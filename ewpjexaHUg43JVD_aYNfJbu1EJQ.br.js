/*! For license information please see cib.bundle.js.LICENSE.txt */
window.CIB||(()=>{var __webpack_modules__={7659:()=>{},6569:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _asyncIterator(O){var B,U,G,q=2;for("undefined"!=typeof Symbol&&(U=Symbol.asyncIterator,G=Symbol.iterator);q--;){if(U&&null!=(B=O[U]))return B.call(O);if(G&&null!=(B=O[G]))return new AsyncFromSyncIterator(B.call(O));U="@@asyncIterator",G="@@iterator"}throw new TypeError("Object is not async iterable")}function AsyncFromSyncIterator(O){function e(O){if(Object(O)!==O)return Promise.reject(new TypeError(O+" is not an object."));var B=O.done;return Promise.resolve(O.value).then((function(O){return{value:O,done:B}}))}return AsyncFromSyncIterator=function(O){this.s=O,this.n=O.next},AsyncFromSyncIterator.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(O){var B=this.s.return;return void 0===B?Promise.resolve({value:O,done:!0}):e(B.apply(this.s,arguments))},throw:function(O){var B=this.s.return;return void 0===B?Promise.reject(O):e(B.apply(this.s,arguments))}},new AsyncFromSyncIterator(O)}var REACT_ELEMENT_TYPE;function _jsx(O,B,U,G){REACT_ELEMENT_TYPE||(REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var q=O&&O.defaultProps,j=arguments.length-3;if(B||0===j||(B={children:void 0}),1===j)B.children=G;else if(j>1){for(var W=new Array(j),Y=0;Y<j;Y++)W[Y]=arguments[Y+3];B.children=W}if(B&&q)for(var K in q)void 0===B[K]&&(B[K]=q[K]);else B||(B=q||{});return{$$typeof:REACT_ELEMENT_TYPE,type:O,key:void 0===U?null:""+U,ref:null,props:B,_owner:null}}function ownKeys(O,B){var U=Object.keys(O);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(O);B&&(G=G.filter((function(B){return Object.getOwnPropertyDescriptor(O,B).enumerable}))),U.push.apply(U,G)}return U}function _objectSpread2(O){for(var B=1;B<arguments.length;B++){var U=null!=arguments[B]?arguments[B]:{};B%2?ownKeys(Object(U),!0).forEach((function(B){_defineProperty(O,B,U[B])})):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(U)):ownKeys(Object(U)).forEach((function(B){Object.defineProperty(O,B,Object.getOwnPropertyDescriptor(U,B))}))}return O}function _typeof(O){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_typeof(O)}function _wrapRegExp(){_wrapRegExp=function(O,B){return new r(O,void 0,B)};var O=RegExp.prototype,B=new WeakMap;function r(O,U,G){var q=new RegExp(O,U);return B.set(q,G||B.get(O)),_setPrototypeOf(q,r.prototype)}function i(O,U){var G=B.get(U);return Object.keys(G).reduce((function(B,U){return B[U]=O[G[U]],B}),Object.create(null))}return _inherits(r,RegExp),r.prototype.exec=function(B){var U=O.exec.call(this,B);return U&&(U.groups=i(U,this)),U},r.prototype[Symbol.replace]=function(U,G){if("string"==typeof G){var q=B.get(this);return O[Symbol.replace].call(this,U,G.replace(/\$<([^>]+)>/g,(function(O,B){return"$"+q[B]})))}if("function"==typeof G){var j=this;return O[Symbol.replace].call(this,U,(function(){var O=arguments;return"object"!=typeof O[O.length-1]&&(O=[].slice.call(O)).push(i(O,j)),G.apply(this,O)}))}return O[Symbol.replace].call(this,U,G)},_wrapRegExp.apply(this,arguments)}function _AwaitValue(O){this.wrapped=O}function _AsyncGenerator(O){var B,U;function i(B,U){try{var G=O[B](U),q=G.value,j=q instanceof _AwaitValue;Promise.resolve(j?q.wrapped:q).then((function(O){j?i("return"===B?"return":"next",O):s(G.done?"return":"normal",O)}),(function(O){i("throw",O)}))}catch(O){s("throw",O)}}function s(O,G){switch(O){case"return":B.resolve({value:G,done:!0});break;case"throw":B.reject(G);break;default:B.resolve({value:G,done:!1})}(B=B.next)?i(B.key,B.arg):U=null}this._invoke=function(O,G){return new Promise((function(q,j){var W={key:O,arg:G,resolve:q,reject:j,next:null};U?U=U.next=W:(B=U=W,i(O,G))}))},"function"!=typeof O.return&&(this.return=void 0)}function _wrapAsyncGenerator(O){return function(){return new _AsyncGenerator(O.apply(this,arguments))}}function _awaitAsyncGenerator(O){return new _AwaitValue(O)}function _asyncGeneratorDelegate(O,B){var U={},G=!1;function s(U,q){return G=!0,q=new Promise((function(B){B(O[U](q))})),{done:!1,value:B(q)}}return U["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},U.next=function(O){return G?(G=!1,O):s("next",O)},"function"==typeof O.throw&&(U.throw=function(O){if(G)throw G=!1,O;return s("throw",O)}),"function"==typeof O.return&&(U.return=function(O){return G?(G=!1,O):s("return",O)}),U}function asyncGeneratorStep(O,B,U,G,q,j,W){try{var Y=O[j](W),K=Y.value}catch(O){return void U(O)}Y.done?B(K):Promise.resolve(K).then(G,q)}function _asyncToGenerator(O){return function(){var B=this,U=arguments;return new Promise((function(G,q){var j=O.apply(B,U);function n(O){asyncGeneratorStep(j,G,q,n,o,"next",O)}function o(O){asyncGeneratorStep(j,G,q,n,o,"throw",O)}n(void 0)}))}}function _classCallCheck(O,B){if(!(O instanceof B))throw new TypeError("Cannot call a class as a function")}function _defineProperties(O,B){for(var U=0;U<B.length;U++){var G=B[U];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(O,G.key,G)}}function _createClass(O,B,U){return B&&_defineProperties(O.prototype,B),U&&_defineProperties(O,U),Object.defineProperty(O,"prototype",{writable:!1}),O}function _defineEnumerableProperties(O,B){for(var U in B)(j=B[U]).configurable=j.enumerable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(O,U,j);if(Object.getOwnPropertySymbols)for(var G=Object.getOwnPropertySymbols(B),q=0;q<G.length;q++){var j,W=G[q];(j=B[W]).configurable=j.enumerable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(O,W,j)}return O}function _defaults(O,B){for(var U=Object.getOwnPropertyNames(B),G=0;G<U.length;G++){var q=U[G],j=Object.getOwnPropertyDescriptor(B,q);j&&j.configurable&&void 0===O[q]&&Object.defineProperty(O,q,j)}return O}function _defineProperty(O,B,U){return B in O?Object.defineProperty(O,B,{value:U,enumerable:!0,configurable:!0,writable:!0}):O[B]=U,O}function _extends(){return _extends=Object.assign||function(O){for(var B=1;B<arguments.length;B++){var U=arguments[B];for(var G in U)Object.prototype.hasOwnProperty.call(U,G)&&(O[G]=U[G])}return O},_extends.apply(this,arguments)}function _objectSpread(O){for(var B=1;B<arguments.length;B++){var U=null!=arguments[B]?Object(arguments[B]):{},G=Object.keys(U);"function"==typeof Object.getOwnPropertySymbols&&G.push.apply(G,Object.getOwnPropertySymbols(U).filter((function(O){return Object.getOwnPropertyDescriptor(U,O).enumerable}))),G.forEach((function(B){_defineProperty(O,B,U[B])}))}return O}function _inherits(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(B&&B.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),Object.defineProperty(O,"prototype",{writable:!1}),B&&_setPrototypeOf(O,B)}function _inheritsLoose(O,B){O.prototype=Object.create(B.prototype),O.prototype.constructor=O,_setPrototypeOf(O,B)}function _getPrototypeOf(O){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(O){return O.__proto__||Object.getPrototypeOf(O)},_getPrototypeOf(O)}function _setPrototypeOf(O,B){return _setPrototypeOf=Object.setPrototypeOf||function(O,B){return O.__proto__=B,O},_setPrototypeOf(O,B)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(O){return!1}}function _construct(O,B,U){return _construct=_isNativeReflectConstruct()?Reflect.construct:function(O,B,U){var G=[null];G.push.apply(G,B);var q=new(Function.bind.apply(O,G));return U&&_setPrototypeOf(q,U.prototype),q},_construct.apply(null,arguments)}function _isNativeFunction(O){return-1!==Function.toString.call(O).indexOf("[native code]")}function _wrapNativeSuper(O){var B="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(O){if(null===O||!_isNativeFunction(O))return O;if("function"!=typeof O)throw new TypeError("Super expression must either be null or a function");if(void 0!==B){if(B.has(O))return B.get(O);B.set(O,r)}function r(){return _construct(O,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(O.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,O)},_wrapNativeSuper(O)}function _instanceof(O,B){return null!=B&&"undefined"!=typeof Symbol&&B[Symbol.hasInstance]?!!B[Symbol.hasInstance](O):O instanceof B}function _interopRequireDefault(O){return O&&O.__esModule?O:{default:O}}function _getRequireWildcardCache(O){if("function"!=typeof WeakMap)return null;var B=new WeakMap,U=new WeakMap;return(_getRequireWildcardCache=function(O){return O?U:B})(O)}function _interopRequireWildcard(O,B){if(!B&&O&&O.__esModule)return O;if(null===O||"object"!=typeof O&&"function"!=typeof O)return{default:O};var U=_getRequireWildcardCache(B);if(U&&U.has(O))return U.get(O);var G={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in O)if("default"!==j&&Object.prototype.hasOwnProperty.call(O,j)){var W=q?Object.getOwnPropertyDescriptor(O,j):null;W&&(W.get||W.set)?Object.defineProperty(G,j,W):G[j]=O[j]}return G.default=O,U&&U.set(O,G),G}function _newArrowCheck(O,B){if(O!==B)throw new TypeError("Cannot instantiate an arrow function")}function _objectDestructuringEmpty(O){if(null==O)throw new TypeError("Cannot destructure undefined")}function _objectWithoutPropertiesLoose(O,B){if(null==O)return{};var U,G,q={},j=Object.keys(O);for(G=0;G<j.length;G++)U=j[G],B.indexOf(U)>=0||(q[U]=O[U]);return q}function _objectWithoutProperties(O,B){if(null==O)return{};var U,G,q=_objectWithoutPropertiesLoose(O,B);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(O);for(G=0;G<j.length;G++)U=j[G],B.indexOf(U)>=0||Object.prototype.propertyIsEnumerable.call(O,U)&&(q[U]=O[U])}return q}function _assertThisInitialized(O){if(void 0===O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O}function _possibleConstructorReturn(O,B){if(B&&("object"==typeof B||"function"==typeof B))return B;if(void 0!==B)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(O)}function _createSuper(O){var B=_isNativeReflectConstruct();return function(){var U,G=_getPrototypeOf(O);if(B){var q=_getPrototypeOf(this).constructor;U=Reflect.construct(G,arguments,q)}else U=G.apply(this,arguments);return _possibleConstructorReturn(this,U)}}function _superPropBase(O,B){for(;!Object.prototype.hasOwnProperty.call(O,B)&&null!==(O=_getPrototypeOf(O)););return O}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(O,B,U){var G=_superPropBase(O,B);if(G){var q=Object.getOwnPropertyDescriptor(G,B);return q.get?q.get.call(arguments.length<3?O:U):q.value}},_get.apply(this,arguments)}function set(O,B,U,G){return set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(O,B,U,G){var q,j=_superPropBase(O,B);if(j){if((q=Object.getOwnPropertyDescriptor(j,B)).set)return q.set.call(G,U),!0;if(!q.writable)return!1}if(q=Object.getOwnPropertyDescriptor(G,B)){if(!q.writable)return!1;q.value=U,Object.defineProperty(G,B,q)}else _defineProperty(G,B,U);return!0},set(O,B,U,G)}function _set(O,B,U,G,q){if(!set(O,B,U,G||O)&&q)throw new Error("failed to set property");return U}function _taggedTemplateLiteral(O,B){return B||(B=O.slice(0)),Object.freeze(Object.defineProperties(O,{raw:{value:Object.freeze(B)}}))}function _taggedTemplateLiteralLoose(O,B){return B||(B=O.slice(0)),O.raw=B,O}function _readOnlyError(O){throw new TypeError('"'+O+'" is read-only')}function _writeOnlyError(O){throw new TypeError('"'+O+'" is write-only')}function _classNameTDZError(O){throw new Error('Class "'+O+'" cannot be referenced in computed property keys.')}function _temporalUndefined(){}function _tdz(O){throw new ReferenceError(O+" is not defined - temporal dead zone")}function _temporalRef(O,B){return O===_temporalUndefined?_tdz(B):O}function _slicedToArray(O,B){return _arrayWithHoles(O)||_iterableToArrayLimit(O,B)||_unsupportedIterableToArray(O,B)||_nonIterableRest()}function _slicedToArrayLoose(O,B){return _arrayWithHoles(O)||_iterableToArrayLimitLoose(O,B)||_unsupportedIterableToArray(O,B)||_nonIterableRest()}function _toArray(O){return _arrayWithHoles(O)||_iterableToArray(O)||_unsupportedIterableToArray(O)||_nonIterableRest()}function _toConsumableArray(O){return _arrayWithoutHoles(O)||_iterableToArray(O)||_unsupportedIterableToArray(O)||_nonIterableSpread()}function _arrayWithoutHoles(O){if(Array.isArray(O))return _arrayLikeToArray(O)}function _arrayWithHoles(O){if(Array.isArray(O))return O}function _maybeArrayLike(O,B,U){if(B&&!Array.isArray(B)&&"number"==typeof B.length){var G=B.length;return _arrayLikeToArray(B,void 0!==U&&U<G?U:G)}return O(B,U)}function _iterableToArray(O){if("undefined"!=typeof Symbol&&null!=O[Symbol.iterator]||null!=O["@@iterator"])return Array.from(O)}function _iterableToArrayLimit(O,B){var U=null==O?null:"undefined"!=typeof Symbol&&O[Symbol.iterator]||O["@@iterator"];if(null!=U){var G,q,j=[],W=!0,Y=!1;try{for(U=U.call(O);!(W=(G=U.next()).done)&&(j.push(G.value),!B||j.length!==B);W=!0);}catch(O){Y=!0,q=O}finally{try{W||null==U.return||U.return()}finally{if(Y)throw q}}return j}}function _iterableToArrayLimitLoose(O,B){var U=O&&("undefined"!=typeof Symbol&&O[Symbol.iterator]||O["@@iterator"]);if(null!=U){var G=[];for(U=U.call(O),_step;!(_step=U.next()).done&&(G.push(_step.value),!B||G.length!==B););return G}}function _unsupportedIterableToArray(O,B){if(O){if("string"==typeof O)return _arrayLikeToArray(O,B);var U=Object.prototype.toString.call(O).slice(8,-1);return"Object"===U&&O.constructor&&(U=O.constructor.name),"Map"===U||"Set"===U?Array.from(O):"Arguments"===U||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(U)?_arrayLikeToArray(O,B):void 0}}function _arrayLikeToArray(O,B){(null==B||B>O.length)&&(B=O.length);for(var U=0,G=new Array(B);U<B;U++)G[U]=O[U];return G}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(O,B){var U="undefined"!=typeof Symbol&&O[Symbol.iterator]||O["@@iterator"];if(!U){if(Array.isArray(O)||(U=_unsupportedIterableToArray(O))||B&&O&&"number"==typeof O.length){U&&(O=U);var G=0,s=function(){};return{s,n:function(){return G>=O.length?{done:!0}:{done:!1,value:O[G++]}},e:function(O){throw O},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var q,j=!0,W=!1;return{s:function(){U=U.call(O)},n:function(){var O=U.next();return j=O.done,O},e:function(O){W=!0,q=O},f:function(){try{j||null==U.return||U.return()}finally{if(W)throw q}}}}function _createForOfIteratorHelperLoose(O,B){var U="undefined"!=typeof Symbol&&O[Symbol.iterator]||O["@@iterator"];if(U)return(U=U.call(O)).next.bind(U);if(Array.isArray(O)||(U=_unsupportedIterableToArray(O))||B&&O&&"number"==typeof O.length){U&&(O=U);var G=0;return function(){return G>=O.length?{done:!0}:{done:!1,value:O[G++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _skipFirstGeneratorNext(O){return function(){var B=O.apply(this,arguments);return B.next(),B}}function _toPrimitive(O,B){if("object"!=typeof O||null===O)return O;var U=O[Symbol.toPrimitive];if(void 0!==U){var G=U.call(O,B||"default");if("object"!=typeof G)return G;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===B?String:Number)(O)}function _toPropertyKey(O){var B=_toPrimitive(O,"string");return"symbol"==typeof B?B:String(B)}function _initializerWarningHelper(O,B){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}function _initializerDefineProperty(O,B,U,G){U&&Object.defineProperty(O,B,{enumerable:U.enumerable,configurable:U.configurable,writable:U.writable,value:U.initializer?U.initializer.call(G):void 0})}function _applyDecoratedDescriptor(O,B,U,G,q){var j={};return Object.keys(G).forEach((function(O){j[O]=G[O]})),j.enumerable=!!j.enumerable,j.configurable=!!j.configurable,("value"in j||j.initializer)&&(j.writable=!0),j=U.slice().reverse().reduce((function(U,G){return G(O,B,U)||U}),j),q&&void 0!==j.initializer&&(j.value=j.initializer?j.initializer.call(q):void 0,j.initializer=void 0),void 0===j.initializer&&(Object.defineProperty(O,B,j),j=null),j}__webpack_require__.d(__webpack_exports__,{Bc:()=>PlayerEvents}),_AsyncGenerator.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},_AsyncGenerator.prototype.next=function(O){return this._invoke("next",O)},_AsyncGenerator.prototype.throw=function(O){return this._invoke("throw",O)},_AsyncGenerator.prototype.return=function(O){return this._invoke("return",O)};var id=0;function _classPrivateFieldLooseKey(O){return"__private_"+id+++"_"+O}function _classPrivateFieldLooseBase(O,B){if(!Object.prototype.hasOwnProperty.call(O,B))throw new TypeError("attempted to use private field on non-instance");return O}function _classPrivateFieldGet(O,B){return _classApplyDescriptorGet(O,_classExtractFieldDescriptor(O,B,"get"))}function _classPrivateFieldSet(O,B,U){return _classApplyDescriptorSet(O,_classExtractFieldDescriptor(O,B,"set"),U),U}function _classPrivateFieldDestructureSet(O,B){return _classApplyDescriptorDestructureSet(O,_classExtractFieldDescriptor(O,B,"set"))}function _classExtractFieldDescriptor(O,B,U){if(!B.has(O))throw new TypeError("attempted to "+U+" private field on non-instance");return B.get(O)}function _classStaticPrivateFieldSpecGet(O,B,U){return _classCheckPrivateStaticAccess(O,B),_classCheckPrivateStaticFieldDescriptor(U,"get"),_classApplyDescriptorGet(O,U)}function _classStaticPrivateFieldSpecSet(O,B,U,G){return _classCheckPrivateStaticAccess(O,B),_classCheckPrivateStaticFieldDescriptor(U,"set"),_classApplyDescriptorSet(O,U,G),G}function _classStaticPrivateMethodGet(O,B,U){return _classCheckPrivateStaticAccess(O,B),U}function _classStaticPrivateMethodSet(){throw new TypeError("attempted to set read only static private field")}function _classApplyDescriptorGet(O,B){return B.get?B.get.call(O):B.value}function _classApplyDescriptorSet(O,B,U){if(B.set)B.set.call(O,U);else{if(!B.writable)throw new TypeError("attempted to set read only private field");B.value=U}}function _classApplyDescriptorDestructureSet(O,B){if(B.set)return"__destrObj"in B||(B.__destrObj={set value(U){B.set.call(O,U)}}),B.__destrObj;if(!B.writable)throw new TypeError("attempted to set read only private field");return B}function _classStaticPrivateFieldDestructureSet(O,B,U){return _classCheckPrivateStaticAccess(O,B),_classCheckPrivateStaticFieldDescriptor(U,"set"),_classApplyDescriptorDestructureSet(O,U)}function _classCheckPrivateStaticAccess(O,B){if(O!==B)throw new TypeError("Private static access of wrong provenance")}function _classCheckPrivateStaticFieldDescriptor(O,B){if(void 0===O)throw new TypeError("attempted to "+B+" private static field before its declaration")}function _decorate(O,B,U,G){var q=_getDecoratorsApi();if(G)for(var j=0;j<G.length;j++)q=G[j](q);var W=B((function(O){q.initializeInstanceElements(O,Y.elements)}),U),Y=q.decorateClass(_coalesceClassElements(W.d.map(_createElementDescriptor)),O);return q.initializeClassElements(W.F,Y.elements),q.runClassFinishers(W.F,Y.finishers)}function _getDecoratorsApi(){_getDecoratorsApi=function(){return O};var O={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(O,B){["method","field"].forEach((function(U){B.forEach((function(B){B.kind===U&&"own"===B.placement&&this.defineClassElement(O,B)}),this)}),this)},initializeClassElements:function(O,B){var U=O.prototype;["method","field"].forEach((function(G){B.forEach((function(B){var q=B.placement;if(B.kind===G&&("static"===q||"prototype"===q)){var j="static"===q?O:U;this.defineClassElement(j,B)}}),this)}),this)},defineClassElement:function(O,B){var U=B.descriptor;if("field"===B.kind){var G=B.initializer;U={enumerable:U.enumerable,writable:U.writable,configurable:U.configurable,value:void 0===G?void 0:G.call(O)}}Object.defineProperty(O,B.key,U)},decorateClass:function(O,B){var U=[],G=[],q={static:[],prototype:[],own:[]};if(O.forEach((function(O){this.addElementPlacement(O,q)}),this),O.forEach((function(O){if(!_hasDecorators(O))return U.push(O);var B=this.decorateElement(O,q);U.push(B.element),U.push.apply(U,B.extras),G.push.apply(G,B.finishers)}),this),!B)return{elements:U,finishers:G};var j=this.decorateConstructor(U,B);return G.push.apply(G,j.finishers),j.finishers=G,j},addElementPlacement:function(O,B,U){var G=B[O.placement];if(!U&&-1!==G.indexOf(O.key))throw new TypeError("Duplicated element ("+O.key+")");G.push(O.key)},decorateElement:function(O,B){for(var U=[],G=[],q=O.decorators,j=q.length-1;j>=0;j--){var W=B[O.placement];W.splice(W.indexOf(O.key),1);var Y=this.fromElementDescriptor(O),K=this.toElementFinisherExtras((0,q[j])(Y)||Y);O=K.element,this.addElementPlacement(O,B),K.finisher&&G.push(K.finisher);var Q=K.extras;if(Q){for(var Z=0;Z<Q.length;Z++)this.addElementPlacement(Q[Z],B);U.push.apply(U,Q)}}return{element:O,finishers:G,extras:U}},decorateConstructor:function(O,B){for(var U=[],G=B.length-1;G>=0;G--){var q=this.fromClassDescriptor(O),j=this.toClassDescriptor((0,B[G])(q)||q);if(void 0!==j.finisher&&U.push(j.finisher),void 0!==j.elements){O=j.elements;for(var W=0;W<O.length-1;W++)for(var Y=W+1;Y<O.length;Y++)if(O[W].key===O[Y].key&&O[W].placement===O[Y].placement)throw new TypeError("Duplicated element ("+O[W].key+")")}}return{elements:O,finishers:U}},fromElementDescriptor:function(O){var B={kind:O.kind,key:O.key,placement:O.placement,descriptor:O.descriptor};return Object.defineProperty(B,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),"field"===O.kind&&(B.initializer=O.initializer),B},toElementDescriptors:function(O){if(void 0!==O)return _toArray(O).map((function(O){var B=this.toElementDescriptor(O);return this.disallowProperty(O,"finisher","An element descriptor"),this.disallowProperty(O,"extras","An element descriptor"),B}),this)},toElementDescriptor:function(O){var B=String(O.kind);if("method"!==B&&"field"!==B)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+B+'"');var U=_toPropertyKey(O.key),G=String(O.placement);if("static"!==G&&"prototype"!==G&&"own"!==G)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+G+'"');var q=O.descriptor;this.disallowProperty(O,"elements","An element descriptor");var j={kind:B,key:U,placement:G,descriptor:Object.assign({},q)};return"field"!==B?this.disallowProperty(O,"initializer","A method descriptor"):(this.disallowProperty(q,"get","The property descriptor of a field descriptor"),this.disallowProperty(q,"set","The property descriptor of a field descriptor"),this.disallowProperty(q,"value","The property descriptor of a field descriptor"),j.initializer=O.initializer),j},toElementFinisherExtras:function(O){return{element:this.toElementDescriptor(O),finisher:_optionalCallableProperty(O,"finisher"),extras:this.toElementDescriptors(O.extras)}},fromClassDescriptor:function(O){var B={kind:"class",elements:O.map(this.fromElementDescriptor,this)};return Object.defineProperty(B,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),B},toClassDescriptor:function(O){var B=String(O.kind);if("class"!==B)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+B+'"');this.disallowProperty(O,"key","A class descriptor"),this.disallowProperty(O,"placement","A class descriptor"),this.disallowProperty(O,"descriptor","A class descriptor"),this.disallowProperty(O,"initializer","A class descriptor"),this.disallowProperty(O,"extras","A class descriptor");var U=_optionalCallableProperty(O,"finisher");return{elements:this.toElementDescriptors(O.elements),finisher:U}},runClassFinishers:function(O,B){for(var U=0;U<B.length;U++){var G=(0,B[U])(O);if(void 0!==G){if("function"!=typeof G)throw new TypeError("Finishers must return a constructor.");O=G}}return O},disallowProperty:function(O,B,U){if(void 0!==O[B])throw new TypeError(U+" can't have a ."+B+" property.")}};return O}function _createElementDescriptor(O){var B,U=_toPropertyKey(O.key);"method"===O.kind?B={value:O.value,writable:!0,configurable:!0,enumerable:!1}:"get"===O.kind?B={get:O.value,configurable:!0,enumerable:!1}:"set"===O.kind?B={set:O.value,configurable:!0,enumerable:!1}:"field"===O.kind&&(B={configurable:!0,writable:!0,enumerable:!0});var G={kind:"field"===O.kind?"field":"method",key:U,placement:O.static?"static":"field"===O.kind?"own":"prototype",descriptor:B};return O.decorators&&(G.decorators=O.decorators),"field"===O.kind&&(G.initializer=O.value),G}function _coalesceGetterSetter(O,B){void 0!==O.descriptor.get?B.descriptor.get=O.descriptor.get:B.descriptor.set=O.descriptor.set}function _coalesceClassElements(O){for(var B=[],r=function(O){return"method"===O.kind&&O.key===q.key&&O.placement===q.placement},U=0;U<O.length;U++){var G,q=O[U];if("method"===q.kind&&(G=B.find(r)))if(_isDataDescriptor(q.descriptor)||_isDataDescriptor(G.descriptor)){if(_hasDecorators(q)||_hasDecorators(G))throw new ReferenceError("Duplicated methods ("+q.key+") can't be decorated.");G.descriptor=q.descriptor}else{if(_hasDecorators(q)){if(_hasDecorators(G))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+q.key+").");G.decorators=q.decorators}_coalesceGetterSetter(q,G)}else B.push(q)}return B}function _hasDecorators(O){return O.decorators&&O.decorators.length}function _isDataDescriptor(O){return void 0!==O&&!(void 0===O.value&&void 0===O.writable)}function _optionalCallableProperty(O,B){var U=O[B];if(void 0!==U&&"function"!=typeof U)throw new TypeError("Expected '"+B+"' to be a function");return U}function _classPrivateMethodGet(O,B,U){if(!B.has(O))throw new TypeError("attempted to get private field on non-instance");return U}function _checkPrivateRedeclaration(O,B){if(B.has(O))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldInitSpec(O,B,U){_checkPrivateRedeclaration(O,B),B.set(O,U)}function _classPrivateMethodInitSpec(O,B){_checkPrivateRedeclaration(O,B),B.add(O)}function _classPrivateMethodSet(){throw new TypeError("attempted to reassign private method")}var _extendStatics=function(O,B){return _extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},_extendStatics(O,B)};function __extends(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function r(){this.constructor=O}_extendStatics(O,B),O.prototype=null===B?Object.create(B):(r.prototype=B.prototype,new r)}var _assign=function(){return _assign=Object.assign||function(O){for(var B,U=1,G=arguments.length;U<G;U++)for(var q in B=arguments[U])Object.prototype.hasOwnProperty.call(B,q)&&(O[q]=B[q]);return O},_assign.apply(this,arguments)};function __rest(O,B){var U={};for(var G in O)Object.prototype.hasOwnProperty.call(O,G)&&B.indexOf(G)<0&&(U[G]=O[G]);if(null!=O&&"function"==typeof Object.getOwnPropertySymbols){var q=0;for(G=Object.getOwnPropertySymbols(O);q<G.length;q++)B.indexOf(G[q])<0&&Object.prototype.propertyIsEnumerable.call(O,G[q])&&(U[G[q]]=O[G[q]])}return U}function __decorate(O,B,U,G){var q,j=arguments.length,W=j<3?B:null===G?G=Object.getOwnPropertyDescriptor(B,U):G;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(O,B,U,G);else for(var Y=O.length-1;Y>=0;Y--)(q=O[Y])&&(W=(j<3?q(W):j>3?q(B,U,W):q(B,U))||W);return j>3&&W&&Object.defineProperty(B,U,W),W}function __param(O,B){return function(U,G){B(U,G,O)}}function __metadata(O,B){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(O,B)}function __awaiter(O,B,U,G){return new(U||(U=Promise))((function(q,j){function n(O){try{h(G.next(O))}catch(O){j(O)}}function o(O){try{h(G.throw(O))}catch(O){j(O)}}function h(O){var B;O.done?q(O.value):(B=O.value,B instanceof U?B:new U((function(O){O(B)}))).then(n,o)}h((G=G.apply(O,B||[])).next())}))}function __generator(O,B){var U,G,q,j,W={label:0,sent:function(){if(1&q[0])throw q[1];return q[1]},trys:[],ops:[]};return j={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(j[Symbol.iterator]=function(){return this}),j;function o(j){return function(Y){return function(j){if(U)throw new TypeError("Generator is already executing.");for(;W;)try{if(U=1,G&&(q=2&j[0]?G.return:j[0]?G.throw||((q=G.return)&&q.call(G),0):G.next)&&!(q=q.call(G,j[1])).done)return q;switch(G=0,q&&(j=[2&j[0],q.value]),j[0]){case 0:case 1:q=j;break;case 4:return W.label++,{value:j[1],done:!1};case 5:W.label++,G=j[1],j=[0];continue;case 7:j=W.ops.pop(),W.trys.pop();continue;default:if(!((q=(q=W.trys).length>0&&q[q.length-1])||6!==j[0]&&2!==j[0])){W=0;continue}if(3===j[0]&&(!q||j[1]>q[0]&&j[1]<q[3])){W.label=j[1];break}if(6===j[0]&&W.label<q[1]){W.label=q[1],q=j;break}if(q&&W.label<q[2]){W.label=q[2],W.ops.push(j);break}q[2]&&W.ops.pop(),W.trys.pop();continue}j=B.call(O,W)}catch(O){j=[6,O],G=0}finally{U=q=0}if(5&j[0])throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}([j,Y])}}}var __createBinding=Object.create?function(O,B,U,G){void 0===G&&(G=U),Object.defineProperty(O,G,{enumerable:!0,get:function(){return B[U]}})}:function(O,B,U,G){void 0===G&&(G=U),O[G]=B[U]};function __exportStar(O,B){for(var U in O)"default"===U||Object.prototype.hasOwnProperty.call(B,U)||__createBinding(B,O,U)}function __values(O){var B="function"==typeof Symbol&&Symbol.iterator,U=B&&O[B],G=0;if(U)return U.call(O);if(O&&"number"==typeof O.length)return{next:function(){return O&&G>=O.length&&(O=void 0),{value:O&&O[G++],done:!O}}};throw new TypeError(B?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(O,B){var U="function"==typeof Symbol&&O[Symbol.iterator];if(!U)return O;var G,q,j=U.call(O),W=[];try{for(;(void 0===B||B-- >0)&&!(G=j.next()).done;)W.push(G.value)}catch(O){q={error:O}}finally{try{G&&!G.done&&(U=j.return)&&U.call(j)}finally{if(q)throw q.error}}return W}function __spread(){for(var O=[],B=0;B<arguments.length;B++)O=O.concat(__read(arguments[B]));return O}function __spreadArrays(){for(var O=0,B=0,U=arguments.length;B<U;B++)O+=arguments[B].length;var G=Array(O),q=0;for(B=0;B<U;B++)for(var j=arguments[B],W=0,Y=j.length;W<Y;W++,q++)G[q]=j[W];return G}function __spreadArray(O,B,U){if(U||2===arguments.length)for(var G,q=0,j=B.length;q<j;q++)!G&&q in B||(G||(G=Array.prototype.slice.call(B,0,q)),G[q]=B[q]);return O.concat(G||Array.prototype.slice.call(B))}function __await(O){return this instanceof __await?(this.v=O,this):new __await(O)}function __asyncGenerator(O,B,U){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var G,q=U.apply(O,B||[]),j=[];return G={},n("next"),n("throw"),n("return"),G[Symbol.asyncIterator]=function(){return this},G;function n(O){q[O]&&(G[O]=function(B){return new Promise((function(U,G){j.push([O,B,U,G])>1||o(O,B)}))})}function o(O,B){try{!function(O){O.value instanceof __await?Promise.resolve(O.value.v).then(h,l):p(j[0][2],O)}(q[O](B))}catch(O){p(j[0][3],O)}}function h(O){o("next",O)}function l(O){o("throw",O)}function p(O,B){O(B),j.shift(),j.length&&o(j[0][0],j[0][1])}}function __asyncDelegator(O){var B,U;return B={},i("next"),i("throw",(function(O){throw O})),i("return"),B[Symbol.iterator]=function(){return this},B;function i(G,q){B[G]=O[G]?function(B){return(U=!U)?{value:__await(O[G](B)),done:"return"===G}:q?q(B):B}:q}}function __asyncValues(O){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var B,U=O[Symbol.asyncIterator];return U?U.call(O):(O="function"==typeof __values?__values(O):O[Symbol.iterator](),B={},i("next"),i("throw"),i("return"),B[Symbol.asyncIterator]=function(){return this},B);function i(U){B[U]=O[U]&&function(B){return new Promise((function(G,q){(function(O,B,U,G){Promise.resolve(G).then((function(B){O({value:B,done:U})}),B)})(G,q,(B=O[U](B)).done,B.value)}))}}}function __makeTemplateObject(O,B){return Object.defineProperty?Object.defineProperty(O,"raw",{value:B}):O.raw=B,O}var __setModuleDefault=Object.create?function(O,B){Object.defineProperty(O,"default",{enumerable:!0,value:B})}:function(O,B){O.default=B};function __importStar(O){if(O&&O.__esModule)return O;var B={};if(null!=O)for(var U in O)"default"!==U&&Object.prototype.hasOwnProperty.call(O,U)&&__createBinding(B,O,U);return __setModuleDefault(B,O),B}function __importDefault(O){return O&&O.__esModule?O:{default:O}}function __classPrivateFieldGet(O,B,U,G){if("a"===U&&!G)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof B?O!==B||!G:!B.has(O))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===U?G:"a"===U?G.call(O):G?G.value:B.get(O)}function __classPrivateFieldSet(O,B,U,G,q){if("m"===G)throw new TypeError("Private method is not writable");if("a"===G&&!q)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof B?O!==B||!q:!B.has(O))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===G?q.call(O,U):q?q.value=U:B.set(O,U),U}var t$3=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,e$8=Symbol(),n$5=new Map;class s$3{constructor(O,B){if(this._$cssResult$=!0,B!==e$8)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=O}get styleSheet(){var O=n$5.get(this.cssText);return t$3&&void 0===O&&(n$5.set(this.cssText,O=new CSSStyleSheet),O.replaceSync(this.cssText)),O}toString(){return this.cssText}}var o$5=O=>new s$3("string"==typeof O?O:O+"",e$8),r$3=function(O){for(var B=arguments.length,U=new Array(B>1?B-1:0),G=1;G<B;G++)U[G-1]=arguments[G];var q=1===O.length?O[0]:U.reduce(((B,U,G)=>B+(O=>{if(!0===O._$cssResult$)return O.cssText;if("number"==typeof O)return O;throw Error("Value passed to 'css' function must be a 'css' function result: "+O+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(U)+O[G+1]),O[0]);return new s$3(q,e$8)},i$3=(O,B)=>{t$3?O.adoptedStyleSheets=B.map((O=>O instanceof CSSStyleSheet?O:O.styleSheet)):B.forEach((B=>{var U=document.createElement("style"),G=window.litNonce;void 0!==G&&U.setAttribute("nonce",G),U.textContent=B.cssText,O.appendChild(U)}))},S$1=t$3?O=>O:O=>O instanceof CSSStyleSheet?(O=>{var B="";for(var U of O.cssRules)B+=U.cssText;return o$5(B)})(O):O,s$2,e$7=window.trustedTypes,r$2=e$7?e$7.emptyScript:"",h$2=window.reactiveElementPolyfillSupport,o$4={toAttribute(O,B){switch(B){case Boolean:O=O?r$2:null;break;case Object:case Array:O=null==O?O:JSON.stringify(O)}return O},fromAttribute(O,B){var U=O;switch(B){case Boolean:U=null!==O;break;case Number:U=null===O?null:Number(O);break;case Object:case Array:try{U=JSON.parse(O)}catch(O){U=null}}return U}},n$4=(O,B)=>B!==O&&(B==B||O==O),l$3={attribute:!0,type:String,converter:o$4,reflect:!1,hasChanged:n$4},t$2;class a$1 extends HTMLElement{constructor(){super(),this._$Et=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Ei=null,this.o()}static addInitializer(O){var B;null!==(B=this.l)&&void 0!==B||(this.l=[]),this.l.push(O)}static get observedAttributes(){this.finalize();var O=[];return this.elementProperties.forEach(((B,U)=>{var G=this._$Eh(U,B);void 0!==G&&(this._$Eu.set(G,U),O.push(G))})),O}static createProperty(O){var B=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l$3;if(B.state&&(B.attribute=!1),this.finalize(),this.elementProperties.set(O,B),!B.noAccessor&&!this.prototype.hasOwnProperty(O)){var U="symbol"==typeof O?Symbol():"__"+O,G=this.getPropertyDescriptor(O,U,B);void 0!==G&&Object.defineProperty(this.prototype,O,G)}}static getPropertyDescriptor(O,B,U){return{get(){return this[B]},set(G){var q=this[O];this[B]=G,this.requestUpdate(O,q,U)},configurable:!0,enumerable:!0}}static getPropertyOptions(O){return this.elementProperties.get(O)||l$3}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;var O=Object.getPrototypeOf(this);if(O.finalize(),this.elementProperties=new Map(O.elementProperties),this._$Eu=new Map,this.hasOwnProperty("properties")){var B=this.properties,U=[...Object.getOwnPropertyNames(B),...Object.getOwnPropertySymbols(B)];for(var G of U)this.createProperty(G,B[G])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(O){var B=[];if(Array.isArray(O)){var U=new Set(O.flat(1/0).reverse());for(var G of U)B.unshift(S$1(G))}else void 0!==O&&B.push(S$1(O));return B}static _$Eh(O,B){var U=B.attribute;return!1===U?void 0:"string"==typeof U?U:"string"==typeof O?O.toLowerCase():void 0}o(){var O;this._$Ep=new Promise((O=>this.enableUpdating=O)),this._$AL=new Map,this._$Em(),this.requestUpdate(),null===(O=this.constructor.l)||void 0===O||O.forEach((O=>O(this)))}addController(O){var B,U;(null!==(B=this._$Eg)&&void 0!==B?B:this._$Eg=[]).push(O),void 0!==this.renderRoot&&this.isConnected&&(null===(U=O.hostConnected)||void 0===U||U.call(O))}removeController(O){var B;null===(B=this._$Eg)||void 0===B||B.splice(this._$Eg.indexOf(O)>>>0,1)}_$Em(){this.constructor.elementProperties.forEach(((O,B)=>{this.hasOwnProperty(B)&&(this._$Et.set(B,this[B]),delete this[B])}))}createRenderRoot(){var O,B=null!==(O=this.shadowRoot)&&void 0!==O?O:this.attachShadow(this.constructor.shadowRootOptions);return i$3(B,this.constructor.elementStyles),B}connectedCallback(){var O;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(O=this._$Eg)||void 0===O||O.forEach((O=>{var B;return null===(B=O.hostConnected)||void 0===B?void 0:B.call(O)}))}enableUpdating(O){}disconnectedCallback(){var O;null===(O=this._$Eg)||void 0===O||O.forEach((O=>{var B;return null===(B=O.hostDisconnected)||void 0===B?void 0:B.call(O)}))}attributeChangedCallback(O,B,U){this._$AK(O,U)}_$ES(O,B){var U,G,q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l$3,j=this.constructor._$Eh(O,q);if(void 0!==j&&!0===q.reflect){var W=(null!==(G=null===(U=q.converter)||void 0===U?void 0:U.toAttribute)&&void 0!==G?G:o$4.toAttribute)(B,q.type);this._$Ei=O,null==W?this.removeAttribute(j):this.setAttribute(j,W),this._$Ei=null}}_$AK(O,B){var U,G,q,j=this.constructor,W=j._$Eu.get(O);if(void 0!==W&&this._$Ei!==W){var Y=j.getPropertyOptions(W),K=Y.converter,Q=null!==(q=null!==(G=null===(U=K)||void 0===U?void 0:U.fromAttribute)&&void 0!==G?G:"function"==typeof K?K:null)&&void 0!==q?q:o$4.fromAttribute;this._$Ei=W,this[W]=Q(B,Y.type),this._$Ei=null}}requestUpdate(O,B,U){var G=!0;void 0!==O&&(((U=U||this.constructor.getPropertyOptions(O)).hasChanged||n$4)(this[O],B)?(this._$AL.has(O)||this._$AL.set(O,B),!0===U.reflect&&this._$Ei!==O&&(void 0===this._$E_&&(this._$E_=new Map),this._$E_.set(O,U))):G=!1),!this.isUpdatePending&&G&&(this._$Ep=this._$EC())}_$EC(){var O=this;return _asyncToGenerator((function*(){O.isUpdatePending=!0;try{yield O._$Ep}catch(B){Promise.reject(B)}var B=O.scheduleUpdate();return null!=B&&(yield B),!O.isUpdatePending}))()}scheduleUpdate(){return this.performUpdate()}performUpdate(){var O;if(this.isUpdatePending){this.hasUpdated,this._$Et&&(this._$Et.forEach(((O,B)=>this[B]=O)),this._$Et=void 0);var B=!1,U=this._$AL;try{(B=this.shouldUpdate(U))?(this.willUpdate(U),null===(O=this._$Eg)||void 0===O||O.forEach((O=>{var B;return null===(B=O.hostUpdate)||void 0===B?void 0:B.call(O)})),this.update(U)):this._$EU()}catch(O){throw B=!1,this._$EU(),O}B&&this._$AE(U)}}willUpdate(O){}_$AE(O){var B;null===(B=this._$Eg)||void 0===B||B.forEach((O=>{var B;return null===(B=O.hostUpdated)||void 0===B?void 0:B.call(O)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(O)),this.updated(O)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Ep}shouldUpdate(O){return!0}update(O){void 0!==this._$E_&&(this._$E_.forEach(((O,B)=>this._$ES(B,this[B],O))),this._$E_=void 0),this._$EU()}updated(O){}firstUpdated(O){}}a$1.finalized=!0,a$1.elementProperties=new Map,a$1.elementStyles=[],a$1.shadowRootOptions={mode:"open"},null==h$2||h$2({ReactiveElement:a$1}),(null!==(s$2=globalThis.reactiveElementVersions)&&void 0!==s$2?s$2:globalThis.reactiveElementVersions=[]).push("1.2.1");var i$2=globalThis.trustedTypes,s$1=i$2?i$2.createPolicy("lit-html",{createHTML:O=>O}):void 0,e$6="lit$".concat((Math.random()+"").slice(9),"$"),o$3="?"+e$6,n$3="<".concat(o$3,">"),l$2=document,h$1=function(){var O=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l$2.createComment(O)},r$1=O=>null===O||"object"!=typeof O&&"function"!=typeof O,d=Array.isArray,u=O=>{var B;return d(O)||"function"==typeof(null===(B=O)||void 0===B?void 0:B[Symbol.iterator])},c=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,a=/>/g,f=/>|[ 	\n\r](?:([^\s"'>=/]+)([ 	\n\r]*=[ 	\n\r]*(?:[^ 	\n\r"'`<>=]|("|')|))|$)/g,_=/'/g,m=/"/g,g=/^(?:script|style|textarea)$/i,p=O=>function(B){for(var U=arguments.length,G=new Array(U>1?U-1:0),q=1;q<U;q++)G[q-1]=arguments[q];return{_$litType$:O,strings:B,values:G}},$=p(1),y=p(2),b=Symbol.for("lit-noChange"),w=Symbol.for("lit-nothing"),T=new WeakMap,x=(O,B,U)=>{var G,q,j=null!==(G=null==U?void 0:U.renderBefore)&&void 0!==G?G:B,W=j._$litPart$;if(void 0===W){var Y=null!==(q=null==U?void 0:U.renderBefore)&&void 0!==q?q:null;j._$litPart$=W=new N(B.insertBefore(h$1(),Y),Y,void 0,null!=U?U:{})}return W._$AI(O),W},A=l$2.createTreeWalker(l$2,129,null,!1),C=(O,B)=>{for(var U,G=O.length-1,q=[],j=2===B?"<svg>":"",W=c,Y=0;Y<G;Y++){for(var K=O[Y],Q=void 0,Z=void 0,X=-1,J=0;J<K.length&&(W.lastIndex=J,null!==(Z=W.exec(K)));)J=W.lastIndex,W===c?"!--"===Z[1]?W=v:void 0!==Z[1]?W=a:void 0!==Z[2]?(g.test(Z[2])&&(U=RegExp("</"+Z[2],"g")),W=f):void 0!==Z[3]&&(W=f):W===f?">"===Z[0]?(W=null!=U?U:c,X=-1):void 0===Z[1]?X=-2:(X=W.lastIndex-Z[2].length,Q=Z[1],W=void 0===Z[3]?f:'"'===Z[3]?m:_):W===m||W===_?W=f:W===v||W===a?W=c:(W=f,U=void 0);var ee=W===f&&O[Y+1].startsWith("/>")?" ":"";j+=W===c?K+n$3:X>=0?(q.push(Q),K.slice(0,X)+"$lit$"+K.slice(X)+e$6+ee):K+e$6+(-2===X?(q.push(void 0),Y):ee)}var te=j+(O[G]||"<?>")+(2===B?"</svg>":"");if(!Array.isArray(O)||!O.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==s$1?s$1.createHTML(te):te,q]};class E{constructor(O,B){var U,{strings:G,_$litType$:q}=O;this.parts=[];var j=0,W=0,Y=G.length-1,K=this.parts,[Q,Z]=C(G,q);if(this.el=E.createElement(Q,B),A.currentNode=this.el.content,2===q){var X=this.el.content,J=X.firstChild;J.remove(),X.append(...J.childNodes)}for(;null!==(U=A.nextNode())&&K.length<Y;){if(1===U.nodeType){if(U.hasAttributes()){var ee=[];for(var te of U.getAttributeNames())if(te.endsWith("$lit$")||te.startsWith(e$6)){var ie=Z[W++];if(ee.push(te),void 0!==ie){var re=U.getAttribute(ie.toLowerCase()+"$lit$").split(e$6),ne=/([.?@])?(.*)/.exec(ie);K.push({type:1,index:j,name:ne[2],strings:re,ctor:"."===ne[1]?M:"?"===ne[1]?H:"@"===ne[1]?I:S})}else K.push({type:6,index:j})}for(var oe of ee)U.removeAttribute(oe)}if(g.test(U.tagName)){var ae=U.textContent.split(e$6),se=ae.length-1;if(se>0){U.textContent=i$2?i$2.emptyScript:"";for(var le=0;le<se;le++)U.append(ae[le],h$1()),A.nextNode(),K.push({type:2,index:++j});U.append(ae[se],h$1())}}}else if(8===U.nodeType)if(U.data===o$3)K.push({type:2,index:j});else for(var ce=-1;-1!==(ce=U.data.indexOf(e$6,ce+1));)K.push({type:7,index:j}),ce+=e$6.length-1;j++}}static createElement(O,B){var U=l$2.createElement("template");return U.innerHTML=O,U}}function P(O,B){var U,G,q,j,W=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O,Y=arguments.length>3?arguments[3]:void 0;if(B===b)return B;var K=void 0!==Y?null===(U=W._$Cl)||void 0===U?void 0:U[Y]:W._$Cu,Q=r$1(B)?void 0:B._$litDirective$;return(null==K?void 0:K.constructor)!==Q&&(null===(G=null==K?void 0:K._$AO)||void 0===G||G.call(K,!1),void 0===Q?K=void 0:(K=new Q(O))._$AT(O,W,Y),void 0!==Y?(null!==(q=(j=W)._$Cl)&&void 0!==q?q:j._$Cl=[])[Y]=K:W._$Cu=K),void 0!==K&&(B=P(O,K._$AS(O,B.values),K,Y)),B}class V{constructor(O,B){this.v=[],this._$AN=void 0,this._$AD=O,this._$AM=B}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(O){var B,{el:{content:U},parts:G}=this._$AD,q=(null!==(B=null==O?void 0:O.creationScope)&&void 0!==B?B:l$2).importNode(U,!0);A.currentNode=q;for(var j=A.nextNode(),W=0,Y=0,K=G[0];void 0!==K;){if(W===K.index){var Q=void 0;2===K.type?Q=new N(j,j.nextSibling,this,O):1===K.type?Q=new K.ctor(j,K.name,K.strings,this,O):6===K.type&&(Q=new L(j,this,O)),this.v.push(Q),K=G[++Y]}W!==(null==K?void 0:K.index)&&(j=A.nextNode(),W++)}return q}m(O){var B=0;for(var U of this.v)void 0!==U&&(void 0!==U.strings?(U._$AI(O,U,B),B+=U.strings.length-2):U._$AI(O[B])),B++}}class N{constructor(O,B,U,G){var q;this.type=2,this._$AH=w,this._$AN=void 0,this._$AA=O,this._$AB=B,this._$AM=U,this.options=G,this._$Cg=null===(q=null==G?void 0:G.isConnected)||void 0===q||q}get _$AU(){var O,B;return null!==(B=null===(O=this._$AM)||void 0===O?void 0:O._$AU)&&void 0!==B?B:this._$Cg}get parentNode(){var O=this._$AA.parentNode,B=this._$AM;return void 0!==B&&11===O.nodeType&&(O=B.parentNode),O}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(O){O=P(this,O,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),r$1(O)?O===w||null==O||""===O?(this._$AH!==w&&this._$AR(),this._$AH=w):O!==this._$AH&&O!==b&&this.$(O):void 0!==O._$litType$?this.T(O):void 0!==O.nodeType?this.S(O):u(O)?this.A(O):this.$(O)}M(O){var B=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._$AB;return this._$AA.parentNode.insertBefore(O,B)}S(O){this._$AH!==O&&(this._$AR(),this._$AH=this.M(O))}$(O){this._$AH!==w&&r$1(this._$AH)?this._$AA.nextSibling.data=O:this.S(l$2.createTextNode(O)),this._$AH=O}T(O){var B,{values:U,_$litType$:G}=O,q="number"==typeof G?this._$AC(O):(void 0===G.el&&(G.el=E.createElement(G.h,this.options)),G);if((null===(B=this._$AH)||void 0===B?void 0:B._$AD)===q)this._$AH.m(U);else{var j=new V(q,this),W=j.p(this.options);j.m(U),this.S(W),this._$AH=j}}_$AC(O){var B=T.get(O.strings);return void 0===B&&T.set(O.strings,B=new E(O)),B}A(O){d(this._$AH)||(this._$AH=[],this._$AR());var B,U=this._$AH,G=0;for(var q of O)G===U.length?U.push(B=new N(this.M(h$1()),this.M(h$1()),this,this.options)):B=U[G],B._$AI(q),G++;G<U.length&&(this._$AR(B&&B._$AB.nextSibling,G),U.length=G)}_$AR(){var O,B=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,U=arguments.length>1?arguments[1]:void 0;for(null===(O=this._$AP)||void 0===O||O.call(this,!1,!0,U);B&&B!==this._$AB;){var G=B.nextSibling;B.remove(),B=G}}setConnected(O){var B;void 0===this._$AM&&(this._$Cg=O,null===(B=this._$AP)||void 0===B||B.call(this,O))}}class S{constructor(O,B,U,G,q){this.type=1,this._$AH=w,this._$AN=void 0,this.element=O,this.name=B,this._$AM=G,this.options=q,U.length>2||""!==U[0]||""!==U[1]?(this._$AH=Array(U.length-1).fill(new String),this.strings=U):this._$AH=w}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(O){var B=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,U=arguments.length>2?arguments[2]:void 0,G=arguments.length>3?arguments[3]:void 0,q=this.strings,j=!1;if(void 0===q)O=P(this,O,B,0),(j=!r$1(O)||O!==this._$AH&&O!==b)&&(this._$AH=O);else{var W,Y,K=O;for(O=q[0],W=0;W<q.length-1;W++)(Y=P(this,K[U+W],B,W))===b&&(Y=this._$AH[W]),j||(j=!r$1(Y)||Y!==this._$AH[W]),Y===w?O=w:O!==w&&(O+=(null!=Y?Y:"")+q[W+1]),this._$AH[W]=Y}j&&!G&&this.k(O)}k(O){O===w?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=O?O:"")}}class M extends S{constructor(){super(...arguments),this.type=3}k(O){this.element[this.name]=O===w?void 0:O}}var k=i$2?i$2.emptyScript:"";class H extends S{constructor(){super(...arguments),this.type=4}k(O){O&&O!==w?this.element.setAttribute(this.name,k):this.element.removeAttribute(this.name)}}class I extends S{constructor(O,B,U,G,q){super(O,B,U,G,q),this.type=5}_$AI(O){var B;if((O=null!==(B=P(this,O,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==B?B:w)!==b){var U=this._$AH,G=O===w&&U!==w||O.capture!==U.capture||O.once!==U.once||O.passive!==U.passive,q=O!==w&&(U===w||G);G&&this.element.removeEventListener(this.name,this,U),q&&this.element.addEventListener(this.name,this,O),this._$AH=O}}handleEvent(O){var B,U;"function"==typeof this._$AH?this._$AH.call(null!==(U=null===(B=this.options)||void 0===B?void 0:B.host)&&void 0!==U?U:this.element,O):this._$AH.handleEvent(O)}}class L{constructor(O,B,U){this.element=O,this.type=6,this._$AN=void 0,this._$AM=B,this.options=U}get _$AU(){return this._$AM._$AU}_$AI(O){P(this,O)}}var R={P:"$lit$",V:e$6,L:o$3,I:1,N:C,R:V,D:u,j:P,H:N,O:S,F:H,B:I,W:M,Z:L},z=window.litHtmlPolyfillSupport,l$1,o$2;null==z||z(E,N),(null!==(t$2=globalThis.litHtmlVersions)&&void 0!==t$2?t$2:globalThis.litHtmlVersions=[]).push("2.1.2");var r=a$1;class s extends a$1{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var O,B,U=super.createRenderRoot();return null!==(O=(B=this.renderOptions).renderBefore)&&void 0!==O||(B.renderBefore=U.firstChild),U}update(O){var B=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(O),this._$Dt=x(B,this.renderRoot,this.renderOptions)}connectedCallback(){var O;super.connectedCallback(),null===(O=this._$Dt)||void 0===O||O.setConnected(!0)}disconnectedCallback(){var O;super.disconnectedCallback(),null===(O=this._$Dt)||void 0===O||O.setConnected(!1)}render(){return b}}s.finalized=!0,s._$litElement$=!0,null===(l$1=globalThis.litElementHydrateSupport)||void 0===l$1||l$1.call(globalThis,{LitElement:s});var n$2=globalThis.litElementPolyfillSupport;null==n$2||n$2({LitElement:s});var h={_$AK:(O,B,U)=>{O._$AK(B,U)},_$AL:O=>O._$AL};(null!==(o$2=globalThis.litElementVersions)&&void 0!==o$2?o$2:globalThis.litElementVersions=[]).push("3.1.2");var n$1=O=>B=>"function"==typeof B?((O,B)=>(window.customElements.define(O,B),B))(O,B):((O,B)=>{var{kind:U,elements:G}=B;return{kind:U,elements:G,finisher(B){window.customElements.define(O,B)}}})(O,B),i$1=(O,B)=>"method"===B.kind&&B.descriptor&&!("value"in B.descriptor)?_objectSpread2(_objectSpread2({},B),{},{finisher(U){U.createProperty(B.key,O)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:B.key,initializer(){"function"==typeof B.initializer&&(this[B.key]=B.initializer.call(this))},finisher(U){U.createProperty(B.key,O)}};function e$5(O){return(B,U)=>void 0!==U?((O,B,U)=>{B.constructor.createProperty(U,O)})(O,B,U):i$1(O,B)}function t$1(O){return e$5(_objectSpread2(_objectSpread2({},O),{},{state:!0}))}var e$4=(O,B,U)=>{Object.defineProperty(B,U,O)},t=(O,B)=>({kind:"method",placement:"prototype",key:B.key,descriptor:O}),o$1=O=>{var{finisher:B,descriptor:U}=O;return(O,G)=>{var q;if(void 0===G){var j=null!==(q=O.originalKey)&&void 0!==q?q:O.key,W=null!=U?{kind:"method",placement:"prototype",key:j,descriptor:U(O.key)}:_objectSpread2(_objectSpread2({},O),{},{key:j});return null!=B&&(W.finisher=function(O){B(O,j)}),W}var Y=O.constructor;void 0!==U&&Object.defineProperty(O,G,U(G)),null==B||B(Y,G)}},n;function e$3(O){return o$1({finisher:(B,U)=>{Object.assign(B.prototype[U],O)}})}function i(O,B){return o$1({descriptor:U=>{var G={get(){var B,U;return null!==(U=null===(B=this.renderRoot)||void 0===B?void 0:B.querySelector(O))&&void 0!==U?U:null},enumerable:!0,configurable:!0};if(B){var q="symbol"==typeof U?Symbol():"__"+U;G.get=function(){var B,U;return void 0===this[q]&&(this[q]=null!==(U=null===(B=this.renderRoot)||void 0===B?void 0:B.querySelector(O))&&void 0!==U?U:null),this[q]}}return G}})}function e$2(O){return o$1({descriptor:B=>({get(){var B,U;return null!==(U=null===(B=this.renderRoot)||void 0===B?void 0:B.querySelectorAll(O))&&void 0!==U?U:[]},enumerable:!0,configurable:!0})})}function e$1(O){return o$1({descriptor:B=>({get(){var B=this;return _asyncToGenerator((function*(){var U;return yield B.updateComplete,null===(U=B.renderRoot)||void 0===U?void 0:U.querySelector(O)}))()},enumerable:!0,configurable:!0})})}var e=null!=(null===(n=window.HTMLSlotElement)||void 0===n?void 0:n.prototype.assignedElements)?(O,B)=>O.assignedElements(B):(O,B)=>O.assignedNodes(B).filter((O=>O.nodeType===Node.ELEMENT_NODE));function l(O){var{slot:B,selector:U}=null!=O?O:{};return o$1({descriptor:G=>({get(){var G,q="slot"+(B?"[name=".concat(B,"]"):":not([name])"),j=null===(G=this.renderRoot)||void 0===G?void 0:G.querySelector(q),W=null!=j?e(j,O):[];return U?W.filter((O=>O.matches(U))):W},enumerable:!0,configurable:!0})})}function o(O,B,U){var G,q=O;return"object"==typeof O?(q=O.slot,G=O):G={flatten:B},U?l({slot:q,flatten:B,selector:U}):o$1({descriptor:O=>({get(){var O,B,U="slot"+(q?"[name=".concat(q,"]"):":not([name])"),j=null===(O=this.renderRoot)||void 0===O?void 0:O.querySelector(U);return null!==(B=null==j?void 0:j.assignedNodes(G))&&void 0!==B?B:[]},enumerable:!0,configurable:!0})})}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(O){return O&&O.__esModule&&Object.prototype.hasOwnProperty.call(O,"default")?O.default:O}function getDefaultExportFromNamespaceIfPresent(O){return O&&Object.prototype.hasOwnProperty.call(O,"default")?O.default:O}function getDefaultExportFromNamespaceIfNotNamed(O){return O&&Object.prototype.hasOwnProperty.call(O,"default")&&1===Object.keys(O).length?O.default:O}function getAugmentedNamespace(O){if(O.__esModule)return O;var B=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(O).forEach((function(U){var G=Object.getOwnPropertyDescriptor(O,U);Object.defineProperty(B,U,G.get?G:{enumerable:!0,get:function(){return O[U]}})})),B}function commonjsRequire(O){throw new Error('Could not dynamically require "'+O+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var lottie$1={exports:{}};(function(module,exports){var factory;"undefined"!=typeof navigator&&(factory=function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(O){_useWebWorker=!!O},getWebWorker=function(){return _useWebWorker},setLocationHref=function(O){locationHref=O},getLocationHref=function(){return locationHref};function createTag(O){return document.createElement(O)}function extendPrototype(O,B){var U,G,q=O.length;for(U=0;U<q;U+=1)for(var j in G=O[U].prototype)Object.prototype.hasOwnProperty.call(G,j)&&(B.prototype[j]=G[j])}function getDescriptor(O,B){return Object.getOwnPropertyDescriptor(O,B)}function createProxyFunction(O){function e(){}return e.prototype=O,e}var audioControllerFactory=function(){function t(O){this.audios=[],this.audioFactory=O,this._volume=1,this._isMuted=!1}return t.prototype={addAudio:function(O){this.audios.push(O)},pause:function(){var O,B=this.audios.length;for(O=0;O<B;O+=1)this.audios[O].pause()},resume:function(){var O,B=this.audios.length;for(O=0;O<B;O+=1)this.audios[O].resume()},setRate:function(O){var B,U=this.audios.length;for(B=0;B<U;B+=1)this.audios[B].setRate(O)},createAudio:function(O){return this.audioFactory?this.audioFactory(O):window.Howl?new window.Howl({src:[O]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(O){this.audioFactory=O},setVolume:function(O){this._volume=O,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var O,B=this.audios.length;for(O=0;O<B;O+=1)this.audios[O].volume(this._volume*(this._isMuted?0:1))}},function(){return new t}}(),createTypedArray=function(){function t(O,B){var U,G=0,q=[];switch(O){case"int16":case"uint8c":U=1;break;default:U=1.1}for(G=0;G<B;G+=1)q.push(U);return q}return"function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(O,B){return"float32"===O?new Float32Array(B):"int16"===O?new Int16Array(B):"uint8c"===O?new Uint8ClampedArray(B):t(O,B)}:t}();function createSizedArray(O){return Array.apply(null,{length:O})}function _typeof$6(O){return _typeof$6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_typeof$6(O)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),_shouldRoundValues=!1,bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};function ProjectInterface$1(){return{}}!function(){var O,B=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],U=B.length;for(O=0;O<U;O+=1)BMMath[B[O]]=Math[B[O]]}(),BMMath.random=Math.random,BMMath.abs=function(O){if("object"===_typeof$6(O)&&O.length){var B,U=createSizedArray(O.length),G=O.length;for(B=0;B<G;B+=1)U[B]=Math.abs(O[B]);return U}return Math.abs(O)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function roundValues(O){_shouldRoundValues=!!O}function bmRnd(O){return _shouldRoundValues?Math.round(O):O}function styleDiv(O){O.style.position="absolute",O.style.top=0,O.style.left=0,O.style.display="block",O.style.transformOrigin="0 0",O.style.webkitTransformOrigin="0 0",O.style.backfaceVisibility="visible",O.style.webkitBackfaceVisibility="visible",O.style.transformStyle="preserve-3d",O.style.webkitTransformStyle="preserve-3d",O.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(O,B,U,G){this.type=O,this.currentTime=B,this.totalTime=U,this.direction=G<0?-1:1}function BMCompleteEvent(O,B){this.type=O,this.direction=B<0?-1:1}function BMCompleteLoopEvent(O,B,U,G){this.type=O,this.currentLoop=U,this.totalLoops=B,this.direction=G<0?-1:1}function BMSegmentStartEvent(O,B,U){this.type=O,this.firstFrame=B,this.totalFrames=U}function BMDestroyEvent(O,B){this.type=O,this.target=B}function BMRenderFrameErrorEvent(O,B){this.type="renderFrameError",this.nativeError=O,this.currentTime=B}function BMConfigErrorEvent(O){this.type="configError",this.nativeError=O}function BMAnimationConfigErrorEvent(O,B){this.type=O,this.nativeError=B}var createElementID=(_count=0,function(){return idPrefix$1+"__lottie_element_"+(_count+=1)}),_count;function HSVtoRGB(O,B,U){var G,q,j,W,Y,K,Q,Z;switch(K=U*(1-B),Q=U*(1-(Y=6*O-(W=Math.floor(6*O)))*B),Z=U*(1-(1-Y)*B),W%6){case 0:G=U,q=Z,j=K;break;case 1:G=Q,q=U,j=K;break;case 2:G=K,q=U,j=Z;break;case 3:G=K,q=Q,j=U;break;case 4:G=Z,q=K,j=U;break;case 5:G=U,q=K,j=Q}return[G,q,j]}function RGBtoHSV(O,B,U){var G,q=Math.max(O,B,U),j=Math.min(O,B,U),W=q-j,Y=0===q?0:W/q,K=q/255;switch(q){case j:G=0;break;case O:G=B-U+W*(B<U?6:0),G/=6*W;break;case B:G=U-O+2*W,G/=6*W;break;case U:G=O-B+4*W,G/=6*W}return[G,Y,K]}function addSaturationToRGB(O,B){var U=RGBtoHSV(255*O[0],255*O[1],255*O[2]);return U[1]+=B,U[1]>1?U[1]=1:U[1]<=0&&(U[1]=0),HSVtoRGB(U[0],U[1],U[2])}function addBrightnessToRGB(O,B){var U=RGBtoHSV(255*O[0],255*O[1],255*O[2]);return U[2]+=B,U[2]>1?U[2]=1:U[2]<0&&(U[2]=0),HSVtoRGB(U[0],U[1],U[2])}function addHueToRGB(O,B){var U=RGBtoHSV(255*O[0],255*O[1],255*O[2]);return U[0]+=B/360,U[0]>1?U[0]-=1:U[0]<0&&(U[0]+=1),HSVtoRGB(U[0],U[1],U[2])}var rgbToHex=function(){var O,B,U=[];for(O=0;O<256;O+=1)B=O.toString(16),U[O]=1===B.length?"0"+B:B;return function(O,B,G){return O<0&&(O=0),B<0&&(B=0),G<0&&(G=0),"#"+U[O]+U[B]+U[G]}}(),setSubframeEnabled=function(O){subframeEnabled=!!O},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(O){expressionsPlugin=O},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(O){expressionsInterfaces=O},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(O){defaultCurveSegments=O},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(O){idPrefix$1=O},getIdPrefix=function(){return idPrefix$1};function createNS(O){return document.createElementNS(svgNS,O)}function _typeof$5(O){return _typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_typeof$5(O)}var dataManager=function(){var O,B,U=1,G=[],q={onmessage:function(){},postMessage:function(B){O({data:B})}},j={postMessage:function(O){q.onmessage({data:O})}};function a(){B||(B=function(B){if(window.Worker&&window.Blob&&getWebWorker()){var U=new Blob(["var _workerSelf = self; self.onmessage = ",B.toString()],{type:"text/javascript"}),G=URL.createObjectURL(U);return new Worker(G)}return O=B,q}((function(O){if(j.dataManager||(j.dataManager=function(){function t(O,B){var U,G,q,j,W,Y,K=O.length;for(G=0;G<K;G+=1)if("ks"in(U=O[G])&&!U.completed){if(U.completed=!0,U.hasMask){var Q=U.masksProperties;for(j=Q.length,q=0;q<j;q+=1)if(Q[q].pt.k.i)i(Q[q].pt.k);else for(Y=Q[q].pt.k.length,W=0;W<Y;W+=1)Q[q].pt.k[W].s&&i(Q[q].pt.k[W].s[0]),Q[q].pt.k[W].e&&i(Q[q].pt.k[W].e[0])}0===U.ty?(U.layers=e(U.refId,B),t(U.layers,B)):4===U.ty?r(U.shapes):5===U.ty&&c(U)}}function e(O,B){var U=function(O,B){for(var U=0,G=B.length;U<G;){if(B[U].id===O)return B[U];U+=1}return null}(O,B);return U?U.layers.__used?JSON.parse(JSON.stringify(U.layers)):(U.layers.__used=!0,U.layers):null}function r(O){var B,U,G;for(B=O.length-1;B>=0;B-=1)if("sh"===O[B].ty)if(O[B].ks.k.i)i(O[B].ks.k);else for(G=O[B].ks.k.length,U=0;U<G;U+=1)O[B].ks.k[U].s&&i(O[B].ks.k[U].s[0]),O[B].ks.k[U].e&&i(O[B].ks.k[U].e[0]);else"gr"===O[B].ty&&r(O[B].it)}function i(O){var B,U=O.i.length;for(B=0;B<U;B+=1)O.i[B][0]+=O.v[B][0],O.i[B][1]+=O.v[B][1],O.o[B][0]+=O.v[B][0],O.o[B][1]+=O.v[B][1]}function s(O,B){var U=B?B.split("."):[100,100,100];return O[0]>U[0]||!(U[0]>O[0])&&(O[1]>U[1]||!(U[1]>O[1])&&(O[2]>U[2]||!(U[2]>O[2])&&null))}var O,B=function(){var O=[4,4,14];function e(O){var B,U,G,q=O.length;for(B=0;B<q;B+=1)5===O[B].ty&&(void 0,G=(U=O[B]).t.d,U.t.d={k:[{s:G,t:0}]})}return function(B){if(s(O,B.v)&&(e(B.layers),B.assets)){var U,G=B.assets.length;for(U=0;U<G;U+=1)B.assets[U].layers&&e(B.assets[U].layers)}}}(),U=(O=[4,7,99],function(B){if(B.chars&&!s(O,B.v)){var U,G=B.chars.length;for(U=0;U<G;U+=1){var q=B.chars[U];q.data&&q.data.shapes&&(r(q.data.shapes),q.data.ip=0,q.data.op=99999,q.data.st=0,q.data.sr=1,q.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},B.chars[U].t||(q.data.shapes.push({ty:"no"}),q.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}),G=function(){var O=[5,7,15];function e(O){var B,U,G=O.length;for(B=0;B<G;B+=1)5===O[B].ty&&(U=void 0,"number"==typeof(U=O[B].t.p).a&&(U.a={a:0,k:U.a}),"number"==typeof U.p&&(U.p={a:0,k:U.p}),"number"==typeof U.r&&(U.r={a:0,k:U.r}))}return function(B){if(s(O,B.v)&&(e(B.layers),B.assets)){var U,G=B.assets.length;for(U=0;U<G;U+=1)B.assets[U].layers&&e(B.assets[U].layers)}}}(),q=function(){var O=[4,1,9];function e(O){var B,U,G,q=O.length;for(B=0;B<q;B+=1)if("gr"===O[B].ty)e(O[B].it);else if("fl"===O[B].ty||"st"===O[B].ty)if(O[B].c.k&&O[B].c.k[0].i)for(G=O[B].c.k.length,U=0;U<G;U+=1)O[B].c.k[U].s&&(O[B].c.k[U].s[0]/=255,O[B].c.k[U].s[1]/=255,O[B].c.k[U].s[2]/=255,O[B].c.k[U].s[3]/=255),O[B].c.k[U].e&&(O[B].c.k[U].e[0]/=255,O[B].c.k[U].e[1]/=255,O[B].c.k[U].e[2]/=255,O[B].c.k[U].e[3]/=255);else O[B].c.k[0]/=255,O[B].c.k[1]/=255,O[B].c.k[2]/=255,O[B].c.k[3]/=255}function r(O){var B,U=O.length;for(B=0;B<U;B+=1)4===O[B].ty&&e(O[B].shapes)}return function(B){if(s(O,B.v)&&(r(B.layers),B.assets)){var U,G=B.assets.length;for(U=0;U<G;U+=1)B.assets[U].layers&&r(B.assets[U].layers)}}}(),j=function(){var O=[4,4,18];function e(O){var B,U,G;for(B=O.length-1;B>=0;B-=1)if("sh"===O[B].ty)if(O[B].ks.k.i)O[B].ks.k.c=O[B].closed;else for(G=O[B].ks.k.length,U=0;U<G;U+=1)O[B].ks.k[U].s&&(O[B].ks.k[U].s[0].c=O[B].closed),O[B].ks.k[U].e&&(O[B].ks.k[U].e[0].c=O[B].closed);else"gr"===O[B].ty&&e(O[B].it)}function r(O){var B,U,G,q,j,W,Y=O.length;for(U=0;U<Y;U+=1){if((B=O[U]).hasMask){var K=B.masksProperties;for(q=K.length,G=0;G<q;G+=1)if(K[G].pt.k.i)K[G].pt.k.c=K[G].cl;else for(W=K[G].pt.k.length,j=0;j<W;j+=1)K[G].pt.k[j].s&&(K[G].pt.k[j].s[0].c=K[G].cl),K[G].pt.k[j].e&&(K[G].pt.k[j].e[0].c=K[G].cl)}4===B.ty&&e(B.shapes)}}return function(B){if(s(O,B.v)&&(r(B.layers),B.assets)){var U,G=B.assets.length;for(U=0;U<G;U+=1)B.assets[U].layers&&r(B.assets[U].layers)}}}();function c(O){0===O.t.a.length&&O.t.p}var W={completeData:function(O){O.__complete||(q(O),B(O),U(O),G(O),j(O),t(O.layers,O.assets),function(O,B){if(O){var U=0,G=O.length;for(U=0;U<G;U+=1)1===O[U].t&&(O[U].data.layers=e(O[U].data.refId,B),t(O[U].data.layers,B))}}(O.chars,O.assets),O.__complete=!0)}};return W.checkColors=q,W.checkChars=U,W.checkPathProperties=G,W.checkShapes=j,W.completeLayers=t,W}()),j.assetLoader||(j.assetLoader=function(){function t(O){var B=O.getResponseHeader("content-type");return B&&"json"===O.responseType&&-1!==B.indexOf("json")||O.response&&"object"===_typeof$5(O.response)?O.response:O.response&&"string"==typeof O.response?JSON.parse(O.response):O.responseText?JSON.parse(O.responseText):null}return{load:function(O,B,U,G){var q,j=new XMLHttpRequest;try{j.responseType="json"}catch(O){}j.onreadystatechange=function(){if(4===j.readyState)if(200===j.status)q=t(j),U(q);else try{q=t(j),U(q)}catch(O){G&&G(O)}};try{j.open(["G","E","T"].join(""),O,!0)}catch(U){j.open(["G","E","T"].join(""),B+"/"+O,!0)}j.send()}}}()),"loadAnimation"===O.data.type)j.assetLoader.load(O.data.path,O.data.fullPath,(function(B){j.dataManager.completeData(B),j.postMessage({id:O.data.id,payload:B,status:"success"})}),(function(){j.postMessage({id:O.data.id,status:"error"})}));else if("complete"===O.data.type){var B=O.data.animation;j.dataManager.completeData(B),j.postMessage({id:O.data.id,payload:B,status:"success"})}else"loadData"===O.data.type&&j.assetLoader.load(O.data.path,O.data.fullPath,(function(B){j.postMessage({id:O.data.id,payload:B,status:"success"})}),(function(){j.postMessage({id:O.data.id,status:"error"})}))})),B.onmessage=function(O){var B=O.data,U=B.id,q=G[U];G[U]=null,"success"===B.status?q.onComplete(B.payload):q.onError&&q.onError()})}function n(O,B){var q="processId_"+(U+=1);return G[q]={onComplete:O,onError:B},q}return{loadAnimation:function(O,U,G){a();var q=n(U,G);B.postMessage({type:"loadAnimation",path:O,fullPath:window.location.origin+window.location.pathname,id:q})},loadData:function(O,U,G){a();var q=n(U,G);B.postMessage({type:"loadData",path:O,fullPath:window.location.origin+window.location.pathname,id:q})},completeAnimation:function(O,U,G){a();var q=n(U,G);B.postMessage({type:"complete",animation:O,id:q})}}}(),ImagePreloader=function(){var O=function(){var O=createTag("canvas");O.width=1,O.height=1;var B=O.getContext("2d");return B.fillStyle="rgba(0,0,0,0)",B.fillRect(0,0,1,1),O}();function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function r(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function i(O,B,U){var G="";if(O.e)G=O.p;else if(B){var q=O.p;-1!==q.indexOf("images/")&&(q=q.split("/")[1]),G=B+q}else G=U,G+=O.u?O.u:"",G+=O.p;return G}function s(O){var B=0,U=setInterval(function(){(O.getBBox().width||B>500)&&(this._imageLoaded(),clearInterval(U)),B+=1}.bind(this),50)}function a(O){var B={assetData:O},U=i(O,this.assetsPath,this.path);return dataManager.loadData(U,function(O){B.img=O,this._footageLoaded()}.bind(this),function(){B.img={},this._footageLoaded()}.bind(this)),B}function n(){this._imageLoaded=e.bind(this),this._footageLoaded=r.bind(this),this.testImageLoaded=s.bind(this),this.createFootageData=a.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return n.prototype={loadAssets:function(O,B){var U;this.imagesLoadedCb=B;var G=O.length;for(U=0;U<G;U+=1)O[U].layers||(O[U].t&&"seq"!==O[U].t?3===O[U].t&&(this.totalFootages+=1,this.images.push(this.createFootageData(O[U]))):(this.totalImages+=1,this.images.push(this._createImageData(O[U]))))},setAssetsPath:function(O){this.assetsPath=O||""},setPath:function(O){this.path=O||""},loadedImages:function(){return this.totalImages===this.loadedAssets},loadedFootages:function(){return this.totalFootages===this.loadedFootagesCount},destroy:function(){this.imagesLoadedCb=null,this.images.length=0},getAsset:function(O){for(var B=0,U=this.images.length;B<U;){if(this.images[B].assetData===O)return this.images[B].img;B+=1}return null},createImgData:function(B){var U=i(B,this.assetsPath,this.path),G=createTag("img");G.crossOrigin="anonymous",G.addEventListener("load",this._imageLoaded,!1),G.addEventListener("error",function(){q.img=O,this._imageLoaded()}.bind(this),!1),G.src=U;var q={img:G,assetData:B};return q},createImageData:function(B){var U=i(B,this.assetsPath,this.path),G=createNS("image");isSafari?this.testImageLoaded(G):G.addEventListener("load",this._imageLoaded,!1),G.addEventListener("error",function(){q.img=O,this._imageLoaded()}.bind(this),!1),G.setAttributeNS("http://www.w3.org/1999/xlink","href",U),this._elementHelper.append?this._elementHelper.append(G):this._elementHelper.appendChild(G);var q={img:G,assetData:B};return q},imageLoaded:e,footageLoaded:r,setCacheType:function(O,B){"svg"===O?(this._elementHelper=B,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}},n}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(O,B){if(this._cbs[O])for(var U=this._cbs[O],G=0;G<U.length;G+=1)U[G](B)},addEventListener:function(O,B){return this._cbs[O]||(this._cbs[O]=[]),this._cbs[O].push(B),function(){this.removeEventListener(O,B)}.bind(this)},removeEventListener:function(O,B){if(B){if(this._cbs[O]){for(var U=0,G=this._cbs[O].length;U<G;)this._cbs[O][U]===B&&(this._cbs[O].splice(U,1),U-=1,G-=1),U+=1;this._cbs[O].length||(this._cbs[O]=null)}}else this._cbs[O]=null}};var markerParser=function(){function t(O){for(var B,U=O.split("\r\n"),G={},q=0,j=0;j<U.length;j+=1)2===(B=U[j].split(":")).length&&(G[B[0]]=B[1].trim(),q+=1);if(0===q)throw new Error;return G}return function(O){for(var B=[],U=0;U<O.length;U+=1){var G=O[U],q={time:G.tm,duration:G.dr};try{q.payload=JSON.parse(O[U].cm)}catch(B){try{q.payload=t(O[U].cm)}catch(B){q.payload={name:O[U].cm}}}B.push(q)}return B}}(),ProjectInterface=function(){function t(O){this.compositions.push(O)}return function(){function e(O){for(var B=0,U=this.compositions.length;B<U;){if(this.compositions[B].data&&this.compositions[B].data.nm===O)return this.compositions[B].prepareFrame&&this.compositions[B].data.xt&&this.compositions[B].prepareFrame(this.currentFrame),this.compositions[B].compInterface;B+=1}return null}return e.compositions=[],e.currentFrame=0,e.registerComposition=t,e}}(),renderers={},registerRenderer=function(O,B){renderers[O]=B};function getRenderer(O){return renderers[O]}function _typeof$4(O){return _typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_typeof$4(O)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0)};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(O){(O.wrapper||O.container)&&(this.wrapper=O.wrapper||O.container);var B="svg";O.animType?B=O.animType:O.renderer&&(B=O.renderer);var U=getRenderer(B);this.renderer=new U(this,O.rendererSettings),this.imagePreloader.setCacheType(B,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=B,""===O.loop||null===O.loop||void 0===O.loop||!0===O.loop?this.loop=!0:!1===O.loop?this.loop=!1:this.loop=parseInt(O.loop,10),this.autoplay=!("autoplay"in O)||O.autoplay,this.name=O.name?O.name:"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(O,"autoloadSegments")||O.autoloadSegments,this.assetsPath=O.assetsPath,this.initialSegment=O.initialSegment,O.audioFactory&&this.audioController.setAudioFactory(O.audioFactory),O.animationData?this.setupAnimation(O.animationData):O.path&&(-1!==O.path.lastIndexOf("\\")?this.path=O.path.substr(0,O.path.lastIndexOf("\\")+1):this.path=O.path.substr(0,O.path.lastIndexOf("/")+1),this.fileName=O.path.substr(O.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(O.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(O){dataManager.completeAnimation(O,this.configAnimation)},AnimationItem.prototype.setData=function(O,B){B&&"object"!==_typeof$4(B)&&(B=JSON.parse(B));var U={wrapper:O,animationData:B},G=O.attributes;U.path=G.getNamedItem("data-animation-path")?G.getNamedItem("data-animation-path").value:G.getNamedItem("data-bm-path")?G.getNamedItem("data-bm-path").value:G.getNamedItem("bm-path")?G.getNamedItem("bm-path").value:"",U.animType=G.getNamedItem("data-anim-type")?G.getNamedItem("data-anim-type").value:G.getNamedItem("data-bm-type")?G.getNamedItem("data-bm-type").value:G.getNamedItem("bm-type")?G.getNamedItem("bm-type").value:G.getNamedItem("data-bm-renderer")?G.getNamedItem("data-bm-renderer").value:G.getNamedItem("bm-renderer")?G.getNamedItem("bm-renderer").value:"canvas";var q=G.getNamedItem("data-anim-loop")?G.getNamedItem("data-anim-loop").value:G.getNamedItem("data-bm-loop")?G.getNamedItem("data-bm-loop").value:G.getNamedItem("bm-loop")?G.getNamedItem("bm-loop").value:"";"false"===q?U.loop=!1:"true"===q?U.loop=!0:""!==q&&(U.loop=parseInt(q,10));var j=G.getNamedItem("data-anim-autoplay")?G.getNamedItem("data-anim-autoplay").value:G.getNamedItem("data-bm-autoplay")?G.getNamedItem("data-bm-autoplay").value:!G.getNamedItem("bm-autoplay")||G.getNamedItem("bm-autoplay").value;U.autoplay="false"!==j,U.name=G.getNamedItem("data-name")?G.getNamedItem("data-name").value:G.getNamedItem("data-bm-name")?G.getNamedItem("data-bm-name").value:G.getNamedItem("bm-name")?G.getNamedItem("bm-name").value:"","false"===(G.getNamedItem("data-anim-prerender")?G.getNamedItem("data-anim-prerender").value:G.getNamedItem("data-bm-prerender")?G.getNamedItem("data-bm-prerender").value:G.getNamedItem("bm-prerender")?G.getNamedItem("bm-prerender").value:"")&&(U.prerender=!1),this.setParams(U)},AnimationItem.prototype.includeLayers=function(O){O.op>this.animationData.op&&(this.animationData.op=O.op,this.totalFrames=Math.floor(O.op-this.animationData.ip));var B,U,G=this.animationData.layers,q=G.length,j=O.layers,W=j.length;for(U=0;U<W;U+=1)for(B=0;B<q;){if(G[B].id===j[U].id){G[B]=j[U];break}B+=1}if((O.chars||O.fonts)&&(this.renderer.globalData.fontManager.addChars(O.chars),this.renderer.globalData.fontManager.addFonts(O.fonts,this.renderer.globalData.defs)),O.assets)for(q=O.assets.length,B=0;B<q;B+=1)this.animationData.assets.push(O.assets[B]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(O){this.animationData=O;var B=getExpressionsPlugin();B&&B.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var O=this.animationData.segments;if(!O||0===O.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var B=O.shift();this.timeCompleted=B.time*this.frameRate;var U=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(U,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},AnimationItem.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(O){if(this.renderer)try{this.animationData=O,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(O),O.assets||(O.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(O.assets),this.markers=markerParser(O.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(O){this.triggerConfigError(O)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||"canvas"!==this.renderer.rendererType)&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var O=getExpressionsPlugin();O&&O.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(O,B){var U="number"==typeof O?O:void 0,G="number"==typeof B?B:void 0;this.renderer.updateContainerSize(U,G)},AnimationItem.prototype.setSubframe=function(O){this.isSubframeEnabled=!!O},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!1!==this.isLoaded&&this.renderer)try{this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(O){this.triggerRenderFrameError(O)}},AnimationItem.prototype.play=function(O){O&&this.name!==O||!0===this.isPaused&&(this.isPaused=!1,this.trigger("_pause"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(O){O&&this.name!==O||!1===this.isPaused&&(this.isPaused=!0,this.trigger("_play"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(O){O&&this.name!==O||(!0===this.isPaused?this.play():this.pause())},AnimationItem.prototype.stop=function(O){O&&this.name!==O||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(O){for(var B,U=0;U<this.markers.length;U+=1)if((B=this.markers[U]).payload&&B.payload.name===O)return B;return null},AnimationItem.prototype.goToAndStop=function(O,B,U){if(!U||this.name===U){var G=Number(O);if(isNaN(G)){var q=this.getMarkerData(O);q&&this.goToAndStop(q.time,!0)}else B?this.setCurrentRawFrameValue(O):this.setCurrentRawFrameValue(O*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(O,B,U){if(!U||this.name===U){var G=Number(O);if(isNaN(G)){var q=this.getMarkerData(O);q&&(q.duration?this.playSegments([q.time,q.time+q.duration],!0):this.goToAndStop(q.time,!0))}else this.goToAndStop(G,B,U);this.play()}},AnimationItem.prototype.advanceTime=function(O){if(!0!==this.isPaused&&!1!==this.isLoaded){var B=this.currentRawFrame+O*this.frameModifier,U=!1;B>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?B>=this.totalFrames?(this.playCount+=1,this.checkSegments(B%this.totalFrames)||(this.setCurrentRawFrameValue(B%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(B):this.checkSegments(B>this.totalFrames?B%this.totalFrames:0)||(U=!0,B=this.totalFrames-1):B<0?this.checkSegments(B%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(U=!0,B=0):(this.setCurrentRawFrameValue(this.totalFrames+B%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(B),U&&(this.setCurrentRawFrameValue(B),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(O,B){this.playCount=0,O[1]<O[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=O[0]-O[1],this.timeCompleted=this.totalFrames,this.firstFrame=O[1],this.setCurrentRawFrameValue(this.totalFrames-.001-B)):O[1]>O[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=O[1]-O[0],this.timeCompleted=this.totalFrames,this.firstFrame=O[0],this.setCurrentRawFrameValue(.001+B)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(O,B){var U=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<O?U=O:this.currentRawFrame+this.firstFrame>B&&(U=B-O)),this.firstFrame=O,this.totalFrames=B-O,this.timeCompleted=this.totalFrames,-1!==U&&this.goToAndStop(U,!0)},AnimationItem.prototype.playSegments=function(O,B){if(B&&(this.segments.length=0),"object"===_typeof$4(O[0])){var U,G=O.length;for(U=0;U<G;U+=1)this.segments.push(O[U])}else this.segments.push(O);this.segments.length&&B&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(O){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),O&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(O){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),O),!0)},AnimationItem.prototype.destroy=function(O){O&&this.name!==O||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.renderer=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(O){this.currentRawFrame=O,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(O){this.playSpeed=O,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(O){this.playDirection=O<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setVolume=function(O,B){B&&this.name!==B||this.audioController.setVolume(O)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(O){O&&this.name!==O||this.audioController.mute()},AnimationItem.prototype.unmute=function(O){O&&this.name!==O||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(O){var B="";if(O.e)B=O.p;else if(this.assetsPath){var U=O.p;-1!==U.indexOf("images/")&&(U=U.split("/")[1]),B=this.assetsPath+U}else B=this.path,B+=O.u?O.u:"",B+=O.p;return B},AnimationItem.prototype.getAssetData=function(O){for(var B=0,U=this.assets.length;B<U;){if(O===this.assets[B].id)return this.assets[B];B+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(O){return O?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(O,B,U){try{this.renderer.getElementByPath(O).updateDocumentData(B,U)}catch(O){}},AnimationItem.prototype.trigger=function(O){if(this._cbs&&this._cbs[O])switch(O){case"enterFrame":this.triggerEvent(O,new BMEnterFrameEvent(O,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(O,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(O,new BMCompleteLoopEvent(O,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(O,new BMCompleteEvent(O,this.frameMult));break;case"segmentStart":this.triggerEvent(O,new BMSegmentStartEvent(O,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(O,new BMDestroyEvent(O,this));break;default:this.triggerEvent(O)}"enterFrame"===O&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(O,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===O&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(O,this.loop,this.playCount,this.frameMult)),"complete"===O&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(O,this.frameMult)),"segmentStart"===O&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(O,this.firstFrame,this.totalFrames)),"destroy"===O&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(O,this))},AnimationItem.prototype.triggerRenderFrameError=function(O){var B=new BMRenderFrameErrorEvent(O,this.currentFrame);this.triggerEvent("error",B),this.onError&&this.onError.call(this,B)},AnimationItem.prototype.triggerConfigError=function(O){var B=new BMConfigErrorEvent(O,this.currentFrame);this.triggerEvent("error",B),this.onError&&this.onError.call(this,B)};var animationManager=function(){var O={},B=[],U=0,G=0,q=0,j=!0,W=!1;function o(O){for(var U=0,q=O.target;U<G;)B[U].animation===q&&(B.splice(U,1),U-=1,G-=1,q.isPaused||p()),U+=1}function h(O,U){if(!O)return null;for(var q=0;q<G;){if(B[q].elem===O&&null!==B[q].elem)return B[q].animation;q+=1}var j=new AnimationItem;return c(j,O),j.setData(O,U),j}function l(){q+=1,u()}function p(){q-=1}function c(O,U){O.addEventListener("destroy",o),O.addEventListener("_active",l),O.addEventListener("_idle",p),B.push({elem:U,animation:O}),G+=1}function f(O){var Y,K=O-U;for(Y=0;Y<G;Y+=1)B[Y].animation.advanceTime(K);U=O,q&&!W?window.requestAnimationFrame(f):j=!0}function d(O){U=O,window.requestAnimationFrame(f)}function u(){!W&&q&&j&&(window.requestAnimationFrame(d),j=!1)}return O.registerAnimation=h,O.loadAnimation=function(O){var B=new AnimationItem;return c(B,null),B.setParams(O),B},O.setSpeed=function(O,U){var q;for(q=0;q<G;q+=1)B[q].animation.setSpeed(O,U)},O.setDirection=function(O,U){var q;for(q=0;q<G;q+=1)B[q].animation.setDirection(O,U)},O.play=function(O){var U;for(U=0;U<G;U+=1)B[U].animation.play(O)},O.pause=function(O){var U;for(U=0;U<G;U+=1)B[U].animation.pause(O)},O.stop=function(O){var U;for(U=0;U<G;U+=1)B[U].animation.stop(O)},O.togglePause=function(O){var U;for(U=0;U<G;U+=1)B[U].animation.togglePause(O)},O.searchAnimations=function(O,B,U){var G,q=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),j=q.length;for(G=0;G<j;G+=1)U&&q[G].setAttribute("data-bm-type",U),h(q[G],O);if(B&&0===j){U||(U="svg");var W=document.getElementsByTagName("body")[0];W.innerText="";var Y=createTag("div");Y.style.width="100%",Y.style.height="100%",Y.setAttribute("data-bm-type",U),W.appendChild(Y),h(Y,O)}},O.resize=function(){var O;for(O=0;O<G;O+=1)B[O].animation.resize()},O.goToAndStop=function(O,U,q){var j;for(j=0;j<G;j+=1)B[j].animation.goToAndStop(O,U,q)},O.destroy=function(O){var U;for(U=G-1;U>=0;U-=1)B[U].animation.destroy(O)},O.freeze=function(){W=!0},O.unfreeze=function(){W=!1,u()},O.setVolume=function(O,U){var q;for(q=0;q<G;q+=1)B[q].animation.setVolume(O,U)},O.mute=function(O){var U;for(U=0;U<G;U+=1)B[U].animation.mute(O)},O.unmute=function(O){var U;for(U=0;U<G;U+=1)B[U].animation.unmute(O)},O.getRegisteredAnimations=function(){var O,U=B.length,G=[];for(O=0;O<U;O+=1)G.push(B[O].animation);return G},O}(),BezierFactory=function(){var O={getBezierEasing:function(O,U,G,q,j){var W=j||("bez_"+O+"_"+U+"_"+G+"_"+q).replace(/\./g,"p");if(B[W])return B[W];var Y=new l([O,U,G,q]);return B[W]=Y,Y}},B={},U=.1,G="function"==typeof Float32Array;function s(O,B){return 1-3*B+3*O}function a(O,B){return 3*B-6*O}function n(O){return 3*O}function o(O,B,U){return((s(B,U)*O+a(B,U))*O+n(B))*O}function h(O,B,U){return 3*s(B,U)*O*O+2*a(B,U)*O+n(B)}function l(O){this._p=O,this._mSampleValues=G?new Float32Array(11):new Array(11),this._precomputed=!1,this.get=this.get.bind(this)}return l.prototype={get:function(O){var B=this._p[0],U=this._p[1],G=this._p[2],q=this._p[3];return this._precomputed||this._precompute(),B===U&&G===q?O:0===O?0:1===O?1:o(this._getTForX(O),U,q)},_precompute:function(){var O=this._p[0],B=this._p[1],U=this._p[2],G=this._p[3];this._precomputed=!0,O===B&&U===G||this._calcSampleValues()},_calcSampleValues:function(){for(var O=this._p[0],B=this._p[2],G=0;G<11;++G)this._mSampleValues[G]=o(G*U,O,B)},_getTForX:function(O){for(var B=this._p[0],G=this._p[2],q=this._mSampleValues,j=0,W=1;10!==W&&q[W]<=O;++W)j+=U;var Y=j+(O-q[--W])/(q[W+1]-q[W])*U,K=h(Y,B,G);return K>=.001?function(O,B,U,G){for(var q=0;q<4;++q){var j=h(B,U,G);if(0===j)return B;B-=(o(B,U,G)-O)/j}return B}(O,Y,B,G):0===K?Y:function(O,B,U,G,q){var j,W,Y=0;do{(j=o(W=B+(U-B)/2,G,q)-O)>0?U=W:B=W}while(Math.abs(j)>1e-7&&++Y<10);return W}(O,j,j+U,B,G)}},O}(),pooling={double:function(O){return O.concat(createSizedArray(O.length))}},poolFactory=function(O,B,U){var G=0,q=O,j=createSizedArray(q);return{newElement:function(){return G?j[G-=1]:B()},release:function(O){G===q&&(j=pooling.double(j),q*=2),U&&U(O),j[G]=O,G+=1}}},bezierLengthPool=poolFactory(8,(function(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}})),segmentsLengthPool=poolFactory(8,(function(){return{lengths:[],totalLength:0}}),(function(O){var B,U=O.lengths.length;for(B=0;B<U;B+=1)bezierLengthPool.release(O.lengths[B]);O.lengths.length=0}));function bezFunction(){var O=Math;function e(O,B,U,G,q,j){var W=O*G+B*q+U*j-q*G-j*O-U*B;return W>-.001&&W<.001}var r=function(O,B,U,G){var q,j,W,Y,K,Q,Z=getDefaultCurveSegments(),X=0,J=[],ee=[],te=bezierLengthPool.newElement();for(W=U.length,q=0;q<Z;q+=1){for(K=q/(Z-1),Q=0,j=0;j<W;j+=1)Y=bmPow(1-K,3)*O[j]+3*bmPow(1-K,2)*K*U[j]+3*(1-K)*bmPow(K,2)*G[j]+bmPow(K,3)*B[j],J[j]=Y,null!==ee[j]&&(Q+=bmPow(J[j]-ee[j],2)),ee[j]=J[j];Q&&(X+=Q=bmSqrt(Q)),te.percents[q]=K,te.lengths[q]=X}return te.addedLength=X,te};function i(O){this.segmentLength=0,this.points=new Array(O)}function s(O,B){this.partialLength=O,this.point=B}var B,U=(B={},function(O,U,G,q){var j=(O[0]+"_"+O[1]+"_"+U[0]+"_"+U[1]+"_"+G[0]+"_"+G[1]+"_"+q[0]+"_"+q[1]).replace(/\./g,"p");if(!B[j]){var W,Y,K,Q,Z,X,J,ee=getDefaultCurveSegments(),te=0,ie=null;2===O.length&&(O[0]!==U[0]||O[1]!==U[1])&&e(O[0],O[1],U[0],U[1],O[0]+G[0],O[1]+G[1])&&e(O[0],O[1],U[0],U[1],U[0]+q[0],U[1]+q[1])&&(ee=2);var re=new i(ee);for(K=G.length,W=0;W<ee;W+=1){for(J=createSizedArray(K),Z=W/(ee-1),X=0,Y=0;Y<K;Y+=1)Q=bmPow(1-Z,3)*O[Y]+3*bmPow(1-Z,2)*Z*(O[Y]+G[Y])+3*(1-Z)*bmPow(Z,2)*(U[Y]+q[Y])+bmPow(Z,3)*U[Y],J[Y]=Q,null!==ie&&(X+=bmPow(J[Y]-ie[Y],2));te+=X=bmSqrt(X),re.points[W]=new s(X,J),ie=J}re.segmentLength=te,B[j]=re}return B[j]});function o(O,B){var U=B.percents,G=B.lengths,q=U.length,j=bmFloor((q-1)*O),W=O*B.addedLength,Y=0;if(j===q-1||0===j||W===G[j])return U[j];for(var K=G[j]>W?-1:1,Q=!0;Q;)if(G[j]<=W&&G[j+1]>W?(Y=(W-G[j])/(G[j+1]-G[j]),Q=!1):j+=K,j<0||j>=q-1){if(j===q-1)return U[j];Q=!1}return U[j]+(U[j+1]-U[j])*Y}var G=createTypedArray("float32",8);return{getSegmentsLength:function(O){var B,U=segmentsLengthPool.newElement(),G=O.c,q=O.v,j=O.o,W=O.i,Y=O._length,K=U.lengths,Q=0;for(B=0;B<Y-1;B+=1)K[B]=r(q[B],q[B+1],j[B],W[B+1]),Q+=K[B].addedLength;return G&&Y&&(K[B]=r(q[B],q[0],j[B],W[0]),Q+=K[B].addedLength),U.totalLength=Q,U},getNewSegment:function(B,U,q,j,W,Y,K){W<0?W=0:W>1&&(W=1);var Q,Z=o(W,K),X=o(Y=Y>1?1:Y,K),J=B.length,ee=1-Z,te=1-X,ie=ee*ee*ee,re=Z*ee*ee*3,ne=Z*Z*ee*3,oe=Z*Z*Z,ae=ee*ee*te,se=Z*ee*te+ee*Z*te+ee*ee*X,le=Z*Z*te+ee*Z*X+Z*ee*X,ce=Z*Z*X,de=ee*te*te,pe=Z*te*te+ee*X*te+ee*te*X,ue=Z*X*te+ee*X*X+Z*te*X,he=Z*X*X,me=te*te*te,ge=X*te*te+te*X*te+te*te*X,fe=X*X*te+te*X*X+X*te*X,ye=X*X*X;for(Q=0;Q<J;Q+=1)G[4*Q]=O.round(1e3*(ie*B[Q]+re*q[Q]+ne*j[Q]+oe*U[Q]))/1e3,G[4*Q+1]=O.round(1e3*(ae*B[Q]+se*q[Q]+le*j[Q]+ce*U[Q]))/1e3,G[4*Q+2]=O.round(1e3*(de*B[Q]+pe*q[Q]+ue*j[Q]+he*U[Q]))/1e3,G[4*Q+3]=O.round(1e3*(me*B[Q]+ge*q[Q]+fe*j[Q]+ye*U[Q]))/1e3;return G},getPointInSegment:function(B,U,G,q,j,W){var Y=o(j,W),K=1-Y;return[O.round(1e3*(K*K*K*B[0]+(Y*K*K+K*Y*K+K*K*Y)*G[0]+(Y*Y*K+K*Y*Y+Y*K*Y)*q[0]+Y*Y*Y*U[0]))/1e3,O.round(1e3*(K*K*K*B[1]+(Y*K*K+K*Y*K+K*K*Y)*G[1]+(Y*Y*K+K*Y*Y+Y*K*Y)*q[1]+Y*Y*Y*U[1]))/1e3]},buildBezierData:U,pointOnLine2D:e,pointOnLine3D:function(B,U,G,q,j,W,Y,K,Q){if(0===G&&0===W&&0===Q)return e(B,U,q,j,Y,K);var Z,X=O.sqrt(O.pow(q-B,2)+O.pow(j-U,2)+O.pow(W-G,2)),J=O.sqrt(O.pow(Y-B,2)+O.pow(K-U,2)+O.pow(Q-G,2)),ee=O.sqrt(O.pow(Y-q,2)+O.pow(K-j,2)+O.pow(Q-W,2));return(Z=X>J?X>ee?X-J-ee:ee-J-X:ee>J?ee-J-X:J-X-ee)>-1e-4&&Z<1e-4}}}var bez=bezFunction(),PropertyFactory=function(){var O=initialDefaultFrame,B=Math.abs;function r(O,B){var U,G=this.offsetTime;"multidimensional"===this.propType&&(U=createTypedArray("float32",this.pv.length));for(var q,j,W,Y,K,Q,Z,X,J,ee=B.lastIndex,te=ee,ie=this.keyframes.length-1,re=!0;re;){if(q=this.keyframes[te],j=this.keyframes[te+1],te===ie-1&&O>=j.t-G){q.h&&(q=j),ee=0;break}if(j.t-G>O){ee=te;break}te<ie-1?te+=1:(ee=0,re=!1)}W=this.keyframesMetadata[te]||{};var ne,oe,ae,se,le,ce,de,pe,ue,he,me=j.t-G,ge=q.t-G;if(q.to){W.bezierData||(W.bezierData=bez.buildBezierData(q.s,j.s||q.e,q.to,q.ti));var fe=W.bezierData;if(O>=me||O<ge){var ye=O>=me?fe.points.length-1:0;for(K=fe.points[ye].point.length,Y=0;Y<K;Y+=1)U[Y]=fe.points[ye].point[Y]}else{W.__fnct?J=W.__fnct:(J=BezierFactory.getBezierEasing(q.o.x,q.o.y,q.i.x,q.i.y,q.n).get,W.__fnct=J),Q=J((O-ge)/(me-ge));var _e,ve=fe.segmentLength*Q,be=B.lastFrame<O&&B._lastKeyframeIndex===te?B._lastAddedLength:0;for(X=B.lastFrame<O&&B._lastKeyframeIndex===te?B._lastPoint:0,re=!0,Z=fe.points.length;re;){if(be+=fe.points[X].partialLength,0===ve||0===Q||X===fe.points.length-1){for(K=fe.points[X].point.length,Y=0;Y<K;Y+=1)U[Y]=fe.points[X].point[Y];break}if(ve>=be&&ve<be+fe.points[X+1].partialLength){for(_e=(ve-be)/fe.points[X+1].partialLength,K=fe.points[X].point.length,Y=0;Y<K;Y+=1)U[Y]=fe.points[X].point[Y]+(fe.points[X+1].point[Y]-fe.points[X].point[Y])*_e;break}X<Z-1?X+=1:re=!1}B._lastPoint=X,B._lastAddedLength=be-fe.points[X].partialLength,B._lastKeyframeIndex=te}}else{var Se,Ce,Ee,xe,Te;if(ie=q.s.length,ne=j.s||q.e,this.sh&&1!==q.h)if(O>=me)U[0]=ne[0],U[1]=ne[1],U[2]=ne[2];else if(O<=ge)U[0]=q.s[0],U[1]=q.s[1],U[2]=q.s[2];else{oe=U,ae=function(O,B,U){var G,q,j,W,Y,K=[],Q=O[0],Z=O[1],X=O[2],J=O[3],ee=B[0],te=B[1],ie=B[2],re=B[3];return(q=Q*ee+Z*te+X*ie+J*re)<0&&(q=-q,ee=-ee,te=-te,ie=-ie,re=-re),1-q>1e-6?(G=Math.acos(q),j=Math.sin(G),W=Math.sin((1-U)*G)/j,Y=Math.sin(U*G)/j):(W=1-U,Y=U),K[0]=W*Q+Y*ee,K[1]=W*Z+Y*te,K[2]=W*X+Y*ie,K[3]=W*J+Y*re,K}(i(q.s),i(ne),(O-ge)/(me-ge)),se=ae[0],le=ae[1],ce=ae[2],de=ae[3],pe=Math.atan2(2*le*de-2*se*ce,1-2*le*le-2*ce*ce),ue=Math.asin(2*se*le+2*ce*de),he=Math.atan2(2*se*de-2*le*ce,1-2*se*se-2*ce*ce),oe[0]=pe/degToRads,oe[1]=ue/degToRads,oe[2]=he/degToRads}else for(te=0;te<ie;te+=1)1!==q.h&&(O>=me?Q=1:O<ge?Q=0:(q.o.x.constructor===Array?(W.__fnct||(W.__fnct=[]),W.__fnct[te]?J=W.__fnct[te]:(Se=void 0===q.o.x[te]?q.o.x[0]:q.o.x[te],Ce=void 0===q.o.y[te]?q.o.y[0]:q.o.y[te],Ee=void 0===q.i.x[te]?q.i.x[0]:q.i.x[te],xe=void 0===q.i.y[te]?q.i.y[0]:q.i.y[te],J=BezierFactory.getBezierEasing(Se,Ce,Ee,xe).get,W.__fnct[te]=J)):W.__fnct?J=W.__fnct:(Se=q.o.x,Ce=q.o.y,Ee=q.i.x,xe=q.i.y,J=BezierFactory.getBezierEasing(Se,Ce,Ee,xe).get,q.keyframeMetadata=J),Q=J((O-ge)/(me-ge)))),ne=j.s||q.e,Te=1===q.h?q.s[te]:q.s[te]+(ne[te]-q.s[te])*Q,"multidimensional"===this.propType?U[te]=Te:U=Te}return B.lastIndex=ee,U}function i(O){var B=O[0]*degToRads,U=O[1]*degToRads,G=O[2]*degToRads,q=Math.cos(B/2),j=Math.cos(U/2),W=Math.cos(G/2),Y=Math.sin(B/2),K=Math.sin(U/2),Q=Math.sin(G/2);return[Y*K*W+q*j*Q,Y*j*W+q*K*Q,q*K*W-Y*j*Q,q*j*W-Y*K*Q]}function s(){var B=this.comp.renderedFrame-this.offsetTime,U=this.keyframes[0].t-this.offsetTime,G=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(B===this._caching.lastFrame||this._caching.lastFrame!==O&&(this._caching.lastFrame>=G&&B>=G||this._caching.lastFrame<U&&B<U))){this._caching.lastFrame>=B&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var q=this.interpolateValue(B,this._caching);this.pv=q}return this._caching.lastFrame=B,this.pv}function a(O){var U;if("unidimensional"===this.propType)U=O*this.mult,B(this.v-U)>1e-5&&(this.v=U,this._mdf=!0);else for(var G=0,q=this.v.length;G<q;)U=O[G]*this.mult,B(this.v[G]-U)>1e-5&&(this.v[G]=U,this._mdf=!0),G+=1}function n(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var O;this.lock=!0,this._mdf=this._isFirstFrame;var B=this.effectsSequence.length,U=this.kf?this.pv:this.data.k;for(O=0;O<B;O+=1)U=this.effectsSequence[O](U);this.setVValue(U),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function o(O){this.effectsSequence.push(O),this.container.addDynamicProperty(this)}function h(O,B,U,G){this.propType="unidimensional",this.mult=U||1,this.data=B,this.v=U?B.k*U:B.k,this.pv=B.k,this._mdf=!1,this.elem=O,this.container=G,this.comp=O.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=n,this.setVValue=a,this.addEffect=o}function l(O,B,U,G){var q;this.propType="multidimensional",this.mult=U||1,this.data=B,this._mdf=!1,this.elem=O,this.container=G,this.comp=O.comp,this.k=!1,this.kf=!1,this.frameId=-1;var j=B.k.length;for(this.v=createTypedArray("float32",j),this.pv=createTypedArray("float32",j),this.vel=createTypedArray("float32",j),q=0;q<j;q+=1)this.v[q]=B.k[q]*this.mult,this.pv[q]=B.k[q];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=n,this.setVValue=a,this.addEffect=o}function p(B,U,G,q){this.propType="unidimensional",this.keyframes=U.k,this.keyframesMetadata=[],this.offsetTime=B.data.st,this.frameId=-1,this._caching={lastFrame:O,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=U,this.mult=G||1,this.elem=B,this.container=q,this.comp=B.comp,this.v=O,this.pv=O,this._isFirstFrame=!0,this.getValue=n,this.setVValue=a,this.interpolateValue=r,this.effectsSequence=[s.bind(this)],this.addEffect=o}function c(B,U,G,q){var j;this.propType="multidimensional";var W,Y,K,Q,Z=U.k.length;for(j=0;j<Z-1;j+=1)U.k[j].to&&U.k[j].s&&U.k[j+1]&&U.k[j+1].s&&(W=U.k[j].s,Y=U.k[j+1].s,K=U.k[j].to,Q=U.k[j].ti,(2===W.length&&(W[0]!==Y[0]||W[1]!==Y[1])&&bez.pointOnLine2D(W[0],W[1],Y[0],Y[1],W[0]+K[0],W[1]+K[1])&&bez.pointOnLine2D(W[0],W[1],Y[0],Y[1],Y[0]+Q[0],Y[1]+Q[1])||3===W.length&&(W[0]!==Y[0]||W[1]!==Y[1]||W[2]!==Y[2])&&bez.pointOnLine3D(W[0],W[1],W[2],Y[0],Y[1],Y[2],W[0]+K[0],W[1]+K[1],W[2]+K[2])&&bez.pointOnLine3D(W[0],W[1],W[2],Y[0],Y[1],Y[2],Y[0]+Q[0],Y[1]+Q[1],Y[2]+Q[2]))&&(U.k[j].to=null,U.k[j].ti=null),W[0]===Y[0]&&W[1]===Y[1]&&0===K[0]&&0===K[1]&&0===Q[0]&&0===Q[1]&&(2===W.length||W[2]===Y[2]&&0===K[2]&&0===Q[2])&&(U.k[j].to=null,U.k[j].ti=null));this.effectsSequence=[s.bind(this)],this.data=U,this.keyframes=U.k,this.keyframesMetadata=[],this.offsetTime=B.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=G||1,this.elem=B,this.container=q,this.comp=B.comp,this.getValue=n,this.setVValue=a,this.interpolateValue=r,this.frameId=-1;var X=U.k[0].s.length;for(this.v=createTypedArray("float32",X),this.pv=createTypedArray("float32",X),j=0;j<X;j+=1)this.v[j]=O,this.pv[j]=O;this._caching={lastFrame:O,lastIndex:0,value:createTypedArray("float32",X)},this.addEffect=o}var U={getProp:function(O,B,U,G,q){var j;if(B.k.length)if("number"==typeof B.k[0])j=new l(O,B,G,q);else switch(U){case 0:j=new p(O,B,G,q);break;case 1:j=new c(O,B,G,q)}else j=new h(O,B,G,q);return j.effectsSequence.length&&q.addDynamicProperty(j),j}};return U}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(O){-1===this.dynamicProperties.indexOf(O)&&(this.dynamicProperties.push(O),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){var O;this._mdf=!1;var B=this.dynamicProperties.length;for(O=0;O<B;O+=1)this.dynamicProperties[O].getValue(),this.dynamicProperties[O]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(O){this.container=O,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=poolFactory(8,(function(){return createTypedArray("float32",2)}));function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(O,B){this.c=O,this.setLength(B);for(var U=0;U<B;)this.v[U]=pointPool.newElement(),this.o[U]=pointPool.newElement(),this.i[U]=pointPool.newElement(),U+=1},ShapePath.prototype.setLength=function(O){for(;this._maxLength<O;)this.doubleArrayLength();this._length=O},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(O,B,U,G,q){var j;switch(this._length=Math.max(this._length,G+1),this._length>=this._maxLength&&this.doubleArrayLength(),U){case"v":j=this.v;break;case"i":j=this.i;break;case"o":j=this.o;break;default:j=[]}(!j[G]||j[G]&&!q)&&(j[G]=pointPool.newElement()),j[G][0]=O,j[G][1]=B},ShapePath.prototype.setTripleAt=function(O,B,U,G,q,j,W,Y){this.setXYAt(O,B,"v",W,Y),this.setXYAt(U,G,"o",W,Y),this.setXYAt(q,j,"i",W,Y)},ShapePath.prototype.reverse=function(){var O=new ShapePath;O.setPathData(this.c,this._length);var B=this.v,U=this.o,G=this.i,q=0;this.c&&(O.setTripleAt(B[0][0],B[0][1],G[0][0],G[0][1],U[0][0],U[0][1],0,!1),q=1);var j,W=this._length-1,Y=this._length;for(j=q;j<Y;j+=1)O.setTripleAt(B[W][0],B[W][1],G[W][0],G[W][1],U[W][0],U[W][1],j,!1),W-=1;return O},ShapePath.prototype.length=function(){return this._length};var shapePool=(factory=poolFactory(4,(function(){return new ShapePath}),(function(O){var B,U=O._length;for(B=0;B<U;B+=1)pointPool.release(O.v[B]),pointPool.release(O.i[B]),pointPool.release(O.o[B]),O.v[B]=null,O.i[B]=null,O.o[B]=null;O._length=0,O.c=!1})),factory.clone=function(O){var B,U=factory.newElement(),G=void 0===O._length?O.v.length:O._length;for(U.setLength(G),U.c=O.c,B=0;B<G;B+=1)U.setTripleAt(O.v[B][0],O.v[B][1],O.o[B][0],O.o[B][1],O.i[B][0],O.i[B][1],B);return U},factory),factory;function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(O){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=O,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var O;for(O=0;O<this._length;O+=1)shapePool.release(this.shapes[O]);this._length=0};var shapeCollectionPool=(ob={newShapeCollection:function(){return _length?pool[_length-=1]:new ShapeCollection},release:function(O){var B,U=O._length;for(B=0;B<U;B+=1)shapePool.release(O.shapes[B]);O._length=0,_length===_maxLength&&(pool=pooling.double(pool),_maxLength*=2),pool[_length]=O,_length+=1}},_length=0,_maxLength=4,pool=createSizedArray(_maxLength),ob),ob,_length,_maxLength,pool,ShapePropertyFactory=function(){var O=-999999;function e(O,B,U){var G,q,j,W,Y,K,Q,Z,X,J=U.lastIndex,ee=this.keyframes;if(O<ee[0].t-this.offsetTime)G=ee[0].s[0],j=!0,J=0;else if(O>=ee[ee.length-1].t-this.offsetTime)G=ee[ee.length-1].s?ee[ee.length-1].s[0]:ee[ee.length-2].e[0],j=!0;else{for(var te,ie,re,ne=J,oe=ee.length-1,ae=!0;ae&&(te=ee[ne],!((ie=ee[ne+1]).t-this.offsetTime>O));)ne<oe-1?ne+=1:ae=!1;if(re=this.keyframesMetadata[ne]||{},J=ne,!(j=1===te.h)){if(O>=ie.t-this.offsetTime)Z=1;else if(O<te.t-this.offsetTime)Z=0;else{var se;re.__fnct?se=re.__fnct:(se=BezierFactory.getBezierEasing(te.o.x,te.o.y,te.i.x,te.i.y).get,re.__fnct=se),Z=se((O-(te.t-this.offsetTime))/(ie.t-this.offsetTime-(te.t-this.offsetTime)))}q=ie.s?ie.s[0]:te.e[0]}G=te.s[0]}for(K=B._length,Q=G.i[0].length,U.lastIndex=J,W=0;W<K;W+=1)for(Y=0;Y<Q;Y+=1)X=j?G.i[W][Y]:G.i[W][Y]+(q.i[W][Y]-G.i[W][Y])*Z,B.i[W][Y]=X,X=j?G.o[W][Y]:G.o[W][Y]+(q.o[W][Y]-G.o[W][Y])*Z,B.o[W][Y]=X,X=j?G.v[W][Y]:G.v[W][Y]+(q.v[W][Y]-G.v[W][Y])*Z,B.v[W][Y]=X}function r(){var B=this.comp.renderedFrame-this.offsetTime,U=this.keyframes[0].t-this.offsetTime,G=this.keyframes[this.keyframes.length-1].t-this.offsetTime,q=this._caching.lastFrame;return q!==O&&(q<U&&B<U||q>G&&B>G)||(this._caching.lastIndex=q<B?this._caching.lastIndex:0,this.interpolateShape(B,this.pv,this._caching)),this._caching.lastFrame=B,this.pv}function i(){this.paths=this.localShapeCollection}function s(O){(function(O,B){if(O._length!==B._length||O.c!==B.c)return!1;var U,G=O._length;for(U=0;U<G;U+=1)if(O.v[U][0]!==B.v[U][0]||O.v[U][1]!==B.v[U][1]||O.o[U][0]!==B.o[U][0]||O.o[U][1]!==B.o[U][1]||O.i[U][0]!==B.i[U][0]||O.i[U][1]!==B.i[U][1])return!1;return!0})(this.v,O)||(this.v=shapePool.clone(O),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function a(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var O,B;this.lock=!0,this._mdf=!1,O=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k;var U=this.effectsSequence.length;for(B=0;B<U;B+=1)O=this.effectsSequence[B](O);this.setVValue(O),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function n(O,B,U){this.propType="shape",this.comp=O.comp,this.container=O,this.elem=O,this.data=B,this.k=!1,this.kf=!1,this._mdf=!1;var G=3===U?B.pt.k:B.ks.k;this.v=shapePool.clone(G),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=i,this.effectsSequence=[]}function o(O){this.effectsSequence.push(O),this.container.addDynamicProperty(this)}function h(B,U,G){this.propType="shape",this.comp=B.comp,this.elem=B,this.container=B,this.offsetTime=B.data.st,this.keyframes=3===G?U.pt.k:U.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var q=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,q),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=O,this.reset=i,this._caching={lastFrame:O,lastIndex:0},this.effectsSequence=[r.bind(this)]}n.prototype.interpolateShape=e,n.prototype.getValue=a,n.prototype.setVValue=s,n.prototype.addEffect=o,h.prototype.getValue=a,h.prototype.interpolateShape=e,h.prototype.setVValue=s,h.prototype.addEffect=o;var B=function(){var O=roundCorner;function e(O,B){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=B.d,this.elem=O,this.comp=O.comp,this.frameId=-1,this.initDynamicPropertyContainer(O),this.p=PropertyFactory.getProp(O,B.p,1,0,this),this.s=PropertyFactory.getProp(O,B.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return e.prototype={reset:i,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var B=this.p.v[0],U=this.p.v[1],G=this.s.v[0]/2,q=this.s.v[1]/2,j=3!==this.d,W=this.v;W.v[0][0]=B,W.v[0][1]=U-q,W.v[1][0]=j?B+G:B-G,W.v[1][1]=U,W.v[2][0]=B,W.v[2][1]=U+q,W.v[3][0]=j?B-G:B+G,W.v[3][1]=U,W.i[0][0]=j?B-G*O:B+G*O,W.i[0][1]=U-q,W.i[1][0]=j?B+G:B-G,W.i[1][1]=U-q*O,W.i[2][0]=j?B+G*O:B-G*O,W.i[2][1]=U+q,W.i[3][0]=j?B-G:B+G,W.i[3][1]=U+q*O,W.o[0][0]=j?B+G*O:B-G*O,W.o[0][1]=U-q,W.o[1][0]=j?B+G:B-G,W.o[1][1]=U+q*O,W.o[2][0]=j?B-G*O:B+G*O,W.o[2][1]=U+q,W.o[3][0]=j?B-G:B+G,W.o[3][1]=U-q*O}},extendPrototype([DynamicPropertyContainer],e),e}(),U=function(){function t(O,B){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=O,this.comp=O.comp,this.data=B,this.frameId=-1,this.d=B.d,this.initDynamicPropertyContainer(O),1===B.sy?(this.ir=PropertyFactory.getProp(O,B.ir,0,0,this),this.is=PropertyFactory.getProp(O,B.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(O,B.pt,0,0,this),this.p=PropertyFactory.getProp(O,B.p,1,0,this),this.r=PropertyFactory.getProp(O,B.r,0,degToRads,this),this.or=PropertyFactory.getProp(O,B.or,0,0,this),this.os=PropertyFactory.getProp(O,B.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return t.prototype={reset:i,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var O,B,U,G,q=2*Math.floor(this.pt.v),j=2*Math.PI/q,W=!0,Y=this.or.v,K=this.ir.v,Q=this.os.v,Z=this.is.v,X=2*Math.PI*Y/(2*q),J=2*Math.PI*K/(2*q),ee=-Math.PI/2;ee+=this.r.v;var te=3===this.data.d?-1:1;for(this.v._length=0,O=0;O<q;O+=1){U=W?Q:Z,G=W?X:J;var ie=(B=W?Y:K)*Math.cos(ee),re=B*Math.sin(ee),ne=0===ie&&0===re?0:re/Math.sqrt(ie*ie+re*re),oe=0===ie&&0===re?0:-ie/Math.sqrt(ie*ie+re*re);ie+=+this.p.v[0],re+=+this.p.v[1],this.v.setTripleAt(ie,re,ie-ne*G*U*te,re-oe*G*U*te,ie+ne*G*U*te,re+oe*G*U*te,O,!0),W=!W,ee+=j*te}},convertPolygonToPath:function(){var O,B=Math.floor(this.pt.v),U=2*Math.PI/B,G=this.or.v,q=this.os.v,j=2*Math.PI*G/(4*B),W=.5*-Math.PI,Y=3===this.data.d?-1:1;for(W+=this.r.v,this.v._length=0,O=0;O<B;O+=1){var K=G*Math.cos(W),Q=G*Math.sin(W),Z=0===K&&0===Q?0:Q/Math.sqrt(K*K+Q*Q),X=0===K&&0===Q?0:-K/Math.sqrt(K*K+Q*Q);K+=+this.p.v[0],Q+=+this.p.v[1],this.v.setTripleAt(K,Q,K-Z*j*q*Y,Q-X*j*q*Y,K+Z*j*q*Y,Q+X*j*q*Y,O,!0),W+=U*Y}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],t),t}(),G=function(){function t(O,B){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=O,this.comp=O.comp,this.frameId=-1,this.d=B.d,this.initDynamicPropertyContainer(O),this.p=PropertyFactory.getProp(O,B.p,1,0,this),this.s=PropertyFactory.getProp(O,B.s,1,0,this),this.r=PropertyFactory.getProp(O,B.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return t.prototype={convertRectToPath:function(){var O=this.p.v[0],B=this.p.v[1],U=this.s.v[0]/2,G=this.s.v[1]/2,q=bmMin(U,G,this.r.v),j=q*(1-roundCorner);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(O+U,B-G+q,O+U,B-G+q,O+U,B-G+j,0,!0),this.v.setTripleAt(O+U,B+G-q,O+U,B+G-j,O+U,B+G-q,1,!0),0!==q?(this.v.setTripleAt(O+U-q,B+G,O+U-q,B+G,O+U-j,B+G,2,!0),this.v.setTripleAt(O-U+q,B+G,O-U+j,B+G,O-U+q,B+G,3,!0),this.v.setTripleAt(O-U,B+G-q,O-U,B+G-q,O-U,B+G-j,4,!0),this.v.setTripleAt(O-U,B-G+q,O-U,B-G+j,O-U,B-G+q,5,!0),this.v.setTripleAt(O-U+q,B-G,O-U+q,B-G,O-U+j,B-G,6,!0),this.v.setTripleAt(O+U-q,B-G,O+U-j,B-G,O+U-q,B-G,7,!0)):(this.v.setTripleAt(O-U,B+G,O-U+j,B+G,O-U,B+G,2),this.v.setTripleAt(O-U,B-G,O-U,B-G+j,O-U,B-G,3))):(this.v.setTripleAt(O+U,B-G+q,O+U,B-G+j,O+U,B-G+q,0,!0),0!==q?(this.v.setTripleAt(O+U-q,B-G,O+U-q,B-G,O+U-j,B-G,1,!0),this.v.setTripleAt(O-U+q,B-G,O-U+j,B-G,O-U+q,B-G,2,!0),this.v.setTripleAt(O-U,B-G+q,O-U,B-G+q,O-U,B-G+j,3,!0),this.v.setTripleAt(O-U,B+G-q,O-U,B+G-j,O-U,B+G-q,4,!0),this.v.setTripleAt(O-U+q,B+G,O-U+q,B+G,O-U+j,B+G,5,!0),this.v.setTripleAt(O+U-q,B+G,O+U-j,B+G,O+U-q,B+G,6,!0),this.v.setTripleAt(O+U,B+G-q,O+U,B+G-q,O+U,B+G-j,7,!0)):(this.v.setTripleAt(O-U,B-G,O-U+j,B-G,O-U,B-G,1,!0),this.v.setTripleAt(O-U,B+G,O-U,B+G-j,O-U,B+G,2,!0),this.v.setTripleAt(O+U,B+G,O+U-j,B+G,O+U,B+G,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:i},extendPrototype([DynamicPropertyContainer],t),t}(),q={getShapeProp:function(O,q,j){var W;return 3===j||4===j?W=(3===j?q.pt:q.ks).k.length?new h(O,q,j):new n(O,q,j):5===j?W=new G(O,q):6===j?W=new B(O,q):7===j&&(W=new U(O,q)),W.k&&O.addDynamicProperty(W),W},getConstructorFunction:function(){return n},getKeyframedConstructorFunction:function(){return h}};return q}(),Matrix=function(){var O=Math.cos,B=Math.sin,U=Math.tan,G=Math.round;function s(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function a(U){if(0===U)return this;var G=O(U),q=B(U);return this._t(G,-q,0,0,q,G,0,0,0,0,1,0,0,0,0,1)}function n(U){if(0===U)return this;var G=O(U),q=B(U);return this._t(1,0,0,0,0,G,-q,0,0,q,G,0,0,0,0,1)}function o(U){if(0===U)return this;var G=O(U),q=B(U);return this._t(G,0,q,0,0,1,0,0,-q,0,G,0,0,0,0,1)}function h(U){if(0===U)return this;var G=O(U),q=B(U);return this._t(G,-q,0,0,q,G,0,0,0,0,1,0,0,0,0,1)}function l(O,B){return this._t(1,B,O,1,0,0)}function p(O,B){return this.shear(U(O),U(B))}function c(G,q){var j=O(q),W=B(q);return this._t(j,W,0,0,-W,j,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,U(G),1,0,0,0,0,1,0,0,0,0,1)._t(j,-W,0,0,W,j,0,0,0,0,1,0,0,0,0,1)}function f(O,B,U){return U||0===U||(U=1),1===O&&1===B&&1===U?this:this._t(O,0,0,0,0,B,0,0,0,0,U,0,0,0,0,1)}function d(O,B,U,G,q,j,W,Y,K,Q,Z,X,J,ee,te,ie){return this.props[0]=O,this.props[1]=B,this.props[2]=U,this.props[3]=G,this.props[4]=q,this.props[5]=j,this.props[6]=W,this.props[7]=Y,this.props[8]=K,this.props[9]=Q,this.props[10]=Z,this.props[11]=X,this.props[12]=J,this.props[13]=ee,this.props[14]=te,this.props[15]=ie,this}function u(O,B,U){return U=U||0,0!==O||0!==B||0!==U?this._t(1,0,0,0,0,1,0,0,0,0,1,0,O,B,U,1):this}function m(O,B,U,G,q,j,W,Y,K,Q,Z,X,J,ee,te,ie){var re=this.props;if(1===O&&0===B&&0===U&&0===G&&0===q&&1===j&&0===W&&0===Y&&0===K&&0===Q&&1===Z&&0===X)return re[12]=re[12]*O+re[15]*J,re[13]=re[13]*j+re[15]*ee,re[14]=re[14]*Z+re[15]*te,re[15]*=ie,this._identityCalculated=!1,this;var ne=re[0],oe=re[1],ae=re[2],se=re[3],le=re[4],ce=re[5],de=re[6],pe=re[7],ue=re[8],he=re[9],me=re[10],ge=re[11],fe=re[12],ye=re[13],_e=re[14],ve=re[15];return re[0]=ne*O+oe*q+ae*K+se*J,re[1]=ne*B+oe*j+ae*Q+se*ee,re[2]=ne*U+oe*W+ae*Z+se*te,re[3]=ne*G+oe*Y+ae*X+se*ie,re[4]=le*O+ce*q+de*K+pe*J,re[5]=le*B+ce*j+de*Q+pe*ee,re[6]=le*U+ce*W+de*Z+pe*te,re[7]=le*G+ce*Y+de*X+pe*ie,re[8]=ue*O+he*q+me*K+ge*J,re[9]=ue*B+he*j+me*Q+ge*ee,re[10]=ue*U+he*W+me*Z+ge*te,re[11]=ue*G+he*Y+me*X+ge*ie,re[12]=fe*O+ye*q+_e*K+ve*J,re[13]=fe*B+ye*j+_e*Q+ve*ee,re[14]=fe*U+ye*W+_e*Z+ve*te,re[15]=fe*G+ye*Y+_e*X+ve*ie,this._identityCalculated=!1,this}function y(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function g(O){for(var B=0;B<16;){if(O.props[B]!==this.props[B])return!1;B+=1}return!0}function v(O){var B;for(B=0;B<16;B+=1)O.props[B]=this.props[B];return O}function b(O){var B;for(B=0;B<16;B+=1)this.props[B]=O[B]}function _(O,B,U){return{x:O*this.props[0]+B*this.props[4]+U*this.props[8]+this.props[12],y:O*this.props[1]+B*this.props[5]+U*this.props[9]+this.props[13],z:O*this.props[2]+B*this.props[6]+U*this.props[10]+this.props[14]}}function P(O,B,U){return O*this.props[0]+B*this.props[4]+U*this.props[8]+this.props[12]}function E(O,B,U){return O*this.props[1]+B*this.props[5]+U*this.props[9]+this.props[13]}function S(O,B,U){return O*this.props[2]+B*this.props[6]+U*this.props[10]+this.props[14]}function x(){var O=this.props[0]*this.props[5]-this.props[1]*this.props[4],B=this.props[5]/O,U=-this.props[1]/O,G=-this.props[4]/O,q=this.props[0]/O,j=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/O,W=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/O,Y=new Matrix;return Y.props[0]=B,Y.props[1]=U,Y.props[4]=G,Y.props[5]=q,Y.props[12]=j,Y.props[13]=W,Y}function A(O){return this.getInverseMatrix().applyToPointArray(O[0],O[1],O[2]||0)}function w(O){var B,U=O.length,G=[];for(B=0;B<U;B+=1)G[B]=A(O[B]);return G}function C(O,B,U){var G=createTypedArray("float32",6);if(this.isIdentity())G[0]=O[0],G[1]=O[1],G[2]=B[0],G[3]=B[1],G[4]=U[0],G[5]=U[1];else{var q=this.props[0],j=this.props[1],W=this.props[4],Y=this.props[5],K=this.props[12],Q=this.props[13];G[0]=O[0]*q+O[1]*W+K,G[1]=O[0]*j+O[1]*Y+Q,G[2]=B[0]*q+B[1]*W+K,G[3]=B[0]*j+B[1]*Y+Q,G[4]=U[0]*q+U[1]*W+K,G[5]=U[0]*j+U[1]*Y+Q}return G}function k(O,B,U){return this.isIdentity()?[O,B,U]:[O*this.props[0]+B*this.props[4]+U*this.props[8]+this.props[12],O*this.props[1]+B*this.props[5]+U*this.props[9]+this.props[13],O*this.props[2]+B*this.props[6]+U*this.props[10]+this.props[14]]}function T(O,B){if(this.isIdentity())return O+","+B;var U=this.props;return Math.round(100*(O*U[0]+B*U[4]+U[12]))/100+","+Math.round(100*(O*U[1]+B*U[5]+U[13]))/100}function D(){for(var O=0,B=this.props,U="matrix3d(";O<16;)U+=G(1e4*B[O])/1e4,U+=15===O?")":",",O+=1;return U}function M(O){return O<1e-6&&O>0||O>-1e-6&&O<0?G(1e4*O)/1e4:O}function F(){var O=this.props;return"matrix("+M(O[0])+","+M(O[1])+","+M(O[4])+","+M(O[5])+","+M(O[12])+","+M(O[13])+")"}return function(){this.reset=s,this.rotate=a,this.rotateX=n,this.rotateY=o,this.rotateZ=h,this.skew=p,this.skewFromAxis=c,this.shear=l,this.scale=f,this.setTransform=d,this.translate=u,this.transform=m,this.applyToPoint=_,this.applyToX=P,this.applyToY=E,this.applyToZ=S,this.applyToPointArray=k,this.applyToTriplePoints=C,this.applyToPointStringified=T,this.toCSS=D,this.to2dCSS=F,this.clone=v,this.cloneFromProps=b,this.equals=g,this.inversePoints=w,this.inversePoint=A,this.getInverseMatrix=x,this._t=this.transform,this.isIdentity=y,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(O){return _typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_typeof$3(O)}var lottie={},standalone="__[STANDALONE]__",animationData="__[ANIMATIONDATA]__",renderer="";function setLocation(O){setLocationHref(O)}function searchAnimations(){!0===standalone?animationManager.searchAnimations(animationData,standalone,renderer):animationManager.searchAnimations()}function setSubframeRendering(O){setSubframeEnabled(O)}function setPrefix(O){setIdPrefix(O)}function loadAnimation(O){return!0===standalone&&(O.animationData=JSON.parse(animationData)),animationManager.loadAnimation(O)}function setQuality(O){if("string"==typeof O)switch(O){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10)}else!isNaN(O)&&O>1&&setDefaultCurveSegments(O);getDefaultCurveSegments()>=50?roundValues(!1):roundValues(!0)}function inBrowser(){return"undefined"!=typeof navigator}function installPlugin(O,B){"expressions"===O&&setExpressionsPlugin(B)}function getFactory(O){switch(O){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}function checkReady(){"complete"===document.readyState&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(O){for(var B=queryString.split("&"),U=0;U<B.length;U+=1){var G=B[U].split("=");if(decodeURIComponent(G[0])==O)return decodeURIComponent(G[1])}return null}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.10.0";var queryString="";if(standalone){var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",renderer=getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{"object"!==_typeof$3(exports)&&(window.bodymovin=lottie)}catch(O){}var ShapeModifiers=function(){var O={},B={};return O.registerModifier=function(O,U){B[O]||(B[O]=U)},O.getModifier=function(O,U,G){return new B[O](U,G)},O}();function ShapeModifier(){}function TrimModifier(){}function PuckerAndBloatModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(O){if(!this.closed){O.sh.container.addDynamicProperty(O.sh);var B={shape:O.sh,data:O,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(B),this.addShapeToModifier(B),this._isAnimated&&O.setAsAnimated()}},ShapeModifier.prototype.init=function(O,B){this.shapes=[],this.elem=O,this.initDynamicPropertyContainer(O),this.initModifierProperties(O,B),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(O,B){this.s=PropertyFactory.getProp(O,B.s,0,.01,this),this.e=PropertyFactory.getProp(O,B.e,0,.01,this),this.o=PropertyFactory.getProp(O,B.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=B.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(O){O.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(O,B,U,G,q){var j=[];B<=1?j.push({s:O,e:B}):O>=1?j.push({s:O-1,e:B-1}):(j.push({s:O,e:1}),j.push({s:0,e:B-1}));var W,Y,K=[],Q=j.length;for(W=0;W<Q;W+=1){var Z,X;(Y=j[W]).e*q<G||Y.s*q>G+U||(Z=Y.s*q<=G?0:(Y.s*q-G)/U,X=Y.e*q>=G+U?1:(Y.e*q-G)/U,K.push([Z,X]))}return K.length||K.push([0,0]),K},TrimModifier.prototype.releasePathsData=function(O){var B,U=O.length;for(B=0;B<U;B+=1)segmentsLengthPool.release(O[B]);return O.length=0,O},TrimModifier.prototype.processShapes=function(O){var B,U,G,q;if(this._mdf||O){var j=this.o.v%360/360;if(j<0&&(j+=1),(B=this.s.v>1?1+j:this.s.v<0?0+j:this.s.v+j)>(U=this.e.v>1?1+j:this.e.v<0?0+j:this.e.v+j)){var W=B;B=U,U=W}B=1e-4*Math.round(1e4*B),U=1e-4*Math.round(1e4*U),this.sValue=B,this.eValue=U}else B=this.sValue,U=this.eValue;var Y,K,Q,Z,X,J=this.shapes.length,ee=0;if(U===B)for(q=0;q<J;q+=1)this.shapes[q].localShapeCollection.releaseShapes(),this.shapes[q].shape._mdf=!0,this.shapes[q].shape.paths=this.shapes[q].localShapeCollection,this._mdf&&(this.shapes[q].pathsData.length=0);else if(1===U&&0===B||0===U&&1===B){if(this._mdf)for(q=0;q<J;q+=1)this.shapes[q].pathsData.length=0,this.shapes[q].shape._mdf=!0}else{var te,ie,re=[];for(q=0;q<J;q+=1)if((te=this.shapes[q]).shape._mdf||this._mdf||O||2===this.m){if(K=(G=te.shape.paths)._length,X=0,!te.shape._mdf&&te.pathsData.length)X=te.totalShapeLength;else{for(Q=this.releasePathsData(te.pathsData),Y=0;Y<K;Y+=1)Z=bez.getSegmentsLength(G.shapes[Y]),Q.push(Z),X+=Z.totalLength;te.totalShapeLength=X,te.pathsData=Q}ee+=X,te.shape._mdf=!0}else te.shape.paths=te.localShapeCollection;var ne,oe=B,ae=U,se=0;for(q=J-1;q>=0;q-=1)if((te=this.shapes[q]).shape._mdf){for((ie=te.localShapeCollection).releaseShapes(),2===this.m&&J>1?(ne=this.calculateShapeEdges(B,U,te.totalShapeLength,se,ee),se+=te.totalShapeLength):ne=[[oe,ae]],K=ne.length,Y=0;Y<K;Y+=1){oe=ne[Y][0],ae=ne[Y][1],re.length=0,ae<=1?re.push({s:te.totalShapeLength*oe,e:te.totalShapeLength*ae}):oe>=1?re.push({s:te.totalShapeLength*(oe-1),e:te.totalShapeLength*(ae-1)}):(re.push({s:te.totalShapeLength*oe,e:te.totalShapeLength}),re.push({s:0,e:te.totalShapeLength*(ae-1)}));var le=this.addShapes(te,re[0]);if(re[0].s!==re[0].e){if(re.length>1)if(te.shape.paths.shapes[te.shape.paths._length-1].c){var ce=le.pop();this.addPaths(le,ie),le=this.addShapes(te,re[1],ce)}else this.addPaths(le,ie),le=this.addShapes(te,re[1]);this.addPaths(le,ie)}}te.shape.paths=ie}}},TrimModifier.prototype.addPaths=function(O,B){var U,G=O.length;for(U=0;U<G;U+=1)B.addShape(O[U])},TrimModifier.prototype.addSegment=function(O,B,U,G,q,j,W){q.setXYAt(B[0],B[1],"o",j),q.setXYAt(U[0],U[1],"i",j+1),W&&q.setXYAt(O[0],O[1],"v",j),q.setXYAt(G[0],G[1],"v",j+1)},TrimModifier.prototype.addSegmentFromArray=function(O,B,U,G){B.setXYAt(O[1],O[5],"o",U),B.setXYAt(O[2],O[6],"i",U+1),G&&B.setXYAt(O[0],O[4],"v",U),B.setXYAt(O[3],O[7],"v",U+1)},TrimModifier.prototype.addShapes=function(O,B,U){var G,q,j,W,Y,K,Q,Z,X=O.pathsData,J=O.shape.paths.shapes,ee=O.shape.paths._length,te=0,ie=[],re=!0;for(U?(Y=U._length,Z=U._length):(U=shapePool.newElement(),Y=0,Z=0),ie.push(U),G=0;G<ee;G+=1){for(K=X[G].lengths,U.c=J[G].c,j=J[G].c?K.length:K.length+1,q=1;q<j;q+=1)if(te+(W=K[q-1]).addedLength<B.s)te+=W.addedLength,U.c=!1;else{if(te>B.e){U.c=!1;break}B.s<=te&&B.e>=te+W.addedLength?(this.addSegment(J[G].v[q-1],J[G].o[q-1],J[G].i[q],J[G].v[q],U,Y,re),re=!1):(Q=bez.getNewSegment(J[G].v[q-1],J[G].v[q],J[G].o[q-1],J[G].i[q],(B.s-te)/W.addedLength,(B.e-te)/W.addedLength,K[q-1]),this.addSegmentFromArray(Q,U,Y,re),re=!1,U.c=!1),te+=W.addedLength,Y+=1}if(J[G].c&&K.length){if(W=K[q-1],te<=B.e){var ne=K[q-1].addedLength;B.s<=te&&B.e>=te+ne?(this.addSegment(J[G].v[q-1],J[G].o[q-1],J[G].i[0],J[G].v[0],U,Y,re),re=!1):(Q=bez.getNewSegment(J[G].v[q-1],J[G].v[0],J[G].o[q-1],J[G].i[0],(B.s-te)/ne,(B.e-te)/ne,K[q-1]),this.addSegmentFromArray(Q,U,Y,re),re=!1,U.c=!1)}else U.c=!1;te+=W.addedLength,Y+=1}if(U._length&&(U.setXYAt(U.v[Z][0],U.v[Z][1],"i",Z),U.setXYAt(U.v[U._length-1][0],U.v[U._length-1][1],"o",U._length-1)),te>B.e)break;G<ee-1&&(U=shapePool.newElement(),re=!0,ie.push(U),Y=0)}return ie},extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(O,B){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(O,B.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(O,B){var U=B/100,G=[0,0],q=O._length,j=0;for(j=0;j<q;j+=1)G[0]+=O.v[j][0],G[1]+=O.v[j][1];G[0]/=q,G[1]/=q;var W,Y,K,Q,Z,X,J=shapePool.newElement();for(J.c=O.c,j=0;j<q;j+=1)W=O.v[j][0]+(G[0]-O.v[j][0])*U,Y=O.v[j][1]+(G[1]-O.v[j][1])*U,K=O.o[j][0]+(G[0]-O.o[j][0])*-U,Q=O.o[j][1]+(G[1]-O.o[j][1])*-U,Z=O.i[j][0]+(G[0]-O.i[j][0])*-U,X=O.i[j][1]+(G[1]-O.i[j][1])*-U,J.setTripleAt(W,Y,K,Q,Z,X,j);return J},PuckerAndBloatModifier.prototype.processShapes=function(O){var B,U,G,q,j,W,Y=this.shapes.length,K=this.amount.v;if(0!==K)for(U=0;U<Y;U+=1){if(W=(j=this.shapes[U]).localShapeCollection,j.shape._mdf||this._mdf||O)for(W.releaseShapes(),j.shape._mdf=!0,B=j.shape.paths.shapes,q=j.shape.paths._length,G=0;G<q;G+=1)W.addShape(this.processPath(B[G],K));j.shape.paths=j.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var O=[0,0];function e(O,B,U){if(this.elem=O,this.frameId=-1,this.propType="transform",this.data=B,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(U||O),B.p&&B.p.s?(this.px=PropertyFactory.getProp(O,B.p.x,0,0,this),this.py=PropertyFactory.getProp(O,B.p.y,0,0,this),B.p.z&&(this.pz=PropertyFactory.getProp(O,B.p.z,0,0,this))):this.p=PropertyFactory.getProp(O,B.p||{k:[0,0,0]},1,0,this),B.rx){if(this.rx=PropertyFactory.getProp(O,B.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(O,B.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(O,B.rz,0,degToRads,this),B.or.k[0].ti){var G,q=B.or.k.length;for(G=0;G<q;G+=1)B.or.k[G].to=null,B.or.k[G].ti=null}this.or=PropertyFactory.getProp(O,B.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(O,B.r||{k:0},0,degToRads,this);B.sk&&(this.sk=PropertyFactory.getProp(O,B.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(O,B.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(O,B.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(O,B.s||{k:[100,100,100]},1,.01,this),B.o?this.o=PropertyFactory.getProp(O,B.o,0,.01,O):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}return e.prototype={applyToMatrix:function(O){var B=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||B,this.a&&O.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&O.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&O.skewFromAxis(-this.sk.v,this.sa.v),this.r?O.rotate(-this.r.v):O.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?O.translate(this.px.v,this.py.v,-this.pz.v):O.translate(this.px.v,this.py.v,0):O.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(B){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||B){var U;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var G,q;if(U=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(G=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/U,0),q=this.p.getValueAtTime(this.p.keyframes[0].t/U,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(G=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/U,0),q=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/U,0)):(G=this.p.pv,q=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/U,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){G=[],q=[];var j=this.px,W=this.py;j._caching.lastFrame+j.offsetTime<=j.keyframes[0].t?(G[0]=j.getValueAtTime((j.keyframes[0].t+.01)/U,0),G[1]=W.getValueAtTime((W.keyframes[0].t+.01)/U,0),q[0]=j.getValueAtTime(j.keyframes[0].t/U,0),q[1]=W.getValueAtTime(W.keyframes[0].t/U,0)):j._caching.lastFrame+j.offsetTime>=j.keyframes[j.keyframes.length-1].t?(G[0]=j.getValueAtTime(j.keyframes[j.keyframes.length-1].t/U,0),G[1]=W.getValueAtTime(W.keyframes[W.keyframes.length-1].t/U,0),q[0]=j.getValueAtTime((j.keyframes[j.keyframes.length-1].t-.01)/U,0),q[1]=W.getValueAtTime((W.keyframes[W.keyframes.length-1].t-.01)/U,0)):(G=[j.pv,W.pv],q[0]=j.getValueAtTime((j._caching.lastFrame+j.offsetTime-.01)/U,j.offsetTime),q[1]=W.getValueAtTime((W._caching.lastFrame+W.offsetTime-.01)/U,W.offsetTime))}else G=q=O;this.v.rotate(-Math.atan2(G[1]-q[1],G[0]-q[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}},precalculateMatrix:function(){if(!this.a.k&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},extendPrototype([DynamicPropertyContainer],e),e.prototype.addDynamicProperty=function(O){this._addDynamicProperty(O),this.elem.addDynamicProperty(O),this._isDirty=!0},e.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:function(O,B,U){return new e(O,B,U)}}}();function RepeaterModifier(){}function RoundCornersModifier(){}function floatEqual(O,B){return 1e5*Math.abs(O-B)<=Math.min(Math.abs(O),Math.abs(B))}function floatZero(O){return Math.abs(O)<=1e-5}function lerp(O,B,U){return O*(1-U)+B*U}function lerpPoint(O,B,U){return[lerp(O[0],B[0],U),lerp(O[1],B[1],U)]}function quadRoots(O,B,U){if(0===O)return[];var G=B*B-4*O*U;if(G<0)return[];var q=-B/(2*O);if(0===G)return[q];var j=Math.sqrt(G)/(2*O);return[q-j,q+j]}function polynomialCoefficients(O,B,U,G){return[3*B-O-3*U+G,3*O-6*B+3*U,-3*O+3*B,O]}function singlePoint(O){return new PolynomialBezier(O,O,O,O,!1)}function PolynomialBezier(O,B,U,G,q){q&&pointEqual(O,B)&&(B=lerpPoint(O,G,1/3)),q&&pointEqual(U,G)&&(U=lerpPoint(O,G,2/3));var j=polynomialCoefficients(O[0],B[0],U[0],G[0]),W=polynomialCoefficients(O[1],B[1],U[1],G[1]);this.a=[j[0],W[0]],this.b=[j[1],W[1]],this.c=[j[2],W[2]],this.d=[j[3],W[3]],this.points=[O,B,U,G]}function extrema(O,B){var U=O.points[0][B],G=O.points[O.points.length-1][B];if(U>G){var q=G;G=U,U=q}for(var j=quadRoots(3*O.a[B],2*O.b[B],O.c[B]),W=0;W<j.length;W+=1)if(j[W]>0&&j[W]<1){var Y=O.point(j[W])[B];Y<U?U=Y:Y>G&&(G=Y)}return{min:U,max:G}}function intersectData(O,B,U){var G=O.boundingBox();return{cx:G.cx,cy:G.cy,width:G.width,height:G.height,bez:O,t:(B+U)/2,t1:B,t2:U}}function splitData(O){var B=O.bez.split(.5);return[intersectData(B[0],O.t1,O.t),intersectData(B[1],O.t,O.t2)]}function boxIntersect(O,B){return 2*Math.abs(O.cx-B.cx)<O.width+B.width&&2*Math.abs(O.cy-B.cy)<O.height+B.height}function intersectsImpl(O,B,U,G,q,j){if(boxIntersect(O,B))if(U>=j||O.width<=G&&O.height<=G&&B.width<=G&&B.height<=G)q.push([O.t,B.t]);else{var W=splitData(O),Y=splitData(B);intersectsImpl(W[0],Y[0],U+1,G,q,j),intersectsImpl(W[0],Y[1],U+1,G,q,j),intersectsImpl(W[1],Y[0],U+1,G,q,j),intersectsImpl(W[1],Y[1],U+1,G,q,j)}}function crossProduct(O,B){return[O[1]*B[2]-O[2]*B[1],O[2]*B[0]-O[0]*B[2],O[0]*B[1]-O[1]*B[0]]}function lineIntersection(O,B,U,G){var q=[O[0],O[1],1],j=[B[0],B[1],1],W=[U[0],U[1],1],Y=[G[0],G[1],1],K=crossProduct(crossProduct(q,j),crossProduct(W,Y));return floatZero(K[2])?null:[K[0]/K[2],K[1]/K[2]]}function polarOffset(O,B,U){return[O[0]+Math.cos(B)*U,O[1]-Math.sin(B)*U]}function pointDistance(O,B){return Math.hypot(O[0]-B[0],O[1]-B[1])}function pointEqual(O,B){return floatEqual(O[0],B[0])&&floatEqual(O[1],B[1])}function ZigZagModifier(){}function setPoint(O,B,U,G,q,j,W){var Y=U-Math.PI/2,K=U+Math.PI/2,Q=B[0]+Math.cos(U)*G*q,Z=B[1]-Math.sin(U)*G*q;O.setTripleAt(Q,Z,Q+Math.cos(Y)*j,Z-Math.sin(Y)*j,Q+Math.cos(K)*W,Z-Math.sin(K)*W,O.length())}function getPerpendicularVector(O,B){var U=[B[0]-O[0],B[1]-O[1]],G=.5*-Math.PI;return[Math.cos(G)*U[0]-Math.sin(G)*U[1],Math.sin(G)*U[0]+Math.cos(G)*U[1]]}function getProjectingAngle(O,B){var U=0===B?O.length()-1:B-1,G=(B+1)%O.length(),q=getPerpendicularVector(O.v[U],O.v[G]);return Math.atan2(0,1)-Math.atan2(q[1],q[0])}function zigZagCorner(O,B,U,G,q,j,W){var Y=getProjectingAngle(B,U),K=B.v[U%B._length],Q=B.v[0===U?B._length-1:U-1],Z=B.v[(U+1)%B._length],X=2===j?Math.sqrt(Math.pow(K[0]-Q[0],2)+Math.pow(K[1]-Q[1],2)):0,J=2===j?Math.sqrt(Math.pow(K[0]-Z[0],2)+Math.pow(K[1]-Z[1],2)):0;setPoint(O,B.v[U%B._length],Y,W,G,J/(2*(q+1)),X/(2*(q+1)),j)}function zigZagSegment(O,B,U,G,q,j){for(var W=0;W<G;W+=1){var Y=(W+1)/(G+1),K=2===q?Math.sqrt(Math.pow(B.points[3][0]-B.points[0][0],2)+Math.pow(B.points[3][1]-B.points[0][1],2)):0,Q=B.normalAngle(Y);setPoint(O,B.point(Y),Q,j,U,K/(2*(G+1)),K/(2*(G+1)),q),j=-j}return j}function linearOffset(O,B,U){var G=Math.atan2(B[0]-O[0],B[1]-O[1]);return[polarOffset(O,G,U),polarOffset(B,G,U)]}function offsetSegment(O,B){var U,G,q,j,W,Y,K;U=(K=linearOffset(O.points[0],O.points[1],B))[0],G=K[1],q=(K=linearOffset(O.points[1],O.points[2],B))[0],j=K[1],W=(K=linearOffset(O.points[2],O.points[3],B))[0],Y=K[1];var Q=lineIntersection(U,G,q,j);null===Q&&(Q=G);var Z=lineIntersection(W,Y,q,j);return null===Z&&(Z=W),new PolynomialBezier(U,Q,Z,Y)}function joinLines(O,B,U,G,q){var j=B.points[3],W=U.points[0];if(3===G)return j;if(pointEqual(j,W))return j;if(2===G){var Y=-B.tangentAngle(1),K=-U.tangentAngle(0)+Math.PI,Q=lineIntersection(j,polarOffset(j,Y+Math.PI/2,100),W,polarOffset(W,Y+Math.PI/2,100)),Z=Q?pointDistance(Q,j):pointDistance(j,W)/2,X=polarOffset(j,Y,2*Z*roundCorner);return O.setXYAt(X[0],X[1],"o",O.length()-1),X=polarOffset(W,K,2*Z*roundCorner),O.setTripleAt(W[0],W[1],W[0],W[1],X[0],X[1],O.length()),W}var J=lineIntersection(pointEqual(j,B.points[2])?B.points[0]:B.points[2],j,W,pointEqual(W,U.points[1])?U.points[3]:U.points[1]);return J&&pointDistance(J,j)<q?(O.setTripleAt(J[0],J[1],J[0],J[1],J[0],J[1],O.length()),J):j}function getIntersection(O,B){var U=O.intersections(B);return U.length&&floatEqual(U[0][0],1)&&U.shift(),U.length?U[0]:null}function pruneSegmentIntersection(O,B){var U=O.slice(),G=B.slice(),q=getIntersection(O[O.length-1],B[0]);return q&&(U[O.length-1]=O[O.length-1].split(q[0])[0],G[0]=B[0].split(q[1])[1]),O.length>1&&B.length>1&&(q=getIntersection(O[0],B[B.length-1]))?[[O[0].split(q[0])[0]],[B[B.length-1].split(q[1])[1]]]:[U,G]}function pruneIntersections(O){for(var B,U=1;U<O.length;U+=1)B=pruneSegmentIntersection(O[U-1],O[U]),O[U-1]=B[0],O[U]=B[1];return O.length>1&&(B=pruneSegmentIntersection(O[O.length-1],O[0]),O[O.length-1]=B[0],O[0]=B[1]),O}function offsetSegmentSplit(O,B){var U,G,q,j,W=O.inflectionPoints();if(0===W.length)return[offsetSegment(O,B)];if(1===W.length||floatEqual(W[1],1))return U=(q=O.split(W[0]))[0],G=q[1],[offsetSegment(U,B),offsetSegment(G,B)];U=(q=O.split(W[0]))[0];var Y=(W[1]-W[0])/(1-W[0]);return j=(q=q[1].split(Y))[0],G=q[1],[offsetSegment(U,B),offsetSegment(j,B),offsetSegment(G,B)]}function OffsetPathModifier(){}function getFontProperties(O){for(var B=O.fStyle?O.fStyle.split(" "):[],U="normal",G="normal",q=B.length,j=0;j<q;j+=1)switch(B[j].toLowerCase()){case"italic":G="italic";break;case"bold":U="700";break;case"black":U="900";break;case"medium":U="500";break;case"regular":case"normal":U="400";break;case"light":case"thin":U="200"}return{style:G,weight:O.fWeight||U}}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(O,B){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(O,B.c,0,null,this),this.o=PropertyFactory.getProp(O,B.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(O,B.tr,this),this.so=PropertyFactory.getProp(O,B.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(O,B.tr.eo,0,.01,this),this.data=B,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(O,B,U,G,q,j){var W=j?-1:1,Y=G.s.v[0]+(1-G.s.v[0])*(1-q),K=G.s.v[1]+(1-G.s.v[1])*(1-q);O.translate(G.p.v[0]*W*q,G.p.v[1]*W*q,G.p.v[2]),B.translate(-G.a.v[0],-G.a.v[1],G.a.v[2]),B.rotate(-G.r.v*W*q),B.translate(G.a.v[0],G.a.v[1],G.a.v[2]),U.translate(-G.a.v[0],-G.a.v[1],G.a.v[2]),U.scale(j?1/Y:Y,j?1/K:K),U.translate(G.a.v[0],G.a.v[1],G.a.v[2])},RepeaterModifier.prototype.init=function(O,B,U,G){for(this.elem=O,this.arr=B,this.pos=U,this.elemsData=G,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(O),this.initModifierProperties(O,B[U]);U>0;)U-=1,this._elements.unshift(B[U]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(O){var B,U=O.length;for(B=0;B<U;B+=1)O[B]._processed=!1,"gr"===O[B].ty&&this.resetElements(O[B].it)},RepeaterModifier.prototype.cloneElements=function(O){var B=JSON.parse(JSON.stringify(O));return this.resetElements(B),B},RepeaterModifier.prototype.changeGroupRender=function(O,B){var U,G=O.length;for(U=0;U<G;U+=1)O[U]._render=B,"gr"===O[U].ty&&this.changeGroupRender(O[U].it,B)},RepeaterModifier.prototype.processShapes=function(O){var B,U,G,q,j,W=!1;if(this._mdf||O){var Y,K=Math.ceil(this.c.v);if(this._groups.length<K){for(;this._groups.length<K;){var Q={it:this.cloneElements(this._elements),ty:"gr"};Q.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,Q),this._groups.splice(0,0,Q),this._currentCopies+=1}this.elem.reloadShapes(),W=!0}for(j=0,G=0;G<=this._groups.length-1;G+=1){if(Y=j<K,this._groups[G]._render=Y,this.changeGroupRender(this._groups[G].it,Y),!Y){var Z=this.elemsData[G].it,X=Z[Z.length-1];0!==X.transform.op.v?(X.transform.op._mdf=!0,X.transform.op.v=0):X.transform.op._mdf=!1}j+=1}this._currentCopies=K;var J=this.o.v,ee=J%1,te=J>0?Math.floor(J):Math.ceil(J),ie=this.pMatrix.props,re=this.rMatrix.props,ne=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var oe,ae,se=0;if(J>0){for(;se<te;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),se+=1;ee&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,ee,!1),se+=ee)}else if(J<0){for(;se>te;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),se-=1;ee&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-ee,!0),se-=ee)}for(G=1===this.data.m?0:this._currentCopies-1,q=1===this.data.m?1:-1,j=this._currentCopies;j;){if(ae=(U=(B=this.elemsData[G].it)[B.length-1].transform.mProps.v.props).length,B[B.length-1].transform.mProps._mdf=!0,B[B.length-1].transform.op._mdf=!0,B[B.length-1].transform.op.v=1===this._currentCopies?this.so.v:this.so.v+(this.eo.v-this.so.v)*(G/(this._currentCopies-1)),0!==se){for((0!==G&&1===q||G!==this._currentCopies-1&&-1===q)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(re[0],re[1],re[2],re[3],re[4],re[5],re[6],re[7],re[8],re[9],re[10],re[11],re[12],re[13],re[14],re[15]),this.matrix.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5],ne[6],ne[7],ne[8],ne[9],ne[10],ne[11],ne[12],ne[13],ne[14],ne[15]),this.matrix.transform(ie[0],ie[1],ie[2],ie[3],ie[4],ie[5],ie[6],ie[7],ie[8],ie[9],ie[10],ie[11],ie[12],ie[13],ie[14],ie[15]),oe=0;oe<ae;oe+=1)U[oe]=this.matrix.props[oe];this.matrix.reset()}else for(this.matrix.reset(),oe=0;oe<ae;oe+=1)U[oe]=this.matrix.props[oe];se+=1,j-=1,G+=q}}else for(j=this._currentCopies,G=0,q=1;j;)U=(B=this.elemsData[G].it)[B.length-1].transform.mProps.v.props,B[B.length-1].transform.mProps._mdf=!1,B[B.length-1].transform.op._mdf=!1,j-=1,G+=q;return W},RepeaterModifier.prototype.addShape=function(){},extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(O,B){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(O,B.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(O,B){var U,G=shapePool.newElement();G.c=O.c;var q,j,W,Y,K,Q,Z,X,J,ee,te,ie,re=O._length,ne=0;for(U=0;U<re;U+=1)q=O.v[U],W=O.o[U],j=O.i[U],q[0]===W[0]&&q[1]===W[1]&&q[0]===j[0]&&q[1]===j[1]?0!==U&&U!==re-1||O.c?(Y=0===U?O.v[re-1]:O.v[U-1],Q=(K=Math.sqrt(Math.pow(q[0]-Y[0],2)+Math.pow(q[1]-Y[1],2)))?Math.min(K/2,B)/K:0,Z=te=q[0]+(Y[0]-q[0])*Q,X=ie=q[1]-(q[1]-Y[1])*Q,J=Z-(Z-q[0])*roundCorner,ee=X-(X-q[1])*roundCorner,G.setTripleAt(Z,X,J,ee,te,ie,ne),ne+=1,Y=U===re-1?O.v[0]:O.v[U+1],Q=(K=Math.sqrt(Math.pow(q[0]-Y[0],2)+Math.pow(q[1]-Y[1],2)))?Math.min(K/2,B)/K:0,Z=J=q[0]+(Y[0]-q[0])*Q,X=ee=q[1]+(Y[1]-q[1])*Q,te=Z-(Z-q[0])*roundCorner,ie=X-(X-q[1])*roundCorner,G.setTripleAt(Z,X,J,ee,te,ie,ne),ne+=1):(G.setTripleAt(q[0],q[1],W[0],W[1],j[0],j[1],ne),ne+=1):(G.setTripleAt(O.v[U][0],O.v[U][1],O.o[U][0],O.o[U][1],O.i[U][0],O.i[U][1],ne),ne+=1);return G},RoundCornersModifier.prototype.processShapes=function(O){var B,U,G,q,j,W,Y=this.shapes.length,K=this.rd.v;if(0!==K)for(U=0;U<Y;U+=1){if(W=(j=this.shapes[U]).localShapeCollection,j.shape._mdf||this._mdf||O)for(W.releaseShapes(),j.shape._mdf=!0,B=j.shape.paths.shapes,q=j.shape.paths._length,G=0;G<q;G+=1)W.addShape(this.processPath(B[G],K));j.shape.paths=j.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},PolynomialBezier.prototype.point=function(O){return[((this.a[0]*O+this.b[0])*O+this.c[0])*O+this.d[0],((this.a[1]*O+this.b[1])*O+this.c[1])*O+this.d[1]]},PolynomialBezier.prototype.derivative=function(O){return[(3*O*this.a[0]+2*this.b[0])*O+this.c[0],(3*O*this.a[1]+2*this.b[1])*O+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(O){var B=this.derivative(O);return Math.atan2(B[1],B[0])},PolynomialBezier.prototype.normalAngle=function(O){var B=this.derivative(O);return Math.atan2(B[0],B[1])},PolynomialBezier.prototype.inflectionPoints=function(){var O=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(O))return[];var B=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/O,U=B*B-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/O;if(U<0)return[];var G=Math.sqrt(U);return floatZero(G)?G>0&&G<1?[B]:[]:[B-G,B+G].filter((function(O){return O>0&&O<1}))},PolynomialBezier.prototype.split=function(O){if(O<=0)return[singlePoint(this.points[0]),this];if(O>=1)return[this,singlePoint(this.points[this.points.length-1])];var B=lerpPoint(this.points[0],this.points[1],O),U=lerpPoint(this.points[1],this.points[2],O),G=lerpPoint(this.points[2],this.points[3],O),q=lerpPoint(B,U,O),j=lerpPoint(U,G,O),W=lerpPoint(q,j,O);return[new PolynomialBezier(this.points[0],B,q,W,!0),new PolynomialBezier(W,j,G,this.points[3],!0)]},PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var O=this.bounds();return{left:O.x.min,right:O.x.max,top:O.y.min,bottom:O.y.max,width:O.x.max-O.x.min,height:O.y.max-O.y.min,cx:(O.x.max+O.x.min)/2,cy:(O.y.max+O.y.min)/2}},PolynomialBezier.prototype.intersections=function(O,B,U){void 0===B&&(B=2),void 0===U&&(U=7);var G=[];return intersectsImpl(intersectData(this,0,1),intersectData(O,0,1),0,B,G,U),G},PolynomialBezier.shapeSegment=function(O,B){var U=(B+1)%O.length();return new PolynomialBezier(O.v[B],O.o[B],O.i[U],O.v[U],!0)},PolynomialBezier.shapeSegmentInverted=function(O,B){var U=(B+1)%O.length();return new PolynomialBezier(O.v[U],O.i[U],O.o[B],O.v[B],!0)},extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(O,B){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(O,B.s,0,null,this),this.frequency=PropertyFactory.getProp(O,B.r,0,null,this),this.pointsType=PropertyFactory.getProp(O,B.pt,0,null,this),this._isAnimated=0!==this.amplitude.effectsSequence.length||0!==this.frequency.effectsSequence.length||0!==this.pointsType.effectsSequence.length},ZigZagModifier.prototype.processPath=function(O,B,U,G){var q=O._length,j=shapePool.newElement();if(j.c=O.c,O.c||(q-=1),0===q)return j;var W=-1,Y=PolynomialBezier.shapeSegment(O,0);zigZagCorner(j,O,0,B,U,G,W);for(var K=0;K<q;K+=1)W=zigZagSegment(j,Y,B,U,G,-W),Y=K!==q-1||O.c?PolynomialBezier.shapeSegment(O,(K+1)%q):null,zigZagCorner(j,O,K+1,B,U,G,W);return j},ZigZagModifier.prototype.processShapes=function(O){var B,U,G,q,j,W,Y=this.shapes.length,K=this.amplitude.v,Q=Math.max(0,Math.round(this.frequency.v)),Z=this.pointsType.v;if(0!==K)for(U=0;U<Y;U+=1){if(W=(j=this.shapes[U]).localShapeCollection,j.shape._mdf||this._mdf||O)for(W.releaseShapes(),j.shape._mdf=!0,B=j.shape.paths.shapes,q=j.shape.paths._length,G=0;G<q;G+=1)W.addShape(this.processPath(B[G],K,Q,Z));j.shape.paths=j.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(O,B){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(O,B.a,0,null,this),this.miterLimit=PropertyFactory.getProp(O,B.ml,0,null,this),this.lineJoin=B.lj,this._isAnimated=0!==this.amount.effectsSequence.length},OffsetPathModifier.prototype.processPath=function(O,B,U,G){var q=shapePool.newElement();q.c=O.c;var j,W,Y,K=O.length();O.c||(K-=1);var Q=[];for(j=0;j<K;j+=1)Y=PolynomialBezier.shapeSegment(O,j),Q.push(offsetSegmentSplit(Y,B));if(!O.c)for(j=K-1;j>=0;j-=1)Y=PolynomialBezier.shapeSegmentInverted(O,j),Q.push(offsetSegmentSplit(Y,B));Q=pruneIntersections(Q);var Z=null,X=null;for(j=0;j<Q.length;j+=1){var J=Q[j];for(X&&(Z=joinLines(q,X,J[0],U,G)),X=J[J.length-1],W=0;W<J.length;W+=1)Y=J[W],Z&&pointEqual(Y.points[0],Z)?q.setXYAt(Y.points[1][0],Y.points[1][1],"o",q.length()-1):q.setTripleAt(Y.points[0][0],Y.points[0][1],Y.points[1][0],Y.points[1][1],Y.points[0][0],Y.points[0][1],q.length()),q.setTripleAt(Y.points[3][0],Y.points[3][1],Y.points[3][0],Y.points[3][1],Y.points[2][0],Y.points[2][1],q.length()),Z=Y.points[3]}return Q.length&&joinLines(q,X,Q[0][0],U,G),q},OffsetPathModifier.prototype.processShapes=function(O){var B,U,G,q,j,W,Y=this.shapes.length,K=this.amount.v,Q=this.miterLimit.v,Z=this.lineJoin;if(0!==K)for(U=0;U<Y;U+=1){if(W=(j=this.shapes[U]).localShapeCollection,j.shape._mdf||this._mdf||O)for(W.releaseShapes(),j.shape._mdf=!0,B=j.shape.paths.shapes,q=j.shape.paths._length,G=0;G<q;G+=1)W.addShape(this.processPath(B[G],K,Z,Q));j.shape.paths=j.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var FontManager=function(){var O={w:0,size:0,shapes:[],data:{shapes:[]}},B=[];B=B.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var U=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"],G=[65039,8205];function s(O,B){var U=createTag("span");U.setAttribute("aria-hidden",!0),U.style.fontFamily=B;var G=createTag("span");G.innerText="giItT1WQy@!-/#",U.style.position="absolute",U.style.left="-10000px",U.style.top="-10000px",U.style.fontSize="300px",U.style.fontVariant="normal",U.style.fontStyle="normal",U.style.fontWeight="normal",U.style.letterSpacing="0",U.appendChild(G),document.body.appendChild(U);var q=G.offsetWidth;return G.style.fontFamily=function(O){var B,U=O.split(","),G=U.length,q=[];for(B=0;B<G;B+=1)"sans-serif"!==U[B]&&"monospace"!==U[B]&&q.push(U[B]);return q.join(",")}(O)+", "+B,{node:G,w:q,parent:U}}function a(O,B){var U,G=document.body&&B?"svg":"canvas",q=getFontProperties(O);if("svg"===G){var j=createNS("text");j.style.fontSize="100px",j.setAttribute("font-family",O.fFamily),j.setAttribute("font-style",q.style),j.setAttribute("font-weight",q.weight),j.textContent="1",O.fClass?(j.style.fontFamily="inherit",j.setAttribute("class",O.fClass)):j.style.fontFamily=O.fFamily,B.appendChild(j),U=j}else{var W=new OffscreenCanvas(500,500).getContext("2d");W.font=q.style+" "+q.weight+" 100px "+O.fFamily,U=W}return{measureText:function(O){return"svg"===G?(U.textContent=O,U.getComputedTextLength()):U.measureText(O).width}}}var n=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};n.isModifier=function(O,B){var G=O.toString(16)+B.toString(16);return-1!==U.indexOf(G)},n.isZeroWidthJoiner=function(O,B){return B?O===G[0]&&B===G[1]:O===G[1]},n.isCombinedCharacter=function(O){return-1!==B.indexOf(O)};var q={addChars:function(O){if(O){var B;this.chars||(this.chars=[]);var U,G,q=O.length,j=this.chars.length;for(B=0;B<q;B+=1){for(U=0,G=!1;U<j;)this.chars[U].style===O[B].style&&this.chars[U].fFamily===O[B].fFamily&&this.chars[U].ch===O[B].ch&&(G=!0),U+=1;G||(this.chars.push(O[B]),j+=1)}}},addFonts:function(O,B){if(O){if(this.chars)return this.isLoaded=!0,void(this.fonts=O.list);if(!document.body)return this.isLoaded=!0,O.list.forEach((function(O){O.helper=a(O),O.cache={}})),void(this.fonts=O.list);var U,G=O.list,q=G.length,j=q;for(U=0;U<q;U+=1){var W,Y,K=!0;if(G[U].loaded=!1,G[U].monoCase=s(G[U].fFamily,"monospace"),G[U].sansCase=s(G[U].fFamily,"sans-serif"),G[U].fPath){if("p"===G[U].fOrigin||3===G[U].origin){if((W=document.querySelectorAll('style[f-forigin="p"][f-family="'+G[U].fFamily+'"], style[f-origin="3"][f-family="'+G[U].fFamily+'"]')).length>0&&(K=!1),K){var Q=createTag("style");Q.setAttribute("f-forigin",G[U].fOrigin),Q.setAttribute("f-origin",G[U].origin),Q.setAttribute("f-family",G[U].fFamily),Q.type="text/css",Q.innerText="@font-face {font-family: "+G[U].fFamily+"; font-style: normal; src: url('"+G[U].fPath+"');}",B.appendChild(Q)}}else if("g"===G[U].fOrigin||1===G[U].origin){for(W=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),Y=0;Y<W.length;Y+=1)-1!==W[Y].href.indexOf(G[U].fPath)&&(K=!1);if(K){var Z=createTag("link");Z.setAttribute("f-forigin",G[U].fOrigin),Z.setAttribute("f-origin",G[U].origin),Z.type="text/css",Z.rel="stylesheet",Z.href=G[U].fPath,document.body.appendChild(Z)}}else if("t"===G[U].fOrigin||2===G[U].origin){for(W=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),Y=0;Y<W.length;Y+=1)G[U].fPath===W[Y].src&&(K=!1);if(K){var X=createTag("link");X.setAttribute("f-forigin",G[U].fOrigin),X.setAttribute("f-origin",G[U].origin),X.setAttribute("rel","stylesheet"),X.setAttribute("href",G[U].fPath),B.appendChild(X)}}}else G[U].loaded=!0,j-=1;G[U].helper=a(G[U],B),G[U].cache={},this.fonts.push(G[U])}0===j?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0},getCharData:function(B,U,G){for(var q=0,j=this.chars.length;q<j;){if(this.chars[q].ch===B&&this.chars[q].style===U&&this.chars[q].fFamily===G)return this.chars[q];q+=1}return("string"==typeof B&&13!==B.charCodeAt(0)||!B)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",B,U,G)),O},getFontByName:function(O){for(var B=0,U=this.fonts.length;B<U;){if(this.fonts[B].fName===O)return this.fonts[B];B+=1}return this.fonts[0]},measureText:function(O,B,U){var G=this.getFontByName(B),q=O.charCodeAt(0);if(!G.cache[q+1]){var j=G.helper;if(" "===O){var W=j.measureText("|"+O+"|"),Y=j.measureText("||");G.cache[q+1]=(W-Y)/100}else G.cache[q+1]=j.measureText(O)/100}return G.cache[q+1]*U},checkLoadedFonts:function(){var O,B,U,G=this.fonts.length,q=G;for(O=0;O<G;O+=1)this.fonts[O].loaded?q-=1:"n"===this.fonts[O].fOrigin||0===this.fonts[O].origin?this.fonts[O].loaded=!0:(B=this.fonts[O].monoCase.node,U=this.fonts[O].monoCase.w,B.offsetWidth!==U?(q-=1,this.fonts[O].loaded=!0):(B=this.fonts[O].sansCase.node,U=this.fonts[O].sansCase.w,B.offsetWidth!==U&&(q-=1,this.fonts[O].loaded=!0)),this.fonts[O].loaded&&(this.fonts[O].sansCase.parent.parentNode.removeChild(this.fonts[O].sansCase.parent),this.fonts[O].monoCase.parent.parentNode.removeChild(this.fonts[O].monoCase.parent)));0!==q&&Date.now()-this.initTime<5e3?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)},setIsLoaded:function(){this.isLoaded=!0}};return n.prototype=q,n}();function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(O){-1===this.renderableComponents.indexOf(O)&&this.renderableComponents.push(O)},removeRenderableComponent:function(O){-1!==this.renderableComponents.indexOf(O)&&this.renderableComponents.splice(this.renderableComponents.indexOf(O),1)},prepareRenderableFrame:function(O){this.checkLayerLimits(O)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(O){this.data.ip-this.data.st<=O&&this.data.op-this.data.st>O?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var O,B=this.renderableComponents.length;for(O=0;O<B;O+=1)this.renderableComponents[O].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=(blendModeEnums={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"},function(O){return blendModeEnums[O]||""}),blendModeEnums;function SliderEffect(O,B,U){this.p=PropertyFactory.getProp(B,O.v,0,0,U)}function AngleEffect(O,B,U){this.p=PropertyFactory.getProp(B,O.v,0,0,U)}function ColorEffect(O,B,U){this.p=PropertyFactory.getProp(B,O.v,1,0,U)}function PointEffect(O,B,U){this.p=PropertyFactory.getProp(B,O.v,1,0,U)}function LayerIndexEffect(O,B,U){this.p=PropertyFactory.getProp(B,O.v,0,0,U)}function MaskIndexEffect(O,B,U){this.p=PropertyFactory.getProp(B,O.v,0,0,U)}function CheckboxEffect(O,B,U){this.p=PropertyFactory.getProp(B,O.v,0,0,U)}function NoValueEffect(){this.p={}}function EffectsManager(O,B){var U,G=O.ef||[];this.effectElements=[];var q,j=G.length;for(U=0;U<j;U+=1)q=new GroupEffect(G[U],B),this.effectElements.push(q)}function GroupEffect(O,B){this.init(O,B)}function BaseElement(){}function FrameElement(){}function FootageElement(O,B,U){this.initFrame(),this.initRenderable(),this.assetData=B.getAssetData(O.refId),this.footageData=B.imageLoader.getAsset(this.assetData),this.initBaseData(O,B,U)}function AudioElement(O,B,U){this.initFrame(),this.initRenderable(),this.assetData=B.getAssetData(O.refId),this.initBaseData(O,B,U),this._isPlaying=!1,this._canPlay=!1;var G=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(G),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=O.tm?PropertyFactory.getProp(this,O.tm,0,B.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,O.au&&O.au.lv?O.au.lv:{k:[100]},1,.01,this)}function BaseRenderer(){}function TransformElement(){}function MaskElement(O,B,U){this.data=O,this.element=B,this.globalData=U,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var G,q,j=this.globalData.defs,W=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(W),this.solidPath="";var Y,K,Q,Z,X,J,ee=this.masksProperties,te=0,ie=[],re=createElementID(),ne="clipPath",oe="clip-path";for(G=0;G<W;G+=1)if(("a"!==ee[G].mode&&"n"!==ee[G].mode||ee[G].inv||100!==ee[G].o.k||ee[G].o.x)&&(ne="mask",oe="mask"),"s"!==ee[G].mode&&"i"!==ee[G].mode||0!==te?Q=null:((Q=createNS("rect")).setAttribute("fill","#ffffff"),Q.setAttribute("width",this.element.comp.data.w||0),Q.setAttribute("height",this.element.comp.data.h||0),ie.push(Q)),q=createNS("path"),"n"===ee[G].mode)this.viewData[G]={op:PropertyFactory.getProp(this.element,ee[G].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,ee[G],3),elem:q,lastPath:""},j.appendChild(q);else{var ae;if(te+=1,q.setAttribute("fill","s"===ee[G].mode?"#000000":"#ffffff"),q.setAttribute("clip-rule","nonzero"),0!==ee[G].x.k?(ne="mask",oe="mask",J=PropertyFactory.getProp(this.element,ee[G].x,0,null,this.element),ae=createElementID(),(Z=createNS("filter")).setAttribute("id",ae),(X=createNS("feMorphology")).setAttribute("operator","erode"),X.setAttribute("in","SourceGraphic"),X.setAttribute("radius","0"),Z.appendChild(X),j.appendChild(Z),q.setAttribute("stroke","s"===ee[G].mode?"#000000":"#ffffff")):(X=null,J=null),this.storedData[G]={elem:q,x:J,expan:X,lastPath:"",lastOperator:"",filterId:ae,lastRadius:0},"i"===ee[G].mode){K=ie.length;var se=createNS("g");for(Y=0;Y<K;Y+=1)se.appendChild(ie[Y]);var le=createNS("mask");le.setAttribute("mask-type","alpha"),le.setAttribute("id",re+"_"+te),le.appendChild(q),j.appendChild(le),se.setAttribute("mask","url("+getLocationHref()+"#"+re+"_"+te+")"),ie.length=0,ie.push(se)}else ie.push(q);ee[G].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[G]={elem:q,lastPath:"",op:PropertyFactory.getProp(this.element,ee[G].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,ee[G],3),invRect:Q},this.viewData[G].prop.k||this.drawPath(ee[G],this.viewData[G].prop.v,this.viewData[G])}for(this.maskElement=createNS(ne),W=ie.length,G=0;G<W;G+=1)this.maskElement.appendChild(ie[G]);te>0&&(this.maskElement.setAttribute("id",re),this.element.maskedElement.setAttribute(oe,"url("+getLocationHref()+"#"+re+")"),j.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(O,B){var U;this.data=O,this.effectElements=[],this.initDynamicPropertyContainer(B);var G,q=this.data.ef.length,j=this.data.ef;for(U=0;U<q;U+=1){switch(G=null,j[U].ty){case 0:G=new SliderEffect(j[U],B,this);break;case 1:G=new AngleEffect(j[U],B,this);break;case 2:G=new ColorEffect(j[U],B,this);break;case 3:G=new PointEffect(j[U],B,this);break;case 4:case 7:G=new CheckboxEffect(j[U],B,this);break;case 10:G=new LayerIndexEffect(j[U],B,this);break;case 11:G=new MaskIndexEffect(j[U],B,this);break;case 5:G=new EffectsManager(j[U],B,this);break;default:G=new NoValueEffect(j[U],B,this)}G&&this.effectElements.push(G)}},BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var O=0,B=this.data.masksProperties.length;O<B;){if("n"!==this.data.masksProperties[O].mode&&!1!==this.data.masksProperties[O].cl)return!0;O+=1}return!1},initExpressions:function(){var O=getExpressionInterfaces();if(O){var B=O("layer"),U=O("effects"),G=O("shape"),q=O("text"),j=O("comp");this.layerInterface=B(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var W=U.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(W),0===this.data.ty||this.data.xt?this.compInterface=j(this):4===this.data.ty?(this.layerInterface.shapeInterface=G(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=q(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var O=getBlendMode(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=O},initBaseData:function(O,B,U){this.globalData=B,this.comp=U,this.data=O,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(O,B){var U,G=this.dynamicProperties.length;for(U=0;U<G;U+=1)(B||this._isParent&&"transform"===this.dynamicProperties[U].propType)&&(this.dynamicProperties[U].getValue(),this.dynamicProperties[U]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(O){-1===this.dynamicProperties.indexOf(O)&&this.dynamicProperties.push(O)}},FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var O=getExpressionInterfaces();if(O){var B=O("footage");this.layerInterface=B(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData},AudioElement.prototype.prepareFrame=function(O){if(this.prepareRenderableFrame(O,!0),this.prepareProperties(O,!0),this.tm._placeholder)this._currentTime=O/this.data.sr;else{var B=this.tm.v;this._currentTime=B}this._volume=this.lv.v[0];var U=this._volume*this._volumeMultiplier;this._previousVolume!==U&&(this._previousVolume=U,this.audio.volume(U))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(O){this.audio.rate(O)},AudioElement.prototype.volume=function(O){this._volumeMultiplier=O,this._previousVolume=O*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){},BaseRenderer.prototype.checkLayers=function(O){var B,U,G=this.layers.length;for(this.completeLayers=!0,B=G-1;B>=0;B-=1)this.elements[B]||(U=this.layers[B]).ip-U.st<=O-this.layers[B].st&&U.op-U.st>O-this.layers[B].st&&this.buildItem(B),this.completeLayers=!!this.elements[B]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(O){switch(O.ty){case 2:return this.createImage(O);case 0:return this.createComp(O);case 1:return this.createSolid(O);case 3:default:return this.createNull(O);case 4:return this.createShape(O);case 5:return this.createText(O);case 6:return this.createAudio(O);case 13:return this.createCamera(O);case 15:return this.createFootage(O)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(O){return new AudioElement(O,this.globalData,this)},BaseRenderer.prototype.createFootage=function(O){return new FootageElement(O,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var O,B=this.layers.length;for(O=0;O<B;O+=1)this.buildItem(O);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(O){var B;this.completeLayers=!1;var U,G=O.length,q=this.layers.length;for(B=0;B<G;B+=1)for(U=0;U<q;){if(this.layers[U].id===O[B].id){this.layers[U]=O[B];break}U+=1}},BaseRenderer.prototype.setProjectInterface=function(O){this.globalData.projectInterface=O},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(O,B,U){for(var G=this.elements,q=this.layers,j=0,W=q.length;j<W;)q[j].ind==B&&(G[j]&&!0!==G[j]?(U.push(G[j]),G[j].setAsParent(),void 0!==q[j].parent?this.buildElementParenting(O,q[j].parent,U):O.setHierarchy(U)):(this.buildItem(j),this.addPendingElement(O))),j+=1},BaseRenderer.prototype.addPendingElement=function(O){this.pendingElements.push(O)},BaseRenderer.prototype.searchExtraCompositions=function(O){var B,U=O.length;for(B=0;B<U;B+=1)if(O[B].xt){var G=this.createComp(O[B]);G.initExpressions(),this.globalData.projectInterface.registerComposition(G)}},BaseRenderer.prototype.getElementByPath=function(O){var B,U=O.shift();if("number"==typeof U)B=this.elements[U];else{var G,q=this.elements.length;for(G=0;G<q;G+=1)if(this.elements[G].data.nm===U){B=this.elements[G];break}}return 0===O.length?B:B.getElementByPath(O)},BaseRenderer.prototype.setupGlobalData=function(O,B){this.globalData.fontManager=new FontManager,this.globalData.fontManager.addChars(O.chars),this.globalData.fontManager.addFonts(O.fonts,B),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=O.fr,this.globalData.nm=O.nm,this.globalData.compSize={w:O.w,h:O.h}},TransformElement.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new Matrix},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var O,B=this.finalTransform.mat,U=0,G=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;U<G;){if(this.hierarchy[U].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}U+=1}if(this.finalTransform._matMdf)for(O=this.finalTransform.mProp.v.props,B.cloneFromProps(O),U=0;U<G;U+=1)O=this.hierarchy[U].finalTransform.mProp.v.props,B.transform(O[0],O[1],O[2],O[3],O[4],O[5],O[6],O[7],O[8],O[9],O[10],O[11],O[12],O[13],O[14],O[15])}},globalToLocal:function(O){var B=[];B.push(this.finalTransform);for(var U,G=!0,q=this.comp;G;)q.finalTransform?(q.data.hasMask&&B.splice(0,0,q.finalTransform),q=q.comp):G=!1;var j,W=B.length;for(U=0;U<W;U+=1)j=B[U].mat.applyToPointArray(0,0,0),O=[O[0]-j[0],O[1]-j[1],0];return O},mHelper:new Matrix},MaskElement.prototype.getMaskProperty=function(O){return this.viewData[O].prop},MaskElement.prototype.renderFrame=function(O){var B,U=this.element.finalTransform.mat,G=this.masksProperties.length;for(B=0;B<G;B+=1)if((this.viewData[B].prop._mdf||O)&&this.drawPath(this.masksProperties[B],this.viewData[B].prop.v,this.viewData[B]),(this.viewData[B].op._mdf||O)&&this.viewData[B].elem.setAttribute("fill-opacity",this.viewData[B].op.v),"n"!==this.masksProperties[B].mode&&(this.viewData[B].invRect&&(this.element.finalTransform.mProp._mdf||O)&&this.viewData[B].invRect.setAttribute("transform",U.getInverseMatrix().to2dCSS()),this.storedData[B].x&&(this.storedData[B].x._mdf||O))){var q=this.storedData[B].expan;this.storedData[B].x.v<0?("erode"!==this.storedData[B].lastOperator&&(this.storedData[B].lastOperator="erode",this.storedData[B].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[B].filterId+")")),q.setAttribute("radius",-this.storedData[B].x.v)):("dilate"!==this.storedData[B].lastOperator&&(this.storedData[B].lastOperator="dilate",this.storedData[B].elem.setAttribute("filter",null)),this.storedData[B].elem.setAttribute("stroke-width",2*this.storedData[B].x.v))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var O="M0,0 ";return O+=" h"+this.globalData.compSize.w,O+=" v"+this.globalData.compSize.h,(O+=" h-"+this.globalData.compSize.w)+" v-"+this.globalData.compSize.h+" "},MaskElement.prototype.drawPath=function(O,B,U){var G,q,j=" M"+B.v[0][0]+","+B.v[0][1];for(q=B._length,G=1;G<q;G+=1)j+=" C"+B.o[G-1][0]+","+B.o[G-1][1]+" "+B.i[G][0]+","+B.i[G][1]+" "+B.v[G][0]+","+B.v[G][1];if(B.c&&q>1&&(j+=" C"+B.o[G-1][0]+","+B.o[G-1][1]+" "+B.i[0][0]+","+B.i[0][1]+" "+B.v[0][0]+","+B.v[0][1]),U.lastPath!==j){var W="";U.elem&&(B.c&&(W=O.inv?this.solidPath+j:j),U.elem.setAttribute("d",W)),U.lastPath=j}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var O={createFilter:function(O,B){var U=createNS("filter");return U.setAttribute("id",O),!0!==B&&(U.setAttribute("filterUnits","objectBoundingBox"),U.setAttribute("x","0%"),U.setAttribute("y","0%"),U.setAttribute("width","100%"),U.setAttribute("height","100%")),U},createAlphaToLuminanceFilter:function(){var O=createNS("feColorMatrix");return O.setAttribute("type","matrix"),O.setAttribute("color-interpolation-filters","sRGB"),O.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),O}};return O}(),featureSupport=function(){var O={maskType:!0};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(O.maskType=!1),O}(),registeredEffects={},idPrefix="filter_result_";function SVGEffects(O){var B,U,G="SourceGraphic",q=O.data.ef?O.data.ef.length:0,j=createElementID(),W=filtersFactory.createFilter(j,!0),Y=0;for(this.filters=[],B=0;B<q;B+=1){U=null;var K=O.data.ef[B].ty;registeredEffects[K]&&(U=new(0,registeredEffects[K].effect)(W,O.effectsManager.effectElements[B],O,idPrefix+Y,G),G=idPrefix+Y,registeredEffects[K].countsAsEffect&&(Y+=1)),U&&this.filters.push(U)}Y&&(O.globalData.defs.appendChild(W),O.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+j+")")),this.filters.length&&O.addRenderableComponent(this)}function registerEffect(O,B,U){registeredEffects[O]={effect:B,countsAsEffect:U}}function SVGBaseElement(){}function HierarchyElement(){}function RenderableDOMElement(){}function IImageElement(O,B,U){this.assetData=B.getAssetData(O.refId),this.initElement(O,B,U),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ProcessedElement(O,B){this.elem=O,this.pos=B}function IShapeElement(){}SVGEffects.prototype.renderFrame=function(O){var B,U=this.filters.length;for(B=0;B<U;B+=1)this.filters[B].renderFrame(O)},SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var O=null;if(this.data.td){this.matteMasks={};var B=createNS("symbol");B.setAttribute("id",this.layerId);var U=createNS("g");U.appendChild(this.layerElement),B.appendChild(U),O=U,this.globalData.defs.appendChild(B)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),O=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0===this.data.ty&&!this.data.hd){var G=createNS("clipPath"),q=createNS("path");q.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var j=createElementID();if(G.setAttribute("id",j),G.appendChild(q),this.globalData.defs.appendChild(G),this.checkMasks()){var W=createNS("g");W.setAttribute("clip-path","url("+getLocationHref()+"#"+j+")"),W.appendChild(this.layerElement),this.transformedElement=W,O?O.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+j+")")}0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this)},getMatte:function(O){if(!this.matteMasks[O]){var B,U,G,q,j=this.layerId+"_"+O;if(1===O||3===O){var W=createNS("mask");W.setAttribute("id",j),W.setAttribute("mask-type",3===O?"luminance":"alpha"),(G=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),W.appendChild(G),this.globalData.defs.appendChild(W),featureSupport.maskType||1!==O||(W.setAttribute("mask-type","luminance"),B=createElementID(),U=filtersFactory.createFilter(B),this.globalData.defs.appendChild(U),U.appendChild(filtersFactory.createAlphaToLuminanceFilter()),(q=createNS("g")).appendChild(G),W.appendChild(q),q.setAttribute("filter","url("+getLocationHref()+"#"+B+")"))}else if(2===O){var Y=createNS("mask");Y.setAttribute("id",j),Y.setAttribute("mask-type","alpha");var K=createNS("g");Y.appendChild(K),B=createElementID(),U=filtersFactory.createFilter(B);var Q=createNS("feComponentTransfer");Q.setAttribute("in","SourceGraphic"),U.appendChild(Q);var Z=createNS("feFuncA");Z.setAttribute("type","table"),Z.setAttribute("tableValues","1.0 0.0"),Q.appendChild(Z),this.globalData.defs.appendChild(U);var X=createNS("rect");X.setAttribute("width",this.comp.data.w),X.setAttribute("height",this.comp.data.h),X.setAttribute("x","0"),X.setAttribute("y","0"),X.setAttribute("fill","#ffffff"),X.setAttribute("opacity","0"),K.setAttribute("filter","url("+getLocationHref()+"#"+B+")"),K.appendChild(X),(G=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),K.appendChild(G),featureSupport.maskType||(Y.setAttribute("mask-type","luminance"),U.appendChild(filtersFactory.createAlphaToLuminanceFilter()),q=createNS("g"),K.appendChild(X),q.appendChild(this.layerElement),K.appendChild(q)),this.globalData.defs.appendChild(Y)}this.matteMasks[O]=j}return this.matteMasks[O]},setMatte:function(O){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+O+")")}},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(O){this.hierarchy=O},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},extendPrototype([RenderableElement,createProxyFunction({initElement:function(O,B,U){this.initFrame(),this.initBaseData(O,B,U),this.initTransform(O,B,U),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(O){this._mdf=!1,this.prepareRenderableFrame(O),this.prepareProperties(O,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],RenderableDOMElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var O=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",O),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},IShapeElement.prototype={addShapeToModifiers:function(O){var B,U=this.shapeModifiers.length;for(B=0;B<U;B+=1)this.shapeModifiers[B].addShape(O)},isShapeInAnimatedModifiers:function(O){for(var B=this.shapeModifiers.length;0<B;)if(this.shapeModifiers[0].isAnimatedWithShape(O))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var O,B=this.shapes.length;for(O=0;O<B;O+=1)this.shapes[O].sh.reset();for(O=(B=this.shapeModifiers.length)-1;O>=0&&!this.shapeModifiers[O].processShapes(this._isFirstFrame);O-=1);}},searchProcessedElement:function(O){for(var B=this.processedElements,U=0,G=B.length;U<G;){if(B[U].elem===O)return B[U].pos;U+=1}return 0},addProcessedElement:function(O,B){for(var U=this.processedElements,G=U.length;G;)if(U[G-=1].elem===O)return void(U[G].pos=B);U.push(new ProcessedElement(O,B))},prepareFrame:function(O){this.prepareRenderableFrame(O),this.prepareProperties(O,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(O,B,U){this.caches=[],this.styles=[],this.transformers=O,this.lStr="",this.sh=U,this.lvl=B,this._isAnimated=!!U.k;for(var G=0,q=O.length;G<q;){if(O[G].mProps.dynamicProperties.length){this._isAnimated=!0;break}G+=1}}function SVGStyleData(O,B){this.data=O,this.type=O.ty,this.d="",this.lvl=B,this._mdf=!1,this.closed=!0===O.hd,this.pElem=createNS("path"),this.msElem=null}function DashProperty(O,B,U,G){var q;this.elem=O,this.frameId=-1,this.dataProps=createSizedArray(B.length),this.renderer=U,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",B.length?B.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(G);var j,W=B.length||0;for(q=0;q<W;q+=1)j=PropertyFactory.getProp(O,B[q].v,0,0,this),this.k=j.k||this.k,this.dataProps[q]={n:B[q].n,p:j};this.k||this.getValue(!0),this._isAnimated=this.k}function SVGStrokeStyleData(O,B,U){this.initDynamicPropertyContainer(O),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(O,B.o,0,.01,this),this.w=PropertyFactory.getProp(O,B.w,0,null,this),this.d=new DashProperty(O,B.d||{},"svg",this),this.c=PropertyFactory.getProp(O,B.c,1,255,this),this.style=U,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(O,B,U){this.initDynamicPropertyContainer(O),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(O,B.o,0,.01,this),this.c=PropertyFactory.getProp(O,B.c,1,255,this),this.style=U}function SVGNoStyleData(O,B,U){this.initDynamicPropertyContainer(O),this.getValue=this.iterateDynamicProperties,this.style=U}function GradientProperty(O,B,U){this.data=B,this.c=createTypedArray("uint8c",4*B.p);var G=B.k.k[0].s?B.k.k[0].s.length-4*B.p:B.k.k.length-4*B.p;this.o=createTypedArray("float32",G),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=G,this.initDynamicPropertyContainer(U),this.prop=PropertyFactory.getProp(O,B.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}function SVGGradientFillStyleData(O,B,U){this.initDynamicPropertyContainer(O),this.getValue=this.iterateDynamicProperties,this.initGradientData(O,B,U)}function SVGGradientStrokeStyleData(O,B,U){this.initDynamicPropertyContainer(O),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(O,B.w,0,null,this),this.d=new DashProperty(O,B.d||{},"svg",this),this.initGradientData(O,B,U),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(O,B,U){this.transform={mProps:O,op:B,container:U},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},DashProperty.prototype.getValue=function(O){if((this.elem.globalData.frameId!==this.frameId||O)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||O,this._mdf)){var B=0,U=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),B=0;B<U;B+=1)"o"!==this.dataProps[B].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[B].p.v:this.dashArray[B]=this.dataProps[B].p.v:this.dashoffset[0]=this.dataProps[B].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),extendPrototype([DynamicPropertyContainer],SVGNoStyleData),GradientProperty.prototype.comparePoints=function(O,B){for(var U=0,G=this.o.length/2;U<G;){if(Math.abs(O[4*U]-O[4*B+2*U])>.01)return!1;U+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var O=0,B=this.data.k.k.length;O<B;){if(!this.comparePoints(this.data.k.k[O].s,this.data.p))return!1;O+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(O){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||O){var B,U,G,q=4*this.data.p;for(B=0;B<q;B+=1)U=B%4==0?100:255,G=Math.round(this.prop.v[B]*U),this.c[B]!==G&&(this.c[B]=G,this._cmdf=!O);if(this.o.length)for(q=this.prop.v.length,B=4*this.data.p;B<q;B+=1)U=B%2==0?100:1,G=B%2==0?Math.round(100*this.prop.v[B]):this.prop.v[B],this.o[B-4*this.data.p]!==G&&(this.o[B-4*this.data.p]=G,this._omdf=!O);this._mdf=!O}},extendPrototype([DynamicPropertyContainer],GradientProperty),SVGGradientFillStyleData.prototype.initGradientData=function(O,B,U){this.o=PropertyFactory.getProp(O,B.o,0,.01,this),this.s=PropertyFactory.getProp(O,B.s,1,null,this),this.e=PropertyFactory.getProp(O,B.e,1,null,this),this.h=PropertyFactory.getProp(O,B.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(O,B.a||{k:0},0,degToRads,this),this.g=new GradientProperty(O,B.g,this),this.style=U,this.stops=[],this.setGradientData(U.pElem,B),this.setGradientOpacity(B,U),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(O,B){var U=createElementID(),G=createNS(1===B.t?"linearGradient":"radialGradient");G.setAttribute("id",U),G.setAttribute("spreadMethod","pad"),G.setAttribute("gradientUnits","userSpaceOnUse");var q,j,W,Y=[];for(W=4*B.g.p,j=0;j<W;j+=4)q=createNS("stop"),G.appendChild(q),Y.push(q);O.setAttribute("gf"===B.ty?"fill":"stroke","url("+getLocationHref()+"#"+U+")"),this.gf=G,this.cst=Y},SVGGradientFillStyleData.prototype.setGradientOpacity=function(O,B){if(this.g._hasOpacity&&!this.g._collapsable){var U,G,q,j=createNS("mask"),W=createNS("path");j.appendChild(W);var Y=createElementID(),K=createElementID();j.setAttribute("id",K);var Q=createNS(1===O.t?"linearGradient":"radialGradient");Q.setAttribute("id",Y),Q.setAttribute("spreadMethod","pad"),Q.setAttribute("gradientUnits","userSpaceOnUse"),q=O.g.k.k[0].s?O.g.k.k[0].s.length:O.g.k.k.length;var Z=this.stops;for(G=4*O.g.p;G<q;G+=2)(U=createNS("stop")).setAttribute("stop-color","rgb(255,255,255)"),Q.appendChild(U),Z.push(U);W.setAttribute("gf"===O.ty?"fill":"stroke","url("+getLocationHref()+"#"+Y+")"),"gs"===O.ty&&(W.setAttribute("stroke-linecap",lineCapEnum[O.lc||2]),W.setAttribute("stroke-linejoin",lineJoinEnum[O.lj||2]),1===O.lj&&W.setAttribute("stroke-miterlimit",O.ml)),this.of=Q,this.ms=j,this.ost=Z,this.maskId=K,B.msElem=W}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var buildShapeString=function(O,B,U,G){if(0===B)return"";var q,j=O.o,W=O.i,Y=O.v,K=" M"+G.applyToPointStringified(Y[0][0],Y[0][1]);for(q=1;q<B;q+=1)K+=" C"+G.applyToPointStringified(j[q-1][0],j[q-1][1])+" "+G.applyToPointStringified(W[q][0],W[q][1])+" "+G.applyToPointStringified(Y[q][0],Y[q][1]);return U&&B&&(K+=" C"+G.applyToPointStringified(j[q-1][0],j[q-1][1])+" "+G.applyToPointStringified(W[0][0],W[0][1])+" "+G.applyToPointStringified(Y[0][0],Y[0][1]),K+="z"),K},SVGElementsRenderer=function(){var O=new Matrix,B=new Matrix;function r(O,B,U){(U||B.transform.op._mdf)&&B.transform.container.setAttribute("opacity",B.transform.op.v),(U||B.transform.mProps._mdf)&&B.transform.container.setAttribute("transform",B.transform.mProps.v.to2dCSS())}function i(){}function s(U,G,q){var j,W,Y,K,Q,Z,X,J,ee,te,ie,re=G.styles.length,ne=G.lvl;for(Z=0;Z<re;Z+=1){if(K=G.sh._mdf||q,G.styles[Z].lvl<ne){for(J=B.reset(),te=ne-G.styles[Z].lvl,ie=G.transformers.length-1;!K&&te>0;)K=G.transformers[ie].mProps._mdf||K,te-=1,ie-=1;if(K)for(te=ne-G.styles[Z].lvl,ie=G.transformers.length-1;te>0;)ee=G.transformers[ie].mProps.v.props,J.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5],ee[6],ee[7],ee[8],ee[9],ee[10],ee[11],ee[12],ee[13],ee[14],ee[15]),te-=1,ie-=1}else J=O;if(W=(X=G.sh.paths)._length,K){for(Y="",j=0;j<W;j+=1)(Q=X.shapes[j])&&Q._length&&(Y+=buildShapeString(Q,Q._length,Q.c,J));G.caches[Z]=Y}else Y=G.caches[Z];G.styles[Z].d+=!0===U.hd?"":Y,G.styles[Z]._mdf=K||G.styles[Z]._mdf}}function a(O,B,U){var G=B.style;(B.c._mdf||U)&&G.pElem.setAttribute("fill","rgb("+bmFloor(B.c.v[0])+","+bmFloor(B.c.v[1])+","+bmFloor(B.c.v[2])+")"),(B.o._mdf||U)&&G.pElem.setAttribute("fill-opacity",B.o.v)}function n(O,B,U){o(O,B,U),h(0,B,U)}function o(O,B,U){var G,q,j,W,Y,K=B.gf,Q=B.g._hasOpacity,Z=B.s.v,X=B.e.v;if(B.o._mdf||U){var J="gf"===O.ty?"fill-opacity":"stroke-opacity";B.style.pElem.setAttribute(J,B.o.v)}if(B.s._mdf||U){var ee=1===O.t?"x1":"cx",te="x1"===ee?"y1":"cy";K.setAttribute(ee,Z[0]),K.setAttribute(te,Z[1]),Q&&!B.g._collapsable&&(B.of.setAttribute(ee,Z[0]),B.of.setAttribute(te,Z[1]))}if(B.g._cmdf||U){G=B.cst;var ie=B.g.c;for(j=G.length,q=0;q<j;q+=1)(W=G[q]).setAttribute("offset",ie[4*q]+"%"),W.setAttribute("stop-color","rgb("+ie[4*q+1]+","+ie[4*q+2]+","+ie[4*q+3]+")")}if(Q&&(B.g._omdf||U)){var re=B.g.o;for(j=(G=B.g._collapsable?B.cst:B.ost).length,q=0;q<j;q+=1)W=G[q],B.g._collapsable||W.setAttribute("offset",re[2*q]+"%"),W.setAttribute("stop-opacity",re[2*q+1])}if(1===O.t)(B.e._mdf||U)&&(K.setAttribute("x2",X[0]),K.setAttribute("y2",X[1]),Q&&!B.g._collapsable&&(B.of.setAttribute("x2",X[0]),B.of.setAttribute("y2",X[1])));else if((B.s._mdf||B.e._mdf||U)&&(Y=Math.sqrt(Math.pow(Z[0]-X[0],2)+Math.pow(Z[1]-X[1],2)),K.setAttribute("r",Y),Q&&!B.g._collapsable&&B.of.setAttribute("r",Y)),B.e._mdf||B.h._mdf||B.a._mdf||U){Y||(Y=Math.sqrt(Math.pow(Z[0]-X[0],2)+Math.pow(Z[1]-X[1],2)));var ne=Math.atan2(X[1]-Z[1],X[0]-Z[0]),oe=B.h.v;oe>=1?oe=.99:oe<=-1&&(oe=-.99);var ae=Y*oe,se=Math.cos(ne+B.a.v)*ae+Z[0],le=Math.sin(ne+B.a.v)*ae+Z[1];K.setAttribute("fx",se),K.setAttribute("fy",le),Q&&!B.g._collapsable&&(B.of.setAttribute("fx",se),B.of.setAttribute("fy",le))}}function h(O,B,U){var G=B.style,q=B.d;q&&(q._mdf||U)&&q.dashStr&&(G.pElem.setAttribute("stroke-dasharray",q.dashStr),G.pElem.setAttribute("stroke-dashoffset",q.dashoffset[0])),B.c&&(B.c._mdf||U)&&G.pElem.setAttribute("stroke","rgb("+bmFloor(B.c.v[0])+","+bmFloor(B.c.v[1])+","+bmFloor(B.c.v[2])+")"),(B.o._mdf||U)&&G.pElem.setAttribute("stroke-opacity",B.o.v),(B.w._mdf||U)&&(G.pElem.setAttribute("stroke-width",B.w.v),G.msElem&&G.msElem.setAttribute("stroke-width",B.w.v))}return{createRenderFunction:function(O){switch(O.ty){case"fl":return a;case"gf":return o;case"gs":return n;case"st":return h;case"sh":case"el":case"rc":case"sr":return s;case"tr":return r;case"no":return i;default:return null}}}}();function SVGShapeElement(O,B,U){this.shapes=[],this.shapesData=O.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(O,B,U),this.prevViewData=[]}function LetterProps(O,B,U,G,q,j){this.o=O,this.sw=B,this.sc=U,this.fc=G,this.m=q,this.p=j,this._mdf={o:!0,sw:!!B,sc:!!U,fc:!!G,m:!0,p:!0}}function TextProperty(O,B){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=B,this.elem=O,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var O,B,U,G,q=this.shapes.length,j=this.stylesList.length,W=[],Y=!1;for(U=0;U<j;U+=1){for(G=this.stylesList[U],Y=!1,W.length=0,O=0;O<q;O+=1)-1!==(B=this.shapes[O]).styles.indexOf(G)&&(W.push(B),Y=B._isAnimated||Y);W.length>1&&Y&&this.setShapesAsAnimated(W)}},SVGShapeElement.prototype.setShapesAsAnimated=function(O){var B,U=O.length;for(B=0;B<U;B+=1)O[B].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(O,B){var U,G=new SVGStyleData(O,B),q=G.pElem;return"st"===O.ty?U=new SVGStrokeStyleData(this,O,G):"fl"===O.ty?U=new SVGFillStyleData(this,O,G):"gf"===O.ty||"gs"===O.ty?(U=new("gf"===O.ty?SVGGradientFillStyleData:SVGGradientStrokeStyleData)(this,O,G),this.globalData.defs.appendChild(U.gf),U.maskId&&(this.globalData.defs.appendChild(U.ms),this.globalData.defs.appendChild(U.of),q.setAttribute("mask","url("+getLocationHref()+"#"+U.maskId+")"))):"no"===O.ty&&(U=new SVGNoStyleData(this,O,G)),"st"!==O.ty&&"gs"!==O.ty||(q.setAttribute("stroke-linecap",lineCapEnum[O.lc||2]),q.setAttribute("stroke-linejoin",lineJoinEnum[O.lj||2]),q.setAttribute("fill-opacity","0"),1===O.lj&&q.setAttribute("stroke-miterlimit",O.ml)),2===O.r&&q.setAttribute("fill-rule","evenodd"),O.ln&&q.setAttribute("id",O.ln),O.cl&&q.setAttribute("class",O.cl),O.bm&&(q.style["mix-blend-mode"]=getBlendMode(O.bm)),this.stylesList.push(G),this.addToAnimatedContents(O,U),U},SVGShapeElement.prototype.createGroupElement=function(O){var B=new ShapeGroupData;return O.ln&&B.gr.setAttribute("id",O.ln),O.cl&&B.gr.setAttribute("class",O.cl),O.bm&&(B.gr.style["mix-blend-mode"]=getBlendMode(O.bm)),B},SVGShapeElement.prototype.createTransformElement=function(O,B){var U=TransformPropertyFactory.getTransformProperty(this,O,this),G=new SVGTransformData(U,U.o,B);return this.addToAnimatedContents(O,G),G},SVGShapeElement.prototype.createShapeElement=function(O,B,U){var G=4;"rc"===O.ty?G=5:"el"===O.ty?G=6:"sr"===O.ty&&(G=7);var q=new SVGShapeData(B,U,ShapePropertyFactory.getShapeProp(this,O,G,this));return this.shapes.push(q),this.addShapeToModifiers(q),this.addToAnimatedContents(O,q),q},SVGShapeElement.prototype.addToAnimatedContents=function(O,B){for(var U=0,G=this.animatedContents.length;U<G;){if(this.animatedContents[U].element===B)return;U+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(O),element:B,data:O})},SVGShapeElement.prototype.setElementStyles=function(O){var B,U=O.styles,G=this.stylesList.length;for(B=0;B<G;B+=1)this.stylesList[B].closed||U.push(this.stylesList[B])},SVGShapeElement.prototype.reloadShapes=function(){var O;this._isFirstFrame=!0;var B=this.itemsData.length;for(O=0;O<B;O+=1)this.prevViewData[O]=this.itemsData[O];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),B=this.dynamicProperties.length,O=0;O<B;O+=1)this.dynamicProperties[O].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(O,B,U,G,q,j,W){var Y,K,Q,Z,X,J,ee=[].concat(j),te=O.length-1,ie=[],re=[];for(Y=te;Y>=0;Y-=1){if((J=this.searchProcessedElement(O[Y]))?B[Y]=U[J-1]:O[Y]._render=W,"fl"===O[Y].ty||"st"===O[Y].ty||"gf"===O[Y].ty||"gs"===O[Y].ty||"no"===O[Y].ty)J?B[Y].style.closed=!1:B[Y]=this.createStyleElement(O[Y],q),O[Y]._render&&B[Y].style.pElem.parentNode!==G&&G.appendChild(B[Y].style.pElem),ie.push(B[Y].style);else if("gr"===O[Y].ty){if(J)for(Q=B[Y].it.length,K=0;K<Q;K+=1)B[Y].prevViewData[K]=B[Y].it[K];else B[Y]=this.createGroupElement(O[Y]);this.searchShapes(O[Y].it,B[Y].it,B[Y].prevViewData,B[Y].gr,q+1,ee,W),O[Y]._render&&B[Y].gr.parentNode!==G&&G.appendChild(B[Y].gr)}else"tr"===O[Y].ty?(J||(B[Y]=this.createTransformElement(O[Y],G)),Z=B[Y].transform,ee.push(Z)):"sh"===O[Y].ty||"rc"===O[Y].ty||"el"===O[Y].ty||"sr"===O[Y].ty?(J||(B[Y]=this.createShapeElement(O[Y],ee,q)),this.setElementStyles(B[Y])):"tm"===O[Y].ty||"rd"===O[Y].ty||"ms"===O[Y].ty||"pb"===O[Y].ty||"zz"===O[Y].ty||"op"===O[Y].ty?(J?(X=B[Y]).closed=!1:((X=ShapeModifiers.getModifier(O[Y].ty)).init(this,O[Y]),B[Y]=X,this.shapeModifiers.push(X)),re.push(X)):"rp"===O[Y].ty&&(J?(X=B[Y]).closed=!0:(X=ShapeModifiers.getModifier(O[Y].ty),B[Y]=X,X.init(this,O,Y,B),this.shapeModifiers.push(X),W=!1),re.push(X));this.addProcessedElement(O[Y],Y+1)}for(te=ie.length,Y=0;Y<te;Y+=1)ie[Y].closed=!0;for(te=re.length,Y=0;Y<te;Y+=1)re[Y].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){var O;this.renderModifiers();var B=this.stylesList.length;for(O=0;O<B;O+=1)this.stylesList[O].reset();for(this.renderShape(),O=0;O<B;O+=1)(this.stylesList[O]._mdf||this._isFirstFrame)&&(this.stylesList[O].msElem&&(this.stylesList[O].msElem.setAttribute("d",this.stylesList[O].d),this.stylesList[O].d="M0 0"+this.stylesList[O].d),this.stylesList[O].pElem.setAttribute("d",this.stylesList[O].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var O,B,U=this.animatedContents.length;for(O=0;O<U;O+=1)B=this.animatedContents[O],(this._isFirstFrame||B.element._isAnimated)&&!0!==B.data&&B.fn(B.data,B.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},LetterProps.prototype.update=function(O,B,U,G,q,j){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var W=!1;return this.o!==O&&(this.o=O,this._mdf.o=!0,W=!0),this.sw!==B&&(this.sw=B,this._mdf.sw=!0,W=!0),this.sc!==U&&(this.sc=U,this._mdf.sc=!0,W=!0),this.fc!==G&&(this.fc=G,this._mdf.fc=!0,W=!0),this.m!==q&&(this.m=q,this._mdf.m=!0,W=!0),!j.length||this.p[0]===j[0]&&this.p[1]===j[1]&&this.p[4]===j[4]&&this.p[5]===j[5]&&this.p[12]===j[12]&&this.p[13]===j[13]||(this.p=j,this._mdf.p=!0,W=!0),W},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U]);return O},TextProperty.prototype.setCurrentData=function(O){O.__complete||this.completeTextData(O),this.currentData=O,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(O){this.effectsSequence.push(O),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(O){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||O){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var B=this.currentData,U=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{var G;this.lock=!0,this._mdf=!1;var q=this.effectsSequence.length,j=O||this.data.d.k[this.keysIndex].s;for(G=0;G<q;G+=1)j=U!==this.keysIndex?this.effectsSequence[G](j,j.t):this.effectsSequence[G](this.currentData,j.t);B!==j&&this.setCurrentData(j),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){for(var O=this.data.d.k,B=this.elem.comp.renderedFrame,U=0,G=O.length;U<=G-1&&!(U===G-1||O[U+1].t>B);)U+=1;return this.keysIndex!==U&&(this.keysIndex=U),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(O){for(var B,U,G=[],q=0,j=O.length,W=!1;q<j;)B=O.charCodeAt(q),FontManager.isCombinedCharacter(B)?G[G.length-1]+=O.charAt(q):B>=55296&&B<=56319?(U=O.charCodeAt(q+1))>=56320&&U<=57343?(W||FontManager.isModifier(B,U)?(G[G.length-1]+=O.substr(q,2),W=!1):G.push(O.substr(q,2)),q+=1):G.push(O.charAt(q)):B>56319?(U=O.charCodeAt(q+1),FontManager.isZeroWidthJoiner(B,U)?(W=!0,G[G.length-1]+=O.substr(q,2),q+=1):G.push(O.charAt(q))):FontManager.isZeroWidthJoiner(B)?(G[G.length-1]+=O.charAt(q),W=!0):G.push(O.charAt(q)),q+=1;return G},TextProperty.prototype.completeTextData=function(O){O.__complete=!0;var B,U,G,q,j,W,Y,K=this.elem.globalData.fontManager,Q=this.data,Z=[],X=0,J=Q.m.g,ee=0,te=0,ie=0,re=[],ne=0,oe=0,ae=K.getFontByName(O.f),se=0,le=getFontProperties(ae);O.fWeight=le.weight,O.fStyle=le.style,O.finalSize=O.s,O.finalText=this.buildFinalText(O.t),U=O.finalText.length,O.finalLineHeight=O.lh;var ce,de=O.tr/1e3*O.finalSize;if(O.sz)for(var pe,ue,he=!0,me=O.sz[0],ge=O.sz[1];he;){pe=0,ne=0,U=(ue=this.buildFinalText(O.t)).length,de=O.tr/1e3*O.finalSize;var fe=-1;for(B=0;B<U;B+=1)ce=ue[B].charCodeAt(0),G=!1," "===ue[B]?fe=B:13!==ce&&3!==ce||(ne=0,G=!0,pe+=O.finalLineHeight||1.2*O.finalSize),K.chars?(Y=K.getCharData(ue[B],ae.fStyle,ae.fFamily),se=G?0:Y.w*O.finalSize/100):se=K.measureText(ue[B],O.f,O.finalSize),ne+se>me&&" "!==ue[B]?(-1===fe?U+=1:B=fe,pe+=O.finalLineHeight||1.2*O.finalSize,ue.splice(B,fe===B?1:0,"\r"),fe=-1,ne=0):(ne+=se,ne+=de);pe+=ae.ascent*O.finalSize/100,this.canResize&&O.finalSize>this.minimumFontSize&&ge<pe?(O.finalSize-=1,O.finalLineHeight=O.finalSize*O.lh/O.s):(O.finalText=ue,U=O.finalText.length,he=!1)}ne=-de,se=0;var ye,_e=0;for(B=0;B<U;B+=1)if(G=!1,13===(ce=(ye=O.finalText[B]).charCodeAt(0))||3===ce?(_e=0,re.push(ne),oe=ne>oe?ne:oe,ne=-2*de,q="",G=!0,ie+=1):q=ye,K.chars?(Y=K.getCharData(ye,ae.fStyle,K.getFontByName(O.f).fFamily),se=G?0:Y.w*O.finalSize/100):se=K.measureText(q,O.f,O.finalSize)," "===ye?_e+=se+de:(ne+=se+de+_e,_e=0),Z.push({l:se,an:se,add:ee,n:G,anIndexes:[],val:q,line:ie,animatorJustifyOffset:0}),2==J){if(ee+=se,""===q||" "===q||B===U-1){for(""!==q&&" "!==q||(ee-=se);te<=B;)Z[te].an=ee,Z[te].ind=X,Z[te].extra=se,te+=1;X+=1,ee=0}}else if(3==J){if(ee+=se,""===q||B===U-1){for(""===q&&(ee-=se);te<=B;)Z[te].an=ee,Z[te].ind=X,Z[te].extra=se,te+=1;ee=0,X+=1}}else Z[X].ind=X,Z[X].extra=0,X+=1;if(O.l=Z,oe=ne>oe?ne:oe,re.push(ne),O.sz)O.boxWidth=O.sz[0],O.justifyOffset=0;else switch(O.boxWidth=oe,O.j){case 1:O.justifyOffset=-O.boxWidth;break;case 2:O.justifyOffset=-O.boxWidth/2;break;default:O.justifyOffset=0}O.lineWidths=re;var ve,be,Se,Ce,Ee=Q.a;W=Ee.length;var xe=[];for(j=0;j<W;j+=1){for((ve=Ee[j]).a.sc&&(O.strokeColorAnim=!0),ve.a.sw&&(O.strokeWidthAnim=!0),(ve.a.fc||ve.a.fh||ve.a.fs||ve.a.fb)&&(O.fillColorAnim=!0),Ce=0,Se=ve.s.b,B=0;B<U;B+=1)(be=Z[B]).anIndexes[j]=Ce,(1==Se&&""!==be.val||2==Se&&""!==be.val&&" "!==be.val||3==Se&&(be.n||" "==be.val||B==U-1)||4==Se&&(be.n||B==U-1))&&(1===ve.s.rn&&xe.push(Ce),Ce+=1);Q.a[j].s.totalChars=Ce;var Te,we=-1;if(1===ve.s.rn)for(B=0;B<U;B+=1)we!=(be=Z[B]).anIndexes[j]&&(we=be.anIndexes[j],Te=xe.splice(Math.floor(Math.random()*xe.length),1)[0]),be.anIndexes[j]=Te}O.yOffset=O.finalLineHeight||1.2*O.finalSize,O.ls=O.ls||0,O.ascent=ae.ascent*O.finalSize/100},TextProperty.prototype.updateDocumentData=function(O,B){B=void 0===B?this.keysIndex:B;var U=this.copyData({},this.data.d.k[B].s);U=this.copyData(U,O),this.data.d.k[B].s=U,this.recalculate(B),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(O){var B=this.data.d.k[O].s;B.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(B)},TextProperty.prototype.canResizeFont=function(O){this.canResize=O,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(O){this.minimumFontSize=Math.floor(O)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var O=Math.max,B=Math.min,U=Math.floor;function i(O,B){this._currentTextLength=-1,this.k=!1,this.data=B,this.elem=O,this.comp=O.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(O),this.s=PropertyFactory.getProp(O,B.s||{k:0},0,0,this),this.e="e"in B?PropertyFactory.getProp(O,B.e,0,0,this):{v:100},this.o=PropertyFactory.getProp(O,B.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(O,B.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(O,B.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(O,B.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(O,B.a,0,.01,this),this.dynamicProperties.length||this.getValue()}return i.prototype={getMult:function(G){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var q=0,j=0,W=1,Y=1;this.ne.v>0?q=this.ne.v/100:j=-this.ne.v/100,this.xe.v>0?W=1-this.xe.v/100:Y=1+this.xe.v/100;var K=BezierFactory.getBezierEasing(q,j,W,Y).get,Q=0,Z=this.finalS,X=this.finalE,J=this.data.sh;if(2===J)Q=K(Q=X===Z?G>=X?1:0:O(0,B(.5/(X-Z)+(G-Z)/(X-Z),1)));else if(3===J)Q=K(Q=X===Z?G>=X?0:1:1-O(0,B(.5/(X-Z)+(G-Z)/(X-Z),1)));else if(4===J)X===Z?Q=0:(Q=O(0,B(.5/(X-Z)+(G-Z)/(X-Z),1)))<.5?Q*=2:Q=1-2*(Q-.5),Q=K(Q);else if(5===J){if(X===Z)Q=0;else{var ee=X-Z,te=-ee/2+(G=B(O(0,G+.5-Z),X-Z)),ie=ee/2;Q=Math.sqrt(1-te*te/(ie*ie))}Q=K(Q)}else 6===J?(X===Z?Q=0:(G=B(O(0,G+.5-Z),X-Z),Q=(1+Math.cos(Math.PI+2*Math.PI*G/(X-Z)))/2),Q=K(Q)):(G>=U(Z)&&(Q=O(0,B(G-Z<0?B(X,1)-(Z-G):X-G,1))),Q=K(Q));if(100!==this.sm.v){var re=.01*this.sm.v;0===re&&(re=1e-8);var ne=.5-.5*re;Q<ne?Q=0:(Q=(Q-ne)/re)>1&&(Q=1)}return Q*this.a.v},getValue:function(O){this.iterateDynamicProperties(),this._mdf=O||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,O&&2===this.data.r&&(this.e.v=this._currentTextLength);var B=2===this.data.r?1:100/this.data.totalChars,U=this.o.v/B,G=this.s.v/B+U,q=this.e.v/B+U;if(G>q){var j=G;G=q,q=j}this.finalS=G,this.finalE=q}},extendPrototype([DynamicPropertyContainer],i),{getTextSelectorProp:function(O,B,U){return new i(O,B,U)}}}();function TextAnimatorDataProperty(O,B,U){var G={propType:!1},q=PropertyFactory.getProp,j=B.a;this.a={r:j.r?q(O,j.r,0,degToRads,U):G,rx:j.rx?q(O,j.rx,0,degToRads,U):G,ry:j.ry?q(O,j.ry,0,degToRads,U):G,sk:j.sk?q(O,j.sk,0,degToRads,U):G,sa:j.sa?q(O,j.sa,0,degToRads,U):G,s:j.s?q(O,j.s,1,.01,U):G,a:j.a?q(O,j.a,1,0,U):G,o:j.o?q(O,j.o,0,.01,U):G,p:j.p?q(O,j.p,1,0,U):G,sw:j.sw?q(O,j.sw,0,0,U):G,sc:j.sc?q(O,j.sc,1,0,U):G,fc:j.fc?q(O,j.fc,1,0,U):G,fh:j.fh?q(O,j.fh,0,0,U):G,fs:j.fs?q(O,j.fs,0,.01,U):G,fb:j.fb?q(O,j.fb,0,.01,U):G,t:j.t?q(O,j.t,0,0,U):G},this.s=TextSelectorProp.getTextSelectorProp(O,B.s,U),this.s.t=B.s.t}function TextAnimatorProperty(O,B,U){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=O,this._renderType=B,this._elem=U,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(U)}function ITextElement(){}TextAnimatorProperty.prototype.searchProperties=function(){var O,B,U=this._textData.a.length,G=PropertyFactory.getProp;for(O=0;O<U;O+=1)B=this._textData.a[O],this._animatorsData[O]=new TextAnimatorDataProperty(this._elem,B,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:G(this._elem,this._textData.p.a,0,0,this),f:G(this._elem,this._textData.p.f,0,0,this),l:G(this._elem,this._textData.p.l,0,0,this),r:G(this._elem,this._textData.p.r,0,0,this),p:G(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=G(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(O,B){if(this.lettersChangedFlag=B,this._mdf||this._isFirstFrame||B||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var U,G,q,j,W,Y,K,Q,Z,X,J,ee,te,ie,re,ne,oe,ae,se,le=this._moreOptions.alignment.v,ce=this._animatorsData,de=this._textData,pe=this.mHelper,ue=this._renderType,he=this.renderedLetters.length,me=O.l;if(this._hasMaskedPath){if(se=this._pathData.m,!this._pathData.n||this._pathData._mdf){var ge,fe=se.v;for(this._pathData.r.v&&(fe=fe.reverse()),W={tLength:0,segments:[]},j=fe._length-1,ne=0,q=0;q<j;q+=1)ge=bez.buildBezierData(fe.v[q],fe.v[q+1],[fe.o[q][0]-fe.v[q][0],fe.o[q][1]-fe.v[q][1]],[fe.i[q+1][0]-fe.v[q+1][0],fe.i[q+1][1]-fe.v[q+1][1]]),W.tLength+=ge.segmentLength,W.segments.push(ge),ne+=ge.segmentLength;q=j,se.v.c&&(ge=bez.buildBezierData(fe.v[q],fe.v[0],[fe.o[q][0]-fe.v[q][0],fe.o[q][1]-fe.v[q][1]],[fe.i[0][0]-fe.v[0][0],fe.i[0][1]-fe.v[0][1]]),W.tLength+=ge.segmentLength,W.segments.push(ge),ne+=ge.segmentLength),this._pathData.pi=W}if(W=this._pathData.pi,Y=this._pathData.f.v,J=0,X=1,Q=0,Z=!0,ie=W.segments,Y<0&&se.v.c)for(W.tLength<Math.abs(Y)&&(Y=-Math.abs(Y)%W.tLength),X=(te=ie[J=ie.length-1].points).length-1;Y<0;)Y+=te[X].partialLength,(X-=1)<0&&(X=(te=ie[J-=1].points).length-1);ee=(te=ie[J].points)[X-1],re=(K=te[X]).partialLength}j=me.length,U=0,G=0;var ye,_e,ve,be,Se,Ce=1.2*O.finalSize*.714,Ee=!0;ve=ce.length;var xe,Te,we,ke,Ae,Re,Ie,Pe,Ne,Oe,Me,De,Le=-1,Be=Y,Fe=J,ze=X,$e=-1,Ue="",Ve=this.defaultPropsArray;if(2===O.j||1===O.j){var Ge=0,He=0,qe=2===O.j?-.5:-1,je=0,We=!0;for(q=0;q<j;q+=1)if(me[q].n){for(Ge&&(Ge+=He);je<q;)me[je].animatorJustifyOffset=Ge,je+=1;Ge=0,We=!0}else{for(_e=0;_e<ve;_e+=1)(ye=ce[_e].a).t.propType&&(We&&2===O.j&&(He+=ye.t.v*qe),(Se=ce[_e].s.getMult(me[q].anIndexes[_e],de.a[_e].s.totalChars)).length?Ge+=ye.t.v*Se[0]*qe:Ge+=ye.t.v*Se*qe);We=!1}for(Ge&&(Ge+=He);je<q;)me[je].animatorJustifyOffset=Ge,je+=1}for(q=0;q<j;q+=1){if(pe.reset(),ke=1,me[q].n)U=0,G+=O.yOffset,G+=Ee?1:0,Y=Be,Ee=!1,this._hasMaskedPath&&(X=ze,ee=(te=ie[J=Fe].points)[X-1],re=(K=te[X]).partialLength,Q=0),Ue="",Me="",Ne="",De="",Ve=this.defaultPropsArray;else{if(this._hasMaskedPath){if($e!==me[q].line){switch(O.j){case 1:Y+=ne-O.lineWidths[me[q].line];break;case 2:Y+=(ne-O.lineWidths[me[q].line])/2}$e=me[q].line}Le!==me[q].ind&&(me[Le]&&(Y+=me[Le].extra),Y+=me[q].an/2,Le=me[q].ind),Y+=le[0]*me[q].an*.005;var Ye=0;for(_e=0;_e<ve;_e+=1)(ye=ce[_e].a).p.propType&&((Se=ce[_e].s.getMult(me[q].anIndexes[_e],de.a[_e].s.totalChars)).length?Ye+=ye.p.v[0]*Se[0]:Ye+=ye.p.v[0]*Se),ye.a.propType&&((Se=ce[_e].s.getMult(me[q].anIndexes[_e],de.a[_e].s.totalChars)).length?Ye+=ye.a.v[0]*Se[0]:Ye+=ye.a.v[0]*Se);for(Z=!0,this._pathData.a.v&&(Y=.5*me[0].an+(ne-this._pathData.f.v-.5*me[0].an-.5*me[me.length-1].an)*Le/(j-1),Y+=this._pathData.f.v);Z;)Q+re>=Y+Ye||!te?(oe=(Y+Ye-Q)/K.partialLength,Te=ee.point[0]+(K.point[0]-ee.point[0])*oe,we=ee.point[1]+(K.point[1]-ee.point[1])*oe,pe.translate(-le[0]*me[q].an*.005,-le[1]*Ce*.01),Z=!1):te&&(Q+=K.partialLength,(X+=1)>=te.length&&(X=0,ie[J+=1]?te=ie[J].points:se.v.c?(X=0,te=ie[J=0].points):(Q-=K.partialLength,te=null)),te&&(ee=K,re=(K=te[X]).partialLength));xe=me[q].an/2-me[q].add,pe.translate(-xe,0,0)}else xe=me[q].an/2-me[q].add,pe.translate(-xe,0,0),pe.translate(-le[0]*me[q].an*.005,-le[1]*Ce*.01,0);for(_e=0;_e<ve;_e+=1)(ye=ce[_e].a).t.propType&&(Se=ce[_e].s.getMult(me[q].anIndexes[_e],de.a[_e].s.totalChars),0===U&&0===O.j||(this._hasMaskedPath?Se.length?Y+=ye.t.v*Se[0]:Y+=ye.t.v*Se:Se.length?U+=ye.t.v*Se[0]:U+=ye.t.v*Se));for(O.strokeWidthAnim&&(Re=O.sw||0),O.strokeColorAnim&&(Ae=O.sc?[O.sc[0],O.sc[1],O.sc[2]]:[0,0,0]),O.fillColorAnim&&O.fc&&(Ie=[O.fc[0],O.fc[1],O.fc[2]]),_e=0;_e<ve;_e+=1)(ye=ce[_e].a).a.propType&&((Se=ce[_e].s.getMult(me[q].anIndexes[_e],de.a[_e].s.totalChars)).length?pe.translate(-ye.a.v[0]*Se[0],-ye.a.v[1]*Se[1],ye.a.v[2]*Se[2]):pe.translate(-ye.a.v[0]*Se,-ye.a.v[1]*Se,ye.a.v[2]*Se));for(_e=0;_e<ve;_e+=1)(ye=ce[_e].a).s.propType&&((Se=ce[_e].s.getMult(me[q].anIndexes[_e],de.a[_e].s.totalChars)).length?pe.scale(1+(ye.s.v[0]-1)*Se[0],1+(ye.s.v[1]-1)*Se[1],1):pe.scale(1+(ye.s.v[0]-1)*Se,1+(ye.s.v[1]-1)*Se,1));for(_e=0;_e<ve;_e+=1){if(ye=ce[_e].a,Se=ce[_e].s.getMult(me[q].anIndexes[_e],de.a[_e].s.totalChars),ye.sk.propType&&(Se.length?pe.skewFromAxis(-ye.sk.v*Se[0],ye.sa.v*Se[1]):pe.skewFromAxis(-ye.sk.v*Se,ye.sa.v*Se)),ye.r.propType&&(Se.length?pe.rotateZ(-ye.r.v*Se[2]):pe.rotateZ(-ye.r.v*Se)),ye.ry.propType&&(Se.length?pe.rotateY(ye.ry.v*Se[1]):pe.rotateY(ye.ry.v*Se)),ye.rx.propType&&(Se.length?pe.rotateX(ye.rx.v*Se[0]):pe.rotateX(ye.rx.v*Se)),ye.o.propType&&(Se.length?ke+=(ye.o.v*Se[0]-ke)*Se[0]:ke+=(ye.o.v*Se-ke)*Se),O.strokeWidthAnim&&ye.sw.propType&&(Se.length?Re+=ye.sw.v*Se[0]:Re+=ye.sw.v*Se),O.strokeColorAnim&&ye.sc.propType)for(Pe=0;Pe<3;Pe+=1)Se.length?Ae[Pe]+=(ye.sc.v[Pe]-Ae[Pe])*Se[0]:Ae[Pe]+=(ye.sc.v[Pe]-Ae[Pe])*Se;if(O.fillColorAnim&&O.fc){if(ye.fc.propType)for(Pe=0;Pe<3;Pe+=1)Se.length?Ie[Pe]+=(ye.fc.v[Pe]-Ie[Pe])*Se[0]:Ie[Pe]+=(ye.fc.v[Pe]-Ie[Pe])*Se;ye.fh.propType&&(Ie=Se.length?addHueToRGB(Ie,ye.fh.v*Se[0]):addHueToRGB(Ie,ye.fh.v*Se)),ye.fs.propType&&(Ie=Se.length?addSaturationToRGB(Ie,ye.fs.v*Se[0]):addSaturationToRGB(Ie,ye.fs.v*Se)),ye.fb.propType&&(Ie=Se.length?addBrightnessToRGB(Ie,ye.fb.v*Se[0]):addBrightnessToRGB(Ie,ye.fb.v*Se))}}for(_e=0;_e<ve;_e+=1)(ye=ce[_e].a).p.propType&&(Se=ce[_e].s.getMult(me[q].anIndexes[_e],de.a[_e].s.totalChars),this._hasMaskedPath?Se.length?pe.translate(0,ye.p.v[1]*Se[0],-ye.p.v[2]*Se[1]):pe.translate(0,ye.p.v[1]*Se,-ye.p.v[2]*Se):Se.length?pe.translate(ye.p.v[0]*Se[0],ye.p.v[1]*Se[1],-ye.p.v[2]*Se[2]):pe.translate(ye.p.v[0]*Se,ye.p.v[1]*Se,-ye.p.v[2]*Se));if(O.strokeWidthAnim&&(Ne=Re<0?0:Re),O.strokeColorAnim&&(Oe="rgb("+Math.round(255*Ae[0])+","+Math.round(255*Ae[1])+","+Math.round(255*Ae[2])+")"),O.fillColorAnim&&O.fc&&(Me="rgb("+Math.round(255*Ie[0])+","+Math.round(255*Ie[1])+","+Math.round(255*Ie[2])+")"),this._hasMaskedPath){if(pe.translate(0,-O.ls),pe.translate(0,le[1]*Ce*.01+G,0),this._pathData.p.v){ae=(K.point[1]-ee.point[1])/(K.point[0]-ee.point[0]);var Ke=180*Math.atan(ae)/Math.PI;K.point[0]<ee.point[0]&&(Ke+=180),pe.rotate(-Ke*Math.PI/180)}pe.translate(Te,we,0),Y-=le[0]*me[q].an*.005,me[q+1]&&Le!==me[q+1].ind&&(Y+=me[q].an/2,Y+=.001*O.tr*O.finalSize)}else{switch(pe.translate(U,G,0),O.ps&&pe.translate(O.ps[0],O.ps[1]+O.ascent,0),O.j){case 1:pe.translate(me[q].animatorJustifyOffset+O.justifyOffset+(O.boxWidth-O.lineWidths[me[q].line]),0,0);break;case 2:pe.translate(me[q].animatorJustifyOffset+O.justifyOffset+(O.boxWidth-O.lineWidths[me[q].line])/2,0,0)}pe.translate(0,-O.ls),pe.translate(xe,0,0),pe.translate(le[0]*me[q].an*.005,le[1]*Ce*.01,0),U+=me[q].l+.001*O.tr*O.finalSize}"html"===ue?Ue=pe.toCSS():"svg"===ue?Ue=pe.to2dCSS():Ve=[pe.props[0],pe.props[1],pe.props[2],pe.props[3],pe.props[4],pe.props[5],pe.props[6],pe.props[7],pe.props[8],pe.props[9],pe.props[10],pe.props[11],pe.props[12],pe.props[13],pe.props[14],pe.props[15]],De=ke}he<=q?(be=new LetterProps(De,Ne,Oe,Me,Ue,Ve),this.renderedLetters.push(be),he+=1,this.lettersChangedFlag=!0):(be=this.renderedLetters[q],this.lettersChangedFlag=be.update(De,Ne,Oe,Me,Ue,Ve)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),ITextElement.prototype.initElement=function(O,B,U){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(O,B,U),this.textProperty=new TextProperty(this,O.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(O.t,this.renderType,this),this.initTransform(O,B,U),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(O){this._mdf=!1,this.prepareRenderableFrame(O),this.prepareProperties(O,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},ITextElement.prototype.createPathShape=function(O,B){var U,G,q=B.length,j="";for(U=0;U<q;U+=1)"sh"===B[U].ty&&(G=B[U].ks.k,j+=buildShapeString(G,G.i.length,!0,O));return j},ITextElement.prototype.updateDocumentData=function(O,B){this.textProperty.updateDocumentData(O,B)},ITextElement.prototype.canResizeFont=function(O){this.textProperty.canResizeFont(O)},ITextElement.prototype.setMinimumFontSize=function(O){this.textProperty.setMinimumFontSize(O)},ITextElement.prototype.applyTextPropertiesToMatrix=function(O,B,U,G,q){switch(O.ps&&B.translate(O.ps[0],O.ps[1]+O.ascent,0),B.translate(0,-O.ls,0),O.j){case 1:B.translate(O.justifyOffset+(O.boxWidth-O.lineWidths[U]),0,0);break;case 2:B.translate(O.justifyOffset+(O.boxWidth-O.lineWidths[U])/2,0,0)}B.translate(G,q,0)},ITextElement.prototype.buildColor=function(O){return"rgb("+Math.round(255*O[0])+","+Math.round(255*O[1])+","+Math.round(255*O[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){};var emptyShapeData={shapes:[]};function SVGTextLottieElement(O,B,U){this.textSpans=[],this.renderType="svg",this.initElement(O,B,U)}function ISolidElement(O,B,U){this.initElement(O,B,U)}function NullElement(O,B,U){this.initFrame(),this.initBaseData(O,B,U),this.initFrame(),this.initTransform(O,B,U),this.initHierarchy()}function SVGRendererBase(){}function ICompElement(){}function SVGCompElement(O,B,U){this.layers=O.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(O,B,U),this.tm=O.tm?PropertyFactory.getProp(this,O.tm,0,B.frameRate,this):{_placeholder:!0}}function SVGRenderer(O,B){this.animationItem=O,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var U="";if(B&&B.title){var G=createNS("title"),q=createElementID();G.setAttribute("id",q),G.textContent=B.title,this.svgElement.appendChild(G),U+=q}if(B&&B.description){var j=createNS("desc"),W=createElementID();j.setAttribute("id",W),j.textContent=B.description,this.svgElement.appendChild(j),U+=" "+W}U&&this.svgElement.setAttribute("aria-labelledby",U);var Y=createNS("defs");this.svgElement.appendChild(Y);var K=createNS("g");this.svgElement.appendChild(K),this.layerElement=K,this.renderConfig={preserveAspectRatio:B&&B.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:B&&B.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:B&&B.contentVisibility||"visible",progressiveLoad:B&&B.progressiveLoad||!1,hideOnTransparent:!(B&&!1===B.hideOnTransparent),viewBoxOnly:B&&B.viewBoxOnly||!1,viewBoxSize:B&&B.viewBoxSize||!1,className:B&&B.className||"",id:B&&B.id||"",focusable:B&&B.focusable,filterSize:{width:B&&B.filterSize&&B.filterSize.width||"100%",height:B&&B.filterSize&&B.filterSize.height||"100%",x:B&&B.filterSize&&B.filterSize.x||"0%",y:B&&B.filterSize&&B.filterSize.y||"0%"},width:B&&B.width,height:B&&B.height,runExpressions:!B||void 0===B.runExpressions||B.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:Y,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function CVContextData(){var O;for(this.saved=[],this.cArrPos=0,this.cTr=new Matrix,this.cO=1,this.savedOp=createTypedArray("float32",15),O=0;O<15;O+=1)this.saved[O]=createTypedArray("float32",16);this._length=15}function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}function CVEffects(){}function CVMaskElement(O,B){var U;this.data=O,this.element=B,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var G=this.masksProperties.length,q=!1;for(U=0;U<G;U+=1)"n"!==this.masksProperties[U].mode&&(q=!0),this.viewData[U]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[U],3);this.hasMasks=q,q&&this.element.addRenderableComponent(this)}function CVBaseElement(){}function CVShapeData(O,B,U,G){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var q,j=4;"rc"===B.ty?j=5:"el"===B.ty?j=6:"sr"===B.ty&&(j=7),this.sh=ShapePropertyFactory.getShapeProp(O,B,j,O);var W,Y=U.length;for(q=0;q<Y;q+=1)U[q].closed||(W={transforms:G.addTransformSequence(U[q].transforms),trNodes:[]},this.styledShapes.push(W),U[q].elements.push(W))}function CVShapeElement(O,B,U){this.shapes=[],this.shapesData=O.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(O,B,U)}function CVTextElement(O,B,U){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(O,B,U)}function CVImageElement(O,B,U){this.assetData=B.getAssetData(O.refId),this.img=B.imageLoader.getAsset(this.assetData),this.initElement(O,B,U)}function CVSolidElement(O,B,U){this.initElement(O,B,U)}function CanvasRendererBase(O,B){this.animationItem=O,this.renderConfig={clearCanvas:!B||void 0===B.clearCanvas||B.clearCanvas,context:B&&B.context||null,progressiveLoad:B&&B.progressiveLoad||!1,preserveAspectRatio:B&&B.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:B&&B.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:B&&B.contentVisibility||"visible",className:B&&B.className||"",id:B&&B.id||""},this.renderConfig.dpr=B&&B.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=B&&B.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function CVCompElement(O,B,U){this.completeLayers=!1,this.layers=O.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(O,B,U),this.tm=O.tm?PropertyFactory.getProp(this,O.tm,0,B.frameRate,this):{_placeholder:!0}}function CanvasRenderer(O,B){this.animationItem=O,this.renderConfig={clearCanvas:!B||void 0===B.clearCanvas||B.clearCanvas,context:B&&B.context||null,progressiveLoad:B&&B.progressiveLoad||!1,preserveAspectRatio:B&&B.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:B&&B.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:B&&B.contentVisibility||"visible",className:B&&B.className||"",id:B&&B.id||"",runExpressions:!B||void 0===B.runExpressions||B.runExpressions},this.renderConfig.dpr=B&&B.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=B&&B.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function HBaseElement(){}function HSolidElement(O,B,U){this.initElement(O,B,U)}function HShapeElement(O,B,U){this.shapes=[],this.shapesData=O.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(O,B,U),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}function HTextElement(O,B,U){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(O,B,U)}function HCameraElement(O,B,U){this.initFrame(),this.initBaseData(O,B,U),this.initHierarchy();var G=PropertyFactory.getProp;if(this.pe=G(this,O.pe,0,0,this),O.ks.p.s?(this.px=G(this,O.ks.p.x,1,0,this),this.py=G(this,O.ks.p.y,1,0,this),this.pz=G(this,O.ks.p.z,1,0,this)):this.p=G(this,O.ks.p,1,0,this),O.ks.a&&(this.a=G(this,O.ks.a,1,0,this)),O.ks.or.k.length&&O.ks.or.k[0].to){var q,j=O.ks.or.k.length;for(q=0;q<j;q+=1)O.ks.or.k[q].to=null,O.ks.or.k[q].ti=null}this.or=G(this,O.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=G(this,O.ks.rx,0,degToRads,this),this.ry=G(this,O.ks.ry,0,degToRads,this),this.rz=G(this,O.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}function HImageElement(O,B,U){this.assetData=B.getAssetData(O.refId),this.initElement(O,B,U)}function HybridRendererBase(O,B){this.animationItem=O,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:B&&B.className||"",imagePreserveAspectRatio:B&&B.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(B&&!1===B.hideOnTransparent),filterSize:{width:B&&B.filterSize&&B.filterSize.width||"400%",height:B&&B.filterSize&&B.filterSize.height||"400%",x:B&&B.filterSize&&B.filterSize.x||"-100%",y:B&&B.filterSize&&B.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}function HCompElement(O,B,U){this.layers=O.layers,this.supports3d=!O.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(O,B,U),this.tm=O.tm?PropertyFactory.getProp(this,O.tm,0,B.frameRate,this):{_placeholder:!0}}function HybridRenderer(O,B){this.animationItem=O,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:B&&B.className||"",imagePreserveAspectRatio:B&&B.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(B&&!1===B.hideOnTransparent),filterSize:{width:B&&B.filterSize&&B.filterSize.width||"400%",height:B&&B.filterSize&&B.filterSize.height||"400%",x:B&&B.filterSize&&B.filterSize.x||"-100%",y:B&&B.filterSize&&B.filterSize.y||"-100%"},runExpressions:!B||void 0===B.runExpressions||B.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(O){for(var B=0,U=O.length,G=[],q="";B<U;)O[B]===String.fromCharCode(13)||O[B]===String.fromCharCode(3)?(G.push(q),q=""):q+=O[B],B+=1;return G.push(q),G},SVGTextLottieElement.prototype.buildShapeData=function(O,B){if(O.shapes&&O.shapes.length){var U=O.shapes[0];if(U.it){var G=U.it[U.it.length-1];G.s&&(G.s.k[0]=B,G.s.k[1]=B)}}return O},SVGTextLottieElement.prototype.buildNewText=function(){var O,B;this.addDynamicProperty(this);var U=this.textProperty.currentData;this.renderedLetters=createSizedArray(U?U.l.length:0),U.fc?this.layerElement.setAttribute("fill",this.buildColor(U.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),U.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(U.sc)),this.layerElement.setAttribute("stroke-width",U.sw)),this.layerElement.setAttribute("font-size",U.finalSize);var G=this.globalData.fontManager.getFontByName(U.f);if(G.fClass)this.layerElement.setAttribute("class",G.fClass);else{this.layerElement.setAttribute("font-family",G.fFamily);var q=U.fWeight,j=U.fStyle;this.layerElement.setAttribute("font-style",j),this.layerElement.setAttribute("font-weight",q)}this.layerElement.setAttribute("aria-label",U.t);var W,Y=U.l||[],K=!!this.globalData.fontManager.chars;B=Y.length;var Q=this.mHelper,Z=this.data.singleShape,X=0,J=0,ee=!0,te=.001*U.tr*U.finalSize;if(!Z||K||U.sz){var ie,re=this.textSpans.length;for(O=0;O<B;O+=1){if(this.textSpans[O]||(this.textSpans[O]={span:null,childSpan:null,glyph:null}),!K||!Z||0===O){if(W=re>O?this.textSpans[O].span:createNS(K?"g":"text"),re<=O){if(W.setAttribute("stroke-linecap","butt"),W.setAttribute("stroke-linejoin","round"),W.setAttribute("stroke-miterlimit","4"),this.textSpans[O].span=W,K){var ne=createNS("g");W.appendChild(ne),this.textSpans[O].childSpan=ne}this.textSpans[O].span=W,this.layerElement.appendChild(W)}W.style.display="inherit"}if(Q.reset(),Z&&(Y[O].n&&(X=-te,J+=U.yOffset,J+=ee?1:0,ee=!1),this.applyTextPropertiesToMatrix(U,Q,Y[O].line,X,J),X+=Y[O].l||0,X+=te),K){var oe;if(1===(ie=this.globalData.fontManager.getCharData(U.finalText[O],G.fStyle,this.globalData.fontManager.getFontByName(U.f).fFamily)).t)oe=new SVGCompElement(ie.data,this.globalData,this);else{var ae=emptyShapeData;ie.data&&ie.data.shapes&&(ae=this.buildShapeData(ie.data,U.finalSize)),oe=new SVGShapeElement(ae,this.globalData,this)}if(this.textSpans[O].glyph){var se=this.textSpans[O].glyph;this.textSpans[O].childSpan.removeChild(se.layerElement),se.destroy()}this.textSpans[O].glyph=oe,oe._debug=!0,oe.prepareFrame(0),oe.renderFrame(),this.textSpans[O].childSpan.appendChild(oe.layerElement),1===ie.t&&this.textSpans[O].childSpan.setAttribute("transform","scale("+U.finalSize/100+","+U.finalSize/100+")")}else Z&&W.setAttribute("transform","translate("+Q.props[12]+","+Q.props[13]+")"),W.textContent=Y[O].val,W.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}Z&&W&&W.setAttribute("d","")}else{var le=this.textContainer,ce="start";switch(U.j){case 1:ce="end";break;case 2:ce="middle";break;default:ce="start"}le.setAttribute("text-anchor",ce),le.setAttribute("letter-spacing",te);var de=this.buildTextContents(U.finalText);for(B=de.length,J=U.ps?U.ps[1]+U.ascent:0,O=0;O<B;O+=1)(W=this.textSpans[O].span||createNS("tspan")).textContent=de[O],W.setAttribute("x",0),W.setAttribute("y",J),W.style.display="inherit",le.appendChild(W),this.textSpans[O]||(this.textSpans[O]={span:null,glyph:null}),this.textSpans[O].span=W,J+=U.finalLineHeight;this.layerElement.appendChild(le)}for(;O<this.textSpans.length;)this.textSpans[O].span.style.display="none",O+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var O=this.layerElement.getBBox();this.bbox={top:O.y,left:O.x,width:O.width,height:O.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var O,B,U=this.textSpans.length;for(this.renderedFrame=this.comp.renderedFrame,O=0;O<U;O+=1)(B=this.textSpans[O].glyph)&&(B.prepareFrame(this.comp.renderedFrame-this.data.st),B._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if((!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var O,B;this._sizeChanged=!0;var U,G,q,j=this.textAnimator.renderedLetters,W=this.textProperty.currentData.l;for(B=W.length,O=0;O<B;O+=1)W[O].n||(U=j[O],G=this.textSpans[O].span,(q=this.textSpans[O].glyph)&&q.renderFrame(),U._mdf.m&&G.setAttribute("transform",U.m),U._mdf.o&&G.setAttribute("opacity",U.o),U._mdf.sw&&G.setAttribute("stroke-width",U.sw),U._mdf.sc&&G.setAttribute("stroke",U.sc),U._mdf.fc&&G.setAttribute("fill",U.fc))}},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var O=createNS("rect");O.setAttribute("width",this.data.sw),O.setAttribute("height",this.data.sh),O.setAttribute("fill",this.data.sc),this.layerElement.appendChild(O)},NullElement.prototype.prepareFrame=function(O){this.prepareProperties(O,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(O){return new NullElement(O,this.globalData,this)},SVGRendererBase.prototype.createShape=function(O){return new SVGShapeElement(O,this.globalData,this)},SVGRendererBase.prototype.createText=function(O){return new SVGTextLottieElement(O,this.globalData,this)},SVGRendererBase.prototype.createImage=function(O){return new IImageElement(O,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(O){return new ISolidElement(O,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(O){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+O.w+" "+O.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",O.w),this.svgElement.setAttribute("height",O.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var B=this.globalData.defs;this.setupGlobalData(O,B),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=O;var U=createNS("clipPath"),G=createNS("rect");G.setAttribute("width",O.w),G.setAttribute("height",O.h),G.setAttribute("x",0),G.setAttribute("y",0);var q=createElementID();U.setAttribute("id",q),U.appendChild(G),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+q+")"),B.appendChild(U),this.layers=O.layers,this.elements=createSizedArray(O.layers.length)},SVGRendererBase.prototype.destroy=function(){var O;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var B=this.layers?this.layers.length:0;for(O=0;O<B;O+=1)this.elements[O]&&this.elements[O].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(O){var B=0,U=this.layers.length;for(B=0;B<U;B+=1)if(this.layers[B].ind===O)return B;return-1},SVGRendererBase.prototype.buildItem=function(O){var B=this.elements;if(!B[O]&&99!==this.layers[O].ty){B[O]=!0;var U=this.createItem(this.layers[O]);if(B[O]=U,getExpressionsPlugin()&&(0===this.layers[O].ty&&this.globalData.projectInterface.registerComposition(U),U.initExpressions()),this.appendElementInPos(U,O),this.layers[O].tt){var G="tp"in this.layers[O]?this.findIndexByInd(this.layers[O].tp):O-1;if(-1===G)return;if(this.elements[G]&&!0!==this.elements[G]){var q=B[G].getMatte(this.layers[O].tt);U.setMatte(q)}else this.buildItem(G),this.addPendingElement(U)}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var O=this.pendingElements.pop();if(O.checkParenting(),O.data.tt)for(var B=0,U=this.elements.length;B<U;){if(this.elements[B]===O){var G="tp"in O.data?this.findIndexByInd(O.data.tp):B-1,q=this.elements[G].getMatte(this.layers[B].tt);O.setMatte(q);break}B+=1}}},SVGRendererBase.prototype.renderFrame=function(O){if(this.renderedFrame!==O&&!this.destroyed){var B;null===O?O=this.renderedFrame:this.renderedFrame=O,this.globalData.frameNum=O,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=O,this.globalData._mdf=!1;var U=this.layers.length;for(this.completeLayers||this.checkLayers(O),B=U-1;B>=0;B-=1)(this.completeLayers||this.elements[B])&&this.elements[B].prepareFrame(O-this.layers[B].st);if(this.globalData._mdf)for(B=0;B<U;B+=1)(this.completeLayers||this.elements[B])&&this.elements[B].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(O,B){var U=O.getBaseElement();if(U){for(var G,q=0;q<B;)this.elements[q]&&!0!==this.elements[q]&&this.elements[q].getBaseElement()&&(G=this.elements[q].getBaseElement()),q+=1;G?this.layerElement.insertBefore(U,G):this.layerElement.appendChild(U)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(O,B,U){this.initFrame(),this.initBaseData(O,B,U),this.initTransform(O,B,U),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&B.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(O){if(this._mdf=!1,this.prepareRenderableFrame(O),this.prepareProperties(O,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=O/this.data.sr;else{var B=this.tm.v;B===this.data.op&&(B=this.data.op-1),this.renderedFrame=B}var U,G=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),U=G-1;U>=0;U-=1)(this.completeLayers||this.elements[U])&&(this.elements[U].prepareFrame(this.renderedFrame-this.layers[U].st),this.elements[U]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var O,B=this.layers.length;for(O=0;O<B;O+=1)(this.completeLayers||this.elements[O])&&this.elements[O].renderFrame()},ICompElement.prototype.setElements=function(O){this.elements=O},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var O,B=this.layers.length;for(O=0;O<B;O+=1)this.elements[O]&&this.elements[O].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(O){return new SVGCompElement(O,this.globalData,this)},extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(O){return new SVGCompElement(O,this.globalData,this)},CVContextData.prototype.duplicate=function(){var O=2*this._length,B=this.savedOp;this.savedOp=createTypedArray("float32",O),this.savedOp.set(B);var U=0;for(U=this._length;U<O;U+=1)this.saved[U]=createTypedArray("float32",16);this._length=O},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.cO=1},ShapeTransformManager.prototype={addTransformSequence:function(O){var B,U=O.length,G="_";for(B=0;B<U;B+=1)G+=O[B].transform.key+"_";var q=this.sequences[G];return q||(q={transforms:[].concat(O),finalTransform:new Matrix,_mdf:!1},this.sequences[G]=q,this.sequenceList.push(q)),q},processSequence:function(O,B){for(var U,G=0,q=O.transforms.length,j=B;G<q&&!B;){if(O.transforms[G].transform.mProps._mdf){j=!0;break}G+=1}if(j)for(O.finalTransform.reset(),G=q-1;G>=0;G-=1)U=O.transforms[G].transform.mProps.v.props,O.finalTransform.transform(U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15]);O._mdf=j},processSequences:function(O){var B,U=this.sequenceList.length;for(B=0;B<U;B+=1)this.processSequence(this.sequenceList[B],O)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}},CVEffects.prototype.renderFrame=function(){},CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var O,B,U,G,q=this.element.finalTransform.mat,j=this.element.canvasContext,W=this.masksProperties.length;for(j.beginPath(),O=0;O<W;O+=1)if("n"!==this.masksProperties[O].mode){var Y;this.masksProperties[O].inv&&(j.moveTo(0,0),j.lineTo(this.element.globalData.compSize.w,0),j.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),j.lineTo(0,this.element.globalData.compSize.h),j.lineTo(0,0)),G=this.viewData[O].v,B=q.applyToPointArray(G.v[0][0],G.v[0][1],0),j.moveTo(B[0],B[1]);var K=G._length;for(Y=1;Y<K;Y+=1)U=q.applyToTriplePoints(G.o[Y-1],G.i[Y],G.v[Y]),j.bezierCurveTo(U[0],U[1],U[2],U[3],U[4],U[5]);U=q.applyToTriplePoints(G.o[Y-1],G.i[0],G.v[0]),j.bezierCurveTo(U[0],U[1],U[2],U[3],U[4],U[5])}this.element.globalData.renderer.save(!0),j.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null},CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){this.canvasContext=this.globalData.canvasContext,this.renderableEffectsManager=new CVEffects(this)},createContent:function(){},setBlendMode:function(){var O=this.globalData;if(O.blendMode!==this.data.bm){O.blendMode=this.data.bm;var B=getBlendMode(this.data.bm);O.canvasContext.globalCompositeOperation=B}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this)},hideElement:function(){this.hidden||this.isInRange&&!this.isTransparent||(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},renderFrame:function(){if(!this.hidden&&!this.data.hd){this.renderTransform(),this.renderRenderable(),this.setBlendMode();var O=0===this.data.ty;this.globalData.renderer.save(O),this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),this.renderInnerContent(),this.globalData.renderer.restore(O),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement,CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated,extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(O,B){var U={data:O,type:O.ty,preTransforms:this.transformsManager.addTransformSequence(B),transforms:[],elements:[],closed:!0===O.hd},G={};if("fl"===O.ty||"st"===O.ty?(G.c=PropertyFactory.getProp(this,O.c,1,255,this),G.c.k||(U.co="rgb("+bmFloor(G.c.v[0])+","+bmFloor(G.c.v[1])+","+bmFloor(G.c.v[2])+")")):"gf"!==O.ty&&"gs"!==O.ty||(G.s=PropertyFactory.getProp(this,O.s,1,null,this),G.e=PropertyFactory.getProp(this,O.e,1,null,this),G.h=PropertyFactory.getProp(this,O.h||{k:0},0,.01,this),G.a=PropertyFactory.getProp(this,O.a||{k:0},0,degToRads,this),G.g=new GradientProperty(this,O.g,this)),G.o=PropertyFactory.getProp(this,O.o,0,.01,this),"st"===O.ty||"gs"===O.ty){if(U.lc=lineCapEnum[O.lc||2],U.lj=lineJoinEnum[O.lj||2],1==O.lj&&(U.ml=O.ml),G.w=PropertyFactory.getProp(this,O.w,0,null,this),G.w.k||(U.wi=G.w.v),O.d){var q=new DashProperty(this,O.d,"canvas",this);G.d=q,G.d.k||(U.da=G.d.dashArray,U.do=G.d.dashoffset[0])}}else U.r=2===O.r?"evenodd":"nonzero";return this.stylesList.push(U),G.style=U,G},CVShapeElement.prototype.createGroupElement=function(){return{it:[],prevViewData:[]}},CVShapeElement.prototype.createTransformElement=function(O){return{transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,O.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,O,this)}}},CVShapeElement.prototype.createShapeElement=function(O){var B=new CVShapeData(this,O,this.stylesList,this.transformsManager);return this.shapes.push(B),this.addShapeToModifiers(B),B},CVShapeElement.prototype.reloadShapes=function(){var O;this._isFirstFrame=!0;var B=this.itemsData.length;for(O=0;O<B;O+=1)this.prevViewData[O]=this.itemsData[O];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),B=this.dynamicProperties.length,O=0;O<B;O+=1)this.dynamicProperties[O].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(O){var B,U=this.stylesList.length;for(B=0;B<U;B+=1)this.stylesList[B].closed||this.stylesList[B].transforms.push(O)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var O,B=this.stylesList.length;for(O=0;O<B;O+=1)this.stylesList[O].closed||this.stylesList[O].transforms.pop()},CVShapeElement.prototype.closeStyles=function(O){var B,U=O.length;for(B=0;B<U;B+=1)O[B].closed=!0},CVShapeElement.prototype.searchShapes=function(O,B,U,G,q){var j,W,Y,K,Q,Z,X=O.length-1,J=[],ee=[],te=[].concat(q);for(j=X;j>=0;j-=1){if((K=this.searchProcessedElement(O[j]))?B[j]=U[K-1]:O[j]._shouldRender=G,"fl"===O[j].ty||"st"===O[j].ty||"gf"===O[j].ty||"gs"===O[j].ty)K?B[j].style.closed=!1:B[j]=this.createStyleElement(O[j],te),J.push(B[j].style);else if("gr"===O[j].ty){if(K)for(Y=B[j].it.length,W=0;W<Y;W+=1)B[j].prevViewData[W]=B[j].it[W];else B[j]=this.createGroupElement(O[j]);this.searchShapes(O[j].it,B[j].it,B[j].prevViewData,G,te)}else"tr"===O[j].ty?(K||(Z=this.createTransformElement(O[j]),B[j]=Z),te.push(B[j]),this.addTransformToStyleList(B[j])):"sh"===O[j].ty||"rc"===O[j].ty||"el"===O[j].ty||"sr"===O[j].ty?K||(B[j]=this.createShapeElement(O[j])):"tm"===O[j].ty||"rd"===O[j].ty||"pb"===O[j].ty||"zz"===O[j].ty||"op"===O[j].ty?(K?(Q=B[j]).closed=!1:((Q=ShapeModifiers.getModifier(O[j].ty)).init(this,O[j]),B[j]=Q,this.shapeModifiers.push(Q)),ee.push(Q)):"rp"===O[j].ty&&(K?(Q=B[j]).closed=!0:(Q=ShapeModifiers.getModifier(O[j].ty),B[j]=Q,Q.init(this,O,j,B),this.shapeModifiers.push(Q),G=!1),ee.push(Q));this.addProcessedElement(O[j],j+1)}for(this.removeTransformFromStyleList(),this.closeStyles(J),X=ee.length,j=0;j<X;j+=1)ee[j].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(O,B){(O._opMdf||B.op._mdf||this._isFirstFrame)&&(B.opacity=O.opacity,B.opacity*=B.op.v,B._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var O,B,U,G,q,j,W,Y,K,Q=this.stylesList.length,Z=this.globalData.renderer,X=this.globalData.canvasContext;for(O=0;O<Q;O+=1)if(("st"!==(Y=(K=this.stylesList[O]).type)&&"gs"!==Y||0!==K.wi)&&K.data._shouldRender&&0!==K.coOp&&0!==this.globalData.currentGlobalAlpha){for(Z.save(),j=K.elements,"st"===Y||"gs"===Y?(X.strokeStyle="st"===Y?K.co:K.grd,X.lineWidth=K.wi,X.lineCap=K.lc,X.lineJoin=K.lj,X.miterLimit=K.ml||0):X.fillStyle="fl"===Y?K.co:K.grd,Z.ctxOpacity(K.coOp),"st"!==Y&&"gs"!==Y&&X.beginPath(),Z.ctxTransform(K.preTransforms.finalTransform.props),U=j.length,B=0;B<U;B+=1){for("st"!==Y&&"gs"!==Y||(X.beginPath(),K.da&&(X.setLineDash(K.da),X.lineDashOffset=K.do)),q=(W=j[B].trNodes).length,G=0;G<q;G+=1)"m"===W[G].t?X.moveTo(W[G].p[0],W[G].p[1]):"c"===W[G].t?X.bezierCurveTo(W[G].pts[0],W[G].pts[1],W[G].pts[2],W[G].pts[3],W[G].pts[4],W[G].pts[5]):X.closePath();"st"!==Y&&"gs"!==Y||(X.stroke(),K.da&&X.setLineDash(this.dashResetter))}"st"!==Y&&"gs"!==Y&&X.fill(K.r),Z.restore()}},CVShapeElement.prototype.renderShape=function(O,B,U,G){var q,j;for(j=O,q=B.length-1;q>=0;q-=1)"tr"===B[q].ty?(j=U[q].transform,this.renderShapeTransform(O,j)):"sh"===B[q].ty||"el"===B[q].ty||"rc"===B[q].ty||"sr"===B[q].ty?this.renderPath(B[q],U[q]):"fl"===B[q].ty?this.renderFill(B[q],U[q],j):"st"===B[q].ty?this.renderStroke(B[q],U[q],j):"gf"===B[q].ty||"gs"===B[q].ty?this.renderGradientFill(B[q],U[q],j):"gr"===B[q].ty?this.renderShape(j,B[q].it,U[q].it):B[q].ty;G&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(O,B){if(this._isFirstFrame||B._mdf||O.transforms._mdf){var U,G,q,j=O.trNodes,W=B.paths,Y=W._length;j.length=0;var K=O.transforms.finalTransform;for(q=0;q<Y;q+=1){var Q=W.shapes[q];if(Q&&Q.v){for(G=Q._length,U=1;U<G;U+=1)1===U&&j.push({t:"m",p:K.applyToPointArray(Q.v[0][0],Q.v[0][1],0)}),j.push({t:"c",pts:K.applyToTriplePoints(Q.o[U-1],Q.i[U],Q.v[U])});1===G&&j.push({t:"m",p:K.applyToPointArray(Q.v[0][0],Q.v[0][1],0)}),Q.c&&G&&(j.push({t:"c",pts:K.applyToTriplePoints(Q.o[U-1],Q.i[0],Q.v[0])}),j.push({t:"z"}))}}O.trNodes=j}},CVShapeElement.prototype.renderPath=function(O,B){if(!0!==O.hd&&O._shouldRender){var U,G=B.styledShapes.length;for(U=0;U<G;U+=1)this.renderStyledShape(B.styledShapes[U],B.sh)}},CVShapeElement.prototype.renderFill=function(O,B,U){var G=B.style;(B.c._mdf||this._isFirstFrame)&&(G.co="rgb("+bmFloor(B.c.v[0])+","+bmFloor(B.c.v[1])+","+bmFloor(B.c.v[2])+")"),(B.o._mdf||U._opMdf||this._isFirstFrame)&&(G.coOp=B.o.v*U.opacity)},CVShapeElement.prototype.renderGradientFill=function(O,B,U){var G,q=B.style;if(!q.grd||B.g._mdf||B.s._mdf||B.e._mdf||1!==O.t&&(B.h._mdf||B.a._mdf)){var j,W=this.globalData.canvasContext,Y=B.s.v,K=B.e.v;if(1===O.t)G=W.createLinearGradient(Y[0],Y[1],K[0],K[1]);else{var Q=Math.sqrt(Math.pow(Y[0]-K[0],2)+Math.pow(Y[1]-K[1],2)),Z=Math.atan2(K[1]-Y[1],K[0]-Y[0]),X=B.h.v;X>=1?X=.99:X<=-1&&(X=-.99);var J=Q*X,ee=Math.cos(Z+B.a.v)*J+Y[0],te=Math.sin(Z+B.a.v)*J+Y[1];G=W.createRadialGradient(ee,te,0,Y[0],Y[1],Q)}var ie=O.g.p,re=B.g.c,ne=1;for(j=0;j<ie;j+=1)B.g._hasOpacity&&B.g._collapsable&&(ne=B.g.o[2*j+1]),G.addColorStop(re[4*j]/100,"rgba("+re[4*j+1]+","+re[4*j+2]+","+re[4*j+3]+","+ne+")");q.grd=G}q.coOp=B.o.v*U.opacity},CVShapeElement.prototype.renderStroke=function(O,B,U){var G=B.style,q=B.d;q&&(q._mdf||this._isFirstFrame)&&(G.da=q.dashArray,G.do=q.dashoffset[0]),(B.c._mdf||this._isFirstFrame)&&(G.co="rgb("+bmFloor(B.c.v[0])+","+bmFloor(B.c.v[1])+","+bmFloor(B.c.v[2])+")"),(B.o._mdf||U._opMdf||this._isFirstFrame)&&(G.coOp=B.o.v*U.opacity),(B.w._mdf||this._isFirstFrame)&&(G.wi=B.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var O=this.textProperty.currentData;this.renderedLetters=createSizedArray(O.l?O.l.length:0);var B=!1;O.fc?(B=!0,this.values.fill=this.buildColor(O.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=B;var U=!1;O.sc&&(U=!0,this.values.stroke=this.buildColor(O.sc),this.values.sWidth=O.sw);var G,q,j,W,Y,K,Q,Z,X,J,ee,te,ie=this.globalData.fontManager.getFontByName(O.f),re=O.l,ne=this.mHelper;this.stroke=U,this.values.fValue=O.finalSize+"px "+this.globalData.fontManager.getFontByName(O.f).fFamily,q=O.finalText.length;var oe=this.data.singleShape,ae=.001*O.tr*O.finalSize,se=0,le=0,ce=!0,de=0;for(G=0;G<q;G+=1){W=(j=this.globalData.fontManager.getCharData(O.finalText[G],ie.fStyle,this.globalData.fontManager.getFontByName(O.f).fFamily))&&j.data||{},ne.reset(),oe&&re[G].n&&(se=-ae,le+=O.yOffset,le+=ce?1:0,ce=!1),X=(Q=W.shapes?W.shapes[0].it:[]).length,ne.scale(O.finalSize/100,O.finalSize/100),oe&&this.applyTextPropertiesToMatrix(O,ne,re[G].line,se,le),ee=createSizedArray(X-1);var pe=0;for(Z=0;Z<X;Z+=1)if("sh"===Q[Z].ty){for(K=Q[Z].ks.k.i.length,J=Q[Z].ks.k,te=[],Y=1;Y<K;Y+=1)1===Y&&te.push(ne.applyToX(J.v[0][0],J.v[0][1],0),ne.applyToY(J.v[0][0],J.v[0][1],0)),te.push(ne.applyToX(J.o[Y-1][0],J.o[Y-1][1],0),ne.applyToY(J.o[Y-1][0],J.o[Y-1][1],0),ne.applyToX(J.i[Y][0],J.i[Y][1],0),ne.applyToY(J.i[Y][0],J.i[Y][1],0),ne.applyToX(J.v[Y][0],J.v[Y][1],0),ne.applyToY(J.v[Y][0],J.v[Y][1],0));te.push(ne.applyToX(J.o[Y-1][0],J.o[Y-1][1],0),ne.applyToY(J.o[Y-1][0],J.o[Y-1][1],0),ne.applyToX(J.i[0][0],J.i[0][1],0),ne.applyToY(J.i[0][0],J.i[0][1],0),ne.applyToX(J.v[0][0],J.v[0][1],0),ne.applyToY(J.v[0][0],J.v[0][1],0)),ee[pe]=te,pe+=1}oe&&(se+=re[G].l,se+=ae),this.textSpans[de]?this.textSpans[de].elem=ee:this.textSpans[de]={elem:ee},de+=1}},CVTextElement.prototype.renderInnerContent=function(){var O,B,U,G,q,j,W=this.canvasContext;W.font=this.values.fValue,W.lineCap="butt",W.lineJoin="miter",W.miterLimit=4,this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var Y,K=this.textAnimator.renderedLetters,Q=this.textProperty.currentData.l;B=Q.length;var Z,X,J=null,ee=null,te=null;for(O=0;O<B;O+=1)if(!Q[O].n){if((Y=K[O])&&(this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(Y.p),this.globalData.renderer.ctxOpacity(Y.o)),this.fill){for(Y&&Y.fc?J!==Y.fc&&(J=Y.fc,W.fillStyle=Y.fc):J!==this.values.fill&&(J=this.values.fill,W.fillStyle=this.values.fill),G=(Z=this.textSpans[O].elem).length,this.globalData.canvasContext.beginPath(),U=0;U<G;U+=1)for(j=(X=Z[U]).length,this.globalData.canvasContext.moveTo(X[0],X[1]),q=2;q<j;q+=6)this.globalData.canvasContext.bezierCurveTo(X[q],X[q+1],X[q+2],X[q+3],X[q+4],X[q+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.fill()}if(this.stroke){for(Y&&Y.sw?te!==Y.sw&&(te=Y.sw,W.lineWidth=Y.sw):te!==this.values.sWidth&&(te=this.values.sWidth,W.lineWidth=this.values.sWidth),Y&&Y.sc?ee!==Y.sc&&(ee=Y.sc,W.strokeStyle=Y.sc):ee!==this.values.stroke&&(ee=this.values.stroke,W.strokeStyle=this.values.stroke),G=(Z=this.textSpans[O].elem).length,this.globalData.canvasContext.beginPath(),U=0;U<G;U+=1)for(j=(X=Z[U]).length,this.globalData.canvasContext.moveTo(X[0],X[1]),q=2;q<j;q+=6)this.globalData.canvasContext.bezierCurveTo(X[q],X[q+1],X[q+2],X[q+3],X[q+4],X[q+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.stroke()}Y&&this.globalData.renderer.restore()}},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var O=createTag("canvas");O.width=this.assetData.w,O.height=this.assetData.h;var B,U,G=O.getContext("2d"),q=this.img.width,j=this.img.height,W=q/j,Y=this.assetData.w/this.assetData.h,K=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;W>Y&&"xMidYMid slice"===K||W<Y&&"xMidYMid slice"!==K?B=(U=j)*Y:U=(B=q)/Y,G.drawImage(this.img,(q-B)/2,(j-U)/2,B,U,0,0,this.assetData.w,this.assetData.h),this.img=O}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){var O=this.canvasContext;O.fillStyle=this.data.sc,O.fillRect(0,0,this.data.sw,this.data.sh)},extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(O){return new CVShapeElement(O,this.globalData,this)},CanvasRendererBase.prototype.createText=function(O){return new CVTextElement(O,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(O){return new CVImageElement(O,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(O){return new CVSolidElement(O,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(O){if(1!==O[0]||0!==O[1]||0!==O[4]||1!==O[5]||0!==O[12]||0!==O[13])if(this.renderConfig.clearCanvas){this.transformMat.cloneFromProps(O);var B=this.contextData.cTr.props;this.transformMat.transform(B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8],B[9],B[10],B[11],B[12],B[13],B[14],B[15]),this.contextData.cTr.cloneFromProps(this.transformMat.props);var U=this.contextData.cTr.props;this.canvasContext.setTransform(U[0],U[1],U[4],U[5],U[12],U[13])}else this.canvasContext.transform(O[0],O[1],O[4],O[5],O[12],O[13])},CanvasRendererBase.prototype.ctxOpacity=function(O){if(!this.renderConfig.clearCanvas)return this.canvasContext.globalAlpha*=O<0?0:O,void(this.globalData.currentGlobalAlpha=this.contextData.cO);this.contextData.cO*=O<0?0:O,this.globalData.currentGlobalAlpha!==this.contextData.cO&&(this.canvasContext.globalAlpha=this.contextData.cO,this.globalData.currentGlobalAlpha=this.contextData.cO)},CanvasRendererBase.prototype.reset=function(){this.renderConfig.clearCanvas?this.contextData.reset():this.canvasContext.restore()},CanvasRendererBase.prototype.save=function(O){if(this.renderConfig.clearCanvas){O&&this.canvasContext.save();var B,U=this.contextData.cTr.props;this.contextData._length<=this.contextData.cArrPos&&this.contextData.duplicate();var G=this.contextData.saved[this.contextData.cArrPos];for(B=0;B<16;B+=1)G[B]=U[B];this.contextData.savedOp[this.contextData.cArrPos]=this.contextData.cO,this.contextData.cArrPos+=1}else this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(O){if(this.renderConfig.clearCanvas){O&&(this.canvasContext.restore(),this.globalData.blendMode="source-over"),this.contextData.cArrPos-=1;var B,U=this.contextData.saved[this.contextData.cArrPos],G=this.contextData.cTr.props;for(B=0;B<16;B+=1)G[B]=U[B];this.canvasContext.setTransform(U[0],U[1],U[4],U[5],U[12],U[13]),U=this.contextData.savedOp[this.contextData.cArrPos],this.contextData.cO=U,this.globalData.currentGlobalAlpha!==U&&(this.canvasContext.globalAlpha=U,this.globalData.currentGlobalAlpha=U)}else this.canvasContext.restore()},CanvasRendererBase.prototype.configAnimation=function(O){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var B=this.animationItem.container.style;B.width="100%",B.height="100%";var U="0px 0px 0px";B.transformOrigin=U,B.mozTransformOrigin=U,B.webkitTransformOrigin=U,B["-webkit-transform"]=U,B.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.data=O,this.layers=O.layers,this.transformCanvas={w:O.w,h:O.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(O,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(O.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(O,B){var U,G,q,j;if(this.reset(),O?(U=O,G=B,this.canvasContext.canvas.width=U,this.canvasContext.canvas.height=G):(this.animationItem.wrapper&&this.animationItem.container?(U=this.animationItem.wrapper.offsetWidth,G=this.animationItem.wrapper.offsetHeight):(U=this.canvasContext.canvas.width,G=this.canvasContext.canvas.height),this.canvasContext.canvas.width=U*this.renderConfig.dpr,this.canvasContext.canvas.height=G*this.renderConfig.dpr),-1!==this.renderConfig.preserveAspectRatio.indexOf("meet")||-1!==this.renderConfig.preserveAspectRatio.indexOf("slice")){var W=this.renderConfig.preserveAspectRatio.split(" "),Y=W[1]||"meet",K=W[0]||"xMidYMid",Q=K.substr(0,4),Z=K.substr(4);q=U/G,(j=this.transformCanvas.w/this.transformCanvas.h)>q&&"meet"===Y||j<q&&"slice"===Y?(this.transformCanvas.sx=U/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=U/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=G/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=G/(this.transformCanvas.h/this.renderConfig.dpr)),this.transformCanvas.tx="xMid"===Q&&(j<q&&"meet"===Y||j>q&&"slice"===Y)?(U-this.transformCanvas.w*(G/this.transformCanvas.h))/2*this.renderConfig.dpr:"xMax"===Q&&(j<q&&"meet"===Y||j>q&&"slice"===Y)?(U-this.transformCanvas.w*(G/this.transformCanvas.h))*this.renderConfig.dpr:0,this.transformCanvas.ty="YMid"===Z&&(j>q&&"meet"===Y||j<q&&"slice"===Y)?(G-this.transformCanvas.h*(U/this.transformCanvas.w))/2*this.renderConfig.dpr:"YMax"===Z&&(j>q&&"meet"===Y||j<q&&"slice"===Y)?(G-this.transformCanvas.h*(U/this.transformCanvas.w))*this.renderConfig.dpr:0}else"none"===this.renderConfig.preserveAspectRatio?(this.transformCanvas.sx=U/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=G/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){var O;for(this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),O=(this.layers?this.layers.length:0)-1;O>=0;O-=1)this.elements[O]&&this.elements[O].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(O,B){if((this.renderedFrame!==O||!0!==this.renderConfig.clearCanvas||B)&&!this.destroyed&&-1!==O){var U;this.renderedFrame=O,this.globalData.frameNum=O-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||B,this.globalData.projectInterface.currentFrame=O;var G=this.layers.length;for(this.completeLayers||this.checkLayers(O),U=0;U<G;U+=1)(this.completeLayers||this.elements[U])&&this.elements[U].prepareFrame(O-this.layers[U].st);if(this.globalData._mdf){for(!0===this.renderConfig.clearCanvas?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),U=G-1;U>=0;U-=1)(this.completeLayers||this.elements[U])&&this.elements[U].renderFrame();!0!==this.renderConfig.clearCanvas&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(O){var B=this.elements;if(!B[O]&&99!==this.layers[O].ty){var U=this.createItem(this.layers[O],this,this.globalData);B[O]=U,U.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"},extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var O,B=this.canvasContext;for(B.beginPath(),B.moveTo(0,0),B.lineTo(this.data.w,0),B.lineTo(this.data.w,this.data.h),B.lineTo(0,this.data.h),B.lineTo(0,0),B.clip(),O=this.layers.length-1;O>=0;O-=1)(this.completeLayers||this.elements[O])&&this.elements[O].renderFrame()},CVCompElement.prototype.destroy=function(){var O;for(O=this.layers.length-1;O>=0;O-=1)this.elements[O]&&this.elements[O].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(O){return new CVCompElement(O,this.globalData,this)},extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(O){return new CVCompElement(O,this.globalData,this)},HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){var O=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var B=this.finalTransform.mat.toCSS();O.transform=B,O.webkitTransform=B}this.finalTransform._opMdf&&(O.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting,extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var O;this.data.hasMask?((O=createNS("rect")).setAttribute("width",this.data.sw),O.setAttribute("height",this.data.sh),O.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):((O=createTag("div")).style.width=this.data.sw+"px",O.style.height=this.data.sh+"px",O.style.backgroundColor=this.data.sc),this.layerElement.appendChild(O)},extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var O;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),O=this.svgElement;else{O=createNS("svg");var B=this.comp.data?this.comp.data:this.globalData.compSize;O.setAttribute("width",B.w),O.setAttribute("height",B.h),O.appendChild(this.shapesContainer),this.layerElement.appendChild(O)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=O},HShapeElement.prototype.getTransformedPoint=function(O,B){var U,G=O.length;for(U=0;U<G;U+=1)B=O[U].mProps.v.applyToPointArray(B[0],B[1],0);return B},HShapeElement.prototype.calculateShapeBoundingBox=function(O,B){var U,G,q,j,W,Y=O.sh.v,K=O.transformers,Q=Y._length;if(!(Q<=1)){for(U=0;U<Q-1;U+=1)G=this.getTransformedPoint(K,Y.v[U]),q=this.getTransformedPoint(K,Y.o[U]),j=this.getTransformedPoint(K,Y.i[U+1]),W=this.getTransformedPoint(K,Y.v[U+1]),this.checkBounds(G,q,j,W,B);Y.c&&(G=this.getTransformedPoint(K,Y.v[U]),q=this.getTransformedPoint(K,Y.o[U]),j=this.getTransformedPoint(K,Y.i[0]),W=this.getTransformedPoint(K,Y.v[0]),this.checkBounds(G,q,j,W,B))}},HShapeElement.prototype.checkBounds=function(O,B,U,G,q){this.getBoundsOfCurve(O,B,U,G);var j=this.shapeBoundingBox;q.x=bmMin(j.left,q.x),q.xMax=bmMax(j.right,q.xMax),q.y=bmMin(j.top,q.y),q.yMax=bmMax(j.bottom,q.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(O,B,U,G){for(var q,j,W,Y,K,Q,Z,X=[[O[0],G[0]],[O[1],G[1]]],J=0;J<2;++J)j=6*O[J]-12*B[J]+6*U[J],q=-3*O[J]+9*B[J]-9*U[J]+3*G[J],W=3*B[J]-3*O[J],j|=0,W|=0,0==(q|=0)&&0===j||(0===q?(Y=-W/j)>0&&Y<1&&X[J].push(this.calculateF(Y,O,B,U,G,J)):(K=j*j-4*W*q)>=0&&((Q=(-j+bmSqrt(K))/(2*q))>0&&Q<1&&X[J].push(this.calculateF(Q,O,B,U,G,J)),(Z=(-j-bmSqrt(K))/(2*q))>0&&Z<1&&X[J].push(this.calculateF(Z,O,B,U,G,J))));this.shapeBoundingBox.left=bmMin.apply(null,X[0]),this.shapeBoundingBox.top=bmMin.apply(null,X[1]),this.shapeBoundingBox.right=bmMax.apply(null,X[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,X[1])},HShapeElement.prototype.calculateF=function(O,B,U,G,q,j){return bmPow(1-O,3)*B[j]+3*bmPow(1-O,2)*O*U[j]+3*(1-O)*bmPow(O,2)*G[j]+bmPow(O,3)*q[j]},HShapeElement.prototype.calculateBoundingBox=function(O,B){var U,G=O.length;for(U=0;U<G;U+=1)O[U]&&O[U].sh?this.calculateShapeBoundingBox(O[U],B):O[U]&&O[U].it?this.calculateBoundingBox(O[U].it,B):O[U]&&O[U].style&&O[U].w&&this.expandStrokeBoundingBox(O[U].w,B)},HShapeElement.prototype.expandStrokeBoundingBox=function(O,B){var U=0;if(O.keyframes){for(var G=0;G<O.keyframes.length;G+=1){var q=O.keyframes[G].s;q>U&&(U=q)}U*=O.mult}else U=O.v*O.mult;B.x-=U,B.xMax+=U,B.y-=U,B.yMax+=U},HShapeElement.prototype.currentBoxContains=function(O){return this.currentBBox.x<=O.x&&this.currentBBox.y<=O.y&&this.currentBBox.width+this.currentBBox.x>=O.x+O.width&&this.currentBBox.height+this.currentBBox.y>=O.y+O.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var O=this.tempBoundingBox,B=999999;if(O.x=B,O.xMax=-B,O.y=B,O.yMax=-B,this.calculateBoundingBox(this.itemsData,O),O.width=O.xMax<O.x?0:O.xMax-O.x,O.height=O.yMax<O.y?0:O.yMax-O.y,this.currentBoxContains(O))return;var U=!1;if(this.currentBBox.w!==O.width&&(this.currentBBox.w=O.width,this.shapeCont.setAttribute("width",O.width),U=!0),this.currentBBox.h!==O.height&&(this.currentBBox.h=O.height,this.shapeCont.setAttribute("height",O.height),U=!0),U||this.currentBBox.x!==O.x||this.currentBBox.y!==O.y){this.currentBBox.w=O.width,this.currentBBox.h=O.height,this.currentBBox.x=O.x,this.currentBBox.y=O.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var G=this.shapeCont.style,q="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";G.transform=q,G.webkitTransform=q}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var O=createNS("g");this.maskedElement.appendChild(O),this.innerElem=O}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var O=this.textProperty.currentData;this.renderedLetters=createSizedArray(O.l?O.l.length:0);var B=this.innerElem.style,U=O.fc?this.buildColor(O.fc):"rgba(0,0,0,0)";B.fill=U,B.color=U,O.sc&&(B.stroke=this.buildColor(O.sc),B.strokeWidth=O.sw+"px");var G,q,j=this.globalData.fontManager.getFontByName(O.f);if(!this.globalData.fontManager.chars)if(B.fontSize=O.finalSize+"px",B.lineHeight=O.finalSize+"px",j.fClass)this.innerElem.className=j.fClass;else{B.fontFamily=j.fFamily;var W=O.fWeight,Y=O.fStyle;B.fontStyle=Y,B.fontWeight=W}var K,Q,Z,X=O.l;q=X.length;var J,ee=this.mHelper,te="",ie=0;for(G=0;G<q;G+=1){if(this.globalData.fontManager.chars?(this.textPaths[ie]?K=this.textPaths[ie]:((K=createNS("path")).setAttribute("stroke-linecap",lineCapEnum[1]),K.setAttribute("stroke-linejoin",lineJoinEnum[2]),K.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[ie]?Z=(Q=this.textSpans[ie]).children[0]:((Q=createTag("div")).style.lineHeight=0,(Z=createNS("svg")).appendChild(K),styleDiv(Q)))):this.isMasked?K=this.textPaths[ie]?this.textPaths[ie]:createNS("text"):this.textSpans[ie]?(Q=this.textSpans[ie],K=this.textPaths[ie]):(styleDiv(Q=createTag("span")),styleDiv(K=createTag("span")),Q.appendChild(K)),this.globalData.fontManager.chars){var re,ne=this.globalData.fontManager.getCharData(O.finalText[G],j.fStyle,this.globalData.fontManager.getFontByName(O.f).fFamily);if(re=ne?ne.data:null,ee.reset(),re&&re.shapes&&re.shapes.length&&(J=re.shapes[0].it,ee.scale(O.finalSize/100,O.finalSize/100),te=this.createPathShape(ee,J),K.setAttribute("d",te)),this.isMasked)this.innerElem.appendChild(K);else{if(this.innerElem.appendChild(Q),re&&re.shapes){document.body.appendChild(Z);var oe=Z.getBBox();Z.setAttribute("width",oe.width+2),Z.setAttribute("height",oe.height+2),Z.setAttribute("viewBox",oe.x-1+" "+(oe.y-1)+" "+(oe.width+2)+" "+(oe.height+2));var ae=Z.style,se="translate("+(oe.x-1)+"px,"+(oe.y-1)+"px)";ae.transform=se,ae.webkitTransform=se,X[G].yOffset=oe.y-1}else Z.setAttribute("width",1),Z.setAttribute("height",1);Q.appendChild(Z)}}else if(K.textContent=X[G].val,K.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(K);else{this.innerElem.appendChild(Q);var le=K.style,ce="translate3d(0,"+-O.finalSize/1.2+"px,0)";le.transform=ce,le.webkitTransform=ce}this.isMasked?this.textSpans[ie]=K:this.textSpans[ie]=Q,this.textSpans[ie].style.display="block",this.textPaths[ie]=K,ie+=1}for(;ie<this.textSpans.length;)this.textSpans[ie].style.display="none",ie+=1},HTextElement.prototype.renderInnerContent=function(){var O;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),O=this.svgElement.style;var B="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";O.transform=B,O.webkitTransform=B}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag){var U,G,q,j,W,Y=0,K=this.textAnimator.renderedLetters,Q=this.textProperty.currentData.l;for(G=Q.length,U=0;U<G;U+=1)Q[U].n?Y+=1:(j=this.textSpans[U],W=this.textPaths[U],q=K[Y],Y+=1,q._mdf.m&&(this.isMasked?j.setAttribute("transform",q.m):(j.style.webkitTransform=q.m,j.style.transform=q.m)),j.style.opacity=q.o,q.sw&&q._mdf.sw&&W.setAttribute("stroke-width",q.sw),q.sc&&q._mdf.sc&&W.setAttribute("stroke",q.sc),q.fc&&q._mdf.fc&&(W.setAttribute("fill",q.fc),W.style.color=q.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var Z=this.innerElem.getBBox();if(this.currentBBox.w!==Z.width&&(this.currentBBox.w=Z.width,this.svgElement.setAttribute("width",Z.width)),this.currentBBox.h!==Z.height&&(this.currentBBox.h=Z.height,this.svgElement.setAttribute("height",Z.height)),this.currentBBox.w!==Z.width+2||this.currentBBox.h!==Z.height+2||this.currentBBox.x!==Z.x-1||this.currentBBox.y!==Z.y-1){this.currentBBox.w=Z.width+2,this.currentBBox.h=Z.height+2,this.currentBBox.x=Z.x-1,this.currentBBox.y=Z.y-1,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),O=this.svgElement.style;var X="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";O.transform=X,O.webkitTransform=X}}}},extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var O,B,U,G,q=this.comp.threeDElements.length;for(O=0;O<q;O+=1)if("3d"===(B=this.comp.threeDElements[O]).type){U=B.perspectiveElem.style,G=B.container.style;var j=this.pe.v+"px",W="0px 0px 0px",Y="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";U.perspective=j,U.webkitPerspective=j,G.transformOrigin=W,G.mozTransformOrigin=W,G.webkitTransformOrigin=W,U.transform=Y,U.webkitTransform=Y}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var O,B,U=this._isFirstFrame;if(this.hierarchy)for(B=this.hierarchy.length,O=0;O<B;O+=1)U=this.hierarchy[O].finalTransform.mProp._mdf||U;if(U||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(O=B=this.hierarchy.length-1;O>=0;O-=1){var G=this.hierarchy[O].finalTransform.mProp;this.mat.translate(-G.p.v[0],-G.p.v[1],G.p.v[2]),this.mat.rotateX(-G.or.v[0]).rotateY(-G.or.v[1]).rotateZ(G.or.v[2]),this.mat.rotateX(-G.rx.v).rotateY(-G.ry.v).rotateZ(G.rz.v),this.mat.scale(1/G.s.v[0],1/G.s.v[1],1/G.s.v[2]),this.mat.translate(G.a.v[0],G.a.v[1],G.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var q;q=this.p?[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var j=Math.sqrt(Math.pow(q[0],2)+Math.pow(q[1],2)+Math.pow(q[2],2)),W=[q[0]/j,q[1]/j,q[2]/j],Y=Math.sqrt(W[2]*W[2]+W[0]*W[0]),K=Math.atan2(W[1],Y),Q=Math.atan2(W[0],-W[2]);this.mat.rotateY(Q).rotateX(-K)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var Z=!this._prevMat.equals(this.mat);if((Z||this.pe._mdf)&&this.comp.threeDElements){var X,J,ee;for(B=this.comp.threeDElements.length,O=0;O<B;O+=1)if("3d"===(X=this.comp.threeDElements[O]).type){if(Z){var te=this.mat.toCSS();(ee=X.container.style).transform=te,ee.webkitTransform=te}this.pe._mdf&&((J=X.perspectiveElem.style).perspective=this.pe.v+"px",J.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(O){this.prepareProperties(O,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null},extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var O=this.globalData.getAssetsPath(this.assetData),B=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",O),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(B),B.crossOrigin="anonymous",B.src=O,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)},extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},HybridRendererBase.prototype.appendElementInPos=function(O,B){var U=O.getBaseElement();if(U){var G=this.layers[B];if(G.ddd&&this.supports3d)this.addTo3dContainer(U,B);else if(this.threeDElements)this.addTo3dContainer(U,B);else{for(var q,j,W=0;W<B;)this.elements[W]&&!0!==this.elements[W]&&this.elements[W].getBaseElement&&(j=this.elements[W],q=(this.layers[W].ddd?this.getThreeDContainerByPos(W):j.getBaseElement())||q),W+=1;q?G.ddd&&this.supports3d||this.layerElement.insertBefore(U,q):G.ddd&&this.supports3d||this.layerElement.appendChild(U)}}},HybridRendererBase.prototype.createShape=function(O){return this.supports3d?new HShapeElement(O,this.globalData,this):new SVGShapeElement(O,this.globalData,this)},HybridRendererBase.prototype.createText=function(O){return this.supports3d?new HTextElement(O,this.globalData,this):new SVGTextLottieElement(O,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(O){return this.camera=new HCameraElement(O,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(O){return this.supports3d?new HImageElement(O,this.globalData,this):new IImageElement(O,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(O){return this.supports3d?new HSolidElement(O,this.globalData,this):new ISolidElement(O,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(O){for(var B=0,U=this.threeDElements.length;B<U;){if(this.threeDElements[B].startPos<=O&&this.threeDElements[B].endPos>=O)return this.threeDElements[B].perspectiveElem;B+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(O,B){var U,G,q=createTag("div");styleDiv(q);var j=createTag("div");if(styleDiv(j),"3d"===B){(U=q.style).width=this.globalData.compSize.w+"px",U.height=this.globalData.compSize.h+"px";var W="50% 50%";U.webkitTransformOrigin=W,U.mozTransformOrigin=W,U.transformOrigin=W;var Y="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";(G=j.style).transform=Y,G.webkitTransform=Y}q.appendChild(j);var K={container:j,perspectiveElem:q,startPos:O,endPos:O,type:B};return this.threeDElements.push(K),K},HybridRendererBase.prototype.build3dContainers=function(){var O,B,U=this.layers.length,G="";for(O=0;O<U;O+=1)this.layers[O].ddd&&3!==this.layers[O].ty?("3d"!==G&&(G="3d",B=this.createThreeDContainer(O,"3d")),B.endPos=Math.max(B.endPos,O)):("2d"!==G&&(G="2d",B=this.createThreeDContainer(O,"2d")),B.endPos=Math.max(B.endPos,O));for(O=(U=this.threeDElements.length)-1;O>=0;O-=1)this.resizerElem.appendChild(this.threeDElements[O].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(O,B){for(var U=0,G=this.threeDElements.length;U<G;){if(B<=this.threeDElements[U].endPos){for(var q,j=this.threeDElements[U].startPos;j<B;)this.elements[j]&&this.elements[j].getBaseElement&&(q=this.elements[j].getBaseElement()),j+=1;q?this.threeDElements[U].container.insertBefore(O,q):this.threeDElements[U].container.appendChild(O);break}U+=1}},HybridRendererBase.prototype.configAnimation=function(O){var B=createTag("div"),U=this.animationItem.wrapper,G=B.style;G.width=O.w+"px",G.height=O.h+"px",this.resizerElem=B,styleDiv(B),G.transformStyle="flat",G.mozTransformStyle="flat",G.webkitTransformStyle="flat",this.renderConfig.className&&B.setAttribute("class",this.renderConfig.className),U.appendChild(B),G.overflow="hidden";var q=createNS("svg");q.setAttribute("width","1"),q.setAttribute("height","1"),styleDiv(q),this.resizerElem.appendChild(q);var j=createNS("defs");q.appendChild(j),this.data=O,this.setupGlobalData(O,q),this.globalData.defs=j,this.layers=O.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){var O;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var B=this.layers?this.layers.length:0;for(O=0;O<B;O+=1)this.elements[O].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var O,B,U,G,q=this.animationItem.wrapper.offsetWidth,j=this.animationItem.wrapper.offsetHeight,W=q/j;this.globalData.compSize.w/this.globalData.compSize.h>W?(O=q/this.globalData.compSize.w,B=q/this.globalData.compSize.w,U=0,G=(j-this.globalData.compSize.h*(q/this.globalData.compSize.w))/2):(O=j/this.globalData.compSize.h,B=j/this.globalData.compSize.h,U=(q-this.globalData.compSize.w*(j/this.globalData.compSize.h))/2,G=0);var Y=this.resizerElem.style;Y.webkitTransform="matrix3d("+O+",0,0,0,0,"+B+",0,0,0,0,1,0,"+U+","+G+",0,1)",Y.transform=Y.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var O,B=this.globalData.compSize.w,U=this.globalData.compSize.h,G=this.threeDElements.length;for(O=0;O<G;O+=1){var q=this.threeDElements[O].perspectiveElem.style;q.webkitPerspective=Math.sqrt(Math.pow(B,2)+Math.pow(U,2))+"px",q.perspective=q.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(O){var B,U=O.length,G=createTag("div");for(B=0;B<U;B+=1)if(O[B].xt){var q=this.createComp(O[B],G,this.globalData.comp,null);q.initExpressions(),this.globalData.projectInterface.registerComposition(q)}},extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(O,B){for(var U,G=0;G<B;)this.elements[G]&&this.elements[G].getBaseElement&&(U=this.elements[G].getBaseElement()),G+=1;U?this.layerElement.insertBefore(O,U):this.layerElement.appendChild(O)},HCompElement.prototype.createComp=function(O){return this.supports3d?new HCompElement(O,this.globalData,this):new SVGCompElement(O,this.globalData,this)},extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(O){return this.supports3d?new HCompElement(O,this.globalData,this):new SVGCompElement(O,this.globalData,this)};var CompExpressionInterface=function(O){function e(B){for(var U=0,G=O.layers.length;U<G;){if(O.layers[U].nm===B||O.layers[U].ind===B)return O.elements[U].layerInterface;U+=1}return null}return Object.defineProperty(e,"_name",{value:O.data.nm}),e.layer=e,e.pixelAspect=1,e.height=O.data.h||O.globalData.compSize.h,e.width=O.data.w||O.globalData.compSize.w,e.pixelAspect=1,e.frameDuration=1/O.globalData.frameRate,e.displayStartTime=0,e.numLayers=O.layers.length,e},Expressions=function(){var O={initExpressions:function(O){var B=0,U=[];O.renderer.compInterface=CompExpressionInterface(O.renderer),O.renderer.globalData.projectInterface.registerComposition(O.renderer),O.renderer.globalData.pushExpression=function(){B+=1},O.renderer.globalData.popExpression=function(){0==(B-=1)&&function(){var O,B=U.length;for(O=0;O<B;O+=1)U[O].release();U.length=0}()},O.renderer.globalData.registerExpressionProperty=function(O){-1===U.indexOf(O)&&U.push(O)}}};return O}(),MaskManagerInterface=function(){function t(O,B){this._mask=O,this._data=B}return Object.defineProperty(t.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(t.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}}),function(O){var B,U=createSizedArray(O.viewData.length),G=O.viewData.length;for(B=0;B<G;B+=1)U[B]=new t(O.viewData[B],O.masksProperties[B]);return function(q){for(B=0;B<G;){if(O.masksProperties[B].nm===q)return U[B];B+=1}return null}}}(),ExpressionPropertyInterface=function(){var O={pv:0,v:0,mult:1},B={pv:[0,0,0],v:[0,0,0],mult:1};function r(O,B,U){Object.defineProperty(O,"velocity",{get:function(){return B.getVelocityAtTime(B.comp.currentFrame)}}),O.numKeys=B.keyframes?B.keyframes.length:0,O.key=function(G){if(!O.numKeys)return 0;var q;q="s"in B.keyframes[G-1]?B.keyframes[G-1].s:"e"in B.keyframes[G-2]?B.keyframes[G-2].e:B.keyframes[G-2].s;var j="unidimensional"===U?new Number(q):Object.assign({},q);return j.time=B.keyframes[G-1].t/B.elem.comp.globalData.frameRate,j.value="unidimensional"===U?q[0]:q,j},O.valueAtTime=B.getValueAtTime,O.speedAtTime=B.getSpeedAtTime,O.velocityAtTime=B.getVelocityAtTime,O.propertyGroup=B.propertyGroup}function i(){return O}return function(U){return U?"unidimensional"===U.propType?function(B){B&&"pv"in B||(B=O);var U=1/B.mult,G=B.pv*U,q=new Number(G);return q.value=G,r(q,B,"unidimensional"),function(){return B.k&&B.getValue(),G=B.v*U,q.value!==G&&((q=new Number(G)).value=G,r(q,B,"unidimensional")),q}}(U):function(O){O&&"pv"in O||(O=B);var U=1/O.mult,G=O.data&&O.data.l||O.pv.length,q=createTypedArray("float32",G),j=createTypedArray("float32",G);return q.value=j,r(q,O,"multidimensional"),function(){O.k&&O.getValue();for(var B=0;B<G;B+=1)j[B]=O.v[B]*U,q[B]=j[B];return q}}(U):i}}(),TransformExpressionInterface=function(O){function e(O){switch(O){case"scale":case"Scale":case"ADBE Scale":case 6:return e.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return e.rotation;case"ADBE Rotate X":return e.xRotation;case"ADBE Rotate Y":return e.yRotation;case"position":case"Position":case"ADBE Position":case 2:return e.position;case"ADBE Position_0":return e.xPosition;case"ADBE Position_1":return e.yPosition;case"ADBE Position_2":return e.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return e.anchorPoint;case"opacity":case"Opacity":case 11:return e.opacity;default:return null}}var B,U,G,q;return Object.defineProperty(e,"rotation",{get:ExpressionPropertyInterface(O.r||O.rz)}),Object.defineProperty(e,"zRotation",{get:ExpressionPropertyInterface(O.rz||O.r)}),Object.defineProperty(e,"xRotation",{get:ExpressionPropertyInterface(O.rx)}),Object.defineProperty(e,"yRotation",{get:ExpressionPropertyInterface(O.ry)}),Object.defineProperty(e,"scale",{get:ExpressionPropertyInterface(O.s)}),O.p?q=ExpressionPropertyInterface(O.p):(B=ExpressionPropertyInterface(O.px),U=ExpressionPropertyInterface(O.py),O.pz&&(G=ExpressionPropertyInterface(O.pz))),Object.defineProperty(e,"position",{get:function(){return O.p?q():[B(),U(),G?G():0]}}),Object.defineProperty(e,"xPosition",{get:ExpressionPropertyInterface(O.px)}),Object.defineProperty(e,"yPosition",{get:ExpressionPropertyInterface(O.py)}),Object.defineProperty(e,"zPosition",{get:ExpressionPropertyInterface(O.pz)}),Object.defineProperty(e,"anchorPoint",{get:ExpressionPropertyInterface(O.a)}),Object.defineProperty(e,"opacity",{get:ExpressionPropertyInterface(O.o)}),Object.defineProperty(e,"skew",{get:ExpressionPropertyInterface(O.sk)}),Object.defineProperty(e,"skewAxis",{get:ExpressionPropertyInterface(O.sa)}),Object.defineProperty(e,"orientation",{get:ExpressionPropertyInterface(O.or)}),e},LayerExpressionInterface=function(){function t(O){var B=new Matrix;return void 0!==O?this._elem.finalTransform.mProp.getValueAtTime(O).clone(B):this._elem.finalTransform.mProp.applyToMatrix(B),B}function e(O,B){var U=this.getMatrix(B);return U.props[12]=0,U.props[13]=0,U.props[14]=0,this.applyPoint(U,O)}function r(O,B){var U=this.getMatrix(B);return this.applyPoint(U,O)}function i(O,B){var U=this.getMatrix(B);return U.props[12]=0,U.props[13]=0,U.props[14]=0,this.invertPoint(U,O)}function s(O,B){var U=this.getMatrix(B);return this.invertPoint(U,O)}function a(O,B){if(this._elem.hierarchy&&this._elem.hierarchy.length){var U,G=this._elem.hierarchy.length;for(U=0;U<G;U+=1)this._elem.hierarchy[U].finalTransform.mProp.applyToMatrix(O)}return O.applyToPointArray(B[0],B[1],B[2]||0)}function n(O,B){if(this._elem.hierarchy&&this._elem.hierarchy.length){var U,G=this._elem.hierarchy.length;for(U=0;U<G;U+=1)this._elem.hierarchy[U].finalTransform.mProp.applyToMatrix(O)}return O.inversePoint(B)}function o(O){var B=new Matrix;if(B.reset(),this._elem.finalTransform.mProp.applyToMatrix(B),this._elem.hierarchy&&this._elem.hierarchy.length){var U,G=this._elem.hierarchy.length;for(U=0;U<G;U+=1)this._elem.hierarchy[U].finalTransform.mProp.applyToMatrix(B);return B.inversePoint(O)}return B.inversePoint(O)}function h(){return[1,1,1,1]}return function(O){var B;function c(O){switch(O){case"ADBE Root Vectors Group":case"Contents":case 2:return c.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return B;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return c.effect;case"ADBE Text Properties":return c.textInterface;default:return null}}c.getMatrix=t,c.invertPoint=n,c.applyPoint=a,c.toWorld=r,c.toWorldVec=e,c.fromWorld=s,c.fromWorldVec=i,c.toComp=r,c.fromComp=o,c.sampleImage=h,c.sourceRectAtTime=O.sourceRectAtTime.bind(O),c._elem=O;var U=getDescriptor(B=TransformExpressionInterface(O.finalTransform.mProp),"anchorPoint");return Object.defineProperties(c,{hasParent:{get:function(){return O.hierarchy.length}},parent:{get:function(){return O.hierarchy[0].layerInterface}},rotation:getDescriptor(B,"rotation"),scale:getDescriptor(B,"scale"),position:getDescriptor(B,"position"),opacity:getDescriptor(B,"opacity"),anchorPoint:U,anchor_point:U,transform:{get:function(){return B}},active:{get:function(){return O.isInRange}}}),c.startTime=O.data.st,c.index=O.data.ind,c.source=O.data.refId,c.height=0===O.data.ty?O.data.h:100,c.width=0===O.data.ty?O.data.w:100,c.inPoint=O.data.ip/O.comp.globalData.frameRate,c.outPoint=O.data.op/O.comp.globalData.frameRate,c._name=O.data.nm,c.registerMaskInterface=function(B){c.mask=new MaskManagerInterface(B,O)},c.registerEffectsInterface=function(O){c.effect=O},c}}(),propertyGroupFactory=function(O,B){return function(U){return(U=void 0===U?1:U)<=0?O:B(U-1)}},PropertyInterface=function(O,B){var U={_name:O};return function(O){return(O=void 0===O?1:O)<=0?U:B(O-1)}},EffectsExpressionInterface=function(){var O={createEffectsInterface:function(O,B){if(O.effectsManager){var U,G=[],q=O.data.ef,j=O.effectsManager.effectElements.length;for(U=0;U<j;U+=1)G.push(e(q[U],O.effectsManager.effectElements[U],B,O));var W=O.data.ef||[],h=function(O){for(U=0,j=W.length;U<j;){if(O===W[U].nm||O===W[U].mn||O===W[U].ix)return G[U];U+=1}return null};return Object.defineProperty(h,"numProperties",{get:function(){return W.length}}),h}return null}};function e(O,B,U,G){function n(B){for(var U=O.ef,G=0,q=U.length;G<q;){if(B===U[G].nm||B===U[G].mn||B===U[G].ix)return 5===U[G].ty?W[G]:W[G]();G+=1}throw new Error}var q,j=propertyGroupFactory(n,U),W=[],Y=O.ef.length;for(q=0;q<Y;q+=1)5===O.ef[q].ty?W.push(e(O.ef[q],B.effectElements[q],B.effectElements[q].propertyGroup,G)):W.push(r(B.effectElements[q],O.ef[q].ty,G,j));return"ADBE Color Control"===O.mn&&Object.defineProperty(n,"color",{get:function(){return W[0]()}}),Object.defineProperties(n,{numProperties:{get:function(){return O.np}},_name:{value:O.nm},propertyGroup:{value:j}}),n.enabled=0!==O.en,n.active=n.enabled,n}function r(O,B,U,G){var q=ExpressionPropertyInterface(O.p);return O.p.setGroupProperty&&O.p.setGroupProperty(PropertyInterface("",G)),function(){return 10===B?U.comp.compInterface(O.p.v):q()}}return O}(),ShapePathInterface=function(O,B,U){var G=B.sh;function s(O){return"Shape"===O||"shape"===O||"Path"===O||"path"===O||"ADBE Vector Shape"===O||2===O?s.path:null}var q=propertyGroupFactory(s,U);return G.setGroupProperty(PropertyInterface("Path",q)),Object.defineProperties(s,{path:{get:function(){return G.k&&G.getValue(),G}},shape:{get:function(){return G.k&&G.getValue(),G}},_name:{value:O.nm},ix:{value:O.ix},propertyIndex:{value:O.ix},mn:{value:O.mn},propertyGroup:{value:U}}),s},ShapeExpressionInterface=function(){function t(O,B,U){var G,q=[],j=O?O.length:0;for(G=0;G<j;G+=1)"gr"===O[G].ty?q.push(e(O[G],B[G],U)):"fl"===O[G].ty?q.push(r(O[G],B[G],U)):"st"===O[G].ty?q.push(s(O[G],B[G],U)):"tm"===O[G].ty?q.push(a(O[G],B[G],U)):"tr"===O[G].ty||("el"===O[G].ty?q.push(o(O[G],B[G],U)):"sr"===O[G].ty?q.push(h(O[G],B[G],U)):"sh"===O[G].ty?q.push(ShapePathInterface(O[G],B[G],U)):"rc"===O[G].ty?q.push(l(O[G],B[G],U)):"rd"===O[G].ty?q.push(p(O[G],B[G],U)):"rp"===O[G].ty?q.push(c(O[G],B[G],U)):"gf"===O[G].ty?q.push(i(O[G],B[G],U)):q.push((O[G],B[G],function(){return null})));return q}function e(O,B,U){var s=function(O){switch(O){case"ADBE Vectors Group":case"Contents":case 2:return s.content;default:return s.transform}};s.propertyGroup=propertyGroupFactory(s,U);var G=function(O,B,U){var G,a=function(O){for(var B=0,U=G.length;B<U;){if(G[B]._name===O||G[B].mn===O||G[B].propertyIndex===O||G[B].ix===O||G[B].ind===O)return G[B];B+=1}return"number"==typeof O?G[O-1]:null};a.propertyGroup=propertyGroupFactory(a,U),G=t(O.it,B.it,a.propertyGroup),a.numProperties=G.length;var q=n(O.it[O.it.length-1],B.it[B.it.length-1],a.propertyGroup);return a.transform=q,a.propertyIndex=O.cix,a._name=O.nm,a}(O,B,s.propertyGroup),q=n(O.it[O.it.length-1],B.it[B.it.length-1],s.propertyGroup);return s.content=G,s.transform=q,Object.defineProperty(s,"_name",{get:function(){return O.nm}}),s.numProperties=O.np,s.propertyIndex=O.ix,s.nm=O.nm,s.mn=O.mn,s}function r(O,B,U){function i(O){return"Color"===O||"color"===O?i.color:"Opacity"===O||"opacity"===O?i.opacity:null}return Object.defineProperties(i,{color:{get:ExpressionPropertyInterface(B.c)},opacity:{get:ExpressionPropertyInterface(B.o)},_name:{value:O.nm},mn:{value:O.mn}}),B.c.setGroupProperty(PropertyInterface("Color",U)),B.o.setGroupProperty(PropertyInterface("Opacity",U)),i}function i(O,B,U){function i(O){return"Start Point"===O||"start point"===O?i.startPoint:"End Point"===O||"end point"===O?i.endPoint:"Opacity"===O||"opacity"===O?i.opacity:null}return Object.defineProperties(i,{startPoint:{get:ExpressionPropertyInterface(B.s)},endPoint:{get:ExpressionPropertyInterface(B.e)},opacity:{get:ExpressionPropertyInterface(B.o)},type:{get:function(){return"a"}},_name:{value:O.nm},mn:{value:O.mn}}),B.s.setGroupProperty(PropertyInterface("Start Point",U)),B.e.setGroupProperty(PropertyInterface("End Point",U)),B.o.setGroupProperty(PropertyInterface("Opacity",U)),i}function s(O,B,U){var G,q=propertyGroupFactory(l,U),j=propertyGroupFactory(Y,q);function n(U){Object.defineProperty(Y,O.d[U].nm,{get:ExpressionPropertyInterface(B.d.dataProps[U].p)})}var W=O.d?O.d.length:0,Y={};for(G=0;G<W;G+=1)n(G),B.d.dataProps[G].p.setGroupProperty(j);function l(O){return"Color"===O||"color"===O?l.color:"Opacity"===O||"opacity"===O?l.opacity:"Stroke Width"===O||"stroke width"===O?l.strokeWidth:null}return Object.defineProperties(l,{color:{get:ExpressionPropertyInterface(B.c)},opacity:{get:ExpressionPropertyInterface(B.o)},strokeWidth:{get:ExpressionPropertyInterface(B.w)},dash:{get:function(){return Y}},_name:{value:O.nm},mn:{value:O.mn}}),B.c.setGroupProperty(PropertyInterface("Color",q)),B.o.setGroupProperty(PropertyInterface("Opacity",q)),B.w.setGroupProperty(PropertyInterface("Stroke Width",q)),l}function a(O,B,U){function i(B){return B===O.e.ix||"End"===B||"end"===B?i.end:B===O.s.ix?i.start:B===O.o.ix?i.offset:null}var G=propertyGroupFactory(i,U);return i.propertyIndex=O.ix,B.s.setGroupProperty(PropertyInterface("Start",G)),B.e.setGroupProperty(PropertyInterface("End",G)),B.o.setGroupProperty(PropertyInterface("Offset",G)),i.propertyIndex=O.ix,i.propertyGroup=U,Object.defineProperties(i,{start:{get:ExpressionPropertyInterface(B.s)},end:{get:ExpressionPropertyInterface(B.e)},offset:{get:ExpressionPropertyInterface(B.o)},_name:{value:O.nm}}),i.mn=O.mn,i}function n(O,B,U){function i(B){return O.a.ix===B||"Anchor Point"===B?i.anchorPoint:O.o.ix===B||"Opacity"===B?i.opacity:O.p.ix===B||"Position"===B?i.position:O.r.ix===B||"Rotation"===B||"ADBE Vector Rotation"===B?i.rotation:O.s.ix===B||"Scale"===B?i.scale:O.sk&&O.sk.ix===B||"Skew"===B?i.skew:O.sa&&O.sa.ix===B||"Skew Axis"===B?i.skewAxis:null}var G=propertyGroupFactory(i,U);return B.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",G)),B.transform.mProps.p.setGroupProperty(PropertyInterface("Position",G)),B.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",G)),B.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",G)),B.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",G)),B.transform.mProps.sk&&(B.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",G)),B.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",G))),B.transform.op.setGroupProperty(PropertyInterface("Opacity",G)),Object.defineProperties(i,{opacity:{get:ExpressionPropertyInterface(B.transform.mProps.o)},position:{get:ExpressionPropertyInterface(B.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(B.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(B.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(B.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(B.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(B.transform.mProps.sa)},_name:{value:O.nm}}),i.ty="tr",i.mn=O.mn,i.propertyGroup=U,i}function o(O,B,U){function i(B){return O.p.ix===B?i.position:O.s.ix===B?i.size:null}var G=propertyGroupFactory(i,U);i.propertyIndex=O.ix;var q="tm"===B.sh.ty?B.sh.prop:B.sh;return q.s.setGroupProperty(PropertyInterface("Size",G)),q.p.setGroupProperty(PropertyInterface("Position",G)),Object.defineProperties(i,{size:{get:ExpressionPropertyInterface(q.s)},position:{get:ExpressionPropertyInterface(q.p)},_name:{value:O.nm}}),i.mn=O.mn,i}function h(O,B,U){function i(B){return O.p.ix===B?i.position:O.r.ix===B?i.rotation:O.pt.ix===B?i.points:O.or.ix===B||"ADBE Vector Star Outer Radius"===B?i.outerRadius:O.os.ix===B?i.outerRoundness:!O.ir||O.ir.ix!==B&&"ADBE Vector Star Inner Radius"!==B?O.is&&O.is.ix===B?i.innerRoundness:null:i.innerRadius}var G=propertyGroupFactory(i,U),q="tm"===B.sh.ty?B.sh.prop:B.sh;return i.propertyIndex=O.ix,q.or.setGroupProperty(PropertyInterface("Outer Radius",G)),q.os.setGroupProperty(PropertyInterface("Outer Roundness",G)),q.pt.setGroupProperty(PropertyInterface("Points",G)),q.p.setGroupProperty(PropertyInterface("Position",G)),q.r.setGroupProperty(PropertyInterface("Rotation",G)),O.ir&&(q.ir.setGroupProperty(PropertyInterface("Inner Radius",G)),q.is.setGroupProperty(PropertyInterface("Inner Roundness",G))),Object.defineProperties(i,{position:{get:ExpressionPropertyInterface(q.p)},rotation:{get:ExpressionPropertyInterface(q.r)},points:{get:ExpressionPropertyInterface(q.pt)},outerRadius:{get:ExpressionPropertyInterface(q.or)},outerRoundness:{get:ExpressionPropertyInterface(q.os)},innerRadius:{get:ExpressionPropertyInterface(q.ir)},innerRoundness:{get:ExpressionPropertyInterface(q.is)},_name:{value:O.nm}}),i.mn=O.mn,i}function l(O,B,U){function i(B){return O.p.ix===B?i.position:O.r.ix===B?i.roundness:O.s.ix===B||"Size"===B||"ADBE Vector Rect Size"===B?i.size:null}var G=propertyGroupFactory(i,U),q="tm"===B.sh.ty?B.sh.prop:B.sh;return i.propertyIndex=O.ix,q.p.setGroupProperty(PropertyInterface("Position",G)),q.s.setGroupProperty(PropertyInterface("Size",G)),q.r.setGroupProperty(PropertyInterface("Rotation",G)),Object.defineProperties(i,{position:{get:ExpressionPropertyInterface(q.p)},roundness:{get:ExpressionPropertyInterface(q.r)},size:{get:ExpressionPropertyInterface(q.s)},_name:{value:O.nm}}),i.mn=O.mn,i}function p(O,B,U){function i(B){return O.r.ix===B||"Round Corners 1"===B?i.radius:null}var G=propertyGroupFactory(i,U),q=B;return i.propertyIndex=O.ix,q.rd.setGroupProperty(PropertyInterface("Radius",G)),Object.defineProperties(i,{radius:{get:ExpressionPropertyInterface(q.rd)},_name:{value:O.nm}}),i.mn=O.mn,i}function c(O,B,U){function i(B){return O.c.ix===B||"Copies"===B?i.copies:O.o.ix===B||"Offset"===B?i.offset:null}var G=propertyGroupFactory(i,U),q=B;return i.propertyIndex=O.ix,q.c.setGroupProperty(PropertyInterface("Copies",G)),q.o.setGroupProperty(PropertyInterface("Offset",G)),Object.defineProperties(i,{copies:{get:ExpressionPropertyInterface(q.c)},offset:{get:ExpressionPropertyInterface(q.o)},_name:{value:O.nm}}),i.mn=O.mn,i}return function(O,B,U){var G;function a(O){if("number"==typeof O)return 0===(O=void 0===O?1:O)?U:G[O-1];for(var B=0,q=G.length;B<q;){if(G[B]._name===O)return G[B];B+=1}return null}return a.propertyGroup=propertyGroupFactory(a,(function(){return U})),G=t(O,B,a.propertyGroup),a.numProperties=G.length,a._name="Contents",a}}(),TextExpressionInterface=function(O){var B,U;function i(O){return"ADBE Text Document"===O?i.sourceText:null}return Object.defineProperty(i,"sourceText",{get:function(){O.textProperty.getValue();var G=O.textProperty.currentData.t;return G!==B&&(O.textProperty.currentData.t=B,(U=new String(G)).value=G||new String(G)),U}}),i};function _typeof$2(O){return _typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_typeof$2(O)}var FootageInterface=(dataInterfaceFactory=function(O){function e(O){return"Outline"===O?e.outlineInterface():null}return e._name="Outline",e.outlineInterface=function(O){var B="",U=O.getFootageData();function i(O){if(U[O])return B=O,"object"===_typeof$2(U=U[O])?i:U;var G=O.indexOf(B);if(-1!==G){var q=parseInt(O.substr(G+B.length),10);return"object"===_typeof$2(U=U[q])?i:U}return""}return function(){return B="",U=O.getFootageData(),i}}(O),e},function(O){function e(O){return"Data"===O?e.dataInterface:null}return e._name="Data",e.dataInterface=dataInterfaceFactory(O),e}),dataInterfaceFactory,interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(O){return interfaces[O]||null}function _typeof$1(O){return _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_typeof$1(O)}function seedRandom(O,B){var U=this,G=256,q=B.pow(G,6),j=B.pow(2,52),W=2*j,Y=255;function h(O){var B,U=O.length,q=this,j=0,W=q.i=q.j=0,K=q.S=[];for(U||(O=[U++]);j<G;)K[j]=j++;for(j=0;j<G;j++)K[j]=K[W=Y&W+O[j%U]+(B=K[j])],K[W]=B;q.g=function(O){for(var B,U=0,j=q.i,W=q.j,K=q.S;O--;)B=K[j=Y&j+1],U=U*G+K[Y&(K[j]=K[W=Y&W+B])+(K[W]=B)];return q.i=j,q.j=W,U}}function l(O,B){return B.i=O.i,B.j=O.j,B.S=O.S.slice(),B}function p(O,B){var U,G=[],q=_typeof$1(O);if(B&&"object"==q)for(U in O)try{G.push(p(O[U],B-1))}catch(O){}return G.length?G:"string"==q?O:O+"\0"}function c(O,B){for(var U,G=O+"",q=0;q<G.length;)B[Y&q]=Y&(U^=19*B[Y&q])+G.charCodeAt(q++);return f(B)}function f(O){return String.fromCharCode.apply(0,O)}B.seedrandom=function(Y,K,Q){var Z=[],X=c(p((K=!0===K?{entropy:!0}:K||{}).entropy?[Y,f(O)]:null===Y?function(){try{var B=new Uint8Array(G);return(U.crypto||U.msCrypto).getRandomValues(B),f(B)}catch(B){var q=U.navigator,j=q&&q.plugins;return[+new Date,U,j,U.screen,f(O)]}}():Y,3),Z),J=new h(Z),v=function(){for(var O=J.g(6),B=q,U=0;O<j;)O=(O+U)*G,B*=G,U=J.g(1);for(;O>=W;)O/=2,B/=2,U>>>=1;return(O+U)/B};return v.int32=function(){return 0|J.g(4)},v.quick=function(){return J.g(4)/4294967296},v.double=v,c(f(J.S),O),(K.pass||Q||function(O,U,G,q){return q&&(q.S&&l(q,J),O.state=function(){return l(J,{})}),G?(B.random=O,U):O})(v,X,"global"in K?K.global:this==B,K.state)},c(B.random(),O)}function initialize$2(O){seedRandom([],O)}var propTypes={SHAPE:"shape"};function _typeof(O){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},_typeof(O)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null;function $bm_isInstanceOfArray(O){return O.constructor===Array||O.constructor===Float32Array}function isNumerable(O,B){return"number"===O||"boolean"===O||"string"===O||B instanceof Number}function $bm_neg(O){var B=_typeof(O);if("number"===B||"boolean"===B||O instanceof Number)return-O;if($bm_isInstanceOfArray(O)){var U,G=O.length,q=[];for(U=0;U<G;U+=1)q[U]=-O[U];return q}return O.propType?O.v:-O}initialize$2(BMMath);var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(O,B){var U=_typeof(O),G=_typeof(B);if("string"===U||"string"===G)return O+B;if(isNumerable(U,O)&&isNumerable(G,B))return O+B;if($bm_isInstanceOfArray(O)&&isNumerable(G,B))return(O=O.slice(0))[0]+=B,O;if(isNumerable(U,O)&&$bm_isInstanceOfArray(B))return(B=B.slice(0))[0]=O+B[0],B;if($bm_isInstanceOfArray(O)&&$bm_isInstanceOfArray(B)){for(var q=0,j=O.length,W=B.length,Y=[];q<j||q<W;)("number"==typeof O[q]||O[q]instanceof Number)&&("number"==typeof B[q]||B[q]instanceof Number)?Y[q]=O[q]+B[q]:Y[q]=void 0===B[q]?O[q]:O[q]||B[q],q+=1;return Y}return 0}var add=sum;function sub(O,B){var U=_typeof(O),G=_typeof(B);if(isNumerable(U,O)&&isNumerable(G,B))return"string"===U&&(O=parseInt(O,10)),"string"===G&&(B=parseInt(B,10)),O-B;if($bm_isInstanceOfArray(O)&&isNumerable(G,B))return(O=O.slice(0))[0]-=B,O;if(isNumerable(U,O)&&$bm_isInstanceOfArray(B))return(B=B.slice(0))[0]=O-B[0],B;if($bm_isInstanceOfArray(O)&&$bm_isInstanceOfArray(B)){for(var q=0,j=O.length,W=B.length,Y=[];q<j||q<W;)("number"==typeof O[q]||O[q]instanceof Number)&&("number"==typeof B[q]||B[q]instanceof Number)?Y[q]=O[q]-B[q]:Y[q]=void 0===B[q]?O[q]:O[q]||B[q],q+=1;return Y}return 0}function mul(O,B){var U,G,q,j=_typeof(O),W=_typeof(B);if(isNumerable(j,O)&&isNumerable(W,B))return O*B;if($bm_isInstanceOfArray(O)&&isNumerable(W,B)){for(q=O.length,U=createTypedArray("float32",q),G=0;G<q;G+=1)U[G]=O[G]*B;return U}if(isNumerable(j,O)&&$bm_isInstanceOfArray(B)){for(q=B.length,U=createTypedArray("float32",q),G=0;G<q;G+=1)U[G]=O*B[G];return U}return 0}function div(O,B){var U,G,q,j=_typeof(O),W=_typeof(B);if(isNumerable(j,O)&&isNumerable(W,B))return O/B;if($bm_isInstanceOfArray(O)&&isNumerable(W,B)){for(q=O.length,U=createTypedArray("float32",q),G=0;G<q;G+=1)U[G]=O[G]/B;return U}if(isNumerable(j,O)&&$bm_isInstanceOfArray(B)){for(q=B.length,U=createTypedArray("float32",q),G=0;G<q;G+=1)U[G]=O/B[G];return U}return 0}function mod(O,B){return"string"==typeof O&&(O=parseInt(O,10)),"string"==typeof B&&(B=parseInt(B,10)),O%B}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(O,B,U){if(B>U){var G=U;U=B,B=G}return Math.min(Math.max(O,B),U)}function radiansToDegrees(O){return O/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(O){return O*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(O,B){if("number"==typeof O||O instanceof Number)return B=B||0,Math.abs(O-B);var U;B||(B=helperLengthArray);var G=Math.min(O.length,B.length),q=0;for(U=0;U<G;U+=1)q+=Math.pow(B[U]-O[U],2);return Math.sqrt(q)}function normalize(O){return div(O,length(O))}function rgbToHsl(O){var B,U,G=O[0],q=O[1],j=O[2],W=Math.max(G,q,j),Y=Math.min(G,q,j),K=(W+Y)/2;if(W===Y)B=0,U=0;else{var Q=W-Y;switch(U=K>.5?Q/(2-W-Y):Q/(W+Y),W){case G:B=(q-j)/Q+(q<j?6:0);break;case q:B=(j-G)/Q+2;break;case j:B=(G-q)/Q+4}B/=6}return[B,U,K,O[3]]}function hue2rgb(O,B,U){return U<0&&(U+=1),U>1&&(U-=1),U<1/6?O+6*(B-O)*U:U<.5?B:U<2/3?O+(B-O)*(2/3-U)*6:O}function hslToRgb(O){var B,U,G,q=O[0],j=O[1],W=O[2];if(0===j)B=W,G=W,U=W;else{var Y=W<.5?W*(1+j):W+j-W*j,K=2*W-Y;B=hue2rgb(K,Y,q+1/3),U=hue2rgb(K,Y,q),G=hue2rgb(K,Y,q-1/3)}return[B,U,G,O[3]]}function linear(O,B,U,G,q){if(void 0!==G&&void 0!==q||(G=B,q=U,B=0,U=1),U<B){var j=U;U=B,B=j}if(O<=B)return G;if(O>=U)return q;var W,Y=U===B?0:(O-B)/(U-B);if(!G.length)return G+(q-G)*Y;var K=G.length,Q=createTypedArray("float32",K);for(W=0;W<K;W+=1)Q[W]=G[W]+(q[W]-G[W])*Y;return Q}function random(O,B){if(void 0===B&&(void 0===O?(O=0,B=1):(B=O,O=void 0)),B.length){var U,G=B.length;O||(O=createTypedArray("float32",G));var q=createTypedArray("float32",G),j=BMMath.random();for(U=0;U<G;U+=1)q[U]=O[U]+j*(B[U]-O[U]);return q}return void 0===O&&(O=0),O+BMMath.random()*(B-O)}function createPath(O,B,U,G){var q,j=O.length,W=shapePool.newElement();W.setPathData(!!G,j);var Y,K,Q=[0,0];for(q=0;q<j;q+=1)Y=B&&B[q]?B[q]:Q,K=U&&U[q]?U[q]:Q,W.setTripleAt(O[q][0],O[q][1],K[0]+O[q][0],K[1]+O[q][1],Y[0]+O[q][0],Y[1]+O[q][1],q,!0);return W}function initiateExpression(elem,data,property){function noOp(O){return O}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=-1!==val.indexOf("random"),elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||!0!==this.data.hd,wiggle=function(O,B){var U,G,q=this.pv.length?this.pv.length:1,j=createTypedArray("float32",q),W=Math.floor(5*time);for(U=0,G=0;U<W;){for(G=0;G<q;G+=1)j[G]+=-B+2*B*BMMath.random();U+=1}var Y=5*time,K=Y-Math.floor(Y),Q=createTypedArray("float32",q);if(q>1){for(G=0;G<q;G+=1)Q[G]=this.pv[G]+j[G]+(-B+2*B*BMMath.random())*K;return Q}return this.pv+j[0]+(-B+2*B*BMMath.random())*K}.bind(this);function loopInDuration(O,B){return loopIn(O,B,!0)}function loopOutDuration(O,B){return loopOut(O,B,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(O,B){var U=[B[0]-O[0],B[1]-O[1],B[2]-O[2]],G=Math.atan2(U[0],Math.sqrt(U[1]*U[1]+U[2]*U[2]))/degToRads;return[-Math.atan2(U[1],U[2])/degToRads,G,0]}function easeOut(O,B,U,G,q){return applyEase(easeOutBez,O,B,U,G,q)}function easeIn(O,B,U,G,q){return applyEase(easeInBez,O,B,U,G,q)}function ease(O,B,U,G,q){return applyEase(easeInOutBez,O,B,U,G,q)}function applyEase(O,B,U,G,q,j){void 0===q?(q=U,j=G):B=(B-U)/(G-U),B>1?B=1:B<0&&(B=0);var W=O(B);if($bm_isInstanceOfArray(q)){var Y,K=q.length,Q=createTypedArray("float32",K);for(Y=0;Y<K;Y+=1)Q[Y]=(j[Y]-q[Y])*W+q[Y];return Q}return(j-q)*W+q}function nearestKey(O){var B,U,G,q=data.k.length;if(data.k.length&&"number"!=typeof data.k[0])if(U=-1,(O*=elem.comp.globalData.frameRate)<data.k[0].t)U=1,G=data.k[0].t;else{for(B=0;B<q-1;B+=1){if(O===data.k[B].t){U=B+1,G=data.k[B].t;break}if(O>data.k[B].t&&O<data.k[B+1].t){O-data.k[B].t>data.k[B+1].t-O?(U=B+2,G=data.k[B+1].t):(U=B+1,G=data.k[B].t);break}}-1===U&&(U=B+1,G=data.k[B].t)}else U=0,G=0;var j={};return j.index=U,j.time=G/elem.comp.globalData.frameRate,j}function key(O){var B,U,G;if(!data.k.length||"number"==typeof data.k[0])throw new Error("The property has no keyframe at index "+O);O-=1,B={time:data.k[O].t/elem.comp.globalData.frameRate,value:[]};var q=Object.prototype.hasOwnProperty.call(data.k[O],"s")?data.k[O].s:data.k[O-1].e;for(G=q.length,U=0;U<G;U+=1)B[U]=q[U],B.value[U]=q[U];return B}function framesToTime(O,B){return B||(B=elem.comp.globalData.frameRate),O/B}function timeToFrames(O,B){return O||0===O||(O=time),B||(B=elem.comp.globalData.frameRate),O*B}function seedRandom(O){BMMath.seedrandom(randSeed+O)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(O,B){return"string"==typeof value?void 0===B?value.substring(O):value.substring(O,B):""}function substr(O,B){return"string"==typeof value?void 0===B?value.substr(O):value.substr(O,B):""}function posterizeTime(O){time=0===O?0:Math.floor(time*O)/O,value=valueAtTime(time)}var index=elem.data.ind,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(O){return value=O,this.frameExpressionId===elem.globalData.frameId&&"textSelector"!==this.propType?value:("textSelector"===this.propType&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),4!==elemType||content||(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),(hasParent=!(!elem.hierarchy||!elem.hierarchy.length))&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath],ob}(),expressionHelpers={searchExpressions:function(O,B,U){B.x&&(U.k=!0,U.x=!0,U.initiateExpression=ExpressionManager.initiateExpression,U.effectsSequence.push(U.initiateExpression(O,B,U).bind(U)))},getSpeedAtTime:function(O){var B=this.getValueAtTime(O),U=this.getValueAtTime(O+-.01),G=0;if(B.length){var q;for(q=0;q<B.length;q+=1)G+=Math.pow(U[q]-B[q],2);G=100*Math.sqrt(G)}else G=0;return G},getVelocityAtTime:function(O){if(void 0!==this.vel)return this.vel;var B,U,G=-.001,q=this.getValueAtTime(O),j=this.getValueAtTime(O+G);if(q.length)for(B=createTypedArray("float32",q.length),U=0;U<q.length;U+=1)B[U]=(j[U]-q[U])/G;else B=(j-q)/G;return B},getValueAtTime:function(O){return O*=this.elem.globalData.frameRate,(O-=this.offsetTime)!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<O?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(O,this._cachingAtTime),this._cachingAtTime.lastFrame=O),this._cachingAtTime.value},getStaticValueAtTime:function(){return this.pv},setGroupProperty:function(O){this.propertyGroup=O}};function addPropertyDecorator(){function t(O,B,U){if(!this.k||!this.keyframes)return this.pv;O=O?O.toLowerCase():"";var G,q,j,W,Y,K=this.comp.renderedFrame,Q=this.keyframes,Z=Q[Q.length-1].t;if(K<=Z)return this.pv;if(U?q=Z-(G=B?Math.abs(Z-this.elem.comp.globalData.frameRate*B):Math.max(0,Z-this.elem.data.ip)):((!B||B>Q.length-1)&&(B=Q.length-1),G=Z-(q=Q[Q.length-1-B].t)),"pingpong"===O){if(Math.floor((K-q)/G)%2!=0)return this.getValueAtTime((G-(K-q)%G+q)/this.comp.globalData.frameRate,0)}else{if("offset"===O){var X=this.getValueAtTime(q/this.comp.globalData.frameRate,0),J=this.getValueAtTime(Z/this.comp.globalData.frameRate,0),ee=this.getValueAtTime(((K-q)%G+q)/this.comp.globalData.frameRate,0),te=Math.floor((K-q)/G);if(this.pv.length){for(W=(Y=new Array(X.length)).length,j=0;j<W;j+=1)Y[j]=(J[j]-X[j])*te+ee[j];return Y}return(J-X)*te+ee}if("continue"===O){var ie=this.getValueAtTime(Z/this.comp.globalData.frameRate,0),re=this.getValueAtTime((Z-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(W=(Y=new Array(ie.length)).length,j=0;j<W;j+=1)Y[j]=ie[j]+(ie[j]-re[j])*((K-Z)/this.comp.globalData.frameRate)/5e-4;return Y}return ie+(K-Z)/.001*(ie-re)}}return this.getValueAtTime(((K-q)%G+q)/this.comp.globalData.frameRate,0)}function e(O,B,U){if(!this.k)return this.pv;O=O?O.toLowerCase():"";var G,q,j,W,Y,K=this.comp.renderedFrame,Q=this.keyframes,Z=Q[0].t;if(K>=Z)return this.pv;if(U?q=Z+(G=B?Math.abs(this.elem.comp.globalData.frameRate*B):Math.max(0,this.elem.data.op-Z)):((!B||B>Q.length-1)&&(B=Q.length-1),G=(q=Q[B].t)-Z),"pingpong"===O){if(Math.floor((Z-K)/G)%2==0)return this.getValueAtTime(((Z-K)%G+Z)/this.comp.globalData.frameRate,0)}else{if("offset"===O){var X=this.getValueAtTime(Z/this.comp.globalData.frameRate,0),J=this.getValueAtTime(q/this.comp.globalData.frameRate,0),ee=this.getValueAtTime((G-(Z-K)%G+Z)/this.comp.globalData.frameRate,0),te=Math.floor((Z-K)/G)+1;if(this.pv.length){for(W=(Y=new Array(X.length)).length,j=0;j<W;j+=1)Y[j]=ee[j]-(J[j]-X[j])*te;return Y}return ee-(J-X)*te}if("continue"===O){var ie=this.getValueAtTime(Z/this.comp.globalData.frameRate,0),re=this.getValueAtTime((Z+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(W=(Y=new Array(ie.length)).length,j=0;j<W;j+=1)Y[j]=ie[j]+(ie[j]-re[j])*(Z-K)/.001;return Y}return ie+(ie-re)*(Z-K)/.001}}return this.getValueAtTime((G-((Z-K)%G+Z))/this.comp.globalData.frameRate,0)}function r(O,B){if(!this.k)return this.pv;if(O=.5*(O||.4),(B=Math.floor(B||5))<=1)return this.pv;var U,G,q=this.comp.renderedFrame/this.comp.globalData.frameRate,j=q-O,W=B>1?(q+O-j)/(B-1):1,Y=0,K=0;for(U=this.pv.length?createTypedArray("float32",this.pv.length):0;Y<B;){if(G=this.getValueAtTime(j+Y*W),this.pv.length)for(K=0;K<this.pv.length;K+=1)U[K]+=G[K];else U+=G;Y+=1}if(this.pv.length)for(K=0;K<this.pv.length;K+=1)U[K]/=B;else U/=B;return U}function i(O){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var B=this._transformCachingAtTime.v;if(B.cloneFromProps(this.pre.props),this.appliedTransformations<1){var U=this.a.getValueAtTime(O);B.translate(-U[0]*this.a.mult,-U[1]*this.a.mult,U[2]*this.a.mult)}if(this.appliedTransformations<2){var G=this.s.getValueAtTime(O);B.scale(G[0]*this.s.mult,G[1]*this.s.mult,G[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var q=this.sk.getValueAtTime(O),j=this.sa.getValueAtTime(O);B.skewFromAxis(-q*this.sk.mult,j*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var W=this.r.getValueAtTime(O);B.rotate(-W*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var Y=this.rz.getValueAtTime(O),K=this.ry.getValueAtTime(O),Q=this.rx.getValueAtTime(O),Z=this.or.getValueAtTime(O);B.rotateZ(-Y*this.rz.mult).rotateY(K*this.ry.mult).rotateX(Q*this.rx.mult).rotateZ(-Z[2]*this.or.mult).rotateY(Z[1]*this.or.mult).rotateX(Z[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var X=this.px.getValueAtTime(O),J=this.py.getValueAtTime(O);if(this.data.p.z){var ee=this.pz.getValueAtTime(O);B.translate(X*this.px.mult,J*this.py.mult,-ee*this.pz.mult)}else B.translate(X*this.px.mult,J*this.py.mult,0)}else{var te=this.p.getValueAtTime(O);B.translate(te[0]*this.p.mult,te[1]*this.p.mult,-te[2]*this.p.mult)}return B}function s(){return this.v.clone(new Matrix)}var O=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(B,U,G){var q=O(B,U,G);return q.dynamicProperties.length?q.getValueAtTime=i.bind(q):q.getValueAtTime=s.bind(q),q.setGroupProperty=expressionHelpers.setGroupProperty,q};var B=PropertyFactory.getProp;PropertyFactory.getProp=function(O,U,G,q,j){var W=B(O,U,G,q,j);W.kf?W.getValueAtTime=expressionHelpers.getValueAtTime.bind(W):W.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(W),W.setGroupProperty=expressionHelpers.setGroupProperty,W.loopOut=t,W.loopIn=e,W.smooth=r,W.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(W),W.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(W),W.numKeys=1===U.a?U.k.length:0,W.propertyIndex=U.ix;var Y=0;return 0!==G&&(Y=createTypedArray("float32",1===U.a?U.k[0].s.length:U.k.length)),W._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:Y},expressionHelpers.searchExpressions(O,U,W),W.k&&j.addDynamicProperty(W),W};var U=ShapePropertyFactory.getConstructorFunction(),G=ShapePropertyFactory.getKeyframedConstructorFunction();function l(){}l.prototype={vertices:function(O,B){this.k&&this.getValue();var U,G=this.v;void 0!==B&&(G=this.getValueAtTime(B,0));var q=G._length,j=G[O],W=G.v,Y=createSizedArray(q);for(U=0;U<q;U+=1)Y[U]="i"===O||"o"===O?[j[U][0]-W[U][0],j[U][1]-W[U][1]]:[j[U][0],j[U][1]];return Y},points:function(O){return this.vertices("v",O)},inTangents:function(O){return this.vertices("i",O)},outTangents:function(O){return this.vertices("o",O)},isClosed:function(){return this.v.c},pointOnPath:function(O,B){var U=this.v;void 0!==B&&(U=this.getValueAtTime(B,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(U));for(var G,q=this._segmentsLength,j=q.lengths,W=q.totalLength*O,Y=0,K=j.length,Q=0;Y<K;){if(Q+j[Y].addedLength>W){var Z=Y,X=U.c&&Y===K-1?0:Y+1,J=(W-Q)/j[Y].addedLength;G=bez.getPointInSegment(U.v[Z],U.v[X],U.o[Z],U.i[X],J,j[Y]);break}Q+=j[Y].addedLength,Y+=1}return G||(G=U.c?[U.v[0][0],U.v[0][1]]:[U.v[U._length-1][0],U.v[U._length-1][1]]),G},vectorOnPath:function(O,B,U){1==O?O=this.v.c:0==O&&(O=.999);var G=this.pointOnPath(O,B),q=this.pointOnPath(O+.001,B),j=q[0]-G[0],W=q[1]-G[1],Y=Math.sqrt(Math.pow(j,2)+Math.pow(W,2));return 0===Y?[0,0]:"tangent"===U?[j/Y,W/Y]:[-W/Y,j/Y]},tangentOnPath:function(O,B){return this.vectorOnPath(O,B,"tangent")},normalOnPath:function(O,B){return this.vectorOnPath(O,B,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([l],U),extendPrototype([l],G),G.prototype.getValueAtTime=function(O){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),O*=this.elem.globalData.frameRate,(O-=this.offsetTime)!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<O?this._caching.lastIndex:0,this._cachingAtTime.lastTime=O,this.interpolateShape(O,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue},G.prototype.initiateExpression=ExpressionManager.initiateExpression;var q=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(O,B,U,G,j){var W=q(O,B,U,G,j);return W.propertyIndex=B.ix,W.lock=!1,3===U?expressionHelpers.searchExpressions(O,B.pt,W):4===U&&expressionHelpers.searchExpressions(O,B.ks,W),W.k&&O.addDynamicProperty(W),W}}function initialize$1(){addPropertyDecorator()}function addDecorator(){TextProperty.prototype.getExpressionValue=function(O,B){var U=this.calculateExpression(B);if(O.t!==U){var G={};return this.copyData(G,O),G.t=U.toString(),G.__complete=!1,G}return O},TextProperty.prototype.searchProperty=function(){var O=this.searchKeyframes(),B=this.searchExpressions();return this.kf=O||B,this.kf},TextProperty.prototype.searchExpressions=function(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}}function initialize(){addDecorator()}function SVGComposableEffect(){}function SVGTintFilter(O,B,U,G,q){this.filterManager=B;var j=createNS("feColorMatrix");j.setAttribute("type","matrix"),j.setAttribute("color-interpolation-filters","linearRGB"),j.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),j.setAttribute("result",G+"_tint_1"),O.appendChild(j),(j=createNS("feColorMatrix")).setAttribute("type","matrix"),j.setAttribute("color-interpolation-filters","sRGB"),j.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),j.setAttribute("result",G+"_tint_2"),O.appendChild(j),this.matrixFilter=j;var W=this.createMergeNode(G,[q,G+"_tint_1",G+"_tint_2"]);O.appendChild(W)}function SVGFillFilter(O,B,U,G){this.filterManager=B;var q=createNS("feColorMatrix");q.setAttribute("type","matrix"),q.setAttribute("color-interpolation-filters","sRGB"),q.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),q.setAttribute("result",G),O.appendChild(q),this.matrixFilter=q}function SVGStrokeEffect(O,B,U){this.initialized=!1,this.filterManager=B,this.elem=U,this.paths=[]}function SVGTritoneFilter(O,B,U,G){this.filterManager=B;var q=createNS("feColorMatrix");q.setAttribute("type","matrix"),q.setAttribute("color-interpolation-filters","linearRGB"),q.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),O.appendChild(q);var j=createNS("feComponentTransfer");j.setAttribute("color-interpolation-filters","sRGB"),j.setAttribute("result",G),this.matrixFilter=j;var W=createNS("feFuncR");W.setAttribute("type","table"),j.appendChild(W),this.feFuncR=W;var Y=createNS("feFuncG");Y.setAttribute("type","table"),j.appendChild(Y),this.feFuncG=Y;var K=createNS("feFuncB");K.setAttribute("type","table"),j.appendChild(K),this.feFuncB=K,O.appendChild(j)}function SVGProLevelsFilter(O,B,U,G){this.filterManager=B;var q=this.filterManager.effectElements,j=createNS("feComponentTransfer");(q[10].p.k||0!==q[10].p.v||q[11].p.k||1!==q[11].p.v||q[12].p.k||1!==q[12].p.v||q[13].p.k||0!==q[13].p.v||q[14].p.k||1!==q[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",j)),(q[17].p.k||0!==q[17].p.v||q[18].p.k||1!==q[18].p.v||q[19].p.k||1!==q[19].p.v||q[20].p.k||0!==q[20].p.v||q[21].p.k||1!==q[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",j)),(q[24].p.k||0!==q[24].p.v||q[25].p.k||1!==q[25].p.v||q[26].p.k||1!==q[26].p.v||q[27].p.k||0!==q[27].p.v||q[28].p.k||1!==q[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",j)),(q[31].p.k||0!==q[31].p.v||q[32].p.k||1!==q[32].p.v||q[33].p.k||1!==q[33].p.v||q[34].p.k||0!==q[34].p.v||q[35].p.k||1!==q[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",j)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(j.setAttribute("color-interpolation-filters","sRGB"),O.appendChild(j)),(q[3].p.k||0!==q[3].p.v||q[4].p.k||1!==q[4].p.v||q[5].p.k||1!==q[5].p.v||q[6].p.k||0!==q[6].p.v||q[7].p.k||1!==q[7].p.v)&&((j=createNS("feComponentTransfer")).setAttribute("color-interpolation-filters","sRGB"),j.setAttribute("result",G),O.appendChild(j),this.feFuncRComposed=this.createFeFunc("feFuncR",j),this.feFuncGComposed=this.createFeFunc("feFuncG",j),this.feFuncBComposed=this.createFeFunc("feFuncB",j))}function SVGDropShadowEffect(O,B,U,G,q){var j=B.container.globalData.renderConfig.filterSize,W=B.data.fs||j;O.setAttribute("x",W.x||j.x),O.setAttribute("y",W.y||j.y),O.setAttribute("width",W.width||j.width),O.setAttribute("height",W.height||j.height),this.filterManager=B;var Y=createNS("feGaussianBlur");Y.setAttribute("in","SourceAlpha"),Y.setAttribute("result",G+"_drop_shadow_1"),Y.setAttribute("stdDeviation","0"),this.feGaussianBlur=Y,O.appendChild(Y);var K=createNS("feOffset");K.setAttribute("dx","25"),K.setAttribute("dy","0"),K.setAttribute("in",G+"_drop_shadow_1"),K.setAttribute("result",G+"_drop_shadow_2"),this.feOffset=K,O.appendChild(K);var Q=createNS("feFlood");Q.setAttribute("flood-color","#00ff00"),Q.setAttribute("flood-opacity","1"),Q.setAttribute("result",G+"_drop_shadow_3"),this.feFlood=Q,O.appendChild(Q);var Z=createNS("feComposite");Z.setAttribute("in",G+"_drop_shadow_3"),Z.setAttribute("in2",G+"_drop_shadow_2"),Z.setAttribute("operator","in"),Z.setAttribute("result",G+"_drop_shadow_4"),O.appendChild(Z);var X=this.createMergeNode(G,[G+"_drop_shadow_4",q]);O.appendChild(X)}SVGComposableEffect.prototype={createMergeNode:function(O,B){var U,G,q=createNS("feMerge");for(q.setAttribute("result",O),G=0;G<B.length;G+=1)(U=createNS("feMergeNode")).setAttribute("in",B[G]),q.appendChild(U),q.appendChild(U);return q}},extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(O){if(O||this.filterManager._mdf){var B=this.filterManager.effectElements[0].p.v,U=this.filterManager.effectElements[1].p.v,G=this.filterManager.effectElements[2].p.v/100;this.matrixFilter.setAttribute("values",U[0]-B[0]+" 0 0 0 "+B[0]+" "+(U[1]-B[1])+" 0 0 0 "+B[1]+" "+(U[2]-B[2])+" 0 0 0 "+B[2]+" 0 0 0 "+G+" 0")}},SVGFillFilter.prototype.renderFrame=function(O){if(O||this.filterManager._mdf){var B=this.filterManager.effectElements[2].p.v,U=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+B[0]+" 0 0 0 0 "+B[1]+" 0 0 0 0 "+B[2]+" 0 0 0 "+U+" 0")}},SVGStrokeEffect.prototype.initialize=function(){var O,B,U,G,q=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(G=this.elem.maskManager.masksProperties.length,U=0):G=1+(U=this.filterManager.effectElements[0].p.v-1),(B=createNS("g")).setAttribute("fill","none"),B.setAttribute("stroke-linecap","round"),B.setAttribute("stroke-dashoffset",1);U<G;U+=1)O=createNS("path"),B.appendChild(O),this.paths.push({p:O,m:U});if(3===this.filterManager.effectElements[10].p.v){var j=createNS("mask"),W=createElementID();j.setAttribute("id",W),j.setAttribute("mask-type","alpha"),j.appendChild(B),this.elem.globalData.defs.appendChild(j);var Y=createNS("g");for(Y.setAttribute("mask","url("+getLocationHref()+"#"+W+")");q[0];)Y.appendChild(q[0]);this.elem.layerElement.appendChild(Y),this.masker=j,B.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v)for(q=this.elem.layerElement.children||this.elem.layerElement.childNodes;q.length;)this.elem.layerElement.removeChild(q[0]);this.elem.layerElement.appendChild(B),this.elem.layerElement.removeAttribute("mask"),B.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=B},SVGStrokeEffect.prototype.renderFrame=function(O){var B;this.initialized||this.initialize();var U,G,q=this.paths.length;for(B=0;B<q;B+=1)if(-1!==this.paths[B].m&&(U=this.elem.maskManager.viewData[this.paths[B].m],G=this.paths[B].p,(O||this.filterManager._mdf||U.prop._mdf)&&G.setAttribute("d",U.lastPath),O||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||U.prop._mdf)){var j;if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){var W=.01*Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),Y=.01*Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),K=G.getTotalLength();j="0 0 0 "+K*W+" ";var Q,Z=K*(Y-W),X=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01,J=Math.floor(Z/X);for(Q=0;Q<J;Q+=1)j+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01+" ";j+="0 "+10*K+" 0 0"}else j="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01;G.setAttribute("stroke-dasharray",j)}if((O||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(O||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v)&&(O||this.filterManager.effectElements[3].p._mdf)){var ee=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(255*ee[0])+","+bmFloor(255*ee[1])+","+bmFloor(255*ee[2])+")")}},SVGTritoneFilter.prototype.renderFrame=function(O){if(O||this.filterManager._mdf){var B=this.filterManager.effectElements[0].p.v,U=this.filterManager.effectElements[1].p.v,G=this.filterManager.effectElements[2].p.v,q=G[0]+" "+U[0]+" "+B[0],j=G[1]+" "+U[1]+" "+B[1],W=G[2]+" "+U[2]+" "+B[2];this.feFuncR.setAttribute("tableValues",q),this.feFuncG.setAttribute("tableValues",j),this.feFuncB.setAttribute("tableValues",W)}},SVGProLevelsFilter.prototype.createFeFunc=function(O,B){var U=createNS(O);return U.setAttribute("type","table"),B.appendChild(U),U},SVGProLevelsFilter.prototype.getTableValue=function(O,B,U,G,q){for(var j,W,Y=0,K=Math.min(O,B),Q=Math.max(O,B),Z=Array.call(null,{length:256}),X=0,J=q-G,ee=B-O;Y<=256;)W=(j=Y/256)<=K?ee<0?q:G:j>=Q?ee<0?G:q:G+J*Math.pow((j-O)/ee,1/U),Z[X]=W,X+=1,Y+=256/255;return Z.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(O){if(O||this.filterManager._mdf){var B,U=this.filterManager.effectElements;this.feFuncRComposed&&(O||U[3].p._mdf||U[4].p._mdf||U[5].p._mdf||U[6].p._mdf||U[7].p._mdf)&&(B=this.getTableValue(U[3].p.v,U[4].p.v,U[5].p.v,U[6].p.v,U[7].p.v),this.feFuncRComposed.setAttribute("tableValues",B),this.feFuncGComposed.setAttribute("tableValues",B),this.feFuncBComposed.setAttribute("tableValues",B)),this.feFuncR&&(O||U[10].p._mdf||U[11].p._mdf||U[12].p._mdf||U[13].p._mdf||U[14].p._mdf)&&(B=this.getTableValue(U[10].p.v,U[11].p.v,U[12].p.v,U[13].p.v,U[14].p.v),this.feFuncR.setAttribute("tableValues",B)),this.feFuncG&&(O||U[17].p._mdf||U[18].p._mdf||U[19].p._mdf||U[20].p._mdf||U[21].p._mdf)&&(B=this.getTableValue(U[17].p.v,U[18].p.v,U[19].p.v,U[20].p.v,U[21].p.v),this.feFuncG.setAttribute("tableValues",B)),this.feFuncB&&(O||U[24].p._mdf||U[25].p._mdf||U[26].p._mdf||U[27].p._mdf||U[28].p._mdf)&&(B=this.getTableValue(U[24].p.v,U[25].p.v,U[26].p.v,U[27].p.v,U[28].p.v),this.feFuncB.setAttribute("tableValues",B)),this.feFuncA&&(O||U[31].p._mdf||U[32].p._mdf||U[33].p._mdf||U[34].p._mdf||U[35].p._mdf)&&(B=this.getTableValue(U[31].p.v,U[32].p.v,U[33].p.v,U[34].p.v,U[35].p.v),this.feFuncA.setAttribute("tableValues",B))}},extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(O){if(O||this.filterManager._mdf){if((O||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),O||this.filterManager.effectElements[0].p._mdf){var B=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*B[0]),Math.round(255*B[1]),Math.round(255*B[2])))}if((O||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),O||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var U=this.filterManager.effectElements[3].p.v,G=(this.filterManager.effectElements[2].p.v-90)*degToRads,q=U*Math.cos(G),j=U*Math.sin(G);this.feOffset.setAttribute("dx",q),this.feOffset.setAttribute("dy",j)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(O,B,U){this.initialized=!1,this.filterManager=B,this.filterElem=O,this.elem=U,U.matteElement=createNS("g"),U.matteElement.appendChild(U.layerElement),U.matteElement.appendChild(U.transformedElement),U.baseElement=U.matteElement}function SVGGaussianBlurEffect(O,B,U,G){O.setAttribute("x","-100%"),O.setAttribute("y","-100%"),O.setAttribute("width","300%"),O.setAttribute("height","300%"),this.filterManager=B;var q=createNS("feGaussianBlur");q.setAttribute("result",G),O.appendChild(q),this.feGaussianBlur=q}return SVGMatte3Effect.prototype.findSymbol=function(O){for(var B=0,U=_svgMatteSymbols.length;B<U;){if(_svgMatteSymbols[B]===O)return _svgMatteSymbols[B];B+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(O,B){var U=O.layerElement.parentNode;if(U){for(var G,q=U.children,j=0,W=q.length;j<W&&q[j]!==O.layerElement;)j+=1;j<=W-2&&(G=q[j+1]);var Y=createNS("use");Y.setAttribute("href","#"+B),G?U.insertBefore(Y,G):U.appendChild(Y)}},SVGMatte3Effect.prototype.setElementAsMask=function(O,B){if(!this.findSymbol(B)){var U=createElementID(),G=createNS("mask");G.setAttribute("id",B.layerId),G.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(B);var q=O.globalData.defs;q.appendChild(G);var j=createNS("symbol");j.setAttribute("id",U),this.replaceInParent(B,U),j.appendChild(B.layerElement),q.appendChild(j);var W=createNS("use");W.setAttribute("href","#"+U),G.appendChild(W),B.data.hd=!1,B.show()}O.setMatte(B.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var O=this.filterManager.effectElements[0].p.v,B=this.elem.comp.elements,U=0,G=B.length;U<G;)B[U]&&B[U].data.ind===O&&this.setElementAsMask(this.elem,B[U]),U+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGGaussianBlurEffect.prototype.renderFrame=function(O){if(O||this.filterManager._mdf){var B=.3*this.filterManager.effectElements[0].p.v,U=this.filterManager.effectElements[1].p.v,G=3==U?0:B,q=2==U?0:B;this.feGaussianBlur.setAttribute("stdDeviation",G+" "+q);var j=1==this.filterManager.effectElements[2].p.v?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",j)}},registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect(20,SVGTintFilter,!0),registerEffect(21,SVGFillFilter,!0),registerEffect(22,SVGStrokeEffect,!1),registerEffect(23,SVGTritoneFilter,!0),registerEffect(24,SVGProLevelsFilter,!0),registerEffect(25,SVGDropShadowEffect,!0),registerEffect(28,SVGMatte3Effect,!1),registerEffect(29,SVGGaussianBlurEffect,!0),lottie},module.exports=factory())})(lottie$1,lottie$1.exports);var lottie=lottie$1.exports,_templateObject$1,styles=r$3(_templateObject$1||(_templateObject$1=_taggedTemplateLiteral(["\n  * {\n    box-sizing: border-box;\n  }\n\n  :host {\n    --lottie-player-toolbar-height: 35px;\n    --lottie-player-toolbar-background-color: transparent;\n    --lottie-player-toolbar-icon-color: #999;\n    --lottie-player-toolbar-icon-hover-color: #222;\n    --lottie-player-toolbar-icon-active-color: #555;\n    --lottie-player-seeker-track-color: #ccc;\n    --lottie-player-seeker-thumb-color: rgba(0, 107, 120, 0.8);\n    --lottie-player-seeker-display: block;\n\n    display: block;\n    width: 100%;\n    height: 100%;\n  }\n\n  .main {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n  }\n\n  .animation {\n    width: 100%;\n    height: 100%;\n    display: flex;\n  }\n  .animation.controls {\n    height: calc(100% - 35px);\n  }\n\n  .toolbar {\n    display: flex;\n    align-items: center;\n    justify-items: center;\n    background-color: var(--lottie-player-toolbar-background-color);\n    margin: 0 5px;\n    height: 35px;\n  }\n\n  .toolbar button {\n    cursor: pointer;\n    fill: var(--lottie-player-toolbar-icon-color);\n    display: flex;\n    background: none;\n    border: 0;\n    padding: 0;\n    outline: none;\n    height: 100%;\n  }\n\n  .toolbar button:hover {\n    fill: var(--lottie-player-toolbar-icon-hover-color);\n  }\n\n  .toolbar button.active {\n    fill: var(--lottie-player-toolbar-icon-active-color);\n  }\n\n  .toolbar button.active:hover {\n    fill: var(--lottie-player-toolbar-icon-hover-color);\n  }\n\n  .toolbar button:focus {\n    outline: 1px dotted var(--lottie-player-toolbar-icon-active-color);\n  }\n\n  .toolbar button svg {\n  }\n\n  .toolbar button.disabled svg {\n    display: none;\n  }\n\n  .seeker {\n    -webkit-appearance: none;\n    width: 95%;\n    outline: none;\n    background-color: var(--lottie-player-toolbar-background-color);\n    display: var(--lottie-player-seeker-display);\n  }\n\n  .seeker::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-webkit-slider-thumb {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n    -webkit-appearance: none;\n    margin-top: -5px;\n  }\n  .seeker:focus::-webkit-slider-runnable-track {\n    background: #999;\n  }\n  .seeker::-moz-range-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-moz-range-thumb {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n  }\n  .seeker::-ms-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: transparent;\n    border-color: transparent;\n    color: transparent;\n  }\n  .seeker::-ms-fill-lower {\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-ms-fill-upper {\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-ms-thumb {\n    border: 0;\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n  }\n  .seeker:focus::-ms-fill-lower {\n    background: var(--lottie-player-seeker-track-color);\n  }\n  .seeker:focus::-ms-fill-upper {\n    background: var(--lottie-player-seeker-track-color);\n  }\n\n  .error {\n    display: flex;\n    justify-content: center;\n    height: 100%;\n    align-items: center;\n  }\n"]))),LOTTIE_PLAYER_VERSION="1.7.1",LOTTIE_WEB_VERSION="^5.10.0",_templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,PlayerState,PlayMode,PlayerEvents;function parseSrc(O){if("object"==typeof O)return O;try{return JSON.parse(O)}catch(B){return new URL(O,window.location.href).toString()}}function isLottie(O){return["v","ip","op","layers","fr","w","h"].every((B=>Object.prototype.hasOwnProperty.call(O,B)))}function fromURL(O){return _fromURL.apply(this,arguments)}function _fromURL(){return(_fromURL=_asyncToGenerator((function*(O){if("string"!=typeof O)throw new Error("The url value must be a string");var B;try{var U=new URL(O),G=yield fetch(U.toString());B=yield G.json()}catch(O){throw new Error("An error occurred while trying to load the Lottie file from URL")}return B}))).apply(this,arguments)}!function(O){O.Destroyed="destroyed",O.Error="error",O.Frozen="frozen",O.Loading="loading",O.Paused="paused",O.Playing="playing",O.Stopped="stopped"}(PlayerState||(PlayerState={})),function(O){O.Bounce="bounce",O.Normal="normal"}(PlayMode||(PlayMode={})),function(O){O.Complete="complete",O.Destroyed="destroyed",O.Error="error",O.Frame="frame",O.Freeze="freeze",O.Load="load",O.Loop="loop",O.Pause="pause",O.Play="play",O.Ready="ready",O.Rendered="rendered",O.Stop="stop"}(PlayerEvents||(PlayerEvents={}));var LottiePlayer=class extends s{constructor(){super(...arguments),this.autoplay=!1,this.background="transparent",this.controls=!1,this.currentState=PlayerState.Loading,this.description="Lottie animation",this.direction=1,this.disableCheck=!1,this.disableShadowDOM=!1,this.hover=!1,this.intermission=1,this.loop=!1,this.mode=PlayMode.Normal,this.preserveAspectRatio="xMidYMid meet",this.renderer="svg",this.speed=1,this._io=void 0,this._counter=1}load(O){var B=this;return _asyncToGenerator((function*(){var U={container:B.container,loop:!1,autoplay:!1,renderer:B.renderer,rendererSettings:Object.assign({preserveAspectRatio:B.preserveAspectRatio,clearCanvas:!1,progressiveLoad:!0,hideOnTransparent:!0},B.viewBoxSize&&{viewBoxSize:B.viewBoxSize})};try{var G=parseSrc(O),q={},j="string"==typeof G?"path":"animationData";B._lottie&&B._lottie.destroy(),B.webworkers&&lottie$1.exports.useWebWorker(!0),B._lottie=lottie$1.exports.loadAnimation(Object.assign(Object.assign({},U),{[j]:G})),B._attachEventListeners(),B.disableCheck||("path"===j?(q=yield fromURL(G),j="animationData"):q=G,isLottie(q)||(B.currentState=PlayerState.Error,B.dispatchEvent(new CustomEvent(PlayerEvents.Error))))}catch(O){B.currentState=PlayerState.Error,B.dispatchEvent(new CustomEvent(PlayerEvents.Error))}}))()}getLottie(){return this._lottie}getVersions(){return{lottieWebVersion:LOTTIE_WEB_VERSION,lottiePlayerVersion:LOTTIE_PLAYER_VERSION}}play(){this._lottie&&(this._lottie.play(),this.currentState=PlayerState.Playing,this.dispatchEvent(new CustomEvent(PlayerEvents.Play)))}pause(){this._lottie&&(this._lottie.pause(),this.currentState=PlayerState.Paused,this.dispatchEvent(new CustomEvent(PlayerEvents.Pause)))}stop(){this._lottie&&(this._counter=1,this._lottie.stop(),this.currentState=PlayerState.Stopped,this.dispatchEvent(new CustomEvent(PlayerEvents.Stop)))}destroy(){this._lottie&&(this._lottie.destroy(),this._lottie=null,this.currentState=PlayerState.Destroyed,this.dispatchEvent(new CustomEvent(PlayerEvents.Destroyed)),this.remove())}seek(O){if(this._lottie){var B=/^(\d+)(%?)$/.exec(O.toString());if(B){var U="%"===B[2]?this._lottie.totalFrames*Number(B[1])/100:Number(B[1]);this.seeker=U,this.currentState===PlayerState.Playing?this._lottie.goToAndPlay(U,!0):(this._lottie.goToAndStop(U,!0),this._lottie.pause())}}}snapshot(){var O=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shadowRoot){var B=this.shadowRoot.querySelector(".animation svg"),U=(new XMLSerializer).serializeToString(B);if(O){var G=document.createElement("a");G.href="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(U)),G.download="download_".concat(this.seeker,".svg"),document.body.appendChild(G),G.click(),document.body.removeChild(G)}return U}}setSpeed(){var O=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._lottie&&this._lottie.setSpeed(O)}setDirection(O){this._lottie&&this._lottie.setDirection(O)}setLooping(O){this._lottie&&(this.loop=O,this._lottie.loop=O)}togglePlay(){return this.currentState===PlayerState.Playing?this.pause():this.play()}toggleLooping(){this.setLooping(!this.loop)}resize(){this._lottie&&this._lottie.resize()}static get styles(){return styles}disconnectedCallback(){this.isConnected||(this._io&&(this._io.disconnect(),this._io=void 0),document.removeEventListener("visibilitychange",(()=>this._onVisibilityChange())),this.destroy())}render(){var O=this.controls?"main controls":"main",B=this.controls?"animation controls":"animation";return $(_templateObject||(_templateObject=_taggedTemplateLiteral([' <div\n      id="animation-container"\n      class=','\n      lang="en"\n      aria-label=','\n      role="img"\n    >\n      <div\n        id="animation"\n        class=','\n        style="background:',';"\n      >\n        ',"\n      </div>\n      ","\n    </div>"])),O,this.description,B,this.background,this.currentState===PlayerState.Error?$(_templateObject2||(_templateObject2=_taggedTemplateLiteral(['<div class="error"></div>']))):void 0,this.controls&&!this.disableShadowDOM?this.renderControls():void 0)}createRenderRoot(){return this.disableShadowDOM&&(this.style.display="block"),this.disableShadowDOM?this:super.createRenderRoot()}firstUpdated(){"IntersectionObserver"in window&&(this._io=new IntersectionObserver((O=>{O[0].isIntersecting?this.currentState===PlayerState.Frozen&&this.play():this.currentState===PlayerState.Playing&&this.freeze()})),this._io.observe(this.container)),void 0!==document.hidden&&document.addEventListener("visibilitychange",(()=>this._onVisibilityChange())),this.src&&this.load(this.src),this.dispatchEvent(new CustomEvent(PlayerEvents.Rendered))}renderControls(){var O=this.currentState===PlayerState.Playing,B=this.currentState===PlayerState.Paused,U=this.currentState===PlayerState.Stopped;return $(_templateObject3||(_templateObject3=_taggedTemplateLiteral(['\n      <div\n        id="lottie-controls"\n        aria-label="lottie-animation-controls"\n        class="toolbar"\n      >\n        <button\n          id="lottie-play-button"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="play-pause"\n        >\n          ','\n        </button>\n        <button\n          id="lottie-stop-button"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="stop"\n        >\n          <svg width="24" height="24" aria-hidden="true" focusable="false">\n            <path d="M6 6h12v12H6V6z" />\n          </svg>\n        </button>\n        <input\n          id="lottie-seeker-input"\n          class="seeker"\n          type="range"\n          min="0"\n          step="1"\n          max="100"\n          .value=',"\n          @input=","\n          @mousedown=","\n          @mouseup=",'\n          aria-valuemin="1"\n          aria-valuemax="100"\n          role="slider"\n          aria-valuenow=','\n          tabindex="0"\n          aria-label="lottie-seek-input"\n        />\n        <button\n          id="lottie-loop-toggle"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="loop-toggle"\n        >\n          <svg width="24" height="24" aria-hidden="true" focusable="false">\n            <path\n              d="M17.016 17.016v-4.031h1.969v6h-12v3l-3.984-3.984 3.984-3.984v3h10.031zM6.984 6.984v4.031H5.015v-6h12v-3l3.984 3.984-3.984 3.984v-3H6.984z"\n            />\n          </svg>\n        </button>\n      </div>\n    '])),this.togglePlay,O||B?"active":"",$(O?_templateObject4||(_templateObject4=_taggedTemplateLiteral(['<svg\n                width="24"\n                height="24"\n                aria-hidden="true"\n                focusable="false"\n              >\n                <path\n                  d="M14.016 5.016H18v13.969h-3.984V5.016zM6 18.984V5.015h3.984v13.969H6z"\n                />\n              </svg>'])):_templateObject5||(_templateObject5=_taggedTemplateLiteral(['<svg\n                width="24"\n                height="24"\n                aria-hidden="true"\n                focusable="false"\n              >\n                <path d="M8.016 5.016L18.985 12 8.016 18.984V5.015z" />\n              </svg>']))),this.stop,U?"active":"",this.seeker,this._handleSeekChange,(()=>{this._prevState=this.currentState,this.freeze()}),(()=>{this._prevState===PlayerState.Playing&&this.play()}),this.seeker,this.toggleLooping,this.loop?"active":"")}_onVisibilityChange(){!0===document.hidden&&this.currentState===PlayerState.Playing?this.freeze():this.currentState===PlayerState.Frozen&&this.play()}_handleSeekChange(O){if(this._lottie&&!isNaN(O.target.value)){var B=O.target.value/100*this._lottie.totalFrames;this.seek(B)}}_attachEventListeners(){this._lottie.addEventListener("enterFrame",(()=>{this.seeker=this._lottie.currentFrame/this._lottie.totalFrames*100,this.dispatchEvent(new CustomEvent(PlayerEvents.Frame,{detail:{frame:this._lottie.currentFrame,seeker:this.seeker}}))})),this._lottie.addEventListener("complete",(()=>{if(this.currentState===PlayerState.Playing){if(!this.loop||this.count&&this._counter>=this.count){if(this.dispatchEvent(new CustomEvent(PlayerEvents.Complete)),this.mode!==PlayMode.Bounce)return;if(0===this._lottie.currentFrame)return}this.mode===PlayMode.Bounce?(this.count&&(this._counter+=.5),setTimeout((()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Loop)),this.currentState===PlayerState.Playing&&(this._lottie.setDirection(-1*this._lottie.playDirection),this._lottie.play())}),this.intermission)):(this.count&&(this._counter+=1),window.setTimeout((()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Loop)),this.currentState===PlayerState.Playing&&(-1===this.direction?(this.seek("99%"),this.play()):(this._lottie.stop(),this._lottie.play()))}),this.intermission))}else this.dispatchEvent(new CustomEvent(PlayerEvents.Complete))})),this._lottie.addEventListener("DOMLoaded",(()=>{this.setSpeed(this.speed),this.setDirection(this.direction),this.autoplay&&(-1===this.direction&&this.seek("100%"),this.play()),this.dispatchEvent(new CustomEvent(PlayerEvents.Ready))})),this._lottie.addEventListener("data_ready",(()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Load))})),this._lottie.addEventListener("data_failed",(()=>{this.currentState=PlayerState.Error,this.dispatchEvent(new CustomEvent(PlayerEvents.Error))})),this.container.addEventListener("mouseenter",(()=>{this.hover&&this.currentState!==PlayerState.Playing&&this.play()})),this.container.addEventListener("mouseleave",(()=>{this.hover&&this.currentState===PlayerState.Playing&&this.stop()}))}freeze(){this._lottie&&(this._lottie.pause(),this.currentState=PlayerState.Frozen,this.dispatchEvent(new CustomEvent(PlayerEvents.Freeze)))}};__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"autoplay",void 0),__decorate([e$5({type:String,reflect:!0})],LottiePlayer.prototype,"background",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"controls",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"count",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"currentState",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"description",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"direction",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"disableCheck",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"disableShadowDOM",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"hover",void 0),__decorate([e$5()],LottiePlayer.prototype,"intermission",void 0),__decorate([e$5({type:Boolean,reflect:!0})],LottiePlayer.prototype,"loop",void 0),__decorate([e$5()],LottiePlayer.prototype,"mode",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"preserveAspectRatio",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"renderer",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"viewBoxSize",void 0),__decorate([e$5()],LottiePlayer.prototype,"seeker",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"speed",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"src",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"webworkers",void 0),__decorate([i(".animation")],LottiePlayer.prototype,"container",void 0),LottiePlayer=__decorate([n$1("lottie-player")],LottiePlayer)},5114:function(O,B){"use strict";var U,G=this&&this.__extends||(U=function(O,B){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},U(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}U(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)});Object.defineProperty(B,"__esModule",{value:!0}),B.LoginRequestResponse=B.ErrorResponse=B.SuccessResponse=B.ActivityResponse=B.ActivityRequestError=B.ActivityRequestTrigger=void 0,function(O){O.Automatic="automatic",O.Manual="manual"}(B.ActivityRequestTrigger||(B.ActivityRequestTrigger={}));var ActivityRequestError=function(O,B){this.code=O,this.message=B};B.ActivityRequestError=ActivityRequestError;var ActivityResponse=function(O){this.request=O};B.ActivityResponse=ActivityResponse;var q=function(O){function SuccessResponse(B,U){var G=O.call(this,B)||this;return G.request=B,G.rawContent=U,G}return G(SuccessResponse,O),SuccessResponse}(ActivityResponse);B.SuccessResponse=q;var j=function(O){function ErrorResponse(B,U){var G=O.call(this,B)||this;return G.request=B,G.error=U,G}return G(ErrorResponse,O),ErrorResponse}(ActivityResponse);B.ErrorResponse=j;var W=function(O){function LoginRequestResponse(B,U){var G=O.call(this,B)||this;G.request=B,G._auth=U;for(var q=0,j=G._auth.buttons;q<j.length;q++){var W=j[q];if("signin"===W.type&&void 0!==W.value)try{new URL(W.value),G.signinButton=W;break}catch(O){}}return G}return G(LoginRequestResponse,O),Object.defineProperty(LoginRequestResponse.prototype,"tokenExchangeResource",{get:function(){return this._auth.tokenExchangeResource},enumerable:!1,configurable:!0}),LoginRequestResponse}(ActivityResponse);B.LoginRequestResponse=W},3125:function(O,B,U){"use strict";var G=this&&this.__awaiter||function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){var B;O.done?q(O.value):(B=O.value,B instanceof U?B:new U((function(O){O(B)}))).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))},q=this&&this.__generator||function(O,B){var U,G,q,j,W={label:0,sent:function(){if(1&q[0])throw q[1];return q[1]},trys:[],ops:[]};return j={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(j[Symbol.iterator]=function(){return this}),j;function verb(j){return function(Y){return function(j){if(U)throw new TypeError("Generator is already executing.");for(;W;)try{if(U=1,G&&(q=2&j[0]?G.return:j[0]?G.throw||((q=G.return)&&q.call(G),0):G.next)&&!(q=q.call(G,j[1])).done)return q;switch(G=0,q&&(j=[2&j[0],q.value]),j[0]){case 0:case 1:q=j;break;case 4:return W.label++,{value:j[1],done:!1};case 5:W.label++,G=j[1],j=[0];continue;case 7:j=W.ops.pop(),W.trys.pop();continue;default:if(!(q=W.trys,(q=q.length>0&&q[q.length-1])||6!==j[0]&&2!==j[0])){W=0;continue}if(3===j[0]&&(!q||j[1]>q[0]&&j[1]<q[3])){W.label=j[1];break}if(6===j[0]&&W.label<q[1]){W.label=q[1],q=j;break}if(q&&W.label<q[2]){W.label=q[2],W.ops.push(j);break}q[2]&&W.ops.pop(),W.trys.pop();continue}j=B.call(O,W)}catch(O){j=[6,O],G=0}finally{U=q=0}if(5&j[0])throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}([j,Y])}}};Object.defineProperty(B,"__esModule",{value:!0}),B.AdaptiveApplet=void 0;var j=U(9003),W=U(7794),Y=U(8418),K=U(5114),Q=U(6758),Z=U(7191),X=U(2421);function logEvent(O,B){for(var U=[],G=2;G<arguments.length;G++)U[G-2]=arguments[G];if(Y.GlobalSettings.applets.logEnabled)if(Y.GlobalSettings.applets.onLogEvent)Y.GlobalSettings.applets.onLogEvent(O,B,U);else switch(O){case j.LogLevel.Warning:console.warn(B,U);break;case j.LogLevel.Error:console.error(B,U);break;default:console.log(B,U)}}var J=function(){function ActivityRequest(O,B,U){this.action=O,this.trigger=B,this.consecutiveRefreshes=U,this.attemptNumber=0}return ActivityRequest.prototype.retryAsync=function(){return G(this,void 0,void 0,(function(){return q(this,(function(O){return this.onSend&&this.onSend(this),[2]}))}))},ActivityRequest}(),ee=function(){function AdaptiveApplet(){this._allowAutomaticCardUpdate=!1,this.renderedElement=document.createElement("div"),this.renderedElement.className="aaf-cardHost",this.renderedElement.style.position="relative",this.renderedElement.style.display="flex",this.renderedElement.style.flexDirection="column",this._cardHostElement=document.createElement("div"),this._refreshButtonHostElement=document.createElement("div"),this._refreshButtonHostElement.className="aaf-refreshButtonHost",this._refreshButtonHostElement.style.display="none",this.renderedElement.appendChild(this._cardHostElement),this.renderedElement.appendChild(this._refreshButtonHostElement)}return AdaptiveApplet.prototype.displayCard=function(O){if(!O.renderedElement)throw new Error("displayCard: undefined card.");W.clearElementChildren(this._cardHostElement),this._refreshButtonHostElement.style.display="none",this._cardHostElement.appendChild(O.renderedElement)},AdaptiveApplet.prototype.showManualRefreshButton=function(O){var B=this;if(!this.onShowManualRefreshButton||this.onShowManualRefreshButton(this)){this._refreshButtonHostElement.style.display="none";var U=void 0;if(this.onRenderManualRefreshButton)U=this.onRenderManualRefreshButton(this);else{var G=Q.Strings.runtime.refreshThisCard();if(Y.GlobalSettings.applets.refresh.mode===j.RefreshMode.Automatic){var q=Q.Strings.runtime.automaticRefreshPaused();" "!==q[q.length-1]&&(q+=" "),G=Q.Strings.runtime.clckToRestartAutomaticRefresh()}var J={type:"AdaptiveCard",version:"1.2",body:[{type:"RichTextBlock",horizontalAlignment:"right",inlines:[{type:"TextRun",text:G,selectAction:{type:"Action.Submit",id:"refreshCard"}}]}]},ee=new Z.AdaptiveCard;ee.parse(J,new Z.SerializationContext(X.Versions.v1_2)),ee.onExecuteAction=function(U){"refreshCard"===U.id&&(W.clearElementChildren(B._refreshButtonHostElement),B.internalExecuteAction(O,K.ActivityRequestTrigger.Automatic,0))},U=ee.render()}U&&(W.clearElementChildren(this._refreshButtonHostElement),this._refreshButtonHostElement.appendChild(U),this._refreshButtonHostElement.style.removeProperty("display"))}},AdaptiveApplet.prototype.createActivityRequest=function(O,B,U){var G=this;if(this.card){var q=new J(O,B,U);return q.onSend=function(O){O.attemptNumber++,G.internalSendActivityRequestAsync(q)},!!this.onPrepareActivityRequest&&!this.onPrepareActivityRequest(this,q,O)?void 0:q}throw new Error("createActivityRequest: no card has been set.")},AdaptiveApplet.prototype.createMagicCodeInputCard=function(O){var B={type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",color:"attention",text:1===O?void 0:"That didn't work... let's try again.",wrap:!0,horizontalAlignment:"center"},{type:"TextBlock",text:'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',wrap:!0,horizontalAlignment:"center"},{type:"Input.Text",id:"magicCode",placeholder:"Enter magic code"},{type:"ActionSet",horizontalAlignment:"center",actions:[{type:"Action.Submit",id:AdaptiveApplet._submitMagicCodeActionId,title:"Submit"},{type:"Action.Submit",id:AdaptiveApplet._cancelMagicCodeAuthActionId,title:"Cancel"}]}]},U=new Z.AdaptiveCard;return U.parse(B),U},AdaptiveApplet.prototype.cancelAutomaticRefresh=function(){this._allowAutomaticCardUpdate&&logEvent(j.LogLevel.Warning,"Automatic card refresh has been cancelled as a result of the user interacting with the card."),this._allowAutomaticCardUpdate=!1},AdaptiveApplet.prototype.createSerializationContext=function(){return this.onCreateSerializationContext?this.onCreateSerializationContext(this):new Z.SerializationContext},AdaptiveApplet.prototype.internalSetCard=function(O,B){var U=this;if("object"==typeof O&&"AdaptiveCard"===O.type&&(this._cardPayload=O),this._cardPayload)try{var G=new Z.AdaptiveCard;this.hostConfig&&(G.hostConfig=this.hostConfig);var q=this.createSerializationContext();if(G.parse(this._cardPayload,q),(!this.onCardChanging||this.onCardChanging(this,this._cardPayload))&&(this._card=G,this._card.authentication&&this._card.authentication.tokenExchangeResource&&this.onPrefetchSSOToken&&this.onPrefetchSSOToken(this,this._card.authentication.tokenExchangeResource),this._card.onExecuteAction=function(O){U.cancelAutomaticRefresh(),U.internalExecuteAction(O,K.ActivityRequestTrigger.Manual,0)},this._card.onInputValueChanged=function(O){U.cancelAutomaticRefresh()},this._card.render(),this._card.renderedElement&&(this.displayCard(this._card),this.onCardChanged&&this.onCardChanged(this),this._card.refresh)))if(Y.GlobalSettings.applets.refresh.mode===j.RefreshMode.Automatic&&B<Y.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes)if(Y.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes<=0)logEvent(j.LogLevel.Info,"Triggering automatic card refresh number "+(B+1)),this.internalExecuteAction(this._card.refresh.action,K.ActivityRequestTrigger.Automatic,B+1);else{logEvent(j.LogLevel.Info,"Scheduling automatic card refresh number "+(B+1)+" in "+Y.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes+"ms");var W=this._card.refresh.action;this._allowAutomaticCardUpdate=!0,window.setTimeout((function(){U._allowAutomaticCardUpdate&&U.internalExecuteAction(W,K.ActivityRequestTrigger.Automatic,B+1)}),Y.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes)}else Y.GlobalSettings.applets.refresh.mode!==j.RefreshMode.Disabled&&(logEvent(j.LogLevel.Warning,B>0?"Stopping automatic refreshes after "+B+" consecutive refreshes.":"The card has a refresh section, but automatic refreshes are disabled."),(Y.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes||Y.GlobalSettings.applets.refresh.mode===j.RefreshMode.Manual)&&(logEvent(j.LogLevel.Info,"Showing manual refresh button."),this.showManualRefreshButton(this._card.refresh.action)))}catch(O){logEvent(j.LogLevel.Error,"setCard: "+O)}},AdaptiveApplet.prototype.internalExecuteAction=function(O,B,U){if(O instanceof Z.ExecuteAction){if(!this.channelAdapter)throw new Error("internalExecuteAction: No channel adapter set.");var G=this.createActivityRequest(O,B,U);G&&G.retryAsync()}this.onAction&&this.onAction(this,O)},AdaptiveApplet.prototype.createProgressOverlay=function(O){if(!this._progressOverlay)if(this.onCreateProgressOverlay)this._progressOverlay=this.onCreateProgressOverlay(this,O);else{this._progressOverlay=document.createElement("div"),this._progressOverlay.className="aaf-progress-overlay";var B=document.createElement("div");B.className="aaf-spinner",B.style.width="28px",B.style.height="28px",this._progressOverlay.appendChild(B)}return this._progressOverlay},AdaptiveApplet.prototype.removeProgressOverlay=function(O){this.onRemoveProgressOverlay&&this.onRemoveProgressOverlay(this,O),void 0!==this._progressOverlay&&(this.renderedElement.removeChild(this._progressOverlay),this._progressOverlay=void 0)},AdaptiveApplet.prototype.activityRequestSucceeded=function(O,B){this.onActivityRequestSucceeded&&this.onActivityRequestSucceeded(this,O,B)},AdaptiveApplet.prototype.activityRequestFailed=function(O){return this.onActivityRequestFailed?this.onActivityRequestFailed(this,O):Y.GlobalSettings.applets.defaultTimeBetweenRetryAttempts},AdaptiveApplet.prototype.showAuthCodeInputDialog=function(O){var B=this;if(!this.onShowAuthCodeInputDialog||this.onShowAuthCodeInputDialog(this,O)){var U=this.createMagicCodeInputCard(O.attemptNumber);U.render(),U.onExecuteAction=function(U){if(B.card&&U instanceof Z.SubmitAction)switch(U.id){case AdaptiveApplet._submitMagicCodeActionId:var G=void 0;U.data&&"string"==typeof U.data.magicCode&&(G=U.data.magicCode),G?(B.displayCard(B.card),O.authCode=G,O.retryAsync()):alert("Please enter the magic code you received.");break;case AdaptiveApplet._cancelMagicCodeAuthActionId:logEvent(j.LogLevel.Warning,"Authentication cancelled by user."),B.displayCard(B.card);break;default:logEvent(j.LogLevel.Error,"Unexpected action taken from magic code input card (id = "+U.id+")"),alert(Q.Strings.magicCodeInputCard.somethingWentWrong())}},this.displayCard(U)}},AdaptiveApplet.prototype.internalSendActivityRequestAsync=function(O){return G(this,void 0,void 0,(function(){var B,U,G,W;return q(this,(function(Z){switch(Z.label){case 0:if(!this.channelAdapter)throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.");void 0!==(B=this.createProgressOverlay(O))&&this.renderedElement.appendChild(B),U=!1,G=function(){var B,G,Z,X,J,ee,te;return q(this,(function(q){switch(q.label){case 0:B=void 0,1===O.attemptNumber?logEvent(j.LogLevel.Info,"Sending activity request to channel (attempt "+O.attemptNumber+")"):logEvent(j.LogLevel.Info,"Re-sending activity request to channel (attempt "+O.attemptNumber+")"),q.label=1;case 1:return q.trys.push([1,3,,4]),[4,W.channelAdapter.sendRequestAsync(O)];case 2:return B=q.sent(),[3,4];case 3:return G=q.sent(),logEvent(j.LogLevel.Error,"Activity request failed: "+G),W.removeProgressOverlay(O),U=!0,[3,4];case 4:if(!B)return[3,10];if(!(B instanceof K.SuccessResponse))return[3,5];if(W.removeProgressOverlay(O),void 0===B.rawContent)throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined");Z=B.rawContent;try{Z=JSON.parse(B.rawContent)}catch(O){}if("string"==typeof Z)logEvent(j.LogLevel.Info,"The activity request returned a string after "+O.attemptNumber+" attempt(s)."),W.activityRequestSucceeded(B,Z);else{if("object"!=typeof Z||"AdaptiveCard"!==Z.type)throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+typeof B.rawContent+")");logEvent(j.LogLevel.Info,"The activity request returned an Adaptive Card after "+O.attemptNumber+" attempt(s)."),W.internalSetCard(Z,O.consecutiveRefreshes),W.activityRequestSucceeded(B,W.card)}return U=!0,[3,10];case 5:return B instanceof K.ErrorResponse?(X=W.activityRequestFailed(B))>=0&&O.attemptNumber<Y.GlobalSettings.applets.maximumRetryAttempts?(logEvent(j.LogLevel.Warning,"Activity request failed: ".concat(B.error.message,". Retrying in ").concat(X,"ms")),O.attemptNumber++,[4,new Promise((function(O,B){window.setTimeout((function(){O()}),X)}))]):[3,7]:[3,9];case 6:return q.sent(),[3,8];case 7:logEvent(j.LogLevel.Error,"Activity request failed: ".concat(B.error.message,". Giving up after ").concat(O.attemptNumber," attempt(s)")),W.removeProgressOverlay(O),U=!0,q.label=8;case 8:return[3,10];case 9:if(B instanceof K.LoginRequestResponse){if(logEvent(j.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+O.attemptNumber+" attempt(s)."),O.attemptNumber<=Y.GlobalSettings.applets.maximumRetryAttempts){if(J=!0,B.tokenExchangeResource&&W.onSSOTokenNeeded&&(J=!W.onSSOTokenNeeded(W,O,B.tokenExchangeResource)),J){if(W.removeProgressOverlay(O),void 0===B.signinButton)throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.");logEvent(j.LogLevel.Info,"Login required at "+B.signinButton.value),W.onShowSigninPrompt?W.onShowSigninPrompt(W,O,B.signinButton):(W.showAuthCodeInputDialog(O),ee=window.screenX+(window.outerWidth-Y.GlobalSettings.applets.authPromptWidth)/2,te=window.screenY+(window.outerHeight-Y.GlobalSettings.applets.authPromptHeight)/2,window.open(B.signinButton.value,B.signinButton.title?B.signinButton.title:"Sign in","width=".concat(Y.GlobalSettings.applets.authPromptWidth,",height=").concat(Y.GlobalSettings.applets.authPromptHeight,",left=").concat(ee,",top=").concat(te)))}}else logEvent(j.LogLevel.Error,"Authentication failed. Giving up after "+O.attemptNumber+" attempt(s)"),alert(Q.Strings.magicCodeInputCard.authenticationFailed());return[2,"break"]}throw new Error("Unhandled response type: "+JSON.stringify(B));case 10:return[2]}}))},W=this,Z.label=1;case 1:return U?[3,3]:[5,G()];case 2:return"break"===Z.sent()?[3,3]:[3,1];case 3:return[2]}}))}))},AdaptiveApplet.prototype.refreshCard=function(){this._card&&this._card.refresh&&this.internalExecuteAction(this._card.refresh.action,K.ActivityRequestTrigger.Manual,0)},AdaptiveApplet.prototype.setCard=function(O){this.internalSetCard(O,0)},Object.defineProperty(AdaptiveApplet.prototype,"card",{get:function(){return this._card},enumerable:!1,configurable:!0}),AdaptiveApplet._submitMagicCodeActionId="submitMagicCode",AdaptiveApplet._cancelMagicCodeAuthActionId="cancelMagicCodeAuth",AdaptiveApplet}();B.AdaptiveApplet=ee},8911:function(O,B,U){"use strict";var G=this&&this.__createBinding||(Object.create?function(O,B,U,G){void 0===G&&(G=U);var q=Object.getOwnPropertyDescriptor(B,U);q&&!("get"in q?!B.__esModule:q.writable||q.configurable)||(q={enumerable:!0,get:function(){return B[U]}}),Object.defineProperty(O,G,q)}:function(O,B,U,G){void 0===G&&(G=U),O[G]=B[U]}),q=this&&this.__exportStar||function(O,B){for(var U in O)"default"===U||Object.prototype.hasOwnProperty.call(B,U)||G(B,O,U)};Object.defineProperty(B,"__esModule",{value:!0}),q(U(6758),B),q(U(9003),B),q(U(8418),B),q(U(7794),B),q(U(2421),B),q(U(9779),B),q(U(351),B),q(U(9301),B),q(U(182),B),q(U(7191),B),q(U(7516),B),q(U(6629),B),q(U(160),B),q(U(5114),B),q(U(3125),B)},7191:function(O,B,U){"use strict";var G,q=this&&this.__extends||(G=function(O,B){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},G(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}G(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)}),j=this&&this.__decorate||function(O,B,U,G){var q,j=arguments.length,W=j<3?B:null===G?G=Object.getOwnPropertyDescriptor(B,U):G;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(O,B,U,G);else for(var Y=O.length-1;Y>=0;Y--)(q=O[Y])&&(W=(j<3?q(W):j>3?q(B,U,W):q(B,U))||W);return j>3&&W&&Object.defineProperty(B,U,W),W},W=this&&this.__awaiter||function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){var B;O.done?q(O.value):(B=O.value,B instanceof U?B:new U((function(O){O(B)}))).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))},Y=this&&this.__generator||function(O,B){var U,G,q,j,W={label:0,sent:function(){if(1&q[0])throw q[1];return q[1]},trys:[],ops:[]};return j={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(j[Symbol.iterator]=function(){return this}),j;function verb(j){return function(Y){return function(j){if(U)throw new TypeError("Generator is already executing.");for(;W;)try{if(U=1,G&&(q=2&j[0]?G.return:j[0]?G.throw||((q=G.return)&&q.call(G),0):G.next)&&!(q=q.call(G,j[1])).done)return q;switch(G=0,q&&(j=[2&j[0],q.value]),j[0]){case 0:case 1:q=j;break;case 4:return W.label++,{value:j[1],done:!1};case 5:W.label++,G=j[1],j=[0];continue;case 7:j=W.ops.pop(),W.trys.pop();continue;default:if(!(q=W.trys,(q=q.length>0&&q[q.length-1])||6!==j[0]&&2!==j[0])){W=0;continue}if(3===j[0]&&(!q||j[1]>q[0]&&j[1]<q[3])){W.label=j[1];break}if(6===j[0]&&W.label<q[1]){W.label=q[1],q=j;break}if(q&&W.label<q[2]){W.label=q[2],W.ops.push(j);break}q[2]&&W.ops.pop(),W.trys.pop();continue}j=B.call(O,W)}catch(O){j=[6,O],G=0}finally{U=q=0}if(5&j[0])throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}([j,Y])}}};Object.defineProperty(B,"__esModule",{value:!0}),B.ContainerWithActions=B.ColumnSet=B.Column=B.Container=B.BackgroundImage=B.ContainerBase=B.StylableCardElementContainer=B.ContainerStyleProperty=B.ActionSet=B.ShowCardAction=B.HttpAction=B.HttpHeader=B.ToggleVisibilityAction=B.OpenUrlAction=B.ExecuteAction=B.SubmitAction=B.SubmitActionBase=B.Action=B.TimeInput=B.TimeProperty=B.DateInput=B.NumberInput=B.ChoiceSetInput=B.Choice=B.ToggleInput=B.TextInput=B.Input=B.Media=B.YouTubePlayer=B.DailymotionPlayer=B.VimeoPlayer=B.IFrameMediaMediaPlayer=B.CustomMediaPlayer=B.HTML5MediaPlayer=B.MediaPlayer=B.MediaSource=B.CaptionSource=B.ContentSource=B.ImageSet=B.CardElementContainer=B.Image=B.FactSet=B.Fact=B.RichTextBlock=B.TextRun=B.TextBlock=B.BaseTextBlock=B.ActionProperty=B.CardElement=B.renderSeparation=void 0,B.SerializationContext=B.AdaptiveCard=B.Authentication=B.TokenExchangeResource=B.AuthCardButton=B.RefreshDefinition=B.RefreshActionProperty=void 0;var K=U(9003),Q=U(8418),Z=U(7794),X=U(351),J=U(9514),ee=U(182),te=U(2421),ie=U(9301),re=U(6758),ne=U(9336);function clearElement(O){var B,U,G="undefined"==typeof window?"":null!==(U=null===(B=window.trustedTypes)||void 0===B?void 0:B.emptyHTML)&&void 0!==U?U:"";O.innerHTML=G}function renderSeparation(O,B,U){if(B.spacing>0||B.lineThickness&&B.lineThickness>0){var G=document.createElement("div");G.className=O.makeCssClassName("ac-"+(U===K.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),G.setAttribute("aria-hidden","true");var q=B.lineColor?Z.stringToCssColor(B.lineColor):"";return U===K.Orientation.Horizontal?B.lineThickness?(G.style.paddingTop=B.spacing/2+"px",G.style.marginBottom=B.spacing/2+"px",G.style.borderBottom=B.lineThickness+"px solid "+q):G.style.height=B.spacing+"px":B.lineThickness?(G.style.paddingLeft=B.spacing/2+"px",G.style.marginRight=B.spacing/2+"px",G.style.borderRight=B.lineThickness+"px solid "+q):G.style.width=B.spacing+"px",G.style.overflow="hidden",G.style.flex="0 0 auto",G}}B.renderSeparation=renderSeparation;var oe=function(O){function CardElement(){var B=null!==O&&O.apply(this,arguments)||this;return B._truncatedDueToOverflow=!1,B}return q(CardElement,O),Object.defineProperty(CardElement.prototype,"lang",{get:function(){var O=this.getValue(CardElement.langProperty);return O||(this.parent?this.parent.lang:void 0)},set:function(O){this.setValue(CardElement.langProperty,O)},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"isVisible",{get:function(){return this.getValue(CardElement.isVisibleProperty)},set:function(O){Q.GlobalSettings.useAdvancedCardBottomTruncation&&!O&&this.undoOverflowTruncation(),this.isVisible!==O&&(this.setValue(CardElement.isVisibleProperty,O),this.updateRenderedElementVisibility(),this._renderedElement&&raiseElementVisibilityChangedEvent(this)),this._renderedElement&&this._renderedElement.setAttribute("aria-expanded",O.toString())},enumerable:!1,configurable:!0}),CardElement.prototype.internalRenderSeparator=function(){var O=renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.separator?this.hostConfig.separator.lineColor:void 0},this.separatorOrientation);if(Q.GlobalSettings.alwaysBleedSeparators&&O&&this.separatorOrientation===K.Orientation.Horizontal){var B=this.getParentContainer();if(B&&B.getEffectivePadding()){var U=this.hostConfig.paddingDefinitionToSpacingDefinition(B.getEffectivePadding());O.style.marginLeft="-"+U.left+"px",O.style.marginRight="-"+U.right+"px"}}return O},CardElement.prototype.updateRenderedElementVisibility=function(){var O=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(O?this._renderedElement.style.display=O:this._renderedElement.style.removeProperty("display")),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":O?this._separatorElement.style.display=O:this._separatorElement.style.removeProperty("display"))},CardElement.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,raiseElementVisibilityChangedEvent(this,!1))},CardElement.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.removeProperty("visibility"),this.isVisible=!0,raiseElementVisibilityChangedEvent(this,!1))},CardElement.prototype.handleOverflow=function(O){if(this.isVisible||this.isHiddenDueToOverflow()){var B=this.truncateOverflow(O);this._truncatedDueToOverflow=B||this._truncatedDueToOverflow,B?B&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}},CardElement.prototype.resetOverflow=function(){var O=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,O=!0),this.isHiddenDueToOverflow()&&this.showElementHiddenDueToOverflow(),O},CardElement.prototype.getDefaultSerializationContext=function(){return new pt},CardElement.prototype.createPlaceholderElement=function(){var O=this.getEffectiveStyleDefinition(),B=Z.stringToCssColor(O.foregroundColors.default.subtle),U=document.createElement("div");return U.style.border="1px dashed "+B,U.style.padding="4px",U.style.minHeight="32px",U.style.fontSize="10px",B&&(U.style.color=B),U.innerText="Empty "+this.getJsonTypeName(),U},CardElement.prototype.adjustRenderedElementSize=function(O){"auto"===this.height?O.style.flex="0 0 auto":O.style.flex="1 1 auto"},CardElement.prototype.isDisplayed=function(){return void 0!==this._renderedElement&&this.isVisible&&this._renderedElement.offsetHeight>0},CardElement.prototype.overrideInternalRender=function(){return this.internalRender()},CardElement.prototype.applyPadding=function(){if(this.separatorElement&&this.separatorOrientation===K.Orientation.Horizontal)if(Q.GlobalSettings.alwaysBleedSeparators&&!this.isBleeding()){var O=new Q.PaddingDefinition;this.getImmediateSurroundingPadding(O);var B=this.hostConfig.paddingDefinitionToSpacingDefinition(O);this.separatorElement.style.marginLeft="-"+B.left+"px",this.separatorElement.style.marginRight="-"+B.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"},CardElement.prototype.truncateOverflow=function(O){return!1},CardElement.prototype.undoOverflowTruncation=function(){},CardElement.prototype.getDefaultPadding=function(){return new Q.PaddingDefinition},CardElement.prototype.getHasBackground=function(O){return void 0===O&&(O=!1),!1},CardElement.prototype.getHasBorder=function(){return!1},CardElement.prototype.getPadding=function(){return this._padding},CardElement.prototype.setPadding=function(O){this._padding=O},CardElement.prototype.shouldSerialize=function(O){return void 0!==O.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(CardElement.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"separatorOrientation",{get:function(){return K.Orientation.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"defaultStyle",{get:function(){return K.ContainerStyle.Default},enumerable:!1,configurable:!0}),CardElement.prototype.parse=function(B,U){O.prototype.parse.call(this,B,U||new pt)},CardElement.prototype.asString=function(){return""},CardElement.prototype.isBleeding=function(){return!1},CardElement.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},CardElement.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},CardElement.prototype.getEffectiveTextStyleDefinition=function(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default},CardElement.prototype.getForbiddenActionTypes=function(){return[]},CardElement.prototype.getImmediateSurroundingPadding=function(O,B,U,G,q){if(void 0===B&&(B=!0),void 0===U&&(U=!0),void 0===G&&(G=!0),void 0===q&&(q=!0),this.parent){var j=B&&this.parent.isTopElement(this),W=U&&this.parent.isRightMostElement(this),Y=G&&this.parent.isBottomElement(this),Q=q&&this.parent.isLeftMostElement(this),Z=this.parent.getEffectivePadding();Z&&(j&&Z.top!==K.Spacing.None&&(O.top=Z.top,j=!1),W&&Z.right!==K.Spacing.None&&(O.right=Z.right,W=!1),Y&&Z.bottom!==K.Spacing.None&&(O.bottom=Z.bottom,Y=!1),Q&&Z.left!==K.Spacing.None&&(O.left=Z.left,Q=!1)),(j||W||Y||Q)&&this.parent.getImmediateSurroundingPadding(O,j,W,Y,Q)}},CardElement.prototype.getActionCount=function(){return 0},CardElement.prototype.getActionAt=function(O){throw new Error(re.Strings.errors.indexOutOfRange(O))},CardElement.prototype.indexOfAction=function(O){for(var B=0;B<this.getActionCount();B++)if(this.getActionAt(B)===O)return B;return-1},CardElement.prototype.remove=function(){return!!(this.parent&&this.parent instanceof ge)&&this.parent.removeItem(this)},CardElement.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.id&&(this._renderedElement.id=this.id),this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:void 0,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this.getRootElement().updateActionsEnabledState(),this._renderedElement},CardElement.prototype.updateLayout=function(O){void 0===O&&(O=!0),this.updateRenderedElementVisibility(),this.applyPadding()},CardElement.prototype.updateActionsEnabledState=function(){for(var O=0,B=this.getRootElement().getAllActions();O<B.length;O++){B[O].updateEnabledState()}},CardElement.prototype.indexOf=function(O){return-1},CardElement.prototype.isDesignMode=function(){var O=this.getRootElement();return O instanceof ct&&O.designMode},CardElement.prototype.isFirstElement=function(O){return!0},CardElement.prototype.isLastElement=function(O){return!0},CardElement.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},CardElement.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},CardElement.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},CardElement.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},CardElement.prototype.isBleedingAtTop=function(){return!1},CardElement.prototype.isBleedingAtBottom=function(){return!1},CardElement.prototype.isLeftMostElement=function(O){return!0},CardElement.prototype.isRightMostElement=function(O){return!0},CardElement.prototype.isTopElement=function(O){return this.isFirstElement(O)},CardElement.prototype.isBottomElement=function(O){return this.isLastElement(O)},CardElement.prototype.isHiddenDueToOverflow=function(){return void 0!==this._renderedElement&&"hidden"===this._renderedElement.style.visibility},CardElement.prototype.getRootElement=function(){return this.getRootObject()},CardElement.prototype.getParentContainer=function(){for(var O=this.parent;O;){if(O instanceof et)return O;O=O.parent}},CardElement.prototype.getAllInputs=function(O){return void 0===O&&(O=!0),[]},CardElement.prototype.getAllActions=function(){for(var O=[],B=0;B<this.getActionCount();B++){var U=this.getActionAt(B);U&&O.push(U)}return O},CardElement.prototype.getResourceInformation=function(){return[]},CardElement.prototype.getElementById=function(O){return this.id===O?this:void 0},CardElement.prototype.getActionById=function(O){},CardElement.prototype.getEffectivePadding=function(){var O=this.getPadding();return O||this.getDefaultPadding()},CardElement.prototype.getEffectiveHorizontalAlignment=function(){return void 0!==this.horizontalAlignment?this.horizontalAlignment:this.parent?this.parent.getEffectiveHorizontalAlignment():K.HorizontalAlignment.Left},Object.defineProperty(CardElement.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:X.defaultHostConfig},set:function(O){this._hostConfig=O},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!1,configurable:!0}),Object.defineProperty(CardElement.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),CardElement.langProperty=new te.StringProperty(te.Versions.v1_1,"lang",!0,/^[a-z]{2,3}$/gi),CardElement.isVisibleProperty=new te.BoolProperty(te.Versions.v1_2,"isVisible",!0),CardElement.separatorProperty=new te.BoolProperty(te.Versions.v1_0,"separator",!1),CardElement.heightProperty=new te.ValueSetProperty(te.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),CardElement.horizontalAlignmentProperty=new te.EnumProperty(te.Versions.v1_0,"horizontalAlignment",K.HorizontalAlignment),CardElement.spacingProperty=new te.EnumProperty(te.Versions.v1_0,"spacing",K.Spacing,K.Spacing.Default),j([(0,te.property)(CardElement.horizontalAlignmentProperty)],CardElement.prototype,"horizontalAlignment",void 0),j([(0,te.property)(CardElement.spacingProperty)],CardElement.prototype,"spacing",void 0),j([(0,te.property)(CardElement.separatorProperty)],CardElement.prototype,"separator",void 0),j([(0,te.property)(CardElement.heightProperty)],CardElement.prototype,"height",void 0),j([(0,te.property)(CardElement.langProperty)],CardElement.prototype,"lang",null),j([(0,te.property)(CardElement.isVisibleProperty)],CardElement.prototype,"isVisible",null),CardElement}(ee.CardObject);B.CardElement=oe;var ae=function(O){function ActionProperty(B,U,G){void 0===G&&(G=[]);var q=O.call(this,B,U,void 0)||this;return q.targetVersion=B,q.name=U,q.forbiddenActionTypes=G,q}return q(ActionProperty,O),ActionProperty.prototype.parse=function(O,B,U){var G=O;return U.parseAction(G,B[this.name],this.forbiddenActionTypes,G.isDesignMode())},ActionProperty.prototype.toJSON=function(O,B,U,G){G.serializeValue(B,this.name,U?U.toJSON(G):void 0,void 0,!0)},ActionProperty}(te.PropertyDefinition);B.ActionProperty=ae;var se=function(O){function BaseTextBlock(B){var U=O.call(this)||this;return U.ariaHidden=!1,B&&(U.text=B),U}return q(BaseTextBlock,O),BaseTextBlock.prototype.populateSchema=function(B){O.prototype.populateSchema.call(this,B),B.remove(BaseTextBlock.selectActionProperty)},Object.defineProperty(BaseTextBlock.prototype,"text",{get:function(){return this.getValue(BaseTextBlock.textProperty)},set:function(O){this.setText(O)},enumerable:!1,configurable:!0}),BaseTextBlock.prototype.getFontSize=function(O){switch(this.effectiveSize){case K.TextSize.Small:return O.fontSizes.small;case K.TextSize.Medium:return O.fontSizes.medium;case K.TextSize.Large:return O.fontSizes.large;case K.TextSize.ExtraLarge:return O.fontSizes.extraLarge;default:return O.fontSizes.default}},BaseTextBlock.prototype.getColorDefinition=function(O,B){switch(B){case K.TextColor.Accent:return O.accent;case K.TextColor.Dark:return O.dark;case K.TextColor.Light:return O.light;case K.TextColor.Good:return O.good;case K.TextColor.Warning:return O.warning;case K.TextColor.Attention:return O.attention;default:return O.default}},BaseTextBlock.prototype.setText=function(O){this.setValue(BaseTextBlock.textProperty,O)},BaseTextBlock.prototype.init=function(O){this.size=O.size,this.weight=O.weight,this.color=O.color,this.isSubtle=O.isSubtle},BaseTextBlock.prototype.asString=function(){return this.text},BaseTextBlock.prototype.applyStylesTo=function(O){var B,U=this.hostConfig.getFontTypeDefinition(this.effectiveFontType);switch(U.fontFamily&&(O.style.fontFamily=U.fontFamily),this.effectiveSize){case K.TextSize.Small:B=U.fontSizes.small;break;case K.TextSize.Medium:B=U.fontSizes.medium;break;case K.TextSize.Large:B=U.fontSizes.large;break;case K.TextSize.ExtraLarge:B=U.fontSizes.extraLarge;break;default:B=U.fontSizes.default}O.style.fontSize=B+"px";var G,q=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),j=Z.stringToCssColor(this.effectiveIsSubtle?q.subtle:q.default);switch(j&&(O.style.color=j),this.effectiveWeight){case K.TextWeight.Lighter:G=U.fontWeights.lighter;break;case K.TextWeight.Bolder:G=U.fontWeights.bolder;break;default:G=U.fontWeights.default}O.style.fontWeight=G.toString(),this.ariaHidden&&O.setAttribute("aria-hidden","true")},BaseTextBlock.prototype.getAllActions=function(){var B=O.prototype.getAllActions.call(this);return this.selectAction&&B.push(this.selectAction),B},Object.defineProperty(BaseTextBlock.prototype,"effectiveColor",{get:function(){return void 0!==this.color?this.color:this.getEffectiveTextStyleDefinition().color},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTextBlock.prototype,"effectiveFontType",{get:function(){return void 0!==this.fontType?this.fontType:this.getEffectiveTextStyleDefinition().fontType},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTextBlock.prototype,"effectiveIsSubtle",{get:function(){return void 0!==this.isSubtle?this.isSubtle:this.getEffectiveTextStyleDefinition().isSubtle},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTextBlock.prototype,"effectiveSize",{get:function(){return void 0!==this.size?this.size:this.getEffectiveTextStyleDefinition().size},enumerable:!1,configurable:!0}),Object.defineProperty(BaseTextBlock.prototype,"effectiveWeight",{get:function(){return void 0!==this.weight?this.weight:this.getEffectiveTextStyleDefinition().weight},enumerable:!1,configurable:!0}),BaseTextBlock.textProperty=new te.StringProperty(te.Versions.v1_0,"text",!0),BaseTextBlock.sizeProperty=new te.EnumProperty(te.Versions.v1_0,"size",K.TextSize),BaseTextBlock.weightProperty=new te.EnumProperty(te.Versions.v1_0,"weight",K.TextWeight),BaseTextBlock.colorProperty=new te.EnumProperty(te.Versions.v1_0,"color",K.TextColor),BaseTextBlock.isSubtleProperty=new te.BoolProperty(te.Versions.v1_0,"isSubtle"),BaseTextBlock.fontTypeProperty=new te.EnumProperty(te.Versions.v1_2,"fontType",K.FontType),BaseTextBlock.selectActionProperty=new ae(te.Versions.v1_1,"selectAction",["Action.ShowCard"]),j([(0,te.property)(BaseTextBlock.sizeProperty)],BaseTextBlock.prototype,"size",void 0),j([(0,te.property)(BaseTextBlock.weightProperty)],BaseTextBlock.prototype,"weight",void 0),j([(0,te.property)(BaseTextBlock.colorProperty)],BaseTextBlock.prototype,"color",void 0),j([(0,te.property)(BaseTextBlock.fontTypeProperty)],BaseTextBlock.prototype,"fontType",void 0),j([(0,te.property)(BaseTextBlock.isSubtleProperty)],BaseTextBlock.prototype,"isSubtle",void 0),j([(0,te.property)(BaseTextBlock.textProperty)],BaseTextBlock.prototype,"text",null),j([(0,te.property)(BaseTextBlock.selectActionProperty)],BaseTextBlock.prototype,"selectAction",void 0),BaseTextBlock}(oe);B.BaseTextBlock=se;var le=function(O){function TextBlock(){var B=null!==O&&O.apply(this,arguments)||this;return B.wrap=!1,B._treatAsPlainText=!0,B.useMarkdown=!0,B}var B,U;return q(TextBlock,O),TextBlock.prototype.restoreOriginalContent=function(){var O,B;if(void 0!==this.renderedElement){this.maxLines&&this.maxLines>0&&(this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px");var U=null!==(B=null===(O=TextBlock._ttRoundtripPolicy)||void 0===O?void 0:O.createHTML(this._originalInnerHtml))&&void 0!==B?B:this._originalInnerHtml;this.renderedElement.innerHTML=U}},TextBlock.prototype.truncateIfSupported=function(O){if(void 0!==this.renderedElement){var B=this.renderedElement.children,U=!B.length;if(U||1===B.length&&"p"===B[0].tagName.toLowerCase()&&!B[0].children.length){var G=U?this.renderedElement:B[0];return Z.truncateText(G,O,this._computedLineHeight),!0}}return!1},TextBlock.prototype.setText=function(B){O.prototype.setText.call(this,B),this._processedText=void 0},TextBlock.prototype.internalRender=function(){var O,B,U=this;if(this._processedText=void 0,this.text){var G=this.preProcessPropertyValue(se.textProperty),q=this.hostConfig,j=void 0;if(this.forElementId){var W=document.createElement("label");W.htmlFor=this.forElementId,j=W}else j=document.createElement("div");if(j.classList.add(q.makeCssClassName("ac-textBlock")),j.style.overflow="hidden",this.applyStylesTo(j),"heading"===this.style){j.setAttribute("role","heading");var Y=this.hostConfig.textBlock.headingLevel;void 0!==Y&&Y>0&&j.setAttribute("aria-level",Y.toString())}if(this.selectAction&&q.supportsInteractivity&&(j.onclick=function(O){U.selectAction&&U.selectAction.isEffectivelyEnabled()&&(O.preventDefault(),O.cancelBubble=!0,U.selectAction.execute())},this.selectAction.setupElementForAccessibility(j),this.selectAction.isEffectivelyEnabled()&&j.classList.add(q.makeCssClassName("ac-selectable"))),!this._processedText){this._treatAsPlainText=!0;var K=J.formatText(this.lang,G);if(this.useMarkdown&&K){Q.GlobalSettings.allowMarkForTextHighlighting&&(K=K.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/"));var X=ct.applyMarkdown(K);if(X.didProcess&&X.outputHtml){if(this._processedText=X.outputHtml,this._treatAsPlainText=!1,Q.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var ee="",te=this.getEffectiveStyleDefinition();te.highlightBackgroundColor&&(ee+="background-color: "+te.highlightBackgroundColor+";"),te.highlightForegroundColor&&(ee+="color: "+te.highlightForegroundColor+";"),ee&&(ee='style="'+ee+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+ee+">").replace(/\/==\//g,"</mark>")}}else this._processedText=K,this._treatAsPlainText=!0}else this._processedText=K,this._treatAsPlainText=!0}if(this._processedText||(this._processedText=""),this._treatAsPlainText)j.innerText=this._processedText;else{var ie=null!==(B=null===(O=TextBlock._ttMarkdownPolicy)||void 0===O?void 0:O.createHTML(this._processedText))&&void 0!==B?B:this._processedText;j.innerHTML=ie}if(j.firstElementChild instanceof HTMLElement){var re=j.firstElementChild;re.style.marginTop="0px",re.style.width="100%",this.wrap||(re.style.overflow="hidden",re.style.textOverflow="ellipsis")}j.lastElementChild instanceof HTMLElement&&(j.lastElementChild.style.marginBottom="0px");for(var ne=j.getElementsByTagName("a"),_loop_1=function(O){O.classList.add(q.makeCssClassName("ac-anchor")),O.target="_blank",O.onclick=function(B){raiseAnchorClickedEvent(U,O,B)&&(B.preventDefault(),B.cancelBubble=!0)},O.oncontextmenu=function(B){return!raiseAnchorClickedEvent(U,O,B)||(B.preventDefault(),B.cancelBubble=!0,!1)}},oe=0,ae=Array.from(ne);oe<ae.length;oe++){_loop_1(ae[oe])}return this.wrap?(j.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(j.style.overflow="hidden",Z.isInternetExplorer()||!Q.GlobalSettings.useWebkitLineClamp?j.style.maxHeight=this._computedLineHeight*this.maxLines+"px":(j.style.removeProperty("line-height"),j.style.display="-webkit-box",j.style.webkitBoxOrient="vertical",j.style.webkitLineClamp=this.maxLines.toString()))):(j.style.whiteSpace="nowrap",j.style.textOverflow="ellipsis"),(Q.GlobalSettings.useAdvancedTextBlockTruncation||Q.GlobalSettings.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=j.innerHTML),j}},TextBlock.prototype.truncateOverflow=function(O){return O>=this._computedLineHeight&&this.truncateIfSupported(O)},TextBlock.prototype.undoOverflowTruncation=function(){if(this.restoreOriginalContent(),Q.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines){var O=this._computedLineHeight*this.maxLines;this.truncateIfSupported(O)}},TextBlock.prototype.applyStylesTo=function(B){switch(O.prototype.applyStylesTo.call(this,B),this.getEffectiveHorizontalAlignment()){case K.HorizontalAlignment.Center:B.style.textAlign="center";break;case K.HorizontalAlignment.Right:B.style.textAlign="end";break;default:B.style.textAlign="start"}var U=this.hostConfig.lineHeights;if(U)switch(this.effectiveSize){case K.TextSize.Small:this._computedLineHeight=U.small;break;case K.TextSize.Medium:this._computedLineHeight=U.medium;break;case K.TextSize.Large:this._computedLineHeight=U.large;break;case K.TextSize.ExtraLarge:this._computedLineHeight=U.extraLarge;break;default:this._computedLineHeight=U.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.effectiveFontType));B.style.lineHeight=this._computedLineHeight+"px"},TextBlock.prototype.getJsonTypeName=function(){return"TextBlock"},TextBlock.prototype.getEffectiveTextStyleDefinition=function(){return this.style?this.hostConfig.textStyles.getStyleByName(this.style):O.prototype.getEffectiveTextStyleDefinition.call(this)},TextBlock.prototype.updateLayout=function(B){void 0===B&&(B=!1),O.prototype.updateLayout.call(this,B),Q.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))},TextBlock.wrapProperty=new te.BoolProperty(te.Versions.v1_0,"wrap",!1),TextBlock.maxLinesProperty=new te.NumProperty(te.Versions.v1_0,"maxLines"),TextBlock.styleProperty=new te.ValueSetProperty(te.Versions.v1_5,"style",[{value:"default"},{value:"columnHeader"},{value:"heading"}]),TextBlock._ttMarkdownPolicy="undefined"==typeof window||null===(B=window.trustedTypes)||void 0===B?void 0:B.createPolicy("adaptivecards#markdownPassthroughPolicy",{createHTML:function(O){return O}}),TextBlock._ttRoundtripPolicy="undefined"==typeof window||null===(U=window.trustedTypes)||void 0===U?void 0:U.createPolicy("adaptivecards#restoreContentsPolicy",{createHTML:function(O){return O}}),j([(0,te.property)(TextBlock.wrapProperty)],TextBlock.prototype,"wrap",void 0),j([(0,te.property)(TextBlock.maxLinesProperty)],TextBlock.prototype,"maxLines",void 0),j([(0,te.property)(TextBlock.styleProperty)],TextBlock.prototype,"style",void 0),TextBlock}(se);B.TextBlock=le;var ce=function(O){function TextRun(){var B=null!==O&&O.apply(this,arguments)||this;return B.italic=!1,B.strikethrough=!1,B.highlight=!1,B.underline=!1,B}return q(TextRun,O),TextRun.prototype.populateSchema=function(B){O.prototype.populateSchema.call(this,B),B.add(se.selectActionProperty)},TextRun.prototype.internalRender=function(){var O=this;if(this.text){var B=this.preProcessPropertyValue(se.textProperty),U=this.hostConfig,G=J.formatText(this.lang,B);G||(G="");var q=document.createElement("span");if(q.classList.add(U.makeCssClassName("ac-textRun")),this.applyStylesTo(q),this.selectAction&&U.supportsInteractivity){var j=document.createElement("a");j.classList.add(U.makeCssClassName("ac-anchor"));var W=this.selectAction.getHref();j.href=W||"",j.target="_blank",j.onclick=function(B){O.selectAction&&O.selectAction.isEffectivelyEnabled()&&(B.preventDefault(),B.cancelBubble=!0,O.selectAction.execute())},this.selectAction.setupElementForAccessibility(j),j.innerText=G,q.appendChild(j)}else q.innerText=G;return q}},TextRun.prototype.applyStylesTo=function(B){if(O.prototype.applyStylesTo.call(this,B),this.italic&&(B.style.fontStyle="italic"),this.strikethrough&&(B.style.textDecoration="line-through"),this.highlight){var U=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),G=Z.stringToCssColor(this.effectiveIsSubtle?U.highlightColors.subtle:U.highlightColors.default);G&&(B.style.backgroundColor=G)}this.underline&&(B.style.textDecoration="underline")},TextRun.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(TextRun.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(TextRun.prototype,"isInline",{get:function(){return!0},enumerable:!1,configurable:!0}),TextRun.italicProperty=new te.BoolProperty(te.Versions.v1_2,"italic",!1),TextRun.strikethroughProperty=new te.BoolProperty(te.Versions.v1_2,"strikethrough",!1),TextRun.highlightProperty=new te.BoolProperty(te.Versions.v1_2,"highlight",!1),TextRun.underlineProperty=new te.BoolProperty(te.Versions.v1_3,"underline",!1),j([(0,te.property)(TextRun.italicProperty)],TextRun.prototype,"italic",void 0),j([(0,te.property)(TextRun.strikethroughProperty)],TextRun.prototype,"strikethrough",void 0),j([(0,te.property)(TextRun.highlightProperty)],TextRun.prototype,"highlight",void 0),j([(0,te.property)(TextRun.underlineProperty)],TextRun.prototype,"underline",void 0),TextRun}(se);B.TextRun=ce;var de=function(O){function RichTextBlock(){var B=null!==O&&O.apply(this,arguments)||this;return B._inlines=[],B}return q(RichTextBlock,O),RichTextBlock.prototype.internalAddInline=function(O,B){if(void 0===B&&(B=!1),!O.isInline)throw new Error(re.Strings.errors.elementCannotBeUsedAsInline());if(!(void 0===O.parent||B)&&O.parent!==this)throw new Error(re.Strings.errors.inlineAlreadyParented());O.setParent(this),this._inlines.push(O)},RichTextBlock.prototype.internalParse=function(B,U){if(O.prototype.internalParse.call(this,B,U),this._inlines=[],Array.isArray(B.inlines))for(var G=0,q=B.inlines;G<q.length;G++){var j=q[G],W=void 0;if("string"==typeof j){var Y=new ce;Y.text=j,W=Y}else W=U.parseElement(this,j,[],!1);W&&this.internalAddInline(W,!0)}},RichTextBlock.prototype.internalToJSON=function(B,U){if(O.prototype.internalToJSON.call(this,B,U),this._inlines.length>0){for(var G=[],q=0,j=this._inlines;q<j.length;q++){var W=j[q];G.push(W.toJSON(U))}U.serializeValue(B,"inlines",G)}},RichTextBlock.prototype.internalRender=function(){if(this._inlines.length>0){var O=void 0;if(this.forElementId){var B=document.createElement("label");B.htmlFor=this.forElementId,O=B}else O=document.createElement("div");switch(O.className=this.hostConfig.makeCssClassName("ac-richTextBlock"),this.getEffectiveHorizontalAlignment()){case K.HorizontalAlignment.Center:O.style.textAlign="center";break;case K.HorizontalAlignment.Right:O.style.textAlign="end";break;default:O.style.textAlign="start"}for(var U=0,G=0,q=this._inlines;G<q.length;G++){var j=q[G].render();j&&(O.appendChild(j),U++)}if(U>0)return O}},RichTextBlock.prototype.asString=function(){for(var O="",B=0,U=this._inlines;B<U.length;B++){O+=U[B].asString()}return O},RichTextBlock.prototype.getJsonTypeName=function(){return"RichTextBlock"},RichTextBlock.prototype.getInlineCount=function(){return this._inlines.length},RichTextBlock.prototype.getInlineAt=function(O){if(O>=0&&O<this._inlines.length)return this._inlines[O];throw new Error(re.Strings.errors.indexOutOfRange(O))},RichTextBlock.prototype.addInline=function(O){"string"==typeof O?this.internalAddInline(new ce(O)):this.internalAddInline(O)},RichTextBlock.prototype.removeInline=function(O){var B=this._inlines.indexOf(O);return B>=0&&(this._inlines[B].setParent(void 0),this._inlines.splice(B,1),!0)},RichTextBlock}(oe);B.RichTextBlock=de;var pe=function(O){function Fact(B,U){var G=O.call(this)||this;return G.name=B,G.value=U,G}return q(Fact,O),Fact.prototype.getSchemaKey=function(){return"Fact"},Fact.titleProperty=new te.StringProperty(te.Versions.v1_0,"title"),Fact.valueProperty=new te.StringProperty(te.Versions.v1_0,"value"),j([(0,te.property)(Fact.titleProperty)],Fact.prototype,"name",void 0),j([(0,te.property)(Fact.valueProperty)],Fact.prototype,"value",void 0),Fact}(te.SerializableObject);B.Fact=pe;var ue=function(O){function FactSet(){return null!==O&&O.apply(this,arguments)||this}return q(FactSet,O),Object.defineProperty(FactSet.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),FactSet.prototype.internalRender=function(){var O=void 0,B=this.hostConfig;if(this.facts.length>0){(O=document.createElement("table")).style.borderWidth="0px",O.style.borderSpacing="0px",O.style.borderStyle="none",O.style.borderCollapse="collapse",O.style.display="block",O.style.overflow="hidden",O.classList.add(B.makeCssClassName("ac-factset")),O.setAttribute("role","presentation");for(var U=0;U<this.facts.length;U++){var G=document.createElement("tr");U>0&&(G.style.marginTop=B.factSet.spacing+"px");var q=document.createElement("td");q.style.padding="0",q.classList.add(B.makeCssClassName("ac-fact-title")),B.factSet.title.maxWidth&&(q.style.maxWidth=B.factSet.title.maxWidth+"px"),q.style.verticalAlign="top";var j=new le;j.setParent(this),j.text=!this.facts[U].name&&this.isDesignMode()?"Title":this.facts[U].name,j.size=B.factSet.title.size,j.color=B.factSet.title.color,j.isSubtle=B.factSet.title.isSubtle,j.weight=B.factSet.title.weight,j.wrap=B.factSet.title.wrap,j.spacing=K.Spacing.None,Z.appendChild(q,j.render()),Z.appendChild(G,q),(q=document.createElement("td")).style.width="10px",Z.appendChild(G,q),(q=document.createElement("td")).style.padding="0",q.style.verticalAlign="top",q.classList.add(B.makeCssClassName("ac-fact-value")),(j=new le).setParent(this),j.text=this.facts[U].value,j.size=B.factSet.value.size,j.color=B.factSet.value.color,j.isSubtle=B.factSet.value.isSubtle,j.weight=B.factSet.value.weight,j.wrap=B.factSet.value.wrap,j.spacing=K.Spacing.None,Z.appendChild(q,j.render()),Z.appendChild(G,q),Z.appendChild(O,G)}}return O},FactSet.prototype.getJsonTypeName=function(){return"FactSet"},FactSet.factsProperty=new te.SerializableObjectCollectionProperty(te.Versions.v1_0,"facts",pe),j([(0,te.property)(FactSet.factsProperty)],FactSet.prototype,"facts",void 0),FactSet}(oe);B.FactSet=ue;var he=function(O){function ImageDimensionProperty(B,U,G,q){var j=O.call(this,B,U)||this;return j.targetVersion=B,j.name=U,j.internalName=G,j.fallbackProperty=q,j}return q(ImageDimensionProperty,O),ImageDimensionProperty.prototype.getInternalName=function(){return this.internalName},ImageDimensionProperty.prototype.parse=function(O,B,U){var G=void 0,q=B[this.name];if(void 0===q)return this.defaultValue;var j=!1;if("string"==typeof q){try{var W=Q.SizeAndUnit.parse(q,!0);W.unit===K.SizeUnit.Pixel&&(G=W.physicalSize,j=!0)}catch(O){}!j&&this.fallbackProperty&&(j=this.fallbackProperty.isValidValue(q,U))}return j||U.logParseEvent(O,K.ValidationEvent.InvalidPropertyValue,re.Strings.errors.invalidPropertyValue(q,this.name)),G},ImageDimensionProperty.prototype.toJSON=function(O,B,U,G){G.serializeValue(B,this.name,"number"!=typeof U||isNaN(U)?void 0:U+"px")},ImageDimensionProperty}(te.PropertyDefinition),me=function(O){function Image(){var B=null!==O&&O.apply(this,arguments)||this;return B.size=K.Size.Auto,B.style=K.ImageStyle.Default,B}return q(Image,O),Image.prototype.populateSchema=function(B){O.prototype.populateSchema.call(this,B),B.remove(oe.heightProperty)},Image.prototype.applySize=function(O){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(O.style.width=this.pixelWidth+"px"),this.pixelHeight&&(O.style.height=this.pixelHeight+"px");else if(this.maxHeight){switch(this.size){case K.Size.Small:O.style.height=this.hostConfig.imageSizes.small+"px";break;case K.Size.Large:O.style.height=this.hostConfig.imageSizes.large+"px";break;default:O.style.height=this.hostConfig.imageSizes.medium+"px"}O.style.maxHeight=this.maxHeight+"px"}else{switch(this.size){case K.Size.Stretch:O.style.width="100%";break;case K.Size.Auto:O.style.maxWidth="100%";break;case K.Size.Small:O.style.width=this.hostConfig.imageSizes.small+"px";break;case K.Size.Large:O.style.width=this.hostConfig.imageSizes.large+"px";break;case K.Size.Medium:O.style.width=this.hostConfig.imageSizes.medium+"px"}O.style.maxHeight="100%"}},Object.defineProperty(Image.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),Image.prototype.internalRender=function(){var O=this,B=void 0;if(this.url){(B=document.createElement("div")).style.display="flex",B.style.alignItems="flex-start";var U=this.hostConfig;switch(this.getEffectiveHorizontalAlignment()){case K.HorizontalAlignment.Center:B.style.justifyContent="center";break;case K.HorizontalAlignment.Right:B.style.justifyContent="flex-end";break;default:B.style.justifyContent="flex-start"}var G=document.createElement("img");G.onload=function(B){raiseImageLoadedEvent(O)},G.onerror=function(B){if(O.renderedElement){var U=O.getRootElement();if(clearElement(O.renderedElement),U&&U.designMode){var G=document.createElement("div");G.style.display="flex",G.style.alignItems="center",G.style.justifyContent="center",G.style.backgroundColor="#EEEEEE",G.style.color="black",G.innerText=":-(",G.style.padding="10px",O.applySize(G),O.renderedElement.appendChild(G)}}raiseImageLoadedEvent(O)},G.style.minWidth="0",G.classList.add(U.makeCssClassName("ac-image")),this.selectAction&&U.supportsInteractivity&&(G.onkeypress=function(B){O.selectAction&&O.selectAction.isEffectivelyEnabled()&&("Enter"===B.code||"Space"===B.code)&&(B.preventDefault(),B.cancelBubble=!0,O.selectAction.execute())},G.onclick=function(B){O.selectAction&&O.selectAction.isEffectivelyEnabled()&&(B.preventDefault(),B.cancelBubble=!0,O.selectAction.execute())},this.selectAction.setupElementForAccessibility(G),this.selectAction.isEffectivelyEnabled()&&G.classList.add(U.makeCssClassName("ac-selectable"))),this.applySize(G),this.style===K.ImageStyle.Person&&(G.style.borderRadius="50%",G.style.backgroundPosition="50% 50%",G.style.backgroundRepeat="no-repeat");var q=Z.stringToCssColor(this.backgroundColor);q&&(G.style.backgroundColor=q),G.src=this.preProcessPropertyValue(Image.urlProperty);var j=this.preProcessPropertyValue(Image.altTextProperty);j&&(G.alt=j),B.appendChild(G)}return B},Image.prototype.getJsonTypeName=function(){return"Image"},Image.prototype.getAllActions=function(){var B=O.prototype.getAllActions.call(this);return this.selectAction&&B.push(this.selectAction),B},Image.prototype.getActionById=function(B){var U=O.prototype.getActionById.call(this,B);return!U&&this.selectAction&&(U=this.selectAction.getActionById(B)),U},Image.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]},Image.urlProperty=new te.StringProperty(te.Versions.v1_0,"url"),Image.altTextProperty=new te.StringProperty(te.Versions.v1_0,"altText"),Image.backgroundColorProperty=new te.StringProperty(te.Versions.v1_1,"backgroundColor"),Image.styleProperty=new te.EnumProperty(te.Versions.v1_0,"style",K.ImageStyle,K.ImageStyle.Default),Image.sizeProperty=new te.EnumProperty(te.Versions.v1_0,"size",K.Size,K.Size.Auto),Image.pixelWidthProperty=new he(te.Versions.v1_1,"width","pixelWidth"),Image.pixelHeightProperty=new he(te.Versions.v1_1,"height","pixelHeight",oe.heightProperty),Image.selectActionProperty=new ae(te.Versions.v1_1,"selectAction",["Action.ShowCard"]),j([(0,te.property)(Image.urlProperty)],Image.prototype,"url",void 0),j([(0,te.property)(Image.altTextProperty)],Image.prototype,"altText",void 0),j([(0,te.property)(Image.backgroundColorProperty)],Image.prototype,"backgroundColor",void 0),j([(0,te.property)(Image.sizeProperty)],Image.prototype,"size",void 0),j([(0,te.property)(Image.styleProperty)],Image.prototype,"style",void 0),j([(0,te.property)(Image.pixelWidthProperty)],Image.prototype,"pixelWidth",void 0),j([(0,te.property)(Image.pixelHeightProperty)],Image.prototype,"pixelHeight",void 0),j([(0,te.property)(Image.selectActionProperty)],Image.prototype,"selectAction",void 0),Image}(oe);B.Image=me;var ge=function(O){function CardElementContainer(){var B=null!==O&&O.apply(this,arguments)||this;return B.allowVerticalOverflow=!1,B}return q(CardElementContainer,O),CardElementContainer.prototype.populateSchema=function(B){O.prototype.populateSchema.call(this,B),this.isSelectable||B.remove(CardElementContainer.selectActionProperty)},CardElementContainer.prototype.isElementAllowed=function(O){return this.hostConfig.supportsInteractivity||!O.isInteractive},CardElementContainer.prototype.applyPadding=function(){if(O.prototype.applyPadding.call(this),this.renderedElement){var B=new Q.SpacingDefinition;this.getEffectivePadding()&&(B=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=B.top+"px",this.renderedElement.style.paddingRight=B.right+"px",this.renderedElement.style.paddingBottom=B.bottom+"px",this.renderedElement.style.paddingLeft=B.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}},Object.defineProperty(CardElementContainer.prototype,"isSelectable",{get:function(){return!1},enumerable:!1,configurable:!0}),CardElementContainer.prototype.forbiddenChildElements=function(){return[]},CardElementContainer.prototype.releaseDOMResources=function(){O.prototype.releaseDOMResources.call(this);for(var B=0;B<this.getItemCount();B++)this.getItemAt(B).releaseDOMResources()},CardElementContainer.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B);for(var U=0;U<this.getItemCount();U++){var G=this.getItemAt(U);!this.hostConfig.supportsInteractivity&&G.isInteractive&&B.addFailure(this,K.ValidationEvent.InteractivityNotAllowed,re.Strings.errors.interactivityNotAllowed()),this.isElementAllowed(G)||B.addFailure(this,K.ValidationEvent.InteractivityNotAllowed,re.Strings.errors.elementTypeNotAllowed(G.getJsonTypeName())),G.internalValidateProperties(B)}this._selectAction&&this._selectAction.internalValidateProperties(B)},CardElementContainer.prototype.render=function(){var B=this,U=O.prototype.render.call(this);if(U){var G=this.hostConfig;this.allowVerticalOverflow&&(U.style.overflowX="hidden",U.style.overflowY="auto"),U&&this.isSelectable&&this._selectAction&&G.supportsInteractivity&&(U.onclick=function(O){B._selectAction&&B._selectAction.isEffectivelyEnabled()&&(O.preventDefault(),O.cancelBubble=!0,B._selectAction.execute())},U.onkeypress=function(O){B._selectAction&&B._selectAction.isEffectivelyEnabled()&&("Enter"===O.code||"Space"===O.code)&&(O.preventDefault(),O.cancelBubble=!0,B._selectAction.execute())},this._selectAction.setupElementForAccessibility(U),this._selectAction.isEffectivelyEnabled()&&U.classList.add(G.makeCssClassName("ac-selectable")))}return U},CardElementContainer.prototype.updateLayout=function(B){if(void 0===B&&(B=!0),O.prototype.updateLayout.call(this,B),B)for(var U=0;U<this.getItemCount();U++)this.getItemAt(U).updateLayout()},CardElementContainer.prototype.getAllInputs=function(O){void 0===O&&(O=!0);for(var B=[],U=0;U<this.getItemCount();U++)B.push.apply(B,this.getItemAt(U).getAllInputs(O));return B},CardElementContainer.prototype.getAllActions=function(){for(var B=O.prototype.getAllActions.call(this),U=0;U<this.getItemCount();U++)B.push.apply(B,this.getItemAt(U).getAllActions());return this._selectAction&&B.push(this._selectAction),B},CardElementContainer.prototype.getResourceInformation=function(){for(var O=[],B=0;B<this.getItemCount();B++)O.push.apply(O,this.getItemAt(B).getResourceInformation());return O},CardElementContainer.prototype.getElementById=function(B){var U=O.prototype.getElementById.call(this,B);if(!U)for(var G=0;G<this.getItemCount()&&!(U=this.getItemAt(G).getElementById(B));G++);return U},CardElementContainer.prototype.findDOMNodeOwner=function(B){for(var U,G=void 0,q=0;q<this.getItemCount();q++)if(G=this.getItemAt(q).findDOMNodeOwner(B))return G;for(q=0;q<this.getActionCount();q++)if(G=null===(U=this.getActionAt(q))||void 0===U?void 0:U.findDOMNodeOwner(B))return G;return O.prototype.findDOMNodeOwner.call(this,B)},CardElementContainer.selectActionProperty=new ae(te.Versions.v1_1,"selectAction",["Action.ShowCard"]),j([(0,te.property)(CardElementContainer.selectActionProperty)],CardElementContainer.prototype,"_selectAction",void 0),CardElementContainer}(oe);B.CardElementContainer=ge;var fe=function(O){function ImageSet(){var B=null!==O&&O.apply(this,arguments)||this;return B._images=[],B.imageSize=K.ImageSize.Medium,B}return q(ImageSet,O),ImageSet.prototype.internalRender=function(){var O=void 0;if(this._images.length>0){(O=document.createElement("div")).style.display="flex",O.style.flexWrap="wrap";for(var B=0,U=this._images;B<U.length;B++){var G=U[B];switch(this.imageSize){case K.ImageSize.Small:G.size=K.Size.Small;break;case K.ImageSize.Large:G.size=K.Size.Large;break;default:G.size=K.Size.Medium}G.maxHeight=this.hostConfig.imageSet.maxImageHeight;var q=G.render();q&&(q.style.display="inline-flex",q.style.margin="0px",q.style.marginRight="10px",Z.appendChild(O,q))}}return O},ImageSet.prototype.getItemCount=function(){return this._images.length},ImageSet.prototype.getItemAt=function(O){return this._images[O]},ImageSet.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:void 0},ImageSet.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0},ImageSet.prototype.removeItem=function(O){if(O instanceof me){var B=this._images.indexOf(O);if(B>=0)return this._images.splice(B,1),O.setParent(void 0),this.updateLayout(),!0}return!1},ImageSet.prototype.getJsonTypeName=function(){return"ImageSet"},ImageSet.prototype.addImage=function(O){if(O.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(O),O.setParent(this)},ImageSet.prototype.indexOf=function(O){return O instanceof me?this._images.indexOf(O):-1},ImageSet.imagesProperty=new te.SerializableObjectCollectionProperty(te.Versions.v1_0,"images",me,(function(O,B){B.setParent(O)})),ImageSet.imageSizeProperty=new te.EnumProperty(te.Versions.v1_0,"imageSize",K.ImageSize,K.ImageSize.Medium),j([(0,te.property)(ImageSet.imagesProperty)],ImageSet.prototype,"_images",void 0),j([(0,te.property)(ImageSet.imageSizeProperty)],ImageSet.prototype,"imageSize",void 0),ImageSet}(ge);B.ImageSet=fe;var ye=function(O){function ContentSource(B,U){var G=O.call(this)||this;return G.url=B,G.mimeType=U,G}return q(ContentSource,O),ContentSource.prototype.isValid=function(){return!(!this.mimeType||!this.url)},ContentSource.mimeTypeProperty=new te.StringProperty(te.Versions.v1_1,"mimeType"),ContentSource.urlProperty=new te.StringProperty(te.Versions.v1_1,"url"),j([(0,te.property)(ContentSource.mimeTypeProperty)],ContentSource.prototype,"mimeType",void 0),j([(0,te.property)(ContentSource.urlProperty)],ContentSource.prototype,"url",void 0),ContentSource}(te.SerializableObject);B.ContentSource=ye;var _e=function(O){function CaptionSource(B,U,G){var q=O.call(this,B,U)||this;return q.label=G,q}return q(CaptionSource,O),CaptionSource.prototype.getSchemaKey=function(){return"CaptionSource"},CaptionSource.prototype.render=function(){var O=void 0;return this.isValid()&&((O=document.createElement("track")).src=this.url,O.kind="captions",O.label=this.label),O},CaptionSource.labelProperty=new te.StringProperty(te.Versions.v1_6,"label"),j([(0,te.property)(CaptionSource.labelProperty)],CaptionSource.prototype,"label",void 0),CaptionSource}(ye);B.CaptionSource=_e;var ve=function(O){function MediaSource(){return null!==O&&O.apply(this,arguments)||this}return q(MediaSource,O),MediaSource.prototype.getSchemaKey=function(){return"MediaSource"},MediaSource.prototype.render=function(){var O=void 0;return this.isValid()&&((O=document.createElement("source")).src=this.url,O.type=this.mimeType),O},MediaSource}(ye);B.MediaSource=ve;var be=function(){function MediaPlayer(){}return MediaPlayer.prototype.play=function(){},Object.defineProperty(MediaPlayer.prototype,"posterUrl",{get:function(){return this._posterUrl},set:function(O){this._posterUrl=O},enumerable:!1,configurable:!0}),Object.defineProperty(MediaPlayer.prototype,"selectedMediaType",{get:function(){},enumerable:!1,configurable:!0}),MediaPlayer}();B.MediaPlayer=be;var Se=function(O){function HTML5MediaPlayer(B){var U=O.call(this)||this;return U.owner=B,U._selectedSources=[],U._captionSources=[],U.processSources(),U}return q(HTML5MediaPlayer,O),HTML5MediaPlayer.prototype.processSources=function(){var O;this._selectedSources=[],this._captionSources=[],this._selectedMediaType=void 0;for(var B=0,U=this.owner.sources;B<U.length;B++){var G=U[B],q=G.mimeType?G.mimeType.split("/"):[];if(2===q.length){if(!this._selectedMediaType){var j=HTML5MediaPlayer.supportedMediaTypes.indexOf(q[0]);j>=0&&(this._selectedMediaType=HTML5MediaPlayer.supportedMediaTypes[j])}q[0]===this._selectedMediaType&&this._selectedSources.push(G)}}(O=this._captionSources).push.apply(O,this.owner.captionSources)},HTML5MediaPlayer.prototype.canPlay=function(){return this._selectedSources.length>0},HTML5MediaPlayer.prototype.fetchVideoDetails=function(){return W(this,void 0,void 0,(function(){return Y(this,(function(O){return[2]}))}))},HTML5MediaPlayer.prototype.render=function(){"video"===this._selectedMediaType?this._mediaElement=document.createElement("video"):this._mediaElement=document.createElement("audio"),this._mediaElement.setAttribute("aria-label",this.owner.altText?this.owner.altText:re.Strings.defaults.mediaPlayerAriaLabel()),this._mediaElement.setAttribute("webkit-playsinline",""),this._mediaElement.setAttribute("playsinline",""),this._mediaElement.setAttribute("crossorigin",""),this._mediaElement.autoplay=!0,this._mediaElement.controls=!0,Z.isMobileOS()&&(this._mediaElement.muted=!0),this._mediaElement.preload="none",this._mediaElement.style.width="100%";for(var O=0,B=this.owner.sources;O<B.length;O++){var U=B[O].render();Z.appendChild(this._mediaElement,U)}for(var G=0,q=this.owner.captionSources;G<q.length;G++){var j=q[G];if("vtt"==j.mimeType){var W=j.render();Z.appendChild(this._mediaElement,W)}}return this._mediaElement},HTML5MediaPlayer.prototype.play=function(){this._mediaElement&&this._mediaElement.play()},Object.defineProperty(HTML5MediaPlayer.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),HTML5MediaPlayer.supportedMediaTypes=["audio","video"],HTML5MediaPlayer}(be);B.HTML5MediaPlayer=Se;var Ce=function(O){function CustomMediaPlayer(B){return O.call(this)||this}return q(CustomMediaPlayer,O),CustomMediaPlayer}(be);B.CustomMediaPlayer=Ce;var Ee=function(O){function IFrameMediaMediaPlayer(B,U){var G=O.call(this,B)||this;return G.iFrameTitle=U,B.length>=2&&(G._videoId=B[1]),G}return q(IFrameMediaMediaPlayer,O),IFrameMediaMediaPlayer.prototype.canPlay=function(){return void 0!==this._videoId},IFrameMediaMediaPlayer.prototype.render=function(){var O=document.createElement("div");O.style.position="relative",O.style.width="100%",O.style.height="0",O.style.paddingBottom="56.25%";var B=document.createElement("iframe");return B.style.position="absolute",B.style.top="0",B.style.left="0",B.style.width="100%",B.style.height="100%",B.src=this.getEmbedVideoUrl(),B.frameBorder="0",this.iFrameTitle&&(B.title=this.iFrameTitle),B.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",B.allowFullscreen=!0,O.appendChild(B),O},Object.defineProperty(IFrameMediaMediaPlayer.prototype,"videoId",{get:function(){return this._videoId},enumerable:!1,configurable:!0}),IFrameMediaMediaPlayer}(Ce);B.IFrameMediaMediaPlayer=Ee;var xe=function(O){function VimeoPlayer(){return null!==O&&O.apply(this,arguments)||this}return q(VimeoPlayer,O),VimeoPlayer.prototype.fetchVideoDetails=function(){return W(this,void 0,void 0,(function(){var O,B,U;return Y(this,(function(G){switch(G.label){case 0:return O="https://vimeo.com/api/oembed.json?url=".concat(this.getEmbedVideoUrl()),[4,fetch(O)];case 1:return(B=G.sent()).ok?[4,B.json()]:[3,3];case 2:U=G.sent(),this.posterUrl=U.thumbnail_url,G.label=3;case 3:return[2]}}))}))},VimeoPlayer.prototype.getEmbedVideoUrl=function(){return"https://player.vimeo.com/video/".concat(this.videoId,"?autoplay=1")},VimeoPlayer}(Ee);B.VimeoPlayer=xe;var Te=function(O){function DailymotionPlayer(){return null!==O&&O.apply(this,arguments)||this}return q(DailymotionPlayer,O),DailymotionPlayer.prototype.fetchVideoDetails=function(){return W(this,void 0,void 0,(function(){var O,B,U;return Y(this,(function(G){switch(G.label){case 0:return O="https://api.dailymotion.com/video/".concat(this.videoId,"?fields=thumbnail_720_url"),[4,fetch(O)];case 1:return(B=G.sent()).ok?[4,B.json()]:[3,3];case 2:U=G.sent(),this.posterUrl=U.thumbnail_720_url,G.label=3;case 3:return[2]}}))}))},DailymotionPlayer.prototype.getEmbedVideoUrl=function(){return"https://www.dailymotion.com/embed/video/".concat(this.videoId,"?autoplay=1")},DailymotionPlayer}(Ee);B.DailymotionPlayer=Te;var we=function(O){function YouTubePlayer(B,U){var G=O.call(this,B,U)||this;return G.iFrameTitle=U,B.length>=3&&void 0!==B[2]&&(G._startTimeIndex=parseInt(B[2])),G}return q(YouTubePlayer,O),YouTubePlayer.prototype.fetchVideoDetails=function(){return W(this,void 0,void 0,(function(){return Y(this,(function(O){return this.posterUrl=this.videoId?"https://img.youtube.com/vi/".concat(this.videoId,"/maxresdefault.jpg"):void 0,[2]}))}))},YouTubePlayer.prototype.getEmbedVideoUrl=function(){var O="https://www.youtube.com/embed/".concat(this.videoId,"?autoplay=1");return void 0!==this._startTimeIndex&&(O+="&start=".concat(this._startTimeIndex)),O},YouTubePlayer}(Ee);B.YouTubePlayer=we;var ke=function(O){function Media(){var B=null!==O&&O.apply(this,arguments)||this;return B.sources=[],B.captionSources=[],B}return q(Media,O),Media.prototype.createMediaPlayer=function(){for(var O=0,B=Media.customMediaPlayers;O<B.length;O++)for(var U=B[O],G=0,q=this.sources;G<q.length;G++){var j=q[G];if(j.url)for(var W=0,Y=U.urlPatterns;W<Y.length;W++){var K=Y[W].exec(j.url);if(null!==K)return U.createMediaPlayer(K)}}return new Se(this)},Media.prototype.handlePlayButtonInvoke=function(O){if(this.hostConfig.media.allowInlinePlayback){if(O.preventDefault(),O.cancelBubble=!0,this.renderedElement){var B=this._mediaPlayer.render();clearElement(this.renderedElement),this.renderedElement.appendChild(B),this._mediaPlayer.play(),B.focus()}}else Media.onPlay&&(O.preventDefault(),O.cancelBubble=!0,Media.onPlay(this))},Media.prototype.displayPoster=function(){return W(this,void 0,void 0,(function(){var O,B,U,G,q,j,W=this;return Y(this,(function(Y){return this.renderedElement&&(12,15,(O=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-poster"),O.setAttribute("role","contentinfo"),O.setAttribute("aria-label",this.altText?this.altText:re.Strings.defaults.mediaPlayerAriaLabel()),O.style.position="relative",O.style.display="flex",(B=this.poster?this.poster:this._mediaPlayer.posterUrl)||(B=this.hostConfig.media.defaultPoster),B?((U=document.createElement("img")).style.width="100%",U.style.height="100%",U.setAttribute("role","presentation"),U.onerror=function(B){U.parentNode&&U.parentNode.removeChild(U),O.classList.add("empty"),O.style.minHeight="150px"},U.src=B,O.appendChild(U)):(O.classList.add("empty"),O.style.minHeight="150px"),this.hostConfig.supportsInteractivity&&this._mediaPlayer.canPlay()&&((G=document.createElement("div")).tabIndex=0,G.setAttribute("role","button"),G.setAttribute("aria-label",re.Strings.defaults.mediaPlayerPlayMedia()),G.className=this.hostConfig.makeCssClassName("ac-media-playButton"),G.style.display="flex",G.style.alignItems="center",G.style.justifyContent="center",G.onclick=function(O){W.handlePlayButtonInvoke(O)},G.onkeypress=function(O){"Enter"!==O.code&&"Space"!==O.code||W.handlePlayButtonInvoke(O)},(q=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),q.style.width="12px",q.style.height="15px",q.style.borderTopWidth="7.5px",q.style.borderBottomWidth="7.5px",q.style.borderLeftWidth="12px",q.style.borderRightWidth="0",q.style.borderStyle="solid",q.style.borderTopColor="transparent",q.style.borderRightColor="transparent",q.style.borderBottomColor="transparent",q.style.transform="translate(1.2px,0px)",G.appendChild(q),(j=document.createElement("div")).style.position="absolute",j.style.left="0",j.style.top="0",j.style.width="100%",j.style.height="100%",j.style.display="flex",j.style.justifyContent="center",j.style.alignItems="center",j.appendChild(G),O.appendChild(j)),clearElement(this.renderedElement),this.renderedElement.appendChild(O)),[2]}))}))},Media.prototype.internalRender=function(){var O=document.createElement("div");return O.className=this.hostConfig.makeCssClassName("ac-media"),O},Media.prototype.render=function(){var B=this,U=O.prototype.render.call(this);return U&&(this._mediaPlayer=this.createMediaPlayer(),this._mediaPlayer.fetchVideoDetails().then((function(){return B.displayPoster()}))),U},Media.prototype.releaseDOMResources=function(){O.prototype.releaseDOMResources.call(this),this.displayPoster()},Media.prototype.getJsonTypeName=function(){return"Media"},Media.prototype.getResourceInformation=function(){var O=[];if(this._mediaPlayer){var B=this.poster?this.poster:this.hostConfig.media.defaultPoster;B&&O.push({url:B,mimeType:"image"})}for(var U=0,G=this.sources;U<G.length;U++){var q=G[U];q.isValid()&&O.push({url:q.url,mimeType:q.mimeType})}for(var j=0,W=this.captionSources;j<W.length;j++){var Y=W[j];Y.isValid()&&O.push({url:Y.url,mimeType:Y.mimeType})}return O},Object.defineProperty(Media.prototype,"selectedMediaType",{get:function(){return this._mediaPlayer.selectedMediaType},enumerable:!1,configurable:!0}),Media.customMediaPlayers=[{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?youtube.com\/watch\?(?=.*v=([\w\d-_]+))(?=(?:.*t=(\d+))?).*/gi,/^(?:https?:\/\/)?youtu.be\/([\w\d-_]+)(?:\?t=(\d+))?/gi],createMediaPlayer:function(O){return new we(O,re.Strings.defaults.youTubeVideoPlayer())}},{urlPatterns:[/^(?:https?:\/\/)?vimeo.com\/([\w\d-_]+).*/gi],createMediaPlayer:function(O){return new xe(O,re.Strings.defaults.vimeoVideoPlayer())}},{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?dailymotion.com\/video\/([\w\d-_]+).*/gi],createMediaPlayer:function(O){return new Te(O,re.Strings.defaults.dailymotionVideoPlayer())}}],Media.sourcesProperty=new te.SerializableObjectCollectionProperty(te.Versions.v1_1,"sources",ve),Media.captionSourcesProperty=new te.SerializableObjectCollectionProperty(te.Versions.v1_6,"captionSources",_e),Media.posterProperty=new te.StringProperty(te.Versions.v1_1,"poster"),Media.altTextProperty=new te.StringProperty(te.Versions.v1_1,"altText"),j([(0,te.property)(Media.sourcesProperty)],Media.prototype,"sources",void 0),j([(0,te.property)(Media.captionSourcesProperty)],Media.prototype,"captionSources",void 0),j([(0,te.property)(Media.posterProperty)],Media.prototype,"poster",void 0),j([(0,te.property)(Media.altTextProperty)],Media.prototype,"altText",void 0),Media}(oe);B.Media=ke;var Ae=function(O){function Input(){return null!==O&&O.apply(this,arguments)||this}return q(Input,O),Input.prototype.getAllLabelIds=function(){var O=[];return this.labelledBy&&O.push(this.labelledBy),this._renderedLabelElement&&O.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&O.push(this._renderedErrorMessageElement.id),O},Input.prototype.updateInputControlAriaLabelledBy=function(){if(this._renderedInputControlElement){var O=this.getAllLabelIds();O.length>0?this._renderedInputControlElement.setAttribute("aria-labelledby",O.join(" ")):this._renderedInputControlElement.removeAttribute("aria-labelledby")}},Object.defineProperty(Input.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(Input.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!1,configurable:!0}),Object.defineProperty(Input.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!1,configurable:!0}),Input.prototype.overrideInternalRender=function(){var O=this.hostConfig;this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column";var B=Z.generateUniqueId();if(this.label){var U=new de;U.setParent(this),U.forElementId=B;var G=new ce(this.label);if(U.addInline(G),this.isRequired){G.init(O.inputs.label.requiredInputs);var q=new ce(O.inputs.label.requiredInputs.suffix);q.color=O.inputs.label.requiredInputs.suffixColor,q.ariaHidden=!0,U.addInline(q)}else G.init(O.inputs.label.optionalInputs);this._renderedLabelElement=U.render(),this._renderedLabelElement&&(this._renderedLabelElement.id=Z.generateUniqueId(),this._renderedLabelElement.style.marginBottom=O.getEffectiveSpacing(O.inputs.label.inputSpacing)+"px",this._outerContainerElement.appendChild(this._renderedLabelElement))}if(this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=O.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex","stretch"===this.height&&(this._inputControlContainerElement.style.alignItems="stretch",this._inputControlContainerElement.style.flex="1 1 auto"),this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement)return this._renderedInputControlElement.id=B,this._renderedInputControlElement.style.minWidth="0px",this.isNullable&&this.isRequired&&(this._renderedInputControlElement.setAttribute("aria-required","true"),this._renderedInputControlElement.classList.add(O.makeCssClassName("ac-input-required"))),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this.updateInputControlAriaLabelledBy(),this._outerContainerElement;this.resetDirtyState()},Input.prototype.valueChanged=function(){var O,B,U;this.getRootElement().updateActionsEnabledState(),this.isValid()&&this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),B=(O=this).getRootElement(),(U=B&&B.onInputValueChanged?B.onInputValueChanged:ct.onInputValueChanged)&&U(O)},Input.prototype.resetValidationFailureCue=function(){this.renderedInputControlElement&&(this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.updateInputControlAriaLabelledBy(),this._renderedErrorMessageElement&&(this._outerContainerElement.removeChild(this._renderedErrorMessageElement),this._renderedErrorMessageElement=void 0))},Input.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&this.errorMessage&&Q.GlobalSettings.displayInputValidationErrors){var O=new le;O.setParent(this),O.text=this.errorMessage,O.wrap=!0,O.init(this.hostConfig.inputs.errorMessage),this._renderedErrorMessageElement=O.render(),this._renderedErrorMessageElement&&(this._renderedErrorMessageElement.id=Z.generateUniqueId(),this._outerContainerElement.appendChild(this._renderedErrorMessageElement),this.updateInputControlAriaLabelledBy())}},Input.prototype.focus=function(){this._renderedInputControlElement&&this._renderedInputControlElement.focus()},Input.prototype.isValid=function(){return!0},Input.prototype.isDirty=function(){return this.value!==this._oldValue},Input.prototype.resetDirtyState=function(){this._oldValue=this.value},Input.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B),this.id||B.addFailure(this,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||B.addFailure(this,K.ValidationEvent.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||B.addFailure(this,K.ValidationEvent.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))},Input.prototype.validateValue=function(){this.resetValidationFailureCue();var O=this.isRequired?this.isSet()&&this.isValid():this.isValid();return!O&&this.renderedInputControlElement&&(this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),O},Input.prototype.getAllInputs=function(O){return void 0===O&&(O=!0),[this]},Input.prototype.render=function(){var B=O.prototype.render.call(this);return this.resetDirtyState(),B},Object.defineProperty(Input.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),Input.labelProperty=new te.StringProperty(te.Versions.v1_3,"label",!0),Input.isRequiredProperty=new te.BoolProperty(te.Versions.v1_3,"isRequired",!1),Input.errorMessageProperty=new te.StringProperty(te.Versions.v1_3,"errorMessage",!0),j([(0,te.property)(Input.labelProperty)],Input.prototype,"label",void 0),j([(0,te.property)(Input.isRequiredProperty)],Input.prototype,"isRequired",void 0),j([(0,te.property)(Input.errorMessageProperty)],Input.prototype,"errorMessage",void 0),Input}(oe);B.Input=Ae;var Re=function(O){function TextInput(){var B=null!==O&&O.apply(this,arguments)||this;return B.isMultiline=!1,B.style=K.InputTextStyle.Text,B}return q(TextInput,O),TextInput.prototype.setupInput=function(O){var B=this;O.style.flex="1 1 auto",O.tabIndex=this.isDesignMode()?-1:0,this.placeholder&&(O.placeholder=this.placeholder,O.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(O.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(O.maxLength=this.maxLength),O.oninput=function(){B.valueChanged()},O.onkeypress=function(O){O.ctrlKey&&"Enter"===O.code&&B.inlineAction&&B.inlineAction.isEffectivelyEnabled()&&B.inlineAction.execute()}},TextInput.prototype.internalRender=function(){var O;return this.isMultiline&&this.style!==K.InputTextStyle.Password?((O=document.createElement("textarea")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),"stretch"===this.height&&(O.style.height="initial")):((O=document.createElement("input")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),O.type=K.InputTextStyle[this.style].toLowerCase()),this.setupInput(O),O},TextInput.prototype.overrideInternalRender=function(){var B=this,U=O.prototype.overrideInternalRender.call(this);if(this.inlineAction){var G=document.createElement("button");if(G.className=this.hostConfig.makeCssClassName(this.inlineAction.isEffectivelyEnabled()?"ac-inlineActionButton":"ac-inlineActionButton-disabled"),G.onclick=function(O){B.inlineAction&&B.inlineAction.isEffectivelyEnabled()&&(O.preventDefault(),O.cancelBubble=!0,B.inlineAction.execute())},this.inlineAction.iconUrl){G.classList.add("iconOnly");var q=document.createElement("img");q.style.height="100%",q.setAttribute("role","presentation"),q.style.display="none",q.onload=function(){q.style.removeProperty("display")},q.onerror=function(){G.removeChild(q),G.classList.remove("iconOnly"),G.classList.add("textOnly"),G.textContent=B.inlineAction&&B.inlineAction.title?B.inlineAction.title:re.Strings.defaults.inlineActionTitle()},q.src=this.inlineAction.iconUrl,G.appendChild(q),G.title=this.inlineAction.title?this.inlineAction.title:re.Strings.defaults.inlineActionTitle()}else G.classList.add("textOnly"),G.textContent=this.inlineAction.title?this.inlineAction.title:re.Strings.defaults.inlineActionTitle();this.inlineAction.setupElementForAccessibility(G,!0),G.style.marginLeft="8px",this.inputControlContainerElement.appendChild(G)}return U},TextInput.prototype.getJsonTypeName=function(){return"Input.Text"},TextInput.prototype.getAllActions=function(){var B=O.prototype.getAllActions.call(this);return this.inlineAction&&B.push(this.inlineAction),B},TextInput.prototype.getActionById=function(B){var U=O.prototype.getActionById.call(this,B);return!U&&this.inlineAction&&(U=this.inlineAction.getActionById(B)),U},TextInput.prototype.isSet=function(){return!!this.value},TextInput.prototype.isValid=function(){return!this.value||(!this.regex||new RegExp(this.regex,"g").test(this.value))},Object.defineProperty(TextInput.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):void 0},enumerable:!1,configurable:!0}),TextInput.valueProperty=new te.StringProperty(te.Versions.v1_0,"value"),TextInput.maxLengthProperty=new te.NumProperty(te.Versions.v1_0,"maxLength"),TextInput.isMultilineProperty=new te.BoolProperty(te.Versions.v1_0,"isMultiline",!1),TextInput.placeholderProperty=new te.StringProperty(te.Versions.v1_0,"placeholder"),TextInput.styleProperty=new te.EnumProperty(te.Versions.v1_0,"style",K.InputTextStyle,K.InputTextStyle.Text,[{value:K.InputTextStyle.Text},{value:K.InputTextStyle.Tel},{value:K.InputTextStyle.Url},{value:K.InputTextStyle.Email},{value:K.InputTextStyle.Password,targetVersion:te.Versions.v1_5}]),TextInput.inlineActionProperty=new ae(te.Versions.v1_0,"inlineAction",["Action.ShowCard"]),TextInput.regexProperty=new te.StringProperty(te.Versions.v1_3,"regex",!0),j([(0,te.property)(TextInput.valueProperty)],TextInput.prototype,"defaultValue",void 0),j([(0,te.property)(TextInput.maxLengthProperty)],TextInput.prototype,"maxLength",void 0),j([(0,te.property)(TextInput.isMultilineProperty)],TextInput.prototype,"isMultiline",void 0),j([(0,te.property)(TextInput.placeholderProperty)],TextInput.prototype,"placeholder",void 0),j([(0,te.property)(TextInput.styleProperty)],TextInput.prototype,"style",void 0),j([(0,te.property)(TextInput.inlineActionProperty)],TextInput.prototype,"inlineAction",void 0),j([(0,te.property)(TextInput.regexProperty)],TextInput.prototype,"regex",void 0),TextInput}(Ae);B.TextInput=Re;var Ie=function(O){function ToggleInput(){var B=null!==O&&O.apply(this,arguments)||this;return B.valueOn="true",B.valueOff="false",B.wrap=!1,B}return q(ToggleInput,O),ToggleInput.prototype.updateInputControlAriaLabelledBy=function(){if(this._checkboxInputElement){var O=this.getAllLabelIds().join(" ");this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id&&(O+=" "+this._checkboxInputLabelElement.id),O?this._checkboxInputElement.setAttribute("aria-labelledby",O):this._checkboxInputElement.removeAttribute("aria-labelledby")}},ToggleInput.prototype.internalRender=function(){var O=this,B=document.createElement("div");if(B.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),B.style.width="100%",B.style.display="flex",B.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=Z.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this.title&&this._checkboxInputElement.setAttribute("aria-label",this.title),this.isRequired&&this._checkboxInputElement.setAttribute("aria-required","true"),this._checkboxInputElement.tabIndex=this.isDesignMode()?-1:0,this.defaultValue===this.valueOn&&(this._checkboxInputElement.checked=!0),this._oldCheckboxValue=this._checkboxInputElement.checked,this._checkboxInputElement.onchange=function(){O.valueChanged()},Z.appendChild(B,this._checkboxInputElement),this.title||this.isDesignMode()){var U=new le;if(U.setParent(this),U.forElementId=this._checkboxInputElement.id,U.hostConfig=this.hostConfig,U.text=this.title?this.title:this.getJsonTypeName(),U.useMarkdown=Q.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,U.wrap=this.wrap,this._checkboxInputLabelElement=U.render(),this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=Z.generateUniqueId(),this._checkboxInputLabelElement.style.display="inline-block",this._checkboxInputLabelElement.style.flex="1 1 auto",this._checkboxInputLabelElement.style.marginLeft="6px",this._checkboxInputLabelElement.style.verticalAlign="middle";var G=document.createElement("div");G.style.width="6px",Z.appendChild(B,G),Z.appendChild(B,this._checkboxInputLabelElement)}}return B},Object.defineProperty(ToggleInput.prototype,"isNullable",{get:function(){return!1},enumerable:!1,configurable:!0}),ToggleInput.prototype.getJsonTypeName=function(){return"Input.Toggle"},ToggleInput.prototype.focus=function(){this._checkboxInputElement&&this._checkboxInputElement.focus()},ToggleInput.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},ToggleInput.prototype.isDirty=function(){return!!this._checkboxInputElement&&this._checkboxInputElement.checked!==this._oldCheckboxValue},Object.defineProperty(ToggleInput.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:void 0},enumerable:!1,configurable:!0}),ToggleInput.valueProperty=new te.StringProperty(te.Versions.v1_0,"value"),ToggleInput.titleProperty=new te.StringProperty(te.Versions.v1_0,"title"),ToggleInput.valueOnProperty=new te.StringProperty(te.Versions.v1_0,"valueOn",!0,void 0,"true",(function(O){return"true"})),ToggleInput.valueOffProperty=new te.StringProperty(te.Versions.v1_0,"valueOff",!0,void 0,"false",(function(O){return"false"})),ToggleInput.wrapProperty=new te.BoolProperty(te.Versions.v1_2,"wrap",!1),j([(0,te.property)(ToggleInput.valueProperty)],ToggleInput.prototype,"defaultValue",void 0),j([(0,te.property)(ToggleInput.titleProperty)],ToggleInput.prototype,"title",void 0),j([(0,te.property)(ToggleInput.valueOnProperty)],ToggleInput.prototype,"valueOn",void 0),j([(0,te.property)(ToggleInput.valueOffProperty)],ToggleInput.prototype,"valueOff",void 0),j([(0,te.property)(ToggleInput.wrapProperty)],ToggleInput.prototype,"wrap",void 0),ToggleInput}(Ae);B.ToggleInput=Ie;var Pe=function(O){function Choice(B,U){var G=O.call(this)||this;return G.title=B,G.value=U,G}return q(Choice,O),Choice.prototype.getSchemaKey=function(){return"Choice"},Choice.titleProperty=new te.StringProperty(te.Versions.v1_0,"title"),Choice.valueProperty=new te.StringProperty(te.Versions.v1_0,"value"),j([(0,te.property)(Choice.titleProperty)],Choice.prototype,"title",void 0),j([(0,te.property)(Choice.valueProperty)],Choice.prototype,"value",void 0),Choice}(te.SerializableObject);B.Choice=Pe;var Ne=function(O){function ChoiceSetInput(){var B=null!==O&&O.apply(this,arguments)||this;return B.isMultiSelect=!1,B.wrap=!1,B.choices=[],B}return q(ChoiceSetInput,O),Object.defineProperty(ChoiceSetInput.prototype,"isCompact",{get:function(){return!this.style||"compact"===this.style},set:function(O){this.style=O?void 0:"expanded"},enumerable:!1,configurable:!0}),ChoiceSetInput.getUniqueCategoryName=function(){var O="__ac-category"+ChoiceSetInput._uniqueCategoryCounter;return ChoiceSetInput._uniqueCategoryCounter++,O},ChoiceSetInput.prototype.internalApplyAriaCurrent=function(){if(this._selectElement){var O=this._selectElement.options;if(O)for(var B=0,U=Array.from(O);B<U.length;B++){var G=U[B];G.selected?G.setAttribute("aria-current","true"):G.removeAttribute("aria-current")}}},ChoiceSetInput.prototype.renderCompoundInput=function(O,B,U){var G=this,q=document.createElement("div");q.className=this.hostConfig.makeCssClassName("ac-input",O),q.style.width="100%",q.tabIndex=this.isDesignMode()?-1:0,this._toggleInputs=[],this._labels=[];for(var j=0,W=this.choices;j<W.length;j++){var Y=W[j],K=document.createElement("input");K.id=Z.generateUniqueId(),K.type=B,K.style.margin="0",K.style.display="inline-block",K.style.verticalAlign="middle",K.style.flex="0 0 auto",K.name=this.id?this.id:this._uniqueCategoryName,this.isRequired&&K.setAttribute("aria-required","true"),K.tabIndex=this.isDesignMode()?-1:0,Y.value&&(K.value=Y.value),Y.title&&K.setAttribute("aria-label",Y.title),U&&Y.value&&U.indexOf(Y.value)>=0&&(K.checked=!0),K.onchange=function(){G.valueChanged()},this._toggleInputs.push(K);var X=document.createElement("div");X.style.display="flex",X.style.alignItems="center",Z.appendChild(X,K);var J=new le;J.setParent(this),J.forElementId=K.id,J.hostConfig=this.hostConfig,J.text=Y.title?Y.title:"Choice "+this._toggleInputs.length,J.useMarkdown=Q.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,J.wrap=this.wrap;var ee=J.render();if(this._labels.push(ee),ee){ee.id=Z.generateUniqueId(),ee.style.display="inline-block",ee.style.flex="1 1 auto",ee.style.marginLeft="6px",ee.style.verticalAlign="middle";var te=document.createElement("div");te.style.width="6px",Z.appendChild(X,te),Z.appendChild(X,ee)}Z.appendChild(q,X)}return q},ChoiceSetInput.prototype.updateInputControlAriaLabelledBy=function(){if((this.isMultiSelect||"expanded"===this.style)&&this._toggleInputs&&this._labels)for(var B=this.getAllLabelIds(),U=0;U<this._toggleInputs.length;U++){var G=B.join(" "),q=this._labels[U];q&&q.id&&(G+=" "+q.id),G?this._toggleInputs[U].setAttribute("aria-labelledby",G):this._toggleInputs[U].removeAttribute("aria-labelledby")}else O.prototype.updateInputControlAriaLabelledBy.call(this)},ChoiceSetInput.prototype.internalRender=function(){var O=this;if(this._uniqueCategoryName=ChoiceSetInput.getUniqueCategoryName(),this.isMultiSelect)return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):void 0);if("expanded"===this.style)return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:void 0);if("filtered"===this.style){var B=document.createElement("div");B.style.width="100%",this._textInput=document.createElement("input"),this._textInput.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-filtered"),this._textInput.type="text",this._textInput.style.width="100%",this._textInput.oninput=function(){O.valueChanged(),O._textInput&&(O.value?(O._textInput.removeAttribute("placeholder"),O._textInput.removeAttribute("aria-label")):O.placeholder&&(O._textInput.placeholder=O.placeholder,O._textInput.setAttribute("aria-label",O.placeholder)))},this.defaultValue&&(this._textInput.value=this.defaultValue),this.placeholder&&!this._textInput.value&&(this._textInput.placeholder=this.placeholder,this._textInput.setAttribute("aria-label",this.placeholder)),this._textInput.tabIndex=this.isDesignMode()?-1:0;var U=document.createElement("datalist");U.id=Z.generateUniqueId();for(var G=0,q=this.choices;G<q.length;G++){var j=q[G],W=document.createElement("option");j.title&&(W.value=j.title,W.setAttribute("aria-label",j.title)),W.tabIndex=this.isDesignMode()?-1:0,U.appendChild(W)}return this._textInput.setAttribute("list",U.id),B.append(this._textInput,U),B}this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%",this._selectElement.tabIndex=this.isDesignMode()?-1:0;var Y=document.createElement("option");Y.selected=!0,Y.disabled=!0,Y.hidden=!0,Y.value="",this.placeholder&&(Y.text=this.placeholder),Z.appendChild(this._selectElement,Y);for(var K=0,Q=this.choices;K<Q.length;K++){j=Q[K];(W=document.createElement("option")).value=j.value,j.title&&(W.text=j.title,W.setAttribute("aria-label",j.title)),W.tabIndex=this.isDesignMode()?-1:0,j.value===this.defaultValue&&(W.selected=!0),Z.appendChild(this._selectElement,W)}return this._selectElement.onchange=function(){O.internalApplyAriaCurrent(),O.valueChanged()},this.internalApplyAriaCurrent(),this._selectElement},ChoiceSetInput.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},ChoiceSetInput.prototype.focus=function(){this._toggleInputs&&(this.isMultiSelect||"expanded"===this.style)?this._toggleInputs.length>0&&this._toggleInputs[0].focus():this._textInput?this._textInput.focus():O.prototype.focus.call(this)},ChoiceSetInput.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B),0===this.choices.length&&B.addFailure(this,K.ValidationEvent.CollectionCantBeEmpty,re.Strings.errors.choiceSetMustHaveAtLeastOneChoice());for(var U=0,G=this.choices;U<G.length;U++){var q=G[U];q.title&&q.value||B.addFailure(this,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.choiceSetChoicesMustHaveTitleAndValue())}},ChoiceSetInput.prototype.isSet=function(){return!!this.value},ChoiceSetInput.prototype.isValid=function(){if(this._textInput){if(""===this.value||this.value===this.placeholder)return!0;for(var B=0,U=this.choices;B<U.length;B++){var G=U[B];if(this.value===G.value)return!0}return!1}return O.prototype.isValid.call(this)},Object.defineProperty(ChoiceSetInput.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0===this._toggleInputs.length)return;for(var O="",B=0,U=this._toggleInputs;B<U.length;B++){(K=U[B]).checked&&(""!==O&&(O+=this.hostConfig.choiceSetInputValueSeparator),O+=K.value)}return O||void 0}if(this._selectElement)return this._selectElement.selectedIndex>0?this._selectElement.value:void 0;if(this._textInput){for(var G=0,q=this.choices;G<q.length;G++){var j=q[G];if(j.title&&this._textInput.value===j.title)return j.value}return this._textInput.value}if(this._toggleInputs&&this._toggleInputs.length>0)for(var W=0,Y=this._toggleInputs;W<Y.length;W++){var K;if((K=Y[W]).checked)return K.value}},enumerable:!1,configurable:!0}),ChoiceSetInput.valueProperty=new te.StringProperty(te.Versions.v1_0,"value"),ChoiceSetInput.choicesProperty=new te.SerializableObjectCollectionProperty(te.Versions.v1_0,"choices",Pe),ChoiceSetInput.styleProperty=new te.ValueSetProperty(te.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"},{value:"filtered",targetVersion:te.Versions.v1_5}],"compact"),ChoiceSetInput.isMultiSelectProperty=new te.BoolProperty(te.Versions.v1_0,"isMultiSelect",!1),ChoiceSetInput.placeholderProperty=new te.StringProperty(te.Versions.v1_0,"placeholder"),ChoiceSetInput.wrapProperty=new te.BoolProperty(te.Versions.v1_2,"wrap",!1),ChoiceSetInput._uniqueCategoryCounter=0,j([(0,te.property)(ChoiceSetInput.valueProperty)],ChoiceSetInput.prototype,"defaultValue",void 0),j([(0,te.property)(ChoiceSetInput.styleProperty)],ChoiceSetInput.prototype,"style",void 0),j([(0,te.property)(ChoiceSetInput.isMultiSelectProperty)],ChoiceSetInput.prototype,"isMultiSelect",void 0),j([(0,te.property)(ChoiceSetInput.placeholderProperty)],ChoiceSetInput.prototype,"placeholder",void 0),j([(0,te.property)(ChoiceSetInput.wrapProperty)],ChoiceSetInput.prototype,"wrap",void 0),j([(0,te.property)(ChoiceSetInput.choicesProperty)],ChoiceSetInput.prototype,"choices",void 0),ChoiceSetInput}(Ae);B.ChoiceSetInput=Ne;var Oe=function(O){function NumberInput(){return null!==O&&O.apply(this,arguments)||this}return q(NumberInput,O),NumberInput.prototype.internalRender=function(){var O=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),void 0!==this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),void 0!==this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=this.isDesignMode()?-1:0,void 0!==this.defaultValue&&(this._numberInputElement.valueAsNumber=this.defaultValue),this.placeholder&&(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){O.valueChanged()},this._numberInputElement},NumberInput.prototype.getJsonTypeName=function(){return"Input.Number"},NumberInput.prototype.isSet=function(){return void 0!==this.value&&!isNaN(this.value)},NumberInput.prototype.isValid=function(){if(void 0===this.value)return!this.isRequired;var O=!0;return void 0!==this.min&&(O=O&&this.value>=this.min),void 0!==this.max&&(O=O&&this.value<=this.max),O},Object.defineProperty(NumberInput.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0},set:function(O){O&&this._numberInputElement&&(this._numberInputElement.value=O.toString())},enumerable:!1,configurable:!0}),NumberInput.valueProperty=new te.NumProperty(te.Versions.v1_0,"value"),NumberInput.placeholderProperty=new te.StringProperty(te.Versions.v1_0,"placeholder"),NumberInput.minProperty=new te.NumProperty(te.Versions.v1_0,"min"),NumberInput.maxProperty=new te.NumProperty(te.Versions.v1_0,"max"),j([(0,te.property)(NumberInput.valueProperty)],NumberInput.prototype,"defaultValue",void 0),j([(0,te.property)(NumberInput.minProperty)],NumberInput.prototype,"min",void 0),j([(0,te.property)(NumberInput.maxProperty)],NumberInput.prototype,"max",void 0),j([(0,te.property)(NumberInput.placeholderProperty)],NumberInput.prototype,"placeholder",void 0),NumberInput}(Ae);B.NumberInput=Oe;var Me=function(O){function DateInput(){return null!==O&&O.apply(this,arguments)||this}return q(DateInput,O),DateInput.prototype.internalRender=function(){var O=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this.min&&this._dateInputElement.setAttribute("min",this.min),this.max&&this._dateInputElement.setAttribute("max",this.max),this.placeholder&&(this._dateInputElement.placeholder=this.placeholder,this._dateInputElement.setAttribute("aria-label",this.placeholder)),this._dateInputElement.tabIndex=this.isDesignMode()?-1:0,this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){O.valueChanged()},this.defaultValue&&(this._dateInputElement.value=this.defaultValue),this._dateInputElement},DateInput.prototype.getJsonTypeName=function(){return"Input.Date"},DateInput.prototype.isSet=function(){return!!this.value},DateInput.prototype.isValid=function(){if(!this.value)return!this.isRequired;var O=new Date(this.value),B=!0;if(this.min){var U=new Date(this.min);B=B&&O>=U}if(this.max){var G=new Date(this.max);B=B&&O<=G}return B},Object.defineProperty(DateInput.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:void 0},enumerable:!1,configurable:!0}),DateInput.valueProperty=new te.StringProperty(te.Versions.v1_0,"value"),DateInput.placeholderProperty=new te.StringProperty(te.Versions.v1_0,"placeholder"),DateInput.minProperty=new te.StringProperty(te.Versions.v1_0,"min"),DateInput.maxProperty=new te.StringProperty(te.Versions.v1_0,"max"),j([(0,te.property)(DateInput.valueProperty)],DateInput.prototype,"defaultValue",void 0),j([(0,te.property)(DateInput.minProperty)],DateInput.prototype,"min",void 0),j([(0,te.property)(DateInput.maxProperty)],DateInput.prototype,"max",void 0),j([(0,te.property)(DateInput.placeholderProperty)],DateInput.prototype,"placeholder",void 0),DateInput}(Ae);B.DateInput=Me;var De=function(O){function TimeProperty(B,U){var G=O.call(this,B,U,(function(O,B,U,G){var q=U[B.name];if("string"==typeof q&&q&&/^[0-9]{2}:[0-9]{2}$/.test(q))return q}),(function(O,B,U,G,q){q.serializeValue(U,B.name,G)}))||this;return G.targetVersion=B,G.name=U,G}return q(TimeProperty,O),TimeProperty}(te.CustomProperty);B.TimeProperty=De;var Le=function(O){function TimeInput(){return null!==O&&O.apply(this,arguments)||this}return q(TimeInput,O),TimeInput.convertTimeStringToDate=function(O){return new Date("1973-09-04T"+O+":00Z")},TimeInput.prototype.internalRender=function(){var O=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this.min&&this._timeInputElement.setAttribute("min",this.min),this.max&&this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){O.valueChanged()},this.placeholder&&(this._timeInputElement.placeholder=this.placeholder,this._timeInputElement.setAttribute("aria-label",this.placeholder)),this._timeInputElement.tabIndex=this.isDesignMode()?-1:0,this.defaultValue&&(this._timeInputElement.value=this.defaultValue),this._timeInputElement},TimeInput.prototype.getJsonTypeName=function(){return"Input.Time"},TimeInput.prototype.isSet=function(){return!!this.value},TimeInput.prototype.isValid=function(){if(!this.value)return!this.isRequired;var O=TimeInput.convertTimeStringToDate(this.value),B=!0;if(this.min){var U=TimeInput.convertTimeStringToDate(this.min);B=B&&O>=U}if(this.max){var G=TimeInput.convertTimeStringToDate(this.max);B=B&&O<=G}return B},Object.defineProperty(TimeInput.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:void 0},enumerable:!1,configurable:!0}),TimeInput.valueProperty=new De(te.Versions.v1_0,"value"),TimeInput.placeholderProperty=new te.StringProperty(te.Versions.v1_0,"placeholder"),TimeInput.minProperty=new De(te.Versions.v1_0,"min"),TimeInput.maxProperty=new De(te.Versions.v1_0,"max"),j([(0,te.property)(TimeInput.valueProperty)],TimeInput.prototype,"defaultValue",void 0),j([(0,te.property)(TimeInput.minProperty)],TimeInput.prototype,"min",void 0),j([(0,te.property)(TimeInput.maxProperty)],TimeInput.prototype,"max",void 0),j([(0,te.property)(TimeInput.placeholderProperty)],TimeInput.prototype,"placeholder",void 0),TimeInput}(Ae);B.TimeInput=Le;var Be=function(O){function Action(){var B=null!==O&&O.apply(this,arguments)||this;return B.style=K.ActionStyle.Default,B.mode=K.ActionMode.Primary,B._state=0,B._isFocusable=!0,B}return q(Action,O),Action.prototype.renderButtonContent=function(){if(this.renderedElement){var O=this.hostConfig,B=document.createElement("div");if(B.style.overflow="hidden",B.style.textOverflow="ellipsis",O.actions.iconPlacement===K.ActionIconPlacement.AboveTitle||O.actions.allowTitleToWrap||(B.style.whiteSpace="nowrap"),this.title&&(B.innerText=this.title),this.iconUrl){var U=document.createElement("img");U.src=this.iconUrl,U.style.width=O.actions.iconSize+"px",U.style.height=O.actions.iconSize+"px",U.style.flex="0 0 auto",O.actions.iconPlacement===K.ActionIconPlacement.AboveTitle?(this.renderedElement.classList.add("iconAbove"),this.renderedElement.style.flexDirection="column",this.title&&(U.style.marginBottom="6px")):(this.renderedElement.classList.add("iconLeft"),U.style.maxHeight="100%",this.title&&(U.style.marginRight="6px")),this.renderedElement.appendChild(U),this.renderedElement.appendChild(B)}else this.renderedElement.classList.add("noIcon"),this.renderedElement.appendChild(B)}},Action.prototype.getParentContainer=function(){return this.parent instanceof et?this.parent:this.parent?this.parent.getParentContainer():void 0},Action.prototype.isDesignMode=function(){var O=this.getRootObject();return O instanceof oe&&O.isDesignMode()},Action.prototype.updateCssClasses=function(){var O,B;if(this.parent&&this.renderedElement){var U=this.parent.hostConfig;this.renderedElement.className=U.makeCssClassName(this.isEffectivelyEnabled()?"ac-pushButton":"ac-pushButton-disabled");var G=this.getParentContainer();if(G){var q=G.getEffectiveStyle();q&&this.renderedElement.classList.add("style-"+q)}switch(this.renderedElement.tabIndex=!this.isDesignMode()&&this.isFocusable?0:-1,this._state){case 0:break;case 1:this.renderedElement.classList.add(U.makeCssClassName("expanded"));break;case 2:this.renderedElement.classList.add(U.makeCssClassName("subdued"))}this.style&&this.isEffectivelyEnabled()&&(this.style===K.ActionStyle.Positive?(O=this.renderedElement.classList).add.apply(O,U.makeCssClassNames("primary","style-positive")):(B=this.renderedElement.classList).add.apply(B,U.makeCssClassNames("style-"+this.style.toLowerCase())))}},Action.prototype.getDefaultSerializationContext=function(){return new pt},Action.prototype.internalGetReferencedInputs=function(){return{}},Action.prototype.internalPrepareForExecution=function(O){},Action.prototype.internalValidateInputs=function(O){var B=[];if(O)for(var U=0,G=Object.keys(O);U<G.length;U++){var q=O[G[U]];q.validateValue()||B.push(q)}return B},Action.prototype.shouldSerialize=function(O){return void 0!==O.actionRegistry.findByName(this.getJsonTypeName())},Action.prototype.raiseExecuteActionEvent=function(){var O,B,U;this.onExecute&&this.onExecute(this),B=(O=this).parent?O.parent.getRootElement():void 0,U=B&&B.onExecuteAction?B.onExecuteAction:ct.onExecuteAction,O.prepareForExecution()&&U&&U(O)},Action.prototype.internalAfterExecute=function(){var O=this.getRootObject();O instanceof oe&&O.updateActionsEnabledState()},Action.prototype.getHref=function(){return""},Action.prototype.getAriaRole=function(){return"button"},Action.prototype.setupElementForAccessibility=function(O,B){if(void 0===B&&(B=!1),O.tabIndex=this.isEffectivelyEnabled()&&!this.isDesignMode()?0:-1,O.setAttribute("role",this.getAriaRole()),O instanceof HTMLButtonElement&&(O.disabled=!this.isEffectivelyEnabled()),this.isEffectivelyEnabled()?(O.removeAttribute("aria-disabled"),O.classList.add(this.hostConfig.makeCssClassName("ac-selectable"))):O.setAttribute("aria-disabled","true"),this.title?(O.setAttribute("aria-label",this.title),O.title=this.title):(O.removeAttribute("aria-label"),O.removeAttribute("title")),this.tooltip){var U=B?this.title?"aria-description":"aria-label":"aria-description";O.setAttribute(U,this.tooltip),O.title=this.tooltip}},Action.prototype.parse=function(B,U){return O.prototype.parse.call(this,B,U||new pt)},Action.prototype.render=function(){var O=this,B=document.createElement("button");B.type="button",B.style.display="flex",B.style.alignItems="center",B.style.justifyContent="center",B.onclick=function(B){O.isEffectivelyEnabled()&&(B.preventDefault(),B.cancelBubble=!0,O.execute())},this._renderedElement=B,this.renderButtonContent(),this.updateCssClasses(),this.setupElementForAccessibility(B)},Action.prototype.execute=function(){this._actionCollection&&this._actionCollection.actionExecuted(this),this.raiseExecuteActionEvent(),this.internalAfterExecute()},Action.prototype.prepareForExecution=function(){var O=this.getReferencedInputs(),B=this.internalValidateInputs(O);return B.length>0?(B[0].focus(),!1):(this.internalPrepareForExecution(O),!0)},Action.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},Action.prototype.getAllInputs=function(O){return void 0===O&&(O=!0),[]},Action.prototype.getAllActions=function(){return[this]},Action.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},Action.prototype.getActionById=function(O){return this.id===O?this:void 0},Action.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},Action.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},Action.prototype.updateEnabledState=function(){},Action.prototype.isEffectivelyEnabled=function(){return this.isEnabled},Object.defineProperty(Action.prototype,"isPrimary",{get:function(){return this.style===K.ActionStyle.Positive},set:function(O){O?this.style=K.ActionStyle.Positive:this.style===K.ActionStyle.Positive&&(this.style=K.ActionStyle.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(Action.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:X.defaultHostConfig},enumerable:!1,configurable:!0}),Object.defineProperty(Action.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(Action.prototype,"state",{get:function(){return this._state},set:function(O){this._state!==O&&(this._state=O,this.updateCssClasses())},enumerable:!1,configurable:!0}),Object.defineProperty(Action.prototype,"isFocusable",{get:function(){return this._isFocusable},set:function(O){this._isFocusable!==O&&(this._isFocusable=O,this.updateCssClasses())},enumerable:!1,configurable:!0}),Action.titleProperty=new te.StringProperty(te.Versions.v1_0,"title"),Action.iconUrlProperty=new te.StringProperty(te.Versions.v1_1,"iconUrl"),Action.styleProperty=new te.ValueSetProperty(te.Versions.v1_2,"style",[{value:K.ActionStyle.Default},{value:K.ActionStyle.Positive},{value:K.ActionStyle.Destructive}],K.ActionStyle.Default),Action.modeProperty=new te.ValueSetProperty(te.Versions.v1_5,"mode",[{value:K.ActionMode.Primary},{value:K.ActionMode.Secondary}],K.ActionMode.Primary),Action.tooltipProperty=new te.StringProperty(te.Versions.v1_5,"tooltip"),Action.isEnabledProperty=new te.BoolProperty(te.Versions.v1_5,"isEnabled",!0),j([(0,te.property)(Action.titleProperty)],Action.prototype,"title",void 0),j([(0,te.property)(Action.iconUrlProperty)],Action.prototype,"iconUrl",void 0),j([(0,te.property)(Action.styleProperty)],Action.prototype,"style",void 0),j([(0,te.property)(Action.modeProperty)],Action.prototype,"mode",void 0),j([(0,te.property)(Action.tooltipProperty)],Action.prototype,"tooltip",void 0),j([(0,te.property)(Action.isEnabledProperty)],Action.prototype,"isEnabled",void 0),Action}(ee.CardObject);B.Action=Be;var Fe=function(O){function SubmitActionBase(){var B=null!==O&&O.apply(this,arguments)||this;return B.disabledUnlessAssociatedInputsChange=!1,B._isPrepared=!1,B._areReferencedInputsDirty=!1,B}return q(SubmitActionBase,O),SubmitActionBase.prototype.internalGetReferencedInputs=function(){var O={};if("none"!==this.associatedInputs){for(var B=this.parent,U=[];B;)U.push.apply(U,B.getAllInputs(!1)),B=B.parent;for(var G=0,q=U;G<q.length;G++){var j=q[G];j.id&&(O[j.id]=j)}}return O},SubmitActionBase.prototype.internalPrepareForExecution=function(O){if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&O)for(var B=0,U=Object.keys(O);B<U.length;B++){var G=O[U[B]];G.id&&G.isSet()&&(this._processedData[G.id]="string"==typeof G.value?G.value:G.value.toString())}this._isPrepared=!0},SubmitActionBase.prototype.internalAfterExecute=function(){Q.GlobalSettings.resetInputsDirtyStateAfterActionExecution&&this.resetReferencedInputsDirtyState()},SubmitActionBase.prototype.resetReferencedInputsDirtyState=function(){var O=this.getReferencedInputs();if(this._areReferencedInputsDirty=!1,O)for(var B=0,U=Object.keys(O);B<U.length;B++){O[U[B]].resetDirtyState()}},SubmitActionBase.prototype.updateEnabledState=function(){this._areReferencedInputsDirty=!1;var O=this.getReferencedInputs();if(O)for(var B=0,U=Object.keys(O);B<U.length;B++){if(O[U[B]].isDirty()){this._areReferencedInputsDirty=!0;break}}this.updateCssClasses(),this._renderedElement&&this.setupElementForAccessibility(this._renderedElement)},SubmitActionBase.prototype.isEffectivelyEnabled=function(){var B=O.prototype.isEffectivelyEnabled.call(this);return this.disabledUnlessAssociatedInputsChange?B&&this._areReferencedInputsDirty:B},Object.defineProperty(SubmitActionBase.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(O){this._originalData=O,this._isPrepared=!1},enumerable:!1,configurable:!0}),SubmitActionBase.dataProperty=new te.PropertyDefinition(te.Versions.v1_0,"data"),SubmitActionBase.associatedInputsProperty=new te.CustomProperty(te.Versions.v1_3,"associatedInputs",(function(O,B,U,G){var q=U[B.name];if(void 0!==q&&"string"==typeof q)return"none"===q.toLowerCase()?"none":"auto"}),(function(O,B,U,G,q){q.serializeValue(U,B.name,G)})),SubmitActionBase.disabledUnlessAssociatedInputsChangeProperty=new te.BoolProperty(te.Versions.v1_6,"disabledUnlessAssociatedInputsChange",!1),j([(0,te.property)(SubmitActionBase.dataProperty)],SubmitActionBase.prototype,"_originalData",void 0),j([(0,te.property)(SubmitActionBase.associatedInputsProperty)],SubmitActionBase.prototype,"associatedInputs",void 0),j([(0,te.property)(SubmitActionBase.disabledUnlessAssociatedInputsChangeProperty)],SubmitActionBase.prototype,"disabledUnlessAssociatedInputsChange",void 0),SubmitActionBase}(Be);B.SubmitActionBase=Fe;var ze=function(O){function SubmitAction(){return null!==O&&O.apply(this,arguments)||this}return q(SubmitAction,O),SubmitAction.prototype.getJsonTypeName=function(){return SubmitAction.JsonTypeName},SubmitAction.JsonTypeName="Action.Submit",SubmitAction}(Fe);B.SubmitAction=ze;var $e=function(O){function ExecuteAction(){return null!==O&&O.apply(this,arguments)||this}return q(ExecuteAction,O),ExecuteAction.prototype.getJsonTypeName=function(){return ExecuteAction.JsonTypeName},ExecuteAction.JsonTypeName="Action.Execute",ExecuteAction.verbProperty=new te.StringProperty(te.Versions.v1_4,"verb"),j([(0,te.property)(ExecuteAction.verbProperty)],ExecuteAction.prototype,"verb",void 0),ExecuteAction}(Fe);B.ExecuteAction=$e;var Ue=function(O){function OpenUrlAction(){return null!==O&&O.apply(this,arguments)||this}return q(OpenUrlAction,O),OpenUrlAction.prototype.getJsonTypeName=function(){return OpenUrlAction.JsonTypeName},OpenUrlAction.prototype.getAriaRole=function(){return"link"},OpenUrlAction.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B),this.url||B.addFailure(this,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.propertyMustBeSet("url"))},OpenUrlAction.prototype.getHref=function(){return this.url},OpenUrlAction.urlProperty=new te.StringProperty(te.Versions.v1_0,"url"),OpenUrlAction.JsonTypeName="Action.OpenUrl",j([(0,te.property)(OpenUrlAction.urlProperty)],OpenUrlAction.prototype,"url",void 0),OpenUrlAction}(Be);B.OpenUrlAction=Ue;var Ve=function(O){function ToggleVisibilityAction(){var B=null!==O&&O.apply(this,arguments)||this;return B.targetElements={},B}return q(ToggleVisibilityAction,O),ToggleVisibilityAction.prototype.updateAriaControlsAttribute=function(){if(this.targetElements){var O=Object.keys(this.targetElements);this._renderedElement&&(O.length>0?this._renderedElement.setAttribute("aria-controls",O.join(" ")):this._renderedElement.removeAttribute("aria-controls"))}},ToggleVisibilityAction.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B),this.targetElements||B.addFailure(this,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.propertyMustBeSet("targetElements"))},ToggleVisibilityAction.prototype.getJsonTypeName=function(){return ToggleVisibilityAction.JsonTypeName},ToggleVisibilityAction.prototype.render=function(){O.prototype.render.call(this),this.updateAriaControlsAttribute()},ToggleVisibilityAction.prototype.execute=function(){if(O.prototype.execute.call(this),this.parent)for(var B=0,U=Object.keys(this.targetElements);B<U.length;B++){var G=U[B],q=this.parent.getRootElement().getElementById(G);q&&("boolean"==typeof this.targetElements[G]?q.isVisible=this.targetElements[G]:q.isVisible=!q.isVisible)}},ToggleVisibilityAction.prototype.addTargetElement=function(O,B){void 0===B&&(B=void 0),this.targetElements[O]=B,this.updateAriaControlsAttribute()},ToggleVisibilityAction.prototype.removeTargetElement=function(O){delete this.targetElements[O],this.updateAriaControlsAttribute()},ToggleVisibilityAction.targetElementsProperty=new te.CustomProperty(te.Versions.v1_2,"targetElements",(function(O,B,U,G){var q={};if(Array.isArray(U[B.name]))for(var j=0,W=U[B.name];j<W.length;j++){var Y=W[j];if("string"==typeof Y)q[Y]=void 0;else if("object"==typeof Y){var K=Y.elementId;"string"==typeof K&&(q[K]=Z.parseBool(Y.isVisible))}}return q}),(function(O,B,U,G,q){for(var j=[],W=0,Y=Object.keys(G);W<Y.length;W++){var K=Y[W];"boolean"==typeof G[K]?j.push({elementId:K,isVisible:G[K]}):j.push(K)}q.serializeArray(U,B.name,j)}),{},(function(O){return{}})),ToggleVisibilityAction.JsonTypeName="Action.ToggleVisibility",j([(0,te.property)(ToggleVisibilityAction.targetElementsProperty)],ToggleVisibilityAction.prototype,"targetElements",void 0),ToggleVisibilityAction}(Be);B.ToggleVisibilityAction=Ve;var Ge=function(O){function StringWithSubstitutionProperty(B,U){var G=O.call(this,B,U,void 0,(function(){return new Q.StringWithSubstitutions}))||this;return G.targetVersion=B,G.name=U,G}return q(StringWithSubstitutionProperty,O),StringWithSubstitutionProperty.prototype.parse=function(O,B,U){var G=new Q.StringWithSubstitutions;return G.set(Z.parseString(B[this.name])),G},StringWithSubstitutionProperty.prototype.toJSON=function(O,B,U,G){G.serializeValue(B,this.name,U.getOriginal())},StringWithSubstitutionProperty}(te.PropertyDefinition),He=function(O){function HttpHeader(B,U){void 0===B&&(B=""),void 0===U&&(U="");var G=O.call(this)||this;return G.name=B,G.value=U,G}return q(HttpHeader,O),HttpHeader.prototype.getSchemaKey=function(){return"HttpHeader"},HttpHeader.prototype.getReferencedInputs=function(O,B){this._value.getReferencedInputs(O,B)},HttpHeader.prototype.prepareForExecution=function(O){this._value.substituteInputValues(O,Q.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(HttpHeader.prototype,"value",{get:function(){return this._value.get()},set:function(O){this._value.set(O)},enumerable:!1,configurable:!0}),HttpHeader.nameProperty=new te.StringProperty(te.Versions.v1_0,"name"),HttpHeader.valueProperty=new Ge(te.Versions.v1_0,"value"),j([(0,te.property)(HttpHeader.nameProperty)],HttpHeader.prototype,"name",void 0),j([(0,te.property)(HttpHeader.valueProperty)],HttpHeader.prototype,"_value",void 0),HttpHeader}(te.SerializableObject);B.HttpHeader=He;var qe=function(O){function HttpAction(){var B=null!==O&&O.apply(this,arguments)||this;return B._ignoreInputValidation=!1,B}return q(HttpAction,O),HttpAction.prototype.internalGetReferencedInputs=function(){var O=this.parent?this.parent.getRootElement().getAllInputs():[],B={};this._url.getReferencedInputs(O,B);for(var U=0,G=this.headers;U<G.length;U++){G[U].getReferencedInputs(O,B)}return this._body.getReferencedInputs(O,B),B},HttpAction.prototype.internalPrepareForExecution=function(O){if(O){this._url.substituteInputValues(O,Q.ContentTypes.applicationXWwwFormUrlencoded);for(var B=Q.ContentTypes.applicationJson,U=0,G=this.headers;U<G.length;U++){var q=G[U];q.prepareForExecution(O),q.name&&"content-type"===q.name.toLowerCase()&&(B=q.value)}this._body.substituteInputValues(O,B)}},HttpAction.prototype.getJsonTypeName=function(){return HttpAction.JsonTypeName},HttpAction.prototype.internalValidateProperties=function(B){if(O.prototype.internalValidateProperties.call(this,B),this.url||B.addFailure(this,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.propertyMustBeSet("url")),this.headers.length>0)for(var U=0,G=this.headers;U<G.length;U++){G[U].name||B.addFailure(this,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.actionHttpHeadersMustHaveNameAndValue())}},Object.defineProperty(HttpAction.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(O){this._ignoreInputValidation=O},enumerable:!1,configurable:!0}),Object.defineProperty(HttpAction.prototype,"url",{get:function(){return this._url.get()},set:function(O){this._url.set(O)},enumerable:!1,configurable:!0}),Object.defineProperty(HttpAction.prototype,"body",{get:function(){return this._body.get()},set:function(O){this._body.set(O)},enumerable:!1,configurable:!0}),HttpAction.urlProperty=new Ge(te.Versions.v1_0,"url"),HttpAction.bodyProperty=new Ge(te.Versions.v1_0,"body"),HttpAction.methodProperty=new te.StringProperty(te.Versions.v1_0,"method"),HttpAction.headersProperty=new te.SerializableObjectCollectionProperty(te.Versions.v1_0,"headers",He),HttpAction.ignoreInputValidationProperty=new te.BoolProperty(te.Versions.v1_3,"ignoreInputValidation",!1),HttpAction.JsonTypeName="Action.Http",j([(0,te.property)(HttpAction.urlProperty)],HttpAction.prototype,"_url",void 0),j([(0,te.property)(HttpAction.bodyProperty)],HttpAction.prototype,"_body",void 0),j([(0,te.property)(HttpAction.methodProperty)],HttpAction.prototype,"method",void 0),j([(0,te.property)(HttpAction.headersProperty)],HttpAction.prototype,"headers",void 0),j([(0,te.property)(HttpAction.ignoreInputValidationProperty)],HttpAction.prototype,"_ignoreInputValidation",void 0),HttpAction}(Be);B.HttpAction=qe;var je=function(O){function ShowCardAction(){var B=null!==O&&O.apply(this,arguments)||this;return B.card=new dt,B}return q(ShowCardAction,O),ShowCardAction.prototype.updateCssClasses=function(){if(O.prototype.updateCssClasses.call(this),this.renderedElement){var B=this.parent?this.parent.hostConfig:X.defaultHostConfig;this.renderedElement.classList.add(B.makeCssClassName("expandable")),this.renderedElement.setAttribute("aria-expanded",(1===this.state).toString())}},ShowCardAction.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U);var G=B.card;G?this.card.parse(G,U):U.logParseEvent(this,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.showCardMustHaveCard())},ShowCardAction.prototype.internalToJSON=function(B,U){O.prototype.internalToJSON.call(this,B,U),this.card&&U.serializeValue(B,"card",this.card.toJSON(U))},ShowCardAction.prototype.raiseExecuteActionEvent=function(){this.hostConfig.actions.showCard.actionMode===K.ShowCardActionMode.Popup&&O.prototype.raiseExecuteActionEvent.call(this)},ShowCardAction.prototype.releaseDOMResources=function(){O.prototype.releaseDOMResources.call(this),this.card.releaseDOMResources()},ShowCardAction.prototype.getJsonTypeName=function(){return ShowCardAction.JsonTypeName},ShowCardAction.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B),this.card.internalValidateProperties(B)},ShowCardAction.prototype.setParent=function(B){O.prototype.setParent.call(this,B),this.card.setParent(B)},ShowCardAction.prototype.getAllInputs=function(O){return void 0===O&&(O=!0),this.card.getAllInputs(O)},ShowCardAction.prototype.getAllActions=function(){var B=O.prototype.getAllActions.call(this);return B.push.apply(B,this.card.getAllActions()),B},ShowCardAction.prototype.getResourceInformation=function(){var B=O.prototype.getResourceInformation.call(this);return B.push.apply(B,this.card.getResourceInformation()),B},ShowCardAction.prototype.getActionById=function(B){var U=O.prototype.getActionById.call(this,B);return U||(U=this.card.getActionById(B)),U},ShowCardAction.JsonTypeName="Action.ShowCard",ShowCardAction}(Be);B.ShowCardAction=je;var We=function(O){function OverflowAction(B){var U=O.call(this)||this;return U._actions=B,U.title=re.Strings.defaults.overflowButtonText(),U.tooltip=re.Strings.defaults.overflowButtonTooltip(),U}return q(OverflowAction,O),OverflowAction.prototype.getActions=function(){return this._actions},OverflowAction.prototype.getAllActions=function(){var B=O.prototype.getAllActions.call(this);return B.push.apply(B,this._actions),B},OverflowAction.prototype.getJsonTypeName=function(){return je.JsonTypeName},OverflowAction.prototype.execute=function(){var O,B,U,G,q,j=this;if((B=this,U=this.renderedElement,G=B.parent?B.parent.getRootElement():void 0,!(void 0!==(q=G&&G.onDisplayOverflowActionMenu?G.onDisplayOverflowActionMenu:ct.onDisplayOverflowActionMenu)&&q(B.getActions(),U)))&&this.renderedElement){var W=new ne.PopupMenu;W.hostConfig=this.hostConfig;for(var _loop_2=function(B){var U=new ne.MenuItem(B.toString(),null!==(O=Y._actions[B].title)&&void 0!==O?O:"");U.isEnabled=Y._actions[B].isEnabled,U.onClick=function(){var O=j._actions[B];W.closePopup(!1),O.isEnabled&&O.execute()},W.items.add(U)},Y=this,K=0;K<this._actions.length;K++)_loop_2(K);W.onClose=function(){var O;null===(O=j.renderedElement)||void 0===O||O.setAttribute("aria-expanded","false")},this.renderedElement.setAttribute("aria-expanded","true"),W.popup(this.renderedElement)}},OverflowAction.prototype.setupElementForAccessibility=function(B,U){void 0===U&&(U=!1),O.prototype.setupElementForAccessibility.call(this,B,U),B.setAttribute("aria-label",re.Strings.defaults.overflowButtonTooltip()),B.setAttribute("aria-expanded","false")},OverflowAction.JsonTypeName="Action.Overflow",OverflowAction}(Be),Ye=function(){function ActionCollection(O){this._items=[],this._renderedActions=[],this._owner=O}return ActionCollection.prototype.isActionAllowed=function(O){var B=this._owner.getForbiddenActionTypes();if(B)for(var U=0,G=B;U<G.length;U++){var q=G[U];if(O.constructor===q)return!1}return!0},ActionCollection.prototype.refreshContainer=function(){if(clearElement(this._actionCardContainer),this._actionCard){this._actionCardContainer.style.marginTop=this.renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var O=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(O);var B=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(O);this._actionCard&&(this._actionCard.style.paddingLeft=B.left+"px",this._actionCard.style.paddingRight=B.right+"px",this._actionCard.style.marginLeft="-"+B.left+"px",this._actionCard.style.marginRight="-"+B.right+"px",0===B.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=B.bottom+"px",this._actionCard.style.marginBottom="-"+B.bottom+"px"),Z.appendChild(this._actionCardContainer,this._actionCard))}else this._actionCardContainer.style.marginTop="0px"},ActionCollection.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},ActionCollection.prototype.showActionCard=function(O,B,U){void 0===B&&(B=!1),void 0===U&&(U=!0),O.card.suppressStyle=B;var G=O.card.renderedElement&&!this._owner.isDesignMode()?O.card.renderedElement:O.card.render();this._actionCard=G,this._expandedAction=O,this.refreshContainer(),U&&(this.layoutChanged(),raiseInlineCardExpandedEvent(O,!0))},ActionCollection.prototype.collapseExpandedAction=function(){for(var O=0,B=this._renderedActions;O<B.length;O++){B[O].state=0}var U=this._expandedAction;this._expandedAction=void 0,this._actionCard=void 0,this.refreshContainer(),U&&(this.layoutChanged(),raiseInlineCardExpandedEvent(U,!1))},ActionCollection.prototype.expandShowCardAction=function(O,B){for(var U=this,G=!1,q=0,j=this._renderedActions;q<j.length;q++){var W=j[q];this._owner.hostConfig.actions.actionsOrientation==K.Orientation.Horizontal&&G&&(W.isFocusable=!1),W!==O?W.state=2:(W.state=1,G=!0,W.renderedElement&&(W.renderedElement.onblur=function(O){for(var B=0,G=U._renderedActions;B<G.length;B++){G[B].isFocusable=!0}}))}this.showActionCard(O,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),B)},ActionCollection.prototype.releaseDOMResources=function(){for(var O=0,B=this._renderedActions;O<B.length;O++){B[O].releaseDOMResources()}},ActionCollection.prototype.actionExecuted=function(O){O instanceof je?O===this._expandedAction?this.collapseExpandedAction():this._owner.hostConfig.actions.showCard.actionMode===K.ShowCardActionMode.Inline&&this.expandShowCardAction(O,!0):this.collapseExpandedAction()},ActionCollection.prototype.parse=function(O,B){if(this.clear(),Array.isArray(O))for(var U=0,G=O;U<G.length;U++){var q=G[U],j=[];this._owner instanceof rt&&(j=this._owner.getForbiddenActionNames());var W=B.parseAction(this._owner,q,j,!this._owner.isDesignMode());W&&this.addAction(W)}},ActionCollection.prototype.toJSON=function(O,B,U){U.serializeArray(O,B,this._items)},ActionCollection.prototype.getActionAt=function(O){return this._items[O]},ActionCollection.prototype.getActionCount=function(){return this._items.length},ActionCollection.prototype.getActionById=function(O){for(var B=void 0,U=0,G=this._items;U<G.length;U++){if(B=G[U].getActionById(O))break}return B},ActionCollection.prototype.validateProperties=function(O){this._owner.hostConfig.actions.maxActions&&this._items.length>this._owner.hostConfig.actions.maxActions&&O.addFailure(this._owner,K.ValidationEvent.TooManyActions,re.Strings.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this._items.length>0&&!this._owner.hostConfig.supportsInteractivity&&O.addFailure(this._owner,K.ValidationEvent.InteractivityNotAllowed,re.Strings.errors.interactivityNotAllowed());for(var B=0,U=this._items;B<U.length;B++){var G=U[B];this.isActionAllowed(G)||O.addFailure(this._owner,K.ValidationEvent.ActionTypeNotAllowed,re.Strings.errors.actionTypeNotAllowed(G.getJsonTypeName())),G.internalValidateProperties(O)}},ActionCollection.prototype.render=function(O){var B=this._owner.hostConfig;if(B.supportsInteractivity){var U=document.createElement("div"),G=B.actions.maxActions?Math.min(B.actions.maxActions,this._items.length):this._items.length;if(this._actionCardContainer=document.createElement("div"),this._renderedActions=[],B.actions.preExpandSingleShowCardAction&&1===G&&this._items[0]instanceof je&&this.isActionAllowed(this._items[0]))this.showActionCard(this._items[0],!0),this._renderedActions.push(this._items[0]);else{var q=document.createElement("div");if(q.className=B.makeCssClassName("ac-actionSet"),q.style.display="flex",O===K.Orientation.Horizontal)if(q.style.flexDirection="row",this._owner.horizontalAlignment&&B.actions.actionAlignment!==K.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case K.HorizontalAlignment.Center:q.style.justifyContent="center";break;case K.HorizontalAlignment.Right:q.style.justifyContent="flex-end";break;default:q.style.justifyContent="flex-start"}else switch(B.actions.actionAlignment){case K.ActionAlignment.Center:q.style.justifyContent="center";break;case K.ActionAlignment.Right:q.style.justifyContent="flex-end";break;default:q.style.justifyContent="flex-start"}else if(q.style.flexDirection="column",this._owner.horizontalAlignment&&B.actions.actionAlignment!==K.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case K.HorizontalAlignment.Center:q.style.alignItems="center";break;case K.HorizontalAlignment.Right:q.style.alignItems="flex-end";break;default:q.style.alignItems="flex-start"}else switch(B.actions.actionAlignment){case K.ActionAlignment.Center:q.style.alignItems="center";break;case K.ActionAlignment.Right:q.style.alignItems="flex-end";break;case K.ActionAlignment.Stretch:q.style.alignItems="stretch";break;default:q.style.alignItems="flex-start"}var j=this._items.filter(this.isActionAllowed.bind(this)),W=[],Y=[];if(this._owner.isDesignMode())W=j;else{j.forEach((function(O){return O.mode===K.ActionMode.Secondary?Y.push(O):W.push(O)}));var X=W.splice(B.actions.maxActions);Q.GlobalSettings.allowMoreThanMaxActionsInOverflowMenu&&Y.push.apply(Y,X);var J=!0;if(Y.length>0){this._overflowAction||(this._overflowAction=new We(Y),this._overflowAction.setParent(this._owner),this._overflowAction._actionCollection=this);var ee=this._owner instanceof ct&&!this._owner.parent;J=!function(O,B){var U=O.parent?O.parent.getRootElement():void 0,G=U&&U.onRenderOverflowActions?U.onRenderOverflowActions:ct.onRenderOverflowActions;return void 0!==G&&G(O.getActions(),B)}(this._overflowAction,ee)}this._overflowAction&&J&&W.push(this._overflowAction)}for(var te=0;te<W.length;te++){var ie=W[te];if(ie.render(),ie.renderedElement&&(B.actions.actionsOrientation===K.Orientation.Horizontal&&B.actions.actionAlignment===K.ActionAlignment.Stretch?ie.renderedElement.style.flex="0 1 100%":ie.renderedElement.style.flex="0 1 auto",q.appendChild(ie.renderedElement),this._renderedActions.push(ie),te<W.length-1&&B.actions.buttonSpacing>0)){var re=document.createElement("div");O===K.Orientation.Horizontal?(re.style.flex="0 0 auto",re.style.width=B.actions.buttonSpacing+"px"):re.style.height=B.actions.buttonSpacing+"px",Z.appendChild(q,re)}}var ne=document.createElement("div");ne.style.overflow="hidden",ne.appendChild(q),Z.appendChild(U,ne)}Z.appendChild(U,this._actionCardContainer);for(var oe=0,ae=this._renderedActions;oe<ae.length;oe++){var se=ae[oe];if(1===se.state){this.expandShowCardAction(se,!1);break}}return this._renderedActions.length>0?U:void 0}},ActionCollection.prototype.addAction=function(O){if(!O)throw new Error("The action parameter cannot be null.");if(O.parent&&O.parent!==this._owner||!(this._items.indexOf(O)<0))throw new Error(re.Strings.errors.actionAlreadyParented());this._items.push(O),O.parent||O.setParent(this._owner),O._actionCollection=this},ActionCollection.prototype.removeAction=function(O){this.expandedAction&&this._expandedAction===O&&this.collapseExpandedAction();var B=this._items.indexOf(O);if(B>=0){this._items.splice(B,1),O.setParent(void 0),O._actionCollection=void 0;for(var U=0;U<this._renderedActions.length;U++)if(this._renderedActions[U]===O){this._renderedActions.splice(U,1);break}return!0}return!1},ActionCollection.prototype.clear=function(){this._items=[],this._renderedActions=[],this._expandedAction=void 0},ActionCollection.prototype.getAllInputs=function(O){void 0===O&&(O=!0);var B=[];if(O)for(var U=0,G=this._items;U<G.length;U++){var q=G[U];B.push.apply(B,q.getAllInputs())}return B},ActionCollection.prototype.getResourceInformation=function(){for(var O=[],B=0,U=this._items;B<U.length;B++){var G=U[B];O.push.apply(O,G.getResourceInformation())}return O},Object.defineProperty(ActionCollection.prototype,"renderedActionCount",{get:function(){return this._renderedActions.length},enumerable:!1,configurable:!0}),Object.defineProperty(ActionCollection.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),ActionCollection}(),Ke=function(O){function ActionSet(){var B=O.call(this)||this;return B._actionCollection=new Ye(B),B}return q(ActionSet,O),ActionSet.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U),this._actionCollection.parse(B.actions,U)},ActionSet.prototype.internalToJSON=function(B,U){O.prototype.internalToJSON.call(this,B,U),this._actionCollection.toJSON(B,"actions",U)},ActionSet.prototype.internalRender=function(){return this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation)},ActionSet.prototype.releaseDOMResources=function(){O.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},ActionSet.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?O.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},ActionSet.prototype.getJsonTypeName=function(){return"ActionSet"},ActionSet.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},ActionSet.prototype.getActionAt=function(B){return B>=0&&B<this.getActionCount()?this._actionCollection.getActionAt(B):O.prototype.getActionAt.call(this,B)},ActionSet.prototype.getActionById=function(B){var U=this._actionCollection.getActionById(B);return U||O.prototype.getActionById.call(this,B)},ActionSet.prototype.getAllActions=function(){for(var B=O.prototype.getAllActions.call(this),U=0;U<this.getActionCount();U++){var G=this.getActionAt(U);G&&B.push(G)}return B},ActionSet.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B),this._actionCollection.validateProperties(B)},ActionSet.prototype.addAction=function(O){this._actionCollection.addAction(O)},ActionSet.prototype.getAllInputs=function(O){return void 0===O&&(O=!0),O?this._actionCollection.getAllInputs():[]},ActionSet.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},ActionSet.prototype.findDOMNodeOwner=function(B){for(var U=void 0,G=0;G<this.getActionCount();G++){var q=this.getActionAt(G);if(q&&(U=q.findDOMNodeOwner(B)))return U}return O.prototype.findDOMNodeOwner.call(this,B)},Object.defineProperty(ActionSet.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),ActionSet.orientationProperty=new te.EnumProperty(te.Versions.v1_1,"orientation",K.Orientation),j([(0,te.property)(ActionSet.orientationProperty)],ActionSet.prototype,"orientation",void 0),ActionSet}(oe);B.ActionSet=Ke;var Qe=function(O){function ContainerStyleProperty(B,U,G,q){var j=O.call(this,B,U,[{value:K.ContainerStyle.Default},{value:K.ContainerStyle.Emphasis},{targetVersion:te.Versions.v1_2,value:K.ContainerStyle.Accent},{targetVersion:te.Versions.v1_2,value:K.ContainerStyle.Good},{targetVersion:te.Versions.v1_2,value:K.ContainerStyle.Attention},{targetVersion:te.Versions.v1_2,value:K.ContainerStyle.Warning}],G,q)||this;return j.targetVersion=B,j.name=U,j.defaultValue=G,j.onGetInitialValue=q,j}return q(ContainerStyleProperty,O),ContainerStyleProperty}(te.ValueSetProperty);B.ContainerStyleProperty=Qe;var Ze=function(O){function StylableCardElementContainer(){return null!==O&&O.apply(this,arguments)||this}return q(StylableCardElementContainer,O),Object.defineProperty(StylableCardElementContainer.prototype,"style",{get:function(){if(this.allowCustomStyle){var O=this.getValue(StylableCardElementContainer.styleProperty);if(O&&this.hostConfig.containerStyles.getStyleByName(O))return O}},set:function(O){this.setValue(StylableCardElementContainer.styleProperty,O)},enumerable:!1,configurable:!0}),Object.defineProperty(StylableCardElementContainer.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(StylableCardElementContainer.prototype,"hasExplicitStyle",{get:function(){return void 0!==this.getValue(StylableCardElementContainer.styleProperty)},enumerable:!1,configurable:!0}),StylableCardElementContainer.prototype.applyBorder=function(){},StylableCardElementContainer.prototype.applyBackground=function(){if(this.renderedElement){var O=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(O.backgroundColor){var B=Z.stringToCssColor(O.backgroundColor);B&&(this.renderedElement.style.backgroundColor=B)}}},StylableCardElementContainer.prototype.applyPadding=function(){if(O.prototype.applyPadding.call(this),this.renderedElement){var B=new Q.SpacingDefinition;if(this.getEffectivePadding()&&(B=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=B.top+"px",this.renderedElement.style.paddingRight=B.right+"px",this.renderedElement.style.paddingBottom=B.bottom+"px",this.renderedElement.style.paddingLeft=B.left+"px",this.isBleeding()){var U=new Q.PaddingDefinition;this.getImmediateSurroundingPadding(U);var G=this.hostConfig.paddingDefinitionToSpacingDefinition(U);this.renderedElement.style.marginRight="-"+G.right+"px",this.renderedElement.style.marginLeft="-"+G.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+G.top+"px",this.renderedElement.style.marginBottom="-"+G.bottom+"px"),this.separatorElement&&this.separatorOrientation===K.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+G.left+"px",this.separatorElement.style.marginRight="-"+G.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&this.separatorOrientation===K.Orientation.Horizontal&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}},StylableCardElementContainer.prototype.getHasBackground=function(O){void 0===O&&(O=!1);for(var B=this.parent;B;){var U=!1;if(U=!O&&(B instanceof et&&B.backgroundImage.isValid()),B instanceof StylableCardElementContainer&&this.hasExplicitStyle&&(B.getEffectiveStyle()!==this.getEffectiveStyle()||U))return!0;B=B.parent}return!1},StylableCardElementContainer.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new Q.PaddingDefinition(K.Spacing.Padding,K.Spacing.Padding,K.Spacing.Padding,K.Spacing.Padding):O.prototype.getDefaultPadding.call(this)},StylableCardElementContainer.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B);var U=this.getValue(StylableCardElementContainer.styleProperty);void 0!==U&&(this.hostConfig.containerStyles.getStyleByName(U)||B.addFailure(this,K.ValidationEvent.InvalidPropertyValue,re.Strings.errors.invalidPropertyValue(U,"style")))},StylableCardElementContainer.prototype.render=function(){var B=O.prototype.render.call(this);return B&&this.getHasBackground()&&this.applyBackground(),this.applyBorder(),B},StylableCardElementContainer.prototype.getEffectiveStyle=function(){var B=this.style;return B||O.prototype.getEffectiveStyle.call(this)},StylableCardElementContainer.styleProperty=new Qe(te.Versions.v1_0,"style"),j([(0,te.property)(StylableCardElementContainer.styleProperty)],StylableCardElementContainer.prototype,"style",null),StylableCardElementContainer}(ge);B.StylableCardElementContainer=Ze;var Xe=function(O){function ContainerBase(){var B=null!==O&&O.apply(this,arguments)||this;return B._bleed=!1,B}return q(ContainerBase,O),ContainerBase.prototype.adjustRenderedElementSize=function(B){O.prototype.adjustRenderedElementSize.call(this,B),this.minPixelHeight&&(B.style.minHeight=this.minPixelHeight+"px")},ContainerBase.prototype.getHasExpandedAction=function(){return!1},ContainerBase.prototype.getBleed=function(){return this._bleed},ContainerBase.prototype.setBleed=function(O){this._bleed=O},Object.defineProperty(ContainerBase.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!1,configurable:!0}),ContainerBase.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},ContainerBase.bleedProperty=new te.BoolProperty(te.Versions.v1_2,"bleed",!1),ContainerBase.minHeightProperty=new te.PixelSizeProperty(te.Versions.v1_2,"minHeight"),j([(0,te.property)(ContainerBase.bleedProperty)],ContainerBase.prototype,"_bleed",void 0),j([(0,te.property)(ContainerBase.minHeightProperty)],ContainerBase.prototype,"minPixelHeight",void 0),ContainerBase}(Ze);B.ContainerBase=Xe;var Je=function(O){function BackgroundImage(){return null!==O&&O.apply(this,arguments)||this}return q(BackgroundImage,O),BackgroundImage.prototype.getSchemaKey=function(){return"BackgroundImage"},BackgroundImage.prototype.internalParse=function(B,U){if("string"!=typeof B)return O.prototype.internalParse.call(this,B,U);this.resetDefaultValues(),this.url=B},BackgroundImage.prototype.apply=function(O){if(this.url&&O.renderedElement){switch(O.renderedElement.style.backgroundImage="url('"+O.preProcessPropertyValue(BackgroundImage.urlProperty,this.url)+"')",this.fillMode){case K.FillMode.Repeat:O.renderedElement.style.backgroundRepeat="repeat";break;case K.FillMode.RepeatHorizontally:O.renderedElement.style.backgroundRepeat="repeat-x";break;case K.FillMode.RepeatVertically:O.renderedElement.style.backgroundRepeat="repeat-y";break;case K.FillMode.Cover:default:O.renderedElement.style.backgroundRepeat="no-repeat",O.renderedElement.style.backgroundSize="cover"}switch(this.horizontalAlignment){case K.HorizontalAlignment.Left:break;case K.HorizontalAlignment.Center:O.renderedElement.style.backgroundPositionX="center";break;case K.HorizontalAlignment.Right:O.renderedElement.style.backgroundPositionX="right"}switch(this.verticalAlignment){case K.VerticalAlignment.Top:break;case K.VerticalAlignment.Center:O.renderedElement.style.backgroundPositionY="center";break;case K.VerticalAlignment.Bottom:O.renderedElement.style.backgroundPositionY="bottom"}}},BackgroundImage.prototype.isValid=function(){return!!this.url},BackgroundImage.urlProperty=new te.StringProperty(te.Versions.v1_0,"url"),BackgroundImage.fillModeProperty=new te.EnumProperty(te.Versions.v1_2,"fillMode",K.FillMode,K.FillMode.Cover),BackgroundImage.horizontalAlignmentProperty=new te.EnumProperty(te.Versions.v1_2,"horizontalAlignment",K.HorizontalAlignment,K.HorizontalAlignment.Left),BackgroundImage.verticalAlignmentProperty=new te.EnumProperty(te.Versions.v1_2,"verticalAlignment",K.VerticalAlignment,K.VerticalAlignment.Top),j([(0,te.property)(BackgroundImage.urlProperty)],BackgroundImage.prototype,"url",void 0),j([(0,te.property)(BackgroundImage.fillModeProperty)],BackgroundImage.prototype,"fillMode",void 0),j([(0,te.property)(BackgroundImage.horizontalAlignmentProperty)],BackgroundImage.prototype,"horizontalAlignment",void 0),j([(0,te.property)(BackgroundImage.verticalAlignmentProperty)],BackgroundImage.prototype,"verticalAlignment",void 0),BackgroundImage}(te.SerializableObject);B.BackgroundImage=Je;var et=function(O){function Container(){var B=null!==O&&O.apply(this,arguments)||this;return B._items=[],B._renderedItems=[],B}return q(Container,O),Object.defineProperty(Container.prototype,"backgroundImage",{get:function(){return this.getValue(Container.backgroundImageProperty)},enumerable:!1,configurable:!0}),Container.prototype.insertItemAt=function(O,B,U){if(O.parent&&!U)throw new Error(re.Strings.errors.elementAlreadyParented());if(!O.isStandalone)throw new Error(re.Strings.errors.elementTypeNotStandalone(O.getJsonTypeName()));B<0||B>=this._items.length?this._items.push(O):this._items.splice(B,0,O),O.setParent(this)},Container.prototype.getItemsCollectionPropertyName=function(){return"items"},Container.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.renderedElement&&this.backgroundImage.apply(this),O.prototype.applyBackground.call(this)},Container.prototype.applyRTL=function(O){void 0!==this.rtl&&(O.dir=this.rtl?"rtl":"ltr")},Container.prototype.internalRender=function(){this._renderedItems=[];var O=this.hostConfig,B=document.createElement("div");switch(this.applyRTL(B),B.classList.add(O.makeCssClassName("ac-container")),B.style.display="flex",B.style.flexDirection="column",Q.GlobalSettings.useAdvancedCardBottomTruncation&&(B.style.minHeight="-webkit-min-content"),this.getEffectiveVerticalContentAlignment()){case K.VerticalAlignment.Center:B.style.justifyContent="center";break;case K.VerticalAlignment.Bottom:B.style.justifyContent="flex-end";break;default:B.style.justifyContent="flex-start"}if(this._items.length>0)for(var U=0,G=this._items;U<G.length;U++){var q=G[U],j=this.isElementAllowed(q)?q.render():void 0;j&&(this._renderedItems.length>0&&q.separatorElement&&(q.separatorElement.style.flex="0 0 auto",Z.appendChild(B,q.separatorElement)),Z.appendChild(B,j),this._renderedItems.push(q))}else if(this.isDesignMode()){var W=this.createPlaceholderElement();W.style.width="100%",W.style.height="100%",B.appendChild(W)}return B},Container.prototype.truncateOverflow=function(O){if(this.renderedElement){for(var B=this.renderedElement.offsetTop+O+1,handleElement_1=function(O){var U=O.renderedElement;if(U)switch(Z.getFitStatus(U,B)){case K.ContainerFitStatus.FullyInContainer:O.resetOverflow()&&handleElement_1(O);break;case K.ContainerFitStatus.Overflowing:var G=B-U.offsetTop;O.handleOverflow(G);break;case K.ContainerFitStatus.FullyOutOfContainer:O.handleOverflow(0)}},U=0,G=this._items;U<G.length;U++){var q=G[U];handleElement_1(q)}return!0}return!1},Container.prototype.undoOverflowTruncation=function(){for(var O=0,B=this._items;O<B.length;O++){B[O].resetOverflow()}},Container.prototype.getHasBackground=function(B){return void 0===B&&(B=!1),!B&&this.backgroundImage.isValid()||O.prototype.getHasBackground.call(this,B)},Container.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U),this.clear(),this.setShouldFallback(!1);var G=B[this.getItemsCollectionPropertyName()];if(Array.isArray(G))for(var q=0,j=G;q<j.length;q++){var W=j[q],Y=U.parseElement(this,W,this.forbiddenChildElements(),!this.isDesignMode());Y&&this.insertItemAt(Y,-1,!0)}},Container.prototype.internalToJSON=function(B,U){O.prototype.internalToJSON.call(this,B,U);var G=this.getItemsCollectionPropertyName();U.serializeArray(B,G,this._items)},Object.defineProperty(Container.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),Container.prototype.getEffectivePadding=function(){return Q.GlobalSettings.removePaddingFromContainersWithBackgroundImage&&!this.getHasBackground(!0)?new Q.PaddingDefinition:O.prototype.getEffectivePadding.call(this)},Container.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;var O=this.getParentContainer();return O?O.getEffectiveVerticalContentAlignment():K.VerticalAlignment.Top},Container.prototype.getItemCount=function(){return this._items.length},Container.prototype.getItemAt=function(O){return this._items[O]},Container.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var O=0,B=this._renderedItems;O<B.length;O++){var U=B[O];if(U.isVisible)return U}},Container.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var O=this._renderedItems.length-1;O>=0;O--)if(this._renderedItems[O].isVisible)return this._renderedItems[O]},Container.prototype.getJsonTypeName=function(){return"Container"},Container.prototype.isFirstElement=function(O){for(var B=this.isDesignMode(),U=0,G=this._items;U<G.length;U++){var q=G[U];if(q.isVisible||B)return q===O}return!1},Container.prototype.isLastElement=function(O){for(var B=this.isDesignMode(),U=this._items.length-1;U>=0;U--)if(this._items[U].isVisible||B)return this._items[U]===O;return!1},Container.prototype.isRtl=function(){if(void 0!==this.rtl)return this.rtl;var O=this.getParentContainer();return!!O&&O.isRtl()},Container.prototype.isBleedingAtTop=function(){var O=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!O&&O.isBleedingAtTop()},Container.prototype.isBleedingAtBottom=function(){var O=this.getLastVisibleRenderedItem();return this.isBleeding()||!!O&&(O.isBleedingAtBottom()&&O.getEffectiveStyle()===this.getEffectiveStyle())},Container.prototype.indexOf=function(O){return this._items.indexOf(O)},Container.prototype.addItem=function(O){this.insertItemAt(O,-1,!1)},Container.prototype.insertItemBefore=function(O,B){this.insertItemAt(O,this._items.indexOf(B),!1)},Container.prototype.insertItemAfter=function(O,B){this.insertItemAt(O,this._items.indexOf(B)+1,!1)},Container.prototype.removeItem=function(O){var B=this._items.indexOf(O);return B>=0&&(this._items.splice(B,1),O.setParent(void 0),this.updateLayout(),!0)},Container.prototype.clear=function(){this._items=[],this._renderedItems=[]},Container.prototype.getResourceInformation=function(){var B=O.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&B.push({url:this.backgroundImage.url,mimeType:"image"}),B},Container.prototype.getActionById=function(B){var U=O.prototype.getActionById.call(this,B);if(!U&&(this.selectAction&&(U=this.selectAction.getActionById(B)),!U))for(var G=0,q=this._items;G<q.length;G++){if(U=q[G].getActionById(B))break}return U},Object.defineProperty(Container.prototype,"padding",{get:function(){return this.getPadding()},set:function(O){this.setPadding(O)},enumerable:!1,configurable:!0}),Object.defineProperty(Container.prototype,"selectAction",{get:function(){return this._selectAction},set:function(O){this._selectAction=O},enumerable:!1,configurable:!0}),Object.defineProperty(Container.prototype,"bleed",{get:function(){return this.getBleed()},set:function(O){this.setBleed(O)},enumerable:!1,configurable:!0}),Container.backgroundImageProperty=new te.SerializableObjectProperty(te.Versions.v1_0,"backgroundImage",Je),Container.verticalContentAlignmentProperty=new te.EnumProperty(te.Versions.v1_1,"verticalContentAlignment",K.VerticalAlignment),Container.rtlProperty=new te.BoolProperty(te.Versions.v1_0,"rtl"),j([(0,te.property)(Container.backgroundImageProperty)],Container.prototype,"backgroundImage",null),j([(0,te.property)(Container.verticalContentAlignmentProperty)],Container.prototype,"verticalContentAlignment",void 0),j([(0,te.property)(Container.rtlProperty)],Container.prototype,"rtl",void 0),Container}(Xe);B.Container=et;var tt=function(O){function Column(B){void 0===B&&(B="stretch");var U=O.call(this)||this;return U.width="stretch",U._computedWeight=0,U.width=B,U}return q(Column,O),Column.prototype.adjustRenderedElementSize=function(O){this.isDesignMode()?(O.style.minWidth="20px",O.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(O.style.minWidth="0",this.minPixelHeight&&(O.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?O.style.flex="0 1 auto":"stretch"===this.width?O.style.flex="1 1 50px":this.width instanceof Q.SizeAndUnit&&(this.width.unit===K.SizeUnit.Pixel?(O.style.flex="0 0 auto",O.style.width=this.width.physicalSize+"px"):O.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%")},Column.prototype.shouldSerialize=function(O){return!0},Object.defineProperty(Column.prototype,"separatorOrientation",{get:function(){return K.Orientation.Vertical},enumerable:!1,configurable:!0}),Column.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(Column.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof it)&&(void 0!==this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!1,configurable:!0}),Object.defineProperty(Column.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Column.widthProperty=new te.CustomProperty(te.Versions.v1_0,"width",(function(O,B,U,G){var q=B.defaultValue,j=U[B.name],W=!1;if("number"!=typeof j||isNaN(j))if("auto"===j||"stretch"===j)q=j;else if("string"==typeof j)try{(q=Q.SizeAndUnit.parse(j)).unit===K.SizeUnit.Pixel&&B.targetVersion.compareTo(G.targetVersion)>0&&(W=!0)}catch(O){W=!0}else W=!0;else q=new Q.SizeAndUnit(j,K.SizeUnit.Weight);return W&&(G.logParseEvent(O,K.ValidationEvent.InvalidPropertyValue,re.Strings.errors.invalidColumnWidth(j)),q="auto"),q}),(function(O,B,U,G,q){G instanceof Q.SizeAndUnit?G.unit===K.SizeUnit.Pixel?q.serializeValue(U,"width",G.physicalSize+"px"):q.serializeNumber(U,"width",G.physicalSize):q.serializeValue(U,"width",G)}),"stretch"),j([(0,te.property)(Column.widthProperty)],Column.prototype,"width",void 0),Column}(et);B.Column=tt;var it=function(O){function ColumnSet(){var B=null!==O&&O.apply(this,arguments)||this;return B._columns=[],B}return q(ColumnSet,O),ColumnSet.prototype.createColumnInstance=function(O,B){return B.parseCardObject(this,O,[],!this.isDesignMode(),(function(O){return O&&"Column"!==O?void 0:new tt}),(function(O,U){B.logParseEvent(void 0,K.ValidationEvent.ElementTypeNotAllowed,re.Strings.errors.elementTypeNotAllowed(O))}))},ColumnSet.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var O=this.hostConfig,B=document.createElement("div");switch(B.className=O.makeCssClassName("ac-columnSet"),B.style.display="flex",Q.GlobalSettings.useAdvancedCardBottomTruncation&&(B.style.minHeight="-webkit-min-content"),this.getEffectiveHorizontalAlignment()){case K.HorizontalAlignment.Center:B.style.justifyContent="center";break;case K.HorizontalAlignment.Right:B.style.justifyContent="flex-end";break;default:B.style.justifyContent="flex-start"}for(var U=0,G=0,q=this._columns;G<q.length;G++){(Y=q[G]).width instanceof Q.SizeAndUnit&&Y.width.unit===K.SizeUnit.Weight&&(U+=Y.width.physicalSize)}for(var j=0,W=this._columns;j<W.length;j++){var Y;if((Y=W[j]).width instanceof Q.SizeAndUnit&&Y.width.unit===K.SizeUnit.Weight&&U>0){var X=100/U*Y.width.physicalSize;Y._computedWeight=X}var J=Y.render();J&&(this._renderedColumns.length>0&&Y.separatorElement&&(Y.separatorElement.style.flex="0 0 auto",Z.appendChild(B,Y.separatorElement)),Z.appendChild(B,J),this._renderedColumns.push(Y))}return this._renderedColumns.length>0?B:void 0}},ColumnSet.prototype.truncateOverflow=function(O){for(var B=0,U=this._columns;B<U.length;B++){U[B].handleOverflow(O)}return!0},ColumnSet.prototype.undoOverflowTruncation=function(){for(var O=0,B=this._columns;O<B.length;O++){B[O].resetOverflow()}},Object.defineProperty(ColumnSet.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),ColumnSet.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U),this._columns=[],this._renderedColumns=[];var G=B.columns;if(Array.isArray(G))for(var q=0,j=G;q<j.length;q++){var W=j[q],Y=this.createColumnInstance(W,U);Y&&this._columns.push(Y)}},ColumnSet.prototype.internalToJSON=function(B,U){O.prototype.internalToJSON.call(this,B,U),U.serializeArray(B,"columns",this._columns)},ColumnSet.prototype.isFirstElement=function(O){for(var B=0,U=this._columns;B<U.length;B++){var G=U[B];if(G.isVisible)return G===O}return!1},ColumnSet.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var O=0,B=this._columns;O<B.length;O++){if(B[O].isBleedingAtTop())return!0}return!1},ColumnSet.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var O=0,B=this._columns;O<B.length;O++){if(B[O].isBleedingAtBottom())return!0}return!1},ColumnSet.prototype.getItemCount=function(){return this._columns.length},ColumnSet.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0},ColumnSet.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0},ColumnSet.prototype.getColumnAt=function(O){return this._columns[O]},ColumnSet.prototype.getItemAt=function(O){return this.getColumnAt(O)},ColumnSet.prototype.getJsonTypeName=function(){return"ColumnSet"},ColumnSet.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B);for(var U=0,G=0,q=0,j=this._columns;q<j.length;q++){var W=j[q];"number"==typeof W.width?U++:"stretch"===W.width&&G++}U>0&&G>0&&B.addFailure(this,K.ValidationEvent.Hint,re.Strings.hints.dontUseWeightedAndStrecthedColumnsInSameSet())},ColumnSet.prototype.addColumn=function(O){if(O.parent)throw new Error(re.Strings.errors.columnAlreadyBelongsToAnotherSet());this._columns.push(O),O.setParent(this)},ColumnSet.prototype.removeItem=function(O){if(O instanceof tt){var B=this._columns.indexOf(O);if(B>=0)return this._columns.splice(B,1),O.setParent(void 0),this.updateLayout(),!0}return!1},ColumnSet.prototype.indexOf=function(O){return O instanceof tt?this._columns.indexOf(O):-1},ColumnSet.prototype.isLeftMostElement=function(O){return 0===this._columns.indexOf(O)},ColumnSet.prototype.isRightMostElement=function(O){return this._columns.indexOf(O)===this._columns.length-1},ColumnSet.prototype.isTopElement=function(O){return this._columns.indexOf(O)>=0},ColumnSet.prototype.isBottomElement=function(O){return this._columns.indexOf(O)>=0},ColumnSet.prototype.getActionById=function(O){for(var B=void 0,U=0,G=this._columns;U<G.length;U++){if(B=G[U].getActionById(O))break}return B},Object.defineProperty(ColumnSet.prototype,"bleed",{get:function(){return this.getBleed()},set:function(O){this.setBleed(O)},enumerable:!1,configurable:!0}),Object.defineProperty(ColumnSet.prototype,"padding",{get:function(){return this.getPadding()},set:function(O){this.setPadding(O)},enumerable:!1,configurable:!0}),Object.defineProperty(ColumnSet.prototype,"selectAction",{get:function(){return this._selectAction},set:function(O){this._selectAction=O},enumerable:!1,configurable:!0}),ColumnSet}(Xe);function raiseImageLoadedEvent(O){var B=O.getRootElement(),U=B&&B.onImageLoaded?B.onImageLoaded:ct.onImageLoaded;U&&U(O)}function raiseAnchorClickedEvent(O,B,U){var G=O.getRootElement(),q=G&&G.onAnchorClicked?G.onAnchorClicked:ct.onAnchorClicked;return void 0!==q&&q(O,B,U)}function raiseInlineCardExpandedEvent(O,B){var U=O.parent?O.parent.getRootElement():void 0,G=U&&U.onInlineCardExpanded?U.onInlineCardExpanded:ct.onInlineCardExpanded;G&&G(O,B)}function raiseElementVisibilityChangedEvent(O,B){void 0===B&&(B=!0);var U=O.getRootElement();B&&U.updateLayout();var G=U,q=G&&G.onElementVisibilityChanged?G.onElementVisibilityChanged:ct.onElementVisibilityChanged;void 0!==q&&q(O)}B.ColumnSet=it;var rt=function(O){function ContainerWithActions(){var B=O.call(this)||this;return B._actionCollection=new Ye(B),B}return q(ContainerWithActions,O),ContainerWithActions.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U),this.parseActions(B,U)},ContainerWithActions.prototype.parseActions=function(O,B){this._actionCollection.parse(O.actions,B)},ContainerWithActions.prototype.internalToJSON=function(B,U){O.prototype.internalToJSON.call(this,B,U),this._actionCollection.toJSON(B,"actions",U)},ContainerWithActions.prototype.internalRender=function(){var B=O.prototype.internalRender.call(this);if(B){var U=this._actionCollection.render(this.hostConfig.actions.actionsOrientation);return U&&(Z.appendChild(B,renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},K.Orientation.Horizontal)),Z.appendChild(B,U)),this.renderIfEmpty||B.children.length>0?B:void 0}},ContainerWithActions.prototype.getHasExpandedAction=function(){return 0!==this.renderedActionCount&&(1===this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)},Object.defineProperty(ContainerWithActions.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(ContainerWithActions.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),ContainerWithActions.prototype.releaseDOMResources=function(){O.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},ContainerWithActions.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},ContainerWithActions.prototype.getActionAt=function(B){return B>=0&&B<this.getActionCount()?this._actionCollection.getActionAt(B):O.prototype.getActionAt.call(this,B)},ContainerWithActions.prototype.getActionById=function(B){var U=this._actionCollection.getActionById(B);return U||O.prototype.getActionById.call(this,B)},ContainerWithActions.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B),this._actionCollection&&this._actionCollection.validateProperties(B)},ContainerWithActions.prototype.isLastElement=function(B){return O.prototype.isLastElement.call(this,B)&&0===this._actionCollection.getActionCount()},ContainerWithActions.prototype.addAction=function(O){this._actionCollection.addAction(O)},ContainerWithActions.prototype.clear=function(){O.prototype.clear.call(this),this._actionCollection.clear()},ContainerWithActions.prototype.getAllInputs=function(B){void 0===B&&(B=!0);var U=O.prototype.getAllInputs.call(this,B);return B&&U.push.apply(U,this._actionCollection.getAllInputs(B)),U},ContainerWithActions.prototype.getResourceInformation=function(){var B=O.prototype.getResourceInformation.call(this);return B.push.apply(B,this._actionCollection.getResourceInformation()),B},ContainerWithActions.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?O.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},ContainerWithActions.prototype.getForbiddenActionNames=function(){return[]},Object.defineProperty(ContainerWithActions.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),ContainerWithActions}(et);B.ContainerWithActions=rt;var nt=function(O){function RefreshActionProperty(B,U){var G=O.call(this,B,U,void 0)||this;return G.targetVersion=B,G.name=U,G}return q(RefreshActionProperty,O),RefreshActionProperty.prototype.parse=function(O,B,U){var G=U.parseAction(O.parent,B[this.name],[],!1);if(void 0!==G){if(G instanceof $e)return G;U.logParseEvent(O,K.ValidationEvent.ActionTypeNotAllowed,re.Strings.errors.actionTypeNotAllowed(G.getJsonTypeName()))}U.logParseEvent(O,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.propertyMustBeSet("action"))},RefreshActionProperty.prototype.toJSON=function(O,B,U,G){G.serializeValue(B,this.name,U?U.toJSON(G):void 0,void 0,!0)},RefreshActionProperty}(te.PropertyDefinition);B.RefreshActionProperty=nt;var ot=function(O){function RefreshDefinition(){return null!==O&&O.apply(this,arguments)||this}return q(RefreshDefinition,O),Object.defineProperty(RefreshDefinition.prototype,"action",{get:function(){return this.getValue(RefreshDefinition.actionProperty)},set:function(O){this.setValue(RefreshDefinition.actionProperty,O),O&&O.setParent(this.parent)},enumerable:!1,configurable:!0}),RefreshDefinition.prototype.getSchemaKey=function(){return"RefreshDefinition"},RefreshDefinition.actionProperty=new nt(te.Versions.v1_4,"action"),RefreshDefinition.userIdsProperty=new te.StringArrayProperty(te.Versions.v1_4,"userIds"),j([(0,te.property)(RefreshDefinition.actionProperty)],RefreshDefinition.prototype,"action",null),j([(0,te.property)(RefreshDefinition.userIdsProperty)],RefreshDefinition.prototype,"userIds",void 0),RefreshDefinition}(te.SerializableObject);B.RefreshDefinition=ot;var at=function(O){function AuthCardButton(){return null!==O&&O.apply(this,arguments)||this}return q(AuthCardButton,O),AuthCardButton.prototype.getSchemaKey=function(){return"AuthCardButton"},AuthCardButton.typeProperty=new te.StringProperty(te.Versions.v1_4,"type"),AuthCardButton.titleProperty=new te.StringProperty(te.Versions.v1_4,"title"),AuthCardButton.imageProperty=new te.StringProperty(te.Versions.v1_4,"image"),AuthCardButton.valueProperty=new te.StringProperty(te.Versions.v1_4,"value"),j([(0,te.property)(AuthCardButton.typeProperty)],AuthCardButton.prototype,"type",void 0),j([(0,te.property)(AuthCardButton.titleProperty)],AuthCardButton.prototype,"title",void 0),j([(0,te.property)(AuthCardButton.imageProperty)],AuthCardButton.prototype,"image",void 0),j([(0,te.property)(AuthCardButton.valueProperty)],AuthCardButton.prototype,"value",void 0),AuthCardButton}(te.SerializableObject);B.AuthCardButton=at;var st=function(O){function TokenExchangeResource(){return null!==O&&O.apply(this,arguments)||this}return q(TokenExchangeResource,O),TokenExchangeResource.prototype.getSchemaKey=function(){return"TokenExchangeResource"},TokenExchangeResource.idProperty=new te.StringProperty(te.Versions.v1_4,"id"),TokenExchangeResource.uriProperty=new te.StringProperty(te.Versions.v1_4,"uri"),TokenExchangeResource.providerIdProperty=new te.StringProperty(te.Versions.v1_4,"providerId"),j([(0,te.property)(TokenExchangeResource.idProperty)],TokenExchangeResource.prototype,"id",void 0),j([(0,te.property)(TokenExchangeResource.uriProperty)],TokenExchangeResource.prototype,"uri",void 0),j([(0,te.property)(TokenExchangeResource.providerIdProperty)],TokenExchangeResource.prototype,"providerId",void 0),TokenExchangeResource}(te.SerializableObject);B.TokenExchangeResource=st;var lt=function(O){function Authentication(){return null!==O&&O.apply(this,arguments)||this}return q(Authentication,O),Authentication.prototype.getSchemaKey=function(){return"Authentication"},Authentication.textProperty=new te.StringProperty(te.Versions.v1_4,"text"),Authentication.connectionNameProperty=new te.StringProperty(te.Versions.v1_4,"connectionName"),Authentication.buttonsProperty=new te.SerializableObjectCollectionProperty(te.Versions.v1_4,"buttons",at),Authentication.tokenExchangeResourceProperty=new te.SerializableObjectProperty(te.Versions.v1_4,"tokenExchangeResource",st,!0),j([(0,te.property)(Authentication.textProperty)],Authentication.prototype,"text",void 0),j([(0,te.property)(Authentication.connectionNameProperty)],Authentication.prototype,"connectionName",void 0),j([(0,te.property)(Authentication.buttonsProperty)],Authentication.prototype,"buttons",void 0),j([(0,te.property)(Authentication.tokenExchangeResourceProperty)],Authentication.prototype,"tokenExchangeResource",void 0),Authentication}(te.SerializableObject);B.Authentication=lt;var ct=function(O){function AdaptiveCard(){var B=null!==O&&O.apply(this,arguments)||this;return B.designMode=!1,B}return q(AdaptiveCard,O),Object.defineProperty(AdaptiveCard.prototype,"refresh",{get:function(){return this.getValue(AdaptiveCard.refreshProperty)},set:function(O){this.setValue(AdaptiveCard.refreshProperty,O),O&&(O.parent=this)},enumerable:!1,configurable:!0}),Object.defineProperty(AdaptiveCard,"processMarkdown",{get:function(){throw new Error(re.Strings.errors.processMarkdownEventRemoved())},set:function(O){throw new Error(re.Strings.errors.processMarkdownEventRemoved())},enumerable:!1,configurable:!0}),AdaptiveCard.applyMarkdown=function(O){var B={didProcess:!1};if(AdaptiveCard.onProcessMarkdown)AdaptiveCard.onProcessMarkdown(O,B);else if(window.markdownit){var U=window.markdownit;B.outputHtml=U().render(O),B.didProcess=!0}else AdaptiveCard._haveWarnedAboutNoMarkdownProcessing||(console.warn(re.Strings.errors.markdownProcessingNotEnabled),AdaptiveCard._haveWarnedAboutNoMarkdownProcessing=!0);return B},AdaptiveCard.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major===this.version.major&&this.maxVersion.minor<this.version.minor)},AdaptiveCard.prototype.getDefaultSerializationContext=function(){return new pt(this.version)},AdaptiveCard.prototype.getItemsCollectionPropertyName=function(){return"body"},AdaptiveCard.prototype.internalParse=function(B,U){this._fallbackCard=void 0;var G=U.parseElement(void 0,B.fallback,this.forbiddenChildElements(),!this.isDesignMode());G&&(this._fallbackCard=new AdaptiveCard,this._fallbackCard.addItem(G)),O.prototype.internalParse.call(this,B,U)},AdaptiveCard.prototype.internalToJSON=function(B,U){this.setValue(AdaptiveCard.versionProperty,U.targetVersion),O.prototype.internalToJSON.call(this,B,U)},AdaptiveCard.prototype.internalRender=function(){var B=O.prototype.internalRender.call(this);return Q.GlobalSettings.useAdvancedCardBottomTruncation&&B&&B.style.removeProperty("minHeight"),B},AdaptiveCard.prototype.getHasBackground=function(O){return void 0===O&&(O=!1),!0},AdaptiveCard.prototype.getDefaultPadding=function(){return new Q.PaddingDefinition(K.Spacing.Padding,K.Spacing.Padding,K.Spacing.Padding,K.Spacing.Padding)},AdaptiveCard.prototype.shouldSerialize=function(O){return!0},Object.defineProperty(AdaptiveCard.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(AdaptiveCard.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(AdaptiveCard.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!1,configurable:!0}),Object.defineProperty(AdaptiveCard.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),AdaptiveCard.prototype.getJsonTypeName=function(){return"AdaptiveCard"},AdaptiveCard.prototype.internalValidateProperties=function(B){O.prototype.internalValidateProperties.call(this,B),"AdaptiveCard"!==this.getValue(oe.typeNameProperty)&&B.addFailure(this,K.ValidationEvent.MissingCardType,re.Strings.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||B.addFailure(this,K.ValidationEvent.UnsupportedCardVersion,re.Strings.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):B.addFailure(this,K.ValidationEvent.PropertyCantBeNull,re.Strings.errors.propertyMustBeSet("version"))},AdaptiveCard.prototype.render=function(B){var U;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,U=this._fallbackCard.render()):(U=O.prototype.render.call(this))&&(U.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),Q.GlobalSettings.setTabIndexAtCardRoot&&(U.tabIndex=0),this.speak&&U.setAttribute("aria-label",this.speak)),B&&(Z.appendChild(B,U),this.updateLayout()),U},AdaptiveCard.prototype.updateLayout=function(B){if(void 0===B&&(B=!0),O.prototype.updateLayout.call(this,B),Q.GlobalSettings.useAdvancedCardBottomTruncation&&this.isDisplayed()){var U=this.hostConfig.getEffectiveSpacing(K.Spacing.Default);this.handleOverflow(this.renderedElement.offsetHeight-U)}},AdaptiveCard.prototype.shouldFallback=function(){return O.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(AdaptiveCard.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),AdaptiveCard.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json",AdaptiveCard.$schemaProperty=new te.CustomProperty(te.Versions.v1_0,"$schema",(function(O,B,U,G){return AdaptiveCard.schemaUrl}),(function(O,B,U,G,q){q.serializeValue(U,B.name,AdaptiveCard.schemaUrl)})),AdaptiveCard.versionProperty=new te.CustomProperty(te.Versions.v1_0,"version",(function(O,B,U,G){var q=te.Version.parse(U[B.name],G);return void 0===q&&(q=te.Versions.latest,G.logParseEvent(O,K.ValidationEvent.InvalidPropertyValue,re.Strings.errors.invalidCardVersion(q.toString()))),q}),(function(O,B,U,G,q){void 0!==G&&q.serializeValue(U,B.name,G.toString())}),te.Versions.v1_0),AdaptiveCard.fallbackTextProperty=new te.StringProperty(te.Versions.v1_0,"fallbackText"),AdaptiveCard.speakProperty=new te.StringProperty(te.Versions.v1_0,"speak"),AdaptiveCard.refreshProperty=new te.SerializableObjectProperty(te.Versions.v1_4,"refresh",ot,!0),AdaptiveCard.authenticationProperty=new te.SerializableObjectProperty(te.Versions.v1_4,"authentication",lt,!0),AdaptiveCard._haveWarnedAboutNoMarkdownProcessing=!1,j([(0,te.property)(AdaptiveCard.versionProperty)],AdaptiveCard.prototype,"version",void 0),j([(0,te.property)(AdaptiveCard.fallbackTextProperty)],AdaptiveCard.prototype,"fallbackText",void 0),j([(0,te.property)(AdaptiveCard.speakProperty)],AdaptiveCard.prototype,"speak",void 0),j([(0,te.property)(AdaptiveCard.refreshProperty)],AdaptiveCard.prototype,"refresh",null),j([(0,te.property)(AdaptiveCard.authenticationProperty)],AdaptiveCard.prototype,"authentication",void 0),AdaptiveCard}(rt);B.AdaptiveCard=ct;var dt=function(O){function InlineAdaptiveCard(){var B=null!==O&&O.apply(this,arguments)||this;return B.suppressStyle=!1,B}return q(InlineAdaptiveCard,O),InlineAdaptiveCard.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"},InlineAdaptiveCard.prototype.populateSchema=function(B){O.prototype.populateSchema.call(this,B),B.remove(ct.$schemaProperty,ct.versionProperty)},InlineAdaptiveCard.prototype.getDefaultPadding=function(){return new Q.PaddingDefinition(this.suppressStyle?K.Spacing.None:K.Spacing.Padding,K.Spacing.Padding,this.suppressStyle?K.Spacing.None:K.Spacing.Padding,K.Spacing.Padding)},Object.defineProperty(InlineAdaptiveCard.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(InlineAdaptiveCard.prototype,"defaultStyle",{get:function(){return this.suppressStyle?K.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:K.ContainerStyle.Emphasis},enumerable:!1,configurable:!0}),InlineAdaptiveCard.prototype.render=function(B){var U=O.prototype.render.call(this,B);return U&&(U.setAttribute("aria-live","polite"),U.removeAttribute("tabindex")),U},InlineAdaptiveCard}(ct),pt=function(O){function SerializationContext(){var B=null!==O&&O.apply(this,arguments)||this;return B._forbiddenTypes=new Set,B}return q(SerializationContext,O),SerializationContext.prototype.internalParseCardObject=function(O,B,U,G,q,j){var W=this,Y=void 0;if(B&&"object"==typeof B){var X=new Set;this._forbiddenTypes.forEach((function(O){X.add(O)})),U.forEach((function(O){W._forbiddenTypes.add(O)}));var J=Z.parseString(B.type);if(J&&this._forbiddenTypes.has(J))j(J,K.TypeErrorType.ForbiddenType);else{var ee=!1;if((Y=q(J))?(Y.setParent(O),Y.parse(B,this),ee=Q.GlobalSettings.enableFallback&&G&&Y.shouldFallback()):(ee=Q.GlobalSettings.enableFallback&&G,j(J,K.TypeErrorType.UnknownType)),ee){var te=B.fallback;!te&&O&&O.setShouldFallback(!0),"string"==typeof te&&"drop"===te.toLowerCase()?Y=void 0:"object"==typeof te&&(Y=this.internalParseCardObject(O,te,U,!0,q,j))}}this._forbiddenTypes=X}return Y},SerializationContext.prototype.cardObjectParsed=function(O,B){O instanceof Be&&this.onParseAction?this.onParseAction(O,B,this):O instanceof oe&&this.onParseElement&&this.onParseElement(O,B,this)},SerializationContext.prototype.shouldSerialize=function(O){return O instanceof Be?void 0!==this.actionRegistry.findByName(O.getJsonTypeName()):!(O instanceof oe)||void 0!==this.elementRegistry.findByName(O.getJsonTypeName())},SerializationContext.prototype.parseCardObject=function(O,B,U,G,q,j){var W=new Set(U),Y=this.internalParseCardObject(O,B,W,G,q,j);return void 0!==Y&&this.cardObjectParsed(Y,B),Y},SerializationContext.prototype.parseElement=function(O,B,U,G){var q=this;return this.parseCardObject(O,B,U,G,(function(O){return q.elementRegistry.createInstance(O,q.targetVersion)}),(function(O,B){B===K.TypeErrorType.UnknownType?q.logParseEvent(void 0,K.ValidationEvent.UnknownElementType,re.Strings.errors.unknownElementType(O)):q.logParseEvent(void 0,K.ValidationEvent.ElementTypeNotAllowed,re.Strings.errors.elementTypeNotAllowed(O))}))},SerializationContext.prototype.parseAction=function(O,B,U,G){var q=this;return this.parseCardObject(O,B,U,G,(function(O){return q.actionRegistry.createInstance(O,q.targetVersion)}),(function(O,B){B===K.TypeErrorType.UnknownType?q.logParseEvent(void 0,K.ValidationEvent.UnknownActionType,re.Strings.errors.unknownActionType(O)):q.logParseEvent(void 0,K.ValidationEvent.ActionTypeNotAllowed,re.Strings.errors.actionTypeNotAllowed(O))}))},Object.defineProperty(SerializationContext.prototype,"elementRegistry",{get:function(){var O;return null!==(O=this._elementRegistry)&&void 0!==O?O:ie.GlobalRegistry.elements},enumerable:!1,configurable:!0}),SerializationContext.prototype.setElementRegistry=function(O){this._elementRegistry=O},Object.defineProperty(SerializationContext.prototype,"actionRegistry",{get:function(){var O;return null!==(O=this._actionRegistry)&&void 0!==O?O:ie.GlobalRegistry.actions},enumerable:!1,configurable:!0}),SerializationContext.prototype.setActionRegistry=function(O){this._actionRegistry=O},SerializationContext}(te.BaseSerializationContext);B.SerializationContext=pt,ie.GlobalRegistry.defaultElements.register("Container",et),ie.GlobalRegistry.defaultElements.register("TextBlock",le),ie.GlobalRegistry.defaultElements.register("RichTextBlock",de,te.Versions.v1_2),ie.GlobalRegistry.defaultElements.register("TextRun",ce,te.Versions.v1_2),ie.GlobalRegistry.defaultElements.register("Image",me),ie.GlobalRegistry.defaultElements.register("ImageSet",fe),ie.GlobalRegistry.defaultElements.register("Media",ke,te.Versions.v1_1),ie.GlobalRegistry.defaultElements.register("FactSet",ue),ie.GlobalRegistry.defaultElements.register("ColumnSet",it),ie.GlobalRegistry.defaultElements.register("ActionSet",Ke,te.Versions.v1_2),ie.GlobalRegistry.defaultElements.register("Input.Text",Re),ie.GlobalRegistry.defaultElements.register("Input.Date",Me),ie.GlobalRegistry.defaultElements.register("Input.Time",Le),ie.GlobalRegistry.defaultElements.register("Input.Number",Oe),ie.GlobalRegistry.defaultElements.register("Input.ChoiceSet",Ne),ie.GlobalRegistry.defaultElements.register("Input.Toggle",Ie),ie.GlobalRegistry.defaultActions.register(Ue.JsonTypeName,Ue),ie.GlobalRegistry.defaultActions.register(ze.JsonTypeName,ze),ie.GlobalRegistry.defaultActions.register(je.JsonTypeName,je),ie.GlobalRegistry.defaultActions.register(Ve.JsonTypeName,Ve,te.Versions.v1_2),ie.GlobalRegistry.defaultActions.register($e.JsonTypeName,$e,te.Versions.v1_4)},182:function(O,B,U){"use strict";var G,q=this&&this.__extends||(G=function(O,B){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},G(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}G(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)}),j=this&&this.__decorate||function(O,B,U,G){var q,j=arguments.length,W=j<3?B:null===G?G=Object.getOwnPropertyDescriptor(B,U):G;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(O,B,U,G);else for(var Y=O.length-1;Y>=0;Y--)(q=O[Y])&&(W=(j<3?q(W):j>3?q(B,U,W):q(B,U))||W);return j>3&&W&&Object.defineProperty(B,U,W),W};Object.defineProperty(B,"__esModule",{value:!0}),B.CardObject=B.ValidationResults=void 0;var W=U(9003),Y=U(6758),K=U(8418),Q=U(9779),Z=U(2421),X=function(){function ValidationResults(){this.allIds={},this.validationEvents=[]}return ValidationResults.prototype.addFailure=function(O,B,U){this.validationEvents.push({phase:W.ValidationPhase.Validation,source:O,event:B,message:U})},ValidationResults}();B.ValidationResults=X;var J=function(O){function CardObject(){var B=null!==O&&O.apply(this,arguments)||this;return B._shouldFallback=!1,B}return q(CardObject,O),CardObject.prototype.getSchemaKey=function(){return this.getJsonTypeName()},Object.defineProperty(CardObject.prototype,"requires",{get:function(){return this.getValue(CardObject.requiresProperty)},enumerable:!1,configurable:!0}),CardObject.prototype.contains=function(O){return!!this._renderedElement&&this._renderedElement.contains(O)},CardObject.prototype.preProcessPropertyValue=function(O,B){var U=void 0===B?this.getValue(O):B;if(K.GlobalSettings.allowPreProcessingPropertyValues){for(var G=this;G&&!G.onPreProcessPropertyValue;)G=G.parent;if(G&&G.onPreProcessPropertyValue)return G.onPreProcessPropertyValue(this,O,U)}return U},CardObject.prototype.setParent=function(O){this._parent=O},CardObject.prototype.setShouldFallback=function(O){this._shouldFallback=O},CardObject.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},CardObject.prototype.getRootObject=function(){for(var O=this;O.parent;)O=O.parent;return O},CardObject.prototype.internalValidateProperties=function(O){this.id&&(O.allIds.hasOwnProperty(this.id)?(1===O.allIds[this.id]&&O.addFailure(this,W.ValidationEvent.DuplicateId,Y.Strings.errors.duplicateId(this.id)),O.allIds[this.id]+=1):O.allIds[this.id]=1)},CardObject.prototype.validateProperties=function(){var O=new X;return this.internalValidateProperties(O),O},CardObject.prototype.findDOMNodeOwner=function(O){return this.contains(O)?this:void 0},CardObject.prototype.releaseDOMResources=function(){},Object.defineProperty(CardObject.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(CardObject.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),CardObject.typeNameProperty=new Z.StringProperty(Z.Versions.v1_0,"type",void 0,void 0,void 0,(function(O){return O.getJsonTypeName()})),CardObject.idProperty=new Z.StringProperty(Z.Versions.v1_0,"id"),CardObject.requiresProperty=new Z.SerializableObjectProperty(Z.Versions.v1_2,"requires",Q.HostCapabilities,!1,new Q.HostCapabilities),j([(0,Z.property)(CardObject.idProperty)],CardObject.prototype,"id",void 0),j([(0,Z.property)(CardObject.requiresProperty)],CardObject.prototype,"requires",null),CardObject}(Z.SerializableObject);B.CardObject=J},7516:function(O,B,U){"use strict";var G,q=this&&this.__extends||(G=function(O,B){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},G(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}G(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)}),j=this&&this.__decorate||function(O,B,U,G){var q,j=arguments.length,W=j<3?B:null===G?G=Object.getOwnPropertyDescriptor(B,U):G;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(O,B,U,G);else for(var Y=O.length-1;Y>=0;Y--)(q=O[Y])&&(W=(j<3?q(W):j>3?q(B,U,W):q(B,U))||W);return j>3&&W&&Object.defineProperty(B,U,W),W},W=this&&this.__spreadArray||function(O,B,U){if(U||2===arguments.length)for(var G,q=0,j=B.length;q<j;q++)!G&&q in B||(G||(G=Array.prototype.slice.call(B,0,q)),G[q]=B[q]);return O.concat(G||Array.prototype.slice.call(B))};Object.defineProperty(B,"__esModule",{value:!0}),B.CarouselEvent=B.Carousel=B.CarouselPage=void 0;var Y=U(7191),K=U(9003),Q=U(2421),Z=U(9301),X=U(9003),J=U(6758),ee=U(5679),te=U(7794),ie=U(8418),re=function(O){function CarouselPage(){return null!==O&&O.apply(this,arguments)||this}return q(CarouselPage,O),CarouselPage.prototype.populateSchema=function(B){O.prototype.populateSchema.call(this,B),B.remove(Y.Container.styleProperty),B.remove(Y.Container.bleedProperty),B.remove(Y.Container.isVisibleProperty)},CarouselPage.prototype.internalRender=function(){var B=document.createElement("div");B.className=this.hostConfig.makeCssClassName("swiper-slide"),this.rtl=this.isRtl();var U=O.prototype.internalRender.call(this);return te.appendChild(B,U),B},CarouselPage.prototype.getForbiddenActionTypes=function(){return[Y.ShowCardAction,Y.ToggleVisibilityAction]},CarouselPage.prototype.getForbiddenChildElements=function(){return this.forbiddenChildElements()},CarouselPage.prototype.forbiddenChildElements=function(){return W([Y.ToggleVisibilityAction.JsonTypeName,Y.ShowCardAction.JsonTypeName,"Media","ActionSet","Input.Text","Input.Date","Input.Time","Input.Number","Input.ChoiceSet","Input.Toggle","Carousel"],O.prototype.forbiddenChildElements.call(this),!0)},CarouselPage.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U),this.setShouldFallback(!1)},CarouselPage.prototype.shouldSerialize=function(O){return!0},CarouselPage.prototype.getJsonTypeName=function(){return"CarouselPage"},Object.defineProperty(CarouselPage.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(CarouselPage.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),CarouselPage}(Y.Container);B.CarouselPage=re;var ne=function(O){function Carousel(){var B=null!==O&&O.apply(this,arguments)||this;return B._pages=[],B._currentIndex=0,B._previousEventType=K.CarouselInteractionEvent.Pagination,B}return q(Carousel,O),Carousel.prototype.populateSchema=function(B){O.prototype.populateSchema.call(this,B),B.remove(Y.Container.styleProperty),B.remove(Y.Container.bleedProperty),B.remove(Y.Container.isVisibleProperty)},Object.defineProperty(Carousel.prototype,"timer",{get:function(){var O=this.getValue(Carousel.timerProperty);return O&&O<this.hostConfig.carousel.minAutoplayDelay&&(console.warn(J.Strings.errors.tooLittleTimeDelay),O=this.hostConfig.carousel.minAutoplayDelay),O},set:function(O){O&&O<this.hostConfig.carousel.minAutoplayDelay?(console.warn(J.Strings.errors.tooLittleTimeDelay),this.setValue(Carousel.timerProperty,this.hostConfig.carousel.minAutoplayDelay)):this.setValue(Carousel.timerProperty,O)},enumerable:!1,configurable:!0}),Object.defineProperty(Carousel.prototype,"initialPageIndex",{get:function(){return this.getValue(Carousel.initialPageProperty)},set:function(O){this.isValidParsedPageIndex(O)?this.setValue(Carousel.initialPageProperty,O):(console.warn(J.Strings.errors.invalidInitialPageIndex(O)),this.setValue(Carousel.initialPageProperty,0))},enumerable:!1,configurable:!0}),Carousel.prototype.isValidParsedPageIndex=function(O){return!!this._pages&&this.isValidPageIndex(O,this._pages.length)},Carousel.prototype.isValidRenderedPageIndex=function(O){return!!this._renderedPages&&this.isValidPageIndex(O,this._renderedPages.length)},Carousel.prototype.isValidPageIndex=function(O,B){return B>0&&0<=O&&O<B},Object.defineProperty(Carousel.prototype,"previousEventType",{get:function(){return this._previousEventType},set:function(O){this._previousEventType=O},enumerable:!1,configurable:!0}),Carousel.prototype.forbiddenChildElements=function(){return W([Y.ToggleVisibilityAction.JsonTypeName,Y.ShowCardAction.JsonTypeName,"Media","ActionSet","Input.Text","Input.Date","Input.Time","Input.Number","Input.ChoiceSet","Input.Toggle"],O.prototype.forbiddenChildElements.call(this),!0)},Carousel.prototype.adjustRenderedElementSize=function(B){O.prototype.adjustRenderedElementSize.call(this,B),"stretch"==this.height&&void 0!==this._containerForAdorners&&(this._containerForAdorners.style.height="100%")},Carousel.prototype.getJsonTypeName=function(){return"Carousel"},Carousel.prototype.getItemCount=function(){return this._pages.length},Carousel.prototype.getItemAt=function(O){return this._pages[O]},Carousel.prototype.addPage=function(O){this._pages.push(O),O.setParent(this)},Carousel.prototype.removeItem=function(O){if(O instanceof re){var B=this._pages.indexOf(O);if(B>=0)return this._pages.splice(B,1),O.setParent(void 0),this.updateLayout(),!0}return!1},Carousel.prototype.getFirstVisibleRenderedItem=function(){var O;return this.renderedElement&&(null===(O=this._renderedPages)||void 0===O?void 0:O.length)>0?this._renderedPages[0]:void 0},Carousel.prototype.getLastVisibleRenderedItem=function(){var O;return this.renderedElement&&(null===(O=this._renderedPages)||void 0===O?void 0:O.length)>0?this._renderedPages[this._renderedPages.length-1]:void 0},Object.defineProperty(Carousel.prototype,"currentPageId",{get:function(){var O,B;if(null===(B=null===(O=this._carousel)||void 0===O?void 0:O.slides)||void 0===B?void 0:B.length)return this._carousel.slides[this._carousel.activeIndex].id},enumerable:!1,configurable:!0}),Object.defineProperty(Carousel.prototype,"currentPageIndex",{get:function(){var O;return null===(O=this._carousel)||void 0===O?void 0:O.realIndex},enumerable:!1,configurable:!0}),Carousel.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U),this._pages=[];var G=B.pages;if(Array.isArray(G))for(var q=0,j=G;q<j.length;q++){var W=j[q],Y=this.createCarouselPageInstance(W,U);Y&&this._pages.push(Y)}this.validateParsing(U)},Carousel.prototype.validateParsing=function(O){this.isValidParsedPageIndex(this.initialPageIndex)||O.logParseEvent(this,K.ValidationEvent.InvalidPropertyValue,J.Strings.errors.invalidInitialPageIndex(this.initialPageIndex))},Carousel.prototype.internalToJSON=function(B,U){O.prototype.internalToJSON.call(this,B,U),U.serializeArray(B,"pages",this._pages)},Carousel.prototype.internalRender=function(){var O,B=this;if(this._renderedPages=[],!(this._pages.length<=0)){var U=document.createElement("div");U.className=this.hostConfig.makeCssClassName("ac-carousel-card-level-container");var G=document.createElement("div");G.className=this.hostConfig.makeCssClassName("swiper","ac-carousel");var q=document.createElement("div");q.className=this.hostConfig.makeCssClassName("ac-carousel-container"),this._containerForAdorners=q,U.appendChild(q);var j=document.createElement("div");switch(j.className=this.hostConfig.makeCssClassName("swiper-wrapper","ac-carousel-card-container"),j.style.display="flex",this.getEffectiveVerticalContentAlignment()){case K.VerticalAlignment.Top:j.style.alignItems="flex-start";break;case K.VerticalAlignment.Bottom:j.style.alignItems="flex-end";break;default:j.style.alignItems="center"}ie.GlobalSettings.useAdvancedCardBottomTruncation&&(j.style.minHeight="-webkit-min-content");var W=document.createElement("div");W.className=this.hostConfig.makeCssClassName("swiper-button-prev","ac-carousel-left"),q.appendChild(W),te.addCancelSelectActionEventHandler(W);var Y=document.createElement("div");Y.className=this.hostConfig.makeCssClassName("swiper-button-next","ac-carousel-right"),q.appendChild(Y),te.addCancelSelectActionEventHandler(Y);var Q=document.createElement("div");Q.className=this.hostConfig.makeCssClassName("swiper-pagination","ac-carousel-pagination"),te.addCancelSelectActionEventHandler(Q),q.appendChild(Q),this.isDesignMode()&&(W.style.zIndex="20",Y.style.zIndex="20",Q.style.zIndex="20");var Z=Math.min(this._pages.length,this.hostConfig.carousel.maxCarouselPages);if(this._pages.length>this.hostConfig.carousel.maxCarouselPages&&console.warn(J.Strings.errors.tooManyCarouselPages),this._pages.length>0)for(var X=0;X<Z;X++){var ee=this._pages[X],re=this.isElementAllowed(ee)?ee.render():void 0;null==re||re.classList.add("ac-carousel-page"),null===(O=null==re?void 0:re.children[0])||void 0===O||O.classList.add("ac-carousel-page-container"),re&&(te.appendChild(j,re),this._renderedPages.push(ee))}return G.appendChild(j),G.tabIndex=this.isDesignMode()?-1:0,q.appendChild(G),this._carouselPageContainer=G,this.rtl=this.isRtl(),this.applyRTL(G),this.isDesignMode()||(this.isValidRenderedPageIndex(this.initialPageIndex)?this._currentIndex=this.initialPageIndex:(console.warn(J.Strings.errors.invalidInitialPageIndex(this.initialPageIndex)),this._currentIndex=0)),this.initializeCarouselControl(G,Y,W,Q,this.rtl),U.addEventListener("keydown",(function(O){var U,q,j=null===(U=B._carousel)||void 0===U?void 0:U.activeIndex;B.initializeCarouselControl(G,Y,W,Q,B.rtl),j&&(null===(q=B._carousel)||void 0===q||q.slideTo(j))}),{once:!0}),this._renderedPages.length>0?U:void 0}},Carousel.prototype.initializeCarouselControl=function(O,B,U,G,q){var j,W=this,Y={loop:!this.isDesignMode(),modules:[ee.Navigation,ee.Pagination,ee.Scrollbar,ee.A11y,ee.History,ee.Keyboard],pagination:{el:G,clickable:!0},navigation:{prevEl:void 0!==q&&q?B:U,nextEl:void 0!==q&&q?U:B},a11y:{enabled:!0},keyboard:{enabled:!0,onlyInViewport:!0},initialSlide:this._currentIndex};this.timer&&!this.isDesignMode()&&(null===(j=Y.modules)||void 0===j||j.push(ee.Autoplay),Y.autoplay={delay:this.timer,pauseOnMouseEnter:!0});var Q=new ee.Swiper(O,Y);O.addEventListener("mouseenter",(function(O){var B;null===(B=Q.autoplay)||void 0===B||B.stop()})),O.addEventListener("mouseleave",(function(O){var B;null===(B=Q.autoplay)||void 0===B||B.start()})),Q.on("navigationNext",(function(O){W.raiseCarouselEvent(K.CarouselInteractionEvent.NavigationNext)})),Q.on("navigationPrev",(function(O){W.raiseCarouselEvent(K.CarouselInteractionEvent.NavigationPrevious)})),Q.on("slideChangeTransitionEnd",(function(O){W.currentIndex=O.realIndex,W.raiseCarouselEvent(K.CarouselInteractionEvent.Pagination)})),Q.on("autoplay",(function(){W.raiseCarouselEvent(K.CarouselInteractionEvent.Autoplay)})),this._carousel=Q},Carousel.prototype.createCarouselPageInstance=function(O,B){return B.parseCardObject(this,O,this.forbiddenChildElements(),!this.isDesignMode(),(function(O){return O&&"CarouselPage"!==O?void 0:new re}),(function(O,U){B.logParseEvent(void 0,X.ValidationEvent.ElementTypeNotAllowed,J.Strings.errors.elementTypeNotAllowed(O))}))},Carousel.prototype.slideTo=function(O){var B;null===(B=this._carousel)||void 0===B||B.slideTo(O)},Object.defineProperty(Carousel.prototype,"carouselPageContainer",{get:function(){return this._carouselPageContainer},enumerable:!1,configurable:!0}),Object.defineProperty(Carousel.prototype,"currentIndex",{get:function(){return this._currentIndex},set:function(O){this._currentIndex=O},enumerable:!1,configurable:!0}),Carousel.prototype.createCarouselEvent=function(O){var B;return null!=this.currentPageIndex&&(B=this.getItemAt(this.currentPageIndex).id),new CarouselEvent(O,this.id,B,this.currentPageIndex)},Carousel.prototype.raiseCarouselEvent=function(O){var B=this.parent?this.parent.getRootElement():void 0,U=B&&B.onCarouselEvent?B.onCarouselEvent:Y.AdaptiveCard.onCarouselEvent;U&&O==K.CarouselInteractionEvent.Pagination&&U(this.createCarouselEvent(this.previousEventType)),this.previousEventType=O},Carousel.timerProperty=new Q.NumProperty(Q.Versions.v1_6,"timer",void 0),Carousel.initialPageProperty=new Q.NumProperty(Q.Versions.v1_6,"initialPage",0),j([(0,Q.property)(Carousel.timerProperty)],Carousel.prototype,"timer",null),j([(0,Q.property)(Carousel.initialPageProperty)],Carousel.prototype,"initialPageIndex",null),Carousel}(Y.Container);B.Carousel=ne;var CarouselEvent=function(O,B,U,G){this.type=O,this.carouselId=B,this.activeCarouselPageId=U,this.activeCarouselPageIndex=G};B.CarouselEvent=CarouselEvent,Z.GlobalRegistry.defaultElements.register("Carousel",ne,Q.Versions.v1_6)},160:(O,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.ChannelAdapter=void 0;var ChannelAdapter=function(){};B.ChannelAdapter=ChannelAdapter},8607:(O,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.Collection=void 0;var U=function(){function Collection(){this._items=[]}return Collection.prototype.get=function(O){return this._items[O]},Collection.prototype.add=function(O){this._items.push(O),this.onItemAdded&&this.onItemAdded(O)},Collection.prototype.remove=function(O){var B=this._items.indexOf(O);B>=0&&(this._items=this._items.splice(B,1),this.onItemRemoved&&this.onItemRemoved(O))},Collection.prototype.indexOf=function(O){return this._items.indexOf(O)},Object.defineProperty(Collection.prototype,"length",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),Collection}();B.Collection=U},336:(O,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.Constants=void 0;var U=function(){function Constants(){}return Constants.keys={tab:"Tab",enter:"Enter",escape:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",delete:"Delete"},Constants}();B.Constants=U},9336:function(O,B,U){"use strict";var G=this&&this.__createBinding||(Object.create?function(O,B,U,G){void 0===G&&(G=U);var q=Object.getOwnPropertyDescriptor(B,U);q&&!("get"in q?!B.__esModule:q.writable||q.configurable)||(q={enumerable:!0,get:function(){return B[U]}}),Object.defineProperty(O,G,q)}:function(O,B,U,G){void 0===G&&(G=U),O[G]=B[U]}),q=this&&this.__exportStar||function(O,B){for(var U in O)"default"===U||Object.prototype.hasOwnProperty.call(B,U)||G(B,O,U)};Object.defineProperty(B,"__esModule",{value:!0}),q(U(2044),B),q(U(3468),B)},2044:(O,B,U)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.MenuItem=void 0;var G=U(351),q=U(336),j=function(){function MenuItem(O,B){this._isEnabled=!0,this.key=O,this._value=B}return MenuItem.prototype.click=function(){this.isEnabled&&this.onClick&&this.onClick(this)},MenuItem.prototype.updateCssClasses=function(){if(this._element){var O=this._hostConfig?this._hostConfig:G.defaultHostConfig;this._element.className=O.makeCssClassName("ac-ctrl"),this._element.classList.add(O.makeCssClassName(this.isEnabled?"ac-ctrl-dropdown-item":"ac-ctrl-dropdown-item-disabled")),this.isEnabled||this._element.classList.add(O.makeCssClassName("ac-disabled"))}},MenuItem.prototype.toString=function(){return this.value},MenuItem.prototype.render=function(O){var B=this;return this._hostConfig=O,this._element||(this._element=document.createElement("span"),this._element.innerText=this.value,this._element.setAttribute("role","menuitem"),this.isEnabled||this._element.setAttribute("aria-disabled","true"),this._element.setAttribute("aria-current","false"),this._element.onmouseup=function(O){B.click()},this._element.onkeydown=function(O){O.key===q.Constants.keys.enter&&(O.cancelBubble=!0,B.click())},this.updateCssClasses()),this._element},Object.defineProperty(MenuItem.prototype,"value",{get:function(){return this._value},set:function(O){this._value=O,this._element&&(this._element.innerText=O)},enumerable:!1,configurable:!0}),Object.defineProperty(MenuItem.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(O){this._isEnabled!==O&&(this._isEnabled=O,this.updateCssClasses())},enumerable:!1,configurable:!0}),MenuItem}();B.MenuItem=j},9985:(O,B,U)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.PopupControl=void 0;var G=U(336),q=U(7794),j=U(351),W=function(){function PopupControl(){this._isOpen=!1}return PopupControl.prototype.keyDown=function(O){if(O.key===G.Constants.keys.escape)this.closePopup(!0)},PopupControl.prototype.render=function(O){var B=this,U=document.createElement("div");return U.tabIndex=0,U.className=this.hostConfig.makeCssClassName("ac-ctrl","ac-ctrl-popup-container"),U.setAttribute("role","dialog"),U.setAttribute("aria-modal","true"),U.onkeydown=function(O){return B.keyDown(O),!O.cancelBubble},U.appendChild(this.renderContent()),U},PopupControl.prototype.focus=function(){this._popupElement&&this._popupElement.firstElementChild.focus()},PopupControl.prototype.popup=function(O){var B,U,G,j,W,Y=this;if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className=this.hostConfig.makeCssClassName("ac-ctrl-overlay"),this._overlayElement.tabIndex=0,this._overlayElement.style.width=document.documentElement.scrollWidth+"px",this._overlayElement.style.height=document.documentElement.scrollHeight+"px",this._overlayElement.onfocus=function(O){Y.closePopup(!0)},document.body.appendChild(this._overlayElement);var K=O.getBoundingClientRect();this._popupElement=this.render(K),(B=this._popupElement.classList).remove.apply(B,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight","ac-ctrl-slideRightToLeft","ac-ctrl-slideTopToBottom","ac-ctrl-slideRightToLeft")),window.addEventListener("resize",(function(O){Y.closePopup(!0)}));var Q=O.getAttribute("aria-label");Q&&this._popupElement.setAttribute("aria-label",Q),this._overlayElement.appendChild(this._popupElement);var Z,X=this._popupElement.getBoundingClientRect(),J=window.innerHeight-K.bottom,ee=K.top,te=window.innerWidth-K.right,ie=K.left,re=K.left+q.getScrollX();if(ee<X.height&&J<X.height){var ne=Math.min(X.height,window.innerHeight);if(this._popupElement.style.maxHeight=ne+"px",Z=ne<X.height?q.getScrollY():q.getScrollY()+K.top+(K.height-ne)/2,ie<X.width&&te<X.width){var oe=Math.min(X.width,window.innerWidth);this._popupElement.style.maxWidth=oe+"px",re=oe<X.width?q.getScrollX():q.getScrollX()+K.left+(K.width-oe)/2}else te>=X.width?(re=q.getScrollX()+K.right,(U=this._popupElement.classList).add.apply(U,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight"))):(re=q.getScrollX()+K.left-X.width,(G=this._popupElement.classList).add.apply(G,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideRightToLeft")))}else J>=X.height?(Z=q.getScrollY()+K.bottom,(j=this._popupElement.classList).add.apply(j,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideTopToBottom"))):(Z=q.getScrollY()+K.top-X.height,(W=this._popupElement.classList).add.apply(W,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideBottomToTop"))),te<X.width&&(re=q.getScrollX()+K.right-X.width);this._popupElement.style.left=re+"px",this._popupElement.style.top=Z+"px",this._popupElement.focus(),this._isOpen=!0}},PopupControl.prototype.closePopup=function(O){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1,this.onClose&&this.onClose(this,O))},Object.defineProperty(PopupControl.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:j.defaultHostConfig},set:function(O){this._hostConfig=O},enumerable:!1,configurable:!0}),Object.defineProperty(PopupControl.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!1,configurable:!0}),PopupControl}();B.PopupControl=W},3468:function(O,B,U){"use strict";var G,q=this&&this.__extends||(G=function(O,B){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},G(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}G(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)});Object.defineProperty(B,"__esModule",{value:!0}),B.PopupMenu=void 0;var j=U(336),W=U(8607),Y=function(O){function PopupMenu(){var B=null!==O&&O.apply(this,arguments)||this;return B._items=new W.Collection,B._renderedItems=[],B._selectedIndex=-1,B}return q(PopupMenu,O),PopupMenu.prototype.renderContent=function(){var O=document.createElement("div");O.className=this.hostConfig.makeCssClassName("ac-ctrl ac-popup"),O.setAttribute("role","listbox");for(var B=0;B<this._items.length;B++){var U=this._items.get(B).render(this.hostConfig);U.tabIndex=0,O.appendChild(U),B===this.selectedIndex&&U.focus(),this._renderedItems.push(U)}return O},PopupMenu.prototype.keyDown=function(B){O.prototype.keyDown.call(this,B);var U=this._selectedIndex;switch(B.key){case j.Constants.keys.tab:this.closePopup(!0);break;case j.Constants.keys.up:(U<=0||--U<0)&&(U=this._renderedItems.length-1),this.selectedIndex=U,B.cancelBubble=!0;break;case j.Constants.keys.down:(U<0||++U>=this._renderedItems.length)&&(U=0),this.selectedIndex=U,B.cancelBubble=!0}},Object.defineProperty(PopupMenu.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(PopupMenu.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(O){O>=0&&O<this._renderedItems.length&&(this._renderedItems[O].focus(),this._selectedIndex=O)},enumerable:!1,configurable:!0}),PopupMenu}(U(9985).PopupControl);B.PopupMenu=Y},9003:(O,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.CarouselInteractionEvent=B.LogLevel=B.RefreshMode=B.TypeErrorType=B.ContainerFitStatus=B.ValidationEvent=B.ValidationPhase=B.InputTextStyle=B.ActionIconPlacement=B.FillMode=B.Orientation=B.ShowCardActionMode=B.ImageStyle=B.ActionAlignment=B.VerticalAlignment=B.HorizontalAlignment=B.TextColor=B.Spacing=B.FontType=B.TextWeight=B.TextSize=B.SizeUnit=B.ImageSize=B.Size=B.ActionMode=B.ActionStyle=B.ContainerStyle=void 0;var U=function(){function ContainerStyle(){}return ContainerStyle.Default="default",ContainerStyle.Emphasis="emphasis",ContainerStyle.Accent="accent",ContainerStyle.Good="good",ContainerStyle.Attention="attention",ContainerStyle.Warning="warning",ContainerStyle}();B.ContainerStyle=U;var G=function(){function ActionStyle(){}return ActionStyle.Default="default",ActionStyle.Positive="positive",ActionStyle.Destructive="destructive",ActionStyle}();B.ActionStyle=G;var q=function(){function ActionMode(){}return ActionMode.Primary="primary",ActionMode.Secondary="secondary",ActionMode}();B.ActionMode=q,function(O){O[O.Auto=0]="Auto",O[O.Stretch=1]="Stretch",O[O.Small=2]="Small",O[O.Medium=3]="Medium",O[O.Large=4]="Large"}(B.Size||(B.Size={})),function(O){O[O.Small=0]="Small",O[O.Medium=1]="Medium",O[O.Large=2]="Large"}(B.ImageSize||(B.ImageSize={})),function(O){O[O.Weight=0]="Weight",O[O.Pixel=1]="Pixel"}(B.SizeUnit||(B.SizeUnit={})),function(O){O[O.Small=0]="Small",O[O.Default=1]="Default",O[O.Medium=2]="Medium",O[O.Large=3]="Large",O[O.ExtraLarge=4]="ExtraLarge"}(B.TextSize||(B.TextSize={})),function(O){O[O.Lighter=0]="Lighter",O[O.Default=1]="Default",O[O.Bolder=2]="Bolder"}(B.TextWeight||(B.TextWeight={})),function(O){O[O.Default=0]="Default",O[O.Monospace=1]="Monospace"}(B.FontType||(B.FontType={})),function(O){O[O.None=0]="None",O[O.Small=1]="Small",O[O.Default=2]="Default",O[O.Medium=3]="Medium",O[O.Large=4]="Large",O[O.ExtraLarge=5]="ExtraLarge",O[O.Padding=6]="Padding"}(B.Spacing||(B.Spacing={})),function(O){O[O.Default=0]="Default",O[O.Dark=1]="Dark",O[O.Light=2]="Light",O[O.Accent=3]="Accent",O[O.Good=4]="Good",O[O.Warning=5]="Warning",O[O.Attention=6]="Attention"}(B.TextColor||(B.TextColor={})),function(O){O[O.Left=0]="Left",O[O.Center=1]="Center",O[O.Right=2]="Right"}(B.HorizontalAlignment||(B.HorizontalAlignment={})),function(O){O[O.Top=0]="Top",O[O.Center=1]="Center",O[O.Bottom=2]="Bottom"}(B.VerticalAlignment||(B.VerticalAlignment={})),function(O){O[O.Left=0]="Left",O[O.Center=1]="Center",O[O.Right=2]="Right",O[O.Stretch=3]="Stretch"}(B.ActionAlignment||(B.ActionAlignment={})),function(O){O[O.Default=0]="Default",O[O.Person=1]="Person"}(B.ImageStyle||(B.ImageStyle={})),function(O){O[O.Inline=0]="Inline",O[O.Popup=1]="Popup"}(B.ShowCardActionMode||(B.ShowCardActionMode={})),function(O){O[O.Horizontal=0]="Horizontal",O[O.Vertical=1]="Vertical"}(B.Orientation||(B.Orientation={})),function(O){O[O.Cover=0]="Cover",O[O.RepeatHorizontally=1]="RepeatHorizontally",O[O.RepeatVertically=2]="RepeatVertically",O[O.Repeat=3]="Repeat"}(B.FillMode||(B.FillMode={})),function(O){O[O.LeftOfTitle=0]="LeftOfTitle",O[O.AboveTitle=1]="AboveTitle"}(B.ActionIconPlacement||(B.ActionIconPlacement={})),function(O){O[O.Text=0]="Text",O[O.Tel=1]="Tel",O[O.Url=2]="Url",O[O.Email=3]="Email",O[O.Password=4]="Password"}(B.InputTextStyle||(B.InputTextStyle={})),function(O){O[O.Parse=0]="Parse",O[O.ToJSON=1]="ToJSON",O[O.Validation=2]="Validation"}(B.ValidationPhase||(B.ValidationPhase={})),function(O){O[O.Hint=0]="Hint",O[O.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",O[O.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",O[O.Deprecated=3]="Deprecated",O[O.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",O[O.InteractivityNotAllowed=5]="InteractivityNotAllowed",O[O.InvalidPropertyValue=6]="InvalidPropertyValue",O[O.MissingCardType=7]="MissingCardType",O[O.PropertyCantBeNull=8]="PropertyCantBeNull",O[O.TooManyActions=9]="TooManyActions",O[O.UnknownActionType=10]="UnknownActionType",O[O.UnknownElementType=11]="UnknownElementType",O[O.UnsupportedCardVersion=12]="UnsupportedCardVersion",O[O.DuplicateId=13]="DuplicateId",O[O.UnsupportedProperty=14]="UnsupportedProperty",O[O.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",O[O.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",O[O.Other=17]="Other"}(B.ValidationEvent||(B.ValidationEvent={})),function(O){O[O.FullyInContainer=0]="FullyInContainer",O[O.Overflowing=1]="Overflowing",O[O.FullyOutOfContainer=2]="FullyOutOfContainer"}(B.ContainerFitStatus||(B.ContainerFitStatus={})),function(O){O[O.UnknownType=0]="UnknownType",O[O.ForbiddenType=1]="ForbiddenType"}(B.TypeErrorType||(B.TypeErrorType={})),function(O){O[O.Disabled=0]="Disabled",O[O.Manual=1]="Manual",O[O.Automatic=2]="Automatic"}(B.RefreshMode||(B.RefreshMode={})),function(O){O[O.Info=0]="Info",O[O.Warning=1]="Warning",O[O.Error=2]="Error"}(B.LogLevel||(B.LogLevel={})),function(O){O[O.NavigationNext=0]="NavigationNext",O[O.NavigationPrevious=1]="NavigationPrevious",O[O.Pagination=2]="Pagination",O[O.Autoplay=3]="Autoplay"}(B.CarouselInteractionEvent||(B.CarouselInteractionEvent={}))},9779:function(O,B,U){"use strict";var G,q=this&&this.__extends||(G=function(O,B){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},G(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}G(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)});Object.defineProperty(B,"__esModule",{value:!0}),B.HostCapabilities=void 0;var j=U(2421),W=function(O){function HostCapabilities(){var B=null!==O&&O.apply(this,arguments)||this;return B._capabilities={},B}return q(HostCapabilities,O),HostCapabilities.prototype.getSchemaKey=function(){return"HostCapabilities"},HostCapabilities.prototype.internalParse=function(B,U){if(O.prototype.internalParse.call(this,B,U),B)for(var G in B){var q=B[G];if("string"==typeof q)if("*"===q)this.addCapability(G,"*");else{var W=j.Version.parse(q,U);(null==W?void 0:W.isValid)&&this.addCapability(G,W)}}},HostCapabilities.prototype.internalToJSON=function(B,U){for(var G in O.prototype.internalToJSON.call(this,B,U),this._capabilities)B[G]=this._capabilities[G]},HostCapabilities.prototype.addCapability=function(O,B){this._capabilities[O]=B},HostCapabilities.prototype.removeCapability=function(O){delete this._capabilities[O]},HostCapabilities.prototype.clear=function(){this._capabilities={}},HostCapabilities.prototype.hasCapability=function(O,B){return!!this._capabilities.hasOwnProperty(O)&&("*"===B||"*"===this._capabilities[O]||B.compareTo(this._capabilities[O])<=0)},HostCapabilities.prototype.areAllMet=function(O){for(var B in this._capabilities)if(!O.hasCapability(B,this._capabilities[B]))return!1;return!0},HostCapabilities}(j.SerializableObject);B.HostCapabilities=W},351:function(O,B,U){"use strict";var G,q=this&&this.__extends||(G=function(O,B){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},G(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}G(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)});Object.defineProperty(B,"__esModule",{value:!0}),B.defaultHostConfig=B.HostConfig=B.CarouselConfig=B.FontTypeSet=B.FontTypeDefinition=B.ContainerStyleSet=B.ContainerStyleDefinition=B.ColorSetDefinition=B.ActionsConfig=B.ShowCardActionConfig=B.FactSetConfig=B.FactTitleDefinition=B.FactTextDefinition=B.InputConfig=B.InputLabelConfig=B.RequiredInputLabelTextDefinition=B.TextBlockConfig=B.TextStyleSet=B.TextStyleDefinition=B.BaseTextDefinition=B.TableConfig=B.MediaConfig=B.ImageSetConfig=B.AdaptiveCardConfig=B.TextColorDefinition=B.ColorDefinition=void 0;var j=U(9003),W=U(7794),Y=U(8418),K=U(9779);function parseHostConfigEnum(O,B,U){if("string"==typeof B){var G=W.parseEnum(O,B,U);return void 0!==G?G:U}return"number"==typeof B?B:U}var Q=function(){function ColorDefinition(O,B){this.default="#000000",this.subtle="#666666",O&&(this.default=O),B&&(this.subtle=B)}return ColorDefinition.prototype.parse=function(O){O&&(this.default=O.default||this.default,this.subtle=O.subtle||this.subtle)},ColorDefinition}();B.ColorDefinition=Q;var Z=function(O){function TextColorDefinition(){var B=null!==O&&O.apply(this,arguments)||this;return B.highlightColors=new Q("#22000000","#11000000"),B}return q(TextColorDefinition,O),TextColorDefinition.prototype.parse=function(B){O.prototype.parse.call(this,B),B&&this.highlightColors.parse(B.highlightColors)},TextColorDefinition}(Q);B.TextColorDefinition=Z;var AdaptiveCardConfig=function(O){this.allowCustomStyle=!1,O&&(this.allowCustomStyle=O.allowCustomStyle||this.allowCustomStyle)};B.AdaptiveCardConfig=AdaptiveCardConfig;var X=function(){function ImageSetConfig(O){this.imageSize=j.Size.Medium,this.maxImageHeight=100,O&&(this.imageSize=null!=O.imageSize?O.imageSize:this.imageSize,this.maxImageHeight=W.parseNumber(O.maxImageHeight,100))}return ImageSetConfig.prototype.toJSON=function(){return{imageSize:j.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},ImageSetConfig}();B.ImageSetConfig=X;var J=function(){function MediaConfig(O){this.allowInlinePlayback=!0,O&&(this.defaultPoster=O.defaultPoster,this.allowInlinePlayback=O.allowInlinePlayback||this.allowInlinePlayback)}return MediaConfig.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},MediaConfig}();B.MediaConfig=J;var ee=function(){function TableConfig(O){this.cellSpacing=8,O&&(this.cellSpacing=O.cellSpacing&&"number"==typeof O.cellSpacing?O.cellSpacing:this.cellSpacing)}return TableConfig.prototype.toJSON=function(){return{cellSpacing:this.cellSpacing}},TableConfig}();B.TableConfig=ee;var te=function(){function BaseTextDefinition(O){this.size=j.TextSize.Default,this.color=j.TextColor.Default,this.isSubtle=!1,this.weight=j.TextWeight.Default,this.parse(O)}return BaseTextDefinition.prototype.parse=function(O){O&&(this.size=parseHostConfigEnum(j.TextSize,O.size,this.size),this.color=parseHostConfigEnum(j.TextColor,O.color,this.color),this.isSubtle=void 0!==O.isSubtle&&"boolean"==typeof O.isSubtle?O.isSubtle:this.isSubtle,this.weight=parseHostConfigEnum(j.TextWeight,O.weight,this.getDefaultWeight()))},BaseTextDefinition.prototype.getDefaultWeight=function(){return j.TextWeight.Default},BaseTextDefinition.prototype.toJSON=function(){return{size:j.TextSize[this.size],color:j.TextColor[this.color],isSubtle:this.isSubtle,weight:j.TextWeight[this.weight]}},BaseTextDefinition}();B.BaseTextDefinition=te;var ie=function(O){function TextStyleDefinition(){var B=null!==O&&O.apply(this,arguments)||this;return B.fontType=j.FontType.Default,B}return q(TextStyleDefinition,O),TextStyleDefinition.prototype.parse=function(B){O.prototype.parse.call(this,B),B&&(this.fontType=parseHostConfigEnum(j.FontType,B.fontType,this.fontType))},TextStyleDefinition}(te);B.TextStyleDefinition=ie;var re=function(){function TextStyleSet(O){this.default=new ie,this.heading=new ie({size:"Large",weight:"Bolder"}),this.columnHeader=new ie({weight:"Bolder"}),O&&(this.heading.parse(O.heading),this.columnHeader.parse(O.columnHeader))}return TextStyleSet.prototype.getStyleByName=function(O){switch(O.toLowerCase()){case"heading":return this.heading;case"columnHeader":return this.columnHeader;default:return this.default}},TextStyleSet}();B.TextStyleSet=re;var TextBlockConfig=function(O){O&&(this.headingLevel=W.parseNumber(O.headingLevel))};B.TextBlockConfig=TextBlockConfig;var ne=function(O){function RequiredInputLabelTextDefinition(){var B=null!==O&&O.apply(this,arguments)||this;return B.suffix=" *",B.suffixColor=j.TextColor.Attention,B}return q(RequiredInputLabelTextDefinition,O),RequiredInputLabelTextDefinition.prototype.parse=function(B){O.prototype.parse.call(this,B),B&&(this.suffix=B.suffix||this.suffix,this.suffixColor=parseHostConfigEnum(j.TextColor,B.suffixColor,this.suffixColor))},RequiredInputLabelTextDefinition.prototype.toJSON=function(){var B=O.prototype.toJSON.call(this);return B.suffix=this.suffix,B.suffixColor=j.TextColor[this.suffixColor],B},RequiredInputLabelTextDefinition}(te);B.RequiredInputLabelTextDefinition=ne;var InputLabelConfig=function(O){this.inputSpacing=j.Spacing.Small,this.requiredInputs=new ne,this.optionalInputs=new te,O&&(this.inputSpacing=parseHostConfigEnum(j.Spacing,O.inputSpacing,this.inputSpacing),this.requiredInputs=new ne(O.requiredInputs),this.optionalInputs=new te(O.optionalInputs))};B.InputLabelConfig=InputLabelConfig;var InputConfig=function(O){this.label=new InputLabelConfig,this.errorMessage=new te({color:j.TextColor.Attention}),O&&(this.label=new InputLabelConfig(O.label),this.errorMessage=new te(O.errorMessage))};B.InputConfig=InputConfig;var oe=function(O){function FactTextDefinition(){var B=null!==O&&O.apply(this,arguments)||this;return B.wrap=!0,B}return q(FactTextDefinition,O),FactTextDefinition.prototype.parse=function(B){O.prototype.parse.call(this,B),B&&(this.wrap=null!=B.wrap?B.wrap:this.wrap)},FactTextDefinition.prototype.toJSON=function(){var B=O.prototype.toJSON.call(this);return B.wrap=this.wrap,B},FactTextDefinition}(te);B.FactTextDefinition=oe;var ae=function(O){function FactTitleDefinition(B){var U=O.call(this,B)||this;return U.maxWidth=150,U.weight=j.TextWeight.Bolder,B&&(U.maxWidth=null!=B.maxWidth?B.maxWidth:U.maxWidth,U.weight=parseHostConfigEnum(j.TextWeight,B.weight,j.TextWeight.Bolder)),U}return q(FactTitleDefinition,O),FactTitleDefinition.prototype.getDefaultWeight=function(){return j.TextWeight.Bolder},FactTitleDefinition}(oe);B.FactTitleDefinition=ae;var FactSetConfig=function(O){this.title=new ae,this.value=new oe,this.spacing=10,O&&(this.title=new ae(O.title),this.value=new oe(O.value),this.spacing=O.spacing&&null!=O.spacing?O.spacing&&O.spacing:this.spacing)};B.FactSetConfig=FactSetConfig;var se=function(){function ShowCardActionConfig(O){this.actionMode=j.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=j.ContainerStyle.Emphasis,O&&(this.actionMode=parseHostConfigEnum(j.ShowCardActionMode,O.actionMode,j.ShowCardActionMode.Inline),this.inlineTopMargin=null!=O.inlineTopMargin?O.inlineTopMargin:this.inlineTopMargin,this.style=O.style&&"string"==typeof O.style?O.style:j.ContainerStyle.Emphasis)}return ShowCardActionConfig.prototype.toJSON=function(){return{actionMode:j.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},ShowCardActionConfig}();B.ShowCardActionConfig=se;var le=function(){function ActionsConfig(O){if(this.maxActions=5,this.spacing=j.Spacing.Default,this.buttonSpacing=20,this.showCard=new se,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=j.Orientation.Horizontal,this.actionAlignment=j.ActionAlignment.Left,this.iconPlacement=j.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=16,O){this.maxActions=null!=O.maxActions?O.maxActions:this.maxActions,this.spacing=parseHostConfigEnum(j.Spacing,O.spacing&&O.spacing,j.Spacing.Default),this.buttonSpacing=null!=O.buttonSpacing?O.buttonSpacing:this.buttonSpacing,this.showCard=new se(O.showCard),this.preExpandSingleShowCardAction=W.parseBool(O.preExpandSingleShowCardAction,!1),this.actionsOrientation=parseHostConfigEnum(j.Orientation,O.actionsOrientation,j.Orientation.Horizontal),this.actionAlignment=parseHostConfigEnum(j.ActionAlignment,O.actionAlignment,j.ActionAlignment.Left),this.iconPlacement=parseHostConfigEnum(j.ActionIconPlacement,O.iconPlacement,j.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=O.allowTitleToWrap?O.allowTitleToWrap:this.allowTitleToWrap;try{var B=Y.SizeAndUnit.parse(O.iconSize);B.unit===j.SizeUnit.Pixel&&(this.iconSize=B.physicalSize)}catch(O){}}}return ActionsConfig.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:j.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:j.Orientation[this.actionsOrientation],actionAlignment:j.ActionAlignment[this.actionAlignment]}},ActionsConfig}();B.ActionsConfig=le;var ce=function(){function ColorSetDefinition(O){this.default=new Z,this.dark=new Z,this.light=new Z,this.accent=new Z,this.good=new Z,this.warning=new Z,this.attention=new Z,this.parse(O)}return ColorSetDefinition.prototype.parseSingleColor=function(O,B){O&&this[B].parse(O[B])},ColorSetDefinition.prototype.parse=function(O){O&&(this.parseSingleColor(O,"default"),this.parseSingleColor(O,"dark"),this.parseSingleColor(O,"light"),this.parseSingleColor(O,"accent"),this.parseSingleColor(O,"good"),this.parseSingleColor(O,"warning"),this.parseSingleColor(O,"attention"))},ColorSetDefinition}();B.ColorSetDefinition=ce;var de=function(){function ContainerStyleDefinition(O){this.foregroundColors=new ce({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(O)}return ContainerStyleDefinition.prototype.parse=function(O){O&&(this.backgroundColor=O.backgroundColor,this.foregroundColors.parse(O.foregroundColors),this.highlightBackgroundColor=O.highlightBackgroundColor,this.highlightForegroundColor=O.highlightForegroundColor,this.borderColor=O.borderColor)},Object.defineProperty(ContainerStyleDefinition.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),ContainerStyleDefinition}();B.ContainerStyleDefinition=de;var pe=function(O){function BuiltInContainerStyleDefinition(){return null!==O&&O.apply(this,arguments)||this}return q(BuiltInContainerStyleDefinition,O),Object.defineProperty(BuiltInContainerStyleDefinition.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),BuiltInContainerStyleDefinition}(de),ue=function(){function ContainerStyleSet(O){if(this._allStyles={},this._allStyles[j.ContainerStyle.Default]=new pe,this._allStyles[j.ContainerStyle.Emphasis]=new pe,this._allStyles[j.ContainerStyle.Accent]=new pe,this._allStyles[j.ContainerStyle.Good]=new pe,this._allStyles[j.ContainerStyle.Attention]=new pe,this._allStyles[j.ContainerStyle.Warning]=new pe,O){this._allStyles[j.ContainerStyle.Default].parse(O[j.ContainerStyle.Default]),this._allStyles[j.ContainerStyle.Emphasis].parse(O[j.ContainerStyle.Emphasis]),this._allStyles[j.ContainerStyle.Accent].parse(O[j.ContainerStyle.Accent]),this._allStyles[j.ContainerStyle.Good].parse(O[j.ContainerStyle.Good]),this._allStyles[j.ContainerStyle.Attention].parse(O[j.ContainerStyle.Attention]),this._allStyles[j.ContainerStyle.Warning].parse(O[j.ContainerStyle.Warning]);var B=O.customStyles;if(B&&Array.isArray(B))for(var U=0,G=B;U<G.length;U++){var q=G[U];if(q){var W=q.name;W&&"string"==typeof W&&(this._allStyles.hasOwnProperty(W)?this._allStyles[W].parse(q.style):this._allStyles[W]=new de(q.style))}}}}return ContainerStyleSet.prototype.toJSON=function(){var O=this,B=[];Object.keys(this._allStyles).forEach((function(U){O._allStyles[U].isBuiltIn||B.push({name:U,style:O._allStyles[U]})}));var U={default:this.default,emphasis:this.emphasis};return B.length>0&&(U.customStyles=B),U},ContainerStyleSet.prototype.getStyleByName=function(O,B){return O&&this._allStyles.hasOwnProperty(O)?this._allStyles[O]:B||this._allStyles[j.ContainerStyle.Default]},Object.defineProperty(ContainerStyleSet.prototype,"default",{get:function(){return this._allStyles[j.ContainerStyle.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(ContainerStyleSet.prototype,"emphasis",{get:function(){return this._allStyles[j.ContainerStyle.Emphasis]},enumerable:!1,configurable:!0}),ContainerStyleSet}();B.ContainerStyleSet=ue;var he=function(){function FontTypeDefinition(O){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},O&&(this.fontFamily=O)}return FontTypeDefinition.prototype.parse=function(O){this.fontFamily=O.fontFamily||this.fontFamily,this.fontSizes={small:O.fontSizes&&O.fontSizes.small||this.fontSizes.small,default:O.fontSizes&&O.fontSizes.default||this.fontSizes.default,medium:O.fontSizes&&O.fontSizes.medium||this.fontSizes.medium,large:O.fontSizes&&O.fontSizes.large||this.fontSizes.large,extraLarge:O.fontSizes&&O.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:O.fontWeights&&O.fontWeights.lighter||this.fontWeights.lighter,default:O.fontWeights&&O.fontWeights.default||this.fontWeights.default,bolder:O.fontWeights&&O.fontWeights.bolder||this.fontWeights.bolder}},FontTypeDefinition.monospace=new FontTypeDefinition("'Courier New', Courier, monospace"),FontTypeDefinition}();B.FontTypeDefinition=he;var me=function(){function FontTypeSet(O){this.default=new he,this.monospace=new he("'Courier New', Courier, monospace"),O&&(this.default.parse(O.default),this.monospace.parse(O.monospace))}return FontTypeSet.prototype.getStyleDefinition=function(O){switch(O){case j.FontType.Monospace:return this.monospace;case j.FontType.Default:default:return this.default}},FontTypeSet}();B.FontTypeSet=me;var ge=function(){function CarouselConfig(O){this.maxCarouselPages=10,this.minAutoplayDelay=5e3,O&&(this.maxCarouselPages=null!=O.maxCarouselPages?O.maxCarouselPages:this.maxCarouselPages,this.minAutoplayDelay=null!=O.minAutoplayDelay?O.minAutoplayDelay:this.minAutoplayDelay)}return CarouselConfig.prototype.toJSON=function(){return{maxCarouselPages:this.maxCarouselPages,minAutoplayDelay:this.minAutoplayDelay}},CarouselConfig}();B.CarouselConfig=ge;var fe=function(){function HostConfig(O){this.hostCapabilities=new K.HostCapabilities,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new ue,this.inputs=new InputConfig,this.actions=new le,this.adaptiveCard=new AdaptiveCardConfig,this.imageSet=new X,this.media=new J,this.factSet=new FactSetConfig,this.table=new ee,this.textStyles=new re,this.textBlock=new TextBlockConfig,this.carousel=new ge,this.alwaysAllowBleed=!1,O&&(("string"==typeof O||O instanceof String)&&(O=JSON.parse(O)),this.choiceSetInputValueSeparator=O&&"string"==typeof O.choiceSetInputValueSeparator?O.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=O&&"boolean"==typeof O.supportsInteractivity?O.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new he,this._legacyFontType.parse(O),O.fontTypes&&(this.fontTypes=new me(O.fontTypes)),O.lineHeights&&(this.lineHeights={small:O.lineHeights.small,default:O.lineHeights.default,medium:O.lineHeights.medium,large:O.lineHeights.large,extraLarge:O.lineHeights.extraLarge}),this.imageSizes={small:O.imageSizes&&O.imageSizes.small||this.imageSizes.small,medium:O.imageSizes&&O.imageSizes.medium||this.imageSizes.medium,large:O.imageSizes&&O.imageSizes.large||this.imageSizes.large},this.containerStyles=new ue(O.containerStyles),this.spacing={small:O.spacing&&O.spacing.small||this.spacing.small,default:O.spacing&&O.spacing.default||this.spacing.default,medium:O.spacing&&O.spacing.medium||this.spacing.medium,large:O.spacing&&O.spacing.large||this.spacing.large,extraLarge:O.spacing&&O.spacing.extraLarge||this.spacing.extraLarge,padding:O.spacing&&O.spacing.padding||this.spacing.padding},this.separator={lineThickness:O.separator&&O.separator.lineThickness||this.separator.lineThickness,lineColor:O.separator&&O.separator.lineColor||this.separator.lineColor},this.inputs=new InputConfig(O.inputs||this.inputs),this.actions=new le(O.actions||this.actions),this.adaptiveCard=new AdaptiveCardConfig(O.adaptiveCard||this.adaptiveCard),this.imageSet=new X(O.imageSet),this.factSet=new FactSetConfig(O.factSet),this.textStyles=new re(O.textStyles),this.textBlock=new TextBlockConfig(O.textBlock),this.carousel=new ge(O.carousel))}return HostConfig.prototype.getFontTypeDefinition=function(O){return this.fontTypes?this.fontTypes.getStyleDefinition(O):O===j.FontType.Monospace?he.monospace:this._legacyFontType},HostConfig.prototype.getEffectiveSpacing=function(O){switch(O){case j.Spacing.Small:return this.spacing.small;case j.Spacing.Default:return this.spacing.default;case j.Spacing.Medium:return this.spacing.medium;case j.Spacing.Large:return this.spacing.large;case j.Spacing.ExtraLarge:return this.spacing.extraLarge;case j.Spacing.Padding:return this.spacing.padding;default:return 0}},HostConfig.prototype.paddingDefinitionToSpacingDefinition=function(O){return new Y.SpacingDefinition(this.getEffectiveSpacing(O.top),this.getEffectiveSpacing(O.right),this.getEffectiveSpacing(O.bottom),this.getEffectiveSpacing(O.left))},HostConfig.prototype.makeCssClassNames=function(){for(var O=[],B=0;B<arguments.length;B++)O[B]=arguments[B];for(var U=[],G=0,q=O;G<q.length;G++){var j=q[G];U.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+j)}return U},HostConfig.prototype.makeCssClassName=function(){for(var O=[],B=0;B<arguments.length;B++)O[B]=arguments[B];var U=this.makeCssClassNames.apply(this,O).join(" ");return U||""},Object.defineProperty(HostConfig.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(O){this._legacyFontType.fontFamily=O},enumerable:!1,configurable:!0}),Object.defineProperty(HostConfig.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(HostConfig.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),HostConfig}();B.HostConfig=fe,B.defaultHostConfig=new fe({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{weight:j.TextWeight.Bolder,suffix:" *",suffixColor:j.TextColor.Attention},optionalInputs:{weight:j.TextWeight.Bolder}},errorMessage:{color:j.TextColor.Attention,weight:j.TextWeight.Bolder}},actions:{maxActions:5,spacing:j.Spacing.Default,buttonSpacing:10,showCard:{actionMode:j.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:j.Orientation.Horizontal,actionAlignment:j.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:j.Size.Medium,maxImageHeight:100},factSet:{title:{color:j.TextColor.Default,size:j.TextSize.Default,isSubtle:!1,weight:j.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:j.TextColor.Default,size:j.TextSize.Default,isSubtle:!1,weight:j.TextWeight.Default,wrap:!0},spacing:10},carousel:{maxCarouselPages:10,minAutoplayDuration:5e3}})},9301:(O,B,U)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.GlobalRegistry=B.CardObjectRegistry=void 0;var G=U(2421),q=function(){function CardObjectRegistry(){this._items={}}return CardObjectRegistry.prototype.findByName=function(O){return this._items.hasOwnProperty(O)?this._items[O]:void 0},CardObjectRegistry.prototype.clear=function(){this._items={}},CardObjectRegistry.prototype.copyTo=function(O){for(var B=0,U=Object.keys(this._items);B<U.length;B++){var G=U[B],q=this._items[G];O.register(q.typeName,q.objectType,q.schemaVersion)}},CardObjectRegistry.prototype.register=function(O,B,U){void 0===U&&(U=G.Versions.v1_0);var q=this.findByName(O);void 0!==q?q.objectType=B:q={typeName:O,objectType:B,schemaVersion:U},this._items[O]=q},CardObjectRegistry.prototype.unregister=function(O){delete this._items[O]},CardObjectRegistry.prototype.createInstance=function(O,B){var U=this.findByName(O);return U&&U.schemaVersion.compareTo(B)<=0?new U.objectType:void 0},CardObjectRegistry.prototype.getItemCount=function(){return Object.keys(this._items).length},CardObjectRegistry.prototype.getItemAt=function(O){var B=this;return Object.keys(this._items).map((function(O){return B._items[O]}))[O]},CardObjectRegistry}();B.CardObjectRegistry=q;var j=function(){function GlobalRegistry(){}return GlobalRegistry.populateWithDefaultElements=function(O){O.clear(),GlobalRegistry.defaultElements.copyTo(O)},GlobalRegistry.populateWithDefaultActions=function(O){O.clear(),GlobalRegistry.defaultActions.copyTo(O)},Object.defineProperty(GlobalRegistry,"elements",{get:function(){return GlobalRegistry._elements||(GlobalRegistry._elements=new q,GlobalRegistry.populateWithDefaultElements(GlobalRegistry._elements)),GlobalRegistry._elements},enumerable:!1,configurable:!0}),Object.defineProperty(GlobalRegistry,"actions",{get:function(){return GlobalRegistry._actions||(GlobalRegistry._actions=new q,GlobalRegistry.populateWithDefaultActions(GlobalRegistry._actions)),GlobalRegistry._actions},enumerable:!1,configurable:!0}),GlobalRegistry.reset=function(){GlobalRegistry._elements=void 0,GlobalRegistry._actions=void 0},GlobalRegistry.defaultElements=new q,GlobalRegistry.defaultActions=new q,GlobalRegistry}();B.GlobalRegistry=j},2421:function(O,B,U){"use strict";var G,q=this&&this.__extends||(G=function(O,B){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},G(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}G(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)});Object.defineProperty(B,"__esModule",{value:!0}),B.SerializableObject=B.property=B.SerializableObjectSchema=B.CustomProperty=B.SerializableObjectCollectionProperty=B.SerializableObjectProperty=B.EnumProperty=B.ValueSetProperty=B.StringArrayProperty=B.PixelSizeProperty=B.NumProperty=B.BoolProperty=B.StringProperty=B.PropertyDefinition=B.BaseSerializationContext=B.isVersionLessOrEqual=B.Versions=B.Version=void 0;var j=U(8418),W=U(7794),Y=U(9003),K=U(6758),Q=function(){function Version(O,B,U){void 0===O&&(O=1),void 0===B&&(B=1),this._isValid=!0,this._major=O,this._minor=B,this._label=U}return Version.parse=function(O,B){if(O){var U=new Version;U._versionString=O;var G=/(\d+).(\d+)/gi.exec(O);return null!=G&&3===G.length?(U._major=parseInt(G[1]),U._minor=parseInt(G[2])):U._isValid=!1,U._isValid||B.logParseEvent(void 0,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.invalidVersionString(U._versionString)),U}},Version.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},Version.prototype.toJSON=function(){return this.toString()},Version.prototype.compareTo=function(O){if(!this.isValid||!O.isValid)throw new Error("Cannot compare invalid version.");return this.major>O.major?1:this.major<O.major?-1:this.minor>O.minor?1:this.minor<O.minor?-1:0},Object.defineProperty(Version.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(Version.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(Version.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(Version.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),Version}();B.Version=Q;var Z=function(){function Versions(){}return Versions.getAllDeclaredVersions=function(){var O=Versions,B=[];for(var U in O)if(U.match(/^v[0-9_]*$/))try{var G=O[U];G instanceof Q&&B.push(G)}catch(O){}return B.sort((function(O,B){return O.compareTo(B)}))},Versions.v1_0=new Q(1,0),Versions.v1_1=new Q(1,1),Versions.v1_2=new Q(1,2),Versions.v1_3=new Q(1,3),Versions.v1_4=new Q(1,4),Versions.v1_5=new Q(1,5),Versions.v1_6=new Q(1,6),Versions.latest=Versions.v1_6,Versions}();B.Versions=Z,B.isVersionLessOrEqual=function(O,B){return!(O instanceof Q)||(!(B instanceof Q)||B.compareTo(O)>=0)};var X=function(){function BaseSerializationContext(O){void 0===O&&(O=Z.latest),this._validationEvents=[],this.targetVersion=O}return BaseSerializationContext.prototype.serializeValue=function(O,B,U,G,q){void 0===G&&(G=void 0),void 0===q&&(q=!1),null==U||U===G?j.GlobalSettings.enableFullJsonRoundTrip&&!q||delete O[B]:U===G?delete O[B]:O[B]=U},BaseSerializationContext.prototype.serializeString=function(O,B,U,G){null==U||U===G?j.GlobalSettings.enableFullJsonRoundTrip||delete O[B]:O[B]=U},BaseSerializationContext.prototype.serializeBool=function(O,B,U,G){null==U||U===G?j.GlobalSettings.enableFullJsonRoundTrip||delete O[B]:O[B]=U},BaseSerializationContext.prototype.serializeNumber=function(O,B,U,G){null==U||U===G||isNaN(U)?j.GlobalSettings.enableFullJsonRoundTrip||delete O[B]:O[B]=U},BaseSerializationContext.prototype.serializeEnum=function(O,B,U,G,q){void 0===q&&(q=void 0),null==G||G===q?j.GlobalSettings.enableFullJsonRoundTrip||delete B[U]:B[U]=O[G]},BaseSerializationContext.prototype.serializeArray=function(O,B,U){var G=[];if(U)for(var q=0,j=U;q<j.length;q++){var W=j[q],Y=void 0;void 0!==(Y=W instanceof ue?W.toJSON(this):W.toJSON?W.toJSON():W)&&G.push(Y)}0===G.length?O.hasOwnProperty(B)&&Array.isArray(O[B])&&delete O[B]:this.serializeValue(O,B,G)},BaseSerializationContext.prototype.clearEvents=function(){this._validationEvents=[]},BaseSerializationContext.prototype.logEvent=function(O,B,U,G){this._validationEvents.push({source:O,phase:B,event:U,message:G})},BaseSerializationContext.prototype.logParseEvent=function(O,B,U){this.logEvent(O,Y.ValidationPhase.Parse,B,U)},BaseSerializationContext.prototype.getEventAt=function(O){return this._validationEvents[O]},Object.defineProperty(BaseSerializationContext.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),BaseSerializationContext}();B.BaseSerializationContext=X;var J=function(O){function SimpleSerializationContext(){return null!==O&&O.apply(this,arguments)||this}return q(SimpleSerializationContext,O),SimpleSerializationContext}(X),ee=function(){function PropertyDefinition(O,B,U,G){this.targetVersion=O,this.name=B,this.defaultValue=U,this.onGetInitialValue=G,this.isSerializationEnabled=!0,this.sequentialNumber=PropertyDefinition._sequentialNumber,PropertyDefinition._sequentialNumber++}return PropertyDefinition.prototype.getInternalName=function(){return this.name},PropertyDefinition.prototype.parse=function(O,B,U){return B[this.name]},PropertyDefinition.prototype.toJSON=function(O,B,U,G){G.serializeValue(B,this.name,U,this.defaultValue)},PropertyDefinition._sequentialNumber=0,PropertyDefinition}();B.PropertyDefinition=ee;var te=function(O){function StringProperty(B,U,G,q,j,W){void 0===G&&(G=!0);var Y=O.call(this,B,U,j,W)||this;return Y.targetVersion=B,Y.name=U,Y.treatEmptyAsUndefined=G,Y.regEx=q,Y.defaultValue=j,Y.onGetInitialValue=W,Y}return q(StringProperty,O),StringProperty.prototype.parse=function(O,B,U){var G=W.parseString(B[this.name],this.defaultValue);if(!(void 0===G||""===G&&this.treatEmptyAsUndefined)&&void 0!==this.regEx&&!this.regEx.exec(G))return void U.logParseEvent(O,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.invalidPropertyValue(G,this.name));return G},StringProperty.prototype.toJSON=function(O,B,U,G){G.serializeString(B,this.name,""===U&&this.treatEmptyAsUndefined?void 0:U,this.defaultValue)},StringProperty}(ee);B.StringProperty=te;var ie=function(O){function BoolProperty(B,U,G,q){var j=O.call(this,B,U,G,q)||this;return j.targetVersion=B,j.name=U,j.defaultValue=G,j.onGetInitialValue=q,j}return q(BoolProperty,O),BoolProperty.prototype.parse=function(O,B,U){return W.parseBool(B[this.name],this.defaultValue)},BoolProperty.prototype.toJSON=function(O,B,U,G){G.serializeBool(B,this.name,U,this.defaultValue)},BoolProperty}(ee);B.BoolProperty=ie;var re=function(O){function NumProperty(B,U,G,q){var j=O.call(this,B,U,G,q)||this;return j.targetVersion=B,j.name=U,j.defaultValue=G,j.onGetInitialValue=q,j}return q(NumProperty,O),NumProperty.prototype.parse=function(O,B,U){return W.parseNumber(B[this.name],this.defaultValue)},NumProperty.prototype.toJSON=function(O,B,U,G){G.serializeNumber(B,this.name,U,this.defaultValue)},NumProperty}(ee);B.NumProperty=re;var ne=function(O){function PixelSizeProperty(){return null!==O&&O.apply(this,arguments)||this}return q(PixelSizeProperty,O),PixelSizeProperty.prototype.parse=function(O,B,U){var G=void 0,q=B[this.name];if("string"==typeof q){var W=!1;try{var Q=j.SizeAndUnit.parse(q,!0);Q.unit===Y.SizeUnit.Pixel&&(G=Q.physicalSize,W=!0)}catch(O){}W||U.logParseEvent(O,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.invalidPropertyValue(B[this.name],"minHeight"))}return G},PixelSizeProperty.prototype.toJSON=function(O,B,U,G){G.serializeValue(B,this.name,"number"!=typeof U||isNaN(U)?void 0:U+"px")},PixelSizeProperty}(ee);B.PixelSizeProperty=ne;var oe=function(O){function StringArrayProperty(B,U,G,q){var j=O.call(this,B,U,G,q)||this;return j.targetVersion=B,j.name=U,j.defaultValue=G,j.onGetInitialValue=q,j}return q(StringArrayProperty,O),StringArrayProperty.prototype.parse=function(O,B,U){var G=B[this.name];if(void 0===G||!Array.isArray(G))return this.defaultValue;for(var q=[],j=0,W=G;j<W.length;j++){var K=W[j];"string"==typeof K?q.push(K):U.logParseEvent(O,Y.ValidationEvent.InvalidPropertyValue,'Invalid array value "'.concat(JSON.stringify(K),'" of type "').concat(typeof K,'" ignored for "').concat(this.name,'".'))}return q},StringArrayProperty.prototype.toJSON=function(O,B,U,G){G.serializeArray(B,this.name,U)},StringArrayProperty}(ee);B.StringArrayProperty=oe;var ae=function(O){function ValueSetProperty(B,U,G,q,j){var W=O.call(this,B,U,q,j)||this;return W.targetVersion=B,W.name=U,W.values=G,W.defaultValue=q,W.onGetInitialValue=j,W}return q(ValueSetProperty,O),ValueSetProperty.prototype.isValidValue=function(O,B){for(var U=0,G=this.values;U<G.length;U++){var q=G[U];if(O.toLowerCase()===q.value.toLowerCase())return(q.targetVersion?q.targetVersion:this.targetVersion).compareTo(B.targetVersion)<=0}return!1},ValueSetProperty.prototype.parse=function(O,B,U){var G=B[this.name];if(void 0===G)return this.defaultValue;if("string"==typeof G)for(var q=0,j=this.values;q<j.length;q++){var W=j[q];if(G.toLowerCase()===W.value.toLowerCase()){var Q=W.targetVersion?W.targetVersion:this.targetVersion;return Q.compareTo(U.targetVersion)<=0?W.value:(U.logParseEvent(O,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.propertyValueNotSupported(G,this.name,Q.toString(),U.targetVersion.toString())),this.defaultValue)}}return U.logParseEvent(O,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.invalidPropertyValue(G,this.name)),this.defaultValue},ValueSetProperty.prototype.toJSON=function(O,B,U,G){var q=!1;if(void 0!==U){q=!0;for(var j=0,W=this.values;j<W.length;j++){var Q=W[j];if(Q.value===U){var Z=Q.targetVersion?Q.targetVersion:this.targetVersion;if(Z.compareTo(G.targetVersion)<=0){q=!1;break}G.logEvent(O,Y.ValidationPhase.ToJSON,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.propertyValueNotSupported(U,this.name,Z.toString(),G.targetVersion.toString()))}}}q||G.serializeValue(B,this.name,U,this.defaultValue,!0)},ValueSetProperty}(ee);B.ValueSetProperty=ae;var se=function(O){function EnumProperty(B,U,G,q,j,W){var Y=O.call(this,B,U,q,W)||this;if(Y.targetVersion=B,Y.name=U,Y.enumType=G,Y.defaultValue=q,Y.onGetInitialValue=W,Y._values=[],j)Y._values=j;else for(var K in G){var Q=parseInt(K,10);Q>=0&&Y._values.push({value:Q})}return Y}return q(EnumProperty,O),EnumProperty.prototype.parse=function(O,B,U){var G=B[this.name];if("string"!=typeof G)return this.defaultValue;var q=W.getEnumValueByName(this.enumType,G);if(void 0!==q)for(var j=0,Q=this.values;j<Q.length;j++){var Z=Q[j];if(Z.value===q){var X=Z.targetVersion?Z.targetVersion:this.targetVersion;return X.compareTo(U.targetVersion)<=0?q:(U.logParseEvent(O,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.propertyValueNotSupported(G,this.name,X.toString(),U.targetVersion.toString())),this.defaultValue)}}return U.logParseEvent(O,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.invalidPropertyValue(G,this.name)),this.defaultValue},EnumProperty.prototype.toJSON=function(O,B,U,G){var q=!1;if(void 0!==U){q=!0;for(var j=0,W=this.values;j<W.length;j++){var Q=W[j];if(Q.value===U){if((Q.targetVersion?Q.targetVersion:this.targetVersion).compareTo(G.targetVersion)<=0){q=!1;break}G.logEvent(O,Y.ValidationPhase.ToJSON,Y.ValidationEvent.InvalidPropertyValue,K.Strings.errors.invalidPropertyValue(U,this.name))}}}q||G.serializeEnum(this.enumType,B,this.name,U,this.defaultValue)},Object.defineProperty(EnumProperty.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),EnumProperty}(ee);B.EnumProperty=se;var le=function(O){function SerializableObjectProperty(B,U,G,q,j){void 0===q&&(q=!1);var W=O.call(this,B,U,j,(function(O){return W.nullable?void 0:new W.objectType}))||this;return W.targetVersion=B,W.name=U,W.objectType=G,W.nullable=q,W}return q(SerializableObjectProperty,O),SerializableObjectProperty.prototype.parse=function(O,B,U){var G=B[this.name];if(void 0===G)return this.onGetInitialValue?this.onGetInitialValue(O):this.defaultValue;var q=new this.objectType;return q.parse(G,U),q},SerializableObjectProperty.prototype.toJSON=function(O,B,U,G){var q=void 0;void 0===U||U.hasAllDefaultValues()||(q=U.toJSON(G)),"object"==typeof q&&0===Object.keys(q).length&&(q=void 0),G.serializeValue(B,this.name,q,this.defaultValue,!0)},SerializableObjectProperty}(ee);B.SerializableObjectProperty=le;var ce=function(O){function SerializableObjectCollectionProperty(B,U,G,q){var j=O.call(this,B,U,void 0,(function(O){return[]}))||this;return j.targetVersion=B,j.name=U,j.objectType=G,j.onItemAdded=q,j}return q(SerializableObjectCollectionProperty,O),SerializableObjectCollectionProperty.prototype.parse=function(O,B,U){var G=[],q=B[this.name];if(Array.isArray(q))for(var j=0,W=q;j<W.length;j++){var Y=W[j],K=new this.objectType;K.parse(Y,U),G.push(K),this.onItemAdded&&this.onItemAdded(O,K)}return G.length>0?G:this.onGetInitialValue?this.onGetInitialValue(O):void 0},SerializableObjectCollectionProperty.prototype.toJSON=function(O,B,U,G){G.serializeArray(B,this.name,U)},SerializableObjectCollectionProperty}(ee);B.SerializableObjectCollectionProperty=ce;var de=function(O){function CustomProperty(B,U,G,q,j,W){var Y=O.call(this,B,U,j,W)||this;if(Y.targetVersion=B,Y.name=U,Y.onParse=G,Y.onToJSON=q,Y.defaultValue=j,Y.onGetInitialValue=W,!Y.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!Y.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return Y}return q(CustomProperty,O),CustomProperty.prototype.parse=function(O,B,U){return this.onParse(O,this,B,U)},CustomProperty.prototype.toJSON=function(O,B,U,G){this.onToJSON(O,this,B,U,G)},CustomProperty}(ee);B.CustomProperty=de;var pe=function(){function SerializableObjectSchema(){this._properties=[]}return SerializableObjectSchema.prototype.indexOf=function(O){for(var B=0;B<this._properties.length;B++)if(this._properties[B]===O)return B;return-1},SerializableObjectSchema.prototype.add=function(){for(var O=[],B=0;B<arguments.length;B++)O[B]=arguments[B];for(var U=0,G=O;U<G.length;U++){var q=G[U];-1===this.indexOf(q)&&this._properties.push(q)}},SerializableObjectSchema.prototype.remove=function(){for(var O=[],B=0;B<arguments.length;B++)O[B]=arguments[B];for(var U=0,G=O;U<G.length;U++)for(var q=G[U];;){var j=this.indexOf(q);if(!(j>=0))break;this._properties.splice(j,1)}},SerializableObjectSchema.prototype.getItemAt=function(O){return this._properties[O]},SerializableObjectSchema.prototype.getCount=function(){return this._properties.length},SerializableObjectSchema}();B.SerializableObjectSchema=pe,B.property=function(O){return function(B,U){var G=Object.getOwnPropertyDescriptor(B,U)||{};G.get||G.set||(G.get=function(){return this.getValue(O)},G.set=function(B){this.setValue(O,B)},Object.defineProperty(B,U,G))}};var ue=function(){function SerializableObject(){this._propertyBag={},this._rawProperties={},this.maxVersion=SerializableObject.defaultMaxVersion;for(var O=this.getSchema(),B=0;B<O.getCount();B++){var U=O.getItemAt(B);U.onGetInitialValue&&this.setValue(U,U.onGetInitialValue(this))}}return SerializableObject.prototype.getDefaultSerializationContext=function(){return new J},SerializableObject.prototype.populateSchema=function(O){var B=this.constructor,U=[];for(var G in B)try{var q=B[G];q instanceof ee&&U.push(q)}catch(O){}if(U.length>0){var j=U.sort((function(O,B){return O.sequentialNumber>B.sequentialNumber?1:O.sequentialNumber<B.sequentialNumber?-1:0}));O.add.apply(O,j)}SerializableObject.onRegisterCustomProperties&&SerializableObject.onRegisterCustomProperties(this,O)},SerializableObject.prototype.getValue=function(O){return this._propertyBag.hasOwnProperty(O.getInternalName())?this._propertyBag[O.getInternalName()]:O.defaultValue},SerializableObject.prototype.setValue=function(O,B){null==B?delete this._propertyBag[O.getInternalName()]:this._propertyBag[O.getInternalName()]=B},SerializableObject.prototype.internalParse=function(O,B){if(this._propertyBag={},this._rawProperties=j.GlobalSettings.enableFullJsonRoundTrip&&O||{},O)for(var U=this.getSchema(),G=0;G<U.getCount();G++){var q=U.getItemAt(G);if(q.isSerializationEnabled){var W=q.onGetInitialValue?q.onGetInitialValue(this):void 0;O.hasOwnProperty(q.name)&&(q.targetVersion.compareTo(B.targetVersion)<=0?W=q.parse(this,O,B):B.logParseEvent(this,Y.ValidationEvent.UnsupportedProperty,K.Strings.errors.propertyNotSupported(q.name,q.targetVersion.toString(),B.targetVersion.toString()))),this.setValue(q,W)}}else this.resetDefaultValues()},SerializableObject.prototype.internalToJSON=function(O,B){for(var U=this.getSchema(),G=[],q=0;q<U.getCount();q++){var j=U.getItemAt(q);j.isSerializationEnabled&&j.targetVersion.compareTo(B.targetVersion)<=0&&-1===G.indexOf(j.name)&&(j.toJSON(this,O,this.getValue(j),B),G.push(j.name))}},SerializableObject.prototype.shouldSerialize=function(O){return!0},SerializableObject.prototype.parse=function(O,B){this.internalParse(O,B||new J)},SerializableObject.prototype.toJSON=function(O){var B;if(O&&O instanceof X?B=O:(B=this.getDefaultSerializationContext()).toJSONOriginalParam=O,this.shouldSerialize(B)){var U=void 0;return U=j.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(U,B),U}},SerializableObject.prototype.hasDefaultValue=function(O){return this.getValue(O)===O.defaultValue},SerializableObject.prototype.hasAllDefaultValues=function(){for(var O=this.getSchema(),B=0;B<O.getCount();B++){var U=O.getItemAt(B);if(!this.hasDefaultValue(U))return!1}return!0},SerializableObject.prototype.resetDefaultValues=function(){for(var O=this.getSchema(),B=0;B<O.getCount();B++){var U=O.getItemAt(B);this.setValue(U,U.defaultValue)}},SerializableObject.prototype.setCustomProperty=function(O,B){"string"==typeof B&&!B||null==B?delete this._rawProperties[O]:this._rawProperties[O]=B},SerializableObject.prototype.getCustomProperty=function(O){return this._rawProperties[O]},SerializableObject.prototype.getSchema=function(){var O=SerializableObject._schemaCache[this.getSchemaKey()];return O||(O=new pe,this.populateSchema(O),SerializableObject._schemaCache[this.getSchemaKey()]=O),O},SerializableObject.defaultMaxVersion=Z.latest,SerializableObject._schemaCache={},SerializableObject}();B.SerializableObject=ue},8418:(O,B,U)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.UUID=B.SizeAndUnit=B.PaddingDefinition=B.SpacingDefinition=B.StringWithSubstitutions=B.ContentTypes=B.GlobalSettings=void 0;var G=U(9003),q=function(){function GlobalSettings(){}return GlobalSettings.useAdvancedTextBlockTruncation=!0,GlobalSettings.useAdvancedCardBottomTruncation=!1,GlobalSettings.useMarkdownInRadioButtonAndCheckbox=!0,GlobalSettings.allowMarkForTextHighlighting=!1,GlobalSettings.alwaysBleedSeparators=!1,GlobalSettings.enableFullJsonRoundTrip=!1,GlobalSettings.displayInputValidationErrors=!0,GlobalSettings.allowPreProcessingPropertyValues=!1,GlobalSettings.setTabIndexAtCardRoot=!0,GlobalSettings.enableFallback=!0,GlobalSettings.useWebkitLineClamp=!0,GlobalSettings.allowMoreThanMaxActionsInOverflowMenu=!1,GlobalSettings.removePaddingFromContainersWithBackgroundImage=!1,GlobalSettings.resetInputsDirtyStateAfterActionExecution=!0,GlobalSettings.applets={logEnabled:!0,logLevel:G.LogLevel.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:G.RefreshMode.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:!0}},GlobalSettings}();B.GlobalSettings=q,B.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var j=function(){function StringWithSubstitutions(){this._isProcessed=!1}return StringWithSubstitutions.prototype.getReferencedInputs=function(O,B){if(!B)throw new Error("The referencedInputs parameter cannot be null.");if(this._original)for(var U=0,G=O;U<G.length;U++){var q=G[U];null!=new RegExp("\\{{2}("+q.id+").value\\}{2}","gi").exec(this._original)&&q.id&&(B[q.id]=q)}},StringWithSubstitutions.prototype.substituteInputValues=function(O,U){if(this._processed=this._original,this._original)for(var G=/\{{2}([a-z0-9_$@]+).value\}{2}/gi,q=void 0;null!==(q=G.exec(this._original))&&this._processed;)for(var j=0,W=Object.keys(O);j<W.length;j++){var Y=W[j];if(Y.toLowerCase()===q[1].toLowerCase()){var K=O[Y],Q="";K.value&&(Q=K.value),U===B.ContentTypes.applicationJson?Q=(Q=JSON.stringify(Q)).slice(1,-1):U===B.ContentTypes.applicationXWwwFormUrlencoded&&(Q=encodeURIComponent(Q)),this._processed=this._processed.replace(q[0],Q);break}}this._isProcessed=!0},StringWithSubstitutions.prototype.getOriginal=function(){return this._original},StringWithSubstitutions.prototype.get=function(){return this._isProcessed?this._processed:this._original},StringWithSubstitutions.prototype.set=function(O){this._original=O,this._isProcessed=!1},StringWithSubstitutions}();B.StringWithSubstitutions=j;var SpacingDefinition=function(O,B,U,G){void 0===O&&(O=0),void 0===B&&(B=0),void 0===U&&(U=0),void 0===G&&(G=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=O,this.right=B,this.bottom=U,this.left=G};B.SpacingDefinition=SpacingDefinition;var PaddingDefinition=function(O,B,U,q){void 0===O&&(O=G.Spacing.None),void 0===B&&(B=G.Spacing.None),void 0===U&&(U=G.Spacing.None),void 0===q&&(q=G.Spacing.None),this.top=G.Spacing.None,this.right=G.Spacing.None,this.bottom=G.Spacing.None,this.left=G.Spacing.None,this.top=O,this.right=B,this.bottom=U,this.left=q};B.PaddingDefinition=PaddingDefinition;var W=function(){function SizeAndUnit(O,B){this.physicalSize=O,this.unit=B}return SizeAndUnit.parse=function(O,B){void 0===B&&(B=!1);var U=new SizeAndUnit(0,G.SizeUnit.Weight);if("number"==typeof O)return U.physicalSize=O,U;if("string"==typeof O){var q=/^([0-9]+)(px|\*)?$/g.exec(O),j=B?3:2;if(q&&q.length>=j)return U.physicalSize=parseInt(q[1]),3===q.length&&"px"===q[2]&&(U.unit=G.SizeUnit.Pixel),U}throw new Error("Invalid size: "+O)},SizeAndUnit}();B.SizeAndUnit=W;var Y=function(){function UUID(){}return UUID.generate=function(){var O=4294967295*Math.random()|0,B=4294967295*Math.random()|0,U=4294967295*Math.random()|0,G=4294967295*Math.random()|0;return UUID.lut[255&O]+UUID.lut[O>>8&255]+UUID.lut[O>>16&255]+UUID.lut[O>>24&255]+"-"+UUID.lut[255&B]+UUID.lut[B>>8&255]+"-"+UUID.lut[B>>16&15|64]+UUID.lut[B>>24&255]+"-"+UUID.lut[63&U|128]+UUID.lut[U>>8&255]+"-"+UUID.lut[U>>16&255]+UUID.lut[U>>24&255]+UUID.lut[255&G]+UUID.lut[G>>8&255]+UUID.lut[G>>16&255]+UUID.lut[G>>24&255]},UUID.initialize=function(){for(var O=0;O<256;O++)UUID.lut[O]=(O<16?"0":"")+O.toString(16)},UUID.lut=[],UUID}();B.UUID=Y,Y.initialize()},6758:(O,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.Strings=void 0;var U=function(){function Strings(){}return Strings.errors={unknownElementType:function(O){return'Unknown element type "'.concat(O,'". Fallback will be used if present.')},unknownActionType:function(O){return'Unknown action type "'.concat(O,'". Fallback will be used if present.')},elementTypeNotAllowed:function(O){return'Element type "'.concat(O,'" is not allowed in this context.')},actionTypeNotAllowed:function(O){return'Action type "'.concat(O,'" is not allowed in this context.')},invalidPropertyValue:function(O,B){return'Invalid value "'.concat(O,'" for property "').concat(B,'".')},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(O){return'Invalid column width "'.concat(O,'" - defaulting to "auto".')},invalidCardVersion:function(O){return'Invalid card version. Defaulting to "'.concat(O,'".')},invalidVersionString:function(O){return'Invalid version string "'.concat(O,'".')},propertyValueNotSupported:function(O,B,U,G){return'Value "'.concat(O,'" for property "').concat(B,'" is supported in version ').concat(U,", but you are using version ").concat(G,".")},propertyNotSupported:function(O,B,U){return'Property "'.concat(O,'" is supported in version ').concat(B,", but you are using version ").concat(U,".")},indexOutOfRange:function(O){return"Index out of range (".concat(O,").")},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(O){return'Property "'.concat(O,'" must be set.')},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(O){return"Maximum number of actions exceeded (".concat(O,").")},tooLittleTimeDelay:function(O){return"Autoplay Delay is too short (".concat(O,").")},tooManyCarouselPages:function(O){return"Maximum number of Carousel pages exceeded (".concat(O,").")},invalidInitialPageIndex:function(O){return"InitialPage for carousel is invalid (".concat(O,").")},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(O,B){return"The specified card version (".concat(O,") is not supported or still in preview. The latest released card version is ").concat(B,".")},duplicateId:function(O){return'Duplicate Id "'.concat(O,'".')},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},processMarkdownEventRemoved:function(){return"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead."},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(O){return"Elements of type ".concat(O," cannot be used as standalone elements.")}},Strings.magicCodeInputCard={tryAgain:function(){return"That didn't work... let's try again."},pleaseLogin:function(){return'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"'},enterMagicCode:function(){return"Enter magic code"},pleaseEnterMagicCodeYouReceived:function(){return"Please enter the magic code you received."},submit:function(){return"Submit"},cancel:function(){return"Cancel"},somethingWentWrong:function(){return"Something went wrong. This action can't be handled."},authenticationFailed:function(){return"Authentication failed."}},Strings.runtime={automaticRefreshPaused:function(){return"Automatic refresh paused."},clckToRestartAutomaticRefresh:function(){return"Click to restart."},refreshThisCard:function(){return"Refresh this card"}},Strings.hints={dontUseWeightedAndStrecthedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},Strings.defaults={inlineActionTitle:function(){return"Inline Action"},overflowButtonText:function(){return"..."},overflowButtonTooltip:function(){return"More options"},mediaPlayerAriaLabel:function(){return"Media content"},mediaPlayerPlayMedia:function(){return"Play media"},youTubeVideoPlayer:function(){return"YouTube video player"},vimeoVideoPlayer:function(){return"Vimeo video player"},dailymotionVideoPlayer:function(){return"Dailymotion video player"}},Strings}();B.Strings=U},6629:function(O,B,U){"use strict";var G,q=this&&this.__extends||(G=function(O,B){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},G(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}G(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)}),j=this&&this.__decorate||function(O,B,U,G){var q,j=arguments.length,W=j<3?B:null===G?G=Object.getOwnPropertyDescriptor(B,U):G;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(O,B,U,G);else for(var Y=O.length-1;Y>=0;Y--)(q=O[Y])&&(W=(j<3?q(W):j>3?q(B,U,W):q(B,U))||W);return j>3&&W&&Object.defineProperty(B,U,W),W};Object.defineProperty(B,"__esModule",{value:!0}),B.Table=B.TableRow=B.TableCell=B.StylableContainer=B.TableColumnDefinition=void 0;var W=U(7191),Y=U(9003),K=U(9301),Q=U(2421),Z=U(8418),X=U(6758),J=U(7794),ee=function(O){function TableColumnDefinition(){var B=null!==O&&O.apply(this,arguments)||this;return B.width=new Z.SizeAndUnit(1,Y.SizeUnit.Weight),B}return q(TableColumnDefinition,O),TableColumnDefinition.prototype.getSchemaKey=function(){return"ColumnDefinition"},TableColumnDefinition.horizontalCellContentAlignmentProperty=new Q.EnumProperty(Q.Versions.v1_5,"horizontalCellContentAlignment",Y.HorizontalAlignment),TableColumnDefinition.verticalCellContentAlignmentProperty=new Q.EnumProperty(Q.Versions.v1_5,"verticalCellContentAlignment",Y.VerticalAlignment),TableColumnDefinition.widthProperty=new Q.CustomProperty(Q.Versions.v1_5,"width",(function(O,B,U,G){var q=B.defaultValue,j=U[B.name],W=!1;if("number"!=typeof j||isNaN(j))if("string"==typeof j)try{q=Z.SizeAndUnit.parse(j)}catch(O){W=!0}else W=!0;else q=new Z.SizeAndUnit(j,Y.SizeUnit.Weight);return W&&G.logParseEvent(O,Y.ValidationEvent.InvalidPropertyValue,X.Strings.errors.invalidColumnWidth(j)),q}),(function(O,B,U,G,q){G.unit===Y.SizeUnit.Pixel?q.serializeValue(U,"width",G.physicalSize+"px"):q.serializeNumber(U,"width",G.physicalSize)}),new Z.SizeAndUnit(1,Y.SizeUnit.Weight)),j([(0,Q.property)(TableColumnDefinition.horizontalCellContentAlignmentProperty)],TableColumnDefinition.prototype,"horizontalCellContentAlignment",void 0),j([(0,Q.property)(TableColumnDefinition.verticalCellContentAlignmentProperty)],TableColumnDefinition.prototype,"verticalCellContentAlignment",void 0),j([(0,Q.property)(TableColumnDefinition.widthProperty)],TableColumnDefinition.prototype,"width",void 0),TableColumnDefinition}(Q.SerializableObject);B.TableColumnDefinition=ee;var te=function(O){function StylableContainer(){var B=null!==O&&O.apply(this,arguments)||this;return B._items=[],B}return q(StylableContainer,O),StylableContainer.prototype.parseItem=function(O,B){var U=this;return B.parseCardObject(this,O,[],!this.isDesignMode(),(function(O){return U.createItemInstance(O)}),(function(O,U){B.logParseEvent(void 0,Y.ValidationEvent.ElementTypeNotAllowed,X.Strings.errors.elementTypeNotAllowed(O))}))},StylableContainer.prototype.internalAddItem=function(O){if(O.parent)throw new Error(X.Strings.errors.elementAlreadyParented());this._items.push(O),O.setParent(this)},StylableContainer.prototype.internalRemoveItem=function(O){var B=this._items.indexOf(O);return B>=0&&(this._items.splice(B,1),O.setParent(void 0),this.updateLayout(),!0)},StylableContainer.prototype.internalIndexOf=function(O){return this._items.indexOf(O)},StylableContainer.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U),this._items=[];var G=B[this.getCollectionPropertyName()];if(Array.isArray(G))for(var q=0,j=G;q<j.length;q++){var W=j[q],Y=this.parseItem(W,U);Y&&this._items.push(Y)}},StylableContainer.prototype.internalToJSON=function(B,U){O.prototype.internalToJSON.call(this,B,U),U.serializeArray(B,this.getCollectionPropertyName(),this._items)},StylableContainer.prototype.removeItem=function(O){return this.internalRemoveItem(O)},StylableContainer.prototype.getItemCount=function(){return this._items.length},StylableContainer.prototype.getItemAt=function(O){return this._items[O]},StylableContainer.prototype.getFirstVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(0):void 0},StylableContainer.prototype.getLastVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(this.getItemCount()-1):void 0},StylableContainer}(W.StylableCardElementContainer);B.StylableContainer=te;var ie=function(O){function TableCell(){var B=null!==O&&O.apply(this,arguments)||this;return B._columnIndex=-1,B._cellType="data",B}return q(TableCell,O),TableCell.prototype.getHasBorder=function(){return this.parentRow.parentTable.showGridLines},TableCell.prototype.applyBorder=function(){if(this.renderedElement&&this.getHasBorder()){var O=this.hostConfig.containerStyles.getStyleByName(this.parentRow.parentTable.gridStyle);if(O.borderColor){var B=(0,J.stringToCssColor)(O.borderColor);B&&(this.renderedElement.style.borderRight="1px solid "+B,this.renderedElement.style.borderBottom="1px solid "+B)}}},TableCell.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new Z.PaddingDefinition(Y.Spacing.Small,Y.Spacing.Small,Y.Spacing.Small,Y.Spacing.Small):O.prototype.getDefaultPadding.call(this)},TableCell.prototype.internalRender=function(){var B=O.prototype.internalRender.call(this);return B&&(B.setAttribute("role","data"===this.cellType?"cell":"columnheader"),B.style.minWidth="0","header"===this.cellType&&B.setAttribute("scope","col")),B},TableCell.prototype.shouldSerialize=function(O){return!0},TableCell.prototype.getJsonTypeName=function(){return"TableCell"},TableCell.prototype.getEffectiveTextStyleDefinition=function(){return"header"===this.cellType?this.hostConfig.textStyles.columnHeader:O.prototype.getEffectiveTextStyleDefinition.call(this)},TableCell.prototype.getEffectiveHorizontalAlignment=function(){if(void 0!==this.horizontalAlignment)return this.horizontalAlignment;if(void 0!==this.parentRow.horizontalCellContentAlignment)return this.parentRow.horizontalCellContentAlignment;if(this.columnIndex>=0){var B=this.parentRow.parentTable.getColumnAt(this.columnIndex).horizontalCellContentAlignment;if(void 0!==B)return B}return void 0!==this.parentRow.parentTable.horizontalCellContentAlignment?this.parentRow.parentTable.horizontalCellContentAlignment:O.prototype.getEffectiveHorizontalAlignment.call(this)},TableCell.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;if(void 0!==this.parentRow.verticalCellContentAlignment)return this.parentRow.verticalCellContentAlignment;if(this.columnIndex>=0){var B=this.parentRow.parentTable.getColumnAt(this.columnIndex).verticalCellContentAlignment;if(void 0!==B)return B}return void 0!==this.parentRow.parentTable.verticalCellContentAlignment?this.parentRow.parentTable.verticalCellContentAlignment:O.prototype.getEffectiveVerticalContentAlignment.call(this)},Object.defineProperty(TableCell.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(TableCell.prototype,"cellType",{get:function(){return this._cellType},enumerable:!1,configurable:!0}),Object.defineProperty(TableCell.prototype,"parentRow",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(TableCell.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),TableCell}(W.Container);B.TableCell=ie;var re=function(O){function TableRow(){return null!==O&&O.apply(this,arguments)||this}return q(TableRow,O),TableRow.prototype.getDefaultPadding=function(){return new Z.PaddingDefinition(Y.Spacing.None,Y.Spacing.None,Y.Spacing.None,Y.Spacing.None)},TableRow.prototype.applyBackground=function(){if(this.renderedElement){var O=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(O.backgroundColor){var B=(0,J.stringToCssColor)(O.backgroundColor);B&&(this.renderedElement.style.backgroundColor=B)}}},TableRow.prototype.getCollectionPropertyName=function(){return"cells"},TableRow.prototype.createItemInstance=function(O){return O&&"TableCell"!==O?void 0:new ie},TableRow.prototype.internalRender=function(){var O=this.getIsFirstRow(),B=this.hostConfig.table.cellSpacing,U=document.createElement("div");U.setAttribute("role","row"),U.style.display="flex",U.style.flexDirection="row";for(var G=0;G<Math.min(this.getItemCount(),this.parentTable.getColumnCount());G++){var q=this.getItemAt(G);q._columnIndex=G,q._cellType=this.parentTable.firstRowAsHeaders&&O?"header":"data";var j=q.render();if(j){var W=this.parentTable.getColumnAt(G);W.computedWidth.unit===Y.SizeUnit.Pixel?j.style.flex="0 0 "+W.computedWidth.physicalSize+"px":j.style.flex="1 1 "+W.computedWidth.physicalSize+"%",G>0&&!this.parentTable.showGridLines&&B>0&&(j.style.marginLeft=B+"px"),U.appendChild(j)}}return U.children.length>0?U:void 0},TableRow.prototype.shouldSerialize=function(O){return!0},TableRow.prototype.addCell=function(O){this.internalAddItem(O)},TableRow.prototype.removeCellAt=function(O){return O>=0&&O<this.getItemCount()&&this.removeItem(this.getItemAt(O))},TableRow.prototype.indexOf=function(O){return O instanceof ie?this.internalIndexOf(O):-1},TableRow.prototype.ensureHasEnoughCells=function(O){for(;this.getItemCount()<O;)this.addCell(new ie)},TableRow.prototype.getJsonTypeName=function(){return"TableRow"},TableRow.prototype.getIsFirstRow=function(){return this.parentTable.getItemAt(0)===this},Object.defineProperty(TableRow.prototype,"parentTable",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(TableRow.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),TableRow.styleProperty=new W.ContainerStyleProperty(Q.Versions.v1_5,"style"),TableRow.horizontalCellContentAlignmentProperty=new Q.EnumProperty(Q.Versions.v1_5,"horizontalCellContentAlignment",Y.HorizontalAlignment),TableRow.verticalCellContentAlignmentProperty=new Q.EnumProperty(Q.Versions.v1_5,"verticalCellContentAlignment",Y.VerticalAlignment),j([(0,Q.property)(TableRow.horizontalCellContentAlignmentProperty)],TableRow.prototype,"horizontalCellContentAlignment",void 0),j([(0,Q.property)(TableRow.verticalCellContentAlignmentProperty)],TableRow.prototype,"verticalCellContentAlignment",void 0),TableRow}(te);B.TableRow=re;var ne=function(O){function Table(){var B=null!==O&&O.apply(this,arguments)||this;return B._columns=[],B.firstRowAsHeaders=!0,B.showGridLines=!0,B}return q(Table,O),Object.defineProperty(Table.prototype,"gridStyle",{get:function(){var O=this.getValue(Table.gridStyleProperty);if(O&&this.hostConfig.containerStyles.getStyleByName(O))return O},set:function(O){this.setValue(Table.gridStyleProperty,O)},enumerable:!1,configurable:!0}),Table.prototype.ensureRowsHaveEnoughCells=function(){for(var O=0;O<this.getItemCount();O++)this.getItemAt(O).ensureHasEnoughCells(this.getColumnCount())},Table.prototype.removeCellsFromColumn=function(O){for(var B=0;B<this.getItemCount();B++)this.getItemAt(B).removeCellAt(O)},Table.prototype.getCollectionPropertyName=function(){return"rows"},Table.prototype.createItemInstance=function(O){return O&&"TableRow"!==O?void 0:new re},Table.prototype.internalParse=function(B,U){O.prototype.internalParse.call(this,B,U),this.ensureRowsHaveEnoughCells()},Table.prototype.internalRender=function(){if(this.getItemCount()>0){for(var O=0,B=0,U=this._columns;B<U.length;B++){(j=U[B]).width.unit===Y.SizeUnit.Weight&&(O+=j.width.physicalSize)}for(var G=0,q=this._columns;G<q.length;G++){var j;(j=q[G]).width.unit===Y.SizeUnit.Pixel?j.computedWidth=new Z.SizeAndUnit(j.width.physicalSize,Y.SizeUnit.Pixel):j.computedWidth=new Z.SizeAndUnit(100/O*j.width.physicalSize,Y.SizeUnit.Weight)}var W=document.createElement("div");if(W.setAttribute("role","table"),W.style.display="flex",W.style.flexDirection="column",this.showGridLines){var K=this.hostConfig.containerStyles.getStyleByName(this.gridStyle);if(K.borderColor){var Q=(0,J.stringToCssColor)(K.borderColor);Q&&(W.style.borderTop="1px solid "+Q,W.style.borderLeft="1px solid "+Q)}}for(var X=this.hostConfig.table.cellSpacing,ee=0;ee<this.getItemCount();ee++){var te=this.getItemAt(ee).render();if(te){if(ee>0&&!this.showGridLines&&X>0){var ie=document.createElement("div");ie.setAttribute("aria-hidden","true"),ie.style.height=X+"px",W.appendChild(ie)}W.appendChild(te)}}return W}},Table.prototype.addColumn=function(O){this._columns.push(O),this.ensureRowsHaveEnoughCells()},Table.prototype.removeColumn=function(O){var B=this._columns.indexOf(O);B>=0&&(this.removeCellsFromColumn(B),this._columns.splice(B,1))},Table.prototype.getColumnCount=function(){return this._columns.length},Table.prototype.getColumnAt=function(O){return this._columns[O]},Table.prototype.addRow=function(O){this.internalAddItem(O),O.ensureHasEnoughCells(this.getColumnCount())},Table.prototype.indexOf=function(O){return O instanceof re?this.internalIndexOf(O):-1},Table.prototype.getJsonTypeName=function(){return"Table"},Table._columnsProperty=new Q.SerializableObjectCollectionProperty(Q.Versions.v1_5,"columns",ee),Table.firstRowAsHeadersProperty=new Q.BoolProperty(Q.Versions.v1_5,"firstRowAsHeaders",!0),Table.showGridLinesProperty=new Q.BoolProperty(Q.Versions.v1_5,"showGridLines",!0),Table.gridStyleProperty=new W.ContainerStyleProperty(Q.Versions.v1_5,"gridStyle"),Table.horizontalCellContentAlignmentProperty=new Q.EnumProperty(Q.Versions.v1_5,"horizontalCellContentAlignment",Y.HorizontalAlignment),Table.verticalCellContentAlignmentProperty=new Q.EnumProperty(Q.Versions.v1_5,"verticalCellContentAlignment",Y.VerticalAlignment),j([(0,Q.property)(Table._columnsProperty)],Table.prototype,"_columns",void 0),j([(0,Q.property)(Table.firstRowAsHeadersProperty)],Table.prototype,"firstRowAsHeaders",void 0),j([(0,Q.property)(Table.showGridLinesProperty)],Table.prototype,"showGridLines",void 0),j([(0,Q.property)(Table.gridStyleProperty)],Table.prototype,"gridStyle",null),j([(0,Q.property)(Table.horizontalCellContentAlignmentProperty)],Table.prototype,"horizontalCellContentAlignment",void 0),j([(0,Q.property)(Table.verticalCellContentAlignmentProperty)],Table.prototype,"verticalCellContentAlignment",void 0),Table}(te);B.Table=ne,K.GlobalRegistry.defaultElements.register("Table",ne,Q.Versions.v1_5)},9514:function(O,B){"use strict";var U,G=this&&this.__extends||(U=function(O,B){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)Object.prototype.hasOwnProperty.call(B,U)&&(O[U]=B[U])},U(O,B)},function(O,B){if("function"!=typeof B&&null!==B)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function __(){this.constructor=O}U(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)});Object.defineProperty(B,"__esModule",{value:!0}),B.formatText=void 0;var q=function(){function AbstractTextFormatter(O){this._regularExpression=O}return AbstractTextFormatter.prototype.format=function(O,B){var U;if(B){for(var G=B;null!=(U=this._regularExpression.exec(B));)G=G.replace(U[0],this.internalFormat(O,U));return G}return B},AbstractTextFormatter}(),j=function(O){function DateFormatter(){return null!==O&&O.apply(this,arguments)||this}return G(DateFormatter,O),DateFormatter.prototype.internalFormat=function(O,B){var U=new Date(Date.parse(B[1])),G=void 0!==B[2]?B[2].toLowerCase():"compact";return"compact"!==G?U.toLocaleDateString(O,{day:"numeric",weekday:G,month:G,year:"numeric"}):U.toLocaleDateString()},DateFormatter}(q),W=function(O){function TimeFormatter(){return null!==O&&O.apply(this,arguments)||this}return G(TimeFormatter,O),TimeFormatter.prototype.internalFormat=function(O,B){return new Date(Date.parse(B[1])).toLocaleTimeString(O,{hour:"numeric",minute:"2-digit"})},TimeFormatter}(q);B.formatText=function(O,B){for(var U=B,G=0,q=[new j(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new W(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];G<q.length;G++){U=q[G].format(O,U)}return U}},7794:(O,B,U)=>{"use strict";var G;Object.defineProperty(B,"__esModule",{value:!0}),B.addCancelSelectActionEventHandler=B.clearElementChildren=B.getScrollY=B.getScrollX=B.getFitStatus=B.truncate=B.truncateText=B.stringToCssColor=B.parseEnum=B.getEnumValueByName=B.parseBool=B.parseNumber=B.parseString=B.appendChild=B.generateUniqueId=B.isMobileOS=B.isInternetExplorer=void 0;var q=U(9003),j=U(8418);function getEnumValueByName(O,B){for(var U in O){var G=parseInt(U,10);if(G>=0){var q=O[U];if(q&&"string"==typeof q&&q.toLowerCase()===B.toLowerCase())return G}}}function truncateWorker(O,B,U,G,q){var fits=function(){return B-O.scrollHeight>=-1};if(!fits()){for(var j=function(O){var B=[],U=findNextCharacter(O,-1);for(;U<O.length;)" "===O[U]&&B.push(U),U=findNextCharacter(O,U);return B}(U),W=0,Y=j.length,K=0;W<Y;){var Q=Math.floor((W+Y)/2);G(U,j[Q]),fits()?(K=j[Q],W=Q+1):Y=Q}if(G(U,K),q&&B-O.scrollHeight>=q-1){for(var Z=findNextCharacter(U,K);Z<U.length&&(G(U,Z),fits());)K=Z,Z=findNextCharacter(U,Z);G(U,K)}}}B.isInternetExplorer=function(){return void 0!==window.document.documentMode},B.isMobileOS=function(){var O=window.navigator.userAgent;return!!O.match(/Android/i)||!!O.match(/iPad/i)||!!O.match(/iPhone/i)},B.generateUniqueId=function(){return"__ac-"+j.UUID.generate()},B.appendChild=function(O,B){B&&O.appendChild(B)},B.parseString=function(O,B){return"string"==typeof O?O:B},B.parseNumber=function(O,B){return"number"==typeof O?O:B},B.parseBool=function(O,B){if("boolean"==typeof O)return O;if("string"==typeof O)switch(O.toLowerCase()){case"true":return!0;case"false":return!1;default:return B}return B},B.getEnumValueByName=getEnumValueByName,B.parseEnum=function(O,B,U){if(!B)return U;var G=getEnumValueByName(O,B);return void 0!==G?G:U},B.stringToCssColor=function(O){if(O){var B=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(O);if(B&&B[4]){var U=parseInt(B[1],16)/255;return"rgba("+parseInt(B[2],16)+","+parseInt(B[3],16)+","+parseInt(B[4],16)+","+U+")"}}return O},B.truncateText=function(O,B,U){truncateWorker(O,B,O.innerText,(function(B,U){O.innerText=B.substring(0,U)+"..."}),U)};var W="undefined"==typeof window||null===(G=window.trustedTypes)||void 0===G?void 0:G.createPolicy("adaptivecards#deprecatedExportedFunctionPolicy",{createHTML:function(O){return O}});function findNextCharacter(O,B){for(B+=1;B<O.length&&"<"===O[B];)for(;B<O.length&&">"!==O[B++];);return B}B.truncate=function(O,B,U){truncateWorker(O,B,O.innerHTML,(function(B,U){var G,q=B.substring(0,U)+"...",j=null!==(G=null==W?void 0:W.createHTML(q))&&void 0!==G?G:q;O.innerHTML=j}),U)},B.getFitStatus=function(O,B){var U=O.offsetTop;return U+O.clientHeight<=B?q.ContainerFitStatus.FullyInContainer:U<B?q.ContainerFitStatus.Overflowing:q.ContainerFitStatus.FullyOutOfContainer},B.getScrollX=function(){return window.pageXOffset},B.getScrollY=function(){return window.pageYOffset},B.clearElementChildren=function(O){for(;O.firstChild;)O.removeChild(O.firstChild)},B.addCancelSelectActionEventHandler=function(O){O.onclick=function(O){O.preventDefault(),O.cancelBubble=!0}}},7423:(O,B,U)=>{"use strict";function assign(O){var B=Array.prototype.slice.call(arguments,1);return B.forEach((function(B){B&&Object.keys(B).forEach((function(U){O[U]=B[U]}))})),O}function _class(O){return Object.prototype.toString.call(O)}function isFunction(O){return"[object Function]"===_class(O)}function escapeRE(O){return O.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var G={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var q={"http:":{validate:function(O,B,U){var G=O.slice(B);return U.re.http||(U.re.http=new RegExp("^\\/\\/"+U.re.src_auth+U.re.src_host_port_strict+U.re.src_path,"i")),U.re.http.test(G)?G.match(U.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(O,B,U){var G=O.slice(B);return U.re.no_http||(U.re.no_http=new RegExp("^"+U.re.src_auth+"(?:localhost|(?:(?:"+U.re.src_domain+")\\.)+"+U.re.src_domain_root+")"+U.re.src_port+U.re.src_host_terminator+U.re.src_path,"i")),U.re.no_http.test(G)?B>=3&&":"===O[B-3]||B>=3&&"/"===O[B-3]?0:G.match(U.re.no_http)[0].length:0}},"mailto:":{validate:function(O,B,U){var G=O.slice(B);return U.re.mailto||(U.re.mailto=new RegExp("^"+U.re.src_email_name+"@"+U.re.src_host_strict,"i")),U.re.mailto.test(G)?G.match(U.re.mailto)[0].length:0}}},j="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function compile(O){var B=O.re=U(6582)(O.__opts__),G=O.__tlds__.slice();function untpl(O){return O.replace("%TLDS%",B.src_tlds)}O.onCompile(),O.__tlds_replaced__||G.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),G.push(B.src_xn),B.src_tlds=G.join("|"),B.email_fuzzy=RegExp(untpl(B.tpl_email_fuzzy),"i"),B.link_fuzzy=RegExp(untpl(B.tpl_link_fuzzy),"i"),B.link_no_ip_fuzzy=RegExp(untpl(B.tpl_link_no_ip_fuzzy),"i"),B.host_fuzzy_test=RegExp(untpl(B.tpl_host_fuzzy_test),"i");var q=[];function schemaError(O,B){throw new Error('(LinkifyIt) Invalid schema "'+O+'": '+B)}O.__compiled__={},Object.keys(O.__schemas__).forEach((function(B){var U=O.__schemas__[B];if(null!==U){var G={validate:null,link:null};if(O.__compiled__[B]=G,"[object Object]"===_class(U))return!function(O){return"[object RegExp]"===_class(O)}(U.validate)?isFunction(U.validate)?G.validate=U.validate:schemaError(B,U):G.validate=function(O){return function(B,U){var G=B.slice(U);return O.test(G)?G.match(O)[0].length:0}}(U.validate),void(isFunction(U.normalize)?G.normalize=U.normalize:U.normalize?schemaError(B,U):G.normalize=function(O,B){B.normalize(O)});!function(O){return"[object String]"===_class(O)}(U)?schemaError(B,U):q.push(B)}})),q.forEach((function(B){O.__compiled__[O.__schemas__[B]]&&(O.__compiled__[B].validate=O.__compiled__[O.__schemas__[B]].validate,O.__compiled__[B].normalize=O.__compiled__[O.__schemas__[B]].normalize)})),O.__compiled__[""]={validate:null,normalize:function(O,B){B.normalize(O)}};var j=Object.keys(O.__compiled__).filter((function(B){return B.length>0&&O.__compiled__[B]})).map(escapeRE).join("|");O.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+B.src_ZPCc+"))("+j+")","i"),O.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+B.src_ZPCc+"))("+j+")","ig"),O.re.schema_at_start=RegExp("^"+O.re.schema_search.source,"i"),O.re.pretest=RegExp("("+O.re.schema_test.source+")|("+O.re.host_fuzzy_test.source+")|@","i"),function(O){O.__index__=-1,O.__text_cache__=""}(O)}function Match(O,B){var U=O.__index__,G=O.__last_index__,q=O.__text_cache__.slice(U,G);this.schema=O.__schema__.toLowerCase(),this.index=U+B,this.lastIndex=G+B,this.raw=q,this.text=q,this.url=q}function createMatch(O,B){var U=new Match(O,B);return O.__compiled__[U.schema].normalize(U,O),U}function LinkifyIt(O,B){if(!(this instanceof LinkifyIt))return new LinkifyIt(O,B);var U;B||(U=O,Object.keys(U||{}).reduce((function(O,B){return O||G.hasOwnProperty(B)}),!1)&&(B=O,O={})),this.__opts__=assign({},G,B),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=assign({},q,O),this.__compiled__={},this.__tlds__=j,this.__tlds_replaced__=!1,this.re={},compile(this)}LinkifyIt.prototype.add=function(O,B){return this.__schemas__[O]=B,compile(this),this},LinkifyIt.prototype.set=function(O){return this.__opts__=assign(this.__opts__,O),this},LinkifyIt.prototype.test=function(O){if(this.__text_cache__=O,this.__index__=-1,!O.length)return!1;var B,U,G,q,j,W,Y,K;if(this.re.schema_test.test(O))for((Y=this.re.schema_search).lastIndex=0;null!==(B=Y.exec(O));)if(q=this.testSchemaAt(O,B[2],Y.lastIndex)){this.__schema__=B[2],this.__index__=B.index+B[1].length,this.__last_index__=B.index+B[0].length+q;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(K=O.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||K<this.__index__)&&null!==(U=O.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(j=U.index+U[1].length,(this.__index__<0||j<this.__index__)&&(this.__schema__="",this.__index__=j,this.__last_index__=U.index+U[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&O.indexOf("@")>=0&&null!==(G=O.match(this.re.email_fuzzy))&&(j=G.index+G[1].length,W=G.index+G[0].length,(this.__index__<0||j<this.__index__||j===this.__index__&&W>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=j,this.__last_index__=W)),this.__index__>=0},LinkifyIt.prototype.pretest=function(O){return this.re.pretest.test(O)},LinkifyIt.prototype.testSchemaAt=function(O,B,U){return this.__compiled__[B.toLowerCase()]?this.__compiled__[B.toLowerCase()].validate(O,U,this):0},LinkifyIt.prototype.match=function(O){var B=0,U=[];this.__index__>=0&&this.__text_cache__===O&&(U.push(createMatch(this,B)),B=this.__last_index__);for(var G=B?O.slice(B):O;this.test(G);)U.push(createMatch(this,B)),G=G.slice(this.__last_index__),B+=this.__last_index__;return U.length?U:null},LinkifyIt.prototype.matchAtStart=function(O){if(this.__text_cache__=O,this.__index__=-1,!O.length)return null;var B=this.re.schema_at_start.exec(O);if(!B)return null;var U=this.testSchemaAt(O,B[2],B[0].length);return U?(this.__schema__=B[2],this.__index__=B.index+B[1].length,this.__last_index__=B.index+B[0].length+U,createMatch(this,0)):null},LinkifyIt.prototype.tlds=function(O,B){return O=Array.isArray(O)?O:[O],B?(this.__tlds__=this.__tlds__.concat(O).sort().filter((function(O,B,U){return O!==U[B-1]})).reverse(),compile(this),this):(this.__tlds__=O.slice(),this.__tlds_replaced__=!0,compile(this),this)},LinkifyIt.prototype.normalize=function(O){O.schema||(O.url="http://"+O.url),"mailto:"!==O.schema||/^mailto:/i.test(O.url)||(O.url="mailto:"+O.url)},LinkifyIt.prototype.onCompile=function(){},O.exports=LinkifyIt},6582:(O,B,U)=>{"use strict";O.exports=function(O){var B={};O=O||{},B.src_Any=U(1816).source,B.src_Cc=U(355).source,B.src_Z=U(21).source,B.src_P=U(6121).source,B.src_ZPCc=[B.src_Z,B.src_P,B.src_Cc].join("|"),B.src_ZCc=[B.src_Z,B.src_Cc].join("|");return B.src_pseudo_letter="(?:(?![><]|"+B.src_ZPCc+")"+B.src_Any+")",B.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",B.src_auth="(?:(?:(?!"+B.src_ZCc+"|[@/\\[\\]()]).)+@)?",B.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",B.src_host_terminator="(?=$|[><]|"+B.src_ZPCc+")(?!"+(O["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+B.src_ZPCc+"))",B.src_path="(?:[/?#](?:(?!"+B.src_ZCc+"|"+"[><]|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+B.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+B.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+B.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+B.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+B.src_ZCc+"|[']).)+\\'|\\'(?="+B.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+B.src_ZCc+"|[.]|$)|"+(O["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+B.src_ZCc+"|$)|;(?!"+B.src_ZCc+"|$)|\\!+(?!"+B.src_ZCc+"|[!]|$)|\\?(?!"+B.src_ZCc+"|[?]|$))+|\\/)?",B.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',B.src_xn="xn--[a-z0-9\\-]{1,59}",B.src_domain_root="(?:"+B.src_xn+"|"+B.src_pseudo_letter+"{1,63})",B.src_domain="(?:"+B.src_xn+"|(?:"+B.src_pseudo_letter+")|(?:"+B.src_pseudo_letter+"(?:-|"+B.src_pseudo_letter+"){0,61}"+B.src_pseudo_letter+"))",B.src_host="(?:(?:(?:(?:"+B.src_domain+")\\.)*"+B.src_domain+"))",B.tpl_host_fuzzy="(?:"+B.src_ip4+"|(?:(?:(?:"+B.src_domain+")\\.)+(?:%TLDS%)))",B.tpl_host_no_ip_fuzzy="(?:(?:(?:"+B.src_domain+")\\.)+(?:%TLDS%))",B.src_host_strict=B.src_host+B.src_host_terminator,B.tpl_host_fuzzy_strict=B.tpl_host_fuzzy+B.src_host_terminator,B.src_host_port_strict=B.src_host+B.src_port+B.src_host_terminator,B.tpl_host_port_fuzzy_strict=B.tpl_host_fuzzy+B.src_port+B.src_host_terminator,B.tpl_host_port_no_ip_fuzzy_strict=B.tpl_host_no_ip_fuzzy+B.src_port+B.src_host_terminator,B.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+B.src_ZPCc+"|>|$))",B.tpl_email_fuzzy='(^|[><]|"|\\(|'+B.src_ZCc+")("+B.src_email_name+"@"+B.tpl_host_fuzzy_strict+")",B.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+B.src_ZPCc+"))((?![$+<=>^`|])"+B.tpl_host_port_fuzzy_strict+B.src_path+")",B.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+B.src_ZPCc+"))((?![$+<=>^`|])"+B.tpl_host_port_no_ip_fuzzy_strict+B.src_path+")",B}},4868:(O,B,U)=>{"use strict";O.exports=U(506)},4216:(O,B,U)=>{"use strict";O.exports=U(4058)},9606:O=>{"use strict";O.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},8247:O=>{"use strict";var B="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",U="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",G=new RegExp("^(?:"+B+"|"+U+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),q=new RegExp("^(?:"+B+"|"+U+")");O.exports.n=G,O.exports.q=q},9086:(O,B,U)=>{"use strict";var G=Object.prototype.hasOwnProperty;function has(O,B){return G.call(O,B)}function isValidEntityCode(O){return!(O>=55296&&O<=57343)&&(!(O>=64976&&O<=65007)&&(65535!=(65535&O)&&65534!=(65535&O)&&(!(O>=0&&O<=8)&&(11!==O&&(!(O>=14&&O<=31)&&(!(O>=127&&O<=159)&&!(O>1114111)))))))}function fromCodePoint(O){if(O>65535){var B=55296+((O-=65536)>>10),U=56320+(1023&O);return String.fromCharCode(B,U)}return String.fromCharCode(O)}var q=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,j=new RegExp(q.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),W=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i,Y=U(4216);var K=/[&<>"]/,Q=/[&<>"]/g,Z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function replaceUnsafeChar(O){return Z[O]}var X=/[.?*+^$[\]\\(){}|-]/g;var J=U(6121);B.lib={},B.lib.mdurl=U(3771),B.lib.ucmicro=U(8274),B.assign=function(O){var B=Array.prototype.slice.call(arguments,1);return B.forEach((function(B){if(B){if("object"!=typeof B)throw new TypeError(B+"must be object");Object.keys(B).forEach((function(U){O[U]=B[U]}))}})),O},B.isString=function(O){return"[object String]"===function(O){return Object.prototype.toString.call(O)}(O)},B.has=has,B.unescapeMd=function(O){return O.indexOf("\\")<0?O:O.replace(q,"$1")},B.unescapeAll=function(O){return O.indexOf("\\")<0&&O.indexOf("&")<0?O:O.replace(j,(function(O,B,U){return B||function(O,B){var U=0;return has(Y,B)?Y[B]:35===B.charCodeAt(0)&&W.test(B)&&isValidEntityCode(U="x"===B[1].toLowerCase()?parseInt(B.slice(2),16):parseInt(B.slice(1),10))?fromCodePoint(U):O}(O,U)}))},B.isValidEntityCode=isValidEntityCode,B.fromCodePoint=fromCodePoint,B.escapeHtml=function(O){return K.test(O)?O.replace(Q,replaceUnsafeChar):O},B.arrayReplaceAt=function(O,B,U){return[].concat(O.slice(0,B),U,O.slice(B+1))},B.isSpace=function(O){switch(O){case 9:case 32:return!0}return!1},B.isWhiteSpace=function(O){if(O>=8192&&O<=8202)return!0;switch(O){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1},B.isMdAsciiPunct=function(O){switch(O){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}},B.isPunctChar=function(O){return J.test(O)},B.escapeRE=function(O){return O.replace(X,"\\$&")},B.normalizeReference=function(O){return O=O.trim().replace(/\s+/g," "),""==="".toLowerCase()&&(O=O.replace(//g,"")),O.toLowerCase().toUpperCase()}},9699:(O,B,U)=>{"use strict";B.parseLinkLabel=U(9347),B.parseLinkDestination=U(6366),B.parseLinkTitle=U(9677)},6366:(O,B,U)=>{"use strict";var G=U(9086).unescapeAll;O.exports=function(O,B,U){var q,j,W=B,Y={ok:!1,pos:0,lines:0,str:""};if(60===O.charCodeAt(B)){for(B++;B<U;){if(10===(q=O.charCodeAt(B)))return Y;if(60===q)return Y;if(62===q)return Y.pos=B+1,Y.str=G(O.slice(W+1,B)),Y.ok=!0,Y;92===q&&B+1<U?B+=2:B++}return Y}for(j=0;B<U&&32!==(q=O.charCodeAt(B))&&!(q<32||127===q);)if(92===q&&B+1<U){if(32===O.charCodeAt(B+1))break;B+=2}else{if(40===q&&++j>32)return Y;if(41===q){if(0===j)break;j--}B++}return W===B||0!==j||(Y.str=G(O.slice(W,B)),Y.lines=0,Y.pos=B,Y.ok=!0),Y}},9347:O=>{"use strict";O.exports=function(O,B,U){var G,q,j,W,Y=-1,K=O.posMax,Q=O.pos;for(O.pos=B+1,G=1;O.pos<K;){if(93===(j=O.src.charCodeAt(O.pos))&&0===--G){q=!0;break}if(W=O.pos,O.md.inline.skipToken(O),91===j)if(W===O.pos-1)G++;else if(U)return O.pos=Q,-1}return q&&(Y=O.pos),O.pos=Q,Y}},9677:(O,B,U)=>{"use strict";var G=U(9086).unescapeAll;O.exports=function(O,B,U){var q,j,W=0,Y=B,K={ok:!1,pos:0,lines:0,str:""};if(B>=U)return K;if(34!==(j=O.charCodeAt(B))&&39!==j&&40!==j)return K;for(B++,40===j&&(j=41);B<U;){if((q=O.charCodeAt(B))===j)return K.pos=B+1,K.lines=W,K.str=G(O.slice(Y+1,B)),K.ok=!0,K;if(40===q&&41===j)return K;10===q?W++:92===q&&B+1<U&&(B++,10===O.charCodeAt(B)&&W++),B++}return K}},506:(O,B,U)=>{"use strict";var G=U(9086),q=U(9699),j=U(3726),W=U(7645),Y=U(9567),K=U(8218),Q=U(7423),Z=U(3771),X=U(2322),J={default:U(8376),zero:U(4105),commonmark:U(6874)},ee=/^(vbscript|javascript|file|data):/,te=/^data:image\/(gif|png|jpeg|webp);/;function validateLink(O){var B=O.trim().toLowerCase();return!ee.test(B)||!!te.test(B)}var ie=["http:","https:","mailto:"];function normalizeLink(O){var B=Z.parse(O,!0);if(B.hostname&&(!B.protocol||ie.indexOf(B.protocol)>=0))try{B.hostname=X.toASCII(B.hostname)}catch(O){}return Z.encode(Z.format(B))}function normalizeLinkText(O){var B=Z.parse(O,!0);if(B.hostname&&(!B.protocol||ie.indexOf(B.protocol)>=0))try{B.hostname=X.toUnicode(B.hostname)}catch(O){}return Z.decode(Z.format(B),Z.decode.defaultChars+"%")}function MarkdownIt(O,B){if(!(this instanceof MarkdownIt))return new MarkdownIt(O,B);B||G.isString(O)||(B=O||{},O="default"),this.inline=new K,this.block=new Y,this.core=new W,this.renderer=new j,this.linkify=new Q,this.validateLink=validateLink,this.normalizeLink=normalizeLink,this.normalizeLinkText=normalizeLinkText,this.utils=G,this.helpers=G.assign({},q),this.options={},this.configure(O),B&&this.set(B)}MarkdownIt.prototype.set=function(O){return G.assign(this.options,O),this},MarkdownIt.prototype.configure=function(O){var B,U=this;if(G.isString(O)&&!(O=J[B=O]))throw new Error('Wrong `markdown-it` preset "'+B+'", check name');if(!O)throw new Error("Wrong `markdown-it` preset, can't be empty");return O.options&&U.set(O.options),O.components&&Object.keys(O.components).forEach((function(B){O.components[B].rules&&U[B].ruler.enableOnly(O.components[B].rules),O.components[B].rules2&&U[B].ruler2.enableOnly(O.components[B].rules2)})),this},MarkdownIt.prototype.enable=function(O,B){var U=[];Array.isArray(O)||(O=[O]),["core","block","inline"].forEach((function(B){U=U.concat(this[B].ruler.enable(O,!0))}),this),U=U.concat(this.inline.ruler2.enable(O,!0));var G=O.filter((function(O){return U.indexOf(O)<0}));if(G.length&&!B)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+G);return this},MarkdownIt.prototype.disable=function(O,B){var U=[];Array.isArray(O)||(O=[O]),["core","block","inline"].forEach((function(B){U=U.concat(this[B].ruler.disable(O,!0))}),this),U=U.concat(this.inline.ruler2.disable(O,!0));var G=O.filter((function(O){return U.indexOf(O)<0}));if(G.length&&!B)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+G);return this},MarkdownIt.prototype.use=function(O){var B=[this].concat(Array.prototype.slice.call(arguments,1));return O.apply(O,B),this},MarkdownIt.prototype.parse=function(O,B){if("string"!=typeof O)throw new Error("Input data should be a String");var U=new this.core.State(O,this,B);return this.core.process(U),U.tokens},MarkdownIt.prototype.render=function(O,B){return B=B||{},this.renderer.render(this.parse(O,B),this.options,B)},MarkdownIt.prototype.parseInline=function(O,B){var U=new this.core.State(O,this,B);return U.inlineMode=!0,this.core.process(U),U.tokens},MarkdownIt.prototype.renderInline=function(O,B){return B=B||{},this.renderer.render(this.parseInline(O,B),this.options,B)},O.exports=MarkdownIt},9567:(O,B,U)=>{"use strict";var G=U(5991),q=[["table",U(2674),["paragraph","reference"]],["code",U(7935)],["fence",U(9346),["paragraph","reference","blockquote","list"]],["blockquote",U(2048),["paragraph","reference","blockquote","list"]],["hr",U(791),["paragraph","reference","blockquote","list"]],["list",U(1937),["paragraph","reference","blockquote"]],["reference",U(8543)],["html_block",U(4224),["paragraph","reference","blockquote"]],["heading",U(284),["paragraph","reference","blockquote"]],["lheading",U(1084)],["paragraph",U(3097)]];function ParserBlock(){this.ruler=new G;for(var O=0;O<q.length;O++)this.ruler.push(q[O][0],q[O][1],{alt:(q[O][2]||[]).slice()})}ParserBlock.prototype.tokenize=function(O,B,U){for(var G,q=this.ruler.getRules(""),j=q.length,W=B,Y=!1,K=O.md.options.maxNesting;W<U&&(O.line=W=O.skipEmptyLines(W),!(W>=U))&&!(O.sCount[W]<O.blkIndent);){if(O.level>=K){O.line=U;break}for(G=0;G<j&&!q[G](O,W,U,!1);G++);O.tight=!Y,O.isEmpty(O.line-1)&&(Y=!0),(W=O.line)<U&&O.isEmpty(W)&&(Y=!0,W++,O.line=W)}},ParserBlock.prototype.parse=function(O,B,U,G){var q;O&&(q=new this.State(O,B,U,G),this.tokenize(q,q.line,q.lineMax))},ParserBlock.prototype.State=U(9562),O.exports=ParserBlock},7645:(O,B,U)=>{"use strict";var G=U(5991),q=[["normalize",U(3285)],["block",U(5185)],["inline",U(4420)],["linkify",U(2716)],["replacements",U(5643)],["smartquotes",U(3859)],["text_join",U(1418)]];function Core(){this.ruler=new G;for(var O=0;O<q.length;O++)this.ruler.push(q[O][0],q[O][1])}Core.prototype.process=function(O){var B,U,G;for(B=0,U=(G=this.ruler.getRules("")).length;B<U;B++)G[B](O)},Core.prototype.State=U(5748),O.exports=Core},8218:(O,B,U)=>{"use strict";var G=U(5991),q=[["text",U(9431)],["linkify",U(2386)],["newline",U(7014)],["escape",U(5491)],["backticks",U(1389)],["strikethrough",U(1606).w],["emphasis",U(9639).w],["link",U(4771)],["image",U(4506)],["autolink",U(5837)],["html_inline",U(6425)],["entity",U(6277)]],j=[["balance_pairs",U(1503)],["strikethrough",U(1606).g],["emphasis",U(9639).g],["fragments_join",U(1305)]];function ParserInline(){var O;for(this.ruler=new G,O=0;O<q.length;O++)this.ruler.push(q[O][0],q[O][1]);for(this.ruler2=new G,O=0;O<j.length;O++)this.ruler2.push(j[O][0],j[O][1])}ParserInline.prototype.skipToken=function(O){var B,U,G=O.pos,q=this.ruler.getRules(""),j=q.length,W=O.md.options.maxNesting,Y=O.cache;if(void 0===Y[G]){if(O.level<W)for(U=0;U<j&&(O.level++,B=q[U](O,!0),O.level--,!B);U++);else O.pos=O.posMax;B||O.pos++,Y[G]=O.pos}else O.pos=Y[G]},ParserInline.prototype.tokenize=function(O){for(var B,U,G=this.ruler.getRules(""),q=G.length,j=O.posMax,W=O.md.options.maxNesting;O.pos<j;){if(O.level<W)for(U=0;U<q&&!(B=G[U](O,!1));U++);if(B){if(O.pos>=j)break}else O.pending+=O.src[O.pos++]}O.pending&&O.pushPending()},ParserInline.prototype.parse=function(O,B,U,G){var q,j,W,Y=new this.State(O,B,U,G);for(this.tokenize(Y),W=(j=this.ruler2.getRules("")).length,q=0;q<W;q++)j[q](Y)},ParserInline.prototype.State=U(5793),O.exports=ParserInline},6874:O=>{"use strict";O.exports={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}}},8376:O=>{"use strict";O.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}}},4105:O=>{"use strict";O.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}}},3726:(O,B,U)=>{"use strict";var G=U(9086).assign,q=U(9086).unescapeAll,j=U(9086).escapeHtml,W={};function Renderer(){this.rules=G({},W)}W.code_inline=function(O,B,U,G,q){var W=O[B];return"<code"+q.renderAttrs(W)+">"+j(O[B].content)+"</code>"},W.code_block=function(O,B,U,G,q){var W=O[B];return"<pre"+q.renderAttrs(W)+"><code>"+j(O[B].content)+"</code></pre>\n"},W.fence=function(O,B,U,G,W){var Y,K,Q,Z,X,J=O[B],ee=J.info?q(J.info).trim():"",te="",ie="";return ee&&(te=(Q=ee.split(/(\s+)/g))[0],ie=Q.slice(2).join("")),0===(Y=U.highlight&&U.highlight(J.content,te,ie)||j(J.content)).indexOf("<pre")?Y+"\n":ee?(K=J.attrIndex("class"),Z=J.attrs?J.attrs.slice():[],K<0?Z.push(["class",U.langPrefix+te]):(Z[K]=Z[K].slice(),Z[K][1]+=" "+U.langPrefix+te),X={attrs:Z},"<pre><code"+W.renderAttrs(X)+">"+Y+"</code></pre>\n"):"<pre><code"+W.renderAttrs(J)+">"+Y+"</code></pre>\n"},W.image=function(O,B,U,G,q){var j=O[B];return j.attrs[j.attrIndex("alt")][1]=q.renderInlineAsText(j.children,U,G),q.renderToken(O,B,U)},W.hardbreak=function(O,B,U){return U.xhtmlOut?"<br />\n":"<br>\n"},W.softbreak=function(O,B,U){return U.breaks?U.xhtmlOut?"<br />\n":"<br>\n":"\n"},W.text=function(O,B){return j(O[B].content)},W.html_block=function(O,B){return O[B].content},W.html_inline=function(O,B){return O[B].content},Renderer.prototype.renderAttrs=function(O){var B,U,G;if(!O.attrs)return"";for(G="",B=0,U=O.attrs.length;B<U;B++)G+=" "+j(O.attrs[B][0])+'="'+j(O.attrs[B][1])+'"';return G},Renderer.prototype.renderToken=function(O,B,U){var G,q="",j=!1,W=O[B];return W.hidden?"":(W.block&&-1!==W.nesting&&B&&O[B-1].hidden&&(q+="\n"),q+=(-1===W.nesting?"</":"<")+W.tag,q+=this.renderAttrs(W),0===W.nesting&&U.xhtmlOut&&(q+=" /"),W.block&&(j=!0,1===W.nesting&&B+1<O.length&&("inline"===(G=O[B+1]).type||G.hidden||-1===G.nesting&&G.tag===W.tag)&&(j=!1)),q+=j?">\n":">")},Renderer.prototype.renderInline=function(O,B,U){for(var G,q="",j=this.rules,W=0,Y=O.length;W<Y;W++)void 0!==j[G=O[W].type]?q+=j[G](O,W,B,U,this):q+=this.renderToken(O,W,B);return q},Renderer.prototype.renderInlineAsText=function(O,B,U){for(var G="",q=0,j=O.length;q<j;q++)"text"===O[q].type?G+=O[q].content:"image"===O[q].type?G+=this.renderInlineAsText(O[q].children,B,U):"softbreak"===O[q].type&&(G+="\n");return G},Renderer.prototype.render=function(O,B,U){var G,q,j,W="",Y=this.rules;for(G=0,q=O.length;G<q;G++)"inline"===(j=O[G].type)?W+=this.renderInline(O[G].children,B,U):void 0!==Y[j]?W+=Y[O[G].type](O,G,B,U,this):W+=this.renderToken(O,G,B,U);return W},O.exports=Renderer},5991:O=>{"use strict";function Ruler(){this.__rules__=[],this.__cache__=null}Ruler.prototype.__find__=function(O){for(var B=0;B<this.__rules__.length;B++)if(this.__rules__[B].name===O)return B;return-1},Ruler.prototype.__compile__=function(){var O=this,B=[""];O.__rules__.forEach((function(O){O.enabled&&O.alt.forEach((function(O){B.indexOf(O)<0&&B.push(O)}))})),O.__cache__={},B.forEach((function(B){O.__cache__[B]=[],O.__rules__.forEach((function(U){U.enabled&&(B&&U.alt.indexOf(B)<0||O.__cache__[B].push(U.fn))}))}))},Ruler.prototype.at=function(O,B,U){var G=this.__find__(O),q=U||{};if(-1===G)throw new Error("Parser rule not found: "+O);this.__rules__[G].fn=B,this.__rules__[G].alt=q.alt||[],this.__cache__=null},Ruler.prototype.before=function(O,B,U,G){var q=this.__find__(O),j=G||{};if(-1===q)throw new Error("Parser rule not found: "+O);this.__rules__.splice(q,0,{name:B,enabled:!0,fn:U,alt:j.alt||[]}),this.__cache__=null},Ruler.prototype.after=function(O,B,U,G){var q=this.__find__(O),j=G||{};if(-1===q)throw new Error("Parser rule not found: "+O);this.__rules__.splice(q+1,0,{name:B,enabled:!0,fn:U,alt:j.alt||[]}),this.__cache__=null},Ruler.prototype.push=function(O,B,U){var G=U||{};this.__rules__.push({name:O,enabled:!0,fn:B,alt:G.alt||[]}),this.__cache__=null},Ruler.prototype.enable=function(O,B){Array.isArray(O)||(O=[O]);var U=[];return O.forEach((function(O){var G=this.__find__(O);if(G<0){if(B)return;throw new Error("Rules manager: invalid rule name "+O)}this.__rules__[G].enabled=!0,U.push(O)}),this),this.__cache__=null,U},Ruler.prototype.enableOnly=function(O,B){Array.isArray(O)||(O=[O]),this.__rules__.forEach((function(O){O.enabled=!1})),this.enable(O,B)},Ruler.prototype.disable=function(O,B){Array.isArray(O)||(O=[O]);var U=[];return O.forEach((function(O){var G=this.__find__(O);if(G<0){if(B)return;throw new Error("Rules manager: invalid rule name "+O)}this.__rules__[G].enabled=!1,U.push(O)}),this),this.__cache__=null,U},Ruler.prototype.getRules=function(O){return null===this.__cache__&&this.__compile__(),this.__cache__[O]||[]},O.exports=Ruler},2048:(O,B,U)=>{"use strict";var G=U(9086).isSpace;O.exports=function(O,B,U,q){var j,W,Y,K,Q,Z,X,J,ee,te,ie,re,ne,oe,ae,se,le,ce,de,pe,ue=O.lineMax,he=O.bMarks[B]+O.tShift[B],me=O.eMarks[B];if(O.sCount[B]-O.blkIndent>=4)return!1;if(62!==O.src.charCodeAt(he++))return!1;if(q)return!0;for(K=ee=O.sCount[B]+1,32===O.src.charCodeAt(he)?(he++,K++,ee++,j=!1,se=!0):9===O.src.charCodeAt(he)?(se=!0,(O.bsCount[B]+ee)%4==3?(he++,K++,ee++,j=!1):j=!0):se=!1,te=[O.bMarks[B]],O.bMarks[B]=he;he<me&&(W=O.src.charCodeAt(he),G(W));)9===W?ee+=4-(ee+O.bsCount[B]+(j?1:0))%4:ee++,he++;for(ie=[O.bsCount[B]],O.bsCount[B]=O.sCount[B]+1+(se?1:0),Z=he>=me,oe=[O.sCount[B]],O.sCount[B]=ee-K,ae=[O.tShift[B]],O.tShift[B]=he-O.bMarks[B],ce=O.md.block.ruler.getRules("blockquote"),ne=O.parentType,O.parentType="blockquote",J=B+1;J<U&&(pe=O.sCount[J]<O.blkIndent,!((he=O.bMarks[J]+O.tShift[J])>=(me=O.eMarks[J])));J++)if(62!==O.src.charCodeAt(he++)||pe){if(Z)break;for(le=!1,Y=0,Q=ce.length;Y<Q;Y++)if(ce[Y](O,J,U,!0)){le=!0;break}if(le){O.lineMax=J,0!==O.blkIndent&&(te.push(O.bMarks[J]),ie.push(O.bsCount[J]),ae.push(O.tShift[J]),oe.push(O.sCount[J]),O.sCount[J]-=O.blkIndent);break}te.push(O.bMarks[J]),ie.push(O.bsCount[J]),ae.push(O.tShift[J]),oe.push(O.sCount[J]),O.sCount[J]=-1}else{for(K=ee=O.sCount[J]+1,32===O.src.charCodeAt(he)?(he++,K++,ee++,j=!1,se=!0):9===O.src.charCodeAt(he)?(se=!0,(O.bsCount[J]+ee)%4==3?(he++,K++,ee++,j=!1):j=!0):se=!1,te.push(O.bMarks[J]),O.bMarks[J]=he;he<me&&(W=O.src.charCodeAt(he),G(W));)9===W?ee+=4-(ee+O.bsCount[J]+(j?1:0))%4:ee++,he++;Z=he>=me,ie.push(O.bsCount[J]),O.bsCount[J]=O.sCount[J]+1+(se?1:0),oe.push(O.sCount[J]),O.sCount[J]=ee-K,ae.push(O.tShift[J]),O.tShift[J]=he-O.bMarks[J]}for(re=O.blkIndent,O.blkIndent=0,(de=O.push("blockquote_open","blockquote",1)).markup=">",de.map=X=[B,0],O.md.block.tokenize(O,B,J),(de=O.push("blockquote_close","blockquote",-1)).markup=">",O.lineMax=ue,O.parentType=ne,X[1]=O.line,Y=0;Y<ae.length;Y++)O.bMarks[Y+B]=te[Y],O.tShift[Y+B]=ae[Y],O.sCount[Y+B]=oe[Y],O.bsCount[Y+B]=ie[Y];return O.blkIndent=re,!0}},7935:O=>{"use strict";O.exports=function(O,B,U){var G,q,j;if(O.sCount[B]-O.blkIndent<4)return!1;for(q=G=B+1;G<U;)if(O.isEmpty(G))G++;else{if(!(O.sCount[G]-O.blkIndent>=4))break;q=++G}return O.line=q,(j=O.push("code_block","code",0)).content=O.getLines(B,q,4+O.blkIndent,!1)+"\n",j.map=[B,O.line],!0}},9346:O=>{"use strict";O.exports=function(O,B,U,G){var q,j,W,Y,K,Q,Z,X=!1,J=O.bMarks[B]+O.tShift[B],ee=O.eMarks[B];if(O.sCount[B]-O.blkIndent>=4)return!1;if(J+3>ee)return!1;if(126!==(q=O.src.charCodeAt(J))&&96!==q)return!1;if(K=J,(j=(J=O.skipChars(J,q))-K)<3)return!1;if(Z=O.src.slice(K,J),W=O.src.slice(J,ee),96===q&&W.indexOf(String.fromCharCode(q))>=0)return!1;if(G)return!0;for(Y=B;!(++Y>=U)&&!((J=K=O.bMarks[Y]+O.tShift[Y])<(ee=O.eMarks[Y])&&O.sCount[Y]<O.blkIndent);)if(O.src.charCodeAt(J)===q&&!(O.sCount[Y]-O.blkIndent>=4||(J=O.skipChars(J,q))-K<j||(J=O.skipSpaces(J))<ee)){X=!0;break}return j=O.sCount[B],O.line=Y+(X?1:0),(Q=O.push("fence","code",0)).info=W,Q.content=O.getLines(B+1,Y,j,!0),Q.markup=Z,Q.map=[B,O.line],!0}},284:(O,B,U)=>{"use strict";var G=U(9086).isSpace;O.exports=function(O,B,U,q){var j,W,Y,K,Q=O.bMarks[B]+O.tShift[B],Z=O.eMarks[B];if(O.sCount[B]-O.blkIndent>=4)return!1;if(35!==(j=O.src.charCodeAt(Q))||Q>=Z)return!1;for(W=1,j=O.src.charCodeAt(++Q);35===j&&Q<Z&&W<=6;)W++,j=O.src.charCodeAt(++Q);return!(W>6||Q<Z&&!G(j))&&(q||(Z=O.skipSpacesBack(Z,Q),(Y=O.skipCharsBack(Z,35,Q))>Q&&G(O.src.charCodeAt(Y-1))&&(Z=Y),O.line=B+1,(K=O.push("heading_open","h"+String(W),1)).markup="########".slice(0,W),K.map=[B,O.line],(K=O.push("inline","",0)).content=O.src.slice(Q,Z).trim(),K.map=[B,O.line],K.children=[],(K=O.push("heading_close","h"+String(W),-1)).markup="########".slice(0,W)),!0)}},791:(O,B,U)=>{"use strict";var G=U(9086).isSpace;O.exports=function(O,B,U,q){var j,W,Y,K,Q=O.bMarks[B]+O.tShift[B],Z=O.eMarks[B];if(O.sCount[B]-O.blkIndent>=4)return!1;if(42!==(j=O.src.charCodeAt(Q++))&&45!==j&&95!==j)return!1;for(W=1;Q<Z;){if((Y=O.src.charCodeAt(Q++))!==j&&!G(Y))return!1;Y===j&&W++}return!(W<3)&&(q||(O.line=B+1,(K=O.push("hr","hr",0)).map=[B,O.line],K.markup=Array(W+1).join(String.fromCharCode(j))),!0)}},4224:(O,B,U)=>{"use strict";var G=U(9606),q=U(8247).q,j=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+G.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(q.source+"\\s*$"),/^$/,!1]];O.exports=function(O,B,U,G){var q,W,Y,K,Q=O.bMarks[B]+O.tShift[B],Z=O.eMarks[B];if(O.sCount[B]-O.blkIndent>=4)return!1;if(!O.md.options.html)return!1;if(60!==O.src.charCodeAt(Q))return!1;for(K=O.src.slice(Q,Z),q=0;q<j.length&&!j[q][0].test(K);q++);if(q===j.length)return!1;if(G)return j[q][2];if(W=B+1,!j[q][1].test(K))for(;W<U&&!(O.sCount[W]<O.blkIndent);W++)if(Q=O.bMarks[W]+O.tShift[W],Z=O.eMarks[W],K=O.src.slice(Q,Z),j[q][1].test(K)){0!==K.length&&W++;break}return O.line=W,(Y=O.push("html_block","",0)).map=[B,W],Y.content=O.getLines(B,W,O.blkIndent,!0),!0}},1084:O=>{"use strict";O.exports=function(O,B,U){var G,q,j,W,Y,K,Q,Z,X,J,ee=B+1,te=O.md.block.ruler.getRules("paragraph");if(O.sCount[B]-O.blkIndent>=4)return!1;for(J=O.parentType,O.parentType="paragraph";ee<U&&!O.isEmpty(ee);ee++)if(!(O.sCount[ee]-O.blkIndent>3)){if(O.sCount[ee]>=O.blkIndent&&(K=O.bMarks[ee]+O.tShift[ee])<(Q=O.eMarks[ee])&&(45===(X=O.src.charCodeAt(K))||61===X)&&(K=O.skipChars(K,X),(K=O.skipSpaces(K))>=Q)){Z=61===X?1:2;break}if(!(O.sCount[ee]<0)){for(q=!1,j=0,W=te.length;j<W;j++)if(te[j](O,ee,U,!0)){q=!0;break}if(q)break}}return!!Z&&(G=O.getLines(B,ee,O.blkIndent,!1).trim(),O.line=ee+1,(Y=O.push("heading_open","h"+String(Z),1)).markup=String.fromCharCode(X),Y.map=[B,O.line],(Y=O.push("inline","",0)).content=G,Y.map=[B,O.line-1],Y.children=[],(Y=O.push("heading_close","h"+String(Z),-1)).markup=String.fromCharCode(X),O.parentType=J,!0)}},1937:(O,B,U)=>{"use strict";var G=U(9086).isSpace;function skipBulletListMarker(O,B){var U,q,j,W;return q=O.bMarks[B]+O.tShift[B],j=O.eMarks[B],42!==(U=O.src.charCodeAt(q++))&&45!==U&&43!==U||q<j&&(W=O.src.charCodeAt(q),!G(W))?-1:q}function skipOrderedListMarker(O,B){var U,q=O.bMarks[B]+O.tShift[B],j=q,W=O.eMarks[B];if(j+1>=W)return-1;if((U=O.src.charCodeAt(j++))<48||U>57)return-1;for(;;){if(j>=W)return-1;if(!((U=O.src.charCodeAt(j++))>=48&&U<=57)){if(41===U||46===U)break;return-1}if(j-q>=10)return-1}return j<W&&(U=O.src.charCodeAt(j),!G(U))?-1:j}O.exports=function(O,B,U,G){var q,j,W,Y,K,Q,Z,X,J,ee,te,ie,re,ne,oe,ae,se,le,ce,de,pe,ue,he,me,ge,fe,ye,_e,ve=!1,be=!0;if(O.sCount[B]-O.blkIndent>=4)return!1;if(O.listIndent>=0&&O.sCount[B]-O.listIndent>=4&&O.sCount[B]<O.blkIndent)return!1;if(G&&"paragraph"===O.parentType&&O.sCount[B]>=O.blkIndent&&(ve=!0),(he=skipOrderedListMarker(O,B))>=0){if(Z=!0,ge=O.bMarks[B]+O.tShift[B],re=Number(O.src.slice(ge,he-1)),ve&&1!==re)return!1}else{if(!((he=skipBulletListMarker(O,B))>=0))return!1;Z=!1}if(ve&&O.skipSpaces(he)>=O.eMarks[B])return!1;if(ie=O.src.charCodeAt(he-1),G)return!0;for(te=O.tokens.length,Z?(_e=O.push("ordered_list_open","ol",1),1!==re&&(_e.attrs=[["start",re]])):_e=O.push("bullet_list_open","ul",1),_e.map=ee=[B,0],_e.markup=String.fromCharCode(ie),oe=B,me=!1,ye=O.md.block.ruler.getRules("list"),le=O.parentType,O.parentType="list";oe<U;){for(ue=he,ne=O.eMarks[oe],Q=ae=O.sCount[oe]+he-(O.bMarks[B]+O.tShift[B]);ue<ne;){if(9===(q=O.src.charCodeAt(ue)))ae+=4-(ae+O.bsCount[oe])%4;else{if(32!==q)break;ae++}ue++}if((K=(j=ue)>=ne?1:ae-Q)>4&&(K=1),Y=Q+K,(_e=O.push("list_item_open","li",1)).markup=String.fromCharCode(ie),_e.map=X=[B,0],Z&&(_e.info=O.src.slice(ge,he-1)),pe=O.tight,de=O.tShift[B],ce=O.sCount[B],se=O.listIndent,O.listIndent=O.blkIndent,O.blkIndent=Y,O.tight=!0,O.tShift[B]=j-O.bMarks[B],O.sCount[B]=ae,j>=ne&&O.isEmpty(B+1)?O.line=Math.min(O.line+2,U):O.md.block.tokenize(O,B,U,!0),O.tight&&!me||(be=!1),me=O.line-B>1&&O.isEmpty(O.line-1),O.blkIndent=O.listIndent,O.listIndent=se,O.tShift[B]=de,O.sCount[B]=ce,O.tight=pe,(_e=O.push("list_item_close","li",-1)).markup=String.fromCharCode(ie),oe=B=O.line,X[1]=oe,j=O.bMarks[B],oe>=U)break;if(O.sCount[oe]<O.blkIndent)break;if(O.sCount[B]-O.blkIndent>=4)break;for(fe=!1,W=0,J=ye.length;W<J;W++)if(ye[W](O,oe,U,!0)){fe=!0;break}if(fe)break;if(Z){if((he=skipOrderedListMarker(O,oe))<0)break;ge=O.bMarks[oe]+O.tShift[oe]}else if((he=skipBulletListMarker(O,oe))<0)break;if(ie!==O.src.charCodeAt(he-1))break}return(_e=Z?O.push("ordered_list_close","ol",-1):O.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(ie),ee[1]=oe,O.line=oe,O.parentType=le,be&&function(O,B){var U,G,q=O.level+2;for(U=B+2,G=O.tokens.length-2;U<G;U++)O.tokens[U].level===q&&"paragraph_open"===O.tokens[U].type&&(O.tokens[U+2].hidden=!0,O.tokens[U].hidden=!0,U+=2)}(O,te),!0}},3097:O=>{"use strict";O.exports=function(O,B){var U,G,q,j,W,Y,K=B+1,Q=O.md.block.ruler.getRules("paragraph"),Z=O.lineMax;for(Y=O.parentType,O.parentType="paragraph";K<Z&&!O.isEmpty(K);K++)if(!(O.sCount[K]-O.blkIndent>3||O.sCount[K]<0)){for(G=!1,q=0,j=Q.length;q<j;q++)if(Q[q](O,K,Z,!0)){G=!0;break}if(G)break}return U=O.getLines(B,K,O.blkIndent,!1).trim(),O.line=K,(W=O.push("paragraph_open","p",1)).map=[B,O.line],(W=O.push("inline","",0)).content=U,W.map=[B,O.line],W.children=[],W=O.push("paragraph_close","p",-1),O.parentType=Y,!0}},8543:(O,B,U)=>{"use strict";var G=U(9086).normalizeReference,q=U(9086).isSpace;O.exports=function(O,B,U,j){var W,Y,K,Q,Z,X,J,ee,te,ie,re,ne,oe,ae,se,le,ce=0,de=O.bMarks[B]+O.tShift[B],pe=O.eMarks[B],ue=B+1;if(O.sCount[B]-O.blkIndent>=4)return!1;if(91!==O.src.charCodeAt(de))return!1;for(;++de<pe;)if(93===O.src.charCodeAt(de)&&92!==O.src.charCodeAt(de-1)){if(de+1===pe)return!1;if(58!==O.src.charCodeAt(de+1))return!1;break}for(Q=O.lineMax,se=O.md.block.ruler.getRules("reference"),ie=O.parentType,O.parentType="reference";ue<Q&&!O.isEmpty(ue);ue++)if(!(O.sCount[ue]-O.blkIndent>3||O.sCount[ue]<0)){for(ae=!1,X=0,J=se.length;X<J;X++)if(se[X](O,ue,Q,!0)){ae=!0;break}if(ae)break}for(pe=(oe=O.getLines(B,ue,O.blkIndent,!1).trim()).length,de=1;de<pe;de++){if(91===(W=oe.charCodeAt(de)))return!1;if(93===W){te=de;break}(10===W||92===W&&++de<pe&&10===oe.charCodeAt(de))&&ce++}if(te<0||58!==oe.charCodeAt(te+1))return!1;for(de=te+2;de<pe;de++)if(10===(W=oe.charCodeAt(de)))ce++;else if(!q(W))break;if(!(re=O.md.helpers.parseLinkDestination(oe,de,pe)).ok)return!1;if(Z=O.md.normalizeLink(re.str),!O.md.validateLink(Z))return!1;for(Y=de=re.pos,K=ce+=re.lines,ne=de;de<pe;de++)if(10===(W=oe.charCodeAt(de)))ce++;else if(!q(W))break;for(re=O.md.helpers.parseLinkTitle(oe,de,pe),de<pe&&ne!==de&&re.ok?(le=re.str,de=re.pos,ce+=re.lines):(le="",de=Y,ce=K);de<pe&&(W=oe.charCodeAt(de),q(W));)de++;if(de<pe&&10!==oe.charCodeAt(de)&&le)for(le="",de=Y,ce=K;de<pe&&(W=oe.charCodeAt(de),q(W));)de++;return!(de<pe&&10!==oe.charCodeAt(de))&&(!!(ee=G(oe.slice(1,te)))&&(j||(void 0===O.env.references&&(O.env.references={}),void 0===O.env.references[ee]&&(O.env.references[ee]={title:le,href:Z}),O.parentType=ie,O.line=B+ce+1),!0))}},9562:(O,B,U)=>{"use strict";var G=U(8843),q=U(9086).isSpace;function StateBlock(O,B,U,G){var j,W,Y,K,Q,Z,X,J;for(this.src=O,this.md=B,this.env=U,this.tokens=G,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0,this.result="",J=!1,Y=K=Z=X=0,Q=(W=this.src).length;K<Q;K++){if(j=W.charCodeAt(K),!J){if(q(j)){Z++,9===j?X+=4-X%4:X++;continue}J=!0}10!==j&&K!==Q-1||(10!==j&&K++,this.bMarks.push(Y),this.eMarks.push(K),this.tShift.push(Z),this.sCount.push(X),this.bsCount.push(0),J=!1,Z=0,X=0,Y=K+1)}this.bMarks.push(W.length),this.eMarks.push(W.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}StateBlock.prototype.push=function(O,B,U){var q=new G(O,B,U);return q.block=!0,U<0&&this.level--,q.level=this.level,U>0&&this.level++,this.tokens.push(q),q},StateBlock.prototype.isEmpty=function(O){return this.bMarks[O]+this.tShift[O]>=this.eMarks[O]},StateBlock.prototype.skipEmptyLines=function(O){for(var B=this.lineMax;O<B&&!(this.bMarks[O]+this.tShift[O]<this.eMarks[O]);O++);return O},StateBlock.prototype.skipSpaces=function(O){for(var B,U=this.src.length;O<U&&(B=this.src.charCodeAt(O),q(B));O++);return O},StateBlock.prototype.skipSpacesBack=function(O,B){if(O<=B)return O;for(;O>B;)if(!q(this.src.charCodeAt(--O)))return O+1;return O},StateBlock.prototype.skipChars=function(O,B){for(var U=this.src.length;O<U&&this.src.charCodeAt(O)===B;O++);return O},StateBlock.prototype.skipCharsBack=function(O,B,U){if(O<=U)return O;for(;O>U;)if(B!==this.src.charCodeAt(--O))return O+1;return O},StateBlock.prototype.getLines=function(O,B,U,G){var j,W,Y,K,Q,Z,X,J=O;if(O>=B)return"";for(Z=new Array(B-O),j=0;J<B;J++,j++){for(W=0,X=K=this.bMarks[J],Q=J+1<B||G?this.eMarks[J]+1:this.eMarks[J];K<Q&&W<U;){if(Y=this.src.charCodeAt(K),q(Y))9===Y?W+=4-(W+this.bsCount[J])%4:W++;else{if(!(K-X<this.tShift[J]))break;W++}K++}Z[j]=W>U?new Array(W-U+1).join(" ")+this.src.slice(K,Q):this.src.slice(K,Q)}return Z.join("")},StateBlock.prototype.Token=G,O.exports=StateBlock},2674:(O,B,U)=>{"use strict";var G=U(9086).isSpace;function getLine(O,B){var U=O.bMarks[B]+O.tShift[B],G=O.eMarks[B];return O.src.slice(U,G)}function escapedSplit(O){var B,U=[],G=0,q=O.length,j=!1,W=0,Y="";for(B=O.charCodeAt(G);G<q;)124===B&&(j?(Y+=O.substring(W,G-1),W=G):(U.push(Y+O.substring(W,G)),Y="",W=G+1)),j=92===B,G++,B=O.charCodeAt(G);return U.push(Y+O.substring(W)),U}O.exports=function(O,B,U,q){var j,W,Y,K,Q,Z,X,J,ee,te,ie,re,ne,oe,ae,se,le,ce;if(B+2>U)return!1;if(Z=B+1,O.sCount[Z]<O.blkIndent)return!1;if(O.sCount[Z]-O.blkIndent>=4)return!1;if((Y=O.bMarks[Z]+O.tShift[Z])>=O.eMarks[Z])return!1;if(124!==(le=O.src.charCodeAt(Y++))&&45!==le&&58!==le)return!1;if(Y>=O.eMarks[Z])return!1;if(124!==(ce=O.src.charCodeAt(Y++))&&45!==ce&&58!==ce&&!G(ce))return!1;if(45===le&&G(ce))return!1;for(;Y<O.eMarks[Z];){if(124!==(j=O.src.charCodeAt(Y))&&45!==j&&58!==j&&!G(j))return!1;Y++}for(X=(W=getLine(O,B+1)).split("|"),te=[],K=0;K<X.length;K++){if(!(ie=X[K].trim())){if(0===K||K===X.length-1)continue;return!1}if(!/^:?-+:?$/.test(ie))return!1;58===ie.charCodeAt(ie.length-1)?te.push(58===ie.charCodeAt(0)?"center":"right"):58===ie.charCodeAt(0)?te.push("left"):te.push("")}if(-1===(W=getLine(O,B).trim()).indexOf("|"))return!1;if(O.sCount[B]-O.blkIndent>=4)return!1;if((X=escapedSplit(W)).length&&""===X[0]&&X.shift(),X.length&&""===X[X.length-1]&&X.pop(),0===(J=X.length)||J!==te.length)return!1;if(q)return!0;for(oe=O.parentType,O.parentType="table",se=O.md.block.ruler.getRules("blockquote"),(ee=O.push("table_open","table",1)).map=re=[B,0],(ee=O.push("thead_open","thead",1)).map=[B,B+1],(ee=O.push("tr_open","tr",1)).map=[B,B+1],K=0;K<X.length;K++)ee=O.push("th_open","th",1),te[K]&&(ee.attrs=[["style","text-align:"+te[K]]]),(ee=O.push("inline","",0)).content=X[K].trim(),ee.children=[],ee=O.push("th_close","th",-1);for(ee=O.push("tr_close","tr",-1),ee=O.push("thead_close","thead",-1),Z=B+2;Z<U&&!(O.sCount[Z]<O.blkIndent);Z++){for(ae=!1,K=0,Q=se.length;K<Q;K++)if(se[K](O,Z,U,!0)){ae=!0;break}if(ae)break;if(!(W=getLine(O,Z).trim()))break;if(O.sCount[Z]-O.blkIndent>=4)break;for((X=escapedSplit(W)).length&&""===X[0]&&X.shift(),X.length&&""===X[X.length-1]&&X.pop(),Z===B+2&&((ee=O.push("tbody_open","tbody",1)).map=ne=[B+2,0]),(ee=O.push("tr_open","tr",1)).map=[Z,Z+1],K=0;K<J;K++)ee=O.push("td_open","td",1),te[K]&&(ee.attrs=[["style","text-align:"+te[K]]]),(ee=O.push("inline","",0)).content=X[K]?X[K].trim():"",ee.children=[],ee=O.push("td_close","td",-1);ee=O.push("tr_close","tr",-1)}return ne&&(ee=O.push("tbody_close","tbody",-1),ne[1]=Z),ee=O.push("table_close","table",-1),re[1]=Z,O.parentType=oe,O.line=Z,!0}},5185:O=>{"use strict";O.exports=function(O){var B;O.inlineMode?((B=new O.Token("inline","",0)).content=O.src,B.map=[0,1],B.children=[],O.tokens.push(B)):O.md.block.parse(O.src,O.md,O.env,O.tokens)}},4420:O=>{"use strict";O.exports=function(O){var B,U,G,q=O.tokens;for(U=0,G=q.length;U<G;U++)"inline"===(B=q[U]).type&&O.md.inline.parse(B.content,O.md,O.env,B.children)}},2716:(O,B,U)=>{"use strict";var G=U(9086).arrayReplaceAt;function isLinkClose(O){return/^<\/a\s*>/i.test(O)}O.exports=function(O){var B,U,q,j,W,Y,K,Q,Z,X,J,ee,te,ie,re,ne,oe,ae,se=O.tokens;if(O.md.options.linkify)for(U=0,q=se.length;U<q;U++)if("inline"===se[U].type&&O.md.linkify.pretest(se[U].content))for(te=0,B=(j=se[U].children).length-1;B>=0;B--)if("link_close"!==(Y=j[B]).type){if("html_inline"===Y.type&&(ae=Y.content,/^<a[>\s]/i.test(ae)&&te>0&&te--,isLinkClose(Y.content)&&te++),!(te>0)&&"text"===Y.type&&O.md.linkify.test(Y.content)){for(Z=Y.content,oe=O.md.linkify.match(Z),K=[],ee=Y.level,J=0,oe.length>0&&0===oe[0].index&&B>0&&"text_special"===j[B-1].type&&(oe=oe.slice(1)),Q=0;Q<oe.length;Q++)ie=oe[Q].url,re=O.md.normalizeLink(ie),O.md.validateLink(re)&&(ne=oe[Q].text,ne=oe[Q].schema?"mailto:"!==oe[Q].schema||/^mailto:/i.test(ne)?O.md.normalizeLinkText(ne):O.md.normalizeLinkText("mailto:"+ne).replace(/^mailto:/,""):O.md.normalizeLinkText("http://"+ne).replace(/^http:\/\//,""),(X=oe[Q].index)>J&&((W=new O.Token("text","",0)).content=Z.slice(J,X),W.level=ee,K.push(W)),(W=new O.Token("link_open","a",1)).attrs=[["href",re]],W.level=ee++,W.markup="linkify",W.info="auto",K.push(W),(W=new O.Token("text","",0)).content=ne,W.level=ee,K.push(W),(W=new O.Token("link_close","a",-1)).level=--ee,W.markup="linkify",W.info="auto",K.push(W),J=oe[Q].lastIndex);J<Z.length&&((W=new O.Token("text","",0)).content=Z.slice(J),W.level=ee,K.push(W)),se[U].children=j=G(j,B,K)}}else for(B--;j[B].level!==Y.level&&"link_open"!==j[B].type;)B--}},3285:O=>{"use strict";var B=/\r\n?|\n/g,U=/\0/g;O.exports=function(O){var G;G=(G=O.src.replace(B,"\n")).replace(U,""),O.src=G}},5643:O=>{"use strict";var B=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,U=/\((c|tm|r)\)/i,G=/\((c|tm|r)\)/gi,q={c:"",r:"",tm:""};function replaceFn(O,B){return q[B.toLowerCase()]}function replace_scoped(O){var B,U,q=0;for(B=O.length-1;B>=0;B--)"text"!==(U=O[B]).type||q||(U.content=U.content.replace(G,replaceFn)),"link_open"===U.type&&"auto"===U.info&&q--,"link_close"===U.type&&"auto"===U.info&&q++}function replace_rare(O){var U,G,q=0;for(U=O.length-1;U>=0;U--)"text"!==(G=O[U]).type||q||B.test(G.content)&&(G.content=G.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1").replace(/(^|\s)--(?=\s|$)/gm,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1")),"link_open"===G.type&&"auto"===G.info&&q--,"link_close"===G.type&&"auto"===G.info&&q++}O.exports=function(O){var G;if(O.md.options.typographer)for(G=O.tokens.length-1;G>=0;G--)"inline"===O.tokens[G].type&&(U.test(O.tokens[G].content)&&replace_scoped(O.tokens[G].children),B.test(O.tokens[G].content)&&replace_rare(O.tokens[G].children))}},3859:(O,B,U)=>{"use strict";var G=U(9086).isWhiteSpace,q=U(9086).isPunctChar,j=U(9086).isMdAsciiPunct,W=/['"]/,Y=/['"]/g;function replaceAt(O,B,U){return O.slice(0,B)+U+O.slice(B+1)}function process_inlines(O,B){var U,W,K,Q,Z,X,J,ee,te,ie,re,ne,oe,ae,se,le,ce,de,pe,ue,he;for(pe=[],U=0;U<O.length;U++){for(W=O[U],J=O[U].level,ce=pe.length-1;ce>=0&&!(pe[ce].level<=J);ce--);if(pe.length=ce+1,"text"===W.type){Z=0,X=(K=W.content).length;e:for(;Z<X&&(Y.lastIndex=Z,Q=Y.exec(K));){if(se=le=!0,Z=Q.index+1,de="'"===Q[0],te=32,Q.index-1>=0)te=K.charCodeAt(Q.index-1);else for(ce=U-1;ce>=0&&("softbreak"!==O[ce].type&&"hardbreak"!==O[ce].type);ce--)if(O[ce].content){te=O[ce].content.charCodeAt(O[ce].content.length-1);break}if(ie=32,Z<X)ie=K.charCodeAt(Z);else for(ce=U+1;ce<O.length&&("softbreak"!==O[ce].type&&"hardbreak"!==O[ce].type);ce++)if(O[ce].content){ie=O[ce].content.charCodeAt(0);break}if(re=j(te)||q(String.fromCharCode(te)),ne=j(ie)||q(String.fromCharCode(ie)),oe=G(te),(ae=G(ie))?se=!1:ne&&(oe||re||(se=!1)),oe?le=!1:re&&(ae||ne||(le=!1)),34===ie&&'"'===Q[0]&&te>=48&&te<=57&&(le=se=!1),se&&le&&(se=re,le=ne),se||le){if(le)for(ce=pe.length-1;ce>=0&&(ee=pe[ce],!(pe[ce].level<J));ce--)if(ee.single===de&&pe[ce].level===J){ee=pe[ce],de?(ue=B.md.options.quotes[2],he=B.md.options.quotes[3]):(ue=B.md.options.quotes[0],he=B.md.options.quotes[1]),W.content=replaceAt(W.content,Q.index,he),O[ee.token].content=replaceAt(O[ee.token].content,ee.pos,ue),Z+=he.length-1,ee.token===U&&(Z+=ue.length-1),X=(K=W.content).length,pe.length=ce;continue e}se?pe.push({token:U,pos:Q.index,single:de,level:J}):le&&de&&(W.content=replaceAt(W.content,Q.index,""))}else de&&(W.content=replaceAt(W.content,Q.index,""))}}}}O.exports=function(O){var B;if(O.md.options.typographer)for(B=O.tokens.length-1;B>=0;B--)"inline"===O.tokens[B].type&&W.test(O.tokens[B].content)&&process_inlines(O.tokens[B].children,O)}},5748:(O,B,U)=>{"use strict";var G=U(8843);function StateCore(O,B,U){this.src=O,this.env=U,this.tokens=[],this.inlineMode=!1,this.md=B}StateCore.prototype.Token=G,O.exports=StateCore},1418:O=>{"use strict";O.exports=function(O){var B,U,G,q,j,W,Y=O.tokens;for(B=0,U=Y.length;B<U;B++)if("inline"===Y[B].type){for(j=(G=Y[B].children).length,q=0;q<j;q++)"text_special"===G[q].type&&(G[q].type="text");for(q=W=0;q<j;q++)"text"===G[q].type&&q+1<j&&"text"===G[q+1].type?G[q+1].content=G[q].content+G[q+1].content:(q!==W&&(G[W]=G[q]),W++);q!==W&&(G.length=W)}}},5837:O=>{"use strict";var B=/^([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,U=/^([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)$/;O.exports=function(O,G){var q,j,W,Y,K,Q,Z=O.pos;if(60!==O.src.charCodeAt(Z))return!1;for(K=O.pos,Q=O.posMax;;){if(++Z>=Q)return!1;if(60===(Y=O.src.charCodeAt(Z)))return!1;if(62===Y)break}return q=O.src.slice(K+1,Z),U.test(q)?(j=O.md.normalizeLink(q),!!O.md.validateLink(j)&&(G||((W=O.push("link_open","a",1)).attrs=[["href",j]],W.markup="autolink",W.info="auto",(W=O.push("text","",0)).content=O.md.normalizeLinkText(q),(W=O.push("link_close","a",-1)).markup="autolink",W.info="auto"),O.pos+=q.length+2,!0)):!!B.test(q)&&(j=O.md.normalizeLink("mailto:"+q),!!O.md.validateLink(j)&&(G||((W=O.push("link_open","a",1)).attrs=[["href",j]],W.markup="autolink",W.info="auto",(W=O.push("text","",0)).content=O.md.normalizeLinkText(q),(W=O.push("link_close","a",-1)).markup="autolink",W.info="auto"),O.pos+=q.length+2,!0))}},1389:O=>{"use strict";O.exports=function(O,B){var U,G,q,j,W,Y,K,Q,Z=O.pos;if(96!==O.src.charCodeAt(Z))return!1;for(U=Z,Z++,G=O.posMax;Z<G&&96===O.src.charCodeAt(Z);)Z++;if(K=(q=O.src.slice(U,Z)).length,O.backticksScanned&&(O.backticks[K]||0)<=U)return B||(O.pending+=q),O.pos+=K,!0;for(W=Y=Z;-1!==(W=O.src.indexOf("`",Y));){for(Y=W+1;Y<G&&96===O.src.charCodeAt(Y);)Y++;if((Q=Y-W)===K)return B||((j=O.push("code_inline","code",0)).markup=q,j.content=O.src.slice(Z,W).replace(/\n/g," ").replace(/^ (.+) $/,"$1")),O.pos=Y,!0;O.backticks[Q]=W}return O.backticksScanned=!0,B||(O.pending+=q),O.pos+=K,!0}},1503:O=>{"use strict";function processDelimiters(O,B){var U,G,q,j,W,Y,K,Q,Z={},X=B.length;if(X){var J=0,ee=-2,te=[];for(U=0;U<X;U++)if(q=B[U],te.push(0),B[J].marker===q.marker&&ee===q.token-1||(J=U),ee=q.token,q.length=q.length||0,q.close){for(Z.hasOwnProperty(q.marker)||(Z[q.marker]=[-1,-1,-1,-1,-1,-1]),W=Z[q.marker][(q.open?3:0)+q.length%3],Y=G=J-te[J]-1;G>W;G-=te[G]+1)if((j=B[G]).marker===q.marker&&j.open&&j.end<0&&(K=!1,(j.close||q.open)&&(j.length+q.length)%3==0&&(j.length%3==0&&q.length%3==0||(K=!0)),!K)){Q=G>0&&!B[G-1].open?te[G-1]+1:0,te[U]=U-G+Q,te[G]=Q,q.open=!1,j.end=U,j.close=!1,Y=-1,ee=-2;break}-1!==Y&&(Z[q.marker][(q.open?3:0)+(q.length||0)%3]=Y)}}}O.exports=function(O){var B,U=O.tokens_meta,G=O.tokens_meta.length;for(processDelimiters(0,O.delimiters),B=0;B<G;B++)U[B]&&U[B].delimiters&&processDelimiters(0,U[B].delimiters)}},9639:O=>{"use strict";function postProcess(O,B){var U,G,q,j,W,Y;for(U=B.length-1;U>=0;U--)95!==(G=B[U]).marker&&42!==G.marker||-1!==G.end&&(q=B[G.end],Y=U>0&&B[U-1].end===G.end+1&&B[U-1].marker===G.marker&&B[U-1].token===G.token-1&&B[G.end+1].token===q.token+1,W=String.fromCharCode(G.marker),(j=O.tokens[G.token]).type=Y?"strong_open":"em_open",j.tag=Y?"strong":"em",j.nesting=1,j.markup=Y?W+W:W,j.content="",(j=O.tokens[q.token]).type=Y?"strong_close":"em_close",j.tag=Y?"strong":"em",j.nesting=-1,j.markup=Y?W+W:W,j.content="",Y&&(O.tokens[B[U-1].token].content="",O.tokens[B[G.end+1].token].content="",U--))}O.exports.w=function(O,B){var U,G,q=O.pos,j=O.src.charCodeAt(q);if(B)return!1;if(95!==j&&42!==j)return!1;for(G=O.scanDelims(O.pos,42===j),U=0;U<G.length;U++)O.push("text","",0).content=String.fromCharCode(j),O.delimiters.push({marker:j,length:G.length,token:O.tokens.length-1,end:-1,open:G.can_open,close:G.can_close});return O.pos+=G.length,!0},O.exports.g=function(O){var B,U=O.tokens_meta,G=O.tokens_meta.length;for(postProcess(O,O.delimiters),B=0;B<G;B++)U[B]&&U[B].delimiters&&postProcess(O,U[B].delimiters)}},6277:(O,B,U)=>{"use strict";var G=U(4216),q=U(9086).has,j=U(9086).isValidEntityCode,W=U(9086).fromCodePoint,Y=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,K=/^&([a-z][a-z0-9]{1,31});/i;O.exports=function(O,B){var U,Q,Z,X=O.pos,J=O.posMax;if(38!==O.src.charCodeAt(X))return!1;if(X+1>=J)return!1;if(35===O.src.charCodeAt(X+1)){if(Q=O.src.slice(X).match(Y))return B||(U="x"===Q[1][0].toLowerCase()?parseInt(Q[1].slice(1),16):parseInt(Q[1],10),(Z=O.push("text_special","",0)).content=j(U)?W(U):W(65533),Z.markup=Q[0],Z.info="entity"),O.pos+=Q[0].length,!0}else if((Q=O.src.slice(X).match(K))&&q(G,Q[1]))return B||((Z=O.push("text_special","",0)).content=G[Q[1]],Z.markup=Q[0],Z.info="entity"),O.pos+=Q[0].length,!0;return!1}},5491:(O,B,U)=>{"use strict";for(var G=U(9086).isSpace,q=[],j=0;j<256;j++)q.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(O){q[O.charCodeAt(0)]=1})),O.exports=function(O,B){var U,j,W,Y,K,Q=O.pos,Z=O.posMax;if(92!==O.src.charCodeAt(Q))return!1;if(++Q>=Z)return!1;if(10===(U=O.src.charCodeAt(Q))){for(B||O.push("hardbreak","br",0),Q++;Q<Z&&(U=O.src.charCodeAt(Q),G(U));)Q++;return O.pos=Q,!0}return Y=O.src[Q],U>=55296&&U<=56319&&Q+1<Z&&(j=O.src.charCodeAt(Q+1))>=56320&&j<=57343&&(Y+=O.src[Q+1],Q++),W="\\"+Y,B||(K=O.push("text_special","",0),U<256&&0!==q[U]?K.content=Y:K.content=W,K.markup=W,K.info="escape"),O.pos=Q+1,!0}},1305:O=>{"use strict";O.exports=function(O){var B,U,G=0,q=O.tokens,j=O.tokens.length;for(B=U=0;B<j;B++)q[B].nesting<0&&G--,q[B].level=G,q[B].nesting>0&&G++,"text"===q[B].type&&B+1<j&&"text"===q[B+1].type?q[B+1].content=q[B].content+q[B+1].content:(B!==U&&(q[U]=q[B]),U++);B!==U&&(q.length=U)}},6425:(O,B,U)=>{"use strict";var G=U(8247).n;O.exports=function(O,B){var U,q,j,W,Y,K=O.pos;return!!O.md.options.html&&(j=O.posMax,!(60!==O.src.charCodeAt(K)||K+2>=j)&&(!(33!==(U=O.src.charCodeAt(K+1))&&63!==U&&47!==U&&!function(O){var B=32|O;return B>=97&&B<=122}(U))&&(!!(q=O.src.slice(K).match(G))&&(B||((W=O.push("html_inline","",0)).content=O.src.slice(K,K+q[0].length),Y=W.content,/^<a[>\s]/i.test(Y)&&O.linkLevel++,function(O){return/^<\/a\s*>/i.test(O)}(W.content)&&O.linkLevel--),O.pos+=q[0].length,!0))))}},4506:(O,B,U)=>{"use strict";var G=U(9086).normalizeReference,q=U(9086).isSpace;O.exports=function(O,B){var U,j,W,Y,K,Q,Z,X,J,ee,te,ie,re,ne="",oe=O.pos,ae=O.posMax;if(33!==O.src.charCodeAt(O.pos))return!1;if(91!==O.src.charCodeAt(O.pos+1))return!1;if(Q=O.pos+2,(K=O.md.helpers.parseLinkLabel(O,O.pos+1,!1))<0)return!1;if((Z=K+1)<ae&&40===O.src.charCodeAt(Z)){for(Z++;Z<ae&&(j=O.src.charCodeAt(Z),q(j)||10===j);Z++);if(Z>=ae)return!1;for(re=Z,(J=O.md.helpers.parseLinkDestination(O.src,Z,O.posMax)).ok&&(ne=O.md.normalizeLink(J.str),O.md.validateLink(ne)?Z=J.pos:ne=""),re=Z;Z<ae&&(j=O.src.charCodeAt(Z),q(j)||10===j);Z++);if(J=O.md.helpers.parseLinkTitle(O.src,Z,O.posMax),Z<ae&&re!==Z&&J.ok)for(ee=J.str,Z=J.pos;Z<ae&&(j=O.src.charCodeAt(Z),q(j)||10===j);Z++);else ee="";if(Z>=ae||41!==O.src.charCodeAt(Z))return O.pos=oe,!1;Z++}else{if(void 0===O.env.references)return!1;if(Z<ae&&91===O.src.charCodeAt(Z)?(re=Z+1,(Z=O.md.helpers.parseLinkLabel(O,Z))>=0?Y=O.src.slice(re,Z++):Z=K+1):Z=K+1,Y||(Y=O.src.slice(Q,K)),!(X=O.env.references[G(Y)]))return O.pos=oe,!1;ne=X.href,ee=X.title}return B||(W=O.src.slice(Q,K),O.md.inline.parse(W,O.md,O.env,ie=[]),(te=O.push("image","img",0)).attrs=U=[["src",ne],["alt",""]],te.children=ie,te.content=W,ee&&U.push(["title",ee])),O.pos=Z,O.posMax=ae,!0}},4771:(O,B,U)=>{"use strict";var G=U(9086).normalizeReference,q=U(9086).isSpace;O.exports=function(O,B){var U,j,W,Y,K,Q,Z,X,J="",ee="",te=O.pos,ie=O.posMax,re=O.pos,ne=!0;if(91!==O.src.charCodeAt(O.pos))return!1;if(K=O.pos+1,(Y=O.md.helpers.parseLinkLabel(O,O.pos,!0))<0)return!1;if((Q=Y+1)<ie&&40===O.src.charCodeAt(Q)){for(ne=!1,Q++;Q<ie&&(j=O.src.charCodeAt(Q),q(j)||10===j);Q++);if(Q>=ie)return!1;if(re=Q,(Z=O.md.helpers.parseLinkDestination(O.src,Q,O.posMax)).ok){for(J=O.md.normalizeLink(Z.str),O.md.validateLink(J)?Q=Z.pos:J="",re=Q;Q<ie&&(j=O.src.charCodeAt(Q),q(j)||10===j);Q++);if(Z=O.md.helpers.parseLinkTitle(O.src,Q,O.posMax),Q<ie&&re!==Q&&Z.ok)for(ee=Z.str,Q=Z.pos;Q<ie&&(j=O.src.charCodeAt(Q),q(j)||10===j);Q++);}(Q>=ie||41!==O.src.charCodeAt(Q))&&(ne=!0),Q++}if(ne){if(void 0===O.env.references)return!1;if(Q<ie&&91===O.src.charCodeAt(Q)?(re=Q+1,(Q=O.md.helpers.parseLinkLabel(O,Q))>=0?W=O.src.slice(re,Q++):Q=Y+1):Q=Y+1,W||(W=O.src.slice(K,Y)),!(X=O.env.references[G(W)]))return O.pos=te,!1;J=X.href,ee=X.title}return B||(O.pos=K,O.posMax=Y,O.push("link_open","a",1).attrs=U=[["href",J]],ee&&U.push(["title",ee]),O.linkLevel++,O.md.inline.tokenize(O),O.linkLevel--,O.push("link_close","a",-1)),O.pos=Q,O.posMax=ie,!0}},2386:O=>{"use strict";var B=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;O.exports=function(O,U){var G,q,j,W,Y,K,Q;return!!O.md.options.linkify&&(!(O.linkLevel>0)&&(!((G=O.pos)+3>O.posMax)&&(58===O.src.charCodeAt(G)&&(47===O.src.charCodeAt(G+1)&&(47===O.src.charCodeAt(G+2)&&(!!(q=O.pending.match(B))&&(j=q[1],!!(W=O.md.linkify.matchAtStart(O.src.slice(G-j.length)))&&(Y=(Y=W.url).replace(/\*+$/,""),K=O.md.normalizeLink(Y),!!O.md.validateLink(K)&&(U||(O.pending=O.pending.slice(0,-j.length),(Q=O.push("link_open","a",1)).attrs=[["href",K]],Q.markup="linkify",Q.info="auto",(Q=O.push("text","",0)).content=O.md.normalizeLinkText(Y),(Q=O.push("link_close","a",-1)).markup="linkify",Q.info="auto"),O.pos+=Y.length-j.length,!0)))))))))}},7014:(O,B,U)=>{"use strict";var G=U(9086).isSpace;O.exports=function(O,B){var U,q,j,W=O.pos;if(10!==O.src.charCodeAt(W))return!1;if(U=O.pending.length-1,q=O.posMax,!B)if(U>=0&&32===O.pending.charCodeAt(U))if(U>=1&&32===O.pending.charCodeAt(U-1)){for(j=U-1;j>=1&&32===O.pending.charCodeAt(j-1);)j--;O.pending=O.pending.slice(0,j),O.push("hardbreak","br",0)}else O.pending=O.pending.slice(0,-1),O.push("softbreak","br",0);else O.push("softbreak","br",0);for(W++;W<q&&G(O.src.charCodeAt(W));)W++;return O.pos=W,!0}},5793:(O,B,U)=>{"use strict";var G=U(8843),q=U(9086).isWhiteSpace,j=U(9086).isPunctChar,W=U(9086).isMdAsciiPunct;function StateInline(O,B,U,G){this.src=O,this.env=U,this.md=B,this.tokens=G,this.tokens_meta=Array(G.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}StateInline.prototype.pushPending=function(){var O=new G("text","",0);return O.content=this.pending,O.level=this.pendingLevel,this.tokens.push(O),this.pending="",O},StateInline.prototype.push=function(O,B,U){this.pending&&this.pushPending();var q=new G(O,B,U),j=null;return U<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),q.level=this.level,U>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],j={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(q),this.tokens_meta.push(j),q},StateInline.prototype.scanDelims=function(O,B){var U,G,Y,K,Q,Z,X,J,ee,te=O,ie=!0,re=!0,ne=this.posMax,oe=this.src.charCodeAt(O);for(U=O>0?this.src.charCodeAt(O-1):32;te<ne&&this.src.charCodeAt(te)===oe;)te++;return Y=te-O,G=te<ne?this.src.charCodeAt(te):32,X=W(U)||j(String.fromCharCode(U)),ee=W(G)||j(String.fromCharCode(G)),Z=q(U),(J=q(G))?ie=!1:ee&&(Z||X||(ie=!1)),Z?re=!1:X&&(J||ee||(re=!1)),B?(K=ie,Q=re):(K=ie&&(!re||X),Q=re&&(!ie||ee)),{can_open:K,can_close:Q,length:Y}},StateInline.prototype.Token=G,O.exports=StateInline},1606:O=>{"use strict";function postProcess(O,B){var U,G,q,j,W,Y=[],K=B.length;for(U=0;U<K;U++)126===(q=B[U]).marker&&-1!==q.end&&(j=B[q.end],(W=O.tokens[q.token]).type="s_open",W.tag="s",W.nesting=1,W.markup="~~",W.content="",(W=O.tokens[j.token]).type="s_close",W.tag="s",W.nesting=-1,W.markup="~~",W.content="","text"===O.tokens[j.token-1].type&&"~"===O.tokens[j.token-1].content&&Y.push(j.token-1));for(;Y.length;){for(G=(U=Y.pop())+1;G<O.tokens.length&&"s_close"===O.tokens[G].type;)G++;U!==--G&&(W=O.tokens[G],O.tokens[G]=O.tokens[U],O.tokens[U]=W)}}O.exports.w=function(O,B){var U,G,q,j,W=O.pos,Y=O.src.charCodeAt(W);if(B)return!1;if(126!==Y)return!1;if(q=(G=O.scanDelims(O.pos,!0)).length,j=String.fromCharCode(Y),q<2)return!1;for(q%2&&(O.push("text","",0).content=j,q--),U=0;U<q;U+=2)O.push("text","",0).content=j+j,O.delimiters.push({marker:Y,length:0,token:O.tokens.length-1,end:-1,open:G.can_open,close:G.can_close});return O.pos+=G.length,!0},O.exports.g=function(O){var B,U=O.tokens_meta,G=O.tokens_meta.length;for(postProcess(O,O.delimiters),B=0;B<G;B++)U[B]&&U[B].delimiters&&postProcess(O,U[B].delimiters)}},9431:O=>{"use strict";function isTerminatorChar(O){switch(O){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}O.exports=function(O,B){for(var U=O.pos;U<O.posMax&&!isTerminatorChar(O.src.charCodeAt(U));)U++;return U!==O.pos&&(B||(O.pending+=O.src.slice(O.pos,U)),O.pos=U,!0)}},8843:O=>{"use strict";function Token(O,B,U){this.type=O,this.tag=B,this.attrs=null,this.map=null,this.nesting=U,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Token.prototype.attrIndex=function(O){var B,U,G;if(!this.attrs)return-1;for(U=0,G=(B=this.attrs).length;U<G;U++)if(B[U][0]===O)return U;return-1},Token.prototype.attrPush=function(O){this.attrs?this.attrs.push(O):this.attrs=[O]},Token.prototype.attrSet=function(O,B){var U=this.attrIndex(O),G=[O,B];U<0?this.attrPush(G):this.attrs[U]=G},Token.prototype.attrGet=function(O){var B=this.attrIndex(O),U=null;return B>=0&&(U=this.attrs[B][1]),U},Token.prototype.attrJoin=function(O,B){var U=this.attrIndex(O);U<0?this.attrPush([O,B]):this.attrs[U][1]=this.attrs[U][1]+" "+B},O.exports=Token},5036:O=>{"use strict";var B={};function decode(O,U){var G;return"string"!=typeof U&&(U=decode.defaultChars),G=function(O){var U,G,q=B[O];if(q)return q;for(q=B[O]=[],U=0;U<128;U++)G=String.fromCharCode(U),q.push(G);for(U=0;U<O.length;U++)q[G=O.charCodeAt(U)]="%"+("0"+G.toString(16).toUpperCase()).slice(-2);return q}(U),O.replace(/(%[a-f0-9]{2})+/gi,(function(O){var B,U,q,j,W,Y,K,Q="";for(B=0,U=O.length;B<U;B+=3)(q=parseInt(O.slice(B+1,B+3),16))<128?Q+=G[q]:192==(224&q)&&B+3<U&&128==(192&(j=parseInt(O.slice(B+4,B+6),16)))?(Q+=(K=q<<6&1984|63&j)<128?"":String.fromCharCode(K),B+=3):224==(240&q)&&B+6<U&&(j=parseInt(O.slice(B+4,B+6),16),W=parseInt(O.slice(B+7,B+9),16),128==(192&j)&&128==(192&W))?(Q+=(K=q<<12&61440|j<<6&4032|63&W)<2048||K>=55296&&K<=57343?"":String.fromCharCode(K),B+=6):240==(248&q)&&B+9<U&&(j=parseInt(O.slice(B+4,B+6),16),W=parseInt(O.slice(B+7,B+9),16),Y=parseInt(O.slice(B+10,B+12),16),128==(192&j)&&128==(192&W)&&128==(192&Y))?((K=q<<18&1835008|j<<12&258048|W<<6&4032|63&Y)<65536||K>1114111?Q+="":(K-=65536,Q+=String.fromCharCode(55296+(K>>10),56320+(1023&K))),B+=9):Q+="";return Q}))}decode.defaultChars=";/?:@&=+$,#",decode.componentChars="",O.exports=decode},2030:O=>{"use strict";var B={};function encode(O,U,G){var q,j,W,Y,K,Q="";for("string"!=typeof U&&(G=U,U=encode.defaultChars),void 0===G&&(G=!0),K=function(O){var U,G,q=B[O];if(q)return q;for(q=B[O]=[],U=0;U<128;U++)G=String.fromCharCode(U),/^[0-9a-z]$/i.test(G)?q.push(G):q.push("%"+("0"+U.toString(16).toUpperCase()).slice(-2));for(U=0;U<O.length;U++)q[O.charCodeAt(U)]=O[U];return q}(U),q=0,j=O.length;q<j;q++)if(W=O.charCodeAt(q),G&&37===W&&q+2<j&&/^[0-9a-f]{2}$/i.test(O.slice(q+1,q+3)))Q+=O.slice(q,q+3),q+=2;else if(W<128)Q+=K[W];else if(W>=55296&&W<=57343){if(W>=55296&&W<=56319&&q+1<j&&(Y=O.charCodeAt(q+1))>=56320&&Y<=57343){Q+=encodeURIComponent(O[q]+O[q+1]),q++;continue}Q+="%EF%BF%BD"}else Q+=encodeURIComponent(O[q]);return Q}encode.defaultChars=";/?:@&=+$,-_.!~*'()#",encode.componentChars="-_.!~*'()",O.exports=encode},576:O=>{"use strict";O.exports=function(O){var B="";return B+=O.protocol||"",B+=O.slashes?"//":"",B+=O.auth?O.auth+"@":"",O.hostname&&-1!==O.hostname.indexOf(":")?B+="["+O.hostname+"]":B+=O.hostname||"",B+=O.port?":"+O.port:"",B+=O.pathname||"",B+=O.search||"",B+=O.hash||""}},3771:(O,B,U)=>{"use strict";O.exports.encode=U(2030),O.exports.decode=U(5036),O.exports.format=U(576),O.exports.parse=U(167)},167:O=>{"use strict";function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var B=/^([a-z0-9.+-]+:)/i,U=/:[0-9]*$/,G=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,q=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),j=["'"].concat(q),W=["%","/","?",";","#"].concat(j),Y=["/","?","#"],K=/^[+a-z0-9A-Z_-]{0,63}$/,Q=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Z={javascript:!0,"javascript:":!0},X={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};Url.prototype.parse=function(O,U){var q,j,J,ee,te,ie=O;if(ie=ie.trim(),!U&&1===O.split("#").length){var re=G.exec(ie);if(re)return this.pathname=re[1],re[2]&&(this.search=re[2]),this}var ne=B.exec(ie);if(ne&&(J=(ne=ne[0]).toLowerCase(),this.protocol=ne,ie=ie.substr(ne.length)),(U||ne||ie.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(te="//"===ie.substr(0,2))||ne&&Z[ne]||(ie=ie.substr(2),this.slashes=!0)),!Z[ne]&&(te||ne&&!X[ne])){var oe,ae,se=-1;for(q=0;q<Y.length;q++)-1!==(ee=ie.indexOf(Y[q]))&&(-1===se||ee<se)&&(se=ee);for(-1!==(ae=-1===se?ie.lastIndexOf("@"):ie.lastIndexOf("@",se))&&(oe=ie.slice(0,ae),ie=ie.slice(ae+1),this.auth=oe),se=-1,q=0;q<W.length;q++)-1!==(ee=ie.indexOf(W[q]))&&(-1===se||ee<se)&&(se=ee);-1===se&&(se=ie.length),":"===ie[se-1]&&se--;var le=ie.slice(0,se);ie=ie.slice(se),this.parseHost(le),this.hostname=this.hostname||"";var ce="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ce){var de=this.hostname.split(/\./);for(q=0,j=de.length;q<j;q++){var pe=de[q];if(pe&&!pe.match(K)){for(var ue="",he=0,me=pe.length;he<me;he++)pe.charCodeAt(he)>127?ue+="x":ue+=pe[he];if(!ue.match(K)){var ge=de.slice(0,q),fe=de.slice(q+1),ye=pe.match(Q);ye&&(ge.push(ye[1]),fe.unshift(ye[2])),fe.length&&(ie=fe.join(".")+ie),this.hostname=ge.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),ce&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var _e=ie.indexOf("#");-1!==_e&&(this.hash=ie.substr(_e),ie=ie.slice(0,_e));var ve=ie.indexOf("?");return-1!==ve&&(this.search=ie.substr(ve),ie=ie.slice(0,ve)),ie&&(this.pathname=ie),X[J]&&this.hostname&&!this.pathname&&(this.pathname=""),this},Url.prototype.parseHost=function(O){var B=U.exec(O);B&&(":"!==(B=B[0])&&(this.port=B.substr(1)),O=O.substr(0,O.length-B.length)),O&&(this.hostname=O)},O.exports=function(O,B){if(O&&O instanceof Url)return O;var U=new Url;return U.parse(O,B),U}},2322:(O,B,U)=>{"use strict";U.r(B),U.d(B,{ucs2decode:()=>ucs2decode,ucs2encode:()=>ucs2encode,decode:()=>decode,encode:()=>encode,toASCII:()=>toASCII,toUnicode:()=>toUnicode,default:()=>X});const G=2147483647,q=36,j=/^xn--/,W=/[^\0-\x7E]/,Y=/[\x2E\u3002\uFF0E\uFF61]/g,K={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Q=Math.floor,Z=String.fromCharCode;function error(O){throw new RangeError(K[O])}function mapDomain(O,B){const U=O.split("@");let G="";U.length>1&&(G=U[0]+"@",O=U[1]);const q=function(O,B){const U=[];let G=O.length;for(;G--;)U[G]=B(O[G]);return U}((O=O.replace(Y,".")).split("."),B).join(".");return G+q}function ucs2decode(O){const B=[];let U=0;const G=O.length;for(;U<G;){const q=O.charCodeAt(U++);if(q>=55296&&q<=56319&&U<G){const G=O.charCodeAt(U++);56320==(64512&G)?B.push(((1023&q)<<10)+(1023&G)+65536):(B.push(q),U--)}else B.push(q)}return B}const ucs2encode=O=>String.fromCodePoint(...O),digitToBasic=function(O,B){return O+22+75*(O<26)-((0!=B)<<5)},adapt=function(O,B,U){let G=0;for(O=U?Q(O/700):O>>1,O+=Q(O/B);O>455;G+=q)O=Q(O/35);return Q(G+36*O/(O+38))},decode=function(O){const B=[],U=O.length;let j=0,W=128,Y=72,K=O.lastIndexOf("-");K<0&&(K=0);for(let U=0;U<K;++U)O.charCodeAt(U)>=128&&error("not-basic"),B.push(O.charCodeAt(U));for(let X=K>0?K+1:0;X<U;){let K=j;for(let B=1,W=q;;W+=q){X>=U&&error("invalid-input");const K=(Z=O.charCodeAt(X++))-48<10?Z-22:Z-65<26?Z-65:Z-97<26?Z-97:q;(K>=q||K>Q((G-j)/B))&&error("overflow"),j+=K*B;const J=W<=Y?1:W>=Y+26?26:W-Y;if(K<J)break;const ee=q-J;B>Q(G/ee)&&error("overflow"),B*=ee}const J=B.length+1;Y=adapt(j-K,J,0==K),Q(j/J)>G-W&&error("overflow"),W+=Q(j/J),j%=J,B.splice(j++,0,W)}var Z;return String.fromCodePoint(...B)},encode=function(O){const B=[];let U=(O=ucs2decode(O)).length,j=128,W=0,Y=72;for(const U of O)U<128&&B.push(Z(U));let K=B.length,X=K;for(K&&B.push("-");X<U;){let U=G;for(const B of O)B>=j&&B<U&&(U=B);const J=X+1;U-j>Q((G-W)/J)&&error("overflow"),W+=(U-j)*J,j=U;for(const U of O)if(U<j&&++W>G&&error("overflow"),U==j){let O=W;for(let U=q;;U+=q){const G=U<=Y?1:U>=Y+26?26:U-Y;if(O<G)break;const j=O-G,W=q-G;B.push(Z(digitToBasic(G+j%W,0))),O=Q(j/W)}B.push(Z(digitToBasic(O,0))),Y=adapt(W,J,X==K),W=0,++X}++W,++j}return B.join("")},toUnicode=function(O){return mapDomain(O,(function(O){return j.test(O)?decode(O.slice(4).toLowerCase()):O}))},toASCII=function(O){return mapDomain(O,(function(O){return W.test(O)?"xn--"+encode(O):O}))},X={version:"2.1.0",ucs2:{decode:ucs2decode,encode:ucs2encode},decode,encode,toASCII,toUnicode}},355:O=>{O.exports=/[\0-\x1F\x7F-\x9F]/},9591:O=>{O.exports=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/},6121:O=>{O.exports=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/},21:O=>{O.exports=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/},8274:(O,B,U)=>{"use strict";B.Any=U(1816),B.Cc=U(355),B.Cf=U(9591),B.P=U(6121),B.Z=U(21)},1816:O=>{O.exports=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/},9870:(O,B,U)=>{var G;var q=Object.hasOwnProperty,j=Object.setPrototypeOf,W=Object.isFrozen,Y=Object.getPrototypeOf,K=Object.getOwnPropertyDescriptor,Q=Object.freeze,Z=Object.seal,X=Object.create,J="undefined"!=typeof Reflect&&Reflect,ee=J.apply,te=J.construct;ee||(ee=function(O,B,U){return O.apply(B,U)}),Q||(Q=function(O){return O}),Z||(Z=function(O){return O}),te||(te=function(O,B){return new(Function.prototype.bind.apply(O,[null].concat(function(O){if(Array.isArray(O)){for(var B=0,U=Array(O.length);B<O.length;B++)U[B]=O[B];return U}return Array.from(O)}(B))))});var ie,re=unapply(Array.prototype.forEach),ne=unapply(Array.prototype.pop),oe=unapply(Array.prototype.push),ae=unapply(String.prototype.toLowerCase),se=unapply(String.prototype.match),le=unapply(String.prototype.replace),ce=unapply(String.prototype.indexOf),de=unapply(String.prototype.trim),pe=unapply(RegExp.prototype.test),ue=(ie=TypeError,function(){for(var O=arguments.length,B=Array(O),U=0;U<O;U++)B[U]=arguments[U];return te(ie,B)});function unapply(O){return function(B){for(var U=arguments.length,G=Array(U>1?U-1:0),q=1;q<U;q++)G[q-1]=arguments[q];return ee(O,B,G)}}function addToSet(O,B){j&&j(O,null);for(var U=B.length;U--;){var G=B[U];if("string"==typeof G){var q=ae(G);q!==G&&(W(B)||(B[U]=q),G=q)}O[G]=!0}return O}function clone(O){var B=X(null),U=void 0;for(U in O)ee(q,O,[U])&&(B[U]=O[U]);return B}function lookupGetter(O,B){for(;null!==O;){var U=K(O,B);if(U){if(U.get)return unapply(U.get);if("function"==typeof U.value)return unapply(U.value)}O=Y(O)}return function(O){return console.warn("fallback value for",O),null}}var he=Q(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),me=Q(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ge=Q(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),fe=Q(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ye=Q(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),_e=Q(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ve=Q(["#text"]),be=Q(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Se=Q(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ce=Q(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ee=Q(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xe=Z(/\{\{[\s\S]*|[\s\S]*\}\}/gm),Te=Z(/<%[\s\S]*|[\s\S]*%>/gm),we=Z(/^data-[\-\w.\u00B7-\uFFFF]/),ke=Z(/^aria-[\-\w]+$/),Ae=Z(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Re=Z(/^(?:\w+script|data):/i),Ie=Z(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O};function _toConsumableArray$1(O){if(Array.isArray(O)){for(var B=0,U=Array(O.length);B<O.length;B++)U[B]=O[B];return U}return Array.from(O)}var getGlobal=function(){return"undefined"==typeof window?null:window},_createTrustedTypesPolicy=function(O,B){if("object"!==(void 0===O?"undefined":Pe(O))||"function"!=typeof O.createPolicy)return null;var U=null,G="data-tt-policy-suffix";B.currentScript&&B.currentScript.hasAttribute(G)&&(U=B.currentScript.getAttribute(G));var q="dompurify"+(U?"#"+U:"");try{return O.createPolicy(q,{createHTML:function(O){return O}})}catch(O){return console.warn("TrustedTypes policy "+q+" could not be created."),null}};var Ne=function createDOMPurify(){var O=arguments.length>0&&void 0!==arguments[0]?arguments[0]:getGlobal(),DOMPurify=function(O){return createDOMPurify(O)};if(DOMPurify.version="2.3.1",DOMPurify.removed=[],!O||!O.document||9!==O.document.nodeType)return DOMPurify.isSupported=!1,DOMPurify;var B=O.document,U=O.document,G=O.DocumentFragment,q=O.HTMLTemplateElement,j=O.Node,W=O.Element,Y=O.NodeFilter,K=O.NamedNodeMap,Z=void 0===K?O.NamedNodeMap||O.MozNamedAttrMap:K,X=O.Text,J=O.Comment,ee=O.DOMParser,te=O.trustedTypes,ie=W.prototype,Ne=lookupGetter(ie,"cloneNode"),Oe=lookupGetter(ie,"nextSibling"),Me=lookupGetter(ie,"childNodes"),De=lookupGetter(ie,"parentNode");if("function"==typeof q){var Le=U.createElement("template");Le.content&&Le.content.ownerDocument&&(U=Le.content.ownerDocument)}var Be=_createTrustedTypesPolicy(te,B),Fe=Be&&ft?Be.createHTML(""):"",ze=U,$e=ze.implementation,Ue=ze.createNodeIterator,Ve=ze.createDocumentFragment,Ge=ze.getElementsByTagName,He=B.importNode,qe={};try{qe=clone(U).documentMode?U.documentMode:{}}catch(O){}var je={};DOMPurify.isSupported="function"==typeof De&&$e&&void 0!==$e.createHTMLDocument&&9!==qe;var We=xe,Ye=Te,Ke=we,Qe=ke,Ze=Re,Xe=Ie,Je=Ae,et=null,tt=addToSet({},[].concat(_toConsumableArray$1(he),_toConsumableArray$1(me),_toConsumableArray$1(ge),_toConsumableArray$1(ye),_toConsumableArray$1(ve))),it=null,rt=addToSet({},[].concat(_toConsumableArray$1(be),_toConsumableArray$1(Se),_toConsumableArray$1(Ce),_toConsumableArray$1(Ee))),nt=null,ot=null,at=!0,st=!0,lt=!1,ct=!1,dt=!1,pt=!1,ut=!1,ht=!1,mt=!1,gt=!0,ft=!1,yt=!0,_t=!0,vt=!1,bt={},St=null,Ct=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Et=null,xt=addToSet({},["audio","video","img","source","image","track"]),Tt=null,wt=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),kt="http://www.w3.org/1998/Math/MathML",At="http://www.w3.org/2000/svg",Rt="http://www.w3.org/1999/xhtml",It=Rt,Pt=!1,Nt=null,Ot=U.createElement("form"),_parseConfig=function(O){Nt&&Nt===O||(O&&"object"===(void 0===O?"undefined":Pe(O))||(O={}),O=clone(O),et="ALLOWED_TAGS"in O?addToSet({},O.ALLOWED_TAGS):tt,it="ALLOWED_ATTR"in O?addToSet({},O.ALLOWED_ATTR):rt,Tt="ADD_URI_SAFE_ATTR"in O?addToSet(clone(wt),O.ADD_URI_SAFE_ATTR):wt,Et="ADD_DATA_URI_TAGS"in O?addToSet(clone(xt),O.ADD_DATA_URI_TAGS):xt,St="FORBID_CONTENTS"in O?addToSet({},O.FORBID_CONTENTS):Ct,nt="FORBID_TAGS"in O?addToSet({},O.FORBID_TAGS):{},ot="FORBID_ATTR"in O?addToSet({},O.FORBID_ATTR):{},bt="USE_PROFILES"in O&&O.USE_PROFILES,at=!1!==O.ALLOW_ARIA_ATTR,st=!1!==O.ALLOW_DATA_ATTR,lt=O.ALLOW_UNKNOWN_PROTOCOLS||!1,ct=O.SAFE_FOR_TEMPLATES||!1,dt=O.WHOLE_DOCUMENT||!1,ht=O.RETURN_DOM||!1,mt=O.RETURN_DOM_FRAGMENT||!1,gt=!1!==O.RETURN_DOM_IMPORT,ft=O.RETURN_TRUSTED_TYPE||!1,ut=O.FORCE_BODY||!1,yt=!1!==O.SANITIZE_DOM,_t=!1!==O.KEEP_CONTENT,vt=O.IN_PLACE||!1,Je=O.ALLOWED_URI_REGEXP||Je,It=O.NAMESPACE||Rt,ct&&(st=!1),mt&&(ht=!0),bt&&(et=addToSet({},[].concat(_toConsumableArray$1(ve))),it=[],!0===bt.html&&(addToSet(et,he),addToSet(it,be)),!0===bt.svg&&(addToSet(et,me),addToSet(it,Se),addToSet(it,Ee)),!0===bt.svgFilters&&(addToSet(et,ge),addToSet(it,Se),addToSet(it,Ee)),!0===bt.mathMl&&(addToSet(et,ye),addToSet(it,Ce),addToSet(it,Ee))),O.ADD_TAGS&&(et===tt&&(et=clone(et)),addToSet(et,O.ADD_TAGS)),O.ADD_ATTR&&(it===rt&&(it=clone(it)),addToSet(it,O.ADD_ATTR)),O.ADD_URI_SAFE_ATTR&&addToSet(Tt,O.ADD_URI_SAFE_ATTR),O.FORBID_CONTENTS&&(St===Ct&&(St=clone(St)),addToSet(St,O.FORBID_CONTENTS)),_t&&(et["#text"]=!0),dt&&addToSet(et,["html","head","body"]),et.table&&(addToSet(et,["tbody"]),delete nt.tbody),Q&&Q(O),Nt=O)},Mt=addToSet({},["mi","mo","mn","ms","mtext"]),Dt=addToSet({},["foreignobject","desc","title","annotation-xml"]),Lt=addToSet({},me);addToSet(Lt,ge),addToSet(Lt,fe);var Bt=addToSet({},ye);addToSet(Bt,_e);var _checkValidNamespace=function(O){var B=De(O);B&&B.tagName||(B={namespaceURI:Rt,tagName:"template"});var U=ae(O.tagName),G=ae(B.tagName);if(O.namespaceURI===At)return B.namespaceURI===Rt?"svg"===U:B.namespaceURI===kt?"svg"===U&&("annotation-xml"===G||Mt[G]):Boolean(Lt[U]);if(O.namespaceURI===kt)return B.namespaceURI===Rt?"math"===U:B.namespaceURI===At?"math"===U&&Dt[G]:Boolean(Bt[U]);if(O.namespaceURI===Rt){if(B.namespaceURI===At&&!Dt[G])return!1;if(B.namespaceURI===kt&&!Mt[G])return!1;var q=addToSet({},["title","style","font","a","script"]);return!Bt[U]&&(q[U]||!Lt[U])}return!1},_forceRemove=function(O){oe(DOMPurify.removed,{element:O});try{O.parentNode.removeChild(O)}catch(B){try{O.outerHTML=Fe}catch(B){O.remove()}}},_removeAttribute=function(O,B){try{oe(DOMPurify.removed,{attribute:B.getAttributeNode(O),from:B})}catch(O){oe(DOMPurify.removed,{attribute:null,from:B})}if(B.removeAttribute(O),"is"===O&&!it[O])if(ht||mt)try{_forceRemove(B)}catch(O){}else try{B.setAttribute(O,"")}catch(O){}},_initDocument=function(O){var B=void 0,G=void 0;if(ut)O="<remove></remove>"+O;else{var q=se(O,/^[\r\n\t ]+/);G=q&&q[0]}var j=Be?Be.createHTML(O):O;if(It===Rt)try{B=(new ee).parseFromString(j,"text/html")}catch(O){}if(!B||!B.documentElement){B=$e.createDocument(It,"template",null);try{B.documentElement.innerHTML=Pt?"":j}catch(O){}}var W=B.body||B.documentElement;return O&&G&&W.insertBefore(U.createTextNode(G),W.childNodes[0]||null),It===Rt?Ge.call(B,dt?"html":"body")[0]:dt?B.documentElement:W},_createIterator=function(O){return Ue.call(O.ownerDocument||O,O,Y.SHOW_ELEMENT|Y.SHOW_COMMENT|Y.SHOW_TEXT,null,!1)},_isClobbered=function(O){return!(O instanceof X||O instanceof J)&&!("string"==typeof O.nodeName&&"string"==typeof O.textContent&&"function"==typeof O.removeChild&&O.attributes instanceof Z&&"function"==typeof O.removeAttribute&&"function"==typeof O.setAttribute&&"string"==typeof O.namespaceURI&&"function"==typeof O.insertBefore)},_isNode=function(O){return"object"===(void 0===j?"undefined":Pe(j))?O instanceof j:O&&"object"===(void 0===O?"undefined":Pe(O))&&"number"==typeof O.nodeType&&"string"==typeof O.nodeName},_executeHook=function(O,B,U){je[O]&&re(je[O],(function(O){O.call(DOMPurify,B,U,Nt)}))},_sanitizeElements=function(O){var B=void 0;if(_executeHook("beforeSanitizeElements",O,null),_isClobbered(O))return _forceRemove(O),!0;if(se(O.nodeName,/[\u0080-\uFFFF]/))return _forceRemove(O),!0;var U=ae(O.nodeName);if(_executeHook("uponSanitizeElement",O,{tagName:U,allowedTags:et}),!_isNode(O.firstElementChild)&&(!_isNode(O.content)||!_isNode(O.content.firstElementChild))&&pe(/<[/\w]/g,O.innerHTML)&&pe(/<[/\w]/g,O.textContent))return _forceRemove(O),!0;if("select"===U&&pe(/<template/i,O.innerHTML))return _forceRemove(O),!0;if(!et[U]||nt[U]){if(_t&&!St[U]){var G=De(O)||O.parentNode,q=Me(O)||O.childNodes;if(q&&G)for(var j=q.length-1;j>=0;--j)G.insertBefore(Ne(q[j],!0),Oe(O))}return _forceRemove(O),!0}return O instanceof W&&!_checkValidNamespace(O)?(_forceRemove(O),!0):"noscript"!==U&&"noembed"!==U||!pe(/<\/no(script|embed)/i,O.innerHTML)?(ct&&3===O.nodeType&&(B=O.textContent,B=le(B,We," "),B=le(B,Ye," "),O.textContent!==B&&(oe(DOMPurify.removed,{element:O.cloneNode()}),O.textContent=B)),_executeHook("afterSanitizeElements",O,null),!1):(_forceRemove(O),!0)},_isValidAttribute=function(O,B,G){if(yt&&("id"===B||"name"===B)&&(G in U||G in Ot))return!1;if(st&&!ot[B]&&pe(Ke,B));else if(at&&pe(Qe,B));else{if(!it[B]||ot[B])return!1;if(Tt[B]);else if(pe(Je,le(G,Xe,"")));else if("src"!==B&&"xlink:href"!==B&&"href"!==B||"script"===O||0!==ce(G,"data:")||!Et[O]){if(lt&&!pe(Ze,le(G,Xe,"")));else if(G)return!1}else;}return!0},_sanitizeAttributes=function(O){var B=void 0,U=void 0,G=void 0,q=void 0;_executeHook("beforeSanitizeAttributes",O,null);var j=O.attributes;if(j){var W={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:it};for(q=j.length;q--;){var Y=B=j[q],K=Y.name,Q=Y.namespaceURI;if(U=de(B.value),G=ae(K),W.attrName=G,W.attrValue=U,W.keepAttr=!0,W.forceKeepAttr=void 0,_executeHook("uponSanitizeAttribute",O,W),U=W.attrValue,!W.forceKeepAttr&&(_removeAttribute(K,O),W.keepAttr))if(pe(/\/>/i,U))_removeAttribute(K,O);else{ct&&(U=le(U,We," "),U=le(U,Ye," "));var Z=O.nodeName.toLowerCase();if(_isValidAttribute(Z,G,U))try{Q?O.setAttributeNS(Q,K,U):O.setAttribute(K,U),ne(DOMPurify.removed)}catch(O){}}}_executeHook("afterSanitizeAttributes",O,null)}},Ft=function _sanitizeShadowDOM(O){var B=void 0,U=_createIterator(O);for(_executeHook("beforeSanitizeShadowDOM",O,null);B=U.nextNode();)_executeHook("uponSanitizeShadowNode",B,null),_sanitizeElements(B)||(B.content instanceof G&&_sanitizeShadowDOM(B.content),_sanitizeAttributes(B));_executeHook("afterSanitizeShadowDOM",O,null)};return DOMPurify.sanitize=function(U,q){var W=void 0,Y=void 0,K=void 0,Q=void 0,Z=void 0;if((Pt=!U)&&(U="\x3c!--\x3e"),"string"!=typeof U&&!_isNode(U)){if("function"!=typeof U.toString)throw ue("toString is not a function");if("string"!=typeof(U=U.toString()))throw ue("dirty is not a string, aborting")}if(!DOMPurify.isSupported){if("object"===Pe(O.toStaticHTML)||"function"==typeof O.toStaticHTML){if("string"==typeof U)return O.toStaticHTML(U);if(_isNode(U))return O.toStaticHTML(U.outerHTML)}return U}if(pt||_parseConfig(q),DOMPurify.removed=[],"string"==typeof U&&(vt=!1),vt);else if(U instanceof j)1===(Y=(W=_initDocument("\x3c!----\x3e")).ownerDocument.importNode(U,!0)).nodeType&&"BODY"===Y.nodeName||"HTML"===Y.nodeName?W=Y:W.appendChild(Y);else{if(!ht&&!ct&&!dt&&-1===U.indexOf("<"))return Be&&ft?Be.createHTML(U):U;if(!(W=_initDocument(U)))return ht?null:Fe}W&&ut&&_forceRemove(W.firstChild);for(var X=_createIterator(vt?U:W);K=X.nextNode();)3===K.nodeType&&K===Q||_sanitizeElements(K)||(K.content instanceof G&&Ft(K.content),_sanitizeAttributes(K),Q=K);if(Q=null,vt)return U;if(ht){if(mt)for(Z=Ve.call(W.ownerDocument);W.firstChild;)Z.appendChild(W.firstChild);else Z=W;return gt&&(Z=He.call(B,Z,!0)),Z}var J=dt?W.outerHTML:W.innerHTML;return ct&&(J=le(J,We," "),J=le(J,Ye," ")),Be&&ft?Be.createHTML(J):J},DOMPurify.setConfig=function(O){_parseConfig(O),pt=!0},DOMPurify.clearConfig=function(){Nt=null,pt=!1},DOMPurify.isValidAttribute=function(O,B,U){Nt||_parseConfig({});var G=ae(O),q=ae(B);return _isValidAttribute(G,q,U)},DOMPurify.addHook=function(O,B){"function"==typeof B&&(je[O]=je[O]||[],oe(je[O],B))},DOMPurify.removeHook=function(O){je[O]&&ne(je[O])},DOMPurify.removeHooks=function(O){je[O]&&(je[O]=[])},DOMPurify.removeAllHooks=function(){je={}},DOMPurify}();void 0===(G=function(){return Ne}.call(B,U,B,O))||(O.exports=G)},2432:(O,B,U)=>{"use strict";var G={};U.r(G),U.d(G,{Answer:()=>jr,Article:()=>Zr,Computation:()=>sn,CreativeWork:()=>Vr,ErrorModel:()=>hn,ErrorResponse:()=>mn,Identifiable:()=>zr,ImageObject:()=>Hr,Images:()=>Qr,Intangible:()=>gn,MediaObject:()=>Gr,News:()=>Jr,NewsArticle:()=>Xr,Places:()=>un,Query:()=>Kr,QueryContext:()=>Lr,RankingRankingGroup:()=>cn,RankingRankingItem:()=>ln,RankingRankingResponse:()=>dn,RelatedSearchesRelatedSearchAnswer:()=>en,Response:()=>$r,ResponseBase:()=>Fr,SearchResponse:()=>pn,SearchResultsAnswer:()=>Wr,SpellSuggestions:()=>tn,StructuredValue:()=>yn,Thing:()=>Ur,TimeZone:()=>nn,TimeZoneTimeZoneInformation:()=>rn,VideoObject:()=>on,Videos:()=>an,WebMetaTag:()=>Br,WebPage:()=>qr,WebWebAnswer:()=>Yr,discriminators:()=>_n});var q={};U.r(q),U.d(q,{CreateCompletionRequest:()=>Go,CreateCompletionRequestStop:()=>Ho,CreateCompletionResponse:()=>qo,CreateCompletionResponseChoicesItem:()=>jo,CreateCompletionResponseChoicesItemLogprobs:()=>Wo});var j={};U.r(j),U.d(j,{AppUser:()=>Fa,ApplicationData:()=>va,AuthToken:()=>za,AuthTokenViewModel:()=>wa,AutoSuggestResultModel:()=>Zo,BitmapDecoratorProfileConfigModel:()=>ua,ContrastRequirement:()=>la,CosmosPermission:()=>ka,CosmosUser:()=>Aa,DeviceChromeLayer:()=>ta,DeviceConfig:()=>ea,EmulatorConfig:()=>Jo,FaceRectangle:()=>Xo,HSLFilter:()=>sa,MicrosoftGraphDirectoryObject:()=>Na,MicrosoftGraphEntity:()=>ma,NetCoreErrorResponse:()=>_a,NormalizedRGB:()=>aa,Paths1Tn5QkaProxiedApinameEndpointPostRequestbodyContentApplicationOctetStreamSchema:()=>Ia,PathsLllj53ImageservicesDecoratebitmapPostResponses200ContentApplicationJsonSchema:()=>ha,PathsYv268WProxiedApinameEndpointPostResponses200ContentApplicationOctetStreamSchema:()=>Pa,Persona:()=>Oa,PersonaPasswordProfile:()=>ga,PersonaPhoto:()=>fa,PersonaProfile:()=>Ma,PersonaProfileShortcuts:()=>ba,PersonaProfileWallpaper:()=>Ca,PrevalentColorSelectRequestModel:()=>ra,PrevalentColorSelectorConfig:()=>oa,PrevalentColorSelectorOutput:()=>ca,ProductGroup:()=>Da,QuantizedColor:()=>na,Role:()=>Ra,Scenario:()=>La,ScenarioSwitch:()=>xa,SerializableBitmapDecoratorConfig:()=>pa,SerializableDecorateBitmapRequestModel:()=>da,Shortcut:()=>Sa,SuggestedShortcut:()=>$a,TimelineSegmentConfig:()=>ia,TwoHundredBooleanResponse:()=>Ea,TwoHundredStringResponse:()=>Ta,TypedResource:()=>ya,UserTestSession:()=>Ba});var W={};U.r(W),U.d(W,{BaseBotResponse:()=>ul,BaseRequest:()=>ll,BaseResponse:()=>cl,BingFirstPageContent:()=>sl,ChannelAccount:()=>rl,ChatRequest:()=>pl,ChatResponse:()=>hl,CreateConversationResponse:()=>ml,FeedbackInfo:()=>il,GetSharedMessagesResponse:()=>yl,Message:()=>tl,NamedEntity:()=>al,NluResponse:()=>nl,Result:()=>dl,ScoredClassification:()=>ol,ShareMessagesRequest:()=>gl,ShareMessagesResponse:()=>fl});var Y={};U.r(Y),U.d(Y,{CaptchaCreateHeaders:()=>Ll,CaptchaVerifyResponse:()=>Dl,Chat:()=>Ol,ChatsResult:()=>Ml,ConversationChatsResponse:()=>Nl,ConversationCreateResponse:()=>Il,CreateConversationResult:()=>Pl});var K={};U.r(K),U.d(K,{attentionMarkers:()=>Tu,contentInitial:()=>vu,disable:()=>wu,document:()=>_u,flow:()=>Su,flowInitial:()=>bu,insideSpan:()=>xu,string:()=>Cu,text:()=>Eu});function __decorate(O,B,U,G){var q,j=arguments.length,W=j<3?B:null===G?G=Object.getOwnPropertyDescriptor(B,U):G;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(O,B,U,G);else for(var Y=O.length-1;Y>=0;Y--)(q=O[Y])&&(W=(j<3?q(W):j>3?q(B,U,W):q(B,U))||W);return j>3&&W&&Object.defineProperty(B,U,W),W}function __param(O,B){return function(U,G){B(U,G,O)}}function __metadata(O,B){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(O,B)}Object.create;Object.create;function __classPrivateFieldGet(O,B,U,G){if("a"===U&&!G)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof B?O!==B||!G:!B.has(O))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===U?G:"a"===U?G.call(O):G?G.value:B.get(O)}function __classPrivateFieldSet(O,B,U,G,q){if("m"===G)throw new TypeError("Private method is not writable");if("a"===G&&!q)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof B?O!==B||!q:!B.has(O))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===G?q.call(O,U):q?q.value=U:B.set(O,U),U}var Q=Object.prototype;const _isPrototype=function(O){var B=O&&O.constructor;return O===("function"==typeof B&&B.prototype||Q)};const Z=function(O,B){return function(U){return O(B(U))}}(Object.keys,Object);var X=Object.prototype.hasOwnProperty;const _baseKeys=function(O){if(!_isPrototype(O))return Z(O);var B=[];for(var U in Object(O))X.call(O,U)&&"constructor"!=U&&B.push(U);return B};const J="object"==typeof global&&global&&global.Object===Object&&global;var ee="object"==typeof self&&self&&self.Object===Object&&self;const te=J||ee||Function("return this")();const ie=te.Symbol;var re=Object.prototype,ne=re.hasOwnProperty,oe=re.toString,ae=ie?ie.toStringTag:void 0;const _getRawTag=function(O){var B=ne.call(O,ae),U=O[ae];try{O[ae]=void 0;var G=!0}catch(O){}var q=oe.call(O);return G&&(B?O[ae]=U:delete O[ae]),q};var se=Object.prototype.toString;const _objectToString=function(O){return se.call(O)};var le=ie?ie.toStringTag:void 0;const _baseGetTag=function(O){return null==O?void 0===O?"[object Undefined]":"[object Null]":le&&le in Object(O)?_getRawTag(O):_objectToString(O)};const lodash_es_isObject=function(O){var B=typeof O;return null!=O&&("object"==B||"function"==B)};const lodash_es_isFunction=function(O){if(!lodash_es_isObject(O))return!1;var B=_baseGetTag(O);return"[object Function]"==B||"[object GeneratorFunction]"==B||"[object AsyncFunction]"==B||"[object Proxy]"==B};const ce=te["__core-js_shared__"];var de,pe=(de=/[^.]+$/.exec(ce&&ce.keys&&ce.keys.IE_PROTO||""))?"Symbol(src)_1."+de:"";const _isMasked=function(O){return!!pe&&pe in O};var ue=Function.prototype.toString;const _toSource=function(O){if(null!=O){try{return ue.call(O)}catch(O){}try{return O+""}catch(O){}}return""};var he=/^\[object .+?Constructor\]$/,me=Function.prototype,ge=Object.prototype,fe=me.toString,ye=ge.hasOwnProperty,_e=RegExp("^"+fe.call(ye).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const _baseIsNative=function(O){return!(!lodash_es_isObject(O)||_isMasked(O))&&(lodash_es_isFunction(O)?_e:he).test(_toSource(O))};const _getValue=function(O,B){return null==O?void 0:O[B]};const _getNative=function(O,B){var U=_getValue(O,B);return _baseIsNative(U)?U:void 0};const ve=_getNative(te,"DataView");const be=_getNative(te,"Map");const Se=_getNative(te,"Promise");const Ce=_getNative(te,"Set");const Ee=_getNative(te,"WeakMap");var xe="[object Map]",Te="[object Promise]",we="[object Set]",ke="[object WeakMap]",Ae="[object DataView]",Re=_toSource(ve),Ie=_toSource(be),Pe=_toSource(Se),Ne=_toSource(Ce),Oe=_toSource(Ee),Me=_baseGetTag;(ve&&Me(new ve(new ArrayBuffer(1)))!=Ae||be&&Me(new be)!=xe||Se&&Me(Se.resolve())!=Te||Ce&&Me(new Ce)!=we||Ee&&Me(new Ee)!=ke)&&(Me=function(O){var B=_baseGetTag(O),U="[object Object]"==B?O.constructor:void 0,G=U?_toSource(U):"";if(G)switch(G){case Re:return Ae;case Ie:return xe;case Pe:return Te;case Ne:return we;case Oe:return ke}return B});const De=Me;const lodash_es_isObjectLike=function(O){return null!=O&&"object"==typeof O};const _baseIsArguments=function(O){return lodash_es_isObjectLike(O)&&"[object Arguments]"==_baseGetTag(O)};var Le=Object.prototype,Be=Le.hasOwnProperty,Fe=Le.propertyIsEnumerable,ze=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(O){return lodash_es_isObjectLike(O)&&Be.call(O,"callee")&&!Fe.call(O,"callee")};const $e=ze;const Ue=Array.isArray;const lodash_es_isLength=function(O){return"number"==typeof O&&O>-1&&O%1==0&&O<=9007199254740991};const lodash_es_isArrayLike=function(O){return null!=O&&lodash_es_isLength(O.length)&&!lodash_es_isFunction(O)};const lodash_es_stubFalse=function(){return!1};var Ve="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ge=Ve&&"object"==typeof module&&module&&!module.nodeType&&module,He=Ge&&Ge.exports===Ve?te.Buffer:void 0;const qe=(He?He.isBuffer:void 0)||lodash_es_stubFalse;var je={};je["[object Float32Array]"]=je["[object Float64Array]"]=je["[object Int8Array]"]=je["[object Int16Array]"]=je["[object Int32Array]"]=je["[object Uint8Array]"]=je["[object Uint8ClampedArray]"]=je["[object Uint16Array]"]=je["[object Uint32Array]"]=!0,je["[object Arguments]"]=je["[object Array]"]=je["[object ArrayBuffer]"]=je["[object Boolean]"]=je["[object DataView]"]=je["[object Date]"]=je["[object Error]"]=je["[object Function]"]=je["[object Map]"]=je["[object Number]"]=je["[object Object]"]=je["[object RegExp]"]=je["[object Set]"]=je["[object String]"]=je["[object WeakMap]"]=!1;const _baseIsTypedArray=function(O){return lodash_es_isObjectLike(O)&&lodash_es_isLength(O.length)&&!!je[_baseGetTag(O)]};const _baseUnary=function(O){return function(B){return O(B)}};var We="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ye=We&&"object"==typeof module&&module&&!module.nodeType&&module,Ke=Ye&&Ye.exports===We&&J.process,Qe=function(){try{var O=Ye&&Ye.require&&Ye.require("util").types;return O||Ke&&Ke.binding&&Ke.binding("util")}catch(O){}}();var Ze=Qe&&Qe.isTypedArray;const Xe=Ze?_baseUnary(Ze):_baseIsTypedArray;var Je=Object.prototype.hasOwnProperty;const lodash_es_isEmpty=function(O){if(null==O)return!0;if(lodash_es_isArrayLike(O)&&(Ue(O)||"string"==typeof O||"function"==typeof O.splice||qe(O)||Xe(O)||$e(O)))return!O.length;var B=De(O);if("[object Map]"==B||"[object Set]"==B)return!O.size;if(_isPrototype(O))return!_baseKeys(O).length;for(var U in O)if(Je.call(O,U))return!1;return!0},et=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;try{return new Function("return this")()}catch(O){return{}}}();void 0===et.trustedTypes&&(et.trustedTypes={createPolicy:(O,B)=>B});const tt={configurable:!1,enumerable:!1,writable:!1};void 0===et.FAST&&Reflect.defineProperty(et,"FAST",Object.assign({value:Object.create(null)},tt));const it=et.FAST;if(void 0===it.getById){const O=Object.create(null);Reflect.defineProperty(it,"getById",Object.assign({value(B,U){let G=O[B];return void 0===G&&(G=U?O[B]=U():null),G}},tt))}const rt=Object.freeze([]),nt=et.FAST.getById(1,(()=>{const O=[],B=[];function throwFirstError(){if(B.length)throw B.shift()}function tryRunTask(O){try{O.call()}catch(O){B.push(O),setTimeout(throwFirstError,0)}}function process(){let B=0;for(;B<O.length;)if(tryRunTask(O[B]),B++,B>1024){for(let U=0,G=O.length-B;U<G;U++)O[U]=O[U+B];O.length-=B,B=0}O.length=0}return Object.freeze({enqueue:function(B){O.length<1&&et.requestAnimationFrame(process),O.push(B)},process})})),ot=et.trustedTypes.createPolicy("fast-html",{createHTML:O=>O});let at=ot;const st=`fast-${Math.random().toString(36).substring(2,8)}`,lt=`${st}{`,ct=`}${st}`,dt=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(O){if(at!==ot)throw new Error("The HTML policy can only be set once.");at=O},createHTML:O=>at.createHTML(O),isMarker:O=>O&&8===O.nodeType&&O.data.startsWith(st),extractDirectiveIndexFromMarker:O=>parseInt(O.data.replace(`${st}:`,"")),createInterpolationPlaceholder:O=>`${lt}${O}${ct}`,createCustomAttributePlaceholder(O,B){return`${O}="${this.createInterpolationPlaceholder(B)}"`},createBlockPlaceholder:O=>`\x3c!--${st}:${O}--\x3e`,queueUpdate:nt.enqueue,processUpdates:nt.process,nextUpdate:()=>new Promise(nt.enqueue),setAttribute(O,B,U){null==U?O.removeAttribute(B):O.setAttribute(B,U)},setBooleanAttribute(O,B,U){U?O.setAttribute(B,""):O.removeAttribute(B)},removeChildNodes(O){for(let B=O.firstChild;null!==B;B=O.firstChild)O.removeChild(B)},createTemplateWalker:O=>document.createTreeWalker(O,133,null,!1)});class SubscriberSet{constructor(O,B){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=O,this.sub1=B}has(O){return void 0===this.spillover?this.sub1===O||this.sub2===O:-1!==this.spillover.indexOf(O)}subscribe(O){const B=this.spillover;if(void 0===B){if(this.has(O))return;if(void 0===this.sub1)return void(this.sub1=O);if(void 0===this.sub2)return void(this.sub2=O);this.spillover=[this.sub1,this.sub2,O],this.sub1=void 0,this.sub2=void 0}else{-1===B.indexOf(O)&&B.push(O)}}unsubscribe(O){const B=this.spillover;if(void 0===B)this.sub1===O?this.sub1=void 0:this.sub2===O&&(this.sub2=void 0);else{const U=B.indexOf(O);-1!==U&&B.splice(U,1)}}notify(O){const B=this.spillover,U=this.source;if(void 0===B){const B=this.sub1,G=this.sub2;void 0!==B&&B.handleChange(U,O),void 0!==G&&G.handleChange(U,O)}else for(let G=0,q=B.length;G<q;++G)B[G].handleChange(U,O)}}class PropertyChangeNotifier{constructor(O){this.subscribers={},this.sourceSubscribers=null,this.source=O}notify(O){var B;const U=this.subscribers[O];void 0!==U&&U.notify(O),null===(B=this.sourceSubscribers)||void 0===B||B.notify(O)}subscribe(O,B){var U;if(B){let U=this.subscribers[B];void 0===U&&(this.subscribers[B]=U=new SubscriberSet(this.source)),U.subscribe(O)}else this.sourceSubscribers=null!==(U=this.sourceSubscribers)&&void 0!==U?U:new SubscriberSet(this.source),this.sourceSubscribers.subscribe(O)}unsubscribe(O,B){var U;if(B){const U=this.subscribers[B];void 0!==U&&U.unsubscribe(O)}else null===(U=this.sourceSubscribers)||void 0===U||U.unsubscribe(O)}}const pt=it.getById(2,(()=>{const O=/(:|&&|\|\||if)/,B=new WeakMap,U=new WeakMap,G=dt.queueUpdate;let q,createArrayObserver=O=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function getNotifier(O){let U=O.$fastController||B.get(O);return void 0===U&&(Array.isArray(O)?U=createArrayObserver(O):B.set(O,U=new PropertyChangeNotifier(O))),U}function getAccessors(O){let B=U.get(O);if(void 0===B){let G=Reflect.getPrototypeOf(O);for(;void 0===B&&null!==G;)B=U.get(G),G=Reflect.getPrototypeOf(G);B=void 0===B?[]:B.slice(0),U.set(O,B)}return B}class DefaultObservableAccessor{constructor(O){this.name=O,this.field=`_${O}`,this.callback=`${O}Changed`}getValue(O){return void 0!==q&&q.watch(O,this.name),O[this.field]}setValue(O,B){const U=this.field,G=O[U];if(G!==B){O[U]=B;const q=O[this.callback];"function"==typeof q&&q.call(O,G,B),getNotifier(O).notify(this.name)}}}class BindingObserverImplementation extends SubscriberSet{constructor(O,B,U=!1){super(O,B),this.binding=O,this.isVolatileBinding=U,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(O,B){this.needsRefresh&&null!==this.last&&this.disconnect();const U=q;q=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;const G=this.binding(O,B);return q=U,G}disconnect(){if(null!==this.last){let O=this.first;for(;void 0!==O;)O.notifier.unsubscribe(this,O.propertyName),O=O.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(O,B){const U=this.last,G=getNotifier(O),j=null===U?this.first:{};if(j.propertySource=O,j.propertyName=B,j.notifier=G,G.subscribe(this,B),null!==U){if(!this.needsRefresh){let B;q=void 0,B=U.propertySource[U.propertyName],q=this,O===B&&(this.needsRefresh=!0)}U.next=j}this.last=j}handleChange(){this.needsQueue&&(this.needsQueue=!1,G(this))}call(){null!==this.last&&(this.needsQueue=!0,this.notify(this))}records(){let O=this.first;return{next:()=>{const B=O;return void 0===B?{value:void 0,done:!0}:(O=O.next,{value:B,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(O){createArrayObserver=O},getNotifier,track(O,B){void 0!==q&&q.watch(O,B)},trackVolatile(){void 0!==q&&(q.needsRefresh=!0)},notify(O,B){getNotifier(O).notify(B)},defineProperty(O,B){"string"==typeof B&&(B=new DefaultObservableAccessor(B)),getAccessors(O).push(B),Reflect.defineProperty(O,B.name,{enumerable:!0,get:function(){return B.getValue(this)},set:function(O){B.setValue(this,O)}})},getAccessors,binding(O,B,U=this.isVolatileBinding(O)){return new BindingObserverImplementation(O,B,U)},isVolatileBinding:B=>O.test(B.toString())})}));function observable(O,B){pt.defineProperty(O,B)}function observable_volatile(O,B,U){return Object.assign({},U,{get:function(){return pt.trackVolatile(),U.get.apply(this)}})}const ut=it.getById(3,(()=>{let O=null;return{get:()=>O,set(B){O=B}}}));class ExecutionContext{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return ut.get()}get isEven(){return this.index%2==0}get isOdd(){return this.index%2!=0}get isFirst(){return 0===this.index}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(O){ut.set(O)}}pt.defineProperty(ExecutionContext.prototype,"index"),pt.defineProperty(ExecutionContext.prototype,"length");const ht=Object.seal(new ExecutionContext);class element_styles_ElementStyles{constructor(){this.targets=new WeakSet}addStylesTo(O){this.targets.add(O)}removeStylesFrom(O){this.targets.delete(O)}isAttachedTo(O){return this.targets.has(O)}withBehaviors(...O){return this.behaviors=null===this.behaviors?O:this.behaviors.concat(O),this}}function reduceStyles(O){return O.map((O=>O instanceof element_styles_ElementStyles?reduceStyles(O.styles):[O])).reduce(((O,B)=>O.concat(B)),[])}function reduceBehaviors(O){return O.map((O=>O instanceof element_styles_ElementStyles?O.behaviors:null)).reduce(((O,B)=>null===B?O:(null===O&&(O=[]),O.concat(B))),null)}element_styles_ElementStyles.create=(()=>{if(dt.supportsAdoptedStyleSheets){const O=new Map;return B=>new AdoptedStyleSheetsStyles(B,O)}return O=>new StyleElementStyles(O)})();class AdoptedStyleSheetsStyles extends element_styles_ElementStyles{constructor(O,B){super(),this.styles=O,this.styleSheetCache=B,this._styleSheets=void 0,this.behaviors=reduceBehaviors(O)}get styleSheets(){if(void 0===this._styleSheets){const O=this.styles,B=this.styleSheetCache;this._styleSheets=reduceStyles(O).map((O=>{if(O instanceof CSSStyleSheet)return O;let U=B.get(O);return void 0===U&&(U=new CSSStyleSheet,U.replaceSync(O),B.set(O,U)),U}))}return this._styleSheets}addStylesTo(O){O.adoptedStyleSheets=[...O.adoptedStyleSheets,...this.styleSheets],super.addStylesTo(O)}removeStylesFrom(O){const B=this.styleSheets;O.adoptedStyleSheets=O.adoptedStyleSheets.filter((O=>-1===B.indexOf(O))),super.removeStylesFrom(O)}}let mt=0;class StyleElementStyles extends element_styles_ElementStyles{constructor(O){super(),this.styles=O,this.behaviors=null,this.behaviors=reduceBehaviors(O),this.styleSheets=reduceStyles(O),this.styleClass="fast-style-class-"+ ++mt}addStylesTo(O){const B=this.styleSheets,U=this.styleClass;O=this.normalizeTarget(O);for(let G=0;G<B.length;G++){const q=document.createElement("style");q.innerHTML=B[G],q.className=U,O.append(q)}super.addStylesTo(O)}removeStylesFrom(O){const B=(O=this.normalizeTarget(O)).querySelectorAll(`.${this.styleClass}`);for(let U=0,G=B.length;U<G;++U)O.removeChild(B[U]);super.removeStylesFrom(O)}isAttachedTo(O){return super.isAttachedTo(this.normalizeTarget(O))}normalizeTarget(O){return O===document?document.body:O}}const gt={toView:O=>O?"true":"false",fromView:O=>null!=O&&"false"!==O&&!1!==O&&0!==O};class AttributeDefinition{constructor(O,B,U=B.toLowerCase(),G="reflect",q){this.guards=new Set,this.Owner=O,this.name=B,this.attribute=U,this.mode=G,this.converter=q,this.fieldName=`_${B}`,this.callbackName=`${B}Changed`,this.hasCallback=this.callbackName in O.prototype,"boolean"===G&&void 0===q&&(this.converter=gt)}setValue(O,B){const U=O[this.fieldName],G=this.converter;void 0!==G&&(B=G.fromView(B)),U!==B&&(O[this.fieldName]=B,this.tryReflectToAttribute(O),this.hasCallback&&O[this.callbackName](U,B),O.$fastController.notify(this.name))}getValue(O){return pt.track(O,this.name),O[this.fieldName]}onAttributeChangedCallback(O,B){this.guards.has(O)||(this.guards.add(O),this.setValue(O,B),this.guards.delete(O))}tryReflectToAttribute(O){const B=this.mode,U=this.guards;U.has(O)||"fromView"===B||dt.queueUpdate((()=>{U.add(O);const G=O[this.fieldName];switch(B){case"reflect":const B=this.converter;dt.setAttribute(O,this.attribute,void 0!==B?B.toView(G):G);break;case"boolean":dt.setBooleanAttribute(O,this.attribute,G)}U.delete(O)}))}static collect(O,...B){const U=[];B.push(O.attributes);for(let G=0,q=B.length;G<q;++G){const q=B[G];if(void 0!==q)for(let B=0,G=q.length;B<G;++B){const G=q[B];"string"==typeof G?U.push(new AttributeDefinition(O,G)):U.push(new AttributeDefinition(O,G.property,G.attribute,G.mode,G.converter))}}return U}}function attr(O,B){let U;function decorator(O,B){arguments.length>1&&(U.property=B);const G=O.constructor.attributes||(O.constructor.attributes=[]);G.push(U)}return arguments.length>1?(U={},void decorator(O,B)):(U=void 0===O?{}:O,decorator)}const ft={mode:"open"},yt={},_t=it.getById(4,(()=>{const O=new Map;return Object.freeze({register:B=>!O.has(B.type)&&(O.set(B.type,B),!0),getByType:B=>O.get(B)})}));class FASTElementDefinition{constructor(O,B=O.definition){"string"==typeof B&&(B={name:B}),this.type=O,this.name=B.name,this.template=B.template;const U=AttributeDefinition.collect(O,B.attributes),G=new Array(U.length),q={},j={};for(let O=0,B=U.length;O<B;++O){const B=U[O];G[O]=B.attribute,q[B.name]=B,j[B.attribute]=B}this.attributes=U,this.observedAttributes=G,this.propertyLookup=q,this.attributeLookup=j,this.shadowOptions=void 0===B.shadowOptions?ft:null===B.shadowOptions?void 0:Object.assign(Object.assign({},ft),B.shadowOptions),this.elementOptions=void 0===B.elementOptions?yt:Object.assign(Object.assign({},yt),B.elementOptions),this.styles=void 0===B.styles?void 0:Array.isArray(B.styles)?element_styles_ElementStyles.create(B.styles):B.styles instanceof element_styles_ElementStyles?B.styles:element_styles_ElementStyles.create([B.styles])}get isDefined(){return!!_t.getByType(this.type)}define(O=customElements){const B=this.type;if(_t.register(this)){const O=this.attributes,U=B.prototype;for(let B=0,G=O.length;B<G;++B)pt.defineProperty(U,O[B]);Reflect.defineProperty(B,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return O.get(this.name)||O.define(this.name,B,this.elementOptions),this}}FASTElementDefinition.forType=_t.getByType;const vt=new WeakMap,bt={bubbles:!0,composed:!0,cancelable:!0};function getShadowRoot(O){return O.shadowRoot||vt.get(O)||null}class Controller extends PropertyChangeNotifier{constructor(O,B){super(O),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=O,this.definition=B;const U=B.shadowOptions;if(void 0!==U){const B=O.attachShadow(U);"closed"===U.mode&&vt.set(O,B)}const G=pt.getAccessors(O);if(G.length>0){const B=this.boundObservables=Object.create(null);for(let U=0,q=G.length;U<q;++U){const q=G[U].name,j=O[q];void 0!==j&&(delete O[q],B[q]=j)}}}get isConnected(){return pt.track(this,"isConnected"),this._isConnected}setIsConnected(O){this._isConnected=O,pt.notify(this,"isConnected")}get template(){return this._template}set template(O){this._template!==O&&(this._template=O,this.needsInitialization||this.renderTemplate(O))}get styles(){return this._styles}set styles(O){this._styles!==O&&(null!==this._styles&&this.removeStyles(this._styles),this._styles=O,this.needsInitialization||null===O||this.addStyles(O))}addStyles(O){const B=getShadowRoot(this.element)||this.element.getRootNode();if(O instanceof HTMLStyleElement)B.append(O);else if(!O.isAttachedTo(B)){const U=O.behaviors;O.addStylesTo(B),null!==U&&this.addBehaviors(U)}}removeStyles(O){const B=getShadowRoot(this.element)||this.element.getRootNode();if(O instanceof HTMLStyleElement)B.removeChild(O);else if(O.isAttachedTo(B)){const U=O.behaviors;O.removeStylesFrom(B),null!==U&&this.removeBehaviors(U)}}addBehaviors(O){const B=this.behaviors||(this.behaviors=new Map),U=O.length,G=[];for(let q=0;q<U;++q){const U=O[q];B.has(U)?B.set(U,B.get(U)+1):(B.set(U,1),G.push(U))}if(this._isConnected){const O=this.element;for(let B=0;B<G.length;++B)G[B].bind(O,ht)}}removeBehaviors(O,B=!1){const U=this.behaviors;if(null===U)return;const G=O.length,q=[];for(let j=0;j<G;++j){const G=O[j];if(U.has(G)){const O=U.get(G)-1;0===O||B?U.delete(G)&&q.push(G):U.set(G,O)}}if(this._isConnected){const O=this.element;for(let B=0;B<q.length;++B)q[B].unbind(O)}}onConnectedCallback(){if(this._isConnected)return;const O=this.element;this.needsInitialization?this.finishInitialization():null!==this.view&&this.view.bind(O,ht);const B=this.behaviors;if(null!==B)for(const[U]of B)U.bind(O,ht);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);const O=this.view;null!==O&&O.unbind();const B=this.behaviors;if(null!==B){const O=this.element;for(const[U]of B)U.unbind(O)}}onAttributeChangedCallback(O,B,U){const G=this.definition.attributeLookup[O];void 0!==G&&G.onAttributeChangedCallback(this.element,U)}emit(O,B,U){return!!this._isConnected&&this.element.dispatchEvent(new CustomEvent(O,Object.assign(Object.assign({detail:B},bt),U)))}finishInitialization(){const O=this.element,B=this.boundObservables;if(null!==B){const U=Object.keys(B);for(let G=0,q=U.length;G<q;++G){const q=U[G];O[q]=B[q]}this.boundObservables=null}const U=this.definition;null===this._template&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():U.template&&(this._template=U.template||null)),null!==this._template&&this.renderTemplate(this._template),null===this._styles&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():U.styles&&(this._styles=U.styles||null)),null!==this._styles&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(O){const B=this.element,U=getShadowRoot(B)||B;null!==this.view?(this.view.dispose(),this.view=null):this.needsInitialization||dt.removeChildNodes(U),O&&(this.view=O.render(B,U,B))}static forCustomElement(O){const B=O.$fastController;if(void 0!==B)return B;const U=FASTElementDefinition.forType(O.constructor);if(void 0===U)throw new Error("Missing FASTElement definition.");return O.$fastController=new Controller(O,U)}}function createFASTElement(O){return class extends O{constructor(){super(),Controller.forCustomElement(this)}$emit(O,B,U){return this.$fastController.emit(O,B,U)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(O,B,U){this.$fastController.onAttributeChangedCallback(O,B,U)}}}const St=Object.assign(createFASTElement(HTMLElement),{from:O=>createFASTElement(O),define:(O,B)=>new FASTElementDefinition(O,B).define().type});function customElement(O){return function(B){new FASTElementDefinition(B,O).define()}}const Ct=new Map;"metadata"in Reflect||(Reflect.metadata=function(O,B){return function(U){Reflect.defineMetadata(O,B,U)}},Reflect.defineMetadata=function(O,B,U){let G=Ct.get(U);void 0===G&&Ct.set(U,G=new Map),G.set(O,B)},Reflect.getOwnMetadata=function(O,B){const U=Ct.get(B);if(void 0!==U)return U.get(O)});class ResolverBuilder{constructor(O,B){this.container=O,this.key=B}instance(O){return this.registerResolver(0,O)}singleton(O){return this.registerResolver(1,O)}transient(O){return this.registerResolver(2,O)}callback(O){return this.registerResolver(3,O)}cachedCallback(O){return this.registerResolver(3,cacheCallbackResult(O))}aliasTo(O){return this.registerResolver(5,O)}registerResolver(O,B){const{container:U,key:G}=this;return this.container=this.key=void 0,U.registerResolver(G,new ResolverImpl(G,O,B))}}function cloneArrayWithPossibleProps(O){const B=O.slice(),U=Object.keys(O),G=U.length;let q;for(let j=0;j<G;++j)q=U[j],isArrayIndex(q)||(B[q]=O[q]);return B}const Et=Object.freeze({none(O){throw Error(`${O.toString()} not registered, did you forget to add @singleton()?`)},singleton:O=>new ResolverImpl(O,1,O),transient:O=>new ResolverImpl(O,2,O)}),xt=Object.freeze({default:Object.freeze({parentLocator:()=>null,responsibleForOwnerRequests:!1,defaultResolver:Et.singleton})}),Tt=new Map;function getParamTypes(O){return B=>Reflect.getOwnMetadata(O,B)}let wt=null;const kt=Object.freeze({createContainer:O=>new ContainerImpl(null,Object.assign({},xt.default,O)),findResponsibleContainer(O){const B=O.$$container$$;return B&&B.responsibleForOwnerRequests?B:kt.findParentContainer(O)},findParentContainer(O){const B=new CustomEvent(Dt,{bubbles:!0,composed:!0,cancelable:!0,detail:{container:void 0}});return O.dispatchEvent(B),B.detail.container||kt.getOrCreateDOMContainer()},getOrCreateDOMContainer:(O,B)=>O?O.$$container$$||new ContainerImpl(O,Object.assign({},xt.default,B,{parentLocator:kt.findParentContainer})):wt||(wt=new ContainerImpl(null,Object.assign({},xt.default,B,{parentLocator:()=>null}))),getDesignParamtypes:getParamTypes("design:paramtypes"),getAnnotationParamtypes:getParamTypes("di:paramtypes"),getOrCreateAnnotationParamTypes(O){let B=this.getAnnotationParamtypes(O);return void 0===B&&Reflect.defineMetadata("di:paramtypes",B=[],O),B},getDependencies(O){let B=Tt.get(O);if(void 0===B){const U=O.inject;if(void 0===U){const U=kt.getDesignParamtypes(O),G=kt.getAnnotationParamtypes(O);if(void 0===U)if(void 0===G){const U=Object.getPrototypeOf(O);B="function"==typeof U&&U!==Function.prototype?cloneArrayWithPossibleProps(kt.getDependencies(U)):[]}else B=cloneArrayWithPossibleProps(G);else if(void 0===G)B=cloneArrayWithPossibleProps(U);else{B=cloneArrayWithPossibleProps(U);let O,q=G.length;for(let U=0;U<q;++U)O=G[U],void 0!==O&&(B[U]=O);const j=Object.keys(G);let W;q=j.length;for(let O=0;O<q;++O)W=j[O],isArrayIndex(W)||(B[W]=G[W])}}else B=cloneArrayWithPossibleProps(U);Tt.set(O,B)}return B},defineProperty(O,B,U,G=!1){const q=`$di_${B}`;Reflect.defineProperty(O,B,{get:function(){let O=this[q];if(void 0===O){const j=this instanceof HTMLElement?kt.findResponsibleContainer(this):kt.getOrCreateDOMContainer();if(O=j.get(U),this[q]=O,G&&this instanceof St){const G=this.$fastController,handleChange=()=>{kt.findResponsibleContainer(this).get(U)!==this[q]&&(this[q]=O,G.notify(B))};G.subscribe({handleChange},"isConnected")}}return O}})},createInterface(O,B){const U="function"==typeof O?O:B,G="string"==typeof O?O:O&&"friendlyName"in O&&O.friendlyName||zt,q="string"!=typeof O&&(O&&"respectConnection"in O&&O.respectConnection||!1),Interface=function(O,B,U){if(null==O||void 0!==new.target)throw new Error(`No registration for interface: '${Interface.friendlyName}'`);if(B)kt.defineProperty(O,B,Interface,q);else{kt.getOrCreateAnnotationParamTypes(O)[U]=Interface}};return Interface.$isInterface=!0,Interface.friendlyName=null==G?"(anonymous)":G,null!=U&&(Interface.register=function(O,B){return U(new ResolverBuilder(O,null!=B?B:Interface))}),Interface.toString=function(){return`InterfaceSymbol<${Interface.friendlyName}>`},Interface},inject:(...O)=>function(B,U,G){if("number"==typeof G){const U=kt.getOrCreateAnnotationParamTypes(B),q=O[0];void 0!==q&&(U[G]=q)}else if(U)kt.defineProperty(B,U,O[0]);else{const U=G?kt.getOrCreateAnnotationParamTypes(G.value):kt.getOrCreateAnnotationParamTypes(B);let q;for(let B=0;B<O.length;++B)q=O[B],void 0!==q&&(U[B]=q)}},transient:O=>(O.register=function(B){return Ft.transient(O,O).register(B)},O.registerInRequestor=!1,O),singleton:(O,B=It)=>(O.register=function(B){return Ft.singleton(O,O).register(B)},O.registerInRequestor=B.scoped,O)}),At=kt.createInterface("Container"),Rt=At;function createResolver(O){return function(B){const resolver=function(O,B,U){kt.inject(resolver)(O,B,U)};return resolver.$isResolver=!0,resolver.resolve=function(U,G){return O(B,U,G)},resolver}}kt.inject;const It={scoped:!1};Pt=(O,B,U,G)=>U.getAll(O,G);var Pt;createResolver(((O,B,U)=>()=>U.get(O)));const Nt=createResolver(((O,B,U)=>U.has(O,!0)?U.get(O):void 0));function ignore(O,B,U){kt.inject(ignore)(O,B,U)}ignore.$isResolver=!0,ignore.resolve=()=>{};createResolver(((O,B,U)=>{const G=createNewInstance(O,B),q=new ResolverImpl(O,0,G);return U.registerResolver(O,q),G})),createResolver(((O,B,U)=>createNewInstance(O,B)));function createNewInstance(O,B){return B.getFactory(O).construct(B)}class ResolverImpl{constructor(O,B,U){this.key=O,this.strategy=B,this.state=U,this.resolving=!1}get $isResolver(){return!0}register(O){return O.registerResolver(this.key,this)}resolve(O,B){switch(this.strategy){case 0:return this.state;case 1:if(this.resolving)throw new Error(`Cyclic dependency found: ${this.state.name}`);return this.resolving=!0,this.state=O.getFactory(this.state).construct(B),this.strategy=0,this.resolving=!1,this.state;case 2:{const U=O.getFactory(this.state);if(null===U)throw new Error(`Resolver for ${String(this.key)} returned a null factory`);return U.construct(B)}case 3:return this.state(O,B,this);case 4:return this.state[0].resolve(O,B);case 5:return B.get(this.state);default:throw new Error(`Invalid resolver strategy specified: ${this.strategy}.`)}}getFactory(O){var B,U,G;switch(this.strategy){case 1:case 2:return O.getFactory(this.state);case 5:return null!==(G=null===(U=null===(B=O.getResolver(this.state))||void 0===B?void 0:B.getFactory)||void 0===U?void 0:U.call(B,O))&&void 0!==G?G:null;default:return null}}}function containerGetKey(O){return this.get(O)}function transformInstance(O,B){return B(O)}class FactoryImpl{constructor(O,B){this.Type=O,this.dependencies=B,this.transformers=null}construct(O,B){let U;return U=void 0===B?new this.Type(...this.dependencies.map(containerGetKey,O)):new this.Type(...this.dependencies.map(containerGetKey,O),...B),null==this.transformers?U:this.transformers.reduce(transformInstance,U)}registerTransformer(O){(this.transformers||(this.transformers=[])).push(O)}}const Ot={$isResolver:!0,resolve:(O,B)=>B};function isRegistry(O){return"function"==typeof O.register}function isRegisterInRequester(O){return function(O){return isRegistry(O)&&"boolean"==typeof O.registerInRequestor}(O)&&O.registerInRequestor}const Mt=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]),Dt="__DI_LOCATE_PARENT__",Lt=new Map;class ContainerImpl{constructor(O,B){this.owner=O,this.config=B,this._parent=void 0,this.registerDepth=0,this.context=null,null!==O&&(O.$$container$$=this),this.resolvers=new Map,this.resolvers.set(At,Ot),O instanceof Node&&O.addEventListener(Dt,(O=>{O.composedPath()[0]!==this.owner&&(O.detail.container=this,O.stopImmediatePropagation())}))}get parent(){return void 0===this._parent&&(this._parent=this.config.parentLocator(this.owner)),this._parent}get depth(){return null===this.parent?0:this.parent.depth+1}get responsibleForOwnerRequests(){return this.config.responsibleForOwnerRequests}registerWithContext(O,...B){return this.context=O,this.register(...B),this.context=null,this}register(...O){if(100==++this.registerDepth)throw new Error("Unable to autoregister dependency");let B,U,G,q,j;const W=this.context;for(let Y=0,K=O.length;Y<K;++Y)if(B=O[Y],di_isObject(B))if(isRegistry(B))B.register(this,W);else if(void 0!==B.prototype)Ft.singleton(B,B).register(this);else for(U=Object.keys(B),q=0,j=U.length;q<j;++q)G=B[U[q]],di_isObject(G)&&(isRegistry(G)?G.register(this,W):this.register(G));return--this.registerDepth,this}registerResolver(O,B){validateKey(O);const U=this.resolvers,G=U.get(O);return null==G?U.set(O,B):G instanceof ResolverImpl&&4===G.strategy?G.state.push(B):U.set(O,new ResolverImpl(O,4,[G,B])),B}registerTransformer(O,B){const U=this.getResolver(O);if(null==U)return!1;if(U.getFactory){const O=U.getFactory(this);return null!=O&&(O.registerTransformer(B),!0)}return!1}getResolver(O,B=!0){if(validateKey(O),void 0!==O.resolve)return O;let U,G=this;for(;null!=G;){if(U=G.resolvers.get(O),null!=U)return U;if(null==G.parent){const U=isRegisterInRequester(O)?this:G;return B?this.jitRegister(O,U):null}G=G.parent}return null}has(O,B=!1){return!!this.resolvers.has(O)||!(!B||null==this.parent)&&this.parent.has(O,!0)}get(O){if(validateKey(O),O.$isResolver)return O.resolve(this,this);let B,U=this;for(;null!=U;){if(B=U.resolvers.get(O),null!=B)return B.resolve(U,this);if(null==U.parent){const G=isRegisterInRequester(O)?this:U;return B=this.jitRegister(O,G),B.resolve(U,this)}U=U.parent}throw new Error(`Unable to resolve key: ${O}`)}getAll(O,B=!1){validateKey(O);const U=this;let G,q=U;if(B){let B=rt;for(;null!=q;)G=q.resolvers.get(O),null!=G&&(B=B.concat(buildAllResponse(G,q,U))),q=q.parent;return B}for(;null!=q;){if(G=q.resolvers.get(O),null!=G)return buildAllResponse(G,q,U);if(q=q.parent,null==q)return rt}return rt}getFactory(O){let B=Lt.get(O);if(void 0===B){if($t(O))throw new Error(`${O.name} is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.`);Lt.set(O,B=new FactoryImpl(O,kt.getDependencies(O)))}return B}registerFactory(O,B){Lt.set(O,B)}createChild(O){return new ContainerImpl(null,Object.assign({},this.config,O,{parentLocator:()=>this}))}jitRegister(O,B){if("function"!=typeof O)throw new Error(`Attempted to jitRegister something that is not a constructor: '${O}'. Did you forget to register this dependency?`);if(Mt.has(O.name))throw new Error(`Attempted to jitRegister an intrinsic type: ${O.name}. Did you forget to add @inject(Key)`);if(isRegistry(O)){const U=O.register(B);if(!(U instanceof Object)||null==U.resolve){const U=B.resolvers.get(O);if(null!=U)return U;throw new Error("A valid resolver was not returned from the static register method")}return U}if(O.$isInterface)throw new Error(`Attempted to jitRegister an interface: ${O.friendlyName}`);{const U=this.config.defaultResolver(O,B);return B.resolvers.set(O,U),U}}}const Bt=new WeakMap;function cacheCallbackResult(O){return function(B,U,G){if(Bt.has(G))return Bt.get(G);const q=O(B,U,G);return Bt.set(G,q),q}}const Ft=Object.freeze({instance:(O,B)=>new ResolverImpl(O,0,B),singleton:(O,B)=>new ResolverImpl(O,1,B),transient:(O,B)=>new ResolverImpl(O,2,B),callback:(O,B)=>new ResolverImpl(O,3,B),cachedCallback:(O,B)=>new ResolverImpl(O,3,cacheCallbackResult(B)),aliasTo:(O,B)=>new ResolverImpl(B,5,O)});function validateKey(O){if(null==O)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}function buildAllResponse(O,B,U){if(O instanceof ResolverImpl&&4===O.strategy){const G=O.state;let q=G.length;const j=new Array(q);for(;q--;)j[q]=G[q].resolve(B,U);return j}return[O.resolve(B,U)]}const zt="(anonymous)";function di_isObject(O){return"object"==typeof O&&null!==O||"function"==typeof O}const $t=function(){const O=new WeakMap;let B=!1,U="",G=0;return function(q){return B=O.get(q),void 0===B&&(U=q.toString(),G=U.length,B=G>=29&&G<=100&&125===U.charCodeAt(G-1)&&U.charCodeAt(G-2)<=32&&93===U.charCodeAt(G-3)&&101===U.charCodeAt(G-4)&&100===U.charCodeAt(G-5)&&111===U.charCodeAt(G-6)&&99===U.charCodeAt(G-7)&&32===U.charCodeAt(G-8)&&101===U.charCodeAt(G-9)&&118===U.charCodeAt(G-10)&&105===U.charCodeAt(G-11)&&116===U.charCodeAt(G-12)&&97===U.charCodeAt(G-13)&&110===U.charCodeAt(G-14)&&88===U.charCodeAt(G-15),O.set(q,B)),B}}(),Ut={};function isArrayIndex(O){switch(typeof O){case"number":return O>=0&&(0|O)===O;case"string":{const B=Ut[O];if(void 0!==B)return B;const U=O.length;if(0===U)return Ut[O]=!1;let G=0;for(let B=0;B<U;++B)if(G=O.charCodeAt(B),0===B&&48===G&&U>1||G<48||G>57)return Ut[O]=!1;return Ut[O]=!0}default:return!1}}const Vt=kt.createInterface(),Gt={buildTimestamp:"Sat, 06 May 2023 03:46:12 GMT",version:"1.96.0",commit:"02bba293a79e1c12d16d3cfe08c27b49a80ac840"},Ht=kt.createInterface();function functional_once(O){const B=this;let U,G=!1;return function(){return G||(G=!0,U=O.apply(B,arguments)),U}}var qt;(function(O){function is(O){return O&&"object"==typeof O&&"function"==typeof O[Symbol.iterator]}O.is=is;const B=Object.freeze([]);function*single(O){yield O}O.empty=function(){return B},O.single=single,O.wrap=function(O){return is(O)?O:single(O)},O.from=function(O){return O||B},O.isEmpty=function(O){return!O||!0===O[Symbol.iterator]().next().done},O.first=function(O){return O[Symbol.iterator]().next().value},O.some=function(O,B){for(const U of O)if(B(U))return!0;return!1},O.find=function(O,B){for(const U of O)if(B(U))return U},O.filter=function*(O,B){for(const U of O)B(U)&&(yield U)},O.map=function*(O,B){let U=0;for(const G of O)yield B(G,U++)},O.concat=function*(...O){for(const B of O)for(const O of B)yield O},O.reduce=function(O,B,U){let G=U;for(const U of O)G=B(G,U);return G},O.slice=function*(O,B,U=O.length){for(B<0&&(B+=O.length),U<0?U+=O.length:U>O.length&&(U=O.length);B<U;B++)yield O[B]},O.consume=function(B,U=Number.POSITIVE_INFINITY){const G=[];if(0===U)return[G,B];const q=B[Symbol.iterator]();for(let B=0;B<U;B++){const B=q.next();if(B.done)return[G,O.empty()];G.push(B.value)}return[G,{[Symbol.iterator]:()=>q}]}})(qt||(qt={}));let jt=null;var Wt,Yt;function trackDisposable(O){return null==jt||jt.trackDisposable(O),O}function markAsDisposed(O){null==jt||jt.markAsDisposed(O)}function setParentOfDisposable(O,B){null==jt||jt.setParent(O,B)}function isDisposable(O){return"function"==typeof O.dispose&&0===O.dispose.length}function dispose(O){if(qt.is(O)){const B=[];for(const U of O)if(U)try{U.dispose()}catch(O){B.push(O)}if(1===B.length)throw B[0];if(B.length>1)throw new AggregateError(B,"Encountered errors while disposing of store");return Array.isArray(O)?[]:O}if(O)return O.dispose(),O}function combinedDisposable(...O){const B=lifecycle_toDisposable((()=>dispose(O)));return function(O,B){if(jt)for(const U of O)jt.setParent(U,B)}(O,B),B}function lifecycle_toDisposable(O){const B=trackDisposable({dispose:functional_once((()=>{markAsDisposed(B),O()}))});return B}class lifecycle_DisposableStore{constructor(){this._toDispose=new Set,this._isDisposed=!1,trackDisposable(this)}dispose(){this._isDisposed||(markAsDisposed(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(0!==this._toDispose.size)try{dispose(this._toDispose)}finally{this._toDispose.clear()}}add(O){if(!O)return O;if(O===this)throw new Error("Cannot register a disposable on itself!");return setParentOfDisposable(O,this),this._isDisposed?lifecycle_DisposableStore.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(O),O}}lifecycle_DisposableStore.DISABLE_DISPOSED_WARNING=!1;class lifecycle_Disposable{constructor(){this._store=new lifecycle_DisposableStore,trackDisposable(this),setParentOfDisposable(this._store,this)}dispose(){markAsDisposed(this),this._store.dispose()}_register(O){if(O===this)throw new Error("Cannot register a disposable on itself!");const B=isDisposable(O)?O:lifecycle_toDisposable(O);return this._store.add(B),O}}lifecycle_Disposable.None=Object.freeze({dispose(){}});class lifecycle_MutableDisposable{constructor(){this._isDisposed=!1,trackDisposable(this)}get value(){return this._isDisposed?void 0:this._value}set value(O){var B;this._isDisposed||O===this._value||(null===(B=this._value)||void 0===B||B.dispose(),O&&setParentOfDisposable(O,this),this._value=O)}clear(){this.value=void 0}dispose(){var O;this._isDisposed=!0,markAsDisposed(this),null===(O=this._value)||void 0===O||O.dispose(),this._value=void 0}clearAndLeak(){const O=this._value;return this._value=void 0,O&&setParentOfDisposable(O,null),O}}class SafeDisposable{constructor(){this.dispose=()=>{},this.unset=()=>{},this.isset=()=>!1,trackDisposable(this)}set(O){let B=O;return this.unset=()=>B=void 0,this.isset=()=>void 0!==B,this.dispose=()=>{B&&(B(),B=void 0,markAsDisposed(this))},this}}class DisposableMap{constructor(){this._store=new Map,this._isDisposed=!1,trackDisposable(this)}dispose(){markAsDisposed(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{dispose(this._store.values())}finally{this._store.clear()}}has(O){return this._store.has(O)}get(O){return this._store.get(O)}set(O,B,U=!1){var G;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),U||null===this._store.get(O)||void 0===G||G.dispose(),this._store.set(O,B)}deleteAndDispose(O){var B;null===this._store.get(O)||void 0===B||B.dispose(),this._store.delete(O)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}class Disposer extends lifecycle_Disposable{get isDisposed(){return this._store.isDisposed}register(O){return this._register(O)}}const{instance:Kt,singleton:Qt,transient:Zt,aliasTo:Xt,cachedCallback:Jt}=Ft;class AppService extends lifecycle_Disposable{constructor(O=!1){super(),Wt.set(this,void 0),Yt.set(this,new WeakMap),__classPrivateFieldSet(this,Wt,O?this.buildContainer():this.buildServicesContainer(),"f")}getElementContainer(O){let B=__classPrivateFieldGet(this,Yt,"f").get(O);return void 0===B&&(B=__classPrivateFieldGet(this,Wt,"f").createChild(),__classPrivateFieldGet(this,Yt,"f").set(O,B)),B}get(O){return __classPrivateFieldGet(this,Wt,"f").get(O)}addSingleton(O,B){__classPrivateFieldGet(this,Wt,"f").register(Qt(O,B))}addTransient(O,B){__classPrivateFieldGet(this,Wt,"f").register(Zt(O,B))}addAlias(O,B){__classPrivateFieldGet(this,Wt,"f").register(Xt(O,B))}addInstance(O,B){__classPrivateFieldGet(this,Wt,"f").register(Kt(O,B))}addFactory(O,B){__classPrivateFieldGet(this,Wt,"f").register(Jt(O,B))}buildServicesContainer(){return kt.getOrCreateDOMContainer(document.body)}buildContainer(){return kt.createContainer()}}Wt=new WeakMap,Yt=new WeakMap;const ei=kt.createInterface("ICaptchaService");const ti=new class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(O){setTimeout((()=>{if(O.stack){if(ErrorNoTelemetry.isErrorNoTelemetry(O))throw new ErrorNoTelemetry(O.message+"\n\n"+O.stack);throw new Error(O.message+"\n\n"+O.stack)}throw O}),0)}}addListener(O){return this.listeners.push(O),()=>{this._removeListener(O)}}emit(O){this.listeners.forEach((B=>{B(O)}))}_removeListener(O){this.listeners.splice(this.listeners.indexOf(O),1)}setUnexpectedErrorHandler(O){this.unexpectedErrorHandler=O}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(O){this.unexpectedErrorHandler(O),this.emit(O)}onUnexpectedExternalError(O){this.unexpectedErrorHandler(O)}};function errors_onUnexpectedError(O){isCancellationError(O)||ti.onUnexpectedError(O)}const ii="Canceled";function isCancellationError(O){return O instanceof errors_CancellationError||O instanceof Error&&O.name===ii&&O.message===ii}class errors_CancellationError extends Error{constructor(){super(ii),this.name=this.message}}class NotImplementedError extends Error{constructor(O){super("NotImplemented"),O&&(this.message=O)}}class NotSupportedError extends Error{constructor(O){super("NotSupported"),O&&(this.message=O)}}class ExpectedError extends Error{constructor(){super(...arguments),this.isExpected=!0}}class ErrorNoTelemetry extends Error{constructor(O){super(O),this.name="CodeExpectedError"}static fromError(O){if(O instanceof ErrorNoTelemetry)return O;const B=new ErrorNoTelemetry;return B.message=O.message,B.stack=O.stack,B}static isErrorNoTelemetry(O){return"CodeExpectedError"===O.name}}class BugIndicatingError extends Error{constructor(O){super(O||"An unexpected bug occurred."),Object.setPrototypeOf(this,BugIndicatingError.prototype)}}class linkedList_Node{constructor(O){this.element=O,this.next=linkedList_Node.Undefined,this.prev=linkedList_Node.Undefined}}linkedList_Node.Undefined=new linkedList_Node(void 0);class linkedList_LinkedList{constructor(){this._first=linkedList_Node.Undefined,this._last=linkedList_Node.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===linkedList_Node.Undefined}clear(){let O=this._first;for(;O!==linkedList_Node.Undefined;){const B=O.next;O.prev=linkedList_Node.Undefined,O.next=linkedList_Node.Undefined,O=B}this._first=linkedList_Node.Undefined,this._last=linkedList_Node.Undefined,this._size=0}unshift(O){return this._insert(O,!1)}push(O){return this._insert(O,!0)}_insert(O,B){const U=new linkedList_Node(O);if(this._first===linkedList_Node.Undefined)this._first=U,this._last=U;else if(B){const O=this._last;this._last=U,U.prev=O,O.next=U}else{const O=this._first;this._first=U,U.next=O,O.prev=U}this._size+=1;let G=!1;return()=>{G||(G=!0,this._remove(U))}}shift(){if(this._first!==linkedList_Node.Undefined){const O=this._first.element;return this._remove(this._first),O}}pop(){if(this._last!==linkedList_Node.Undefined){const O=this._last.element;return this._remove(this._last),O}}_remove(O){if(O.prev!==linkedList_Node.Undefined&&O.next!==linkedList_Node.Undefined){const B=O.prev;B.next=O.next,O.next.prev=B}else O.prev===linkedList_Node.Undefined&&O.next===linkedList_Node.Undefined?(this._first=linkedList_Node.Undefined,this._last=linkedList_Node.Undefined):O.next===linkedList_Node.Undefined?(this._last=this._last.prev,this._last.next=linkedList_Node.Undefined):O.prev===linkedList_Node.Undefined&&(this._first=this._first.next,this._first.prev=linkedList_Node.Undefined);this._size-=1}*[Symbol.iterator](){let O=this._first;for(;O!==linkedList_Node.Undefined;)yield O.element,O=O.next}}var ri;(function(O){function _addLeakageTraceLogic(O){false}function once(O){return(B,U=null,G)=>{let q,j=!1;return q=O((O=>{if(!j)return q?q.dispose():j=!0,B.call(U,O)}),null,G),j&&q.dispose(),q}}function map(O,B,U){return snapshot(((U,G=null,q)=>O((O=>U.call(G,B(O))),null,q)),U)}function forEach(O,B,U){return snapshot(((U,G=null,q)=>O((O=>{B(O),U.call(G,O)}),null,q)),U)}function filter(O,B,U){return snapshot(((U,G=null,q)=>O((O=>B(O)&&U.call(G,O)),null,q)),U)}function reduce(O,B,U,G){let q=U;return map(O,(O=>(q=B(q,O),q)),G)}function snapshot(O,B){let U;const G={onFirstListenerAdd(){U=O(q.fire,q)},onLastListenerRemove(){null==U||U.dispose()}};B||_addLeakageTraceLogic();const q=new Emitter(G);return null==B||B.add(q),q.event}function debounce(O,B,U=100,G=!1,q,j){let W,Y,K,Q=0;const Z={onFirstListenerAdd(){W=O((O=>{Q++,Y=B(Y,O),G&&!K&&(X.fire(Y),Y=void 0),clearTimeout(K),K=setTimeout((()=>{const O=Y;Y=void 0,K=void 0,(!G||Q>1)&&X.fire(O),Q=0}),U)}))},onLastListenerRemove(){W.dispose()}};j||_addLeakageTraceLogic();const X=new Emitter(Z);return null==j||j.add(X),X.event}function latch(O,B=((O,B)=>O===B),U){let G,q=!0;return filter(O,(O=>{const U=q||!B(O,G);return q=!1,G=O,U}),U)}O.None=()=>lifecycle_Disposable.None,O.defer=function(O,B){return debounce(O,(()=>{}),0,void 0,void 0,B)},O.accumulate=function(B,U=0,G){return O.debounce(B,((O,B)=>O?(O.push(B),O):[B]),U,void 0,void 0,G)},O.once=once,O.map=map,O.forEach=forEach,O.filter=filter,O.signal=function(O){return O},O.any=function(...O){return(B,U=null,G)=>combinedDisposable(...O.map((O=>O((O=>B.call(U,O)),null,G))))},O.reduce=reduce,O.debounce=debounce,O.latch=latch,O.split=function(B,U,G){return[O.filter(B,U,G),O.filter(B,(O=>!U(O)),G)]},O.buffer=function(O,B=!1,U=[]){let G=U.slice(),q=O((O=>{G?G.push(O):j.fire(O)}));const flush=()=>{null==G||G.forEach((O=>j.fire(O))),G=null},j=new Emitter({onFirstListenerAdd(){q||(q=O((O=>j.fire(O))))},onFirstListenerDidAdd(){G&&(B?setTimeout(flush):flush())},onLastListenerRemove(){q&&q.dispose(),q=null}});return j.event};class ChainableEvent{constructor(O){this.event=O,this.disposables=new lifecycle_DisposableStore}map(O){return new ChainableEvent(map(this.event,O,this.disposables))}forEach(O){return new ChainableEvent(forEach(this.event,O,this.disposables))}filter(O){return new ChainableEvent(filter(this.event,O,this.disposables))}reduce(O,B){return new ChainableEvent(reduce(this.event,O,B,this.disposables))}latch(){return new ChainableEvent(latch(this.event,void 0,this.disposables))}debounce(O,B=100,U=!1,G){return new ChainableEvent(debounce(this.event,O,B,U,0,this.disposables))}on(O,B,U){return this.event(O,B,U)}once(O,B,U){return once(this.event)(O,B,U)}dispose(){this.disposables.dispose()}}O.chain=function(O){return new ChainableEvent(O)},O.fromNodeEventEmitter=function(O,B,U=(O=>O)){const fn=(...O)=>G.fire(U(...O)),G=new Emitter({onFirstListenerAdd:()=>O.on(B,fn),onLastListenerRemove:()=>O.removeListener(B,fn)});return G.event},O.fromDOMEventEmitter=function(O,B,U=(O=>O)){const fn=(...O)=>G.fire(U(...O)),G=new Emitter({onFirstListenerAdd:()=>O.addEventListener(B,fn),onLastListenerRemove:()=>O.removeEventListener(B,fn)});return G.event},O.toPromise=function(O){return new Promise((B=>once(O)(B)))},O.runAndSubscribe=function(O,B){return B(void 0),O((O=>B(O)))},O.runAndSubscribeWithStore=function(O,B){let U=null;function run(O){null==U||U.dispose(),U=new lifecycle_DisposableStore,B(O,U)}run(void 0);const G=O((O=>run(O)));return lifecycle_toDisposable((()=>{G.dispose(),null==U||U.dispose()}))}})(ri||(ri={}));class Listener{constructor(O,B,U){this.callback=O,this.callbackThis=B,this.stack=U,this.subscription=new SafeDisposable}invoke(O){this.callback.call(this.callbackThis,O)}}class Emitter{constructor(O){var B;this._disposed=!1,this._options=O,this._deliveryQueue=null===(B=this._options)||void 0===B?void 0:B.deliveryQueue}dispose(){var O,B,U;this._disposed||(this._disposed=!0,this._listeners&&this._listeners.clear(),null===(O=this._deliveryQueue)||void 0===O||O.clear(this),null===(U=null===(B=this._options)||void 0===B?void 0:B.onLastListenerRemove)||void 0===U||U.call(B))}get event(){return this._event||(this._event=(O,B,U)=>{var G,q,j;this._listeners||(this._listeners=new linkedList_LinkedList);const W=this._listeners.isEmpty();W&&(null===(G=this._options)||void 0===G?void 0:G.onFirstListenerAdd)&&this._options.onFirstListenerAdd(this);const Y=new Listener(O,B,void 0),K=this._listeners.push(Y);W&&(null===(q=this._options)||void 0===q?void 0:q.onFirstListenerDidAdd)&&this._options.onFirstListenerDidAdd(this),(null===(j=this._options)||void 0===j?void 0:j.onListenerDidAdd)&&this._options.onListenerDidAdd(this,O,B);const Q=Y.subscription.set((()=>{if(!this._disposed&&(K(),this._options&&this._options.onLastListenerRemove)){this._listeners&&!this._listeners.isEmpty()||this._options.onLastListenerRemove(this)}}));return U instanceof lifecycle_DisposableStore?U.add(Q):Array.isArray(U)&&U.push(Q),Q}),this._event}fire(O){if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new PrivateEventDeliveryQueue);for(const B of this._listeners)this._deliveryQueue.push(this,B,O);this._deliveryQueue.deliver()}}hasListeners(){return!!this._listeners&&!this._listeners.isEmpty()}}class EventDeliveryQueue{constructor(){this._queue=new linkedList_LinkedList}get size(){return this._queue.size}push(O,B,U){this._queue.push(new EventDeliveryQueueElement(O,B,U))}clear(O){const B=new linkedList_LinkedList;for(const U of this._queue)U.emitter!==O&&B.push(U);this._queue=B}deliver(){for(;this._queue.size>0;){const O=this._queue.shift();try{O.listener.invoke(O.event)}catch(O){errors_onUnexpectedError(O)}}}}class PrivateEventDeliveryQueue extends EventDeliveryQueue{clear(O){this._queue.clear()}}class EventDeliveryQueueElement{constructor(O,B,U){this.emitter=O,this.listener=B,this.event=U}}class DomEmitter{constructor(O,B,U){const fn=O=>this.emitter.fire(O);this.emitter=new Emitter({onFirstListenerAdd:()=>O.addEventListener(B,fn,U),onLastListenerRemove:()=>O.removeEventListener(B,fn,U)})}get event(){return this.emitter.event}dispose(){this.emitter.dispose()}}const ni=Object.freeze((function(O,B){const U=setTimeout(O.bind(B),0);return{dispose(){clearTimeout(U)}}}));var oi;(function(O){O.isCancellationToken=function(B){return B===O.None||B===O.Cancelled||(B instanceof MutableToken||!(!B||"object"!=typeof B)&&("boolean"==typeof B.isCancellationRequested&&"function"==typeof B.onCancellationRequested))},O.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ri.None}),O.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:ni})})(oi||(oi={}));class MutableToken{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?ni:(this._emitter||(this._emitter=new Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class cancellation_CancellationTokenSource{constructor(O){this._token=void 0,this._parentListener=void 0,this._parentListener=O&&O.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new MutableToken),this._token}cancel(){this._token?this._token instanceof MutableToken&&this._token.cancel():this._token=oi.Cancelled}dispose(O=!1){var B;O&&this.cancel(),null===(B=this._parentListener)||void 0===B||B.dispose(),this._token?this._token instanceof MutableToken&&this._token.dispose():this._token=oi.None}}let ai,si=!1,li=!1,ci=!1,di=!1,pi=!1,ui=!1;const hi="object"==typeof self?self:"object"==typeof U.g?U.g:{};var mi;"object"==typeof navigator?(ai=navigator.userAgent,si=ai.indexOf("Windows")>=0,li=ai.indexOf("Macintosh")>=0,pi=(ai.indexOf("Macintosh")>=0||ai.indexOf("iPad")>=0||ai.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,ci=ai.indexOf("Linux")>=0,ui=(null==ai?void 0:ai.indexOf("Mobi"))>=0,di=!0):console.error("Unable to resolve platform."),function(O){O[O.Web=0]="Web",O[O.Mac=1]="Mac",O[O.Linux=2]="Linux",O[O.Windows=3]="Windows"}(mi||(mi={}));let gi=0;li?gi=1:si?gi=3:ci&&(gi=2);const fi=si,yi=li,_i=(di&&hi.importScripts,pi),vi=ai,bi="en";var Si;(function(O){O.value=function(){return bi},O.isDefaultVariant=function(){return 2===bi.length||bi.length>=3&&("e"===bi[0]&&"n"===bi[1]&&"-"===bi[2])},O.isDefault=function(){return!0}})(Si||(Si={}));const Ci="function"==typeof hi.postMessage&&!hi.importScripts,Ei=(()=>{if(Ci){const O=[];hi.addEventListener("message",(B=>{if(B.data&&B.data.vscodeScheduleAsyncWork)for(let U=0,G=O.length;U<G;U++){const G=O[U];if(G.id===B.data.vscodeScheduleAsyncWork)return O.splice(U,1),void G.callback()}}));let B=0;return U=>{const G=++B;O.push({id:G,callback:U}),hi.postMessage({vscodeScheduleAsyncWork:G},"*")}}return O=>setTimeout(O)})();var xi;(function(O){O[O.Windows=1]="Windows",O[O.Macintosh=2]="Macintosh",O[O.Linux=3]="Linux"})(xi||(xi={}));const Ti=!!(vi&&vi.indexOf("Chrome")>=0);vi&&vi.indexOf("Firefox"),!Ti&&vi&&vi.indexOf("Safari"),vi&&vi.indexOf("Edg/"),vi&&vi.indexOf("Android");const wi=Symbol("MicrotaskDelay");class Delayer{constructor(O){this.defaultDelay=O,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(O,B=this.defaultDelay){this.task=O,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(((O,B)=>{this.doResolve=O,this.doReject=B})).then((()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const O=this.task;return this.task=null,O()}})));const fn=()=>{var O;this.deferred=null,null===(O=this.doResolve)||void 0===O||O.call(this,null)};return this.deferred=B===wi?(O=>{let B=!0;return queueMicrotask((()=>{B&&(B=!1,O())})),{isTriggered:()=>B,dispose:()=>{B=!1}}})(fn):((O,B)=>{let U=!0;const G=setTimeout((()=>{U=!1,B()}),O);return{isTriggered:()=>U,dispose:()=>{clearTimeout(G),U=!1}}})(B,fn),this.completionPromise}isTriggered(){var O;return!!(null===(O=this.deferred)||void 0===O?void 0:O.isTriggered())}cancel(){var O;this.cancelTimeout(),this.completionPromise&&(null===(O=this.doReject)||void 0===O||O.call(this,new errors_CancellationError),this.completionPromise=null)}cancelTimeout(){var O;null===(O=this.deferred)||void 0===O||O.dispose(),this.deferred=null}dispose(){this.cancel()}}class Limiter{constructor(O){this._size=0,this.maxDegreeOfParalellism=O,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new Emitter}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(O){return this._size++,new Promise(((B,U)=>{this.outstandingPromises.push({factory:O,c:B,e:U}),this.consume()}))}purge(){this.outstandingPromises.length=0,this._size=0}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const O=this.outstandingPromises.shift();this.runningPromises++;const B=O.factory();B.then(O.c,O.e),B.then((()=>this.consumed()),(()=>this.consumed()))}}consumed(){this._size--,this.runningPromises--,this.outstandingPromises.length>0?this.consume():this._onDrained.fire()}dispose(){this._onDrained.dispose()}}class Queue extends Limiter{constructor(){super(1)}}class async_TimeoutTimer{constructor(O,B){this._token=-1,"function"==typeof O&&"number"==typeof B&&this.setIfNotSet(O,B)}dispose(){this.cancel()}cancel(){-1!==this._token&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(O,B){this.cancel(),this._token=setTimeout((()=>{this._token=-1,O()}),B)}setIfNotSet(O,B){-1===this._token&&(this._token=setTimeout((()=>{this._token=-1,O()}),B))}}let ki;ki="function"!=typeof requestIdleCallback||"function"!=typeof cancelIdleCallback?O=>{Ei((()=>{if(B)return;const U=Date.now()+15;O(Object.freeze({didTimeout:!0,timeRemaining:()=>Math.max(0,U-Date.now())}))}));let B=!1;return{dispose(){B||(B=!0)}}}:(O,B)=>{const U=requestIdleCallback(O,"number"==typeof B?{timeout:B}:void 0);let G=!1;return{dispose(){G||(G=!0,cancelIdleCallback(U))}}};class DeferredPromise{constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise(((O,B)=>{this.completeCallback=O,this.errorCallback=B}))}get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}complete(O){return new Promise((B=>{this.completeCallback(O),this.resolved=!0,B()}))}error(O){return new Promise((B=>{this.errorCallback(O),this.rejected=!0,B()}))}cancel(){new Promise((O=>{this.errorCallback(new errors_CancellationError),this.rejected=!0,O()}))}}var Ai,Ri;(function(O){O.settled=async function(O){let B;const U=await Promise.all(O.map((O=>O.then((O=>O),(O=>{B||(B=O)})))));if(void 0!==B)throw B;return U},O.withAsyncBody=function(O){return new Promise((async(B,U)=>{try{await O(B,U)}catch(O){U(O)}}))}})(Ai||(Ai={})),function(O){O[O.Initial=0]="Initial",O[O.DoneOK=1]="DoneOK",O[O.DoneError=2]="DoneError"}(Ri||(Ri={}));class AsyncIterableObject{constructor(O){this._state=0,this._results=[],this._error=null,this._onStateChanged=new Emitter,queueMicrotask((async()=>{const B={emitOne:O=>this.emitOne(O),emitMany:O=>this.emitMany(O),reject:O=>this.reject(O)};try{await Promise.resolve(O(B)),this.resolve()}catch(O){this.reject(O instanceof Error?O:new Error(`${O}`))}finally{B.emitOne=void 0,B.emitMany=void 0,B.reject=void 0}}))}static fromArray(O){return new AsyncIterableObject((B=>{B.emitMany(O)}))}static fromPromise(O){return new AsyncIterableObject((async B=>{B.emitMany(await O)}))}static fromPromises(O){return new AsyncIterableObject((async B=>{await Promise.all(O.map((async O=>B.emitOne(await O))))}))}static merge(O){return new AsyncIterableObject((async B=>{await Promise.all(O.map((async O=>{for await(const U of O)B.emitOne(U)})))}))}[Symbol.asyncIterator](){let O=0;return{next:async()=>{for(;;){if(2===this._state)throw this._error;if(O<this._results.length)return{done:!1,value:this._results[O++]};if(1===this._state)return{done:!0,value:void 0};await ri.toPromise(this._onStateChanged.event)}}}}static map(O,B){return new AsyncIterableObject((async U=>{for await(const G of O)U.emitOne(B(G))}))}map(O){return AsyncIterableObject.map(this,O)}static filter(O,B){return new AsyncIterableObject((async U=>{for await(const G of O)B(G)&&U.emitOne(G)}))}filter(O){return AsyncIterableObject.filter(this,O)}static coalesce(O){return AsyncIterableObject.filter(O,(O=>!!O))}coalesce(){return AsyncIterableObject.coalesce(this)}static async toPromise(O){const B=[];for await(const U of O)B.push(U);return B}toPromise(){return AsyncIterableObject.toPromise(this)}emitOne(O){0===this._state&&(this._results.push(O),this._onStateChanged.fire())}emitMany(O){0===this._state&&(this._results=this._results.concat(O),this._onStateChanged.fire())}resolve(){0===this._state&&(this._state=1,this._onStateChanged.fire())}reject(O){0===this._state&&(this._state=2,this._error=O,this._onStateChanged.fire())}}AsyncIterableObject.EMPTY=AsyncIterableObject.fromArray([]);const Ii=kt.createInterface(),Pi=kt.createInterface();function isError(O){return O instanceof Error}function ErrorUtils_getErrorMessage(O){let B=O.message,U=O;for(;U.cause;)U=U.cause,B=`${B} ${U.message}`;return B}function ensureErrorInstance(O){return O instanceof Error?O:new Error(String(O))}let Ni=class{constructor(O,B){var U;this.api=O,this.log=B,this._onCaptchaChallengeRequestedEmitter=new Emitter,this.currentCaptcha=null,this.captchaStatusToken=null,null===(U=this.log)||void 0===U||U.trace(this,"ctor",null).write()}onCaptchaChallengeRequested(O){return this._onCaptchaChallengeRequestedEmitter.event(O)}getCaptchaChallengeResultAsync(){return this.startCaptchaChallengeAsync(),this.captchaStatusToken=new DeferredPromise,this.captchaStatusToken.p}cancelCaptchaChallenge(){var O;null===(O=this.captchaStatusToken)||void 0===O||O.complete(!1)}async submitCaptchaAsync(O){var B,U,G;if(null===(B=this.log)||void 0===B||B.trace(this,this.submitCaptchaAsync,O).write(),null===this.currentCaptcha)return!1;try{const{id:B,regionid:G}=this.currentCaptcha,q=await this.api.bing.captcha.verify(B,G,O);return q.solved?null===(U=this.captchaStatusToken)||void 0===U||U.complete(!0):this.startCaptchaChallengeAsync(),q.solved}catch(B){const U=ensureErrorInstance(B),q=`Verify Captcha Request failed (value: '${O}'): '${ErrorUtils_getErrorMessage(U)}'`;throw null===(G=this.log)||void 0===G||G.error(this,this.submitCaptchaAsync,q).write(),new Error(q,{cause:U})}}async startCaptchaChallengeAsync(){var O,B;null===(O=this.log)||void 0===O||O.trace(this,this.startCaptchaChallengeAsync,null).write();try{const O=await this.api.bing.captcha.create(),B=await O.blobBody;O.captchaImgSrc=URL.createObjectURL(B),this.currentCaptcha=O,this._onCaptchaChallengeRequestedEmitter.fire(this.currentCaptcha.captchaImgSrc)}catch(O){const U=ensureErrorInstance(O),G=`Get Captcha Request failed: '${ErrorUtils_getErrorMessage(U)}'`;throw null===(B=this.log)||void 0===B||B.error(this,this.startCaptchaChallengeAsync,G).write(),new Error(G,{cause:U})}}};var Oi;Ni=__decorate([__param(0,Ii),__param(1,Nt(Pi)),__metadata("design:paramtypes",[Object,Object])],Ni),function(O){O.AccessTokenHash="at_hash",O.AccessTokenMaxUses="at_use_nbr",O.Actor="act",O.Address="address",O.Audience="aud",O.AuthenticationContextClassReference="acr",O.AuthenticationMethod="amr",O.AuthorizedActor="may_act",O.AuthorizedParty="azp",O.AuthenticationTime="auth_time",O.BirthDate="birthdate",O.ClientId="client_id",O.AuthorizationCodeHash="c_hash",O.Confirmation="cnf",O.DestinationId="dest",O.DivertedTarget="div",O.Email="email",O.EmailVerified="email_verified",O.Expiration="exp",O.FirstName="given_name",O.GivenName="given_name",O.Gender="gender",O.IssuedAt="iat",O.Issuer="iss",O.JCard="jcard",O.JwtId="jti",O.LastName="family_name",O.FamilyName="family_name",O.Locale="locale",O.MediaKeyFingerprint="mky",O.MiddleName="middle_name",O.Name="name",O.NickName="nickname",O.Nonce="nonce",O.NotBefore="nbf",O.OriginalPASSporT="opt",O.OriginatingId="orig",O.PhoneNumber="phone_number",O.PhoneNumberVerified="phone_number_verified",O.PreferredUsername="preferred_username",O.Profile="profile",O.Picture="picture",O.ResourcePriorityHeader="rph",O.Scope="scope",O.SecurityEvents="events",O.SelfIssuedOidProviderPublicKey="sub_jwk",O.SessionId="sid",O.ShakenAttestationLevel="attest",O.ShakenOriginatingId="origid",O.SipCallId="sip_callid",O.SipCSeqNum="sip_cseq_num",O.SipDate="sip_date",O.SipFromTag="sip_from_tag",O.SipViaBranch="sip_via_branch",O.Subject="sub",O.TimeofEvent="toe",O.TimeZone="zoneinfo",O.ZoneInfo="zoneinfo",O.TransactionId="txn",O.UpdatedAt="updated_at",O.VectorOfTrust="vot",O.VectorOfTrustTrustmarkUrl="vtm",O.VerifiableCredential="vc",O.VerifiablePresentation="vp",O.Website="website",O.Id="id",O.Secret="secret",O.IdentityProvider="idp",O.Role="role",O.ObjectId="oid",O.TenantId="tid"}(Oi||(Oi={}));const Mi=new Map([["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier",Oi.Subject],["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress",Oi.Email],["http://schemas.microsoft.com/identity/claims/objectidentifier",Oi.ObjectId],["http://schemas.microsoft.com/identity/claims/tenantid",Oi.TenantId]]);var Di;(function(O){O.shortClaimType=function(O){var B;return O.startsWith("http://")&&null!==(B=Mi.get(O))&&void 0!==B?B:O}})(Di||(Di={}));Object.freeze(["exp","iat","nbf"]);var Li,Bi,Fi,zi,$i,Ui,Vi,Gi,Hi,qi,ji,Wi,Yi,Ki,Qi,Zi,Xi,Ji,er,tr,ir,rr,nr,or,ar,sr;(function(O){O.HttpLocalhost7071V0="http://localhost:7071/v0",O.HttpsProteusAzureApiNetTestV0="https://proteus.azure-api.net/test/v0",O.HttpsProteusAzureApiNetV0="https://proteus.azure-api.net/v0"})(Li||(Li={})),function(O){O.Trace="Trace",O.Debug="Debug",O.Info="Info",O.Warning="Warning",O.Error="Error",O.Critical="Critical",O.Off="Off"}(Bi||(Bi={})),function(O){O.Include="Include",O.Exclude="Exclude"}(Fi||(Fi={})),function(O){O.Scroll="Scroll",O.ScaleToFit="ScaleToFit"}(zi||(zi={})),function(O){O.Upright="Upright",O.Right="Right",O.Flipped="Flipped",O.Left="Left"}($i||($i={})),function(O){O.Single="Single",O.DualBoth="DualBoth",O.DualPrimary="DualPrimary",O.DualSecondary="DualSecondary",O.Tiled="Tiled"}(Ui||(Ui={})),function(O){O.Image="Image",O.Color="Color",O.GenericComponent="GenericComponent"}(Vi||(Vi={})),function(O){O.Image="Image",O.Color="Color",O.Timeline="Timeline"}(Gi||(Gi={})),function(O){O[O.Zero=0]="Zero",O[O.One=1]="One"}(Hi||(Hi={})),function(O){O.TextBlock="TextBlock",O.RichTextBlock="RichTextBlock",O.TextRun="TextRun"}(qi||(qi={})),function(O){O[O.ChatResponse=0]="ChatResponse",O[O.GetMessagesResponse=1]="GetMessagesResponse",O[O.GetConversationResponse=2]="GetConversationResponse",O[O.GetSharedMessagesResponse=3]="GetSharedMessagesResponse",O[O.SerpCachedResponse=4]="SerpCachedResponse",O[O.CaptchaResponse=5]="CaptchaResponse"}(ji||(ji={})),function(O){O.Unknown="Unknown",O.Success="Success",O.InternalError="InternalError",O.InvalidSession="InvalidSession",O.ConfigurationError="ConfigurationError",O.InvalidRequest="InvalidRequest",O.UnauthorizedRequest="UnauthorizedRequest",O.Canceled="Canceled",O.Throttled="Throttled",O.CaptchaChallenge="CaptchaChallenge"}(Wi||(Wi={})),function(O){O.Bot="bot",O.User="user"}(Yi||(Yi={})),function(O){O.AnnRules="AnnRules",O.Apology="Apology",O.BingContent="Bing Content",O.Chitchat="Chitchat",O.NluDirectResponse="NluDirectResponse",O.Qna="Qna",O.TopicChanger="TopicChanger",O.Delighterdluni="Delighterdluni",O.DeepLeo="DeepLeo"}(Ki||(Ki={})),function(O){O.Image="IMAGE"}(Qi||(Qi={})),function(O){O.WebPage="WebPage"}(Zi||(Zi={})),function(O){O.None="None",O.Positive="Positive",O.Negative="Negative",O.Laugh="Laugh",O.Surprised="Surprised",O.UnknownBf="UnknownBf"}(Xi||(Xi={})),function(O){O.Keyboard="Keyboard",O.Speech="Speech"}(Ji||(Ji={})),function(O){O.AudioUrl="AudioUrl",O.None="None",O.Simple="Simple",O.Ssml="Ssml"}(er||(er={})),function(O){O.ActionRequest="ActionRequest",O.Ads="Ads",O.AdsQuery="AdsQuery",O.CaptchaChallenge="CaptchaChallenge",O.Chat="Chat",O.Context="Context",O.Disengaged="Disengaged",O.SearchQuery="SearchQuery",O.Internal="Internal",O.Suggestion="Suggestion",O.InternalSuggestions="InternalSuggestions",O.InternalSearchQuery="InternalSearchQuery",O.InternalSearchResult="InternalSearchResult",O.InternalActionMarker="InternalActionMarker",O.InternalStateMarker="InternalStateMarker",O.InternalLoaderMessage="InternalLoaderMessage",O.GenerateContentQuery="GenerateContentQuery",O.RenderCardRequest="RenderCardRequest",O.SemanticSerp="SemanticSerp",O.Any="Any"}(tr||(tr={})),function(O){O.IncomingBotResponse=void 0}(tr||(tr={})),function(O){O.Blank="BLANK",O.BingFrontPageSkill="BING_FRONT_PAGE_SKILL",O.BingSkill="BING_SKILL",O.Chitchat="CHITCHAT",O.Infoseeking="INFOSEEKING",O.InitialBingFrontPageSkill="INITIAL_BING_FRONT_PAGE_SKILL",O.InitialQNA="INITIAL_QNA",O.InitialVideos="INITIAL_VIDEOS",O.InitialWebpages="INITIAL_WEBPAGES",O.MedicalHealth="MEDICAL_HEALTH",O.MicrosoftBrands="MICROSOFT_BRANDS",O.NeedEmpathy="NEED_EMPATHY",O.Offensive="OFFENSIVE",O.OpinionGiving="OPINION_GIVING",O.OpinionSeeking="OPINION_SEEKING",O.OUTOFDomain="OUT_OF_DOMAIN",O.QNA="QNA",O.SettingsChange="SETTINGS_CHANGE",O.SettingsCheck="SETTINGS_CHECK",O.SuicideHelp="SUICIDE_HELP",O.TuringBOTSafe="TURING_BOT_SAFE",O.Unhandled="UNHANDLED",O.Videos="VIDEOS",O.Webpages="WEBPAGES"}(ir||(ir={})),function(O){O.Amount="AMOUNT",O.Setting="SETTING",O.Type="TYPE",O.Unknown="UNKNOWN",O.Unit="UNIT",O.Value="VALUE"}(rr||(rr={})),function(O){O.Unknown="Unknown",O.None="None",O.Offensive="Offensive",O.OffenseTrigger="OffenseTrigger",O.OffenseResponse="OffenseResponse",O.Blocklist="Blocklist"}(nr||(nr={})),function(O){O.Finished="FINISHED",O.Intermediate="INTERMEDIATE"}(or||(or={})),function(O){O.General="General",O.Internal="Internal"}(ar||(ar={}));class AdsMessage{constructor(O,B,U){this.messageType=tr.Ads,this.author=Yi.Bot,this.contentOrigin="search ads",this.adsQueryId=O,this.description=U,this.adsInfo=B}}(function(O){O.Creative="Creative",O.Balanced="Balanced",O.Precise="Precise"})(sr||(sr={}));var lr,cr,dr,pr;U(7659);(function(O){O.Success="Success",O.TooManyRequests="TooManyRequests",O.NoContent="NoContent",O.UnauthorizedRequest="UnauthorizedRequest",O.Forbidden="Forbidden",O.InternalServerError="InternalServerError",O.CaptchaChallenge="CaptchaChallenge"})(lr||(lr={})),function(O){O.Creative="Creative",O.Balanced="Balanced",O.Precise="Precise"}(cr||(cr={})),function(O){O.Visual="visual"}(dr||(dr={})),function(O){O[O.Proteus=0]="Proteus",O[O.OpenAI=1]="OpenAI",O[O.Sydney=2]="Sydney",O[O.WebSearch=3]="WebSearch",O[O.Bing=4]="Bing"}(pr||(pr={}));var tslib_es6_extendStatics=function(O,B){return tslib_es6_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var U in B)B.hasOwnProperty(U)&&(O[U]=B[U])},tslib_es6_extendStatics(O,B)};function tslib_es6_extends(O,B){function __(){this.constructor=O}tslib_es6_extendStatics(O,B),O.prototype=null===B?Object.create(B):(__.prototype=B.prototype,new __)}var ur,tslib_es6_assign=function(){return tslib_es6_assign=Object.assign||function(O){for(var B,U=1,G=arguments.length;U<G;U++)for(var q in B=arguments[U])Object.prototype.hasOwnProperty.call(B,q)&&(O[q]=B[q]);return O},tslib_es6_assign.apply(this,arguments)};function tslib_es6_decorate(O,B,U,G){var q,j=arguments.length,W=j<3?B:null===G?G=Object.getOwnPropertyDescriptor(B,U):G;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(O,B,U,G);else for(var Y=O.length-1;Y>=0;Y--)(q=O[Y])&&(W=(j<3?q(W):j>3?q(B,U,W):q(B,U))||W);return j>3&&W&&Object.defineProperty(B,U,W),W}function tslib_es6_awaiter(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))}function tslib_es6_generator(O,B){var U,G,q,j,W={label:0,sent:function(){if(1&q[0])throw q[1];return q[1]},trys:[],ops:[]};return j={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(j[Symbol.iterator]=function(){return this}),j;function verb(j){return function(Y){return function(j){if(U)throw new TypeError("Generator is already executing.");for(;W;)try{if(U=1,G&&(q=2&j[0]?G.return:j[0]?G.throw||((q=G.return)&&q.call(G),0):G.next)&&!(q=q.call(G,j[1])).done)return q;switch(G=0,q&&(j=[2&j[0],q.value]),j[0]){case 0:case 1:q=j;break;case 4:return W.label++,{value:j[1],done:!1};case 5:W.label++,G=j[1],j=[0];continue;case 7:j=W.ops.pop(),W.trys.pop();continue;default:if(!(q=W.trys,(q=q.length>0&&q[q.length-1])||6!==j[0]&&2!==j[0])){W=0;continue}if(3===j[0]&&(!q||j[1]>q[0]&&j[1]<q[3])){W.label=j[1];break}if(6===j[0]&&W.label<q[1]){W.label=q[1],q=j;break}if(q&&W.label<q[2]){W.label=q[2],W.ops.push(j);break}q[2]&&W.ops.pop(),W.trys.pop();continue}j=B.call(O,W)}catch(O){j=[6,O],G=0}finally{U=q=0}if(5&j[0])throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}([j,Y])}}}function encodeByteArray(O){for(var B="",U=0;U<O.length;U++)B+=String.fromCharCode(O[U]);return btoa(B)}function decodeString(O){for(var B=atob(O),U=new Uint8Array(B.length),G=0;G<B.length;G++)U[G]=B.charCodeAt(G);return U}var hr=new Uint8Array(16);function rng(){if(!ur&&!(ur="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ur(hr)}const mr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const esm_browser_validate=function(O){return"string"==typeof O&&mr.test(O)};for(var gr=[],fr=0;fr<256;++fr)gr.push((fr+256).toString(16).substr(1));const esm_browser_stringify=function(O){var B=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,U=(gr[O[B+0]]+gr[O[B+1]]+gr[O[B+2]]+gr[O[B+3]]+"-"+gr[O[B+4]]+gr[O[B+5]]+"-"+gr[O[B+6]]+gr[O[B+7]]+"-"+gr[O[B+8]]+gr[O[B+9]]+"-"+gr[O[B+10]]+gr[O[B+11]]+gr[O[B+12]]+gr[O[B+13]]+gr[O[B+14]]+gr[O[B+15]]).toLowerCase();if(!esm_browser_validate(U))throw TypeError("Stringified UUID is invalid");return U};const esm_browser_v4=function(O,B,U){var G=(O=O||{}).random||(O.rng||rng)();if(G[6]=15&G[6]|64,G[8]=63&G[8]|128,B){U=U||0;for(var q=0;q<16;++q)B[U+q]=G[q];return B}return esm_browser_stringify(G)};"undefined"!=typeof process&&!!process.version&&!!process.versions&&process.versions.node;function stripResponse(O){var B={};return B.body=O.bodyAsText,B.headers=O.headers,B.status=O.status,B}function stripRequest(O){var B=O.clone();return B.headers&&B.headers.remove("authorization"),B}function generateUuid(){return esm_browser_v4()}function delay(O,B){return new Promise((function(U){return setTimeout((function(){return U(B)}),O)}))}var yr=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function replaceAll(O,B,U){return O&&B?O.split(B).join(U||""):O}var _r=function(){function Serializer(O,B){void 0===O&&(O={}),this.modelMappers=O,this.isXML=B}return Serializer.prototype.validateConstraints=function(O,B,U){var failValidation=function(O,G){throw new Error('"'+U+'" with value "'+B+'" should satisfy the constraint "'+O+'": '+G+".")};if(O.constraints&&null!=B){var G=O.constraints,q=G.ExclusiveMaximum,j=G.ExclusiveMinimum,W=G.InclusiveMaximum,Y=G.InclusiveMinimum,K=G.MaxItems,Q=G.MaxLength,Z=G.MinItems,X=G.MinLength,J=G.MultipleOf,ee=G.Pattern,te=G.UniqueItems;if(null!=q&&B>=q&&failValidation("ExclusiveMaximum",q),null!=j&&B<=j&&failValidation("ExclusiveMinimum",j),null!=W&&B>W&&failValidation("InclusiveMaximum",W),null!=Y&&B<Y&&failValidation("InclusiveMinimum",Y),null!=K&&B.length>K&&failValidation("MaxItems",K),null!=Q&&B.length>Q&&failValidation("MaxLength",Q),null!=Z&&B.length<Z&&failValidation("MinItems",Z),null!=X&&B.length<X&&failValidation("MinLength",X),null!=J&&B%J!=0&&failValidation("MultipleOf",J),ee){var ie="string"==typeof ee?new RegExp(ee):ee;"string"==typeof B&&null!==B.match(ie)||failValidation("Pattern",ee)}te&&B.some((function(O,B,U){return U.indexOf(O)!==B}))&&failValidation("UniqueItems",te)}},Serializer.prototype.serialize=function(O,B,U){var G={},q=O.type.name;U||(U=O.serializedName),null!==q.match(/^Sequence$/gi)&&(G=[]),O.isConstant&&(B=O.defaultValue);var j=O.required,W=O.nullable;if(j&&W&&void 0===B)throw new Error(U+" cannot be undefined.");if(j&&!W&&null==B)throw new Error(U+" cannot be null or undefined.");if(!j&&!1===W&&null===B)throw new Error(U+" cannot be null.");if(null==B)G=B;else if(this.validateConstraints(O,B,U),null!==q.match(/^any$/gi))G=B;else if(null!==q.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/gi))G=function(O,B,U){if(null!=U)if(null!==O.match(/^Number$/gi)){if("number"!=typeof U)throw new Error(B+" with value "+U+" must be of type number.")}else if(null!==O.match(/^String$/gi)){if("string"!=typeof U.valueOf())throw new Error(B+' with value "'+U+'" must be of type string.')}else if(null!==O.match(/^Uuid$/gi)){if("string"!=typeof U.valueOf()||(q=U,!new RegExp("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","ig").test(q)))throw new Error(B+' with value "'+U+'" must be of type string and a valid uuid.')}else if(null!==O.match(/^Boolean$/gi)){if("boolean"!=typeof U)throw new Error(B+" with value "+U+" must be of type boolean.")}else if(null!==O.match(/^Stream$/gi)){var G=typeof U;if(!("string"===G||"function"===G||U instanceof ArrayBuffer||ArrayBuffer.isView(U)||"function"==typeof Blob&&U instanceof Blob))throw new Error(B+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}var q;return U}(q,U,B);else if(null!==q.match(/^Enum$/gi)){G=function(O,B,U){if(!B)throw new Error("Please provide a set of allowedValues to validate "+O+" as an Enum Type.");if(!B.some((function(O){return"string"==typeof O.valueOf()?O.toLowerCase()===U.toLowerCase():O===U})))throw new Error(U+" is not a valid value for "+O+". The valid values are: "+JSON.stringify(B)+".");return U}(U,O.type.allowedValues,B)}else null!==q.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/gi)?G=function(O,B,U){if(null!=B)if(null!==O.match(/^Date$/gi)){if(!(B instanceof Date||"string"==typeof B.valueOf()&&!isNaN(Date.parse(B))))throw new Error(U+" must be an instanceof Date or a string in ISO8601 format.");B=B instanceof Date?B.toISOString().substring(0,10):new Date(B).toISOString().substring(0,10)}else if(null!==O.match(/^DateTime$/gi)){if(!(B instanceof Date||"string"==typeof B.valueOf()&&!isNaN(Date.parse(B))))throw new Error(U+" must be an instanceof Date or a string in ISO8601 format.");B=B instanceof Date?B.toISOString():new Date(B).toISOString()}else if(null!==O.match(/^DateTimeRfc1123$/gi)){if(!(B instanceof Date||"string"==typeof B.valueOf()&&!isNaN(Date.parse(B))))throw new Error(U+" must be an instanceof Date or a string in RFC-1123 format.");B=B instanceof Date?B.toUTCString():new Date(B).toUTCString()}else if(null!==O.match(/^UnixTime$/gi)){if(!(B instanceof Date||"string"==typeof B.valueOf()&&!isNaN(Date.parse(B))))throw new Error(U+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");B=function(O){if(!O)return;"string"==typeof O.valueOf()&&(O=new Date(O));return Math.floor(O.getTime()/1e3)}(B)}else if(null!==O.match(/^TimeSpan$/gi)&&!function(O){return yr.test(O)}(B))throw new Error(U+' must be a string in ISO 8601 format. Instead was "'+B+'".');return B}(q,B,U):null!==q.match(/^ByteArray$/gi)?G=function(O,B){if(null!=B){if(!(B instanceof Uint8Array))throw new Error(O+" must be of type Uint8Array.");B=encodeByteArray(B)}return B}(U,B):null!==q.match(/^Base64Url$/gi)?G=function(O,B){if(null!=B){if(!(B instanceof Uint8Array))throw new Error(O+" must be of type Uint8Array.");B=function(O){if(!O)return;if(!(O instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(O,B){var U=O.length;for(;U-1>=0&&O[U-1]===B;)--U;return O.substr(0,U)}(encodeByteArray(O),"=").replace(/\+/g,"-").replace(/\//g,"_")}(B)}return B}(U,B):null!==q.match(/^Sequence$/gi)?G=function(O,B,U,G){if(!Array.isArray(U))throw new Error(G+" must be of type Array.");var q=B.type.element;if(!q||"object"!=typeof q)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+G+".");for(var j=[],W=0;W<U.length;W++)j[W]=O.serialize(q,U[W],G);return j}(this,O,B,U):null!==q.match(/^Dictionary$/gi)?G=function(O,B,U,G){if("object"!=typeof U)throw new Error(G+" must be of type object.");var q=B.type.value;if(!q||"object"!=typeof q)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+G+".");for(var j={},W=0,Y=Object.keys(U);W<Y.length;W++){var K=Y[W];j[K]=O.serialize(q,U[K],G+"."+K)}return j}(this,O,B,U):null!==q.match(/^Composite$/gi)&&(G=function(O,B,U,G){var q;getPolymorphicDiscriminatorRecursively(O,B)&&(B=getPolymorphicMapper(O,B,U,"clientName"));if(null!=U){for(var j={},W=resolveModelProperties(O,B,G),Y=0,K=Object.keys(W);Y<K.length;Y++){var Q=K[Y],Z=W[Q];if(!Z.readOnly){var X=void 0,J=j;if(O.isXML)X=Z.xmlIsWrapped?Z.xmlName:Z.xmlElementName||Z.xmlName;else{var ee=splitSerializeName(Z.serializedName);X=ee.pop();for(var te=0,ie=ee;te<ie.length;te++){var re=ie[te];null==J[re]&&null!=U[Q]&&(J[re]={}),J=J[re]}}if(null!=J){var ne=""!==Z.serializedName?G+"."+Z.serializedName:G,oe=U[Q],ae=getPolymorphicDiscriminatorRecursively(O,B);ae&&ae.clientName===Q&&null==oe&&(oe=B.serializedName);var se=O.serialize(Z,oe,ne);void 0!==se&&null!=X&&(Z.xmlIsAttribute?(J.$=J.$||{},J.$[X]=se):Z.xmlIsWrapped?J[X]=((q={})[Z.xmlElementName]=se,q):J[X]=se)}}}var le=B.type.additionalProperties;if(le){var ce=Object.keys(W),_loop_1=function(B){ce.every((function(O){return O!==B}))&&(j[B]=O.serialize(le,U[B],G+'["'+B+'"]'))};for(var de in U)_loop_1(de)}return j}return U}(this,O,B,U));return G},Serializer.prototype.deserialize=function(O,B,U){if(null==B)return this.isXML&&"Sequence"===O.type.name&&!O.xmlIsWrapped&&(B=[]),void 0!==O.defaultValue&&(B=O.defaultValue),B;var G,q=O.type.name;return U||(U=O.serializedName),null!==q.match(/^Composite$/gi)?G=function(O,B,U,G){getPolymorphicDiscriminatorRecursively(O,B)&&(B=getPolymorphicMapper(O,B,U,"serializedName"));for(var q=resolveModelProperties(O,B,G),j={},W=[],Y=0,K=Object.keys(q);Y<K.length;Y++){var Q=K[Y],Z=q[Q],X=splitSerializeName(q[Q].serializedName);W.push(X[0]);var J=Z.serializedName,ee=Z.xmlName,te=Z.xmlElementName,ie=G;""!==J&&void 0!==J&&(ie=G+"."+J);var re=Z.headerCollectionPrefix;if(re){for(var ne={},oe=0,ae=Object.keys(U);oe<ae.length;oe++){var se=ae[oe];se.startsWith(re)&&(ne[se.substring(re.length)]=O.deserialize(Z.type.value,U[se],ie)),W.push(se)}j[Q]=ne}else if(O.isXML)if(Z.xmlIsAttribute&&U.$)j[Q]=O.deserialize(Z,U.$[ee],ie);else{var le=U[te||ee||J];if(Z.xmlIsWrapped)void 0===(le=(le=U[ee])&&le[te])&&(le=[]);j[Q]=O.deserialize(Z,le,ie)}else{for(var ce=void 0,de=U,pe=0,ue=X;pe<ue.length;pe++){var he=ue[pe];if(!de)break;de=de[he]}ce=de;var me=B.type.polymorphicDiscriminator;me&&Q===me.clientName&&null==ce&&(ce=B.serializedName);var ge=void 0;if(Array.isArray(U[Q])&&""===q[Q].serializedName){ce=U[Q];for(var fe=O.deserialize(Z,ce,ie),ye=0,_e=Object.entries(j);ye<_e.length;ye++){var ve=_e[ye],be=ve[0],Se=ve[1];fe.hasOwnProperty(be)||(fe[be]=Se)}j=fe}else void 0===ce&&void 0===Z.defaultValue||(ge=O.deserialize(Z,ce,ie),j[Q]=ge)}}var Ce=B.type.additionalProperties;if(Ce){var isAdditionalProperty=function(O){for(var B in q){if(splitSerializeName(q[B].serializedName)[0]===O)return!1}return!0};for(var Ee in U)isAdditionalProperty(Ee)&&(j[Ee]=O.deserialize(Ce,U[Ee],G+'["'+Ee+'"]'))}else if(U)for(var xe=0,Te=Object.keys(U);xe<Te.length;xe++){void 0!==j[Q=Te[xe]]||W.includes(Q)||isSpecialXmlProperty(Q)||(j[Q]=U[Q])}return j}(this,O,B,U):(this.isXML&&null!=B.$&&null!=B._&&(B=B._),null!==q.match(/^Number$/gi)?(G=parseFloat(B),isNaN(G)&&(G=B)):null!==q.match(/^Boolean$/gi)?G="true"===B||"false"!==B&&B:null!==q.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/gi)?G=B:null!==q.match(/^(Date|DateTime|DateTimeRfc1123)$/gi)?G=new Date(B):null!==q.match(/^UnixTime$/gi)?G=function(O){if(!O)return;return new Date(1e3*O)}(B):null!==q.match(/^ByteArray$/gi)?G=decodeString(B):null!==q.match(/^Base64Url$/gi)?G=function(O){if(!O)return;if(O&&"string"!=typeof O.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return decodeString(O=O.replace(/\-/g,"+").replace(/\_/g,"/"))}(B):null!==q.match(/^Sequence$/gi)?G=function(O,B,U,G){var q=B.type.element;if(!q||"object"!=typeof q)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+G);if(U){Array.isArray(U)||(U=[U]);for(var j=[],W=0;W<U.length;W++)j[W]=O.deserialize(q,U[W],G+"["+W+"]");return j}return U}(this,O,B,U):null!==q.match(/^Dictionary$/gi)&&(G=function(O,B,U,G){var q=B.type.value;if(!q||"object"!=typeof q)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+G);if(U){for(var j={},W=0,Y=Object.keys(U);W<Y.length;W++){var K=Y[W];j[K]=O.deserialize(q,U[K],G)}return j}return U}(this,O,B,U))),O.isConstant&&(G=O.defaultValue),G},Serializer}();function splitSerializeName(O){var B=[],U="";if(O)for(var G=0,q=O.split(".");G<q.length;G++){var j=q[G];"\\"===j.charAt(j.length-1)?U+=j.substr(0,j.length-1)+".":(U+=j,B.push(U),U="")}return B}function resolveModelProperties(O,B,U){var G=B.type.modelProperties;if(!G){var q=B.type.className;if(!q)throw new Error('Class name for model "'+U+'" is not provided in the mapper "'+JSON.stringify(B,void 0,2)+'".');var j=O.modelMappers[q];if(!j)throw new Error('mapper() cannot be null or undefined for model "'+q+'".');if(!(G=j.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(j)+'" of type "'+q+'" for object "'+U+'".')}return G}function isSpecialXmlProperty(O){return["$","_"].includes(O)}function getPolymorphicMapper(O,B,U,G){var q=getPolymorphicDiscriminatorRecursively(O,B);if(q){var j=q[G];if(null!=j){var W=U[j];if(null!=W){var Y=B.type.uberParent||B.type.className,K=W===Y?W:Y+"."+W,Q=O.modelMappers.discriminators[K];Q&&(B=Q)}}}return B}function getPolymorphicDiscriminatorRecursively(O,B){return B.type.polymorphicDiscriminator||getPolymorphicDiscriminatorSafely(O,B.type.uberParent)||getPolymorphicDiscriminatorSafely(O,B.type.className)}function getPolymorphicDiscriminatorSafely(O,B){return B&&O.modelMappers[B]&&O.modelMappers[B].type.polymorphicDiscriminator}var vr=function(O){for(var B={},U=0,G=O;U<G.length;U++){var q=G[U];B[q]=q}return B}(["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"]);function isStreamOperation(O){var B=!1;for(var U in O.responses){var G=O.responses[U];if(G.bodyMapper&&G.bodyMapper.type.name===vr.Stream){B=!0;break}}return B}var br,Sr,Cr,Er=function(O){function RestError(B,U,G,q,j,W){var Y=O.call(this,B)||this;return Y.code=U,Y.statusCode=G,Y.request=q,Y.response=j,Y.body=W,Object.setPrototypeOf(Y,RestError.prototype),Y}return tslib_es6_extends(RestError,O),RestError.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",RestError.REQUEST_ABORTED_ERROR="REQUEST_ABORTED_ERROR",RestError.PARSE_ERROR="PARSE_ERROR",RestError}(Error),xr=new DOMParser;function parseXML(O){var B;try{var U=xr.parseFromString(null!==(B=null==Cr?void 0:Cr.createHTML(O))&&void 0!==B?B:O,"application/xml");(function(O){if(Tr){var B=O.getElementsByTagNameNS(Tr,"parsererror");if(B.length)throw new Error(B.item(0).innerHTML)}})(U);var G=domToObject(U.childNodes[0]);return Promise.resolve(G)}catch(O){return Promise.reject(O)}}void 0!==self.trustedTypes&&(Cr=self.trustedTypes.createPolicy("@azure/ms-rest-js#xml.browser",{createHTML:function(O){return O}}));var Tr="";try{var wr=null!==(br=null==Cr?void 0:Cr.createHTML("INVALID"))&&void 0!==br?br:"INVALID";Tr=null!==(Sr=xr.parseFromString(wr,"text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==Sr?Sr:""}catch(O){}function domToObject(O){var B={},U=O.childNodes.length,G=O.childNodes[0],q=G&&1===U&&G.nodeType===Node.TEXT_NODE&&G.nodeValue||void 0,j=function(O){return function(O){return!!O.attributes}(O)&&O.hasAttributes()?O:void 0}(O);if(j){B.$={};for(var W=0;W<j.attributes.length;W++){var Y=j.attributes[W];B.$[Y.nodeName]=Y.nodeValue}q&&(B._=q)}else 0===U?B="":q&&(B=q);if(!q)for(W=0;W<U;W++){var K=O.childNodes[W];if(K.nodeType!==Node.TEXT_NODE){var Q=domToObject(K);B[K.nodeName]?Array.isArray(B[K.nodeName])?B[K.nodeName].push(Q):B[K.nodeName]=[B[K.nodeName],Q]:B[K.nodeName]=Q}}return B}var kr,Ar=document.implementation.createDocument(null,null,null),Rr=new XMLSerializer;function stringifyXML(O,B){var U=buildNode(O,B&&B.rootName||"root")[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+Rr.serializeToString(U)}function buildAttributes(O){for(var B=[],U=0,G=Object.keys(O);U<G.length;U++){var q=G[U],j=Ar.createAttribute(q);j.value=O[q].toString(),B.push(j)}return B}function buildNode(O,B){if("string"==typeof O||"number"==typeof O||"boolean"==typeof O)return(K=Ar.createElement(B)).textContent=O.toString(),[K];if(Array.isArray(O)){for(var U=[],G=0,q=O;G<q.length;G++)for(var j=0,W=buildNode(q[G],B);j<W.length;j++){var Y=W[j];U.push(Y)}return U}if("object"==typeof O){for(var K=Ar.createElement(B),Q=0,Z=Object.keys(O);Q<Z.length;Q++){var X=Z[Q];if("$"===X)for(var J=0,ee=buildAttributes(O[X]);J<ee.length;J++){var te=ee[J];K.attributes.setNamedItem(te)}else for(var ie=0,re=buildNode(O[X],X);ie<re.length;ie++){Y=re[ie];K.appendChild(Y)}}return[K]}throw new Error("Illegal value passed to buildObject: "+O)}(function(O){O[O.OFF=0]="OFF",O[O.ERROR=1]="ERROR",O[O.WARNING=2]="WARNING",O[O.INFO=3]="INFO"})(kr||(kr={}));var Ir=function(){function BaseRequestPolicy(O,B){this._nextPolicy=O,this._options=B}return BaseRequestPolicy.prototype.shouldLog=function(O){return this._options.shouldLog(O)},BaseRequestPolicy.prototype.log=function(O,B){this._options.log(O,B)},BaseRequestPolicy}(),Pr=function(){function RequestPolicyOptions(O){this._logger=O}return RequestPolicyOptions.prototype.shouldLog=function(O){return!!this._logger&&O!==kr.OFF&&O<=this._logger.minimumLogLevel},RequestPolicyOptions.prototype.log=function(O,B){this._logger&&this.shouldLog(O)&&this._logger.log(O,B)},RequestPolicyOptions}();function deserializationPolicy(O){return{create:function(B,U){return new Mr(B,O,U)}}}var Nr=["application/json","text/json"],Or=["application/xml","application/atom+xml"],Mr=function(O){function DeserializationPolicy(B,U,G){var q=O.call(this,B,G)||this;return q.jsonContentTypes=U&&U.json||Nr,q.xmlContentTypes=U&&U.xml||Or,q}return tslib_es6_extends(DeserializationPolicy,O),DeserializationPolicy.prototype.sendRequest=function(O){return tslib_es6_awaiter(this,void 0,void 0,(function(){var B=this;return tslib_es6_generator(this,(function(U){return[2,this._nextPolicy.sendRequest(O).then((function(O){return function(O,B,U){return function(O,B,U){var errorHandler=function(O){var B='Error "'+O+'" occurred while parsing the response body - '+U.bodyAsText+".",G=O.code||Er.PARSE_ERROR,q=new Er(B,G,U.status,U.request,U,U.bodyAsText);return Promise.reject(q)};if(!U.request.streamResponseBody&&U.bodyAsText){var G=U.bodyAsText,q=U.headers.get("Content-Type")||"",j=q?q.split(";").map((function(O){return O.toLowerCase()})):[];if(0===j.length||j.some((function(B){return-1!==O.indexOf(B)})))return new Promise((function(O){U.parsedBody=JSON.parse(G),O(U)})).catch(errorHandler);if(j.some((function(O){return-1!==B.indexOf(O)})))return parseXML(G).then((function(O){return U.parsedBody=O,U})).catch(errorHandler)}return Promise.resolve(U)}(O,B,U).then((function(O){var B=function(O){var B,U=O.request.shouldDeserialize;B=void 0===U||("boolean"==typeof U?U:U(O));return B}(O);if(B){var G=O.request.operationSpec;if(G&&G.responses){var q=O.status,j=Object.keys(G.responses),W=0===j.length||1===j.length&&"default"===j[0],Y=function(O){var B,U=O.request,G=U.operationSpec;if(G){var q=U.operationResponseGetter;B=q?q(G,O):G.responses[O.status]}return B}(O);if(W?200<=q&&q<300:!!Y){if(Y){if(Y.bodyMapper){ie=O.parsedBody;G.isXML&&Y.bodyMapper.type.name===vr.Sequence&&(ie="object"==typeof ie?ie[Y.bodyMapper.xmlElementName]:[]);try{O.parsedBody=G.serializer.deserialize(Y.bodyMapper,ie,"operationRes.parsedBody")}catch(X){var K=new Er("Error "+X+" occurred in deserializing the responseBody - "+O.bodyAsText);return K.request=stripRequest(O.request),K.response=stripResponse(O),Promise.reject(K)}}else"HEAD"===G.httpMethod&&(O.parsedBody=U.status>=200&&U.status<300);Y.headersMapper&&(O.parsedHeaders=G.serializer.deserialize(Y.headersMapper,O.headers.rawHeaders(),"operationRes.parsedHeaders"))}}else{var Q=G.responses.default;if(Q){var Z=isStreamOperation(G)?"Unexpected status code: "+q:O.bodyAsText,X=new Er(Z);X.statusCode=q,X.request=stripRequest(O.request),X.response=stripResponse(O);var J=O.parsedBody;try{if(J){var ee=Q.bodyMapper;if(ee&&"CloudError"===ee.serializedName)J.error&&(J=J.error),J.code&&(X.code=J.code),J.message&&(X.message=J.message);else{var te=J;J.error&&(te=J.error),X.code=te.code,te.message&&(X.message=te.message)}if(ee){var ie=J;G.isXML&&ee.type.name===vr.Sequence&&(ie="object"==typeof J?J[ee.xmlElementName]:[]),X.body=G.serializer.deserialize(ee,ie,"error.body")}}}catch(B){X.message='Error "'+B.message+'" occurred in deserializing the responseBody - "'+O.bodyAsText+'" for the default response.'}return Promise.reject(X)}}}}return Promise.resolve(O)}))}(B.jsonContentTypes,B.xmlContentTypes,O)}))]}))}))},DeserializationPolicy}(Ir);class EmptyServiceClientCredentials{signRequest(O){return Promise.resolve(O)}}class ProteusRuntimeTokenPolicy{constructor(O){this.token=O,this.name="proteusRuntimeTokenPolicy"}async sendRequest(O,B){const U=new URL(O.url);return U.searchParams.set("s",this.token),O.url=U.href,B(O)}}class ProteusRuntimeTokenPolicyMsRestJs_ProteusRuntimeTokenPolicy extends Ir{constructor(O,B,U){super(O,B),this.token=U}sendRequest(O){const B=new URL(O.url);return B.searchParams.set("s",this.token),O.url=B.href,this._nextPolicy.sendRequest(O)}}var Dr,Lr={serializedName:"QueryContext",type:{name:"Composite",className:"QueryContext",modelProperties:{originalQuery:{required:!0,serializedName:"originalQuery",type:{name:"String"}},alteredQuery:{readOnly:!0,serializedName:"alteredQuery",type:{name:"String"}},alterationOverrideQuery:{readOnly:!0,serializedName:"alterationOverrideQuery",type:{name:"String"}},adultIntent:{readOnly:!0,serializedName:"adultIntent",type:{name:"Boolean"}},askUserForLocation:{readOnly:!0,serializedName:"askUserForLocation",type:{name:"Boolean"}},isTransactional:{readOnly:!0,serializedName:"isTransactional",type:{name:"Boolean"}}}}},Br={serializedName:"Web/MetaTag",type:{name:"Composite",className:"WebMetaTag",modelProperties:{name:{readOnly:!0,serializedName:"name",type:{name:"String"}},content:{readOnly:!0,serializedName:"content",type:{name:"String"}}}}},Fr={serializedName:"ResponseBase",type:{name:"Composite",polymorphicDiscriminator:{serializedName:"_type",clientName:"_type"},uberParent:"ResponseBase",className:"ResponseBase",modelProperties:{_type:{required:!0,serializedName:"_type",type:{name:"String"}}}}},zr={serializedName:"Identifiable",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Identifiable",modelProperties:tslib_es6_assign(tslib_es6_assign({},Fr.type.modelProperties),{id:{readOnly:!0,serializedName:"id",type:{name:"String"}}})}},$r={serializedName:"Response",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Response",modelProperties:tslib_es6_assign(tslib_es6_assign({},zr.type.modelProperties),{webSearchUrl:{readOnly:!0,serializedName:"webSearchUrl",type:{name:"String"}}})}},Ur={serializedName:"Thing",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Thing",modelProperties:tslib_es6_assign(tslib_es6_assign({},$r.type.modelProperties),{name:{readOnly:!0,serializedName:"name",type:{name:"String"}},url:{readOnly:!0,serializedName:"url",type:{name:"String"}},image:{readOnly:!0,serializedName:"image",type:{name:"Composite",className:"ImageObject"}},description:{readOnly:!0,serializedName:"description",type:{name:"String"}},bingId:{readOnly:!0,serializedName:"bingId",type:{name:"String"}}})}},Vr={serializedName:"CreativeWork",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"CreativeWork",modelProperties:tslib_es6_assign(tslib_es6_assign({},Ur.type.modelProperties),{thumbnailUrl:{readOnly:!0,serializedName:"thumbnailUrl",type:{name:"String"}},provider:{readOnly:!0,serializedName:"provider",type:{name:"Sequence",element:{type:{name:"Composite",className:"Thing"}}}},text:{readOnly:!0,serializedName:"text",type:{name:"String"}}})}},Gr={serializedName:"MediaObject",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"MediaObject",modelProperties:tslib_es6_assign(tslib_es6_assign({},Vr.type.modelProperties),{contentUrl:{readOnly:!0,serializedName:"contentUrl",type:{name:"String"}},hostPageUrl:{readOnly:!0,serializedName:"hostPageUrl",type:{name:"String"}},width:{readOnly:!0,serializedName:"width",type:{name:"Number"}},height:{readOnly:!0,serializedName:"height",type:{name:"Number"}}})}},Hr={serializedName:"ImageObject",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"ImageObject",modelProperties:tslib_es6_assign(tslib_es6_assign({},Gr.type.modelProperties),{thumbnail:{readOnly:!0,serializedName:"thumbnail",type:{name:"Composite",className:"ImageObject"}}})}},qr={serializedName:"WebPage",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"WebPage",modelProperties:tslib_es6_assign(tslib_es6_assign({},Vr.type.modelProperties),{displayUrl:{readOnly:!0,serializedName:"displayUrl",type:{name:"String"}},snippet:{readOnly:!0,serializedName:"snippet",type:{name:"String"}},deepLinks:{readOnly:!0,serializedName:"deepLinks",type:{name:"Sequence",element:{type:{name:"Composite",className:"WebPage"}}}},dateLastCrawled:{readOnly:!0,serializedName:"dateLastCrawled",type:{name:"String"}},searchTags:{readOnly:!0,serializedName:"searchTags",type:{name:"Sequence",element:{type:{name:"Composite",className:"WebMetaTag"}}}},primaryImageOfPage:{readOnly:!0,serializedName:"primaryImageOfPage",type:{name:"Composite",className:"ImageObject"}}})}},jr={serializedName:"Answer",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Answer",modelProperties:tslib_es6_assign(tslib_es6_assign({},$r.type.modelProperties),{followUpQueries:{readOnly:!0,serializedName:"followUpQueries",type:{name:"Sequence",element:{type:{name:"Composite",className:"Query"}}}}})}},Wr={serializedName:"SearchResultsAnswer",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"SearchResultsAnswer",modelProperties:tslib_es6_assign(tslib_es6_assign({},jr.type.modelProperties),{queryContext:{readOnly:!0,serializedName:"queryContext",type:{name:"Composite",className:"QueryContext"}},totalEstimatedMatches:{readOnly:!0,serializedName:"totalEstimatedMatches",type:{name:"Number"}},isFamilyFriendly:{readOnly:!0,serializedName:"isFamilyFriendly",type:{name:"Boolean"}}})}},Yr={serializedName:"Web/WebAnswer",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"WebWebAnswer",modelProperties:tslib_es6_assign(tslib_es6_assign({},Wr.type.modelProperties),{value:{required:!0,serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"WebPage"}}}},someResultsRemoved:{readOnly:!0,serializedName:"someResultsRemoved",type:{name:"Boolean"}}})}},Kr={serializedName:"Query",type:{name:"Composite",className:"Query",modelProperties:{text:{required:!0,serializedName:"text",type:{name:"String"}},displayText:{readOnly:!0,serializedName:"displayText",type:{name:"String"}},webSearchUrl:{readOnly:!0,serializedName:"webSearchUrl",type:{name:"String"}},searchLink:{readOnly:!0,serializedName:"searchLink",type:{name:"String"}},thumbnail:{readOnly:!0,serializedName:"thumbnail",type:{name:"Composite",className:"ImageObject"}}}}},Qr={serializedName:"Images",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Images",modelProperties:tslib_es6_assign(tslib_es6_assign({},Wr.type.modelProperties),{nextOffset:{readOnly:!0,serializedName:"nextOffset",type:{name:"Number"}},value:{required:!0,serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"ImageObject"}}}},queryExpansions:{readOnly:!0,serializedName:"queryExpansions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Query"}}}},similarTerms:{readOnly:!0,serializedName:"similarTerms",type:{name:"Sequence",element:{type:{name:"Composite",className:"Query"}}}},relatedSearches:{readOnly:!0,serializedName:"relatedSearches",type:{name:"Sequence",element:{type:{name:"Composite",className:"Query"}}}}})}},Zr={serializedName:"Article",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Article",modelProperties:tslib_es6_assign(tslib_es6_assign({},Vr.type.modelProperties),{wordCount:{readOnly:!0,serializedName:"wordCount",type:{name:"Number"}}})}},Xr={serializedName:"NewsArticle",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"NewsArticle",modelProperties:tslib_es6_assign({},Zr.type.modelProperties)}},Jr={serializedName:"News",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"News",modelProperties:tslib_es6_assign(tslib_es6_assign({},Wr.type.modelProperties),{value:{required:!0,serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"NewsArticle"}}}},location:{readOnly:!0,serializedName:"location",type:{name:"String"}}})}},en={serializedName:"RelatedSearches/RelatedSearchAnswer",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"RelatedSearchesRelatedSearchAnswer",modelProperties:tslib_es6_assign(tslib_es6_assign({},Wr.type.modelProperties),{value:{required:!0,serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Query"}}}}})}},tn={serializedName:"SpellSuggestions",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"SpellSuggestions",modelProperties:tslib_es6_assign(tslib_es6_assign({},Wr.type.modelProperties),{value:{required:!0,serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Query"}}}}})}},rn={serializedName:"TimeZone/TimeZoneInformation",type:{name:"Composite",className:"TimeZoneTimeZoneInformation",modelProperties:{location:{required:!0,serializedName:"location",type:{name:"String"}},time:{required:!0,serializedName:"time",type:{name:"String"}},utcOffset:{required:!0,serializedName:"utcOffset",type:{name:"String"}}}}},nn={serializedName:"TimeZone",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"TimeZone",modelProperties:tslib_es6_assign(tslib_es6_assign({},Wr.type.modelProperties),{primaryCityTime:{required:!0,serializedName:"primaryCityTime",type:{name:"Composite",className:"TimeZoneTimeZoneInformation"}},otherCityTimes:{readOnly:!0,serializedName:"otherCityTimes",type:{name:"Sequence",element:{type:{name:"Composite",className:"TimeZoneTimeZoneInformation"}}}}})}},on={serializedName:"VideoObject",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"VideoObject",modelProperties:tslib_es6_assign(tslib_es6_assign({},Gr.type.modelProperties),{motionThumbnailUrl:{readOnly:!0,serializedName:"motionThumbnailUrl",type:{name:"String"}},motionThumbnailId:{readOnly:!0,serializedName:"motionThumbnailId",type:{name:"String"}},embedHtml:{readOnly:!0,serializedName:"embedHtml",type:{name:"String"}},allowHttpsEmbed:{readOnly:!0,serializedName:"allowHttpsEmbed",type:{name:"Boolean"}},viewCount:{readOnly:!0,serializedName:"viewCount",type:{name:"Number"}},thumbnail:{readOnly:!0,serializedName:"thumbnail",type:{name:"Composite",className:"ImageObject"}},videoId:{readOnly:!0,serializedName:"videoId",type:{name:"String"}},allowMobileEmbed:{readOnly:!0,serializedName:"allowMobileEmbed",type:{name:"Boolean"}},isSuperfresh:{readOnly:!0,serializedName:"isSuperfresh",type:{name:"Boolean"}}})}},an={serializedName:"Videos",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Videos",modelProperties:tslib_es6_assign(tslib_es6_assign({},Wr.type.modelProperties),{value:{required:!0,serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"VideoObject"}}}},nextOffset:{readOnly:!0,serializedName:"nextOffset",type:{name:"Number"}},queryExpansions:{readOnly:!0,serializedName:"queryExpansions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Query"}}}},relatedSearches:{readOnly:!0,serializedName:"relatedSearches",type:{name:"Sequence",element:{type:{name:"Composite",className:"Query"}}}}})}},sn={serializedName:"Computation",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Computation",modelProperties:tslib_es6_assign(tslib_es6_assign({},jr.type.modelProperties),{expression:{required:!0,serializedName:"expression",type:{name:"String"}},value:{required:!0,serializedName:"value",type:{name:"String"}}})}},ln={serializedName:"Ranking/RankingItem",type:{name:"Composite",className:"RankingRankingItem",modelProperties:{answerType:{required:!0,serializedName:"answerType",defaultValue:"WebPages",type:{name:"String"}},resultIndex:{readOnly:!0,serializedName:"resultIndex",type:{name:"Number"}},value:{readOnly:!0,serializedName:"value",type:{name:"Composite",className:"Identifiable"}},htmlIndex:{readOnly:!0,serializedName:"htmlIndex",type:{name:"Number"}},textualIndex:{readOnly:!0,serializedName:"textualIndex",type:{name:"Number"}},screenshotIndex:{readOnly:!0,serializedName:"screenshotIndex",type:{name:"Number"}}}}},cn={serializedName:"Ranking/RankingGroup",type:{name:"Composite",className:"RankingRankingGroup",modelProperties:{items:{required:!0,serializedName:"items",type:{name:"Sequence",element:{type:{name:"Composite",className:"RankingRankingItem"}}}}}}},dn={serializedName:"Ranking/RankingResponse",type:{name:"Composite",className:"RankingRankingResponse",modelProperties:{pole:{readOnly:!0,serializedName:"pole",type:{name:"Composite",className:"RankingRankingGroup"}},mainline:{readOnly:!0,serializedName:"mainline",type:{name:"Composite",className:"RankingRankingGroup"}},sidebar:{readOnly:!0,serializedName:"sidebar",type:{name:"Composite",className:"RankingRankingGroup"}}}}},pn={serializedName:"SearchResponse",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"SearchResponse",modelProperties:tslib_es6_assign(tslib_es6_assign({},$r.type.modelProperties),{queryContext:{readOnly:!0,serializedName:"queryContext",type:{name:"Composite",className:"QueryContext"}},webPages:{readOnly:!0,serializedName:"webPages",type:{name:"Composite",className:"WebWebAnswer"}},images:{readOnly:!0,serializedName:"images",type:{name:"Composite",className:"Images"}},news:{readOnly:!0,serializedName:"news",type:{name:"Composite",className:"News"}},relatedSearches:{readOnly:!0,serializedName:"relatedSearches",type:{name:"Composite",className:"RelatedSearchesRelatedSearchAnswer"}},spellSuggestions:{readOnly:!0,serializedName:"spellSuggestions",type:{name:"Composite",className:"SpellSuggestions"}},timeZone:{readOnly:!0,serializedName:"timeZone",type:{name:"Composite",className:"TimeZone"}},videos:{readOnly:!0,serializedName:"videos",type:{name:"Composite",className:"Videos"}},computation:{readOnly:!0,serializedName:"computation",type:{name:"Composite",className:"Computation"}},rankingResponse:{readOnly:!0,serializedName:"rankingResponse",type:{name:"Composite",className:"RankingRankingResponse"}}})}},un={serializedName:"Places",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Places",modelProperties:tslib_es6_assign(tslib_es6_assign({},Wr.type.modelProperties),{value:{required:!0,serializedName:"value",type:{name:"Sequence",element:{type:{name:"Composite",className:"Thing"}}}}})}},hn={serializedName:"Error",type:{name:"Composite",className:"ErrorModel",modelProperties:{code:{required:!0,serializedName:"code",defaultValue:"None",type:{name:"String"}},subCode:{readOnly:!0,serializedName:"subCode",type:{name:"String"}},message:{required:!0,serializedName:"message",type:{name:"String"}},moreDetails:{readOnly:!0,serializedName:"moreDetails",type:{name:"String"}},parameter:{readOnly:!0,serializedName:"parameter",type:{name:"String"}},value:{readOnly:!0,serializedName:"value",type:{name:"String"}}}}},mn={serializedName:"ErrorResponse",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"ErrorResponse",modelProperties:tslib_es6_assign(tslib_es6_assign({},$r.type.modelProperties),{errors:{required:!0,serializedName:"errors",type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorModel"}}}}})}},gn={serializedName:"Intangible",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"Intangible",modelProperties:tslib_es6_assign({},Ur.type.modelProperties)}},yn={serializedName:"StructuredValue",type:{name:"Composite",polymorphicDiscriminator:Fr.type.polymorphicDiscriminator,uberParent:"ResponseBase",className:"StructuredValue",modelProperties:tslib_es6_assign({},gn.type.modelProperties)}},_n={"ResponseBase.ImageObject":Hr,"ResponseBase.WebPage":qr,"ResponseBase.Web/WebAnswer":Yr,"ResponseBase.Images":Qr,"ResponseBase.NewsArticle":Xr,"ResponseBase.News":Jr,"ResponseBase.RelatedSearches/RelatedSearchAnswer":en,"ResponseBase.SpellSuggestions":tn,"ResponseBase.TimeZone":nn,"ResponseBase.VideoObject":on,"ResponseBase.Videos":an,"ResponseBase.Computation":sn,"ResponseBase.Identifiable":zr,"ResponseBase.SearchResponse":pn,"ResponseBase.Response":$r,"ResponseBase.Thing":Ur,"ResponseBase.Places":un,"ResponseBase.SearchResultsAnswer":Wr,"ResponseBase.Answer":jr,"ResponseBase.ErrorResponse":mn,"Web/WebGrouping":{serializedName:"Web/WebGrouping",type:{name:"Composite",polymorphicDiscriminator:{serializedName:"_type",clientName:"_type"},uberParent:"WebWebGrouping",className:"WebWebGrouping",modelProperties:{webPages:{required:!0,serializedName:"webPages",type:{name:"Sequence",element:{type:{name:"Composite",className:"WebPage"}}}},_type:{required:!0,serializedName:"_type",type:{name:"String"}}}}},ResponseBase:Fr,"ResponseBase.CreativeWork":Vr,"ResponseBase.Intangible":gn,"ResponseBase.MediaObject":Gr,"ResponseBase.Article":Zr,"ResponseBase.StructuredValue":yn};(function(O){O.Csv=",",O.Ssv=" ",O.Tsv="\t",O.Pipes="|",O.Multi="Multi"})(Dr||(Dr={}));var vn={parameterPath:["options","promote"],mapper:{serializedName:"promote",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:Dr.Csv},bn={parameterPath:["options","responseFilter"],mapper:{serializedName:"responseFilter",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:Dr.Csv},Sn=function(){function Web(O){this.client=O}return Web.prototype.search=function(O,B,U){return this.client.sendOperationRequest({query:O,options:B},En,U)},Web}(),Cn=new _r(G),En={httpMethod:"GET",path:"search",urlParameters:[{parameterPath:"endpoint",mapper:{required:!0,serializedName:"Endpoint",defaultValue:"https://api.cognitive.microsoft.com",type:{name:"String"}},skipEncoding:!0}],queryParameters:[{parameterPath:["options","answerCount"],mapper:{serializedName:"answerCount",type:{name:"Number"}}},{parameterPath:["options","countryCode"],mapper:{serializedName:"cc",type:{name:"String"}}},{parameterPath:["options","count"],mapper:{serializedName:"count",type:{name:"Number"}}},{parameterPath:["options","freshness"],mapper:{serializedName:"freshness",type:{name:"String"}}},{parameterPath:["options","market"],mapper:{serializedName:"mkt",defaultValue:"en-us",type:{name:"String"}}},{parameterPath:["options","offset"],mapper:{serializedName:"offset",type:{name:"Number"}}},vn,{parameterPath:"query",mapper:{required:!0,serializedName:"q",type:{name:"String"}}},bn,{parameterPath:["options","safeSearch"],mapper:{serializedName:"safeSearch",type:{name:"String"}}},{parameterPath:["options","setLang"],mapper:{serializedName:"setLang",type:{name:"String"}}},{parameterPath:["options","textDecorations"],mapper:{serializedName:"textDecorations",type:{name:"Boolean"}}},{parameterPath:["options","textFormat"],mapper:{serializedName:"textFormat",type:{name:"String"}}}],headerParameters:[{parameterPath:"xBingApisSDK",mapper:{required:!0,isConstant:!0,serializedName:"X-BingApis-SDK",defaultValue:"true",type:{name:"String"}}},{parameterPath:["options","acceptLanguage"],mapper:{serializedName:"Accept-Language",type:{name:"String"}}},{parameterPath:["options","pragma"],mapper:{serializedName:"Pragma",type:{name:"String"}}},{parameterPath:["options","userAgent"],mapper:{serializedName:"User-Agent",type:{name:"String"}}},{parameterPath:["options","clientId"],mapper:{serializedName:"X-MSEdge-ClientID",type:{name:"String"}}},{parameterPath:["options","clientIp"],mapper:{serializedName:"X-MSEdge-ClientIP",type:{name:"String"}}},{parameterPath:["options","location"],mapper:{serializedName:"X-Search-Location",type:{name:"String"}}}],responses:{200:{bodyMapper:pn},default:{bodyMapper:mn}},serializer:Cn};function getHeaderKey(O){return O.toLowerCase()}function isHttpHeadersLike(O){return!(!O||"object"!=typeof O)&&("function"==typeof O.rawHeaders&&"function"==typeof O.clone&&"function"==typeof O.get&&"function"==typeof O.set&&"function"==typeof O.contains&&"function"==typeof O.remove&&"function"==typeof O.headersArray&&"function"==typeof O.headerValues&&"function"==typeof O.headerNames&&"function"==typeof O.toJson)}var xn=function(){function HttpHeaders(O){if(this._headersMap={},O)for(var B in O)this.set(B,O[B])}return HttpHeaders.prototype.set=function(O,B){this._headersMap[getHeaderKey(O)]={name:O,value:B.toString()}},HttpHeaders.prototype.get=function(O){var B=this._headersMap[getHeaderKey(O)];return B?B.value:void 0},HttpHeaders.prototype.contains=function(O){return!!this._headersMap[getHeaderKey(O)]},HttpHeaders.prototype.remove=function(O){var B=this.contains(O);return delete this._headersMap[getHeaderKey(O)],B},HttpHeaders.prototype.rawHeaders=function(){var O={};for(var B in this._headersMap){var U=this._headersMap[B];O[U.name.toLowerCase()]=U.value}return O},HttpHeaders.prototype.headersArray=function(){var O=[];for(var B in this._headersMap)O.push(this._headersMap[B]);return O},HttpHeaders.prototype.headerNames=function(){for(var O=[],B=this.headersArray(),U=0;U<B.length;++U)O.push(B[U].name);return O},HttpHeaders.prototype.headerValues=function(){for(var O=[],B=this.headersArray(),U=0;U<B.length;++U)O.push(B[U].value);return O},HttpHeaders.prototype.toJson=function(){return this.rawHeaders()},HttpHeaders.prototype.toString=function(){return JSON.stringify(this.toJson())},HttpHeaders.prototype.clone=function(){return new HttpHeaders(this.rawHeaders())},HttpHeaders}(),Tn="2.6.2",wn={HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},kn={AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"};function getDefaultUserAgentKey(){return"x-ms-command-name"}var An=getDefaultUserAgentKey;function getDefaultUserAgentValue(){var O,B,U,G=[{key:"ms-rest-js",value:Tn}],q=function(){var O=self.navigator;return[{key:"OS",value:(O.oscpu||O.platform).replace(" ","")}]}(),j=(O=G.concat(q),void 0===B&&(B=" "),void 0===U&&(U="/"),O.map((function(O){var B=O.value?""+U+O.value:"";return""+O.key+B})).join(B));return j}var Rn=function(O){function UserAgentPolicy(B,U,G,q){var j=O.call(this,B,U)||this;return j._nextPolicy=B,j._options=U,j.headerKey=G,j.headerValue=q,j}return tslib_es6_extends(UserAgentPolicy,O),UserAgentPolicy.prototype.sendRequest=function(O){return this.addUserAgentHeader(O),this._nextPolicy.sendRequest(O)},UserAgentPolicy.prototype.addUserAgentHeader=function(O){O.headers||(O.headers=new xn),!O.headers.get(this.headerKey)&&this.headerValue&&O.headers.set(this.headerKey,this.headerValue)},UserAgentPolicy}(Ir);var In=function(){function XhrHttpClient(){}return XhrHttpClient.prototype.sendRequest=function(O){var B=new XMLHttpRequest;if(O.agentSettings)throw new Error("HTTP agent settings not supported in browser environment");if(O.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var U=O.abortSignal;if(U){var listener_1=function(){B.abort()};U.addEventListener("abort",listener_1),B.addEventListener("readystatechange",(function(){B.readyState===XMLHttpRequest.DONE&&U.removeEventListener("abort",listener_1)}))}if(addProgressListener(B.upload,O.onUploadProgress),addProgressListener(B,O.onDownloadProgress),O.formData){for(var G=O.formData,q=new FormData,appendFormValue=function(O,B){B&&B.hasOwnProperty("value")&&B.hasOwnProperty("options")?q.append(O,B.value,B.options):q.append(O,B)},j=0,W=Object.keys(G);j<W.length;j++){var Y=W[j],K=G[Y];if(Array.isArray(K))for(var Q=0;Q<K.length;Q++)appendFormValue(Y,K[Q]);else appendFormValue(Y,K)}O.body=q,O.formData=void 0;var Z=O.headers.get("Content-Type");Z&&-1!==Z.indexOf("multipart/form-data")&&O.headers.remove("Content-Type")}B.open(O.method,O.url),B.timeout=O.timeout,B.withCredentials=O.withCredentials;for(var X=0,J=O.headers.headersArray();X<J.length;X++){var ee=J[X];B.setRequestHeader(ee.name,ee.value)}return B.responseType=O.streamResponseBody?"blob":"text",B.send(void 0===O.body?null:O.body),O.streamResponseBody?new Promise((function(U,G){B.addEventListener("readystatechange",(function(){if(B.readyState===XMLHttpRequest.HEADERS_RECEIVED){var G=new Promise((function(U,G){B.addEventListener("load",(function(){U(B.response)})),rejectOnTerminalEvent(O,B,G)}));U({request:O,status:B.status,headers:parseHeaders(B),blobBody:G})}})),rejectOnTerminalEvent(O,B,G)})):new Promise((function(U,G){B.addEventListener("load",(function(){return U({request:O,status:B.status,headers:parseHeaders(B),bodyAsText:B.responseText})})),rejectOnTerminalEvent(O,B,G)}))},XhrHttpClient}();function addProgressListener(O,B){B&&O.addEventListener("progress",(function(O){return B({loadedBytes:O.loaded})}))}function parseHeaders(O){for(var B=new xn,U=0,G=O.getAllResponseHeaders().trim().split(/[\r\n]+/);U<G.length;U++){var q=G[U],j=q.indexOf(":"),W=q.slice(0,j),Y=q.slice(j+2);B.set(W,Y)}return B}function rejectOnTerminalEvent(O,B,U){B.addEventListener("error",(function(){return U(new Er("Failed to send request to "+O.url,Er.REQUEST_SEND_ERROR,void 0,O))})),B.addEventListener("abort",(function(){return U(new Er("The request was aborted",Er.REQUEST_ABORTED_ERROR,void 0,O))})),B.addEventListener("timeout",(function(){return U(new Er("timeout of "+B.timeout+"ms exceeded",Er.REQUEST_SEND_ERROR,void 0,O))}))}function getPathStringFromParameter(O){return getPathStringFromParameterPath(O.parameterPath,O.mapper)}function getPathStringFromParameterPath(O,B){return"string"==typeof O?O:Array.isArray(O)?O.join("."):B.serializedName}var Pn=function(O){function ExponentialRetryPolicy(B,U,G,q,j,W){var Y=O.call(this,B,U)||this;function isNumber(O){return"number"==typeof O}return Y.retryCount=isNumber(G)?G:3,Y.retryInterval=isNumber(q)?q:3e4,Y.minRetryInterval=isNumber(j)?j:3e3,Y.maxRetryInterval=isNumber(W)?W:9e4,Y}return tslib_es6_extends(ExponentialRetryPolicy,O),ExponentialRetryPolicy.prototype.sendRequest=function(O){var B=this;return this._nextPolicy.sendRequest(O.clone()).then((function(U){return exponentialRetryPolicy_retry(B,O,U)})).catch((function(U){return exponentialRetryPolicy_retry(B,O,U.response,void 0,U)}))},ExponentialRetryPolicy}(Ir);function exponentialRetryPolicy_retry(O,B,U,G,q){G=function(O,B,U){B||(B={retryCount:0,retryInterval:0}),U&&(B.error&&(U.innerError=B.error),B.error=U),B.retryCount++;var G=Math.pow(2,B.retryCount)-1;return G*=.8*O.retryInterval+Math.floor(Math.random()*(1.2*O.retryInterval-.8*O.retryInterval)),B.retryInterval=Math.min(O.minRetryInterval+G,O.maxRetryInterval),B}(O,G,q);var j=B.abortSignal&&B.abortSignal.aborted;if(!j&&function(O,B,U){if(null==B||B<500&&408!==B||501===B||505===B)return!1;if(!U)throw new Error("retryData for the ExponentialRetryPolicyFilter cannot be null.");return(U&&U.retryCount)<O.retryCount}(O,U&&U.status,G))return delay(G.retryInterval).then((function(){return O._nextPolicy.sendRequest(B.clone())})).then((function(U){return exponentialRetryPolicy_retry(O,B,U,G,void 0)})).catch((function(q){return exponentialRetryPolicy_retry(O,B,U,G,q)}));if(j||q||!U){var W=G.error||new Er("Failed to send the request.",Er.REQUEST_SEND_ERROR,U&&U.status,U&&U.request,U);return Promise.reject(W)}return Promise.resolve(U)}var Nn=function(O){function GenerateClientRequestIdPolicy(B,U,G){var q=O.call(this,B,U)||this;return q._requestIdHeaderName=G,q}return tslib_es6_extends(GenerateClientRequestIdPolicy,O),GenerateClientRequestIdPolicy.prototype.sendRequest=function(O){return O.headers.contains(this._requestIdHeaderName)||O.headers.set(this._requestIdHeaderName,generateUuid()),this._nextPolicy.sendRequest(O)},GenerateClientRequestIdPolicy}(Ir),On=function(){function URLQuery(){this._rawQuery={}}return URLQuery.prototype.any=function(){return Object.keys(this._rawQuery).length>0},URLQuery.prototype.set=function(O,B){if(O)if(null!=B){var U=Array.isArray(B)?B:B.toString();this._rawQuery[O]=U}else delete this._rawQuery[O]},URLQuery.prototype.get=function(O){return O?this._rawQuery[O]:void 0},URLQuery.prototype.toString=function(){var O="";for(var B in this._rawQuery){O&&(O+="&");var U=this._rawQuery[B];if(Array.isArray(U)){for(var G=[],q=0,j=U;q<j.length;q++){var W=j[q];G.push(B+"="+W)}O+=G.join("&")}else O+=B+"="+U}return O},URLQuery.parse=function(O){var B=new URLQuery;if(O){O.startsWith("?")&&(O=O.substring(1));for(var U="ParameterName",G="",q="",j=0;j<O.length;++j){var W=O[j];switch(U){case"ParameterName":switch(W){case"=":U="ParameterValue";break;case"&":G="",q="";break;default:G+=W}break;case"ParameterValue":if("&"===W)B.set(G,q),G="",q="",U="ParameterName";else q+=W;break;default:throw new Error("Unrecognized URLQuery parse state: "+U)}}"ParameterValue"===U&&B.set(G,q)}return B},URLQuery}(),Mn=function(){function URLBuilder(){}return URLBuilder.prototype.setScheme=function(O){O?this.set(O,"SCHEME"):this._scheme=void 0},URLBuilder.prototype.getScheme=function(){return this._scheme},URLBuilder.prototype.setHost=function(O){O?this.set(O,"SCHEME_OR_HOST"):this._host=void 0},URLBuilder.prototype.getHost=function(){return this._host},URLBuilder.prototype.setPort=function(O){null==O||""===O?this._port=void 0:this.set(O.toString(),"PORT")},URLBuilder.prototype.getPort=function(){return this._port},URLBuilder.prototype.setPath=function(O){if(O){var B=O.indexOf("://");if(-1!==B){var U=O.lastIndexOf("/",B);this.set(-1===U?O:O.substr(U+1),"SCHEME")}else this.set(O,"PATH")}else this._path=void 0},URLBuilder.prototype.appendPath=function(O){if(O){var B=this.getPath();B&&(B.endsWith("/")||(B+="/"),O.startsWith("/")&&(O=O.substring(1)),O=B+O),this.set(O,"PATH")}},URLBuilder.prototype.getPath=function(){return this._path},URLBuilder.prototype.setQuery=function(O){this._query=O?On.parse(O):void 0},URLBuilder.prototype.setQueryParameter=function(O,B){O&&(this._query||(this._query=new On),this._query.set(O,B))},URLBuilder.prototype.getQueryParameterValue=function(O){return this._query?this._query.get(O):void 0},URLBuilder.prototype.getQuery=function(){return this._query?this._query.toString():void 0},URLBuilder.prototype.set=function(O,B){for(var U=new Ln(O,B);U.next();){var G=U.current();if(G)switch(G.type){case"SCHEME":this._scheme=G.text||void 0;break;case"HOST":this._host=G.text||void 0;break;case"PORT":this._port=G.text||void 0;break;case"PATH":var q=G.text||void 0;this._path&&"/"!==this._path&&"/"===q||(this._path=q);break;case"QUERY":this._query=On.parse(G.text);break;default:throw new Error("Unrecognized URLTokenType: "+G.type)}}},URLBuilder.prototype.toString=function(){var O="";return this._scheme&&(O+=this._scheme+"://"),this._host&&(O+=this._host),this._port&&(O+=":"+this._port),this._path&&(this._path.startsWith("/")||(O+="/"),O+=this._path),this._query&&this._query.any()&&(O+="?"+this._query.toString()),O},URLBuilder.prototype.replaceAll=function(O,B){O&&(this.setScheme(replaceAll(this.getScheme(),O,B)),this.setHost(replaceAll(this.getHost(),O,B)),this.setPort(replaceAll(this.getPort(),O,B)),this.setPath(replaceAll(this.getPath(),O,B)),this.setQuery(replaceAll(this.getQuery(),O,B)))},URLBuilder.parse=function(O){var B=new URLBuilder;return B.set(O,"SCHEME_OR_HOST"),B},URLBuilder}(),Dn=function(){function URLToken(O,B){this.text=O,this.type=B}return URLToken.scheme=function(O){return new URLToken(O,"SCHEME")},URLToken.host=function(O){return new URLToken(O,"HOST")},URLToken.port=function(O){return new URLToken(O,"PORT")},URLToken.path=function(O){return new URLToken(O,"PATH")},URLToken.query=function(O){return new URLToken(O,"QUERY")},URLToken}();var Ln=function(){function URLTokenizer(O,B){this._text=O,this._textLength=O?O.length:0,this._currentState=null!=B?B:"SCHEME_OR_HOST",this._currentIndex=0}return URLTokenizer.prototype.current=function(){return this._currentToken},URLTokenizer.prototype.next=function(){if(hasCurrentCharacter(this))switch(this._currentState){case"SCHEME":B=function(O){return readWhile(O,(function(O){return function(O){var B=O.charCodeAt(0);return 48<=B&&B<=57||65<=B&&B<=90||97<=B&&B<=122}(O)}))}(O=this),O._currentToken=Dn.scheme(B),hasCurrentCharacter(O)?O._currentState="HOST":O._currentState="DONE";break;case"SCHEME_OR_HOST":(function(O){var B=readUntilCharacter(O,":","/","?");hasCurrentCharacter(O)?":"===getCurrentCharacter(O)?"://"===peekCharacters(O,3)?(O._currentToken=Dn.scheme(B),O._currentState="HOST"):(O._currentToken=Dn.host(B),O._currentState="PORT"):(O._currentToken=Dn.host(B),"/"===getCurrentCharacter(O)?O._currentState="PATH":O._currentState="QUERY"):(O._currentToken=Dn.host(B),O._currentState="DONE")})(this);break;case"HOST":(function(O){"://"===peekCharacters(O,3)&&nextCharacter(O,3);var B=readUntilCharacter(O,":","/","?");O._currentToken=Dn.host(B),hasCurrentCharacter(O)?":"===getCurrentCharacter(O)?O._currentState="PORT":"/"===getCurrentCharacter(O)?O._currentState="PATH":O._currentState="QUERY":O._currentState="DONE"})(this);break;case"PORT":(function(O){":"===getCurrentCharacter(O)&&nextCharacter(O);var B=readUntilCharacter(O,"/","?");O._currentToken=Dn.port(B),hasCurrentCharacter(O)?"/"===getCurrentCharacter(O)?O._currentState="PATH":O._currentState="QUERY":O._currentState="DONE"})(this);break;case"PATH":(function(O){var B=readUntilCharacter(O,"?");O._currentToken=Dn.path(B),hasCurrentCharacter(O)?O._currentState="QUERY":O._currentState="DONE"})(this);break;case"QUERY":(function(O){"?"===getCurrentCharacter(O)&&nextCharacter(O);var B=function(O){var B="";O._currentIndex<O._textLength&&(B=O._text.substring(O._currentIndex),O._currentIndex=O._textLength);return B}(O);O._currentToken=Dn.query(B),O._currentState="DONE"})(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var O,B;return!!this._currentToken},URLTokenizer}();function hasCurrentCharacter(O){return O._currentIndex<O._textLength}function getCurrentCharacter(O){return O._text[O._currentIndex]}function nextCharacter(O,B){hasCurrentCharacter(O)&&(B||(B=1),O._currentIndex+=B)}function peekCharacters(O,B){var U=O._currentIndex+B;return O._textLength<U&&(U=O._textLength),O._text.substring(O._currentIndex,U)}function readWhile(O,B){for(var U="";hasCurrentCharacter(O);){var G=getCurrentCharacter(O);if(!B(G))break;U+=G,nextCharacter(O)}return U}function readUntilCharacter(O){for(var B=[],U=1;U<arguments.length;U++)B[U-1]=arguments[U];return readWhile(O,(function(O){return-1===B.indexOf(O)}))}var Bn={handleRedirects:!0,maxRetries:20};var Fn=function(O){function RedirectPolicy(B,U,G){void 0===G&&(G=20);var q=O.call(this,B,U)||this;return q.maxRetries=G,q}return tslib_es6_extends(RedirectPolicy,O),RedirectPolicy.prototype.sendRequest=function(O){var B=this;return this._nextPolicy.sendRequest(O).then((function(O){return handleRedirect(B,O,0)}))},RedirectPolicy}(Ir);function handleRedirect(O,B,U){var G=B.request,q=B.status,j=B.headers.get("location");if(j&&(300===q||301===q&&["GET","HEAD"].includes(G.method)||302===q&&["GET","POST","HEAD"].includes(G.method)||303===q&&"POST"===G.method||307===q)&&(void 0!==G.redirectLimit&&U<G.redirectLimit||void 0===G.redirectLimit&&U<O.maxRetries)){var W=Mn.parse(G.url);return W.setPath(j),G.url=W.toString(),302!==q&&303!==q||"POST"!==G.method||(G.method="GET",delete G.body),O._nextPolicy.sendRequest(G).then((function(B){return handleRedirect(O,B,U+1)})).then((function(O){return function(O,B){O.redirected||(O.redirected=!0,O.url=B);return O}(O,G.url)}))}return Promise.resolve(B)}var zn=function(O){function RPRegistrationPolicy(B,U,G){void 0===G&&(G=30);var q=O.call(this,B,U)||this;return q._retryTimeout=G,q}return tslib_es6_extends(RPRegistrationPolicy,O),RPRegistrationPolicy.prototype.sendRequest=function(O){var B=this;return this._nextPolicy.sendRequest(O.clone()).then((function(U){return function(O,B,U){if(409===U.status){var G=function(O){var B,U;if(O){try{U=JSON.parse(O)}catch(O){}if(U&&U.error&&U.error.message&&U.error.code&&"MissingSubscriptionRegistration"===U.error.code){var G=U.error.message.match(/.*'(.*)'/i);G&&(B=G.pop())}}return B}(U.bodyAsText);if(G){var q=function(O){var B,U=O.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!U||!U[0])throw new Error("Unable to extract subscriptionId from the given url - "+O+".");B=U[0];return B}(B.url);return function(O,B,U,G){var q=B+"providers/"+U+"/register?api-version=2016-02-01",j=B+"providers/"+U+"?api-version=2016-02-01",W=getRequestEssentials(G);return W.method="POST",W.url=q,O._nextPolicy.sendRequest(W).then((function(B){if(200!==B.status)throw new Error("Autoregistration of "+U+" failed. Please try registering manually.");return getRegistrationStatus(O,j,G)}))}(O,q,G,B).catch((function(){return!1})).then((function(G){return G?(B.headers.set("x-ms-client-request-id",generateUuid()),O._nextPolicy.sendRequest(B.clone())):U}))}}return Promise.resolve(U)}(B,O,U)}))},RPRegistrationPolicy}(Ir);function getRequestEssentials(O,B){void 0===B&&(B=!1);var U=O.clone();return B&&(U.url=O.url),U.headers.set("x-ms-client-request-id",generateUuid()),U.headers.set("Content-Type","application/json; charset=utf-8"),U}function getRegistrationStatus(O,B,U){var G=getRequestEssentials(U);return G.url=B,G.method="GET",O._nextPolicy.sendRequest(G).then((function(G){var q=G.parsedBody;return!(!G.parsedBody||!q.registrationState||"Registered"!==q.registrationState)||delay(1e3*O._retryTimeout).then((function(){return getRegistrationStatus(O,B,U)}))}))}var $n=function(O){function SigningPolicy(B,U,G){var q=O.call(this,B,U)||this;return q.authenticationProvider=G,q}return tslib_es6_extends(SigningPolicy,O),SigningPolicy.prototype.signRequest=function(O){return this.authenticationProvider.signRequest(O)},SigningPolicy.prototype.sendRequest=function(O){var B=this;return this.signRequest(O).then((function(O){return B._nextPolicy.sendRequest(O)}))},SigningPolicy}(Ir);var Un=function(O){function SystemErrorRetryPolicy(B,U,G,q,j,W){var Y=O.call(this,B,U)||this;return Y.DEFAULT_CLIENT_RETRY_INTERVAL=3e4,Y.DEFAULT_CLIENT_RETRY_COUNT=3,Y.DEFAULT_CLIENT_MAX_RETRY_INTERVAL=9e4,Y.DEFAULT_CLIENT_MIN_RETRY_INTERVAL=3e3,Y.retryCount="number"==typeof G?G:Y.DEFAULT_CLIENT_RETRY_COUNT,Y.retryInterval="number"==typeof q?q:Y.DEFAULT_CLIENT_RETRY_INTERVAL,Y.minRetryInterval="number"==typeof j?j:Y.DEFAULT_CLIENT_MIN_RETRY_INTERVAL,Y.maxRetryInterval="number"==typeof W?W:Y.DEFAULT_CLIENT_MAX_RETRY_INTERVAL,Y}return tslib_es6_extends(SystemErrorRetryPolicy,O),SystemErrorRetryPolicy.prototype.sendRequest=function(O){var B=this;return this._nextPolicy.sendRequest(O.clone()).catch((function(U){return systemErrorRetryPolicy_retry(B,O,U.response,U)}))},SystemErrorRetryPolicy}(Ir);function systemErrorRetryPolicy_retry(O,B,U,G,q){return tslib_es6_awaiter(this,void 0,void 0,(function(){var j;return tslib_es6_generator(this,(function(W){switch(W.label){case 0:if(q=function(O,B,U){B||(B={retryCount:0,retryInterval:0}),U&&(B.error&&(U.innerError=B.error),B.error=U),B.retryCount++;var G=Math.pow(2,B.retryCount)-1;return G*=.8*O.retryInterval+Math.floor(Math.random()*(.4*O.retryInterval)),B.retryInterval=Math.min(O.minRetryInterval+G,O.maxRetryInterval),B}(O,q,G),!(G&&G.code&&function(O,B){if(!B)throw new Error("retryData for the SystemErrorRetryPolicyFilter cannot be null.");return(B&&B.retryCount)<O.retryCount}(O,q))||"ETIMEDOUT"!==G.code&&"ESOCKETTIMEDOUT"!==G.code&&"ECONNREFUSED"!==G.code&&"ECONNRESET"!==G.code&&"ENOENT"!==G.code)return[3,5];W.label=1;case 1:return W.trys.push([1,3,,4]),[4,delay(q.retryInterval)];case 2:return W.sent(),[2,O._nextPolicy.sendRequest(B.clone())];case 3:return j=W.sent(),[2,systemErrorRetryPolicy_retry(O,B,U,j,q)];case 4:return[3,6];case 5:return G?[2,Promise.reject(q.error)]:[2,U];case 6:return[2]}}))}))}var Vn=function(){function WebResource(O,B,U,G,q,j,W,Y,K,Q,Z,X,J,ee,te){this.streamResponseBody=j,this.url=O||"",this.method=B||"GET",this.headers=isHttpHeadersLike(q)?q:new xn(q),this.body=U,this.query=G,this.formData=void 0,this.withCredentials=W||!1,this.abortSignal=Y,this.timeout=K||0,this.onUploadProgress=Q,this.onDownloadProgress=Z,this.proxySettings=X,this.keepAlive=J,this.agentSettings=ee,this.redirectLimit=te}return WebResource.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},WebResource.prototype.prepare=function(O){if(!O)throw new Error("options object is required");if(null==O.method||"string"!=typeof O.method.valueOf())throw new Error("options.method must be a string.");if(O.url&&O.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=O.pathTemplate&&"string"==typeof O.pathTemplate.valueOf()||null!=O.url&&"string"==typeof O.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(O.url){if("string"!=typeof O.url)throw new Error('options.url must be of type "string".');this.url=O.url}if(O.method){var B=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===B.indexOf(O.method.toUpperCase()))throw new Error('The provided method "'+O.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(B))}if(this.method=O.method.toUpperCase(),O.pathTemplate){var U=O.pathTemplate,G=O.pathParameters;if("string"!=typeof U)throw new Error('options.pathTemplate must be of type "string".');O.baseUrl||(O.baseUrl="https://management.azure.com");var q=O.baseUrl,j=q+(q.endsWith("/")?"":"/")+(U.startsWith("/")?U.slice(1):U),W=j.match(/({\w*\s*\w*})/gi);if(W&&W.length){if(!G)throw new Error("pathTemplate: "+U+" has been provided. Hence, options.pathParameters must also be provided.");W.forEach((function(O){var B=O.slice(1,-1),q=G[B];if(null==q||"string"!=typeof q&&"object"!=typeof q)throw new Error("pathTemplate: "+U+" contains the path parameter "+B+" however, it is not present in "+G+" - "+JSON.stringify(G,void 0,2)+'.The value of the path parameter can either be a "string" of the form { '+B+': "some sample value" } or it can be an "object" of the form { "'+B+'": { value: "some sample value", skipUrlEncoding: true } }.');if("string"==typeof q.valueOf()&&(j=j.replace(O,encodeURIComponent(q))),"object"==typeof q.valueOf()){if(!q.value)throw new Error("options.pathParameters["+B+'] is of type "object" but it does not contain a "value" property.');j=q.skipUrlEncoding?j.replace(O,q.value):j.replace(O,encodeURIComponent(q.value))}}))}this.url=j}if(O.queryParameters){var Y=O.queryParameters;if("object"!=typeof Y)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var K=[];for(var Q in this.query={},Y){var Z=Y[Q];if(Z)if("string"==typeof Z)K.push(Q+"="+encodeURIComponent(Z)),this.query[Q]=encodeURIComponent(Z);else if("object"==typeof Z){if(!Z.value)throw new Error("options.queryParameters["+Q+'] is of type "object" but it does not contain a "value" property.');Z.skipUrlEncoding?(K.push(Q+"="+Z.value),this.query[Q]=Z.value):(K.push(Q+"="+encodeURIComponent(Z.value)),this.query[Q]=encodeURIComponent(Z.value))}}this.url+=K.join("&")}if(O.headers)for(var X=O.headers,J=0,ee=Object.keys(O.headers);J<ee.length;J++){var te=ee[J];this.headers.set(te,X[te])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||O.disableClientRequestId||this.headers.set("x-ms-client-request-id",generateUuid()),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=O.body,null!=O.body&&(O.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(O.serializationMapper&&(this.body=new _r(O.mappers).serialize(O.serializationMapper,O.body,"requestBody")),O.disableJsonStringifyOnBody||(this.body=JSON.stringify(O.body)))),this.abortSignal=O.abortSignal,this.onDownloadProgress=O.onDownloadProgress,this.onUploadProgress=O.onUploadProgress,this.redirectLimit=O.redirectLimit,this.streamResponseBody=O.streamResponseBody,this},WebResource.prototype.clone=function(){var O=new WebResource(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.agentSettings,this.redirectLimit);return this.formData&&(O.formData=this.formData),this.operationSpec&&(O.operationSpec=this.operationSpec),this.shouldDeserialize&&(O.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(O.operationResponseGetter=this.operationResponseGetter),O},WebResource}(),Gn=new Error("AgentPolicy is not supported in browser environment");(function(O){function AgentPolicy(B,U){O.call(this,B,U);throw Gn}tslib_es6_extends(AgentPolicy,O),AgentPolicy.prototype.sendRequest=function(O){throw Gn}})(Ir);var Hn=new Error("ProxyPolicy is not supported in browser environment");(function(O){function ProxyPolicy(B,U){O.call(this,B,U);throw Hn}tslib_es6_extends(ProxyPolicy,O),ProxyPolicy.prototype.sendRequest=function(O){throw Hn}})(Ir);var qn=wn.StatusCodes;var jn=function(O){function ThrottlingRetryPolicy(B,U,G){var q=O.call(this,B,U)||this;return q.retryLimit=G,q}return tslib_es6_extends(ThrottlingRetryPolicy,O),ThrottlingRetryPolicy.prototype.sendRequest=function(O){return tslib_es6_awaiter(this,void 0,void 0,(function(){var B=this;return tslib_es6_generator(this,(function(U){return[2,this._nextPolicy.sendRequest(O.clone()).then((function(U){return B.retry(O,U,0)}))]}))}))},ThrottlingRetryPolicy.prototype.retry=function(O,B,U){return tslib_es6_awaiter(this,void 0,void 0,(function(){var G,q,j;return tslib_es6_generator(this,(function(W){switch(W.label){case 0:return B.status!==qn.TooManyRequests?[2,B]:(G=B.headers.get(kn.RETRY_AFTER))&&U<this.retryLimit&&(q=ThrottlingRetryPolicy.parseRetryAfterHeader(G))?[4,delay(q)]:[3,3];case 1:return W.sent(),[4,this._nextPolicy.sendRequest(O)];case 2:return j=W.sent(),[2,this.retry(O,j,U+1)];case 3:return[2,B]}}))}))},ThrottlingRetryPolicy.parseRetryAfterHeader=function(O){var B=Number(O);return Number.isNaN(B)?ThrottlingRetryPolicy.parseDateRetryAfterHeader(O):1e3*B},ThrottlingRetryPolicy.parseDateRetryAfterHeader=function(O){try{var B=Date.now(),U=Date.parse(O)-B;return Number.isNaN(U)?void 0:U}catch(O){return}},ThrottlingRetryPolicy}(Ir),Wn=["https://management.windows.net","https://management.chinacloudapi.cn","https://management.usgovcloudapi.net","https://management.cloudapi.de"],Yn=function(){function AzureIdentityCredentialAdapter(O,B){void 0===B&&(B="https://management.azure.com/.default"),this.azureTokenCredential=O,this.scopes=B}return AzureIdentityCredentialAdapter.prototype.getToken=function(){return tslib_es6_awaiter(this,void 0,void 0,(function(){var O;return tslib_es6_generator(this,(function(B){switch(B.label){case 0:return[4,this.azureTokenCredential.getToken(this.scopes)];case 1:if(null!==(O=B.sent()))return[2,{accessToken:O.token,tokenType:"Bearer",expiresOn:O.expiresOnTimestamp}];throw new Error("Could find token for scope")}}))}))},AzureIdentityCredentialAdapter.prototype.signRequest=function(O){return tslib_es6_awaiter(this,void 0,void 0,(function(){var B;return tslib_es6_generator(this,(function(U){switch(U.label){case 0:return[4,this.getToken()];case 1:return B=U.sent(),O.headers.set(kn.AUTHORIZATION,B.tokenType+" "+B.accessToken),[2,Promise.resolve(O)]}}))}))},AzureIdentityCredentialAdapter}(),Kn=function(){function ServiceClient(O,B){var U,G;if(B||(B={}),B.baseUri&&(this.baseUri=B.baseUri),function(O){const B=O;return B&&"function"==typeof B.getToken&&(void 0===B.signRequest||B.getToken.length>0)}(O)){var q=void 0;(null==B?void 0:B.baseUri)&&Wn.includes(null==B?void 0:B.baseUri)&&(q=B.baseUri+"/.default"),U=new Yn(O,q)}else U=O;if(U&&!U.signRequest)throw new Error("credentials argument needs to implement signRequest method");if(this._withCredentials=B.withCredentials||!1,this._httpClient=B.httpClient||new In,this._requestPolicyOptions=new Pr(B.httpPipelineLogger),Array.isArray(B.requestPolicyFactories))G=B.requestPolicyFactories;else if(G=function(O,B){var U=[];B.generateClientRequestIdHeader&&U.push((void 0===(G=B.clientRequestIdHeaderName)&&(G="x-ms-client-request-id"),{create:function(O,B){return new Nn(O,B,G)}}));var G;O&&(!function(O){return"function"==typeof O.create}(O)?U.push((q=O,{create:function(O,B){return new $n(O,B,q)}})):U.push(O));var q;var j=getValueOrFunctionResult(B.userAgentHeaderName,An),W=getValueOrFunctionResult(B.userAgent,getDefaultUserAgentValue);j&&W&&U.push(function(O){var B=O&&null!=O.key?O.key:"x-ms-command-name",U=O&&null!=O.value?O.value:getDefaultUserAgentValue();return{create:function(O,G){return new Rn(O,G,B,U)}}}({key:j,value:W}));var Y=tslib_es6_assign(tslib_es6_assign({},Bn),B.redirectOptions);Y.handleRedirects&&U.push((void 0===(K=Y.maxRetries)&&(K=20),{create:function(O,B){return new Fn(O,B,K)}}));var K;U.push(function(O){return void 0===O&&(O=30),{create:function(B,U){return new zn(B,U,O)}}}(B.rpRegistrationRetryTimeout)),B.noRetryPolicy||(U.push({create:function(O,B){return new Pn(O,B,Z,X,J,ee)}}),U.push(function(O,B,U,G){return{create:function(q,j){return new Un(q,j,O,B,U,G)}}}()),U.push((void 0===Q&&(Q=3),{create:function(O,B){return new jn(O,B,Q)}})));var Q;var Z,X,J,ee;U.push(deserializationPolicy(B.deserializationContentTypes));var te=B.proxySettings||void 0;te&&U.push({create:function(O,B){throw Hn}});B.agentSettings&&U.push((B.agentSettings,{create:function(O,B){throw Gn}}));return U}(U,B),B.requestPolicyFactories){var j=B.requestPolicyFactories(G);j&&(G=j)}this._requestPolicyFactories=G}return ServiceClient.prototype.sendRequest=function(O){if(null==O||"object"!=typeof O)throw new Error("options cannot be null or undefined and it must be of type object.");var B,U;try{"object"==typeof(U=O)&&"string"==typeof U.url&&"string"==typeof U.method&&"object"==typeof U.headers&&isHttpHeadersLike(U.headers)&&"function"==typeof U.validateRequestProperties&&"function"==typeof U.prepare&&"function"==typeof U.clone?(O.validateRequestProperties(),B=O):B=(B=new Vn).prepare(O)}catch(O){return Promise.reject(O)}var G=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var q=this._requestPolicyFactories.length-1;q>=0;--q)G=this._requestPolicyFactories[q].create(G,this._requestPolicyOptions);return G.sendRequest(B)},ServiceClient.prototype.sendOperationRequest=function(O,B,U){"function"==typeof O.options&&(U=O.options,O.options=void 0);var G,q=new Vn;try{var j=B.baseUrl||this.baseUri;if(!j)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");q.method=B.httpMethod,q.operationSpec=B;var W=Mn.parse(j);if(B.path&&W.appendPath(B.path),B.urlParameters&&B.urlParameters.length>0)for(var Y=0,K=B.urlParameters;Y<K.length;Y++){var Q=K[Y],Z=getOperationArgumentValueFromParameter(this,O,Q,B.serializer);Z=B.serializer.serialize(Q.mapper,Z,getPathStringFromParameter(Q)),Q.skipEncoding||(Z=encodeURIComponent(Z)),W.replaceAll("{"+(Q.mapper.serializedName||getPathStringFromParameter(Q))+"}",Z)}if(B.queryParameters&&B.queryParameters.length>0)for(var X=0,J=B.queryParameters;X<J.length;X++){var ee=J[X],te=getOperationArgumentValueFromParameter(this,O,ee,B.serializer);if(null!=te){if(te=B.serializer.serialize(ee.mapper,te,getPathStringFromParameter(ee)),null!=ee.collectionFormat)if(ee.collectionFormat===Dr.Multi)if(0===te.length)te="";else for(var ie in te){var re=te[ie];te[ie]=null==re?"":re.toString()}else ee.collectionFormat!==Dr.Ssv&&ee.collectionFormat!==Dr.Tsv||(te=te.join(ee.collectionFormat));if(!ee.skipEncoding)if(Array.isArray(te))for(var ie in te)void 0!==te[ie]&&null!==te[ie]&&(te[ie]=encodeURIComponent(te[ie]));else te=encodeURIComponent(te);null!=ee.collectionFormat&&ee.collectionFormat!==Dr.Multi&&ee.collectionFormat!==Dr.Ssv&&ee.collectionFormat!==Dr.Tsv&&(te=te.join(ee.collectionFormat)),W.setQueryParameter(ee.mapper.serializedName||getPathStringFromParameter(ee),te)}}q.url=W.toString();var ne=B.contentType||this.requestContentType;if(ne&&q.headers.set("Content-Type",ne),B.headerParameters)for(var oe=0,ae=B.headerParameters;oe<ae.length;oe++){var se=ae[oe],le=getOperationArgumentValueFromParameter(this,O,se,B.serializer);if(null!=le){le=B.serializer.serialize(se.mapper,le,getPathStringFromParameter(se));var ce=se.mapper.headerCollectionPrefix;if(ce)for(var de=0,pe=Object.keys(le);de<pe.length;de++){var ue=pe[de];q.headers.set(ce+ue,le[ue])}else q.headers.set(se.mapper.serializedName||getPathStringFromParameter(se),le)}}var he=O.options;if(he){if(he.customHeaders)for(var me in he.customHeaders)q.headers.set(me,he.customHeaders[me]);he.abortSignal&&(q.abortSignal=he.abortSignal),he.timeout&&(q.timeout=he.timeout),he.onUploadProgress&&(q.onUploadProgress=he.onUploadProgress),he.onDownloadProgress&&(q.onDownloadProgress=he.onDownloadProgress)}q.withCredentials=this._withCredentials,function(O,B,U,G){if(G.requestBody&&G.requestBody.mapper){B.body=getOperationArgumentValueFromParameter(O,U,G.requestBody,G.serializer);var q=G.requestBody.mapper,j=q.required,W=q.xmlName,Y=q.xmlElementName,K=q.serializedName,Q=q.type.name;try{if(null!=B.body||j){var Z=getPathStringFromParameter(G.requestBody);B.body=G.serializer.serialize(q,B.body,Z);var X=Q===vr.Stream;G.isXML?Q===vr.Sequence?B.body=stringifyXML(function(O,B){var U;return Array.isArray(O)||(O=[O]),(U={})[B]=O,U}(B.body,Y||W||K),{rootName:W||K}):X||(B.body=stringifyXML(B.body,{rootName:W||K})):X||(B.body=JSON.stringify(B.body))}}catch(O){throw new Error('Error "'+O.message+'" occurred in serializing the payload - '+JSON.stringify(K,void 0,"  ")+".")}}else if(G.formDataParameters&&G.formDataParameters.length>0){B.formData={};for(var J=0,ee=G.formDataParameters;J<ee.length;J++){var te=ee[J],ie=getOperationArgumentValueFromParameter(O,U,te,G.serializer);if(null!=ie){var re=te.mapper.serializedName||getPathStringFromParameter(te);B.formData[re]=G.serializer.serialize(te.mapper,ie,getPathStringFromParameter(te))}}}}(this,q,O,B),null==q.streamResponseBody&&(q.streamResponseBody=isStreamOperation(B)),G=this.sendRequest(q).then((function(O){return function(O,B){var U=O.parsedHeaders,G=B&&B.bodyMapper,addOperationResponse=function(B){return Object.defineProperty(B,"_response",{value:O})};if(G){var q=G.type.name;if("Stream"===q)return addOperationResponse(tslib_es6_assign(tslib_es6_assign({},U),{blobBody:O.blobBody,readableStreamBody:O.readableStreamBody}));var j="Composite"===q&&G.type.modelProperties||{},W=Object.keys(j).some((function(O){return""===j[O].serializedName}));if("Sequence"===q||W){for(var Y=function(){for(var O=0,B=0,U=arguments.length;B<U;B++)O+=arguments[B].length;var G=Array(O),q=0;for(B=0;B<U;B++)for(var j=arguments[B],W=0,Y=j.length;W<Y;W++,q++)G[q]=j[W];return G}(Array.isArray(O.parsedBody)?O.parsedBody:[]),K=0,Q=Object.keys(j);K<Q.length;K++){var Z=Q[K];j[Z].serializedName&&(Y[Z]=O.parsedBody[Z])}if(U)for(var X=0,J=Object.keys(U);X<J.length;X++){Y[Z=J[X]]=U[Z]}return addOperationResponse(Y),Y}if("Composite"===q||"Dictionary"===q)return addOperationResponse(tslib_es6_assign(tslib_es6_assign({},U),O.parsedBody))}if(G||"HEAD"===O.request.method||function(O){return"object"!=typeof O&&"function"!=typeof O||null===O}(O.parsedBody))return addOperationResponse(tslib_es6_assign(tslib_es6_assign({},U),{body:O.parsedBody}));return addOperationResponse(tslib_es6_assign(tslib_es6_assign({},U),O.parsedBody))}(O,B.responses[O.status])}))}catch(O){G=Promise.reject(O)}var ge=U;return ge&&G.then((function(O){return ge(null,O._response.parsedBody,O._response.request,O._response)})).catch((function(O){return ge(O)})),G},ServiceClient}();function getValueOrFunctionResult(O,B){var U;return"string"==typeof O?U=O:(U=B(),"function"==typeof O&&(U=O(U))),U}function getOperationArgumentValueFromParameter(O,B,U,G){return getOperationArgumentValueFromParameterPath(O,B,U.parameterPath,U.mapper,G)}function getOperationArgumentValueFromParameterPath(O,B,U,G,q){var j;if("string"==typeof U&&(U=[U]),Array.isArray(U)){if(U.length>0){if(G.isConstant)j=G.defaultValue;else{var W=getPropertyFromParameterPath(B,U);W.propertyFound||(W=getPropertyFromParameterPath(O,U));var Y=!1;W.propertyFound||(Y=G.required||"options"===U[0]&&2===U.length),j=Y?G.defaultValue:W.propertyValue}var K=getPathStringFromParameterPath(U,G);q.serialize(G,j,K)}}else for(var Q in G.required&&(j={}),U){var Z=G.type.modelProperties[Q],X=U[Q],J=getOperationArgumentValueFromParameterPath(O,B,X,Z,q),ee=getPathStringFromParameterPath(X,Z);q.serialize(Z,J,ee),void 0!==J&&(j||(j={}),j[Q]=J)}return j}function getPropertyFromParameterPath(O,B){for(var U={propertyFound:!1},G=0;G<B.length;++G){var q=B[G];if(null==O||!(q in O))break;O=O[q]}return G===B.length&&(U.propertyValue=O,U.propertyFound=!0),U}var Qn=function(O){function WebSearchClientContext(B,U){var G=this;if(null==B)throw new Error("'credentials' cannot be null.");if(U||(U={}),!U.userAgent){var q=getDefaultUserAgentValue();U.userAgent="@azure/cognitiveservices-websearch/3.0.1 "+q}return(G=O.call(this,B,U)||this).endpoint="https://api.cognitive.microsoft.com",G.baseUri="{Endpoint}/bing/v7.0",G.requestContentType="application/json; charset=utf-8",G.credentials=B,null!==U.endpoint&&void 0!==U.endpoint&&(G.endpoint=U.endpoint),G}return tslib_es6_extends(WebSearchClientContext,O),WebSearchClientContext}(Kn),Zn=function(O){function WebSearchClient(B,U){var G=O.call(this,B,U)||this;return G.web=new Sn(G),G}return tslib_es6_extends(WebSearchClient,O),WebSearchClient}(Qn);function object_isObject(O){return!("object"!=typeof O||null===O||Array.isArray(O)||O instanceof RegExp||O instanceof Date)}function error_isError(O){if(object_isObject(O)){const B="string"==typeof O.name,U="string"==typeof O.message;return B&&U}return!1}function error_getErrorMessage(O){if(error_isError(O))return O.message;{let B;try{B="object"==typeof O&&O?JSON.stringify(O):String(O)}catch(O){B="[unable to stringify input]"}return`Unknown error ${B}`}}const Xn={},Jn="REDACTED",eo=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],to=["api-version"];class Sanitizer{constructor({additionalAllowedHeaderNames:O=[],additionalAllowedQueryParameters:B=[]}={}){O=eo.concat(O),B=to.concat(B),this.allowedHeaderNames=new Set(O.map((O=>O.toLowerCase()))),this.allowedQueryParameters=new Set(B.map((O=>O.toLowerCase())))}sanitize(O){const B=new Set;return JSON.stringify(O,((O,U)=>{if(U instanceof Error)return Object.assign(Object.assign({},U),{name:U.name,message:U.message});if("headers"===O)return this.sanitizeHeaders(U);if("url"===O)return this.sanitizeUrl(U);if("query"===O)return this.sanitizeQuery(U);if("body"!==O&&"response"!==O&&"operationSpec"!==O){if(Array.isArray(U)||object_isObject(U)){if(B.has(U))return"[Circular]";B.add(U)}return U}}),2)}sanitizeHeaders(O){const B={};for(const U of Object.keys(O))this.allowedHeaderNames.has(U.toLowerCase())?B[U]=O[U]:B[U]=Jn;return B}sanitizeQuery(O){if("object"!=typeof O||null===O)return O;const B={};for(const U of Object.keys(O))this.allowedQueryParameters.has(U.toLowerCase())?B[U]=O[U]:B[U]=Jn;return B}sanitizeUrl(O){if("string"!=typeof O||null===O)return O;const B=new URL(O);if(!B.search)return O;for(const[O]of B.searchParams)this.allowedQueryParameters.has(O.toLowerCase())||B.searchParams.set(O,Jn);return B.toString()}}const io=new Sanitizer;class restError_RestError extends Error{constructor(O,B={}){super(O),this.name="RestError",this.code=B.code,this.statusCode=B.statusCode,this.request=B.request,this.response=B.response,Object.setPrototypeOf(this,restError_RestError.prototype)}[Xn](){return`RestError: ${this.message} \n ${io.sanitize(this)}`}}function isRestError(O){return O instanceof restError_RestError||error_isError(O)&&"RestError"===O.name}restError_RestError.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",restError_RestError.PARSE_ERROR="PARSE_ERROR";class HttpRetryPolicy{constructor(O){this.options=O,this.name="httpRetryPolicy"}async sendRequest(O,B){const U=this.options.rules.find((B=>O.url.match(B.urlPattern)));if(!U)return B(O);const G={retryCount:-1};let q;for(;;){G.retryCount+=1,G.response=void 0,G.responseError=void 0;try{G.response=await B(O)}catch(O){if(!isRestError(O))throw O;G.responseError=O,G.response=G.responseError.response}0===G.retryCount&&(q=U.retryStrategy(G.response,G.responseError));const j=G.retryCount<U.maxRetryCount;if(q&&j){const{errorToThrow:O,successResponse:B,retryAfterInMs:U,skipStrategy:j}=q.retry(G);if(O)throw O;if(B)return B;if(!j){(U||0===U)&&await delay(U,void 0);continue}}if(G.responseError)throw G.responseError;if(G.response)return G.response;throw new Error(`${j?"Strategy skipped":"Maximum retries reached"} with no response or error to throw`)}}}class PhaseDelayRetryStrategy{constructor(O,B){this.phaseAttempts=O,this.phaseDelays=B,this.maxRetryCount=O.reduce(((O,B)=>O+B),0)}retry(O){var B,U;const{retryCount:G,response:q,responseError:j}=O,W=null!==(U=null===(B=this.getCustomModifiers)||void 0===B?void 0:B.call(this,O))&&void 0!==U?U:{};if(W.skipStrategy||W.errorToThrow||W.successResponse||void 0!==W.retryAfterInMs)return W;if(G<this.maxRetryCount){let O=0,B=0;for(let U=0;U<this.phaseAttempts.length;U++)if(O=this.phaseAttempts[U],B+=O,G<B){W.retryAfterInMs=this.phaseDelays[U];break}}else if(j)W.errorToThrow=j;else if(q){let O=`The request failed with status code '${q.status}'`;if(q.status.toString().startsWith("2")){let B;if(200===q.status&&q.bodyAsText)try{B=JSON.parse(q.bodyAsText)}catch(O){}let U="";try{U=(null==B?void 0:B.result)?JSON.stringify(null==B?void 0:B.result):"{}"}catch(O){}O+=` but body result is ${U}`}W.errorToThrow=new Error(O)}return W}}function createPhaseDelayRetryStrategy(O,B){return new PhaseDelayRetryStrategy(O,B)}class ShortCircuitRetryStrategy{constructor(O){var B;this.modifiers=O;const{skipStrategy:U,errorToThrow:G,successResponse:q,retryAfterInMs:j}=O;if(void 0!==j||void 0===(null!==(B=null!=U?U:G)&&void 0!==B?B:q))throw new Error("ShortCircuitRetryStrategy: invalid modifiers")}retry(O){return this.modifiers}}class CreateConversationNoContentError extends Error{constructor(){super("No content in response body."),this.name="CreateConversationNoContentError"}}function getRetryModifiers(O){const B={},{response:U}=O;if(U&&function(O){return 200===O.status}(U)){const O=function(O){let B;try{O.bodyAsText&&(B=JSON.parse(O.bodyAsText))}catch(O){}return B}(U);if(function(O){var B;return"string"==typeof(null===(B=null==O?void 0:O.result)||void 0===B?void 0:B.value)}(O))switch(O.result.value){case lr.Success:B.successResponse=U;break;case lr.UnauthorizedRequest:case lr.Forbidden:B.skipStrategy=!0}else B.errorToThrow=new CreateConversationNoContentError}return B}const ro={urlPattern:"/turing/conversation/create",retryStrategy:function(O){let B;const U=getRetryModifiers({response:O,retryCount:0});return B=U.errorToThrow||U.skipStrategy||U.successResponse?function(O){return new ShortCircuitRetryStrategy(O)}(U):(null==O?void 0:O.status.toString().startsWith("5"))?createPhaseDelayRetryStrategy([4,4,8,2],[100,1e3,2e3,5e3]):createPhaseDelayRetryStrategy([4,4,4,8,4,2],[20,250,1e3,2e3,5e3,1e4]),B.getCustomModifiers=getRetryModifiers,B},maxRetryCount:100};function normalizeName(O){return O.toLowerCase()}class HttpHeadersImpl{constructor(O){if(this._headersMap=new Map,O)for(const B of Object.keys(O))this.set(B,O[B])}set(O,B){this._headersMap.set(normalizeName(O),{name:O,value:String(B)})}get(O){var B;return null===(B=this._headersMap.get(normalizeName(O)))||void 0===B?void 0:B.value}has(O){return this._headersMap.has(normalizeName(O))}delete(O){this._headersMap.delete(normalizeName(O))}toJSON(O={}){const B={};if(O.preserveCase)for(const O of this._headersMap.values())B[O.name]=O.value;else for(const[O,U]of this._headersMap)B[O]=U.value;return B}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(O){for(const B of O.values())yield[B.name,B.value]}(this._headersMap)}}function createHttpHeaders(O){return new HttpHeadersImpl(O)}class PipelineRequestImpl{constructor(O){var B,U,G,q,j,W,Y;this.url=O.url,this.body=O.body,this.headers=null!==(B=O.headers)&&void 0!==B?B:createHttpHeaders(),this.method=null!==(U=O.method)&&void 0!==U?U:"GET",this.timeout=null!==(G=O.timeout)&&void 0!==G?G:0,this.formData=O.formData,this.disableKeepAlive=null!==(q=O.disableKeepAlive)&&void 0!==q&&q,this.proxySettings=O.proxySettings,this.streamResponseStatusCodes=O.streamResponseStatusCodes,this.withCredentials=null!==(j=O.withCredentials)&&void 0!==j&&j,this.abortSignal=O.abortSignal,this.tracingOptions=O.tracingOptions,this.onUploadProgress=O.onUploadProgress,this.onDownloadProgress=O.onDownloadProgress,this.requestId=O.requestId||esm_browser_v4(),this.allowInsecureConnection=null!==(W=O.allowInsecureConnection)&&void 0!==W&&W,this.enableBrowserStreams=null!==(Y=O.enableBrowserStreams)&&void 0!==Y&&Y}}const no="$",oo="_";function base64_browser_encodeByteArray(O){let B="";for(let U=0;U<O.length;U++)B+=String.fromCharCode(O[U]);return btoa(B)}function base64_browser_decodeString(O){const B=atob(O),U=new Uint8Array(B.length);for(let O=0;O<B.length;O++)U[O]=B.charCodeAt(O);return U}function decodeStringToString(O){return atob(O)}function isPrimitiveBody(O,B){return"Composite"!==B&&"Dictionary"!==B&&("string"==typeof O||"number"==typeof O||"boolean"==typeof O||null!==(null==B?void 0:B.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))||null==O)}const ao=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;const so=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function utils_flattenResponse(O,B){var U,G;const q=O.parsedHeaders;if("HEAD"===O.request.method)return Object.assign(Object.assign({},q),{body:O.parsedBody});const j=B&&B.bodyMapper,W=Boolean(null==j?void 0:j.nullable),Y=null==j?void 0:j.type.name;if("Stream"===Y)return Object.assign(Object.assign({},q),{blobBody:O.blobBody,readableStreamBody:O.readableStreamBody});const K="Composite"===Y&&j.type.modelProperties||{},Q=Object.keys(K).some((O=>""===K[O].serializedName));if("Sequence"===Y||Q){const B=null!==(U=O.parsedBody)&&void 0!==U?U:[];for(const U of Object.keys(K))K[U].serializedName&&(B[U]=null===(G=O.parsedBody)||void 0===G?void 0:G[U]);if(q)for(const O of Object.keys(q))B[O]=q[O];return!W||O.parsedBody||q||0!==Object.getOwnPropertyNames(K).length?B:null}return function(O){const B=Object.assign(Object.assign({},O.headers),O.body);return O.hasNullableType&&0===Object.getOwnPropertyNames(B).length?O.shouldWrapBody?{body:null}:null:O.shouldWrapBody?Object.assign(Object.assign({},O.headers),{body:O.body}):B}({body:O.parsedBody,headers:q,hasNullableType:W,shouldWrapBody:isPrimitiveBody(O.parsedBody,Y)})}class SerializerImpl{constructor(O={},B=!1){this.modelMappers=O,this.isXML=B}validateConstraints(O,B,U){const failValidation=(O,G)=>{throw new Error(`"${U}" with value "${B}" should satisfy the constraint "${O}": ${G}.`)};if(O.constraints&&null!=B){const{ExclusiveMaximum:U,ExclusiveMinimum:G,InclusiveMaximum:q,InclusiveMinimum:j,MaxItems:W,MaxLength:Y,MinItems:K,MinLength:Q,MultipleOf:Z,Pattern:X,UniqueItems:J}=O.constraints;if(void 0!==U&&B>=U&&failValidation("ExclusiveMaximum",U),void 0!==G&&B<=G&&failValidation("ExclusiveMinimum",G),void 0!==q&&B>q&&failValidation("InclusiveMaximum",q),void 0!==j&&B<j&&failValidation("InclusiveMinimum",j),void 0!==W&&B.length>W&&failValidation("MaxItems",W),void 0!==Y&&B.length>Y&&failValidation("MaxLength",Y),void 0!==K&&B.length<K&&failValidation("MinItems",K),void 0!==Q&&B.length<Q&&failValidation("MinLength",Q),void 0!==Z&&B%Z!=0&&failValidation("MultipleOf",Z),X){const O="string"==typeof X?new RegExp(X):X;"string"==typeof B&&null!==B.match(O)||failValidation("Pattern",X)}J&&B.some(((O,B,U)=>U.indexOf(O)!==B))&&failValidation("UniqueItems",J)}}serialize(O,B,U,G={xml:{}}){var q,j,W;const Y={xml:{rootName:null!==(q=G.xml.rootName)&&void 0!==q?q:"",includeRoot:null!==(j=G.xml.includeRoot)&&void 0!==j&&j,xmlCharKey:null!==(W=G.xml.xmlCharKey)&&void 0!==W?W:oo}};let K={};const Q=O.type.name;U||(U=O.serializedName),null!==Q.match(/^Sequence$/i)&&(K=[]),O.isConstant&&(B=O.defaultValue);const{required:Z,nullable:X}=O;if(Z&&X&&void 0===B)throw new Error(`${U} cannot be undefined.`);if(Z&&!X&&null==B)throw new Error(`${U} cannot be null or undefined.`);if(!Z&&!1===X&&null===B)throw new Error(`${U} cannot be null.`);if(null==B)K=B;else if(null!==Q.match(/^any$/i))K=B;else if(null!==Q.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i))K=function(O,B,U){if(null!=U)if(null!==O.match(/^Number$/i)){if("number"!=typeof U)throw new Error(`${B} with value ${U} must be of type number.`)}else if(null!==O.match(/^String$/i)){if("string"!=typeof U.valueOf())throw new Error(`${B} with value "${U}" must be of type string.`)}else if(null!==O.match(/^Uuid$/i)){if("string"!=typeof U.valueOf()||(G=U,!so.test(G)))throw new Error(`${B} with value "${U}" must be of type string and a valid uuid.`)}else if(null!==O.match(/^Boolean$/i)){if("boolean"!=typeof U)throw new Error(`${B} with value ${U} must be of type boolean.`)}else if(null!==O.match(/^Stream$/i)){if(!("string"===typeof U||"function"==typeof U.pipe||U instanceof ArrayBuffer||ArrayBuffer.isView(U)||("function"==typeof Blob||"object"==typeof Blob)&&U instanceof Blob))throw new Error(`${B} must be a string, Blob, ArrayBuffer, ArrayBufferView, or NodeJS.ReadableStream.`)}var G;return U}(Q,U,B);else if(null!==Q.match(/^Enum$/i)){K=function(O,B,U){if(!B)throw new Error(`Please provide a set of allowedValues to validate ${O} as an Enum Type.`);if(!B.some((O=>"string"==typeof O.valueOf()?O.toLowerCase()===U.toLowerCase():O===U)))throw new Error(`${U} is not a valid value for ${O}. The valid values are: ${JSON.stringify(B)}.`);return U}(U,O.type.allowedValues,B)}else null!==Q.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?K=function(O,B,U){if(null!=B)if(null!==O.match(/^Date$/i)){if(!(B instanceof Date||"string"==typeof B.valueOf()&&!isNaN(Date.parse(B))))throw new Error(`${U} must be an instanceof Date or a string in ISO8601 format.`);B=B instanceof Date?B.toISOString().substring(0,10):new Date(B).toISOString().substring(0,10)}else if(null!==O.match(/^DateTime$/i)){if(!(B instanceof Date||"string"==typeof B.valueOf()&&!isNaN(Date.parse(B))))throw new Error(`${U} must be an instanceof Date or a string in ISO8601 format.`);B=B instanceof Date?B.toISOString():new Date(B).toISOString()}else if(null!==O.match(/^DateTimeRfc1123$/i)){if(!(B instanceof Date||"string"==typeof B.valueOf()&&!isNaN(Date.parse(B))))throw new Error(`${U} must be an instanceof Date or a string in RFC-1123 format.`);B=B instanceof Date?B.toUTCString():new Date(B).toUTCString()}else if(null!==O.match(/^UnixTime$/i)){if(!(B instanceof Date||"string"==typeof B.valueOf()&&!isNaN(Date.parse(B))))throw new Error(`${U} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);B=function(O){if(!O)return;"string"==typeof O.valueOf()&&(O=new Date(O));return Math.floor(O.getTime()/1e3)}(B)}else if(null!==O.match(/^TimeSpan$/i)&&!function(O){return ao.test(O)}(B))throw new Error(`${U} must be a string in ISO 8601 format. Instead was "${B}".`);return B}(Q,B,U):null!==Q.match(/^ByteArray$/i)?K=function(O,B){if(null!=B){if(!(B instanceof Uint8Array))throw new Error(`${O} must be of type Uint8Array.`);B=base64_browser_encodeByteArray(B)}return B}(U,B):null!==Q.match(/^Base64Url$/i)?K=function(O,B){if(null!=B){if(!(B instanceof Uint8Array))throw new Error(`${O} must be of type Uint8Array.`);B=function(O){if(!O)return;if(!(O instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(O,B){let U=O.length;for(;U-1>=0&&O[U-1]===B;)--U;return O.substr(0,U)}(base64_browser_encodeByteArray(O),"=").replace(/\+/g,"-").replace(/\//g,"_")}(B)}return B}(U,B):null!==Q.match(/^Sequence$/i)?K=function(O,B,U,G,q,j){var W;if(!Array.isArray(U))throw new Error(`${G} must be of type Array.`);let Y=B.type.element;if(!Y||"object"!=typeof Y)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${G}.`);"Composite"===Y.type.name&&Y.type.className&&(Y=null!==(W=O.modelMappers[Y.type.className])&&void 0!==W?W:Y);const K=[];for(let B=0;B<U.length;B++){const W=O.serialize(Y,U[B],G,j);if(q&&Y.xmlNamespace){const O=Y.xmlNamespacePrefix?`xmlns:${Y.xmlNamespacePrefix}`:"xmlns";"Composite"===Y.type.name?(K[B]=Object.assign({},W),K[B][no]={[O]:Y.xmlNamespace}):(K[B]={},K[B][j.xml.xmlCharKey]=W,K[B][no]={[O]:Y.xmlNamespace})}else K[B]=W}return K}(this,O,B,U,Boolean(this.isXML),Y):null!==Q.match(/^Dictionary$/i)?K=function(O,B,U,G,q,j){if("object"!=typeof U)throw new Error(`${G} must be of type object.`);const W=B.type.value;if(!W||"object"!=typeof W)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${G}.`);const Y={};for(const B of Object.keys(U)){const K=O.serialize(W,U[B],G,j);Y[B]=getXmlObjectValue(W,K,q,j)}if(q&&B.xmlNamespace){const O=B.xmlNamespacePrefix?`xmlns:${B.xmlNamespacePrefix}`:"xmlns",U=Y;return U[no]={[O]:B.xmlNamespace},U}return Y}(this,O,B,U,Boolean(this.isXML),Y):null!==Q.match(/^Composite$/i)&&(K=function(O,B,U,G,q,j){serializer_getPolymorphicDiscriminatorRecursively(O,B)&&(B=serializer_getPolymorphicMapper(O,B,U,"clientName"));if(null!=U){const W={},Y=serializer_resolveModelProperties(O,B,G);for(const K of Object.keys(Y)){const Q=Y[K];if(Q.readOnly)continue;let Z,X=W;if(O.isXML)Z=Q.xmlIsWrapped?Q.xmlName:Q.xmlElementName||Q.xmlName;else{const O=serializer_splitSerializeName(Q.serializedName);Z=O.pop();for(const B of O){const O=X[B];null==O&&(void 0!==U[K]&&null!==U[K]||void 0!==Q.defaultValue)&&(X[B]={}),X=X[B]}}if(null!=X){if(q&&B.xmlNamespace){const O=B.xmlNamespacePrefix?`xmlns:${B.xmlNamespacePrefix}`:"xmlns";X[no]=Object.assign(Object.assign({},X[no]),{[O]:B.xmlNamespace})}const W=""!==Q.serializedName?G+"."+Q.serializedName:G;let Y=U[K];const J=serializer_getPolymorphicDiscriminatorRecursively(O,B);J&&J.clientName===K&&null==Y&&(Y=B.serializedName);const ee=O.serialize(Q,Y,W,j);if(void 0!==ee&&null!=Z){const O=getXmlObjectValue(Q,ee,q,j);q&&Q.xmlIsAttribute?(X[no]=X[no]||{},X[no][Z]=ee):q&&Q.xmlIsWrapped?X[Z]={[Q.xmlElementName]:O}:X[Z]=O}}}const K=function(O,B,U){const G=B.type.additionalProperties;if(!G&&B.type.className){const G=resolveReferencedMapper(O,B,U);return null==G?void 0:G.type.additionalProperties}return G}(O,B,G);if(K){const B=Object.keys(Y);for(const q in U){B.every((O=>O!==q))&&(W[q]=O.serialize(K,U[q],G+'["'+q+'"]',j))}}return W}return U}(this,O,B,U,Boolean(this.isXML),Y));return K}deserialize(O,B,U,G={xml:{}}){var q,j,W;const Y={xml:{rootName:null!==(q=G.xml.rootName)&&void 0!==q?q:"",includeRoot:null!==(j=G.xml.includeRoot)&&void 0!==j&&j,xmlCharKey:null!==(W=G.xml.xmlCharKey)&&void 0!==W?W:oo}};if(null==B)return this.isXML&&"Sequence"===O.type.name&&!O.xmlIsWrapped&&(B=[]),void 0!==O.defaultValue&&(B=O.defaultValue),B;let K;const Q=O.type.name;if(U||(U=O.serializedName),null!==Q.match(/^Composite$/i))K=function(O,B,U,G,q){var j;serializer_getPolymorphicDiscriminatorRecursively(O,B)&&(B=serializer_getPolymorphicMapper(O,B,U,"serializedName"));const W=serializer_resolveModelProperties(O,B,G);let Y={};const K=[];for(const Q of Object.keys(W)){const Z=W[Q],X=serializer_splitSerializeName(W[Q].serializedName);K.push(X[0]);const{serializedName:J,xmlName:ee,xmlElementName:te}=Z;let ie=G;""!==J&&void 0!==J&&(ie=G+"."+J);const re=Z.headerCollectionPrefix;if(re){const B={};for(const G of Object.keys(U))G.startsWith(re)&&(B[G.substring(re.length)]=O.deserialize(Z.type.value,U[G],ie,q)),K.push(G);Y[Q]=B}else if(O.isXML)if(Z.xmlIsAttribute&&U[no])Y[Q]=O.deserialize(Z,U[no][ee],ie,q);else{const B=te||ee||J;if(Z.xmlIsWrapped){const B=U[ee],G=null!==(j=null==B?void 0:B[te])&&void 0!==j?j:[];Y[Q]=O.deserialize(Z,G,ie,q)}else{const G=U[B];Y[Q]=O.deserialize(Z,G,ie,q)}}else{let G,j=U;for(const O of X){if(!j)break;j=j[O]}G=j;const K=B.type.polymorphicDiscriminator;let J;if(K&&Q===K.clientName&&null==G&&(G=B.serializedName),Array.isArray(U[Q])&&""===W[Q].serializedName){G=U[Q];const B=O.deserialize(Z,G,ie,q);for(const[O,U]of Object.entries(Y))Object.prototype.hasOwnProperty.call(B,O)||(B[O]=U);Y=B}else void 0===G&&void 0===Z.defaultValue||(J=O.deserialize(Z,G,ie,q),Y[Q]=J)}}const Q=B.type.additionalProperties;if(Q){const isAdditionalProperty=O=>{for(const B in W){if(serializer_splitSerializeName(W[B].serializedName)[0]===O)return!1}return!0};for(const B in U)isAdditionalProperty(B)&&(Y[B]=O.deserialize(Q,U[B],G+'["'+B+'"]',q))}else if(U)for(const O of Object.keys(U))void 0!==Y[O]||K.includes(O)||serializer_isSpecialXmlProperty(O,q)||(Y[O]=U[O]);return Y}(this,O,B,U,Y);else{if(this.isXML){const O=Y.xml.xmlCharKey;void 0!==B[no]&&void 0!==B[O]&&(B=B[O])}null!==Q.match(/^Number$/i)?(K=parseFloat(B),isNaN(K)&&(K=B)):null!==Q.match(/^Boolean$/i)?K="true"===B||"false"!==B&&B:null!==Q.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?K=B:null!==Q.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?K=new Date(B):null!==Q.match(/^UnixTime$/i)?K=function(O){if(!O)return;return new Date(1e3*O)}(B):null!==Q.match(/^ByteArray$/i)?K=base64_browser_decodeString(B):null!==Q.match(/^Base64Url$/i)?K=function(O){if(!O)return;if(O&&"string"!=typeof O.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return base64_browser_decodeString(O=O.replace(/-/g,"+").replace(/_/g,"/"))}(B):null!==Q.match(/^Sequence$/i)?K=function(O,B,U,G,q){var j;let W=B.type.element;if(!W||"object"!=typeof W)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${G}`);if(U){Array.isArray(U)||(U=[U]),"Composite"===W.type.name&&W.type.className&&(W=null!==(j=O.modelMappers[W.type.className])&&void 0!==j?j:W);const B=[];for(let j=0;j<U.length;j++)B[j]=O.deserialize(W,U[j],`${G}[${j}]`,q);return B}return U}(this,O,B,U,Y):null!==Q.match(/^Dictionary$/i)&&(K=function(O,B,U,G,q){const j=B.type.value;if(!j||"object"!=typeof j)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${G}`);if(U){const B={};for(const W of Object.keys(U))B[W]=O.deserialize(j,U[W],G,q);return B}return U}(this,O,B,U,Y))}return O.isConstant&&(K=O.defaultValue),K}}function createSerializer(O={},B=!1){return new SerializerImpl(O,B)}function serializer_splitSerializeName(O){const B=[];let U="";if(O){const G=O.split(".");for(const O of G)"\\"===O.charAt(O.length-1)?U+=O.substr(0,O.length-1)+".":(U+=O,B.push(U),U="")}return B}function resolveReferencedMapper(O,B,U){const G=B.type.className;if(!G)throw new Error(`Class name for model "${U}" is not provided in the mapper "${JSON.stringify(B,void 0,2)}".`);return O.modelMappers[G]}function serializer_resolveModelProperties(O,B,U){let G=B.type.modelProperties;if(!G){const q=resolveReferencedMapper(O,B,U);if(!q)throw new Error(`mapper() cannot be null or undefined for model "${B.type.className}".`);if(G=null==q?void 0:q.type.modelProperties,!G)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(q)}" of type "${B.type.className}" for object "${U}".`)}return G}function getXmlObjectValue(O,B,U,G){if(!U||!O.xmlNamespace)return B;const q={[O.xmlNamespacePrefix?`xmlns:${O.xmlNamespacePrefix}`:"xmlns"]:O.xmlNamespace};if(["Composite"].includes(O.type.name)){if(B[no])return B;{const O=Object.assign({},B);return O[no]=q,O}}const j={};return j[G.xml.xmlCharKey]=B,j[no]=q,j}function serializer_isSpecialXmlProperty(O,B){return[no,B.xml.xmlCharKey].includes(O)}function serializer_getPolymorphicMapper(O,B,U,G){var q;const j=serializer_getPolymorphicDiscriminatorRecursively(O,B);if(j){let W=j[G];if(W){"serializedName"===G&&(W=W.replace(/\\/gi,""));const j=U[W],Y=null!==(q=B.type.uberParent)&&void 0!==q?q:B.type.className;if("string"==typeof j&&Y){const U=function(O,B,U){const G=[U];for(;G.length;){const U=G.shift(),q=B===U?B:U+"."+B;if(Object.prototype.hasOwnProperty.call(O,q))return O[q];for(const[B,q]of Object.entries(O))B.startsWith(U+".")&&q.type.uberParent===U&&q.type.className&&G.push(q.type.className)}}(O.modelMappers.discriminators,j,Y);U&&(B=U)}}}return B}function serializer_getPolymorphicDiscriminatorRecursively(O,B){return B.type.polymorphicDiscriminator||serializer_getPolymorphicDiscriminatorSafely(O,B.type.uberParent)||serializer_getPolymorphicDiscriminatorSafely(O,B.type.className)}function serializer_getPolymorphicDiscriminatorSafely(O,B){return B&&O.modelMappers[B]&&O.modelMappers[B].type.polymorphicDiscriminator}const lo="Sequence",co="String",po="Stream";function operationHelpers_getOperationArgumentValueFromParameter(O,B,U){let G=B.parameterPath;const q=B.mapper;let j;if("string"==typeof G&&(G=[G]),Array.isArray(G)){if(G.length>0)if(q.isConstant)j=q.defaultValue;else{let B=operationHelpers_getPropertyFromParameterPath(O,G);!B.propertyFound&&U&&(B=operationHelpers_getPropertyFromParameterPath(U,G));let W=!1;B.propertyFound||(W=q.required||"options"===G[0]&&2===G.length),j=W?q.defaultValue:B.propertyValue}}else{q.required&&(j={});for(const B in G){const W=q.type.modelProperties[B],Y=operationHelpers_getOperationArgumentValueFromParameter(O,{parameterPath:G[B],mapper:W},U);void 0!==Y&&(j||(j={}),j[B]=Y)}}return j}function operationHelpers_getPropertyFromParameterPath(O,B){const U={propertyFound:!1};let G=0;for(;G<B.length;++G){const U=B[G];if(!O||!(U in O))break;O=O[U]}return G===B.length&&(U.propertyValue=O,U.propertyFound=!0),U}const uo=new WeakMap;function getOperationRequestInfo(O){let B=uo.get(O);return B||(B={},uo.set(O,B)),B}const ho=["application/json","text/json"],mo=["application/xml","application/atom+xml"];function deserializationPolicy_deserializationPolicy(O={}){var B,U,G,q,j,W,Y;const K=null!==(U=null===(B=O.expectedContentTypes)||void 0===B?void 0:B.json)&&void 0!==U?U:ho,Q=null!==(q=null===(G=O.expectedContentTypes)||void 0===G?void 0:G.xml)&&void 0!==q?q:mo,Z=O.parseXML,X=O.serializerOptions,J={xml:{rootName:null!==(j=null==X?void 0:X.xml.rootName)&&void 0!==j?j:"",includeRoot:null!==(W=null==X?void 0:X.xml.includeRoot)&&void 0!==W&&W,xmlCharKey:null!==(Y=null==X?void 0:X.xml.xmlCharKey)&&void 0!==Y?Y:oo}};return{name:"deserializationPolicy",async sendRequest(O,B){const U=await B(O);return async function(O,B,U,G,q){const j=await async function(O,B,U,G,q){var j;if(!(null===(j=U.request.streamResponseStatusCodes)||void 0===j?void 0:j.has(U.status))&&U.bodyAsText){const j=U.bodyAsText,W=U.headers.get("Content-Type")||"",Y=W?W.split(";").map((O=>O.toLowerCase())):[];try{if(0===Y.length||Y.some((B=>-1!==O.indexOf(B))))return U.parsedBody=JSON.parse(j),U;if(Y.some((O=>-1!==B.indexOf(O)))){if(!q)throw new Error("Parsing XML not supported.");const O=await q(j,G.xml);return U.parsedBody=O,U}}catch(O){const B=`Error "${O}" occurred while parsing the response body - ${U.bodyAsText}.`,G=O.code||restError_RestError.PARSE_ERROR;throw new restError_RestError(B,{code:G,statusCode:U.status,request:U.request,response:U})}}return U}(O,B,U,G,q);if(!function(O){const B=getOperationRequestInfo(O.request),U=null==B?void 0:B.shouldDeserialize;let G;G=void 0===U||("boolean"==typeof U?U:U(O));return G}(j))return j;const W=getOperationRequestInfo(j.request),Y=null==W?void 0:W.operationSpec;if(!Y||!Y.responses)return j;const K=function(O){let B;const U=getOperationRequestInfo(O.request),G=null==U?void 0:U.operationSpec;G&&(B=(null==U?void 0:U.operationResponseGetter)?null==U?void 0:U.operationResponseGetter(G,O):G.responses[O.status]);return B}(j),{error:Q,shouldReturnResponse:Z}=function(O,B,U){var G;const q=200<=O.status&&O.status<300;if(function(O){const B=Object.keys(O.responses);return 0===B.length||1===B.length&&"default"===B[0]}(B)?q:U){if(!U)return{error:null,shouldReturnResponse:!1};if(!U.isError)return{error:null,shouldReturnResponse:!1}}const j=null!=U?U:B.responses.default,W=(null===(G=O.request.streamResponseStatusCodes)||void 0===G?void 0:G.has(O.status))?`Unexpected status code: ${O.status}`:O.bodyAsText,Y=new restError_RestError(W,{statusCode:O.status,request:O.request,response:O});if(!j)throw Y;const K=j.bodyMapper,Q=j.headersMapper;try{if(O.parsedBody){const U=O.parsedBody;let G;if(K){let O=U;if(B.isXML&&K.type.name===lo){O=[];const B=K.xmlElementName;"object"==typeof U&&B&&(O=U[B])}G=B.serializer.deserialize(K,O,"error.response.parsedBody")}const q=U.error||G||U;Y.code=q.code,q.message&&(Y.message=q.message),K&&(Y.response.parsedBody=G)}O.headers&&Q&&(Y.response.parsedHeaders=B.serializer.deserialize(Q,O.headers.toJSON(),"operationRes.parsedHeaders"))}catch(B){Y.message=`Error "${B.message}" occurred in deserializing the responseBody - "${O.bodyAsText}" for the default response.`}return{error:Y,shouldReturnResponse:!1}}(j,Y,K);if(Q)throw Q;if(Z)return j;if(K){if(K.bodyMapper){let O=j.parsedBody;Y.isXML&&K.bodyMapper.type.name===lo&&(O="object"==typeof O?O[K.bodyMapper.xmlElementName]:[]);try{j.parsedBody=Y.serializer.deserialize(K.bodyMapper,O,"operationRes.parsedBody")}catch(O){throw new restError_RestError(`Error ${O} occurred in deserializing the responseBody - ${j.bodyAsText}`,{statusCode:j.status,request:j.request,response:j})}}else"HEAD"===Y.httpMethod&&(j.parsedBody=U.status>=200&&U.status<300);K.headersMapper&&(j.parsedHeaders=Y.serializer.deserialize(K.headersMapper,j.headers.toJSON(),"operationRes.parsedHeaders"))}return j}(K,Q,U,J,Z)}}}const fo="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let yo,_o=[],vo=[];const bo=[];fo&&enable(fo);const So=Object.assign((O=>createDebugger(O)),{enable,enabled,disable:function(){const O=yo||"";return enable(""),O},log:function(...O){if(O.length>0){const B=String(O[0]);B.includes(":error")?console.error(...O):B.includes(":warning")?console.warn(...O):B.includes(":info")?console.info(...O):(B.includes(":verbose"),console.debug(...O))}}});function enable(O){yo=O,_o=[],vo=[];const B=/\*/g,U=O.split(",").map((O=>O.trim().replace(B,".*?")));for(const O of U)O.startsWith("-")?vo.push(new RegExp(`^${O.substr(1)}$`)):_o.push(new RegExp(`^${O}$`));for(const O of bo)O.enabled=enabled(O.namespace)}function enabled(O){if(O.endsWith("*"))return!0;for(const B of vo)if(B.test(O))return!1;for(const B of _o)if(B.test(O))return!0;return!1}function createDebugger(O){const B=Object.assign((function(...U){if(!B.enabled)return;U.length>0&&(U[0]=`${O} ${U[0]}`);B.log(...U)}),{enabled:enabled(O),destroy,log:So.log,namespace:O,extend});return bo.push(B),B}function destroy(){const O=bo.indexOf(this);return O>=0&&(bo.splice(O,1),!0)}function extend(O){const B=createDebugger(`${this.namespace}:${O}`);return B.log=this.log,B}const Co=So,Eo=new Set,xo="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let To;const wo=Co("azure");wo.log=(...O)=>{Co.log(...O)};const ko=["verbose","info","warning","error"];xo&&(isAzureLogLevel(xo)?function(O){if(O&&!isAzureLogLevel(O))throw new Error(`Unknown log level '${O}'. Acceptable values: ${ko.join(",")}`);To=O;const B=[];for(const O of Eo)shouldEnable(O)&&B.push(O.namespace);Co.enable(B.join(","))}(xo):console.error(`AZURE_LOG_LEVEL set to unknown log level '${xo}'; logging is not enabled. Acceptable values: ${ko.join(", ")}.`));const Ao={verbose:400,info:300,warning:200,error:100};function createClientLogger(O){const B=wo.extend(O);return patchLogMethod(wo,B),{error:createLogger(B,"error"),warning:createLogger(B,"warning"),info:createLogger(B,"info"),verbose:createLogger(B,"verbose")}}function patchLogMethod(O,B){B.log=(...B)=>{O.log(...B)}}function createLogger(O,B){const U=Object.assign(O.extend(B),{level:B});if(patchLogMethod(O,U),shouldEnable(U)){const O=Co.disable();Co.enable(O+","+U.namespace)}return Eo.add(U),U}function shouldEnable(O){return!!(To&&Ao[O.level]<=Ao[To])}function isAzureLogLevel(O){return ko.includes(O)}const Ro=createClientLogger("core-rest-pipeline");const Io=new Set(["Deserialize","Serialize","Retry","Sign"]);class HttpPipeline{constructor(O){var B;this._policies=[],this._policies=null!==(B=null==O?void 0:O.slice(0))&&void 0!==B?B:[],this._orderedPolicies=void 0}addPolicy(O,B={}){if(B.phase&&B.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(B.phase&&!Io.has(B.phase))throw new Error(`Invalid phase name: ${B.phase}`);if(B.afterPhase&&!Io.has(B.afterPhase))throw new Error(`Invalid afterPhase name: ${B.afterPhase}`);this._policies.push({policy:O,options:B}),this._orderedPolicies=void 0}removePolicy(O){const B=[];return this._policies=this._policies.filter((U=>!(O.name&&U.policy.name===O.name||O.phase&&U.options.phase===O.phase)||(B.push(U.policy),!1))),this._orderedPolicies=void 0,B}sendRequest(O,B){return this.getOrderedPolicies().reduceRight(((O,B)=>U=>B.sendRequest(U,O)),(B=>O.sendRequest(B)))(B)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new HttpPipeline(this._policies)}static create(){return new HttpPipeline}orderPolicies(){const O=[],B=new Map;function createPhase(O){return{name:O,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const U=createPhase("Serialize"),G=createPhase("None"),q=createPhase("Deserialize"),j=createPhase("Retry"),W=createPhase("Sign"),Y=[U,G,q,j,W];function getPhase(O){return"Retry"===O?j:"Serialize"===O?U:"Deserialize"===O?q:"Sign"===O?W:G}for(const O of this._policies){const U=O.policy,G=O.options,q=U.name;if(B.has(q))throw new Error("Duplicate policy names not allowed in pipeline");const j={policy:U,dependsOn:new Set,dependants:new Set};G.afterPhase&&(j.afterPhase=getPhase(G.afterPhase),j.afterPhase.hasAfterPolicies=!0),B.set(q,j);getPhase(G.phase).policies.add(j)}for(const O of this._policies){const{policy:U,options:G}=O,q=U.name,j=B.get(q);if(!j)throw new Error(`Missing node for policy ${q}`);if(G.afterPolicies)for(const O of G.afterPolicies){const U=B.get(O);U&&(j.dependsOn.add(U),U.dependants.add(j))}if(G.beforePolicies)for(const O of G.beforePolicies){const U=B.get(O);U&&(U.dependsOn.add(j),j.dependants.add(U))}}function walkPhase(U){U.hasRun=!0;for(const G of U.policies)if((!G.afterPhase||G.afterPhase.hasRun&&!G.afterPhase.policies.size)&&0===G.dependsOn.size){O.push(G.policy);for(const O of G.dependants)O.dependsOn.delete(G);B.delete(G.policy.name),U.policies.delete(G)}}function walkPhases(){for(const O of Y){if(walkPhase(O),O.policies.size>0&&O!==G)return void(G.hasRun||walkPhase(G));O.hasAfterPolicies&&walkPhase(G)}}let K=0;for(;B.size>0;){K++;const B=O.length;if(walkPhases(),O.length<=B&&K>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return O}}const Po="1.10.0";function getUserAgentValue(O){const B=new Map;B.set("core-rest-pipeline",Po),function(O){const B=self.navigator;O.set("OS",(B.oscpu||B.platform).replace(" ",""))}(B);const U=function(O){const B=[];for(const[U,G]of O){const O=G?`${U}/${G}`:U;B.push(O)}return B.join(" ")}(B);return O?`${O} ${U}`:U}const No="x-ms-useragent";new Error("decompressResponsePolicy is not supported in browser environment");class AbortError extends Error{constructor(O){super(O),this.name="AbortError"}}function helpers_delay(O,B,U){return new Promise(((G,q)=>{let j,W;const rejectOnAbort=()=>q(new AbortError((null==U?void 0:U.abortErrorMsg)?null==U?void 0:U.abortErrorMsg:"The operation was aborted.")),removeListeners=()=>{(null==U?void 0:U.abortSignal)&&W&&U.abortSignal.removeEventListener("abort",W)};if(W=()=>(j&&clearTimeout(j),removeListeners(),rejectOnAbort()),(null==U?void 0:U.abortSignal)&&U.abortSignal.aborted)return rejectOnAbort();j=setTimeout((()=>{removeListeners(),G(B)}),O),(null==U?void 0:U.abortSignal)&&U.abortSignal.addEventListener("abort",W)}))}function parseHeaderValueAsNumber(O,B){const U=O.headers.get(B);if(!U)return;const G=Number(U);return Number.isNaN(G)?void 0:G}const Oo="Retry-After",Mo=["retry-after-ms","x-ms-retry-after-ms",Oo];function getRetryAfterInMs(O){if(O&&[429,503].includes(O.status))try{for(const B of Mo){const U=parseHeaderValueAsNumber(O,B);if(0===U||U){return U*(B===Oo?1e3:1)}}const B=O.headers.get(Oo);if(!B)return;const U=Date.parse(B)-Date.now();return Number.isFinite(U)?Math.max(0,U):void 0}catch(O){return}}function exponentialRetryStrategy(O={}){var B,U;const G=null!==(B=O.retryDelayInMs)&&void 0!==B?B:1e3,q=null!==(U=O.maxRetryDelayInMs)&&void 0!==U?U:64e3;let j=G;return{name:"exponentialRetryStrategy",retry({retryCount:B,response:U,responseError:G}){const W=function(O){if(!O)return!1;return"ETIMEDOUT"===O.code||"ESOCKETTIMEDOUT"===O.code||"ECONNREFUSED"===O.code||"ECONNRESET"===O.code||"ENOENT"===O.code}(G),Y=W&&O.ignoreSystemErrors,K=function(O){return Boolean(O&&void 0!==O.status&&(O.status>=500||408===O.status)&&501!==O.status&&505!==O.status)}(U),Q=K&&O.ignoreHttpStatusCodes,Z=U&&(function(O){return Number.isFinite(getRetryAfterInMs(O))}(U)||!K);if(Z||Q||Y)return{skipStrategy:!0};if(G&&!W&&!K)return{errorToThrow:G};const X=j*Math.pow(2,B),J=Math.min(q,X);var ee,te;return j=J/2+(ee=0,te=J/2,ee=Math.ceil(ee),te=Math.floor(te),Math.floor(Math.random()*(te-ee+1))+ee),{retryAfterInMs:j}}}}const Do=createClientLogger("core-rest-pipeline retryPolicy");function retryPolicy(O,B={maxRetries:3}){const U=B.logger||Do;return{name:"retryPolicy",async sendRequest(G,q){var j,W;let Y,K,Q=-1;e:for(;;){Q+=1,Y=void 0,K=void 0;try{U.info(`Retry ${Q}: Attempting to send request`,G.requestId),Y=await q(G),U.info(`Retry ${Q}: Received a response from request`,G.requestId)}catch(O){if(U.error(`Retry ${Q}: Received an error from request`,G.requestId),K=O,!O||"RestError"!==K.name)throw O;Y=K.response}if(null===(j=G.abortSignal)||void 0===j?void 0:j.aborted){U.error(`Retry ${Q}: Request aborted.`);throw new AbortError}if(Q>=(null!==(W=B.maxRetries)&&void 0!==W?W:3)){if(U.info(`Retry ${Q}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),K)throw K;if(Y)return Y;throw new Error("Maximum retries reached with no response or error to throw")}U.info(`Retry ${Q}: Processing ${O.length} retry strategies.`);t:for(const B of O){const O=B.logger||Do;O.info(`Retry ${Q}: Processing retry strategy ${B.name}.`);const U=B.retry({retryCount:Q,response:Y,responseError:K});if(U.skipStrategy){O.info(`Retry ${Q}: Skipped.`);continue t}const{errorToThrow:q,retryAfterInMs:j,redirectTo:W}=U;if(q)throw O.error(`Retry ${Q}: Retry strategy ${B.name} throws error:`,q),q;if(j||0===j){O.info(`Retry ${Q}: Retry strategy ${B.name} retries after ${j}`),await helpers_delay(j,void 0,{abortSignal:G.abortSignal});continue e}if(W){O.info(`Retry ${Q}: Retry strategy ${B.name} redirects to ${W}`),G.url=W;continue e}}if(K)throw U.info("None of the retry strategies could work with the received error. Throwing it."),K;if(Y)return U.info("None of the retry strategies could work with the received response. Returning it."),Y}}}}new Error("proxyPolicy is not supported in browser environment");const Lo={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function createTracingContext(O={}){let B=new TracingContextImpl(O.parentContext);return O.span&&(B=B.setValue(Lo.span,O.span)),O.namespace&&(B=B.setValue(Lo.namespace,O.namespace)),B}class TracingContextImpl{constructor(O){this._contextMap=O instanceof TracingContextImpl?new Map(O._contextMap):new Map}setValue(O,B){const U=new TracingContextImpl(this);return U._contextMap.set(O,B),U}getValue(O){return this._contextMap.get(O)}deleteValue(O){const B=new TracingContextImpl(this);return B._contextMap.delete(O),B}}let Bo;function getInstrumenter(){return Bo||(Bo={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(O,B)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:createTracingContext({parentContext:B.tracingContext})}),withContext:(O,B,...U)=>B(...U)}),Bo}function tracingPolicy(O={}){const B=getUserAgentValue(O.userAgentPrefix),U=function(){try{return function(O){const{namespace:B,packageName:U,packageVersion:G}=O;function startSpan(O,q,j){var W;const Y=getInstrumenter().startSpan(O,Object.assign(Object.assign({},j),{packageName:U,packageVersion:G,tracingContext:null===(W=null==q?void 0:q.tracingOptions)||void 0===W?void 0:W.tracingContext}));let K=Y.tracingContext;const Q=Y.span;return K.getValue(Lo.namespace)||(K=K.setValue(Lo.namespace,B)),Q.setAttribute("az.namespace",K.getValue(Lo.namespace)),{span:Q,updatedOptions:Object.assign({},q,{tracingOptions:Object.assign(Object.assign({},null==q?void 0:q.tracingOptions),{tracingContext:K})})}}function withContext(O,B,...U){return getInstrumenter().withContext(O,B,...U)}return{startSpan,withSpan:async function(O,B,U,G){const{span:q,updatedOptions:j}=startSpan(O,B,G);try{const O=await withContext(j.tracingOptions.tracingContext,(()=>Promise.resolve(U(j,q))));return q.setStatus({status:"success"}),O}catch(O){throw q.setStatus({status:"error",error:O}),O}finally{q.end()}},withContext,parseTraceparentHeader:function(O){return getInstrumenter().parseTraceparentHeader(O)},createRequestHeaders:function(O){return getInstrumenter().createRequestHeaders(O)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Po})}catch(O){return void Ro.warning(`Error when creating the TracingClient: ${error_getErrorMessage(O)}`)}}();return{name:"tracingPolicy",async sendRequest(O,G){var q,j;if(!U||!(null===(q=O.tracingOptions)||void 0===q?void 0:q.tracingContext))return G(O);const{span:W,tracingContext:Y}=null!==(j=function(O,B,U){try{const{span:G,updatedOptions:q}=O.startSpan(`HTTP ${B.method}`,{tracingOptions:B.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":B.method,"http.url":B.url,requestId:B.requestId}});if(!G.isRecording())return void G.end();U&&G.setAttribute("http.user_agent",U);const j=O.createRequestHeaders(q.tracingOptions.tracingContext);for(const[O,U]of Object.entries(j))B.headers.set(O,U);return{span:G,tracingContext:q.tracingOptions.tracingContext}}catch(O){return void Ro.warning(`Skipping creating a tracing span due to an error: ${error_getErrorMessage(O)}`)}}(U,O,B))&&void 0!==j?j:{};if(!W||!Y)return G(O);try{const B=await U.withContext(Y,G,O);return function(O,B){try{O.setAttribute("http.status_code",B.status);const U=B.headers.get("x-ms-request-id");U&&O.setAttribute("serviceRequestId",U),O.setStatus({status:"success"}),O.end()}catch(O){Ro.warning(`Skipping tracing span processing due to an error: ${error_getErrorMessage(O)}`)}}(W,B),B}catch(O){throw function(O,B){try{O.setStatus({status:"error",error:error_isError(B)?B:void 0}),isRestError(B)&&B.statusCode&&O.setAttribute("http.status_code",B.statusCode),O.end()}catch(O){Ro.warning(`Skipping tracing span processing due to an error: ${error_getErrorMessage(O)}`)}}(W,O),O}}}}function createPipelineFromOptions(O){const B=HttpPipeline.create();return B.addPolicy({name:"formDataPolicy",async sendRequest(O,B){if(O.formData){const B=O.formData,U=new FormData;for(const O of Object.keys(B)){const G=B[O];if(Array.isArray(G))for(const B of G)U.append(O,B);else U.append(O,G)}O.body=U,O.formData=void 0;const G=O.headers.get("Content-Type");G&&-1!==G.indexOf("application/x-www-form-urlencoded")?O.body=new URLSearchParams(U).toString():G&&-1!==G.indexOf("multipart/form-data")&&O.headers.delete("Content-Type")}return B(O)}}),B.addPolicy(function(O={}){const B=getUserAgentValue(O.userAgentPrefix);return{name:"userAgentPolicy",sendRequest:async(O,U)=>(O.headers.has(No)||O.headers.set(No,B),U(O))}}(O.userAgentOptions)),B.addPolicy(function(O="x-ms-client-request-id"){return{name:"setClientRequestIdPolicy",sendRequest:async(B,U)=>(B.headers.has(O)||B.headers.set(O,B.requestId),U(B))}}()),B.addPolicy(function(O={}){var B;return{name:"defaultRetryPolicy",sendRequest:retryPolicy([{name:"throttlingRetryStrategy",retry({response:O}){const B=getRetryAfterInMs(O);return Number.isFinite(B)?{retryAfterInMs:B}:{skipStrategy:!0}}},exponentialRetryStrategy(O)],{maxRetries:null!==(B=O.maxRetries)&&void 0!==B?B:3}).sendRequest}}(O.retryOptions),{phase:"Retry"}),B.addPolicy(tracingPolicy(O.userAgentOptions),{afterPhase:"Retry"}),B.addPolicy(function(O={}){var B;const U=null!==(B=O.logger)&&void 0!==B?B:Ro.info,G=new Sanitizer({additionalAllowedHeaderNames:O.additionalAllowedHeaderNames,additionalAllowedQueryParameters:O.additionalAllowedQueryParameters});return{name:"logPolicy",async sendRequest(O,B){if(!U.enabled)return B(O);U(`Request: ${G.sanitize(O)}`);const q=await B(O);return U(`Response status code: ${q.status}`),U(`Headers: ${G.sanitize(q.headers)}`),q}}}(O.loggingOptions),{afterPhase:"Sign"}),B}const Fo={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function createTokenCycler(O,B){let U,G=null,q=null;const j=Object.assign(Object.assign({},Fo),B),W={get isRefreshing(){return null!==G},get shouldRefresh(){var O;return!W.isRefreshing&&(null!==(O=null==q?void 0:q.expiresOnTimestamp)&&void 0!==O?O:0)-j.refreshWindowInMs<Date.now()},get mustRefresh(){return null===q||q.expiresOnTimestamp-j.forcedRefreshWindowInMs<Date.now()}};function refresh(B,Y){var K;if(!W.isRefreshing){G=async function(O,B,U){async function tryGetAccessToken(){if(!(Date.now()<U)){const B=await O();if(null===B)throw new Error("Failed to refresh access token.");return B}try{return await O()}catch(O){return null}}let G=await tryGetAccessToken();for(;null===G;)await helpers_delay(B),G=await tryGetAccessToken();return G}((()=>O.getToken(B,Y)),j.retryIntervalInMs,null!==(K=null==q?void 0:q.expiresOnTimestamp)&&void 0!==K?K:Date.now()).then((O=>(G=null,q=O,U=Y.tenantId,q))).catch((O=>{throw G=null,q=null,U=void 0,O}))}return G}return async(O,B)=>U!==B.tenantId||Boolean(B.claims)||W.mustRefresh?refresh(O,B):(W.shouldRefresh&&refresh(O,B),q)}const zo="bearerTokenAuthenticationPolicy";async function defaultAuthorizeRequest(O){const{scopes:B,getAccessToken:U,request:G}=O,q={abortSignal:G.abortSignal,tracingOptions:G.tracingOptions},j=await U(B,q);j&&O.request.headers.set("Authorization",`Bearer ${j.token}`)}function bearerTokenAuthenticationPolicy(O){var B;const{credential:U,scopes:G,challengeCallbacks:q}=O,j=O.logger||Ro,W=Object.assign({authorizeRequest:null!==(B=null==q?void 0:q.authorizeRequest)&&void 0!==B?B:defaultAuthorizeRequest,authorizeRequestOnChallenge:null==q?void 0:q.authorizeRequestOnChallenge},q),Y=U?createTokenCycler(U):()=>Promise.resolve(null);return{name:zo,async sendRequest(O,B){if(!O.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let U,q;await W.authorizeRequest({scopes:Array.isArray(G)?G:[G],request:O,getAccessToken:Y,logger:j});try{U=await B(O)}catch(O){q=O,U=O.response}if(W.authorizeRequestOnChallenge&&401===(null==U?void 0:U.status)&&function(O){const B=O.headers.get("WWW-Authenticate");if(401===O.status&&B)return B}(U)){if(await W.authorizeRequestOnChallenge({scopes:Array.isArray(G)?G:[G],request:O,response:U,getAccessToken:Y,logger:j}))return B(O)}if(q)throw q;return U}}}function interfaceHelpers_getPathStringFromParameter(O){const{parameterPath:B,mapper:U}=O;let G;return G="string"==typeof B?B:Array.isArray(B)?B.join("."):U.serializedName,G}function serializationPolicy(O={}){const B=O.stringifyXML;return{name:"serializationPolicy",async sendRequest(O,U){const G=getOperationRequestInfo(O),q=null==G?void 0:G.operationSpec,j=null==G?void 0:G.operationArguments;return q&&j&&(function(O,B,U){var G,q;if(U.headerParameters)for(const G of U.headerParameters){let q=operationHelpers_getOperationArgumentValueFromParameter(B,G);if(null!=q||G.mapper.required){q=U.serializer.serialize(G.mapper,q,interfaceHelpers_getPathStringFromParameter(G));const B=G.mapper.headerCollectionPrefix;if(B)for(const U of Object.keys(q))O.headers.set(B+U,q[U]);else O.headers.set(G.mapper.serializedName||interfaceHelpers_getPathStringFromParameter(G),q)}}const j=null===(q=null===(G=B.options)||void 0===G?void 0:G.requestOptions)||void 0===q?void 0:q.customHeaders;if(j)for(const B of Object.keys(j))O.headers.set(B,j[B])}(O,j,q),function(O,B,U,G=function(){throw new Error("XML serialization unsupported!")}){var q,j,W,Y,K;const Q=null===(q=B.options)||void 0===q?void 0:q.serializerOptions,Z={xml:{rootName:null!==(j=null==Q?void 0:Q.xml.rootName)&&void 0!==j?j:"",includeRoot:null!==(W=null==Q?void 0:Q.xml.includeRoot)&&void 0!==W&&W,xmlCharKey:null!==(Y=null==Q?void 0:Q.xml.xmlCharKey)&&void 0!==Y?Y:oo}},X=Z.xml.xmlCharKey;if(U.requestBody&&U.requestBody.mapper){O.body=operationHelpers_getOperationArgumentValueFromParameter(B,U.requestBody);const q=U.requestBody.mapper,{required:j,serializedName:W,xmlName:Y,xmlElementName:Q,xmlNamespace:J,xmlNamespacePrefix:ee,nullable:te}=q,ie=q.type.name;try{if(void 0!==O.body&&null!==O.body||te&&null===O.body||j){const B=interfaceHelpers_getPathStringFromParameter(U.requestBody);O.body=U.serializer.serialize(q,O.body,B,Z);const j=ie===po;if(U.isXML){const B=ee?`xmlns:${ee}`:"xmlns",U=function(O,B,U,G,q){if(O&&!["Composite","Sequence","Dictionary"].includes(U)){const U={};return U[q.xml.xmlCharKey]=G,U[no]={[B]:O},U}return G}(J,B,ie,O.body,Z);ie===lo?O.body=G(function(O,B,U,G){Array.isArray(O)||(O=[O]);if(!U||!G)return{[B]:O};const q={[B]:O};return q[no]={[U]:G},q}(U,Q||Y||W,B,J),{rootName:Y||W,xmlCharKey:X}):j||(O.body=G(U,{rootName:Y||W,xmlCharKey:X}))}else{if(ie===co&&((null===(K=U.contentType)||void 0===K?void 0:K.match("text/plain"))||"text"===U.mediaType))return;j||(O.body=JSON.stringify(O.body))}}}catch(O){throw new Error(`Error "${O.message}" occurred in serializing the payload - ${JSON.stringify(W,void 0,"  ")}.`)}}else if(U.formDataParameters&&U.formDataParameters.length>0){O.formData={};for(const G of U.formDataParameters){const q=operationHelpers_getOperationArgumentValueFromParameter(B,G);if(null!=q){const B=G.mapper.serializedName||interfaceHelpers_getPathStringFromParameter(G);O.formData[B]=U.serializer.serialize(G.mapper,q,interfaceHelpers_getPathStringFromParameter(G),Z)}}}}(O,j,q,B)),U(O)}}}function isReadableStream(O){return Boolean(O&&"function"==typeof O.getReader&&"function"==typeof O.tee)}class FetchHttpClient{async sendRequest(O){if("https:"!==new URL(O.url).protocol&&!O.allowInsecureConnection)throw new Error(`Cannot connect to ${O.url} while allowInsecureConnection is false.`);if(O.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(O){const{abortController:B,abortControllerCleanup:U}=function(O){const B=new AbortController;let U,G;if(O.abortSignal){if(O.abortSignal.aborted)throw new AbortError("The operation was aborted.");G=O=>{"abort"===O.type&&B.abort()},O.abortSignal.addEventListener("abort",G),U=()=>{var B;G&&(null===(B=O.abortSignal)||void 0===B||B.removeEventListener("abort",G))}}O.timeout>0&&setTimeout((()=>{B.abort()}),O.timeout);return{abortController:B,abortControllerCleanup:U}}(O);try{const G=function(O){const B=new Headers;for(const[U,G]of O)B.append(U,G);return B}(O.headers),q=function(O){const B="function"==typeof O.body?O.body():O.body;if(function(O){return O&&"function"==typeof O.pipe}(B))throw new Error("Node streams are not supported in browser environment.");return isReadableStream(B)?buildBodyStream(B,O.onUploadProgress):B}(O);return async function(O,B){var U,G;const q=function(O){const B=createHttpHeaders();for(const[U,G]of O.headers)B.set(U,G);return B}(O),j={request:B,headers:q,status:O.status},W=isReadableStream(O.body)?buildBodyStream(O.body,B.onDownloadProgress):O.body;if((null===(U=B.streamResponseStatusCodes)||void 0===U?void 0:U.has(Number.POSITIVE_INFINITY))||(null===(G=B.streamResponseStatusCodes)||void 0===G?void 0:G.has(j.status)))if(B.enableBrowserStreams)j.browserStreamBody=null!=W?W:void 0;else{const O=new Response(W);j.blobBody=O.blob()}else{const O=new Response(W);j.bodyAsText=await O.text()}return j}(await fetch(O.url,{body:q,method:O.method,headers:G,signal:B.signal,credentials:O.withCredentials?"include":"same-origin",cache:"no-store"}),O)}finally{U&&U()}}(O)}catch(B){throw function(O,B){var U;return O&&"AbortError"===(null==O?void 0:O.name)?O:new restError_RestError(`Error sending request: ${O.message}`,{code:null!==(U=null==O?void 0:O.code)&&void 0!==U?U:restError_RestError.REQUEST_SEND_ERROR,request:B})}(B,O)}}}function buildBodyStream(O,B){let U=0;if(function(O){return void 0!==O.pipeThrough&&void 0!==self.TransformStream}(O))return O.pipeThrough(new TransformStream({transform(O,G){null!==O?(G.enqueue(O),U+=O.length,B&&B({loadedBytes:U})):G.terminate()}}));{const G=O.getReader();return new ReadableStream({async pull(O){var q;const{done:j,value:W}=await G.read();if(j||!W)return O.close(),void G.releaseLock();U+=null!==(q=null==W?void 0:W.length)&&void 0!==q?q:0,O.enqueue(W),B&&B({loadedBytes:U})}})}}function defaultHttpClient_browser_createDefaultHttpClient(){return new FetchHttpClient}let $o;const Uo={CSV:",",SSV:" ",Multi:"Multi",TSV:"\t",Pipes:"|"};function getRequestUrl(O,B,U,G){const q=function(O,B,U){var G;const q=new Map;if(null===(G=O.urlParameters)||void 0===G?void 0:G.length)for(const G of O.urlParameters){let j=operationHelpers_getOperationArgumentValueFromParameter(B,G,U);const W=interfaceHelpers_getPathStringFromParameter(G);j=O.serializer.serialize(G.mapper,j,W),G.skipEncoding||(j=encodeURIComponent(j)),q.set(`{${G.mapper.serializedName||W}}`,j)}return q}(B,U,G);let j=!1,W=urlHelpers_replaceAll(O,q);if(B.path){let O=urlHelpers_replaceAll(B.path,q);"/{nextLink}"===B.path&&O.startsWith("/")&&(O=O.substring(1)),O.includes("://")?(W=O,j=!0):W=function(O,B){if(!B)return O;const U=new URL(O);let G=U.pathname;G.endsWith("/")||(G=`${G}/`);B.startsWith("/")&&(B=B.substring(1));const q=B.indexOf("?");if(-1!==q){const O=B.substring(0,q),j=B.substring(q+1);G+=O,j&&(U.search=U.search?`${U.search}&${j}`:j)}else G+=B;return U.pathname=G,U.toString()}(W,O)}const{queryParams:Y,sequenceParams:K}=function(O,B,U){var G;const q=new Map,j=new Set;if(null===(G=O.queryParameters)||void 0===G?void 0:G.length)for(const G of O.queryParameters){"Sequence"===G.mapper.type.name&&G.mapper.serializedName&&j.add(G.mapper.serializedName);let W=operationHelpers_getOperationArgumentValueFromParameter(B,G,U);if(null!=W||G.mapper.required){W=O.serializer.serialize(G.mapper,W,interfaceHelpers_getPathStringFromParameter(G));const B=G.collectionFormat?Uo[G.collectionFormat]:"";if(Array.isArray(W)&&(W=W.map((O=>null==O?"":O))),"Multi"===G.collectionFormat&&0===W.length)continue;!Array.isArray(W)||"SSV"!==G.collectionFormat&&"TSV"!==G.collectionFormat||(W=W.join(B)),G.skipEncoding||(W=Array.isArray(W)?W.map((O=>encodeURIComponent(O))):encodeURIComponent(W)),!Array.isArray(W)||"CSV"!==G.collectionFormat&&"Pipes"!==G.collectionFormat||(W=W.join(B)),q.set(G.mapper.serializedName||interfaceHelpers_getPathStringFromParameter(G),W)}}return{queryParams:q,sequenceParams:j}}(B,U,G);return W=function(O,B,U,G=!1){if(0===B.size)return O;const q=new URL(O),j=function(O){const B=new Map;if(!O||"?"!==O[0])return B;const U=(O=O.slice(1)).split("&");for(const O of U){const[U,G]=O.split("=",2),q=B.get(U);q?Array.isArray(q)?q.push(G):B.set(U,[q,G]):B.set(U,G)}return B}(q.search);for(const[O,q]of B){const B=j.get(O);if(Array.isArray(B))if(Array.isArray(q)){B.push(...q);const U=new Set(B);j.set(O,Array.from(U))}else B.push(q);else B?(Array.isArray(q)?q.unshift(B):U.has(O)&&j.set(O,[B,q]),G||j.set(O,q)):j.set(O,q)}const W=[];for(const[O,B]of j)if("string"==typeof B)W.push(`${O}=${B}`);else if(Array.isArray(B))for(const U of B)W.push(`${O}=${U}`);else W.push(`${O}=${B}`);return q.search=W.length?`?${W.join("&")}`:"",q.toString()}(W,Y,K,j),W}function urlHelpers_replaceAll(O,B){let U=O;for(const[O,G]of B)U=U.split(O).join(G);return U}const Vo=createClientLogger("core-client");class serviceClient_ServiceClient{constructor(O={}){var B,U;if(this._requestContentType=O.requestContentType,this._endpoint=null!==(B=O.endpoint)&&void 0!==B?B:O.baseUri,O.baseUri&&Vo.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=O.allowInsecureConnection,this._httpClient=O.httpClient||($o||($o=defaultHttpClient_browser_createDefaultHttpClient()),$o),this.pipeline=O.pipeline||function(O){const B=function(O){if(O.credentialScopes){const B=O.credentialScopes;return Array.isArray(B)?B.map((O=>new URL(O).toString())):new URL(B).toString()}if(O.endpoint)return`${O.endpoint}/.default`;if(O.baseUri)return`${O.baseUri}/.default`;if(O.credential&&!O.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy");return}(O),U=O.credential&&B?{credentialScopes:B,credential:O.credential}:void 0;return function(O={}){const B=createPipelineFromOptions(null!=O?O:{});return O.credentialOptions&&B.addPolicy(bearerTokenAuthenticationPolicy({credential:O.credentialOptions.credential,scopes:O.credentialOptions.credentialScopes})),B.addPolicy(serializationPolicy(O.serializationOptions),{phase:"Serialize"}),B.addPolicy(deserializationPolicy_deserializationPolicy(O.deserializationOptions),{phase:"Deserialize"}),B}(Object.assign(Object.assign({},O),{credentialOptions:U}))}(O),null===(U=O.additionalPolicies)||void 0===U?void 0:U.length)for(const{policy:B,position:U}of O.additionalPolicies){const O="perRetry"===U?"Sign":void 0;this.pipeline.addPolicy(B,{afterPhase:O})}}async sendRequest(O){return this.pipeline.sendRequest(this._httpClient,O)}async sendOperationRequest(O,B){const U=B.baseUrl||this._endpoint;if(!U)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const G=function(O){return new PipelineRequestImpl(O)}({url:getRequestUrl(U,B,O,this)});G.method=B.httpMethod;const q=getOperationRequestInfo(G);q.operationSpec=B,q.operationArguments=O;const j=B.contentType||this._requestContentType;j&&B.requestBody&&G.headers.set("Content-Type",j);const W=O.options;if(W){const O=W.requestOptions;O&&(O.timeout&&(G.timeout=O.timeout),O.onUploadProgress&&(G.onUploadProgress=O.onUploadProgress),O.onDownloadProgress&&(G.onDownloadProgress=O.onDownloadProgress),void 0!==O.shouldDeserialize&&(q.shouldDeserialize=O.shouldDeserialize),O.allowInsecureConnection&&(G.allowInsecureConnection=!0)),W.abortSignal&&(G.abortSignal=W.abortSignal),W.tracingOptions&&(G.tracingOptions=W.tracingOptions)}this._allowInsecureConnection&&(G.allowInsecureConnection=!0),void 0===G.streamResponseStatusCodes&&(G.streamResponseStatusCodes=function(O){const B=new Set;for(const U in O.responses){const G=O.responses[U];G.bodyMapper&&G.bodyMapper.type.name===po&&B.add(Number(U))}return B}(B));try{const O=await this.sendRequest(G),U=utils_flattenResponse(O,B.responses[O.status]);return(null==W?void 0:W.onResponse)&&W.onResponse(O,U),U}catch(O){if("object"==typeof O&&(null==O?void 0:O.response)){const U=O.response,G=utils_flattenResponse(U,B.responses[O.statusCode]||B.responses.default);O.details=G,(null==W?void 0:W.onResponse)&&W.onResponse(U,G,O)}throw O}}}async function authorizeRequestOnClaimChallenge(O){const{scopes:B,response:U}=O,G=O.logger||Vo,q=U.headers.get("WWW-Authenticate");if(!q)return G.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;const j=function(O){return`, ${O.trim()}`.split(", Bearer ").filter((O=>O)).map((O=>{const B=`${O.trim()}, `.split('", ').filter((O=>O)).map((O=>(([O,B])=>({[O]:B}))(O.trim().split('="'))));return B.reduce(((O,B)=>Object.assign(Object.assign({},O),B)),{})}))}(q)||[],W=j.find((O=>O.claims));if(!W)return G.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;const Y=await O.getAccessToken(W.scope?[W.scope]:B,{claims:decodeStringToString(W.claims)});return!!Y&&(O.request.headers.set("Authorization",`Bearer ${Y.token}`),!0)}const Go={type:{name:"Composite",className:"CreateCompletionRequest",modelProperties:{model:{serializedName:"model",type:{name:"String"}},prompt:{defaultValue:"",serializedName:"prompt",nullable:!0,type:{name:"String"}},suffix:{serializedName:"suffix",nullable:!0,type:{name:"String"}},maxTokens:{defaultValue:16,constraints:{InclusiveMinimum:0},serializedName:"max_tokens",nullable:!0,type:{name:"Number"}},temperature:{defaultValue:1,constraints:{InclusiveMaximum:2,InclusiveMinimum:0},serializedName:"temperature",nullable:!0,type:{name:"Number"}},topP:{defaultValue:1,constraints:{InclusiveMaximum:1,InclusiveMinimum:0},serializedName:"top_p",nullable:!0,type:{name:"Number"}},n:{defaultValue:1,constraints:{InclusiveMaximum:128,InclusiveMinimum:1},serializedName:"n",nullable:!0,type:{name:"Number"}},stream:{defaultValue:!1,serializedName:"stream",nullable:!0,type:{name:"Boolean"}},logprobs:{constraints:{InclusiveMaximum:5,InclusiveMinimum:0},serializedName:"logprobs",nullable:!0,type:{name:"Number"}},echo:{defaultValue:!1,serializedName:"echo",nullable:!0,type:{name:"Boolean"}},stop:{serializedName:"stop",type:{name:"Composite",className:"CreateCompletionRequestStop"}},presencePenalty:{defaultValue:0,constraints:{InclusiveMaximum:2,InclusiveMinimum:-2},serializedName:"presence_penalty",nullable:!0,type:{name:"Number"}},frequencyPenalty:{defaultValue:0,constraints:{InclusiveMaximum:2,InclusiveMinimum:-2},serializedName:"frequency_penalty",nullable:!0,type:{name:"Number"}},bestOf:{defaultValue:1,constraints:{InclusiveMaximum:20,InclusiveMinimum:0},serializedName:"best_of",nullable:!0,type:{name:"Number"}},logitBias:{serializedName:"logit_bias",nullable:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}},user:{serializedName:"user",type:{name:"String"}}}}},Ho={type:{name:"Composite",className:"CreateCompletionRequestStop"}},qo={type:{name:"Composite",className:"CreateCompletionResponse",modelProperties:{id:{serializedName:"id",type:{name:"String"}},object:{serializedName:"object",type:{name:"String"}},created:{serializedName:"created",type:{name:"Number"}},model:{serializedName:"model",type:{name:"String"}},choices:{serializedName:"choices",type:{name:"Sequence",element:{type:{name:"Composite",className:"CreateCompletionResponseChoicesItem"}}}}}}},jo={type:{name:"Composite",className:"CreateCompletionResponseChoicesItem",modelProperties:{text:{serializedName:"text",type:{name:"String"}},index:{serializedName:"index",type:{name:"Number"}},logprobs:{serializedName:"logprobs",type:{name:"Composite",className:"CreateCompletionResponseChoicesItemLogprobs"}},finishReason:{serializedName:"finish_reason",type:{name:"String"}}}}},Wo={type:{name:"Composite",className:"CreateCompletionResponseChoicesItemLogprobs",modelProperties:{tokens:{serializedName:"tokens",type:{name:"Sequence",element:{type:{name:"String"}}}},tokenLogprobs:{serializedName:"token_logprobs",type:{name:"Sequence",element:{type:{name:"Number"}}}},topLogprobs:{serializedName:"top_logprobs",type:{name:"Sequence",element:{type:{name:"Dictionary",value:{type:{name:"any"}}}}}},textOffset:{serializedName:"text_offset",type:{name:"Sequence",element:{type:{name:"Number"}}}}}}},Yo={parameterPath:"body",mapper:Go};class CompletionImpl{constructor(O){this.client=O}create(O,B){return this.client.sendOperationRequest({body:O,options:B},Qo)}}const Ko=createSerializer(q,!1),Qo={path:"/completions",httpMethod:"POST",responses:{200:{bodyMapper:qo}},requestBody:Yo,urlParameters:[{parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0}],headerParameters:[{parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},{parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}}],mediaType:"json",serializer:Ko};class OpenAIAPI extends serviceClient_ServiceClient{constructor(O){var B,U;O||(O={});const G="azsdk-js-api-client-factory/1.0.0-beta.1",q=O.userAgentOptions&&O.userAgentOptions.userAgentPrefix?`${O.userAgentOptions.userAgentPrefix} ${G}`:`${G}`,j={requestContentType:"application/json; charset=utf-8",...O,userAgentOptions:{userAgentPrefix:q},baseUri:null!==(U=null!==(B=O.endpoint)&&void 0!==B?B:O.baseUri)&&void 0!==U?U:"https://api.openai.com/v1"};if(super(j),(null==O?void 0:O.pipeline)&&O.pipeline.getOrderedPolicies().length>0){O.pipeline.getOrderedPolicies().some((O=>O.name===zo))||(this.pipeline.removePolicy({name:zo}),this.pipeline.addPolicy(bearerTokenAuthenticationPolicy({scopes:`${j.baseUri}/.default`,challengeCallbacks:{authorizeRequestOnChallenge:authorizeRequestOnClaimChallenge}})))}this.$host=O.$host||"https://api.openai.com/v1",this.completion=new CompletionImpl(this)}}const Zo={type:{name:"Composite",className:"AutoSuggestResultModel",modelProperties:{url:{serializedName:"url",type:{name:"String"}},displayText:{serializedName:"displayText",type:{name:"String"}},query:{serializedName:"query",type:{name:"String"}},searchKind:{serializedName:"searchKind",type:{name:"String"}},order:{serializedName:"order",type:{name:"Number"}}}}},Xo={type:{name:"Composite",className:"FaceRectangle",modelProperties:{height:{serializedName:"height",type:{name:"Number"}},width:{serializedName:"width",type:{name:"Number"}},top:{serializedName:"top",type:{name:"Number"}},left:{serializedName:"left",type:{name:"Number"}}}}},Jo={type:{name:"Composite",className:"EmulatorConfig",modelProperties:{id:{serializedName:"id",type:{name:"String"}},dataType:{serializedName:"dataType",type:{name:"String"}},logId:{serializedName:"logId",nullable:!0,type:{name:"String"}},logLevel:{serializedName:"logLevel",type:{name:"String"}},topicFilter:{serializedName:"topicFilter",type:{name:"String"}},logTopics:{serializedName:"logTopics",nullable:!0,type:{name:"Sequence",element:{type:{name:"String"}}}},routerLogId:{serializedName:"routerLogId",nullable:!0,type:{name:"String"}},routerLogLevel:{serializedName:"routerLogLevel",type:{name:"String"}},routerTopicFilter:{serializedName:"routerTopicFilter",type:{name:"String"}},routerLogTopics:{serializedName:"routerLogTopics",nullable:!0,type:{name:"Sequence",element:{type:{name:"String"}}}},controllerLogId:{serializedName:"controllerLogId",nullable:!0,type:{name:"String"}},controllerLogLevel:{serializedName:"controllerLogLevel",type:{name:"String"}},controllerTopicFilter:{serializedName:"controllerTopicFilter",type:{name:"String"}},controllerLogTopics:{serializedName:"controllerLogTopics",nullable:!0,type:{name:"Sequence",element:{type:{name:"String"}}}},createController:{serializedName:"createController",nullable:!0,type:{name:"Boolean"}},syncHost:{serializedName:"syncHost",nullable:!0,type:{name:"String"}},syncPort:{serializedName:"syncPort",nullable:!0,type:{name:"String"}},logoUrl:{serializedName:"logoUrl",nullable:!0,type:{name:"String"}},resizeMode:{serializedName:"resizeMode",type:{name:"String"}},minGlobalScaleFactor:{serializedName:"minGlobalScaleFactor",nullable:!0,type:{name:"Number"}},maxGlobalScaleFactor:{serializedName:"maxGlobalScaleFactor",nullable:!0,type:{name:"Number"}},deviceSpacing:{serializedName:"deviceSpacing",nullable:!0,type:{name:"Number"}},outerMarginTop:{serializedName:"outerMarginTop",nullable:!0,type:{name:"Number"}},outerMarginRight:{serializedName:"outerMarginRight",nullable:!0,type:{name:"Number"}},outerMarginBottom:{serializedName:"outerMarginBottom",nullable:!0,type:{name:"Number"}},outerMarginLeft:{serializedName:"outerMarginLeft",nullable:!0,type:{name:"Number"}},allowFullScreenMode:{serializedName:"allowFullScreenMode",nullable:!0,type:{name:"Boolean"}},allowFullMenu:{serializedName:"allowFullMenu",nullable:!0,type:{name:"Boolean"}},availableDevices:{serializedName:"availableDevices",nullable:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"DeviceConfig"}}}},backdropMode:{serializedName:"backdropMode",type:{name:"String"}},backdropSource:{serializedName:"backdropSource",nullable:!0,type:{name:"String"}},timelineCurrent:{serializedName:"timelineCurrent",nullable:!0,type:{name:"String"}},timelineStart:{serializedName:"timelineStart",nullable:!0,type:{name:"String"}},timelineEnd:{serializedName:"timelineEnd",nullable:!0,type:{name:"String"}},timelineSegments:{serializedName:"timelineSegments",nullable:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"TimelineSegmentConfig"}}}}}}},ea={type:{name:"Composite",className:"DeviceConfig",modelProperties:{id:{serializedName:"id",nullable:!0,type:{name:"String"}},policyProvider:{serializedName:"policyProvider",type:{name:"Enum",allowedValues:["Windows10","Windows11","Windows12","Other"]}},showDevice:{serializedName:"showDevice",nullable:!0,type:{name:"Boolean"}},projectId:{serializedName:"projectId",nullable:!0,type:{name:"Number"}},deviceScale:{serializedName:"deviceScale",nullable:!0,type:{name:"Number"}},useCounterRotation:{serializedName:"useCounterRotation",nullable:!0,type:{name:"Boolean"}},defaultRotation:{serializedName:"defaultRotation",type:{name:"String"}},allowedRotations:{serializedName:"allowedRotations",nullable:!0,type:{name:"Sequence",element:{type:{name:"String"}}}},defaultLayout:{serializedName:"defaultLayout",type:{name:"String"}},allowedLayouts:{serializedName:"allowedLayouts",nullable:!0,type:{name:"Sequence",element:{type:{name:"String"}}}},activeScreenTiles:{serializedName:"activeScreenTiles",nullable:!0,type:{name:"Number"}},allowAddRemoveScreenTiles:{serializedName:"allowAddRemoveScreenTiles",nullable:!0,type:{name:"Boolean"}},maxScreenTiles:{serializedName:"maxScreenTiles",nullable:!0,type:{name:"Number"}},dualScreenGap:{serializedName:"dualScreenGap",nullable:!0,type:{name:"Number"}},selectionIndicatorYOffset:{serializedName:"selectionIndicatorYOffset",nullable:!0,type:{name:"Number"}},cornerRadius:{serializedName:"cornerRadius",nullable:!0,type:{name:"Number"}},defaultScreenWidth:{serializedName:"defaultScreenWidth",nullable:!0,type:{name:"Number"}},defaultScreenHeight:{serializedName:"defaultScreenHeight",nullable:!0,type:{name:"Number"}},showOptionsPane:{serializedName:"showOptionsPane",nullable:!0,type:{name:"Boolean"}},screenContentUrls:{serializedName:"screenContentUrls",nullable:!0,type:{name:"Sequence",element:{type:{name:"String"}}}},isLargeScreen:{serializedName:"isLargeScreen",nullable:!0,type:{name:"Boolean"}},autoGenerateScreenQueryString:{serializedName:"autoGenerateScreenQueryString",nullable:!0,type:{name:"Boolean"}},allowFullOSMode:{serializedName:"allowFullOSMode",nullable:!0,type:{name:"Boolean"}},useGlobalSync:{serializedName:"useGlobalSync",nullable:!0,type:{name:"Boolean"}},showShadows:{serializedName:"showShadows",nullable:!0,type:{name:"Boolean"}},frameBackgroundColor:{serializedName:"frameBackgroundColor",nullable:!0,type:{name:"String"}},allowSleepMode:{serializedName:"allowSleepMode",nullable:!0,type:{name:"Boolean"}},allowComposeMode:{serializedName:"allowComposeMode",nullable:!0,type:{name:"Boolean"}},allowPenMode:{serializedName:"allowPenMode",nullable:!0,type:{name:"Boolean"}},chrome:{serializedName:"chrome",nullable:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"DeviceChromeLayer"}}}}}}},ta={type:{name:"Composite",className:"DeviceChromeLayer",modelProperties:{mode:{serializedName:"mode",type:{name:"String"}},source:{serializedName:"source",nullable:!0,type:{name:"String"}},width:{serializedName:"width",nullable:!0,type:{name:"String"}},height:{serializedName:"height",nullable:!0,type:{name:"String"}},transform:{serializedName:"transform",nullable:!0,type:{name:"String"}},cornerRadius:{serializedName:"cornerRadius",nullable:!0,type:{name:"String"}},offsetTop:{serializedName:"offsetTop",nullable:!0,type:{name:"Number"}},offsetBottom:{serializedName:"offsetBottom",nullable:!0,type:{name:"Number"}},offsetLeft:{serializedName:"offsetLeft",nullable:!0,type:{name:"Number"}},offsetRight:{serializedName:"offsetRight",nullable:!0,type:{name:"Number"}},zIndex:{serializedName:"zIndex",nullable:!0,type:{name:"Number"}}}}},ia={type:{name:"Composite",className:"TimelineSegmentConfig",modelProperties:{endTime:{serializedName:"endTime",nullable:!0,type:{name:"String"}},visibleDevices:{serializedName:"visibleDevices",nullable:!0,type:{name:"Sequence",element:{type:{name:"String"}}}}}}},ra={type:{name:"Composite",className:"PrevalentColorSelectRequestModel",modelProperties:{input:{serializedName:"input",type:{name:"Sequence",element:{type:{name:"Composite",className:"QuantizedColor"}}}},config:{serializedName:"config",type:{name:"Composite",className:"PrevalentColorSelectorConfig"}}}}},na={type:{name:"Composite",className:"QuantizedColor",modelProperties:{count:{serializedName:"count",type:{name:"Number"}},color:{serializedName:"color",type:{name:"String"}}}}},oa={type:{name:"Composite",className:"PrevalentColorSelectorConfig",modelProperties:{textSelectionMode:{serializedName:"textSelectionMode",type:{name:"Enum",allowedValues:["PreferedOnly","AlternateOnly","BestContrast","PreferedUnlessLightImage","PreferedUnlessDarkImage","AlternateUnlessLightImage","AlternateUnlessDarkImage"]}},preferedTextColor:{serializedName:"preferedTextColor",type:{name:"Composite",className:"NormalizedRGB"}},alternateTextColor:{serializedName:"alternateTextColor",type:{name:"Composite",className:"NormalizedRGB"}},lightColorThreshold:{serializedName:"lightColorThreshold",type:{name:"Number"}},lightImageThreshold:{serializedName:"lightImageThreshold",type:{name:"Number"}},darkColorThreshold:{serializedName:"darkColorThreshold",type:{name:"Number"}},darkImageThreshold:{serializedName:"darkImageThreshold",type:{name:"Number"}},hslPreFilters:{serializedName:"hslPreFilters",type:{name:"Sequence",element:{type:{name:"Composite",className:"HSLFilter"}}}},hslfilters:{serializedName:"hslfilters",type:{name:"Sequence",element:{type:{name:"Composite",className:"HSLFilter"}}}},saturatedRedPreFilter:{serializedName:"saturatedRedPreFilter",type:{name:"Composite",className:"HSLFilter"}},preferedTextHSLFilter:{serializedName:"preferedTextHSLFilter",type:{name:"Composite",className:"HSLFilter"}},alternateTextHSLFilter:{serializedName:"alternateTextHSLFilter",type:{name:"Composite",className:"HSLFilter"}},brownFilter:{serializedName:"brownFilter",type:{name:"Composite",className:"HSLFilter"}},gradientSearchMode:{serializedName:"gradientSearchMode",type:{name:"Enum",allowedValues:["Lighter","Darker","Alternating"]}},gradientSteps:{serializedName:"gradientSteps",type:{name:"Number"}},lighterGradientSearch:{serializedName:"lighterGradientSearch",type:{name:"Sequence",element:{type:{name:"Number"}}}},darkerGradientSearch:{serializedName:"darkerGradientSearch",type:{name:"Sequence",element:{type:{name:"Number"}}}},alternatingGradientSearch:{serializedName:"alternatingGradientSearch",type:{name:"Sequence",element:{type:{name:"Number"}}}},contrastRequirements:{serializedName:"contrastRequirements",type:{name:"Sequence",element:{type:{name:"Composite",className:"ContrastRequirement"}}}},checkSemiOpaqueContrast:{serializedName:"checkSemiOpaqueContrast",type:{name:"Boolean"}},semiOpaqueContrast:{serializedName:"semiOpaqueContrast",type:{name:"Number"}},requiredTextContrast:{serializedName:"requiredTextContrast",type:{name:"Number"}}}}},aa={type:{name:"Composite",className:"NormalizedRGB",modelProperties:{r:{serializedName:"r",type:{name:"Number"}},g:{serializedName:"g",type:{name:"Number"}},b:{serializedName:"b",type:{name:"Number"}}}}},sa={type:{name:"Composite",className:"HSLFilter",modelProperties:{id:{serializedName:"id",type:{name:"String"}},invert:{serializedName:"invert",nullable:!0,type:{name:"Boolean"}},minH:{serializedName:"minH",nullable:!0,type:{name:"Number"}},maxH:{serializedName:"maxH",nullable:!0,type:{name:"Number"}},minS:{serializedName:"minS",nullable:!0,type:{name:"Number"}},maxS:{serializedName:"maxS",nullable:!0,type:{name:"Number"}},minL:{serializedName:"minL",nullable:!0,type:{name:"Number"}},maxL:{serializedName:"maxL",nullable:!0,type:{name:"Number"}}}}},la={type:{name:"Composite",className:"ContrastRequirement",modelProperties:{id:{serializedName:"id",type:{name:"String"}},ratio:{serializedName:"ratio",type:{name:"Number"}},mode:{serializedName:"mode",type:{name:"Enum",allowedValues:["Both","PreferedTextOnly","AlternateTextOnly"]}},color:{serializedName:"color",type:{name:"Composite",className:"NormalizedRGB"}}}}},ca={type:{name:"Composite",className:"PrevalentColorSelectorOutput",modelProperties:{chosenColor:{serializedName:"chosenColor",type:{name:"Composite",className:"QuantizedColor"}},preferedTextColorContrast:{serializedName:"preferedTextColorContrast",nullable:!0,type:{name:"Number"}},alternateTextColorContrast:{serializedName:"alternateTextColorContrast",nullable:!0,type:{name:"Number"}},isLightImage:{serializedName:"isLightImage",type:{name:"Boolean"}},isDarkImage:{serializedName:"isDarkImage",type:{name:"Boolean"}},useAlternateTextColor:{serializedName:"useAlternateTextColor",type:{name:"Boolean"}},preferedTextColor:{serializedName:"preferedTextColor",type:{name:"Composite",className:"NormalizedRGB"}},alternateTextColor:{serializedName:"alternateTextColor",type:{name:"Composite",className:"NormalizedRGB"}}}}},da={type:{name:"Composite",className:"SerializableDecorateBitmapRequestModel",modelProperties:{decoratorConfig:{serializedName:"DecoratorConfig",type:{name:"Composite",className:"SerializableBitmapDecoratorConfig"}},images:{serializedName:"Images",type:{name:"Sequence",element:{type:{name:"Dictionary",value:{type:{name:"any"}}}}}}}}},pa={type:{name:"Composite",className:"SerializableBitmapDecoratorConfig",modelProperties:{backgroundSource:{serializedName:"BackgroundSource",type:{name:"String"}},decoratorProfiles:{serializedName:"DecoratorProfiles",type:{name:"Sequence",element:{type:{name:"Composite",className:"BitmapDecoratorProfileConfigModel"}}}}}}},ua={type:{name:"Composite",className:"BitmapDecoratorProfileConfigModel",modelProperties:{decoratorSource:{serializedName:"DecoratorSource",type:{name:"String"}},searchMode:{serializedName:"SearchMode",type:{name:"Number"}},searchSpacing:{serializedName:"SearchSpacing",type:{name:"Number"}},overlapForMatchMin:{serializedName:"OverlapForMatchMin",type:{name:"Number"}},overlapForMatchMax:{serializedName:"OverlapForMatchMax",type:{name:"Number"}},topRatio:{serializedName:"TopRatio",type:{name:"Number"}},angleStep:{serializedName:"AngleStep",type:{name:"Number"}},maxAngleSearch:{serializedName:"MaxAngleSearch",type:{name:"Number"}}}}},ha={type:{name:"Composite",className:"PathsLllj53ImageservicesDecoratebitmapPostResponses200ContentApplicationJsonSchema"}},ma={type:{name:"Composite",className:"MicrosoftGraphEntity",modelProperties:{id:{serializedName:"id",type:{name:"String"}}}}},ga={type:{name:"Composite",className:"PersonaPasswordProfile",modelProperties:{password:{serializedName:"password",nullable:!0,type:{name:"String"}},forceChangePasswordNextSignIn:{serializedName:"forceChangePasswordNextSignIn",nullable:!0,type:{name:"Boolean"}}}}},fa={type:{name:"Composite",className:"PersonaPhoto",modelProperties:{id:{serializedName:"id",nullable:!0,type:{name:"String"}},height:{constraints:{InclusiveMaximum:2147483647,InclusiveMinimum:-2147483648},serializedName:"height",nullable:!0,type:{name:"Number"}},width:{constraints:{InclusiveMaximum:2147483647,InclusiveMinimum:-2147483648},serializedName:"width",nullable:!0,type:{name:"Number"}},url:{serializedName:"url",nullable:!0,type:{name:"String"}}}}},ya={type:{name:"Composite",className:"TypedResource",modelProperties:{deletedDateTime:{serializedName:"deletedDateTime",nullable:!0,type:{name:"DateTime"}},etag:{serializedName:"_etag",nullable:!0,type:{name:"String"}},id:{serializedName:"id",type:{name:"String"}},isArchived:{serializedName:"isArchived",type:{name:"Boolean"}}}}},_a={type:{name:"Composite",className:"NetCoreErrorResponse",modelProperties:{type:{serializedName:"type",type:{name:"String"}},title:{serializedName:"title",type:{name:"String"}},status:{serializedName:"status",type:{name:"Number"}},traceId:{serializedName:"traceId",type:{name:"String"}}}}},va={type:{name:"Composite",className:"ApplicationData",modelProperties:{appName:{serializedName:"appName",type:{name:"String"}},appData:{serializedName:"appData",type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},ba={type:{name:"Composite",className:"PersonaProfileShortcuts",modelProperties:{desktop:{serializedName:"desktop",type:{name:"Sequence",element:{type:{name:"Composite",className:"Shortcut"}}}},taskbar:{serializedName:"taskbar",type:{name:"Sequence",element:{type:{name:"Composite",className:"Shortcut"}}}},startMenu:{serializedName:"startMenu",type:{name:"Sequence",element:{type:{name:"Composite",className:"Shortcut"}}}},suggested:{serializedName:"suggested",type:{name:"Sequence",element:{type:{name:"Composite",className:"SuggestedShortcut"}}}}}}},Sa={type:{name:"Composite",className:"Shortcut",modelProperties:{shortcutTargetUrn:{serializedName:"shortcutTargetUrn",nullable:!0,type:{name:"String"}},displayIndex:{serializedName:"displayIndex",nullable:!0,type:{name:"Number"}},timestamp:{serializedName:"timestamp",nullable:!0,type:{name:"String"}}}}},Ca={type:{name:"Composite",className:"PersonaProfileWallpaper",modelProperties:{imageLight:{serializedName:"imageLight",nullable:!0,type:{name:"String"}},imageDark:{serializedName:"imageDark",nullable:!0,type:{name:"String"}},thumbnailLight:{serializedName:"thumbnailLight",nullable:!0,type:{name:"String"}},thumbnailDark:{serializedName:"thumbnailDark",nullable:!0,type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["dog","gmunk","default"]}}}}},Ea={type:{name:"Composite",className:"TwoHundredBooleanResponse",modelProperties:{result:{serializedName:"result",required:!0,readOnly:!0,type:{name:"Boolean"}}}}},xa={type:{name:"Composite",className:"ScenarioSwitch",modelProperties:{id:{serializedName:"id",type:{name:"Number"}},name:{serializedName:"name",nullable:!0,type:{name:"String"}},isDefault:{serializedName:"isDefault",type:{name:"Boolean"}}}}},Ta={type:{name:"Composite",className:"TwoHundredStringResponse",modelProperties:{result:{serializedName:"result",required:!0,readOnly:!0,type:{name:"String"}}}}},wa={type:{name:"Composite",className:"AuthTokenViewModel",modelProperties:{id:{serializedName:"id",nullable:!0,type:{name:"String"}},userId:{serializedName:"userId",nullable:!0,type:{name:"String"}}}}},ka={type:{name:"Composite",className:"CosmosPermission",modelProperties:{id:{serializedName:"id",type:{name:"String"}},permissionMode:{serializedName:"permissionMode",type:{name:"String"}},resource:{serializedName:"resource",type:{name:"String"}},token:{serializedName:"_token",type:{name:"String"}},ts:{serializedName:"_ts",type:{name:"Number"}}}}},Aa={type:{name:"Composite",className:"CosmosUser",modelProperties:{id:{constraints:{MaxLength:255},serializedName:"id",type:{name:"String"}},permissions:{serializedName:"_permissions",type:{name:"String"}},ts:{serializedName:"_ts",type:{name:"Number"}}}}},Ra={type:{name:"Composite",className:"Role",modelProperties:{roleId:{serializedName:"roleId",type:{name:"Number"}},roleName:{serializedName:"roleName",type:{name:"String"}},isEnabled:{serializedName:"isEnabled",type:{name:"Boolean"}}}}},Ia={type:{name:"Composite",className:"Paths1Tn5QkaProxiedApinameEndpointPostRequestbodyContentApplicationOctetStreamSchema"}},Pa={type:{name:"Composite",className:"PathsYv268WProxiedApinameEndpointPostResponses200ContentApplicationOctetStreamSchema"}},Na={type:{name:"Composite",className:"MicrosoftGraphDirectoryObject",modelProperties:{...ma.type.modelProperties,deletedDateTime:{serializedName:"deletedDateTime",nullable:!0,type:{name:"DateTime"}}}}},Oa={type:{name:"Composite",className:"Persona",modelProperties:{...ya.type.modelProperties,aboutMe:{serializedName:"aboutMe",nullable:!0,type:{name:"String"}},accountEnabled:{serializedName:"accountEnabled",type:{name:"Boolean"}},ageGroup:{serializedName:"ageGroup",nullable:!0,type:{name:"String"}},birthday:{serializedName:"birthday",nullable:!0,type:{name:"DateTime"}},businessPhones:{serializedName:"businessPhones",type:{name:"Sequence",element:{type:{name:"String"}}}},city:{serializedName:"city",nullable:!0,type:{name:"String"}},companyName:{serializedName:"companyName",nullable:!0,type:{name:"String"}},consentProvidedForMinor:{serializedName:"consentProvidedForMinor",nullable:!0,type:{name:"String"}},country:{serializedName:"country",nullable:!0,type:{name:"String"}},createdDateTime:{serializedName:"createdDateTime",nullable:!0,type:{name:"DateTime"}},createdObjects:{serializedName:"createdObjects",type:{name:"Sequence",element:{type:{name:"Composite",className:"MicrosoftGraphDirectoryObject"}}}},creationType:{serializedName:"creationType",nullable:!0,type:{name:"String"}},department:{serializedName:"department",nullable:!0,type:{name:"String"}},deviceEnrollmentLimit:{constraints:{InclusiveMaximum:2147483647,InclusiveMinimum:-2147483648},serializedName:"deviceEnrollmentLimit",type:{name:"Number"}},directReports:{serializedName:"directReports",type:{name:"Sequence",element:{type:{name:"Composite",className:"MicrosoftGraphDirectoryObject"}}}},displayName:{serializedName:"displayName",type:{name:"String"}},employeeHireDate:{serializedName:"employeeHireDate",nullable:!0,type:{name:"DateTime"}},employeeId:{serializedName:"employeeId",nullable:!0,type:{name:"String"}},employeeType:{serializedName:"employeeType",nullable:!0,type:{name:"String"}},externalUserState:{serializedName:"externalUserState",nullable:!0,type:{name:"String"}},externalUserStateChangeDateTime:{serializedName:"externalUserStateChangeDateTime",nullable:!0,type:{name:"DateTime"}},faxNumber:{serializedName:"faxNumber",nullable:!0,type:{name:"String"}},givenName:{serializedName:"givenName",nullable:!0,type:{name:"String"}},hireDate:{serializedName:"hireDate",type:{name:"DateTime"}},imAddresses:{serializedName:"imAddresses",type:{name:"Sequence",element:{type:{name:"String"}}}},interests:{serializedName:"interests",nullable:!0,type:{name:"String"}},isResourceAccount:{serializedName:"isResourceAccount",type:{name:"Boolean"}},jobTitle:{serializedName:"jobTitle",nullable:!0,type:{name:"String"}},lastPasswordChangeDateTime:{serializedName:"lastPasswordChangeDateTime",nullable:!0,type:{name:"DateTime"}},legalAgeGroupClassification:{serializedName:"legalAgeGroupClassification",nullable:!0,type:{name:"String"}},mail:{serializedName:"mail",nullable:!0,type:{name:"String"}},mailNickname:{serializedName:"mailNickname",nullable:!0,type:{name:"String"}},manager:{serializedName:"manager",type:{name:"Composite",className:"MicrosoftGraphDirectoryObject"}},memberOf:{serializedName:"memberOf",type:{name:"Sequence",element:{type:{name:"Composite",className:"MicrosoftGraphDirectoryObject"}}}},mobilePhone:{serializedName:"mobilePhone",nullable:!0,type:{name:"String"}},mySite:{serializedName:"mySite",nullable:!0,type:{name:"String"}},officeLocation:{serializedName:"officeLocation",nullable:!0,type:{name:"String"}},otherMails:{serializedName:"otherMails",type:{name:"Sequence",element:{type:{name:"String"}}}},ownedDevices:{serializedName:"ownedDevices",type:{name:"Sequence",element:{type:{name:"Composite",className:"MicrosoftGraphDirectoryObject"}}}},ownedObjects:{serializedName:"ownedObjects",type:{name:"Sequence",element:{type:{name:"Composite",className:"MicrosoftGraphDirectoryObject"}}}},ownerId:{serializedName:"ownerId",type:{name:"String"}},passwordPolicies:{serializedName:"passwordPolicies",nullable:!0,type:{name:"String"}},passwordProfile:{serializedName:"passwordProfile",type:{name:"Composite",className:"PersonaPasswordProfile"}},pastProjects:{serializedName:"pastProjects",nullable:!0,type:{name:"String"}},photo:{serializedName:"photo",type:{name:"Composite",className:"PersonaPhoto"}},postalCode:{serializedName:"postalCode",nullable:!0,type:{name:"String"}},preferredLanguage:{serializedName:"preferredLanguage",nullable:!0,type:{name:"String"}},preferredName:{serializedName:"preferredName",nullable:!0,type:{name:"String"}},proxyAddresses:{serializedName:"proxyAddresses",type:{name:"Sequence",element:{type:{name:"String"}}}},registeredDevices:{serializedName:"registeredDevices",type:{name:"Sequence",element:{type:{name:"Composite",className:"MicrosoftGraphDirectoryObject"}}}},responsibilities:{serializedName:"responsibilities",type:{name:"Sequence",element:{type:{name:"String"}}}},schools:{serializedName:"schools",type:{name:"Sequence",element:{type:{name:"String"}}}},showInAddressList:{serializedName:"showInAddressList",type:{name:"Boolean"}},skills:{serializedName:"skills",type:{name:"Sequence",element:{type:{name:"String"}}}},state:{serializedName:"state",nullable:!0,type:{name:"String"}},streetAddress:{serializedName:"streetAddress",nullable:!0,type:{name:"String"}},surname:{serializedName:"surname",nullable:!0,type:{name:"String"}},usageLocation:{serializedName:"usageLocation",nullable:!0,type:{name:"String"}},userPrincipalName:{serializedName:"userPrincipalName",type:{name:"String"}},userType:{serializedName:"userType",nullable:!0,type:{name:"String"}}}}},Ma={type:{name:"Composite",className:"PersonaProfile",modelProperties:{...ya.type.modelProperties,applicationData:{serializedName:"applicationData",type:{name:"Sequence",element:{type:{name:"Composite",className:"ApplicationData"}}}},description:{serializedName:"description",nullable:!0,type:{name:"String"}},personaId:{serializedName:"personaId",nullable:!0,type:{name:"String"}},shortcuts:{serializedName:"shortcuts",type:{name:"Composite",className:"PersonaProfileShortcuts"}},theme:{serializedName:"theme",type:{name:"Enum",allowedValues:["light","dark"]}},wallpaper:{serializedName:"wallpaper",type:{name:"Composite",className:"PersonaProfileWallpaper"}}}}},Da={type:{name:"Composite",className:"ProductGroup",modelProperties:{...ya.type.modelProperties,name:{serializedName:"name",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}},path:{serializedName:"path",type:{name:"String"}},imageUrl:{serializedName:"imageUrl",type:{name:"String"}}}}},La={type:{name:"Composite",className:"Scenario",modelProperties:{...ya.type.modelProperties,name:{serializedName:"name",nullable:!0,type:{name:"String"}},presetId:{serializedName:"presetId",nullable:!0,type:{name:"String"}},path:{serializedName:"path",nullable:!0,type:{name:"String"}},contact:{serializedName:"contact",nullable:!0,type:{name:"String"}},isPublic:{serializedName:"isPublic",type:{name:"Boolean"}},ownerId:{serializedName:"ownerId",nullable:!0,type:{name:"String"}},personaIds:{serializedName:"personaIds",type:{name:"Sequence",element:{type:{name:"String"}}}},personaProfileIds:{serializedName:"personaProfileIds",type:{name:"Sequence",element:{type:{name:"String"}}}},productGroups:{serializedName:"productGroups",type:{name:"Sequence",element:{type:{name:"String"}}}},projectId:{serializedName:"projectId",nullable:!0,type:{name:"Number"}},description:{serializedName:"description",nullable:!0,type:{name:"String"}},requiredRole:{serializedName:"requiredRole",nullable:!0,type:{name:"Number"}},switches:{serializedName:"switches",nullable:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ScenarioSwitch"}}}}}}},Ba={type:{name:"Composite",className:"UserTestSession",modelProperties:{...ya.type.modelProperties,authTokenId:{serializedName:"authTokenId",nullable:!0,type:{name:"String"}},presetId:{serializedName:"presetId",required:!0,type:{name:"String"}},personaId:{serializedName:"personaId",required:!0,type:{name:"String"}},userId:{serializedName:"userId",nullable:!0,type:{name:"String"}},createdTimeStamp:{serializedName:"createdTimeStamp",nullable:!0,type:{name:"Number"}},isFullscreenOsView:{serializedName:"isFullscreenOsView",type:{name:"Boolean"}},ttl:{serializedName:"ttl",nullable:!0,type:{name:"Number"}}}}},Fa={type:{name:"Composite",className:"AppUser",modelProperties:{...ya.type.modelProperties,lastAccessTimestamp:{serializedName:"lastAccessTimestamp",nullable:!0,type:{name:"Number"}},productGroupMemberships:{serializedName:"productGroupMemberships",type:{name:"Sequence",element:{type:{name:"String"}}}},userAlias:{serializedName:"userAlias",nullable:!0,type:{name:"String"}},userName:{serializedName:"userName",nullable:!0,type:{name:"String"}},userRoles:{serializedName:"userRoles",type:{name:"Sequence",element:{type:{name:"Number"}}}}}}},za={type:{name:"Composite",className:"AuthToken",modelProperties:{...ya.type.modelProperties,userId:{serializedName:"userId",type:{name:"String"}},isUserTestToken:{serializedName:"isUserTestToken",type:{name:"Boolean"}},projectIds:{serializedName:"projectIds",type:{name:"Sequence",element:{type:{name:"Number"}}}},ttl:{serializedName:"ttl",nullable:!0,type:{name:"Number"}}}}},$a={type:{name:"Composite",className:"SuggestedShortcut",modelProperties:{...Sa.type.modelProperties,suggestedReason:{serializedName:"suggestedReason",nullable:!0,type:{name:"String"}}}}},Ua={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},Va={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},Ga={parameterPath:"s",mapper:{serializedName:"s",required:!0,type:{name:"String"}}},Ha={parameterPath:"data",mapper:{serializedName:"data",required:!0,type:{name:"Stream"}}},qa={parameterPath:"id",mapper:{serializedName:"id",required:!0,type:{name:"String"}}},ja={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},Wa={parameterPath:"body",mapper:ra},Ya={parameterPath:"body",mapper:da},Ka={parameterPath:["options","ownerId"],mapper:{serializedName:"ownerId",type:{name:"String"}}},Qa={parameterPath:"body",mapper:Oa},Za={parameterPath:"body",mapper:Ma},Xa={parameterPath:"body",mapper:Da},Ja={parameterPath:"apiName",mapper:{serializedName:"apiName",required:!0,type:{name:"String"}}},es={parameterPath:"endpoint",mapper:{serializedName:"endpoint",required:!0,type:{name:"String"}}},ts={parameterPath:"body",mapper:La},rs={parameterPath:"id",mapper:{serializedName:"id",required:!0,type:{name:"Number"}}},ns={parameterPath:"body",mapper:Ba};class CognitiveServicesImpl{constructor(O){this.client=O}autoSuggest(O,B){return this.client.sendOperationRequest({term:O,options:B},as)}detectFace(O,B){return this.client.sendOperationRequest({data:O,options:B},ss)}}const os=createSerializer(j,!1),as={path:"/cognitiveservices/autosuggest/{term}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"AutoSuggestResultModel"}}}}}},queryParameters:[Ga],urlParameters:[Va,{parameterPath:"term",mapper:{serializedName:"term",required:!0,type:{name:"String"}}}],headerParameters:[Ua],serializer:os},ss={path:"/cognitiveservices/detectface",httpMethod:"POST",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"FaceRectangle"}}}}},400:{}},requestBody:Ha,queryParameters:[Ga],urlParameters:[Va],headerParameters:[{parameterPath:["options","contentType"],mapper:{defaultValue:"image/*",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},{parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}}],mediaType:"binary",serializer:os};class ConfigImpl{constructor(O){this.client=O}getEmulatorConfigById(O,B){return this.client.sendOperationRequest({id:O,options:B},cs)}getDynamicConfigById(O,B){return this.client.sendOperationRequest({id:O,options:B},ds)}}const ls=createSerializer(j,!1),cs={path:"/config/emulator/{id}",httpMethod:"GET",responses:{200:{bodyMapper:Jo},400:{},404:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:ls},ds={path:"/config/dynamic/{id}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Dictionary",value:{type:{name:"any"}}}}},400:{},404:{}},queryParameters:[Ga],urlParameters:[Va,rs],headerParameters:[Ua],serializer:ls};class ImageImpl{constructor(O){this.client=O}getPrevalentColor(O,B){return this.client.sendOperationRequest({body:O,options:B},us)}decorateBitmap(O,B){return this.client.sendOperationRequest({body:O,options:B},hs)}}const ps=createSerializer(j,!1),us={path:"/imageservices/prevalentcolor",httpMethod:"POST",responses:{200:{bodyMapper:ca}},requestBody:Wa,queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua,ja],mediaType:"json",serializer:ps},hs={path:"/imageservices/decoratebitmap",httpMethod:"POST",responses:{200:{bodyMapper:ha}},requestBody:Ya,queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua,ja],mediaType:"json",serializer:ps};class PersonasImpl{constructor(O){this.client=O}getAll(O){return this.client.sendOperationRequest({options:O},gs)}create(O,B){return this.client.sendOperationRequest({body:O,options:B},fs)}getById(O,B){return this.client.sendOperationRequest({id:O,options:B},ys)}update(O,B,U){return this.client.sendOperationRequest({id:O,body:B,options:U},_s)}getMyPersonas(O){return this.client.sendOperationRequest({options:O},vs)}}const ms=createSerializer(j,!1),gs={path:"/personas",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"Persona"}}}}},404:{}},queryParameters:[Ga,Ka],urlParameters:[Va],headerParameters:[Ua],serializer:ms},fs={path:"/personas",httpMethod:"POST",responses:{200:{bodyMapper:Oa},400:{},404:{},415:{bodyMapper:_a},500:{}},requestBody:Qa,queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua,ja],mediaType:"json",serializer:ms},ys={path:"/personas/{id}",httpMethod:"GET",responses:{200:{bodyMapper:Oa},400:{},404:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:ms},_s={path:"/personas/{id}",httpMethod:"PUT",responses:{200:{bodyMapper:Oa},400:{},404:{},415:{bodyMapper:_a},500:{}},requestBody:Qa,queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua,ja],mediaType:"json",serializer:ms},vs={path:"/personas/me",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"Persona"}}}}},404:{}},queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua],serializer:ms};class PersonaProfilesImpl{constructor(O){this.client=O}getAll(O){return this.client.sendOperationRequest({options:O},Ss)}create(O,B){return this.client.sendOperationRequest({body:O,options:B},Cs)}getById(O,B){return this.client.sendOperationRequest({id:O,options:B},Es)}update(O,B,U){return this.client.sendOperationRequest({id:O,body:B,options:U},xs)}getByPersonaId(O,B){return this.client.sendOperationRequest({id:O,options:B},Ts)}}const bs=createSerializer(j,!1),Ss={path:"/personaprofiles",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"PersonaProfile"}}}}},404:{}},queryParameters:[Ga,{parameterPath:["options","personaId"],mapper:{serializedName:"personaId",type:{name:"String"}}}],urlParameters:[Va],headerParameters:[Ua],serializer:bs},Cs={path:"/personaprofiles",httpMethod:"POST",responses:{200:{bodyMapper:Ma},400:{},404:{},415:{bodyMapper:_a},500:{}},requestBody:Za,queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua,ja],mediaType:"json",serializer:bs},Es={path:"/personaprofiles/{id}",httpMethod:"GET",responses:{200:{bodyMapper:Ma},400:{},404:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:bs},xs={path:"/personaprofiles/{id}",httpMethod:"PUT",responses:{200:{bodyMapper:Ma},400:{},404:{},415:{bodyMapper:_a},500:{}},requestBody:Za,queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua,ja],mediaType:"json",serializer:bs},Ts={path:"/personas/{id}/personaprofiles",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"PersonaProfile"}}}}},400:{},404:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:bs};class ProductGroupsImpl{constructor(O){this.client=O}getAll(O){return this.client.sendOperationRequest({options:O},ks)}create(O,B){return this.client.sendOperationRequest({body:O,options:B},As)}getById(O,B){return this.client.sendOperationRequest({id:O,options:B},Rs)}update(O,B,U){return this.client.sendOperationRequest({id:O,body:B,options:U},Is)}delete(O,B){return this.client.sendOperationRequest({id:O,options:B},Ps)}}const ws=createSerializer(j,!1),ks={path:"/productgroups",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"ProductGroup"}}}}}},queryParameters:[Ga,{parameterPath:["options","f"],mapper:{serializedName:"f",type:{name:"String"}}}],urlParameters:[Va],headerParameters:[Ua],serializer:ws},As={path:"/productgroups",httpMethod:"POST",responses:{200:{bodyMapper:Da},400:{},404:{},415:{bodyMapper:_a},500:{}},requestBody:Xa,queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua,ja],mediaType:"json",serializer:ws},Rs={path:"/productgroups/{id}",httpMethod:"GET",responses:{200:{bodyMapper:Da},400:{},404:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:ws},Is={path:"/productgroups/{id}",httpMethod:"PUT",responses:{200:{bodyMapper:Da},400:{},404:{},415:{bodyMapper:_a},500:{}},requestBody:Xa,queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua,ja],mediaType:"json",serializer:ws},Ps={path:"/productgroups/{id}",httpMethod:"DELETE",responses:{200:{bodyMapper:Ea},400:{},404:{},500:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:ws};class ScenariosImpl{constructor(O){this.client=O}getAll(O){return this.client.sendOperationRequest({options:O},Os)}create(O,B){return this.client.sendOperationRequest({body:O,options:B},Ms)}getById(O,B){return this.client.sendOperationRequest({id:O,options:B},Ds)}update(O,B,U){return this.client.sendOperationRequest({id:O,body:B,options:U},Ls)}delete(O,B){return this.client.sendOperationRequest({id:O,options:B},Bs)}getAuthenticated(O){return this.client.sendOperationRequest({options:O},Fs)}getByPath(O,B){return this.client.sendOperationRequest({path:O,options:B},zs)}}const Ns=createSerializer(j,!1),Os={path:"/scenarios",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"Scenario"}}}}},404:{}},queryParameters:[Ga,Ka,{parameterPath:["options","pgid"],mapper:{serializedName:"pgid",type:{name:"String"}}},{parameterPath:["options","pgpath"],mapper:{serializedName:"pgpath",type:{name:"String"}}}],urlParameters:[Va],headerParameters:[Ua],serializer:Ns},Ms={path:"/scenarios",httpMethod:"POST",responses:{200:{bodyMapper:La},400:{},404:{},415:{bodyMapper:_a},500:{}},requestBody:ts,queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua,ja],mediaType:"json",serializer:Ns},Ds={path:"/scenarios/{id}",httpMethod:"GET",responses:{200:{bodyMapper:La},400:{},404:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:Ns},Ls={path:"/scenarios/{id}",httpMethod:"PUT",responses:{200:{bodyMapper:La},400:{},404:{},415:{bodyMapper:_a},500:{}},requestBody:ts,queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua,ja],mediaType:"json",serializer:Ns},Bs={path:"/scenarios/{id}",httpMethod:"DELETE",responses:{200:{bodyMapper:Ea},400:{},404:{},500:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:Ns},Fs={path:"/scenarios/authenticated",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"Scenario"}}}}},401:{},500:{}},urlParameters:[Va],headerParameters:[Ua],serializer:Ns},zs={path:"/scenarios/authenticated/{path}",httpMethod:"GET",responses:{200:{bodyMapper:La},400:{},401:{},404:{},500:{}},urlParameters:[Va,{parameterPath:"path",mapper:{serializedName:"path",required:!0,type:{name:"String"}}}],headerParameters:[Ua],serializer:Ns};class TokensImpl{constructor(O){this.client=O}create(O,B){return this.client.sendOperationRequest({alias:O,options:B},Us)}getById(O,B){return this.client.sendOperationRequest({id:O,options:B},Vs)}}const $s=createSerializer(j,!1),Us={path:"/tokens",httpMethod:"POST",responses:{200:{bodyMapper:Ta},400:{},500:{}},queryParameters:[{parameterPath:"alias",mapper:{serializedName:"alias",required:!0,type:{name:"String"}}}],urlParameters:[Va],headerParameters:[Ua],serializer:$s},Vs={path:"/tokens/{id}",httpMethod:"GET",responses:{200:{bodyMapper:wa},400:{},404:{}},urlParameters:[Va,qa],headerParameters:[Ua],serializer:$s};class UserImpl{constructor(O){this.client=O}isInRole(O,B){return this.client.sendOperationRequest({id:O,options:B},Hs)}getPersonas(O){return this.client.sendOperationRequest({options:O},qs)}getUserTestSessions(O){return this.client.sendOperationRequest({options:O},js)}}const Gs=createSerializer(j,!1),Hs={path:"/user/isinrole/{id}",httpMethod:"GET",responses:{200:{bodyMapper:Ea},400:{}},queryParameters:[Ga],urlParameters:[Va,rs],headerParameters:[Ua],serializer:Gs},qs={path:"/user/personas",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"Persona"}}}}},404:{}},queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua],serializer:Gs},js={path:"/user/usertestsessions",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"UserTestSession"}}}}},404:{}},queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua],serializer:Gs};class UserTestsImpl{constructor(O){this.client=O}createSession(O,B){return this.client.sendOperationRequest({body:O,options:B},Ys)}getSessionById(O,B){return this.client.sendOperationRequest({id:O,options:B},Ks)}deleteSession(O,B){return this.client.sendOperationRequest({id:O,options:B},Qs)}getMySessions(O){return this.client.sendOperationRequest({options:O},Zs)}}const Ws=createSerializer(j,!1),Ys={path:"/usertestsessions",httpMethod:"POST",responses:{200:{bodyMapper:Ta},400:{},401:{},404:{},415:{bodyMapper:_a}},requestBody:ns,queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua,ja],mediaType:"json",serializer:Ws},Ks={path:"/usertestsessions/{id}",httpMethod:"GET",responses:{200:{bodyMapper:Ba},400:{},404:{}},urlParameters:[Va,qa],headerParameters:[Ua],serializer:Ws},Qs={path:"/usertestsessions/{id}",httpMethod:"DELETE",responses:{200:{bodyMapper:Ea},404:{}},queryParameters:[Ga],urlParameters:[Va,qa],headerParameters:[Ua],serializer:Ws},Zs={path:"/usertestsessions/me",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Sequence",element:{type:{name:"Composite",className:"UserTestSession"}}}}},404:{}},queryParameters:[Ga],urlParameters:[Va],headerParameters:[Ua],serializer:Ws};class ProteusAPI extends serviceClient_ServiceClient{constructor(O,B){var U,G;if(void 0===O)throw new Error("'s' cannot be null");B||(B={});const q="azsdk-js-api-client-factory/1.0.0-beta.1",j=B.userAgentOptions&&B.userAgentOptions.userAgentPrefix?`${B.userAgentOptions.userAgentPrefix} ${q}`:`${q}`,W={requestContentType:"application/json; charset=utf-8",...B,userAgentOptions:{userAgentPrefix:j},baseUri:null!==(G=null!==(U=B.endpoint)&&void 0!==U?U:B.baseUri)&&void 0!==G?G:"http://localhost:7071/v0"};if(super(W),(null==B?void 0:B.pipeline)&&B.pipeline.getOrderedPolicies().length>0){B.pipeline.getOrderedPolicies().some((O=>O.name===zo))||(this.pipeline.removePolicy({name:zo}),this.pipeline.addPolicy(bearerTokenAuthenticationPolicy({scopes:`${W.baseUri}/.default`,challengeCallbacks:{authorizeRequestOnChallenge:authorizeRequestOnClaimChallenge}})))}this.s=O,this.$host=B.$host||"http://localhost:7071/v0",this.cognitiveServices=new CognitiveServicesImpl(this),this.config=new ConfigImpl(this),this.image=new ImageImpl(this),this.personas=new PersonasImpl(this),this.personaProfiles=new PersonaProfilesImpl(this),this.productGroups=new ProductGroupsImpl(this),this.scenarios=new ScenariosImpl(this),this.tokens=new TokensImpl(this),this.user=new UserImpl(this),this.userTests=new UserTestsImpl(this)}proxiedApiGetResult(O,B,U){return this.sendOperationRequest({apiName:O,endpoint:B,options:U},Js)}proxiedApiPostResult(O,B,U,G){return this.sendOperationRequest({apiName:O,endpoint:B,data:U,options:G},el)}}const Xs=createSerializer(j,!1),Js={path:"/proxied/{apiName}/{endpoint}",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Dictionary",value:{type:{name:"any"}}}}}},queryParameters:[Ga],urlParameters:[Va,Ja,es],headerParameters:[Ua],serializer:Xs},el={path:"/proxied/{apiName}/{endpoint}",httpMethod:"POST",responses:{200:{}},requestBody:Ha,queryParameters:[Ga],urlParameters:[Va,Ja,es],headerParameters:[{parameterPath:["options","contentType"],mapper:{defaultValue:"application/octet-stream",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}}],mediaType:"binary",serializer:Xs},tl={type:{name:"Composite",className:"Message",modelProperties:{audioUrl:{serializedName:"audioUrl",type:{name:"String"}},author:{serializedName:"author",required:!0,type:{name:"String"}},contentOrigin:{serializedName:"contentOrigin",type:{name:"String"}},contextType:{serializedName:"contextType",type:{name:"String"}},createdAt:{serializedName:"createdAt",type:{name:"DateTime"}},description:{serializedName:"description",type:{name:"String"}},displayUrl:{serializedName:"displayUrl",type:{name:"String"}},feedback:{serializedName:"feedback",type:{name:"Composite",className:"FeedbackInfo"}},from:{serializedName:"from",type:{name:"Composite",className:"ChannelAccount"}},hiddenText:{serializedName:"hiddenText",type:{name:"String"}},inputMethod:{serializedName:"inputMethod",type:{name:"String"}},linkUrl:{serializedName:"linkUrl",type:{name:"String"}},locale:{serializedName:"locale",type:{name:"String"}},location:{serializedName:"location",type:{name:"String"}},market:{serializedName:"market",type:{name:"String"}},messageId:{serializedName:"messageId",type:{name:"String"}},messageType:{serializedName:"messageType",type:{name:"String"}},nlu:{serializedName:"nlu",type:{name:"Composite",className:"NluResponse"}},offense:{serializedName:"offense",type:{name:"String"}},region:{serializedName:"region",type:{name:"String"}},requestId:{serializedName:"requestId",type:{name:"String"}},rewrittenMessage:{serializedName:"rewrittenMessage",type:{name:"String"}},sourceAttributions:{serializedName:"sourceAttributions",type:{name:"Sequence",element:{type:{name:"Dictionary",value:{type:{name:"any"}}}}}},sourceName:{serializedName:"sourceName",type:{name:"String"}},sourceUrl:{serializedName:"sourceUrl",type:{name:"String"}},spokenText:{serializedName:"spokenText",type:{name:"String"}},suggestedResponses:{serializedName:"suggestedResponses",type:{name:"Sequence",element:{type:{name:"Composite",className:"Message"}}}},text:{serializedName:"text",required:!0,type:{name:"String"}},timestamp:{serializedName:"timestamp",type:{name:"String"}},topicChangerText:{serializedName:"topicChangerText",type:{name:"String"}}}}},il={type:{name:"Composite",className:"FeedbackInfo",modelProperties:{tag:{serializedName:"tag",type:{name:"String"}},updatedOn:{serializedName:"updatedOn",type:{name:"DateTime"}},type:{serializedName:"type",required:!0,type:{name:"String"}}}}},rl={type:{name:"Composite",className:"ChannelAccount",modelProperties:{id:{serializedName:"id",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}}}}},nl={type:{name:"Composite",className:"NluResponse",modelProperties:{scoredClassification:{serializedName:"scoredClassification",type:{name:"Composite",className:"ScoredClassification"}},classificationRanking:{serializedName:"classificationRanking",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ScoredClassification"}}}},qualifyingClassifications:{serializedName:"qualifyingClassifications",type:{name:"Dictionary",value:{type:{name:"Number"}}}},ood:{serializedName:"ood",type:{name:"Number"}},metaData:{serializedName:"metaData",type:{name:"String"}},entities:{serializedName:"entities",type:{name:"Sequence",element:{type:{name:"Composite",className:"NamedEntity"}}}}}}},ol={type:{name:"Composite",className:"ScoredClassification",modelProperties:{classification:{serializedName:"classification",required:!0,type:{name:"String"}},score:{serializedName:"score",required:!0,type:{name:"Number"}}}}},al={type:{name:"Composite",className:"NamedEntity",modelProperties:{type:{serializedName:"type",type:{name:"String"}},value:{serializedName:"value",nullable:!0,type:{name:"String"}},originalValue:{serializedName:"originalValue",nullable:!0,type:{name:"String"}},origin:{serializedName:"origin",nullable:!0,type:{name:"String"}}}}},sl={type:{name:"Composite",className:"BingFirstPageContent",modelProperties:{answerId:{serializedName:"answerId",type:{name:"String"}},serviceName:{serializedName:"serviceName",type:{name:"String"}},scenarioName:{serializedName:"scenarioName",type:{name:"String"}},feedName:{serializedName:"feedName",type:{name:"String"}},displayText:{serializedName:"displayText",type:{name:"String"}},spokenText:{serializedName:"spokenText",type:{name:"String"}},spokenSsmlText:{serializedName:"spokenSSMLText",type:{name:"String"}},rank:{serializedName:"rank",type:{name:"Number"}},isAdultQuery:{serializedName:"isAdultQuery",type:{name:"Boolean"}},adultQueryScore:{serializedName:"adultQueryScore",type:{name:"Number"}},sourceUrl:{serializedName:"sourceUrl",type:{name:"String"}},sourceName:{serializedName:"sourceName",type:{name:"String"}},title:{serializedName:"title",type:{name:"String"}},rankingScore:{serializedName:"rankingScore",type:{name:"Number"}}}}},ll={type:{name:"Composite",className:"BaseRequest",modelProperties:{traceId:{serializedName:"traceId",type:{name:"String"}},sliceIds:{serializedName:"sliceIds",type:{name:"Sequence",element:{type:{name:"String"}}}},source:{serializedName:"source",required:!0,type:{name:"String"}},clientInfo:{serializedName:"clientInfo",type:{name:"Dictionary",value:{type:{name:"any"}}}},conversationId:{serializedName:"conversationId",type:{name:"String"}},requestId:{serializedName:"requestId",type:{name:"String"}},optionsSets:{serializedName:"optionsSets",type:{name:"Sequence",element:{type:{name:"String"}}}},extraExtensionParameters:{serializedName:"extraExtensionParameters",type:{name:"Dictionary",value:{type:{name:"any"}}}},privacy:{serializedName:"privacy",type:{name:"String"}},extraExtensions:{serializedName:"extraExtensions",type:{name:"Sequence",element:{type:{name:"Dictionary",value:{type:{name:"any"}}}}}},options:{serializedName:"options",type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},cl={type:{name:"Composite",className:"BaseResponse",modelProperties:{result:{serializedName:"result",type:{name:"Composite",className:"Result"}}}}},dl={type:{name:"Composite",className:"Result",modelProperties:{error:{serializedName:"error",type:{name:"String"}},exception:{serializedName:"exception",type:{name:"String"}},message:{serializedName:"message",required:!0,type:{name:"String"}},renewCert:{serializedName:"renewCert",type:{name:"Boolean"}},retry:{serializedName:"retry",type:{name:"Boolean"}},serviceVersion:{serializedName:"serviceVersion",required:!0,type:{name:"String"}},value:{serializedName:"value",required:!0,type:{name:"String"}}}}},pl={type:{name:"Composite",className:"ChatRequest",modelProperties:{...ll.type.modelProperties,isStartOfSession:{serializedName:"isStartOfSession",type:{name:"Boolean"}},message:{serializedName:"message",type:{name:"Composite",className:"Message"}},messageProgress:{serializedName:"messageProgress",type:{name:"String"}},messageCorrelationId:{serializedName:"messageCorrelationId",type:{name:"String"}},tenantId:{serializedName:"tenantId",type:{name:"String"}},context:{serializedName:"context",nullable:!0,type:{name:"any"}},previousMessages:{serializedName:"previousMessages",type:{name:"Sequence",element:{type:{name:"Composite",className:"Message"}}}},ignoreCache:{serializedName:"ignoreCache",type:{name:"Boolean"}},topLgContent:{serializedName:"topLgContent",type:{name:"Composite",className:"BingFirstPageContent"}},bingFirstPageContent:{serializedName:"bingFirstPageContent",type:{name:"Composite",className:"BingFirstPageContent"}},webPageContent:{serializedName:"webPageContent",type:{name:"Composite",className:"BingFirstPageContent"}},videoAnswerContent:{serializedName:"videoAnswerContent",type:{name:"Composite",className:"BingFirstPageContent"}},qasDomains:{serializedName:"qasDomains",type:{name:"Sequence",element:{type:{name:"String"}}}},spokenTextMode:{serializedName:"spokenTextMode",type:{name:"String"}}}}},ul={type:{name:"Composite",className:"BaseBotResponse",modelProperties:{...cl.type.modelProperties,conversationId:{serializedName:"conversationId",required:!0,type:{name:"String"}},requestId:{serializedName:"requestId",required:!0,type:{name:"String"}},conversationExpiryTime:{serializedName:"conversationExpiryTime",required:!0,type:{name:"DateTime"}},shouldInitiateConversation:{serializedName:"shouldInitiateConversation",type:{name:"Boolean"}}}}},hl={type:{name:"Composite",className:"ChatResponse",modelProperties:{...ul.type.modelProperties,messages:{serializedName:"messages",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Message"}}}},firstNewMessageIndex:{serializedName:"firstNewMessageIndex",required:!0,type:{name:"Number"}},suggestedResponses:{serializedName:"suggestedResponses",type:{name:"Sequence",element:{type:{name:"Composite",className:"Message"}}}}}}},ml={type:{name:"Composite",className:"CreateConversationResponse",modelProperties:{...ul.type.modelProperties,conversationSignature:{serializedName:"conversationSignature",required:!0,type:{name:"String"}}}}},gl={type:{name:"Composite",className:"ShareMessagesRequest",modelProperties:{...ll.type.modelProperties,messages:{serializedName:"messages",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Message"}}}},shareId:{serializedName:"shareId",type:{name:"String"}}}}},fl={type:{name:"Composite",className:"ShareMessagesResponse",modelProperties:{...cl.type.modelProperties,shareId:{serializedName:"shareId",required:!0,type:{name:"String"}}}}},yl={type:{name:"Composite",className:"GetSharedMessagesResponse",modelProperties:{...cl.type.modelProperties,messages:{serializedName:"messages",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Message"}}}}}}},_l={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},vl={parameterPath:"body",mapper:gl},bl={parameterPath:"body",mapper:pl},Sl={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},Cl={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0};class ChatImpl{constructor(O){this.client=O}post(O,B){return this.client.sendOperationRequest({body:O,options:B},xl)}}const El=createSerializer(W,!1),xl={path:"/chat",httpMethod:"POST",responses:{200:{bodyMapper:hl}},requestBody:bl,urlParameters:[Cl],headerParameters:[_l,Sl],mediaType:"json",serializer:El};class MessageSharingImpl{constructor(O){this.client=O}shareMessagesAsync(O,B){return this.client.sendOperationRequest({body:O,options:B},wl)}async getSharedMessagesAsync(O,B,U,G,q){const j={shareId:O,source:B,traceId:U,sliceIds:G.join(","),options:q},W=await this.client.sendOperationRequest(j,kl);return W.type,ji.GetSharedMessagesResponse,W}}const Tl=createSerializer(W,!1),wl={path:"/ShareMessages",httpMethod:"POST",responses:{200:{bodyMapper:fl}},requestBody:vl,urlParameters:[Cl],headerParameters:[_l,Sl],mediaType:"json",serializer:Tl},kl={path:"/GetSharedMessages",httpMethod:"GET",responses:{200:{bodyMapper:yl}},queryParameters:[{parameterPath:"shareId",mapper:{serializedName:"shareId",required:!0,type:{name:"String"}}},{parameterPath:"source",mapper:{serializedName:"source",required:!0,type:{name:"String"}}},{parameterPath:"traceId",mapper:{serializedName:"traceId",required:!0,type:{name:"String"}}},{parameterPath:"sliceIds",mapper:{serializedName:"sliceIds",required:!0,type:{name:"String"}}}],urlParameters:[Cl],headerParameters:[Sl],serializer:Tl},Al=createSerializer(W,!1),Rl={path:"/CreateConversation",httpMethod:"POST",responses:{200:{bodyMapper:ml}},requestBody:bl,urlParameters:[Cl],headerParameters:[_l,Sl],mediaType:"json",serializer:Al};class CreateConversationImpl{constructor(O){this.client=O}post(O,B){return this.client.sendOperationRequest({body:O,options:B},Rl)}}class SydneyAPI extends serviceClient_ServiceClient{constructor(O){var B,U;O||(O={});const G="azsdk-js-api-client-factory/1.0.0-beta.1",q=O.userAgentOptions&&O.userAgentOptions.userAgentPrefix?`${O.userAgentOptions.userAgentPrefix} ${G}`:`${G}`;super({requestContentType:"application/json; charset=utf-8",...O,userAgentOptions:{userAgentPrefix:q},baseUri:null!==(U=null!==(B=O.endpoint)&&void 0!==B?B:O.baseUri)&&void 0!==U?U:"https://sydney.bing.com/sydney"}),this.pipeline.removePolicy({name:zo}),this.$host=O.$host||"https://sydney.bing.com/sydney",this.chat=new ChatImpl(this),this.createConversation=new CreateConversationImpl(this),this.sharing=new MessageSharingImpl(this)}}const Il={type:{name:"Composite",className:"ConversationCreateResponse",modelProperties:{clientId:{serializedName:"clientId",required:!0,type:{name:"String"}},conversationId:{serializedName:"conversationId",required:!0,type:{name:"String"}},conversationSignature:{serializedName:"conversationSignature",required:!0,type:{name:"String"}},result:{serializedName:"result",type:{name:"Composite",className:"CreateConversationResult"}}}}},Pl={type:{name:"Composite",className:"CreateConversationResult",modelProperties:{error:{serializedName:"error",type:{name:"String"}},exception:{serializedName:"exception",type:{name:"String"}},message:{serializedName:"message",required:!0,type:{name:"String"}},renewCert:{serializedName:"renewCert",type:{name:"Boolean"}},retry:{serializedName:"retry",type:{name:"Boolean"}},serviceVersion:{serializedName:"serviceVersion",required:!0,type:{name:"String"}},value:{serializedName:"value",required:!0,type:{name:"String"}}}}},Nl={type:{name:"Composite",className:"ConversationChatsResponse",modelProperties:{clientId:{serializedName:"clientId",required:!0,type:{name:"String"}},chats:{serializedName:"chats",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Chat"}}}},result:{serializedName:"result",type:{name:"Composite",className:"ChatsResult"}}}}},Ol={type:{name:"Composite",className:"Chat",modelProperties:{conversationId:{serializedName:"conversationId",required:!0,type:{name:"String"}},chatName:{serializedName:"chatName",required:!0,type:{name:"String"}},conversationSignature:{serializedName:"conversationSignature",required:!0,type:{name:"String"}},tone:{serializedName:"tone",required:!0,type:{name:"String"}},createTimeUtc:{serializedName:"createTimeUtc",required:!0,type:{name:"Number"}},updateTimeUtc:{serializedName:"updateTimeUtc",required:!0,type:{name:"Number"}},expiryTimeUtc:{serializedName:"expiryTimeUtc",required:!0,type:{name:"Number"}}}}},Ml={type:{name:"Composite",className:"ChatsResult",modelProperties:{message:{serializedName:"message",required:!0,type:{name:"String"}},serviceVersion:{serializedName:"serviceVersion",required:!0,type:{name:"String"}},value:{serializedName:"value",required:!0,type:{name:"String"}}}}},Dl={type:{name:"Composite",className:"CaptchaVerifyResponse",modelProperties:{reason:{serializedName:"reason",required:!0,type:{name:"String"}},solved:{serializedName:"solved",required:!0,type:{name:"Boolean"}},statusCode:{serializedName:"statusCode",required:!0,type:{name:"Number"}}}}},Ll={type:{name:"Composite",className:"CaptchaCreateHeaders",modelProperties:{id:{serializedName:"id",type:{name:"String"}},regionid:{serializedName:"regionid",type:{name:"String"}}}}},Bl={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},Fl={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0};class ConversationImpl{constructor(O){this.client=O}create(O){return this.client.sendOperationRequest({options:O},$l)}getChats(O){return this.client.sendOperationRequest({options:O},Ul)}}const zl=createSerializer(Y,!1),$l={path:"/turing/conversation/create",httpMethod:"GET",responses:{200:{bodyMapper:Il}},urlParameters:[Fl],headerParameters:[Bl],serializer:zl},Ul={path:"/turing/conversation/chats",httpMethod:"GET",responses:{200:{bodyMapper:Nl}},urlParameters:[Fl],headerParameters:[Bl],serializer:zl};class CaptchaImpl{constructor(O){this.client=O}create(O){return this.client.sendOperationRequest({options:O},Gl)}verify(O,B,U,G){return this.client.sendOperationRequest({id:O,regionId:B,value:U,options:G},Hl)}}const Vl=createSerializer(Y,!1),Gl={path:"/turing/captcha/create",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Stream"},serializedName:"parsedResponse"},headersMapper:Ll}},urlParameters:[Fl],headerParameters:[{parameterPath:"accept",mapper:{defaultValue:"image/jpeg",isConstant:!0,serializedName:"Accept",type:{name:"String"}}}],serializer:Vl},Hl={path:"/turing/captcha/verify",httpMethod:"GET",responses:{200:{bodyMapper:Dl}},queryParameters:[{parameterPath:["options","type"],mapper:{defaultValue:"visual",serializedName:"type",type:{name:"String"}}},{parameterPath:"id",mapper:{serializedName:"id",required:!0,type:{name:"String"}}},{parameterPath:"regionId",mapper:{serializedName:"regionId",required:!0,type:{name:"String"}}},{parameterPath:"value",mapper:{serializedName:"value",required:!0,type:{name:"String"}}}],urlParameters:[Fl],headerParameters:[Bl],serializer:Vl};class BingAPI extends serviceClient_ServiceClient{constructor(O){var B,U;O||(O={});const G="azsdk-js-api-client-factory/1.0.0-beta.1",q=O.userAgentOptions&&O.userAgentOptions.userAgentPrefix?`${O.userAgentOptions.userAgentPrefix} ${G}`:`${G}`;super({requestContentType:"application/json; charset=utf-8",...O,userAgentOptions:{userAgentPrefix:q},endpoint:null!==(U=null!==(B=O.endpoint)&&void 0!==B?B:O.baseUri)&&void 0!==U?U:"https://www.bing.com"}),this.$host=O.$host||"https://www.bing.com",this.conversation=new ConversationImpl(this),this.captcha=new CaptchaImpl(this)}}class ApiClientFactory{constructor(){}static create(O,B,U,G){switch(null!=U||(U=""),null!=B||(B=""),O){case pr.Proteus:return this.createProteusApiClient(B,U,G);case pr.OpenAI:return this.createOpenAiApiClient(B,G);case pr.Sydney:return this.createSydneyApiClient();case pr.WebSearch:return this.createWebSearchClient(B,U);case pr.Bing:return this.createBingApiClient(B);default:throw new Error("Unsupported client type.")}}static createProteusApiClient(O,B,U){if(void 0===ApiClientFactory.proteus){const G={allowInsecureConnection:O===Li.HttpLocalhost7071V0,$host:O,endpoint:O,credential:U};ApiClientFactory.proteus=new ProteusAPI(B,G)}return ApiClientFactory.proteus}static createOpenAiApiClient(O,B){if(void 0===ApiClientFactory.openai){const G=`${O}${proxiedApiRelativeBasePath("openai")}`,q={$host:G,endpoint:G,credential:B};O.startsWith(Li.HttpsProteusAzureApiNetTestV0)&&(q.additionalPolicies=[(U="debug_token",{policy:new ProteusRuntimeTokenPolicy(U),position:"perCall"})]),ApiClientFactory.openai=new OpenAIAPI(q)}var U;return ApiClientFactory.openai}static createSydneyApiClient(){return void 0===ApiClientFactory.sydney&&(ApiClientFactory.sydney=new SydneyAPI),ApiClientFactory.sydney}static createWebSearchClient(O,B,U=!1){if(void 0===ApiClientFactory.webSearch){const{origin:B,pathname:j}=new URL(O),W=`{Endpoint}${function(O,B){return`${O}${proxiedApiRelativeBasePath(B)}`}(j||"",U?"bingsearchservices":"cognitiveservices")}`,Y=new EmptyServiceClientCredentials,K=[deserializationPolicy({json:["application/json","text/json","text/plain"]})];O.startsWith(Li.HttpsProteusAzureApiNetTestV0)&&K.push(function(O){return{create:(B,U)=>new ProteusRuntimeTokenPolicyMsRestJs_ProteusRuntimeTokenPolicy(B,U,O)}}("debug_token"));const Q={requestPolicyFactories:K,endpoint:B,baseUri:W};ApiClientFactory.webSearch=(G=new Zn(Y,Q),q=W,G.baseUri=q,G)}var G,q;return ApiClientFactory.webSearch}static createBingApiClient(O){if(void 0===ApiClientFactory.bing){const B=new BingAPI({$host:O,endpoint:O});B.pipeline.addPolicy(function(O){return new HttpRetryPolicy(O)}({rules:[ro]}),{phase:"Retry"}),ApiClientFactory.bing=B}return ApiClientFactory.bing}}function proxiedApiRelativeBasePath(O){return`/proxied/${O}`}const ql=kt.createInterface("IConfigService");let jl=class extends lifecycle_Disposable{constructor(O){super(),this.config=O}get webSearch(){return void 0===this._webSearch&&(this._webSearch=ApiClientFactory.create(pr.WebSearch,Li.HttpsProteusAzureApiNetTestV0)),this._webSearch}get sydney(){return void 0===this._sydney&&(this._sydney=ApiClientFactory.create(pr.Sydney)),this._sydney}get bing(){if(void 0===this._bing){const{baseUrl:O}=this.config.bing;this._bing=ApiClientFactory.create(pr.Bing,O)}return this._bing}};jl=__decorate([__param(0,ql),__metadata("design:paramtypes",[Object])],jl);const Wl=kt.createInterface("ISydneyApiClient");class ChatStreamResultError extends Error{constructor(O){super(O),this.result=O,this.name="ChatStreamResultError"}}class ChatStreamConnectionError extends Error{constructor(O,B){super(O),this.name="ChatStreamConnectionError",B&&(B instanceof Error?this.cause=B:this.cause=new Error(String(B)))}}class ChatStreamTransportError extends Error{constructor(O,B){super(O),this.name="ChatStreamTransportError",B&&(B instanceof Error?this.cause=B:this.cause=new Error(String(B)))}}var Yl,Kl,Ql,Zl,Xl,Jl,ec,tc,ic;(function(O){O.Next="NEXT",O.Update="UPDATE",O.Complete="COMPLETE",O.Error="ERROR"})(Yl||(Yl={})),function(O){O[O.Trace=0]="Trace",O[O.Debug=1]="Debug",O[O.Info=2]="Info",O[O.Warning=3]="Warning",O[O.Error=4]="Error",O[O.Off=5]="Off"}(Kl||(Kl={})),function(O){O[O.NoMatch=0]="NoMatch",O[O.Canceled=1]="Canceled",O[O.RecognizingSpeech=2]="RecognizingSpeech",O[O.RecognizedSpeech=3]="RecognizedSpeech",O[O.RecognizedKeyword=4]="RecognizedKeyword",O[O.RecognizingIntent=5]="RecognizingIntent",O[O.RecognizedIntent=6]="RecognizedIntent",O[O.TranslatingSpeech=7]="TranslatingSpeech",O[O.TranslatedSpeech=8]="TranslatedSpeech",O[O.SynthesizingAudio=9]="SynthesizingAudio",O[O.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",O[O.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",O[O.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",O[O.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",O[O.RecognizedSpeakers=14]="RecognizedSpeakers",O[O.RecognizedSpeaker=15]="RecognizedSpeaker",O[O.ResetVoiceProfile=16]="ResetVoiceProfile",O[O.DeletedVoiceProfile=17]="DeletedVoiceProfile",O[O.VoicesListRetrieved=18]="VoicesListRetrieved"}(Ql||(Ql={})),function(O){O[O.NoError=0]="NoError",O[O.AuthenticationFailure=1]="AuthenticationFailure",O[O.BadRequestParameters=2]="BadRequestParameters",O[O.TooManyRequests=3]="TooManyRequests",O[O.ConnectionFailure=4]="ConnectionFailure",O[O.ServiceTimeout=5]="ServiceTimeout",O[O.ServiceError=6]="ServiceError",O[O.RuntimeError=7]="RuntimeError",O[O.Forbidden=8]="Forbidden"}(Zl||(Zl={}));class RiffPcmEncoder{constructor(O,B){this.privActualSampleRate=O,this.privDesiredSampleRate=B}encode(O){const B=this.downSampleAudioFrame(O,this.privActualSampleRate,this.privDesiredSampleRate);if(!B)return null;const U=2*B.length,G=new ArrayBuffer(U),q=new DataView(G);return this.floatTo16BitPCM(q,0,B),G}setString(O,B,U){for(let G=0;G<U.length;G++)O.setUint8(B+G,U.charCodeAt(G))}floatTo16BitPCM(O,B,U){for(let G=0;G<U.length;G++,B+=2){const q=Math.max(-1,Math.min(1,U[G]));O.setInt16(B,q<0?32768*q:32767*q,!0)}}downSampleAudioFrame(O,B,U){if(!O)return null;if(U===B||U>B)return O;const G=B/U,q=Math.round(O.length/G),j=new Float32Array(q);let W=0,Y=0;for(;Y<q;){const B=Math.round((Y+1)*G);let U=0,q=0;for(;W<B&&W<O.length;)U+=O[W++],q++;j[Y++]=U/q}return j}}class PcmRecorder{constructor(O){this.privStopInputOnRelease=O}record(O,B,U){const G=new RiffPcmEncoder(O.sampleRate,16e3),q=O.createMediaStreamSource(B),attachScriptProcessor=()=>{const j=(()=>{let B=0;try{return O.createScriptProcessor(B,1,1)}catch(U){B=2048;let G=O.sampleRate;for(;B<16384&&G>=32e3;)B<<=1,G>>=1;return O.createScriptProcessor(B,1,1)}})();j.onaudioprocess=O=>{const B=O.inputBuffer.getChannelData(0);if(U&&!U.isClosed){const O=G.encode(B);O&&U.writeStreamChunk({buffer:O,isEnd:!1,timeReceived:Date.now()})}},q.connect(j),j.connect(O.destination),this.privMediaResources={scriptProcessorNode:j,source:q,stream:B}};if(O.audioWorklet){if(!this.privSpeechProcessorScript){const O=new Blob(["class SP extends AudioWorkletProcessor {\n                    constructor(options) {\n                      super(options);\n                    }\n                    process(inputs, outputs) {\n                      const input = inputs[0];\n                      const output = [];\n                      for (let channel = 0; channel < input.length; channel += 1) {\n                        output[channel] = input[channel];\n                      }\n                      this.port.postMessage(output[0]);\n                      return true;\n                    }\n                  }\n                  registerProcessor('speech-processor', SP);"],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(O)}O.audioWorklet.addModule(this.privSpeechProcessorScript).then((()=>{const j=new AudioWorkletNode(O,"speech-processor");j.port.onmessage=O=>{const B=O.data;if(U&&!U.isClosed){const O=G.encode(B);O&&U.writeStreamChunk({buffer:O,isEnd:!1,timeReceived:Date.now()})}},q.connect(j),j.connect(O.destination),this.privMediaResources={scriptProcessorNode:j,source:q,stream:B}})).catch((()=>{attachScriptProcessor()}))}else try{attachScriptProcessor()}catch(O){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${O}`)}}releaseMediaResources(O){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(O.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach((O=>O.stop())),this.privMediaResources.source=null))}setWorkletUrl(O){this.privSpeechProcessorScript=O}}(function(O){O[O.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",O[O.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",O[O.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",O[O.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",O[O.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",O[O.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",O[O.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",O[O.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",O[O.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",O[O.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",O[O.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",O[O.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",O[O.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",O[O.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",O[O.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",O[O.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",O[O.Speech_SessionId=16]="Speech_SessionId",O[O.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",O[O.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",O[O.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",O[O.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",O[O.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",O[O.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",O[O.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",O[O.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",O[O.CancellationDetails_Reason=25]="CancellationDetails_Reason",O[O.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",O[O.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",O[O.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",O[O.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",O[O.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",O[O.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",O[O.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",O[O.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",O[O.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",O[O.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",O[O.SpeechServiceResponse_ProfanityOption=36]="SpeechServiceResponse_ProfanityOption",O[O.SpeechServiceResponse_PostProcessingOption=37]="SpeechServiceResponse_PostProcessingOption",O[O.SpeechServiceResponse_RequestWordLevelTimestamps=38]="SpeechServiceResponse_RequestWordLevelTimestamps",O[O.SpeechServiceResponse_StablePartialResultThreshold=39]="SpeechServiceResponse_StablePartialResultThreshold",O[O.SpeechServiceResponse_OutputFormatOption=40]="SpeechServiceResponse_OutputFormatOption",O[O.SpeechServiceResponse_TranslationRequestStablePartialResult=41]="SpeechServiceResponse_TranslationRequestStablePartialResult",O[O.SpeechServiceResponse_RequestWordBoundary=42]="SpeechServiceResponse_RequestWordBoundary",O[O.SpeechServiceResponse_RequestPunctuationBoundary=43]="SpeechServiceResponse_RequestPunctuationBoundary",O[O.SpeechServiceResponse_RequestSentenceBoundary=44]="SpeechServiceResponse_RequestSentenceBoundary",O[O.Conversation_ApplicationId=45]="Conversation_ApplicationId",O[O.Conversation_DialogType=46]="Conversation_DialogType",O[O.Conversation_Initial_Silence_Timeout=47]="Conversation_Initial_Silence_Timeout",O[O.Conversation_From_Id=48]="Conversation_From_Id",O[O.Conversation_Conversation_Id=49]="Conversation_Conversation_Id",O[O.Conversation_Custom_Voice_Deployment_Ids=50]="Conversation_Custom_Voice_Deployment_Ids",O[O.Conversation_Speech_Activity_Template=51]="Conversation_Speech_Activity_Template",O[O.Conversation_Request_Bot_Status_Messages=52]="Conversation_Request_Bot_Status_Messages",O[O.Conversation_Agent_Connection_Id=53]="Conversation_Agent_Connection_Id",O[O.SpeechServiceConnection_Host=54]="SpeechServiceConnection_Host",O[O.ConversationTranslator_Host=55]="ConversationTranslator_Host",O[O.ConversationTranslator_Name=56]="ConversationTranslator_Name",O[O.ConversationTranslator_CorrelationId=57]="ConversationTranslator_CorrelationId",O[O.ConversationTranslator_Token=58]="ConversationTranslator_Token",O[O.PronunciationAssessment_ReferenceText=59]="PronunciationAssessment_ReferenceText",O[O.PronunciationAssessment_GradingSystem=60]="PronunciationAssessment_GradingSystem",O[O.PronunciationAssessment_Granularity=61]="PronunciationAssessment_Granularity",O[O.PronunciationAssessment_EnableMiscue=62]="PronunciationAssessment_EnableMiscue",O[O.PronunciationAssessment_Json=63]="PronunciationAssessment_Json",O[O.PronunciationAssessment_Params=64]="PronunciationAssessment_Params",O[O.SpeakerRecognition_Api_Version=65]="SpeakerRecognition_Api_Version"})(Xl||(Xl={})),function(O){O[O.Interactive=0]="Interactive",O[O.Conversation=1]="Conversation",O[O.Dictation=2]="Dictation"}(Jl||(Jl={})),function(O){O[O.Simple=0]="Simple",O[O.Detailed=1]="Detailed"}(ec||(ec={}));class RecognizerConfig{constructor(O,B){this.privSpeechServiceConfig=O||new SpeechServiceConfig(new Context(null)),this.privParameters=B,this.privMaxRetryCount=parseInt(B.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=B.getProperty(Xl.SpeechServiceConnection_LanguageIdMode,void 0)}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(O){this.privRecognitionMode=O,this.privRecognitionActivityTimeout=O===Jl.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=Jl[O]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==Jl.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(Xl.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(Xl.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){const O=[];let B=!1;if(void 0!==this.autoDetectSourceLanguages)for(const U of this.autoDetectSourceLanguages.split(",")){const G=U+Xl.SpeechServiceConnection_EndpointId.toString(),q=this.parameters.getProperty(G,void 0);void 0!==q?(O.push({language:U,endpoint:q}),B=!0):O.push({language:U,endpoint:""})}return B?O:void 0}get maxRetryCount(){return this.privMaxRetryCount}}class SpeechServiceConfig{constructor(O){this.context=O}serialize(){return JSON.stringify(this,((O,B)=>{if(B&&"object"==typeof B){const O={};for(const U in B)Object.hasOwnProperty.call(B,U)&&(O[U&&U.charAt(0).toLowerCase()+U.substring(1)]=B[U]);return O}return B}))}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(O){this.recognition=O.toLowerCase()}}class Context{constructor(O){this.system=new System,this.os=O}}class System{constructor(){this.name="SpeechSDK",this.version="1.15.0-alpha.0.1",this.build="JavaScript",this.lang="JavaScript"}}class RecognizerConfig_OS{constructor(O,B,U){this.platform=O,this.name=B,this.version=U}}(function(O){O.Bluetooth="Bluetooth",O.Wired="Wired",O.WiFi="WiFi",O.Cellular="Cellular",O.InBuilt="InBuilt",O.Unknown="Unknown"})(tc||(tc={})),function(O){O.Phone="Phone",O.Speaker="Speaker",O.Car="Car",O.Headset="Headset",O.Thermostat="Thermostat",O.Microphones="Microphones",O.Deskphone="Deskphone",O.RemoteControl="RemoteControl",O.Unknown="Unknown",O.File="File",O.Stream="Stream"}(ic||(ic={}));const createNoDashGuid=()=>esm_browser_v4().replace(new RegExp("-","g"),"").toUpperCase();class ArgumentNullError extends Error{constructor(O){super(O),this.name="ArgumentNull",this.message=O}}class InvalidOperationError extends Error{constructor(O){super(O),this.name="InvalidOperation",this.message=O}}class ObjectDisposedError extends Error{constructor(O,B){super(B),this.name=O+"ObjectDisposed",this.message=B}}class EventSource_EventSource{constructor(O){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=O}onEvent(O){if(this.isDisposed())throw new ObjectDisposedError("EventSource");if(this.metadata)for(const B in this.metadata)B&&O.metadata&&(O.metadata[B]||(O.metadata[B]=this.metadata[B]));for(const B in this.privEventListeners)B&&this.privEventListeners[B]&&this.privEventListeners[B](O)}attach(O){const B=createNoDashGuid();return this.privEventListeners[B]=O,{detach:()=>(delete this.privEventListeners[B],Promise.resolve())}}attachListener(O){return this.attach((B=>O.onEvent(B)))}attachConsoleListener(O){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach((B=>O.onEvent(B))),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}}var rc,nc;(function(O){O[O.None=0]="None",O[O.Resolved=1]="Resolved",O[O.Rejected=2]="Rejected"})(rc||(rc={}));class Deferred{constructor(){this.resolve=O=>(this.privResolve(O),this),this.reject=O=>(this.privReject(O),this),this.privPromise=new Promise(((O,B)=>{this.privResolve=O,this.privReject=B}))}get promise(){return this.privPromise}}function marshalPromiseToCallbacks(O,B,U){O.then((O=>{try{B&&B(O)}catch(O){if(U)try{if(O instanceof Error){const B=O;U(B.name+": "+B.message)}else U(O)}catch(O){}}}),(O=>{if(U)try{if(O instanceof Error){const B=O;U(B.name+": "+B.message)}else U(O)}catch(O){}}))}(function(O){O[O.Debug=0]="Debug",O[O.Info=1]="Info",O[O.Warning=2]="Warning",O[O.Error=3]="Error",O[O.None=4]="None"})(nc||(nc={}));class PlatformEvent{constructor(O,B){this.privName=O,this.privEventId=createNoDashGuid(),this.privEventTime=(new Date).toISOString(),this.privEventType=B,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}class AudioSourceEvent extends PlatformEvent{constructor(O,B,U=nc.Info){super(O,U),this.privAudioSourceId=B}get audioSourceId(){return this.privAudioSourceId}}class AudioSourceInitializingEvent extends AudioSourceEvent{constructor(O){super("AudioSourceInitializingEvent",O)}}class AudioSourceReadyEvent extends AudioSourceEvent{constructor(O){super("AudioSourceReadyEvent",O)}}class AudioSourceOffEvent extends AudioSourceEvent{constructor(O){super("AudioSourceOffEvent",O)}}class AudioSourceErrorEvent extends AudioSourceEvent{constructor(O,B){super("AudioSourceErrorEvent",O,nc.Error),this.privError=B}get error(){return this.privError}}class AudioStreamNodeEvent extends AudioSourceEvent{constructor(O,B,U){super(O,B),this.privAudioNodeId=U}get audioNodeId(){return this.privAudioNodeId}}class AudioStreamNodeAttachingEvent extends AudioStreamNodeEvent{constructor(O,B){super("AudioStreamNodeAttachingEvent",O,B)}}class AudioStreamNodeAttachedEvent extends AudioStreamNodeEvent{constructor(O,B){super("AudioStreamNodeAttachedEvent",O,B)}}class AudioStreamNodeDetachedEvent extends AudioStreamNodeEvent{constructor(O,B){super("AudioStreamNodeDetachedEvent",O,B)}}class AudioStreamNodeErrorEvent extends AudioStreamNodeEvent{constructor(O,B,U){super("AudioStreamNodeErrorEvent",O,B),this.privError=U}get error(){return this.privError}}class List{constructor(O){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],O)for(const B of O)this.privList.push(B)}get(O){return this.throwIfDisposed(),this.privList[O]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(O){this.throwIfDisposed(),this.insertAt(this.privList.length,O)}insertAt(O,B){this.throwIfDisposed(),0===O?this.privList.unshift(B):O===this.privList.length?this.privList.push(B):this.privList.splice(O,0,B),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(O){return this.throwIfDisposed(),this.remove(O,1)[0]}remove(O,B){this.throwIfDisposed();const U=this.privList.splice(O,B);return this.triggerSubscriptions(this.privRemoveSubscriptions),U}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(O){this.throwIfDisposed();const B=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[B]=O,{detach:()=>(delete this.privAddSubscriptions[B],Promise.resolve())}}onRemoved(O){this.throwIfDisposed();const B=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[B]=O,{detach:()=>(delete this.privRemoveSubscriptions[B],Promise.resolve())}}onDisposed(O){this.throwIfDisposed();const B=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[B]=O,{detach:()=>(delete this.privDisposedSubscriptions[B],Promise.resolve())}}join(O){return this.throwIfDisposed(),this.privList.join(O)}toArray(){const O=Array();return this.privList.forEach((B=>{O.push(B)})),O}any(O){return this.throwIfDisposed(),O?this.where(O).length()>0:this.length()>0}all(O){return this.throwIfDisposed(),this.where(O).length()===this.length()}forEach(O){this.throwIfDisposed();for(let B=0;B<this.length();B++)O(this.privList[B],B)}select(O){this.throwIfDisposed();const B=[];for(let U=0;U<this.privList.length;U++)B.push(O(this.privList[U],U));return new List(B)}where(O){this.throwIfDisposed();const B=new List;for(let U=0;U<this.privList.length;U++)O(this.privList[U],U)&&B.add(this.privList[U]);return B}orderBy(O){this.throwIfDisposed();const B=this.toArray().sort(O);return new List(B)}orderByDesc(O){return this.throwIfDisposed(),this.orderBy(((B,U)=>O(U,B)))}clone(){return this.throwIfDisposed(),new List(this.toArray())}concat(O){return this.throwIfDisposed(),new List(this.privList.concat(O.toArray()))}concatArray(O){return this.throwIfDisposed(),new List(this.privList.concat(O))}isDisposed(){return null==this.privList}dispose(O){this.isDisposed()||(this.privDisposeReason=O,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(O){if(O)for(const B in O)B&&O[B]()}}var oc,Queue_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};(function(O){O[O.Dequeue=0]="Dequeue",O[O.Peek=1]="Peek"})(oc||(oc={}));class Queue_Queue{constructor(O){this.privPromiseStore=new List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=O||new List,this.privDetachables=[],this.privSubscribers=new List,this.privDetachables.push(this.privList.onAdded((()=>this.drain())))}enqueue(O){this.throwIfDispose(),this.enqueueFromPromise(new Promise((B=>B(O))))}enqueueFromPromise(O){this.throwIfDispose(),O.then((O=>{this.privList.add(O)}),(()=>{}))}dequeue(){this.throwIfDispose();const O=new Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:O,type:oc.Dequeue}),this.drain()),O.promise}peek(){this.throwIfDispose();const O=new Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:O,type:oc.Peek}),this.drain()),O.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return null==this.privSubscribers}drainAndDispose(O,B){return Queue_awaiter(this,void 0,void 0,(function*(){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=B,this.privIsDisposing=!0;const U=this.privSubscribers;if(U){for(;U.length()>0;){U.removeFirst().deferral.resolve(void 0)}this.privSubscribers===U&&(this.privSubscribers=U)}for(const O of this.privDetachables)yield O.detach();if(this.privPromiseStore.length()>0&&O){const B=[];return this.privPromiseStore.toArray().forEach((O=>{B.push(O)})),Promise.all(B).finally((()=>{this.privSubscribers=null,this.privList.forEach((B=>{O(B)})),this.privList=null})).then()}this.privSubscribers=null,this.privList=null}}))}dispose(O){return Queue_awaiter(this,void 0,void 0,(function*(){yield this.drainAndDispose(null,O)}))}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const O=this.privSubscribers,B=this.privList;if(O&&B){for(;B.length()>0&&O.length()>0&&!this.privIsDisposing;){const U=O.removeFirst();if(U.type===oc.Peek)U.deferral.resolve(B.first());else{const O=B.removeFirst();U.deferral.resolve(O)}}this.privSubscribers===O&&(this.privSubscribers=O),this.privList===B&&(this.privList=B)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed()){if(this.privDisposeReason)throw new InvalidOperationError(this.privDisposeReason);throw new ObjectDisposedError("Queue")}if(this.privIsDisposing)throw new InvalidOperationError("Queue disposing")}}var ac,Stream_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class Stream{constructor(O){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=O||createNoDashGuid(),this.privReaderQueue=new Queue_Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(O){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(O)}catch(O){}}read(){if(this.privIsReadEnded)throw new InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then((O=>Stream_awaiter(this,void 0,void 0,(function*(){return(void 0===O||O.isEnd)&&(yield this.privReaderQueue.dispose("End of stream reached")),O}))))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new Queue_Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new InvalidOperationError("Stream closed")}}class ChunkedArrayBufferStream extends Stream{constructor(O,B){super(B),this.privTargetChunkSize=O,this.privNextBufferReadyBytes=0}writeStreamChunk(O){if(O.isEnd||0===this.privNextBufferReadyBytes&&O.buffer.byteLength===this.privTargetChunkSize)return void super.writeStreamChunk(O);let B=0;for(;B<O.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=O.timeReceived);const U=Math.min(O.buffer.byteLength-B,this.privTargetChunkSize-this.privNextBufferReadyBytes),G=new Uint8Array(this.privNextBufferToWrite),q=new Uint8Array(O.buffer.slice(B,U+B));G.set(q,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=U,B+=U,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){0===this.privNextBufferReadyBytes||this.isClosed||super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}}class Events{static setEventSource(O){if(!O)throw new ArgumentNullError("eventSource");Events.privInstance=O}static get instance(){return Events.privInstance}}Events.privInstance=new EventSource_EventSource,function(O){O[O.PCM=1]="PCM",O[O.MuLaw=2]="MuLaw",O[O.Siren=3]="Siren",O[O.MP3=4]="MP3",O[O.SILKSkype=5]="SILKSkype",O[O.OGG_OPUS=6]="OGG_OPUS",O[O.WEBM_OPUS=7]="WEBM_OPUS",O[O.ALaw=8]="ALaw",O[O.FLAC=9]="FLAC",O[O.OPUS=10]="OPUS"}(ac||(ac={}));class AudioStreamFormat{static getDefaultInputFormat(){return AudioStreamFormatImpl.getDefaultInputFormat()}static getWaveFormat(O,B,U,G){return new AudioStreamFormatImpl(O,B,U,G)}static getWaveFormatPCM(O,B,U){return new AudioStreamFormatImpl(O,B,U)}}class AudioStreamFormatImpl extends AudioStreamFormat{constructor(O=16e3,B=16,U=1,G=ac.PCM){super();let q=!0;switch(G){case ac.PCM:this.formatTag=1;break;case ac.ALaw:this.formatTag=6;break;case ac.MuLaw:this.formatTag=7;break;default:q=!1}if(this.bitsPerSample=B,this.samplesPerSec=O,this.channels=U,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),q){this.privHeader=new ArrayBuffer(44);const O=new DataView(this.privHeader);this.setString(O,0,"RIFF"),O.setUint32(4,0,!0),this.setString(O,8,"WAVEfmt "),O.setUint32(16,16,!0),O.setUint16(20,this.formatTag,!0),O.setUint16(22,this.channels,!0),O.setUint32(24,this.samplesPerSec,!0),O.setUint32(28,this.avgBytesPerSec,!0),O.setUint16(32,this.channels*(this.bitsPerSample/8),!0),O.setUint16(34,this.bitsPerSample,!0),this.setString(O,36,"data"),O.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new AudioStreamFormatImpl}static getAudioContext(O){const B=window.AudioContext||window.webkitAudioContext||!1;if(B)return void 0!==O&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new B({sampleRate:O}):new B;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(O,B,U){for(let G=0;G<U.length;G++)O.setUint8(B+G,U.charCodeAt(G))}}var MicAudioSource_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class MicAudioSource{constructor(O,B,U,G){this.privRecorder=O,this.deviceId=B,this.privStreams={},this.privOutputChunkSize=MicAudioSource.AUDIOFORMAT.avgBytesPerSec/10,this.privId=U||createNoDashGuid(),this.privEvents=new EventSource_EventSource,this.privMediaStream=G||null,this.privIsClosing=!1}get format(){return Promise.resolve(MicAudioSource.AUDIOFORMAT)}get blob(){return Promise.reject("Not implemented for Mic input")}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new Deferred;try{this.createAudioContext()}catch(O){if(O instanceof Error){const B=O;this.privInitializeDeferral.reject(B.name+": "+B.message)}else this.privInitializeDeferral.reject(O);return this.privInitializeDeferral.promise}const O=window.navigator;let B=O.getUserMedia||O.webkitGetUserMedia||O.mozGetUserMedia||O.msGetUserMedia;if(O.mediaDevices&&(B=(B,U,G)=>{O.mediaDevices.getUserMedia(B).then(U).catch(G)}),B){const next=()=>{this.onEvent(new AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):B({audio:!this.deviceId||{deviceId:this.deviceId},video:!1},(O=>{this.privMediaStream=O,this.onEvent(new AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()}),(O=>{const B=`Error occurred during microphone initialization: ${O}`;this.privInitializeDeferral.reject(B),this.onEvent(new AudioSourceErrorEvent(this.privId,B))}))};"suspended"===this.privContext.state?this.privContext.resume().then(next).catch((O=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${O}`)})):next()}else{const O="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(O),this.onEvent(new AudioSourceErrorEvent(O,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(O){return this.onEvent(new AudioStreamNodeAttachingEvent(this.privId,O)),this.listen(O).then((B=>(this.onEvent(new AudioStreamNodeAttachedEvent(this.privId,O)),{detach:()=>MicAudioSource_awaiter(this,void 0,void 0,(function*(){return B.readEnded(),delete this.privStreams[O],this.onEvent(new AudioStreamNodeDetachedEvent(this.privId,O)),this.turnOff()})),id:()=>O,read:()=>B.read()})))}detach(O){O&&this.privStreams[O]&&(this.privStreams[O].close(),delete this.privStreams[O],this.onEvent(new AudioStreamNodeDetachedEvent(this.privId,O)))}turnOff(){return MicAudioSource_awaiter(this,void 0,void 0,(function*(){for(const O in this.privStreams)if(O){const B=this.privStreams[O];B&&B.close()}this.onEvent(new AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(yield this.privInitializeDeferral,this.privInitializeDeferral=null),yield this.destroyAudioContext()}))}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then((O=>({bitspersample:MicAudioSource.AUDIOFORMAT.bitsPerSample,channelcount:MicAudioSource.AUDIOFORMAT.channels,connectivity:tc.Unknown,manufacturer:"Speech SDK",model:O,samplerate:MicAudioSource.AUDIOFORMAT.samplesPerSec,type:ic.Microphones})))}setProperty(O,B){if("MICROPHONE-WorkletSourceUrl"!==O)throw new Error("Property '"+O+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(B)}getMicrophoneLabel(){const O="microphone";if(void 0!==this.privMicrophoneLabel)return Promise.resolve(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return Promise.resolve(O);this.privMicrophoneLabel=O;const B=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===B)return Promise.resolve(this.privMicrophoneLabel);const U=new Deferred;return navigator.mediaDevices.enumerateDevices().then((O=>{for(const U of O)if(U.deviceId===B){this.privMicrophoneLabel=U.label;break}U.resolve(this.privMicrophoneLabel)}),(()=>U.resolve(this.privMicrophoneLabel))),U.promise}listen(O){return MicAudioSource_awaiter(this,void 0,void 0,(function*(){yield this.turnOn();const B=new ChunkedArrayBufferStream(this.privOutputChunkSize,O);this.privStreams[O]=B;try{this.privRecorder.record(this.privContext,this.privMediaStream,B)}catch(B){throw this.onEvent(new AudioStreamNodeErrorEvent(this.privId,O,B)),B}return B}))}onEvent(O){this.privEvents.onEvent(O),Events.instance.onEvent(O)}createAudioContext(){this.privContext||(this.privContext=AudioStreamFormatImpl.getAudioContext(MicAudioSource.AUDIOFORMAT.samplesPerSec))}destroyAudioContext(){return MicAudioSource_awaiter(this,void 0,void 0,(function*(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let O=!1;"close"in this.privContext&&(O=!0),O?this.privIsClosing||(this.privIsClosing=!0,yield this.privContext.close(),this.privContext=null,this.privIsClosing=!1):null!==this.privContext&&"running"===this.privContext.state&&(yield this.privContext.suspend())}))}}MicAudioSource.AUDIOFORMAT=AudioStreamFormat.getDefaultInputFormat();var FileAudioSource_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class FileAudioSource{constructor(O,B,U){this.privStreams={},this.privHeaderEnd=44,this.privId=U||createNoDashGuid(),this.privEvents=new EventSource_EventSource,this.privSource=O,"undefined"!=typeof window&&"undefined"!=typeof Blob&&this.privSource instanceof Blob?this.privFilename=O.name:this.privFilename=B||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}get blob(){return Promise.resolve(this.privSource)}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const O=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new AudioSourceErrorEvent(O,"")),Promise.reject(O)}this.onEvent(new AudioSourceInitializingEvent(this.privId)),this.onEvent(new AudioSourceReadyEvent(this.privId))}id(){return this.privId}attach(O){return FileAudioSource_awaiter(this,void 0,void 0,(function*(){this.onEvent(new AudioStreamNodeAttachingEvent(this.privId,O));const B=yield this.upload(O);return this.onEvent(new AudioStreamNodeAttachedEvent(this.privId,O)),Promise.resolve({detach:()=>FileAudioSource_awaiter(this,void 0,void 0,(function*(){B.readEnded(),delete this.privStreams[O],this.onEvent(new AudioStreamNodeDetachedEvent(this.privId,O)),yield this.turnOff()})),id:()=>O,read:()=>B.read()})}))}detach(O){O&&this.privStreams[O]&&(this.privStreams[O].close(),delete this.privStreams[O],this.onEvent(new AudioStreamNodeDetachedEvent(this.privId,O)))}turnOff(){for(const O in this.privStreams)if(O){const B=this.privStreams[O];B&&!B.isClosed&&B.close()}return this.onEvent(new AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then((O=>Promise.resolve({bitspersample:O.bitsPerSample,channelcount:O.channels,connectivity:tc.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:O.samplesPerSec,type:ic.File})))}readHeader(){const O=this.privSource.slice(0,4296),B=new Deferred,processHeader=O=>{const U=new DataView(O),getWord=O=>String.fromCharCode(U.getUint8(O),U.getUint8(O+1),U.getUint8(O+2),U.getUint8(O+3));if("RIFF"!==getWord(0))return void B.reject("Invalid WAV header in file, RIFF was not found");if("WAVE"!==getWord(8)||"fmt "!==getWord(12))return void B.reject("Invalid WAV header in file, WAVEfmt was not found");const G=U.getInt32(16,!0),q=U.getUint16(22,!0),j=U.getUint32(24,!0),W=U.getUint16(34,!0);let Y=36+Math.max(G-16,0);for(;"data"!==getWord(Y);Y+=2)if(Y>4288)return void B.reject("Invalid WAV header in file, data block was not found");this.privHeaderEnd=Y+8,B.resolve(AudioStreamFormat.getWaveFormatPCM(j,W,q))};if("undefined"!=typeof window&&"undefined"!=typeof Blob&&O instanceof Blob){const B=new FileReader;B.onload=O=>{const B=O.target.result;processHeader(B)},B.readAsArrayBuffer(O)}else{const B=O;processHeader(B.buffer.slice(B.byteOffset,B.byteOffset+B.byteLength))}return B.promise}upload(O){return FileAudioSource_awaiter(this,void 0,void 0,(function*(){const onerror=B=>{const U=`Error occurred while processing '${this.privFilename}'. ${B}`;throw this.onEvent(new AudioStreamNodeErrorEvent(this.privId,O,U)),new Error(U)};try{yield this.turnOn();const B=yield this.privAudioFormatPromise,U=new ChunkedArrayBufferStream(B.avgBytesPerSec/10,O);this.privStreams[O]=U;const G=this.privSource.slice(this.privHeaderEnd),processFile=O=>{U.isClosed||(U.writeStreamChunk({buffer:O,isEnd:!1,timeReceived:Date.now()}),U.close())};if("undefined"!=typeof window&&"undefined"!=typeof Blob&&G instanceof Blob){const O=new FileReader;O.onerror=O=>onerror(O.toString()),O.onload=O=>{const B=O.target.result;processFile(B)},O.readAsArrayBuffer(G)}else{const O=G;processFile(O.buffer.slice(O.byteOffset,O.byteOffset+O.byteLength))}return U}catch(O){onerror(O)}}))}onEvent(O){this.privEvents.onEvent(O),Events.instance.onEvent(O)}}class Contracts{static throwIfNullOrUndefined(O,B){if(null==O)throw new Error("throwIfNullOrUndefined:"+B)}static throwIfNull(O,B){if(null===O)throw new Error("throwIfNull:"+B)}static throwIfNullOrWhitespace(O,B){if(Contracts.throwIfNullOrUndefined(O,B),(""+O).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+B)}static throwIfDisposed(O){if(O)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(O,B){if(Contracts.throwIfNullOrUndefined(O,B),0===O.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+B);for(const U of O)Contracts.throwIfNullOrWhitespace(U,B)}static throwIfFileDoesNotExist(O,B){Contracts.throwIfNullOrWhitespace(O,B)}static throwIfNotUndefined(O,B){if(void 0!==O)throw new Error("throwIfNotUndefined:"+B)}}class PullAudioInputStreamCallback{}var sc,lc,cc,AudioInputStream_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class AudioInputStream{constructor(){}static createPushStream(O){return PushAudioInputStream.create(O)}static createPullStream(O,B){return PullAudioInputStream.create(O,B)}}class PushAudioInputStream extends AudioInputStream{static create(O){return new PushAudioInputStreamImpl(O)}}class PushAudioInputStreamImpl extends PushAudioInputStream{constructor(O){super(),this.privFormat=void 0===O?AudioStreamFormatImpl.getDefaultInputFormat():O,this.privEvents=new EventSource_EventSource,this.privId=createNoDashGuid(),this.privStream=new ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(O){this.privStream.writeStreamChunk({buffer:O,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}get blob(){return this.attach("id").then((O=>{const B=[];let U=Buffer.from("");const readCycle=()=>O.read().then((O=>!O||O.isEnd?"undefined"!=typeof XMLHttpRequest&&"undefined"!=typeof Blob?Promise.resolve(new Blob(B)):Promise.resolve(Buffer.from(U)):("undefined"!=typeof Blob?B.push(O.buffer):U=Buffer.concat([U,this.toBuffer(O.buffer)]),readCycle())));return readCycle()}))}turnOn(){this.onEvent(new AudioSourceInitializingEvent(this.privId)),this.onEvent(new AudioSourceReadyEvent(this.privId))}attach(O){return AudioInputStream_awaiter(this,void 0,void 0,(function*(){this.onEvent(new AudioStreamNodeAttachingEvent(this.privId,O)),yield this.turnOn();const B=this.privStream;return this.onEvent(new AudioStreamNodeAttachedEvent(this.privId,O)),{detach:()=>AudioInputStream_awaiter(this,void 0,void 0,(function*(){return this.onEvent(new AudioStreamNodeDetachedEvent(this.privId,O)),this.turnOff()})),id:()=>O,read:()=>B.read()}}))}detach(O){this.onEvent(new AudioStreamNodeDetachedEvent(this.privId,O))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:tc.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:ic.Stream})}onEvent(O){this.privEvents.onEvent(O),Events.instance.onEvent(O)}toBuffer(O){const B=Buffer.alloc(O.byteLength),U=new Uint8Array(O);for(let O=0;O<B.length;++O)B[O]=U[O];return B}}class PullAudioInputStream extends AudioInputStream{constructor(){super()}static create(O,B){return new PullAudioInputStreamImpl(O,B)}}class PullAudioInputStreamImpl extends PullAudioInputStream{constructor(O,B){super(),this.privFormat=void 0===B?AudioStreamFormat.getDefaultInputFormat():B,this.privEvents=new EventSource_EventSource,this.privId=createNoDashGuid(),this.privCallback=O,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}get blob(){return Promise.reject("Not implemented")}turnOn(){this.onEvent(new AudioSourceInitializingEvent(this.privId)),this.onEvent(new AudioSourceReadyEvent(this.privId))}attach(O){return AudioInputStream_awaiter(this,void 0,void 0,(function*(){return this.onEvent(new AudioStreamNodeAttachingEvent(this.privId,O)),yield this.turnOn(),this.onEvent(new AudioStreamNodeAttachedEvent(this.privId,O)),{detach:()=>(this.privCallback.close(),this.onEvent(new AudioStreamNodeDetachedEvent(this.privId,O)),this.turnOff()),id:()=>O,read:()=>{let O,B=0;for(;B<this.privBufferSize;){const U=new ArrayBuffer(this.privBufferSize-B),G=this.privCallback.read(U);if(void 0===O)O=U;else{new Int8Array(O).set(new Int8Array(U),B)}if(0===G)break;B+=G}return Promise.resolve({buffer:O.slice(0,B),isEnd:this.privIsClosed||0===B,timeReceived:Date.now()})}}}))}detach(O){this.onEvent(new AudioStreamNodeDetachedEvent(this.privId,O))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:tc.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:ic.Stream})}onEvent(O){this.privEvents.onEvent(O),Events.instance.onEvent(O)}}(function(O){O[O.Text=0]="Text",O[O.Binary=1]="Binary"})(sc||(sc={}));class ConnectionMessage{constructor(O,B,U,G){if(this.privBody=null,O===sc.Text&&B&&"string"!=typeof B)throw new InvalidOperationError("Payload must be a string");if(O===sc.Binary&&B&&!(B instanceof ArrayBuffer))throw new InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=O,this.privBody=B,this.privHeaders=U||{},this.privId=G||createNoDashGuid(),this.messageType){case sc.Binary:this.privSize=null!==this.binaryBody?this.binaryBody.byteLength:0;break;case sc.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===sc.Binary)throw new InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===sc.Text)throw new InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}class ServiceEvent extends PlatformEvent{constructor(O,B,U=nc.Info){super(O,U),this.privJsonResult=B}get jsonString(){return this.privJsonResult}}class ConnectionEvent extends PlatformEvent{constructor(O,B,U=nc.Info){super(O,U),this.privConnectionId=B}get connectionId(){return this.privConnectionId}}class ConnectionStartEvent extends ConnectionEvent{constructor(O,B,U){super("ConnectionStartEvent",O),this.privUri=B,this.privHeaders=U}get uri(){return this.privUri}get headers(){return this.privHeaders}}class ConnectionEstablishedEvent extends ConnectionEvent{constructor(O){super("ConnectionEstablishedEvent",O)}}class ConnectionClosedEvent extends ConnectionEvent{constructor(O,B,U){super("ConnectionClosedEvent",O,nc.Debug),this.privReason=U,this.privStatusCode=B}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class ConnectionErrorEvent extends ConnectionEvent{constructor(O,B,U){super("ConnectionErrorEvent",O,nc.Debug),this.privMessage=B,this.privType=U}get message(){return this.privMessage}get type(){return this.privType}}class ConnectionEstablishErrorEvent extends ConnectionEvent{constructor(O,B,U){super("ConnectionEstablishErrorEvent",O,nc.Error),this.privStatusCode=B,this.privReason=U}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class ConnectionMessageReceivedEvent extends ConnectionEvent{constructor(O,B,U){super("ConnectionMessageReceivedEvent",O),this.privNetworkReceivedTime=B,this.privMessage=U}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}class ConnectionMessageSentEvent extends ConnectionEvent{constructor(O,B,U){super("ConnectionMessageSentEvent",O),this.privNetworkSentTime=B,this.privMessage=U}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}(function(O){O[O.None=0]="None",O[O.Connected=1]="Connected",O[O.Connecting=2]="Connecting",O[O.Disconnected=3]="Disconnected"})(lc||(lc={})),function(O){O[O.Error=0]="Error",O[O.EndOfStream=1]="EndOfStream"}(cc||(cc={}));class SpeechSynthesisEventArgs{constructor(O){this.privResult=O}get result(){return this.privResult}}class SynthesisResult{constructor(O,B,U,G){this.privResultId=O,this.privReason=B,this.privErrorDetails=U,this.privProperties=G}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}}class SpeechSynthesisResult extends SynthesisResult{constructor(O,B,U,G,q,j){super(O,B,G,q),this.privAudioData=U,this.privAudioDuration=j}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}}class PropertyCollection{constructor(){this.privKeys=[],this.privValues=[]}getProperty(O,B){let U;U="string"==typeof O?O:Xl[O];for(let O=0;O<this.privKeys.length;O++)if(this.privKeys[O]===U)return this.privValues[O];if(void 0!==B)return String(B)}setProperty(O,B){let U;U="string"==typeof O?O:Xl[O];for(let O=0;O<this.privKeys.length;O++)if(this.privKeys[O]===U)return void(this.privValues[O]=B);this.privKeys.push(U),this.privValues.push(B)}clone(){const O=new PropertyCollection;for(let B=0;B<this.privKeys.length;B++)O.privKeys.push(this.privKeys[B]),O.privValues.push(this.privValues[B]);return O}mergeTo(O){this.privKeys.forEach((B=>{if(void 0===O.getProperty(B,void 0)){const U=this.getProperty(B);O.setProperty(B,U)}}))}get keys(){return this.privKeys}}class SpeechSynthesisWordBoundaryEventArgs{constructor(O,B,U,G,q,j){this.privAudioOffset=O,this.privDuration=B,this.privText=U,this.privWordLength=G,this.privTextOffset=q,this.privBoundaryType=j}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}}class SpeechSynthesisBookmarkEventArgs{constructor(O,B){this.privAudioOffset=O,this.privText=B}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}}class SpeechSynthesisVisemeEventArgs{constructor(O,B,U){this.privAudioOffset=O,this.privVisemeId=B,this.privAnimation=U}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}}const dc="OutputFormat",pc="CancellationErrorCode",uc="ServiceProperties",hc="ForceDictation";var mc;(function(O){O[O.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",O[O.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",O[O.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",O[O.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",O[O.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",O[O.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",O[O.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",O[O.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",O[O.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",O[O.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",O[O.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",O[O.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",O[O.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",O[O.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",O[O.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",O[O.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",O[O.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",O[O.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",O[O.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",O[O.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",O[O.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",O[O.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",O[O.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",O[O.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",O[O.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",O[O.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",O[O.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",O[O.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",O[O.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",O[O.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",O[O.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",O[O.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",O[O.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",O[O.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",O[O.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",O[O.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",O[O.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm"})(mc||(mc={}));class AudioOutputFormatImpl extends AudioStreamFormatImpl{constructor(O,B,U,G,q,j,W,Y,K){super(U,j,B,O),this.formatTag=O,this.avgBytesPerSec=G,this.blockAlign=q,this.priAudioFormatString=W,this.priRequestAudioFormatString=Y,this.priHasHeader=K}static fromSpeechSynthesisOutputFormat(O){return void 0===O?AudioOutputFormatImpl.getDefaultOutputFormat():AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(AudioOutputFormatImpl.SpeechSynthesisOutputFormatToString[O])}static fromSpeechSynthesisOutputFormatString(O){switch(O){case"raw-8khz-8bit-mono-mulaw":return new AudioOutputFormatImpl(ac.MuLaw,1,8e3,8e3,1,8,O,O,!1);case"riff-16khz-16kbps-mono-siren":return new AudioOutputFormatImpl(ac.Siren,1,16e3,2e3,40,0,O,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new AudioOutputFormatImpl(ac.Siren,1,16e3,2e3,40,0,O,O,!1);case"audio-16khz-32kbitrate-mono-mp3":return new AudioOutputFormatImpl(ac.MP3,1,16e3,4096,2,16,O,O,!1);case"audio-16khz-128kbitrate-mono-mp3":return new AudioOutputFormatImpl(ac.MP3,1,16e3,16384,2,16,O,O,!1);case"audio-16khz-64kbitrate-mono-mp3":return new AudioOutputFormatImpl(ac.MP3,1,16e3,8192,2,16,O,O,!1);case"audio-24khz-48kbitrate-mono-mp3":return new AudioOutputFormatImpl(ac.MP3,1,24e3,6144,2,16,O,O,!1);case"audio-24khz-96kbitrate-mono-mp3":return new AudioOutputFormatImpl(ac.MP3,1,24e3,12288,2,16,O,O,!1);case"audio-24khz-160kbitrate-mono-mp3":return new AudioOutputFormatImpl(ac.MP3,1,24e3,20480,2,16,O,O,!1);case"raw-16khz-16bit-mono-truesilk":return new AudioOutputFormatImpl(ac.SILKSkype,1,16e3,32e3,2,16,O,O,!1);case"riff-8khz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,8e3,16e3,2,16,O,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,24e3,48e3,2,16,O,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new AudioOutputFormatImpl(ac.MuLaw,1,8e3,8e3,1,8,O,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,16e3,32e3,2,16,O,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,24e3,48e3,2,16,O,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,8e3,16e3,2,16,O,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new AudioOutputFormatImpl(ac.OGG_OPUS,1,16e3,8192,2,16,O,O,!1);case"ogg-24khz-16bit-mono-opus":return new AudioOutputFormatImpl(ac.OGG_OPUS,1,24e3,8192,2,16,O,O,!1);case"raw-48khz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,48e3,96e3,2,16,O,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,48e3,96e3,2,16,O,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new AudioOutputFormatImpl(ac.MP3,1,48e3,12288,2,16,O,O,!1);case"audio-48khz-192kbitrate-mono-mp3":return new AudioOutputFormatImpl(ac.MP3,1,48e3,24576,2,16,O,O,!1);case"ogg-48khz-16bit-mono-opus":return new AudioOutputFormatImpl(ac.OGG_OPUS,1,48e3,12e3,2,16,O,O,!1);case"webm-16khz-16bit-mono-opus":return new AudioOutputFormatImpl(ac.WEBM_OPUS,1,16e3,4e3,2,16,O,O,!1);case"webm-24khz-16bit-mono-opus":return new AudioOutputFormatImpl(ac.WEBM_OPUS,1,24e3,6e3,2,16,O,O,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new AudioOutputFormatImpl(ac.WEBM_OPUS,1,24e3,3e3,2,16,O,O,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new AudioOutputFormatImpl(ac.OPUS,1,16e3,4e3,2,16,O,O,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new AudioOutputFormatImpl(ac.OPUS,1,24e3,6e3,2,16,O,O,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new AudioOutputFormatImpl(ac.OPUS,1,24e3,3e3,2,16,O,O,!1);case"audio-24khz-16bit-mono-flac":return new AudioOutputFormatImpl(ac.FLAC,1,24e3,24e3,2,16,O,O,!1);case"audio-48khz-16bit-mono-flac":return new AudioOutputFormatImpl(ac.FLAC,1,48e3,3e4,2,16,O,O,!1);case"raw-24khz-16bit-mono-truesilk":return new AudioOutputFormatImpl(ac.SILKSkype,1,24e3,48e3,2,16,O,O,!1);case"raw-8khz-8bit-mono-alaw":return new AudioOutputFormatImpl(ac.ALaw,1,8e3,8e3,1,8,O,O,!1);case"riff-8khz-8bit-mono-alaw":return new AudioOutputFormatImpl(ac.ALaw,1,8e3,8e3,1,8,O,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,22050,44100,2,16,O,O,!1);case"riff-22050hz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,22050,44100,2,16,O,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,44100,88200,2,16,O,O,!1);case"riff-44100hz-16bit-mono-pcm":return new AudioOutputFormatImpl(ac.PCM,1,44100,88200,2,16,O,"raw-44100hz-16bit-mono-pcm",!0);default:return new AudioOutputFormatImpl(ac.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString("undefined"!=typeof window?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(O){if(this.priHasHeader){const B=new DataView(this.privHeader);B.setUint32(4,O+this.privHeader.byteLength-8,!0),B.setUint32(40,O,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}}AudioOutputFormatImpl.SpeechSynthesisOutputFormatToString={[mc.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[mc.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[mc.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[mc.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[mc.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[mc.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[mc.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[mc.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[mc.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[mc.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[mc.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[mc.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[mc.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[mc.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[mc.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[mc.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[mc.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[mc.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[mc.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[mc.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[mc.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[mc.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[mc.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[mc.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[mc.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[mc.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[mc.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[mc.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[mc.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[mc.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[mc.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[mc.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[mc.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[mc.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[mc.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[mc.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[mc.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm"};var gc,AudioOutputStream_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class AudioOutputStream{constructor(){}static createPullStream(){return PullAudioOutputStream.create()}}class PullAudioOutputStream extends AudioOutputStream{static create(){return new PullAudioOutputStreamImpl}}class PullAudioOutputStreamImpl extends PullAudioOutputStream{constructor(){super(),this.privId=createNoDashGuid(),this.privStream=new Stream}set format(O){null==O&&(this.privFormat=AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=O}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(O){return AudioOutputStream_awaiter(this,void 0,void 0,(function*(){const B=new Int8Array(O);let U=0;if(void 0!==this.privLastChunkView){if(this.privLastChunkView.length>O.byteLength)return B.set(this.privLastChunkView.slice(0,O.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(O.byteLength),Promise.resolve(O.byteLength);B.set(this.privLastChunkView),U=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;U<O.byteLength&&!this.privStream.isReadEnded;){const G=yield this.privStream.read();if(void 0===G||G.isEnd)this.privStream.readEnded();else{let q;G.buffer.byteLength>O.byteLength-U?(q=G.buffer.slice(0,O.byteLength-U),this.privLastChunkView=new Int8Array(G.buffer.slice(O.byteLength-U))):q=G.buffer,B.set(new Int8Array(q),U),U+=q.byteLength}}return U}))}write(O){Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:O,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}class PushAudioOutputStream extends AudioOutputStream{constructor(){super()}static create(O){return new PushAudioOutputStreamImpl(O)}}class PushAudioOutputStreamImpl extends PushAudioOutputStream{constructor(O){super(),this.privId=createNoDashGuid(),this.privCallback=O}set format(O){}write(O){this.privCallback.write&&this.privCallback.write(O)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}(function(O){O.WordBoundary="WordBoundary",O.Bookmark="Bookmark",O.Viseme="Viseme",O.SentenceBoundary="SentenceBoundary",O.SessionEnd="SessionEnd"})(gc||(gc={}));class SynthesisAudioMetadata{constructor(O){this.privSynthesisAudioMetadata=JSON.parse(O)}static fromJSON(O){return new SynthesisAudioMetadata(O)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}class SpeechSynthesisEvent extends PlatformEvent{constructor(O,B,U=nc.Info){super(O,U),this.privRequestId=B}get requestId(){return this.privRequestId}}class SynthesisTriggeredEvent extends SpeechSynthesisEvent{constructor(O,B,U){super("SynthesisTriggeredEvent",O),this.privSessionAudioDestinationId=B,this.privTurnAudioDestinationId=U}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}class ConnectingToSynthesisServiceEvent extends SpeechSynthesisEvent{constructor(O,B){super("ConnectingToSynthesisServiceEvent",O),this.privAuthFetchEventId=B}get authFetchEventId(){return this.privAuthFetchEventId}}class SynthesisStartedEvent extends SpeechSynthesisEvent{constructor(O,B){super("SynthesisStartedEvent",O),this.privAuthFetchEventId=B}get authFetchEventId(){return this.privAuthFetchEventId}}var SynthesisTurn_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class SynthesisTurn{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=createNoDashGuid(),this.privTurnDeferral=new Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(O){this.privStreamId=O}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(O){this.privAudioOutputFormat=O}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}getAllReceivedAudio(){return SynthesisTurn_awaiter(this,void 0,void 0,(function*(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(yield this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}))}getAllReceivedAudioWithHeader(){return SynthesisTurn_awaiter(this,void 0,void 0,(function*(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const O=yield this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=SynthesisAdapterBase.addHeader(O,this.audioOutputFormat),this.privReceivedAudioWithHeader}return this.getAllReceivedAudio()}))}startNewSynthesis(O,B,U,G){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=O,this.privRawText=B,this.privIsSSML=U,this.privAudioOutputStream=new PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",void 0!==G&&(this.privTurnAudioDestination=G,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new SynthesisTriggeredEvent(this.requestId,void 0,void 0===G?void 0:G.id()))}onPreConnectionStart(O){this.privAuthFetchEventId=O,this.onEvent(new ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(O){O&&this.onComplete()}onConnectionEstablishCompleted(O){if(200===O)return this.onEvent(new SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),void(this.privBytesReceived=0);403===O&&this.onComplete()}onServiceResponseMessage(O){const B=JSON.parse(O);this.streamId=B.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new Deferred}onAudioChunkReceived(O){this.isSynthesizing&&(this.privAudioOutputStream.write(O),this.privBytesReceived+=O.byteLength,void 0!==this.privTurnAudioDestination&&this.privTurnAudioDestination.write(O))}onTextBoundaryEvent(O){this.updateTextOffset(O.Data.text.Text,O.Type)}onVisemeMetadataReceived(O){void 0!==O.Data.AnimationChunk&&(this.privPartialVisemeAnimation+=O.Data.AnimationChunk)}onSessionEnd(O){this.privAudioDuration=O.Data.Offset}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const O=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",O}onEvent(O){Events.instance.onEvent(O)}static isXmlTag(O){return O.length>=2&&"<"===O[0]&&">"===O[O.length-1]}updateTextOffset(O,B){B===gc.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(O,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+O.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!SynthesisTurn.isXmlTag(O)&&this.updateTextOffset(O,B))):(this.privSentenceOffset=this.privRawText.indexOf(O,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+O.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!SynthesisTurn.isXmlTag(O)&&this.updateTextOffset(O,B)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,void 0!==this.privTurnAudioDestination&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}readAllAudioFromStream(){return SynthesisTurn_awaiter(this,void 0,void 0,(function*(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{yield this.privAudioOutputStream.read(this.privReceivedAudio)}catch(O){this.privReceivedAudio=new ArrayBuffer(0)}}}))}withinXmlTag(O){return this.privRawText.indexOf("<",O+1)>this.privRawText.indexOf(">",O+1)}}class SynthesisContext{constructor(O){this.privContext={},this.privSpeechSynthesizer=O}setSection(O,B){this.privContext[O]=B}set audioOutputFormat(O){this.privAudioOutputFormat=O}toJSON(){const O=this.buildSynthesisContext();return this.setSection("synthesis",O),JSON.stringify(this.privContext)}buildSynthesisContext(){return{audio:{metadataOptions:{bookmarkEnabled:!!this.privSpeechSynthesizer.bookmarkReached,punctuationBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(Xl.SpeechServiceResponse_RequestPunctuationBoundary,!!this.privSpeechSynthesizer.wordBoundary),sentenceBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(Xl.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!this.privSpeechSynthesizer.visemeReceived,wordBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(Xl.SpeechServiceResponse_RequestWordBoundary,!!this.privSpeechSynthesizer.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:this.privSpeechSynthesizer.autoDetectSourceLanguage}}}}class AgentConfig{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(O){this.iPrivConfig=O}}class HeaderNames{}HeaderNames.AuthKey="Ocp-Apim-Subscription-Key",HeaderNames.Authorization="Authorization",HeaderNames.ConnectionId="X-ConnectionId",HeaderNames.ContentType="Content-Type",HeaderNames.CustomCommandsAppId="X-CommandsAppId",HeaderNames.Path="Path",HeaderNames.RequestId="X-RequestId",HeaderNames.RequestStreamId="X-StreamId",HeaderNames.RequestTimestamp="X-Timestamp";class SpeechConnectionMessage extends ConnectionMessage{constructor(O,B,U,G,q,j,W,Y){if(!B)throw new ArgumentNullError("path");if(!U)throw new ArgumentNullError("requestId");const K={};if(K[HeaderNames.Path]=B,K[HeaderNames.RequestId]=U,K[HeaderNames.RequestTimestamp]=(new Date).toISOString(),G&&(K[HeaderNames.ContentType]=G),j&&(K[HeaderNames.RequestStreamId]=j),W)for(const O in W)O&&(K[O]=W[O]);Y?super(O,q,K,Y):super(O,q,K),this.privPath=B,this.privRequestId=U,this.privContentType=G,this.privStreamId=j,this.privAdditionalHeaders=W}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(O){let B=null,U=null,G=null,q=null;const j={};if(O.headers)for(const W in O.headers)W&&(W.toLowerCase()===HeaderNames.Path.toLowerCase()?B=O.headers[W]:W.toLowerCase()===HeaderNames.RequestId.toLowerCase()?U=O.headers[W]:W.toLowerCase()===HeaderNames.ContentType.toLowerCase()?G=O.headers[W]:W.toLowerCase()===HeaderNames.RequestStreamId.toLowerCase()?q=O.headers[W]:j[W]=O.headers[W]);return new SpeechConnectionMessage(O.messageType,B,U,G,O.body,q,j,O.id)}}var SynthesisAdapterBase_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class SynthesisAdapterBase{constructor(O,B,U,G,q){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!O)throw new ArgumentNullError("authentication");if(!B)throw new ArgumentNullError("connectionFactory");if(!U)throw new ArgumentNullError("synthesizerConfig");this.privAuthentication=O,this.privConnectionFactory=B,this.privSynthesizerConfig=U,this.privIsDisposed=!1,this.privSpeechSynthesizer=G,this.privSessionAudioDestination=q,this.privSynthesisTurn=new SynthesisTurn,this.privConnectionEvents=new EventSource_EventSource,this.privServiceEvents=new EventSource_EventSource,this.privSynthesisContext=new SynthesisContext(this.privSpeechSynthesizer),this.privAgentConfig=new AgentConfig,this.connectionEvents.attach((O=>{if("ConnectionClosedEvent"===O.name){const B=O;1e3!==B.statusCode&&this.cancelSynthesisLocal(cc.Error,1007===B.statusCode?Zl.BadRequestParameters:Zl.ConnectionFailure,`${B.reason} websocket error code: ${B.statusCode}`)}}))}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(O){this.privActivityTemplate=O}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(O){this.privAudioOutputFormat=O,this.privSynthesisTurn.audioOutputFormat=O,void 0!==this.privSessionAudioDestination&&(this.privSessionAudioDestination.format=O),void 0!==this.synthesisContext&&(this.synthesisContext.audioOutputFormat=O)}static addHeader(O,B){if(!B.hasHeader)return O;B.updateHeader(O.byteLength);const U=new Uint8Array(O.byteLength+B.header.byteLength);return U.set(new Uint8Array(B.header),0),U.set(new Uint8Array(O),B.header.byteLength),U.buffer}isDisposed(){return this.privIsDisposed}dispose(O){return SynthesisAdapterBase_awaiter(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.close(),void 0!==this.privConnectionConfigurationPromise){const B=yield this.privConnectionConfigurationPromise;yield B.dispose(O)}}))}connect(){return SynthesisAdapterBase_awaiter(this,void 0,void 0,(function*(){yield this.connectImpl()}))}sendNetworkMessage(O,B){return SynthesisAdapterBase_awaiter(this,void 0,void 0,(function*(){const U="string"==typeof B?sc.Text:sc.Binary,G="string"==typeof B?"application/json":"";return(yield this.fetchConnection()).send(new SpeechConnectionMessage(U,O,this.privSynthesisTurn.requestId,G,B))}))}Speak(O,B,U,G,q,j){return SynthesisAdapterBase_awaiter(this,void 0,void 0,(function*(){let W;if(W=B?O:this.privSpeechSynthesizer.buildSsml(O),void 0!==this.speakOverride)return this.speakOverride(W,U,G,q);this.privSuccessCallback=G,this.privErrorCallback=q,this.privSynthesisTurn.startNewSynthesis(U,O,B,j);try{yield this.connectImpl();const O=yield this.fetchConnection();yield this.sendSynthesisContext(O),yield this.sendSsmlMessage(O,W,U);const B=new SpeechSynthesisEventArgs(new SpeechSynthesisResult(U,Ql.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,B),this.receiveMessage()}catch(O){return this.cancelSynthesisLocal(cc.Error,Zl.ConnectionFailure,O),Promise.reject(O)}}))}cancelSynthesis(O,B,U,G){const q=new PropertyCollection;q.setProperty(pc,Zl[U]);const j=new SpeechSynthesisResult(O,Ql.Canceled,void 0,G,q);if(this.privSpeechSynthesizer.SynthesisCanceled){const O=new SpeechSynthesisEventArgs(j);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,O)}catch(O){}}if(this.privSuccessCallback)try{this.privSuccessCallback(j)}catch(O){}}cancelSynthesisLocal(O,B,U){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,O,B,U))}processTypeSpecificMessages(O){return!0}receiveMessage(){return SynthesisAdapterBase_awaiter(this,void 0,void 0,(function*(){try{const O=yield this.fetchConnection(),B=yield O.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!B)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const U=SpeechConnectionMessage.fromConnectionMessage(B);if(U.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(U.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse();break;case"response":this.privSynthesisTurn.onServiceResponseMessage(U.textBody);break;case"audio":if(this.privSynthesisTurn.streamId.toLowerCase()===U.streamId.toLowerCase()&&U.binaryBody){if(this.privSynthesisTurn.onAudioChunkReceived(U.binaryBody),this.privSpeechSynthesizer.synthesizing)try{const O=SynthesisAdapterBase.addHeader(U.binaryBody,this.privSynthesisTurn.audioOutputFormat),B=new SpeechSynthesisEventArgs(new SpeechSynthesisResult(this.privSynthesisTurn.requestId,Ql.SynthesizingAudio,O));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,B)}catch(O){}void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.write(U.binaryBody)}break;case"audio.metadata":const O=SynthesisAudioMetadata.fromJSON(U.textBody).Metadata;for(const B of O)switch(B.Type){case gc.WordBoundary:case gc.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(B);const O=new SpeechSynthesisWordBoundaryEventArgs(B.Data.Offset,B.Data.Duration,B.Data.text.Text,B.Data.text.Length,B.Type===gc.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,B.Data.text.BoundaryType);if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,O)}catch(O){}break;case gc.Bookmark:const U=new SpeechSynthesisBookmarkEventArgs(B.Data.Offset,B.Data.Bookmark);if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,U)}catch(O){}break;case gc.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(B),B.Data.IsLastAnimation){const O=new SpeechSynthesisVisemeEventArgs(B.Data.Offset,B.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,O)}catch(O){}}break;case gc.SessionEnd:this.privSynthesisTurn.onSessionEnd(B)}break;case"turn.end":let B;this.privSynthesisTurn.onServiceTurnEndResponse();try{const O=yield this.privSynthesisTurn.getAllReceivedAudioWithHeader();B=new SpeechSynthesisResult(this.privSynthesisTurn.requestId,Ql.SynthesizingAudioCompleted,O,void 0,void 0,this.privSynthesisTurn.audioDuration),this.privSuccessCallback&&this.privSuccessCallback(B)}catch(O){this.privErrorCallback&&this.privErrorCallback(O)}if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new SpeechSynthesisEventArgs(B))}catch(O){}break;default:this.processTypeSpecificMessages(U)||this.privServiceEvents&&this.serviceEvents.onEvent(new ServiceEvent(U.path.toLowerCase(),U.textBody))}return this.receiveMessage()}catch(O){}}))}sendSynthesisContext(O){const B=this.synthesisContext.toJSON();if(B)return O.send(new SpeechConnectionMessage(sc.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",B))}connectImpl(O=!1){if(null!=this.privConnectionPromise)return this.privConnectionPromise.then((O=>O.state()===lc.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl())));this.privAuthFetchEventId=createNoDashGuid(),this.privConnectionId=createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const B=O?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=B.then((B=>SynthesisAdapterBase_awaiter(this,void 0,void 0,(function*(){this.privSynthesisTurn.onAuthCompleted(!1);const U=this.privConnectionFactory.create(this.privSynthesizerConfig,B,this.privConnectionId);U.events.attach((O=>{this.connectionEvents.onEvent(O)}));const G=yield U.open();return 200===G.statusCode?(this.privSynthesisTurn.onConnectionEstablishCompleted(G.statusCode),Promise.resolve(U)):403!==G.statusCode||O?(this.privSynthesisTurn.onConnectionEstablishCompleted(G.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${G.statusCode}, ${this.privSynthesizerConfig.parameters.getProperty(Xl.SpeechServiceConnection_Endpoint)} Reason: ${G.reason}`)):this.connectImpl(!0)}))),(O=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(O)})),this.privConnectionPromise.catch((()=>{})),this.privConnectionPromise}sendSpeechServiceConfig(O,B){if(B)return O.send(new SpeechConnectionMessage(sc.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",B))}sendSsmlMessage(O,B,U){return O.send(new SpeechConnectionMessage(sc.Text,"ssml",U,"application/ssml+xml",B))}fetchConnection(){return SynthesisAdapterBase_awaiter(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((O=>O.state()===lc.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}configureConnection(){return SynthesisAdapterBase_awaiter(this,void 0,void 0,(function*(){const O=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(O):(yield this.sendSpeechServiceConfig(O,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),O)}))}}SynthesisAdapterBase.telemetryDataEnabled=!0;class BackgroundEvent extends PlatformEvent{constructor(O){super("BackgroundEvent",nc.Error),this.privError=O}get error(){return this.privError}}var SpeakerAudioDestination_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};const fc={[ac.PCM]:"audio/wav",[ac.MuLaw]:"audio/x-wav",[ac.MP3]:"audio/mpeg",[ac.OGG_OPUS]:"audio/ogg",[ac.WEBM_OPUS]:"audio/webm; codecs=opus",[ac.ALaw]:"audio/x-wav",[ac.FLAC]:"audio/flac"};class SpeakerAudioDestination{constructor(O){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=O||createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(O,B,U){void 0!==this.privAudioBuffer?(this.privAudioBuffer.push(O),this.updateSourceBuffer().then((()=>{B&&B()}),(O=>{U&&U(O)}))):void 0!==this.privAudioOutputStream&&(this.privAudioOutputStream.write(O),this.privBytesReceived+=O.byteLength)}close(O,B){if(this.privIsClosed=!0,void 0!==this.privSourceBuffer)this.handleSourceBufferUpdateEnd().then((()=>{O&&O()}),(O=>{B&&B(O)}));else if(void 0!==this.privAudioOutputStream&&"undefined"!=typeof window)if(this.privFormat.formatTag!==ac.PCM&&this.privFormat.formatTag!==ac.MuLaw&&this.privFormat.formatTag!==ac.ALaw||!1!==this.privFormat.hasHeader){let U=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(U).then((()=>{U=SynthesisAdapterBase.addHeader(U,this.privFormat);const G=new Blob([U],{type:fc[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(G),this.notifyPlayback().then((()=>{O&&O()}),(O=>{B&&B(O)}))}),(O=>{B&&B(O)}))}else console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else this.onAudioEnd&&this.onAudioEnd(this)}set format(O){if("undefined"!=typeof AudioContext||"undefined"!=typeof window&&void 0!==window.webkitAudioContext){this.privFormat=O;const B=fc[this.privFormat.formatTag];void 0===B?console.warn(`Unknown mimeType for format ${ac[this.privFormat.formatTag]}; playback is not supported.`):"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported(B)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=1800,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(B),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch((O=>{Events.instance.onEvent(new BackgroundEvent(O))}))},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch((O=>{Events.instance.onEvent(new BackgroundEvent(O))}))},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch((O=>{Events.instance.onEvent(new BackgroundEvent(O))}))):(console.warn(`Format ${ac[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var O,B;return null!==(B=null===(O=this.privAudio)||void 0===O?void 0:O.volume)&&void 0!==B?B:-1}set volume(O){this.privAudio&&(this.privAudio.volume=O)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return void 0!==this.privAudio?this.privAudio.currentTime:-1}pause(){this.privIsPaused||void 0===this.privAudio||(this.privAudio.pause(),this.privIsPaused=!0)}resume(O,B){this.privIsPaused&&void 0!==this.privAudio&&(this.privAudio.play().then((()=>{O&&O()}),(O=>{B&&B(O)})),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){return SpeakerAudioDestination_awaiter(this,void 0,void 0,(function*(){if(void 0!==this.privAudioBuffer&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const O=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(O)}catch(B){return this.privAudioBuffer.unshift(O),void console.log("buffer filled, pausing addition of binaries until space is made")}yield this.notifyPlayback()}else this.canEndStream()&&(yield this.handleSourceBufferUpdateEnd())}))}handleSourceBufferUpdateEnd(){return SpeakerAudioDestination_awaiter(this,void 0,void 0,(function*(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),yield this.notifyPlayback())}))}notifyPlayback(){return SpeakerAudioDestination_awaiter(this,void 0,void 0,(function*(){this.privPlaybackStarted||void 0===this.privAudio||(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||(yield this.privAudio.play()))}))}canEndStream(){return this.isClosed&&void 0!==this.privSourceBuffer&&0===this.privAudioBuffer.length&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&"open"===this.privMediaSource.readyState}sourceBufferAvailable(){return void 0!==this.privSourceBuffer&&!this.privSourceBuffer.updating}}class PushAudioOutputStreamCallback{}var yc,_c,vc=U(6555);class AudioFileWriter{constructor(O){Contracts.throwIfNullOrUndefined(vc.openSync,"\nFile System access not available, please use Push or PullAudioOutputStream"),this.privFd=vc.openSync(O,"w")}set format(O){Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=O;let B=0;this.privAudioFormat.hasHeader&&(B=this.privAudioFormat.header.byteLength),void 0!==this.privFd&&(this.privWriteStream=vc.createWriteStream("",{fd:this.privFd,start:B,autoClose:!1}))}write(O){Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),void 0!==this.privWriteStream&&this.privWriteStream.write(new Uint8Array(O.slice(0)))}close(){void 0!==this.privFd&&(this.privWriteStream.on("finish",(()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),vc.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),vc.closeSync(this.privFd),this.privFd=void 0})),this.privWriteStream.end())}id(){return this.privId}}class AudioConfig{static fromDefaultMicrophoneInput(){const O=new PcmRecorder(!0);return new AudioConfigImpl(new MicAudioSource(O))}static fromMicrophoneInput(O){const B=new PcmRecorder(!0);return new AudioConfigImpl(new MicAudioSource(B,O))}static fromWavFileInput(O,B="unnamedBuffer.wav"){return new AudioConfigImpl(new FileAudioSource(O,B))}static fromStreamInput(O){if(O instanceof PullAudioInputStreamCallback)return new AudioConfigImpl(new PullAudioInputStreamImpl(O));if(O instanceof AudioInputStream)return new AudioConfigImpl(O);if("undefined"!=typeof MediaStream&&O instanceof MediaStream){const B=new PcmRecorder(!1);return new AudioConfigImpl(new MicAudioSource(B,null,null,O))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new AudioOutputConfigImpl(new SpeakerAudioDestination)}static fromSpeakerOutput(O){if(void 0===O)return AudioConfig.fromDefaultSpeakerOutput();if(O instanceof SpeakerAudioDestination)return new AudioOutputConfigImpl(O);throw new Error("Not Supported Type")}static fromAudioFileOutput(O){return new AudioOutputConfigImpl(new AudioFileWriter(O))}static fromStreamOutput(O){if(O instanceof PushAudioOutputStreamCallback)return new AudioOutputConfigImpl(new PushAudioOutputStreamImpl(O));if(O instanceof PushAudioOutputStream)return new AudioOutputConfigImpl(O);if(O instanceof PullAudioOutputStream)return new AudioOutputConfigImpl(O);throw new Error("Not Supported Type")}}class AudioConfigImpl extends AudioConfig{constructor(O){super(),this.privSource=O}get format(){return this.privSource.format}close(O,B){this.privSource.turnOff().then((()=>{O&&O()}),(O=>{B&&B(O)}))}id(){return this.privSource.id()}get blob(){return this.privSource.blob}turnOn(){return this.privSource.turnOn()}attach(O){return this.privSource.attach(O)}detach(O){return this.privSource.detach(O)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(O,B){if(Contracts.throwIfNull(B,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(O,B)}getProperty(O,B){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(O,B);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}class AudioOutputConfigImpl extends AudioConfig{constructor(O){super(),this.privDestination=O}set format(O){this.privDestination.format=O}write(O){this.privDestination.write(O)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}(function(O){O[O.Simple=0]="Simple",O[O.Detailed=1]="Detailed"})(yc||(yc={})),function(O){O[O.Masked=0]="Masked",O[O.Removed=1]="Removed",O[O.Raw=2]="Raw"}(_c||(_c={}));class SpeechConfig{constructor(){}static fromSubscription(O,B){Contracts.throwIfNullOrWhitespace(O,"subscriptionKey"),Contracts.throwIfNullOrWhitespace(B,"region");const U=new SpeechConfigImpl;return U.setProperty(Xl.SpeechServiceConnection_Region,B),U.setProperty(Xl.SpeechServiceConnection_IntentRegion,B),U.setProperty(Xl.SpeechServiceConnection_Key,O),U}static fromEndpoint(O,B){Contracts.throwIfNull(O,"endpoint");const U=new SpeechConfigImpl;return U.setProperty(Xl.SpeechServiceConnection_Endpoint,O.href),void 0!==B&&U.setProperty(Xl.SpeechServiceConnection_Key,B),U}static fromHost(O,B){Contracts.throwIfNull(O,"hostName");const U=new SpeechConfigImpl;return U.setProperty(Xl.SpeechServiceConnection_Host,O.protocol+"//"+O.hostname+(""===O.port?"":":"+O.port)),void 0!==B&&U.setProperty(Xl.SpeechServiceConnection_Key,B),U}static fromAuthorizationToken(O,B){Contracts.throwIfNull(O,"authorizationToken"),Contracts.throwIfNullOrWhitespace(B,"region");const U=new SpeechConfigImpl;return U.setProperty(Xl.SpeechServiceConnection_Region,B),U.setProperty(Xl.SpeechServiceConnection_IntentRegion,B),U.authorizationToken=O,U}close(){}}class SpeechConfigImpl extends SpeechConfig{constructor(){super(),this.privProperties=new PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=yc.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(Xl.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(Xl.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(Xl.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(Xl.SpeechServiceAuthorization_Token)}set authorizationToken(O){this.privProperties.setProperty(Xl.SpeechServiceAuthorization_Token,O)}get speechRecognitionLanguage(){return this.privProperties.getProperty(Xl.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(O){this.privProperties.setProperty(Xl.SpeechServiceConnection_RecoLanguage,O)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(Xl.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(O){this.privProperties.setProperty(Xl.SpeechServiceConnection_AutoDetectSourceLanguages,O)}get outputFormat(){return yc[this.privProperties.getProperty(dc,void 0)]}set outputFormat(O){this.privProperties.setProperty(dc,yc[O])}get endpointId(){return this.privProperties.getProperty(Xl.SpeechServiceConnection_EndpointId)}set endpointId(O){this.privProperties.setProperty(Xl.SpeechServiceConnection_EndpointId,O)}setProperty(O,B){Contracts.throwIfNull(B,"value"),this.privProperties.setProperty(O,B)}getProperty(O,B){return this.privProperties.getProperty(O,B)}setProxy(O,B,U,G){this.setProperty(Xl[Xl.SpeechServiceConnection_ProxyHostName],O),this.setProperty(Xl[Xl.SpeechServiceConnection_ProxyPort],B),this.setProperty(Xl[Xl.SpeechServiceConnection_ProxyUserName],U),this.setProperty(Xl[Xl.SpeechServiceConnection_ProxyPassword],G)}setServiceProperty(O,B){const U=JSON.parse(this.privProperties.getProperty(uc,"{}"));U[O]=B,this.privProperties.setProperty(uc,JSON.stringify(U))}setProfanity(O){this.privProperties.setProperty(Xl.SpeechServiceResponse_ProfanityOption,_c[O])}enableAudioLogging(){this.privProperties.setProperty(Xl.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(Xl.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(hc,"true")}clone(){const O=new SpeechConfigImpl;return O.privProperties=this.privProperties.clone(),O}get speechSynthesisLanguage(){return this.privProperties.getProperty(Xl.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(O){this.privProperties.setProperty(Xl.SpeechServiceConnection_SynthLanguage,O)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(Xl.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(O){this.privProperties.setProperty(Xl.SpeechServiceConnection_SynthVoice,O)}get speechSynthesisOutputFormat(){return mc[this.privProperties.getProperty(Xl.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(O){this.privProperties.setProperty(Xl.SpeechServiceConnection_SynthOutputFormat,mc[O])}}var bc=U(5242),Sc=U.n(bc);class ConnectionOpenResponse{constructor(O,B){this.privStatusCode=O,this.privReason=B}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}class RawWebsocketMessage{constructor(O,B,U){if(this.privPayload=null,!B)throw new ArgumentNullError("payload");if(O===sc.Binary&&"ArrayBuffer"!==B.__proto__.constructor.name)throw new InvalidOperationError("Payload must be ArrayBuffer");if(O===sc.Text&&"string"!=typeof B)throw new InvalidOperationError("Payload must be a string");this.privMessageType=O,this.privPayload=B,this.privId=U||createNoDashGuid()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===sc.Binary)throw new InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===sc.Text)throw new InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}}var Cc=U(958),Ec=U(3797);class OCSPEvent extends PlatformEvent{constructor(O,B,U){super(O,B),this.privSignature=U}}class OCSPMemoryCacheHitEvent extends OCSPEvent{constructor(O){super("OCSPMemoryCacheHitEvent",nc.Debug,O)}}class OCSPCacheMissEvent extends OCSPEvent{constructor(O){super("OCSPCacheMissEvent",nc.Debug,O)}}class OCSPDiskCacheHitEvent extends OCSPEvent{constructor(O){super("OCSPDiskCacheHitEvent",nc.Debug,O)}}class OCSPCacheUpdateNeededEvent extends OCSPEvent{constructor(O){super("OCSPCacheUpdateNeededEvent",nc.Debug,O)}}class OCSPMemoryCacheStoreEvent extends OCSPEvent{constructor(O){super("OCSPMemoryCacheStoreEvent",nc.Debug,O)}}class OCSPDiskCacheStoreEvent extends OCSPEvent{constructor(O){super("OCSPDiskCacheStoreEvent",nc.Debug,O)}}class OCSPCacheUpdateCompleteEvent extends OCSPEvent{constructor(O){super("OCSPCacheUpdateCompleteEvent",nc.Debug,O)}}class OCSPStapleReceivedEvent extends OCSPEvent{constructor(){super("OCSPStapleReceivedEvent",nc.Debug,"")}}class OCSPCacheEntryExpiredEvent extends OCSPEvent{constructor(O,B){super("OCSPCacheEntryExpiredEvent",nc.Debug,O),this.privExpireTime=B}}class OCSPCacheEntryNeedsRefreshEvent extends OCSPEvent{constructor(O,B,U){super("OCSPCacheEntryNeedsRefreshEvent",nc.Debug,O),this.privExpireTime=U,this.privStartTime=B}}class OCSPCacheHitEvent extends OCSPEvent{constructor(O,B,U){super("OCSPCacheHitEvent",nc.Debug,O),this.privExpireTime=U,this.privExpireTimeString=new Date(U).toLocaleDateString(),this.privStartTime=B,this.privStartTimeString=new Date(B).toLocaleTimeString()}}class OCSPVerificationFailedEvent extends OCSPEvent{constructor(O,B){super("OCSPVerificationFailedEvent",nc.Debug,O),this.privError=B}}class OCSPCacheFetchErrorEvent extends OCSPEvent{constructor(O,B){super("OCSPCacheFetchErrorEvent",nc.Debug,O),this.privError=B}}class OCSPResponseRetrievedEvent extends OCSPEvent{constructor(O){super("OCSPResponseRetrievedEvent",nc.Debug,O)}}class OCSPCacheUpdateErrorEvent extends OCSPEvent{constructor(O,B){super("OCSPCacheUpdateErrorEvent",nc.Debug,O),this.privError=B}}var xc=U(5500),Tc=U.n(xc),wc=U(4949),kc=U.n(wc),Ac=U(4295),Rc=U.n(Ac),Ic=U(7277),CertChecks_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class CertCheckAgent{constructor(O){O&&(this.privProxyInfo=O),CertCheckAgent.privDiskCache||(CertCheckAgent.privDiskCache=new(kc())("microsoft-cognitiveservices-speech-sdk-cache",{supportBuffer:!0,location:"undefined"!=typeof process&&process.env.SPEECH_OCSP_CACHE_ROOT?process.env.SPEECH_OCSP_CACHE_ROOT:void 0}))}static forceReinitDiskCache(){CertCheckAgent.privDiskCache=void 0,CertCheckAgent.privMemCache={}}GetAgent(O){const B=new(Tc().Agent)(this.CreateConnection);if(void 0!==this.privProxyInfo&&void 0!==this.privProxyInfo.HostName&&this.privProxyInfo.Port>0){B["privProxyInfo"]=this.privProxyInfo}return B}static GetProxyAgent(O){const B={host:O.HostName,port:O.Port};O.UserName?B.headers={"Proxy-Authentication":"Basic "+new Buffer(`${O.UserName}:${void 0===O.Password?"":O.Password}`).toString("base64")}:B.headers={},B.headers.requestOCSP="true";return new(Rc())(B)}static OCSPCheck(O,B){return CertChecks_awaiter(this,void 0,void 0,(function*(){let U,G,q=!1;const j=yield O;j.cork();const W=j;return new Promise(((O,Y)=>{j.on("OCSPResponse",(O=>{O&&(this.onEvent(new OCSPStapleReceivedEvent),G=O)})),j.on("error",(O=>{q||(q=!0,j.destroy(),Y(O))})),W.on("secure",(()=>CertChecks_awaiter(this,void 0,void 0,(function*(){const K=W.getPeerCertificate(!0);try{const W=yield this.GetIssuer(K);U=Ec.request.generate(K.raw,W.raw);const Y=U.id.toString("hex");if(!G){const O=yield CertCheckAgent.GetResponseFromCache(Y,U,B);G=O}yield this.VerifyOCSPResponse(G,U,B),j.uncork(),q=!0,O(j)}catch(O){j.destroy(),q=!0,Y(O)}}))))}))}))}static GetIssuer(O){return O.issuerCertificate?Promise.resolve(O.issuerCertificate):new Promise(((B,U)=>{new Ec.Agent({}).fetchIssuer(O,null,((O,G)=>{O?U(O):B(G)}))}))}static GetResponseFromCache(O,B,U){return CertChecks_awaiter(this,void 0,void 0,(function*(){let G=CertCheckAgent.privMemCache[O];if(G&&this.onEvent(new OCSPMemoryCacheHitEvent(O)),!G)try{const B=yield CertCheckAgent.privDiskCache.get(O);B.isCached&&(CertCheckAgent.onEvent(new OCSPDiskCacheHitEvent(O)),CertCheckAgent.StoreMemoryCacheEntry(O,B.value),G=B.value)}catch(O){G=null}if(!G)return G;try{const q=Ec.utils.parseResponse(G),j=q.value.tbsResponseData;if(j.responses.length<1)return void this.onEvent(new OCSPCacheFetchErrorEvent(O,"Not enough data in cached response"));const W=j.responses[0].thisUpdate,Y=j.responses[0].nextUpdate;if(Y<Date.now()+this.testTimeOffset-6e4)this.onEvent(new OCSPCacheEntryExpiredEvent(O,Y)),G=null;else{const G=Math.min(864e5,(Y-W)/2);Y-(Date.now()+this.testTimeOffset)<G?(this.onEvent(new OCSPCacheEntryNeedsRefreshEvent(O,W,Y)),this.UpdateCache(B,U).catch((B=>{this.onEvent(new OCSPCacheUpdateErrorEvent(O,B.toString()))}))):this.onEvent(new OCSPCacheHitEvent(O,W,Y))}}catch(B){this.onEvent(new OCSPCacheFetchErrorEvent(O,B)),G=null}return G||this.onEvent(new OCSPCacheMissEvent(O)),G}))}static VerifyOCSPResponse(O,B,U){return CertChecks_awaiter(this,void 0,void 0,(function*(){let G=O;return G||(G=yield CertCheckAgent.GetOCSPResponse(B,U)),new Promise(((q,j)=>{Ec.verify({request:B,response:G},(W=>{W?(CertCheckAgent.onEvent(new OCSPVerificationFailedEvent(B.id.toString("hex"),W)),O?this.VerifyOCSPResponse(null,B,U).then((()=>{q()}),(O=>{j(O)})):j(W)):(O||CertCheckAgent.StoreCacheEntry(B.id.toString("hex"),G),q())}))}))}))}static UpdateCache(O,B){return CertChecks_awaiter(this,void 0,void 0,(function*(){const U=O.id.toString("hex");this.onEvent(new OCSPCacheUpdateNeededEvent(U));const G=yield this.GetOCSPResponse(O,B);this.StoreCacheEntry(U,G),this.onEvent(new OCSPCacheUpdateCompleteEvent(O.id.toString("hex")))}))}static StoreCacheEntry(O,B){this.StoreMemoryCacheEntry(O,B),this.StoreDiskCacheEntry(O,B)}static StoreMemoryCacheEntry(O,B){this.privMemCache[O]=B,this.onEvent(new OCSPMemoryCacheStoreEvent(O))}static StoreDiskCacheEntry(O,B){this.privDiskCache.set(O,B).then((()=>{this.onEvent(new OCSPDiskCacheStoreEvent(O))}))}static GetOCSPResponse(O,B){let U={};if(B){const O=CertCheckAgent.GetProxyAgent(B);U.agent=O}return new Promise(((B,G)=>{Ec.utils.getAuthorityInfo(O.cert,"1.3.6.1.5.5.7.48.1",((q,j)=>{if(q)return void G(q);const W=new URL(j);U=Object.assign(Object.assign({},U),{host:W.host,protocol:W.protocol,port:W.port,path:W.pathname,hostname:W.host}),Ec.utils.getResponse(U,O.data,((U,q)=>{if(U)return void G(U);const j=O.certID;this.onEvent(new OCSPResponseRetrievedEvent(j.toString("hex"))),B(q)}))}))}))}static onEvent(O){Events.instance.onEvent(O)}CreateConnection(O,B){const U="undefined"!=typeof process&&"0"!==process.env.NODE_TLS_REJECT_UNAUTHORIZED&&"0"!==process.env.SPEECH_CONDUCT_OCSP_CHECK&&B.secureEndpoint;let G;if(B=Object.assign(Object.assign({},B),{requestOCSP:!CertCheckAgent.forceDisableOCSPStapling,servername:B.host}),this.privProxyInfo){const U=CertCheckAgent.GetProxyAgent(this.privProxyInfo);G=new Promise(((G,q)=>{U.callback(O,B,((O,B)=>{O?q(O):G(B)}))}))}else G=B.secureEndpoint?Promise.resolve(Cc.connect(B)):Promise.resolve(Ic.connect(B));return U?CertCheckAgent.OCSPCheck(G,this.privProxyInfo):G}}CertCheckAgent.testTimeOffset=0,CertCheckAgent.forceDisableOCSPStapling=!1,CertCheckAgent.privMemCache={};var WebsocketMessageAdapter_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class WebsocketMessageAdapter{constructor(O,B,U,G,q,j){if(!O)throw new ArgumentNullError("uri");if(!U)throw new ArgumentNullError("messageFormatter");this.proxyInfo=G,this.privConnectionEvents=new EventSource_EventSource,this.privConnectionId=B,this.privMessageFormatter=U,this.privConnectionState=lc.None,this.privUri=O,this.privHeaders=q,this.privEnableCompression=j,this.privHeaders[HeaderNames.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===lc.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new Deferred,this.privCertificateValidatedDeferral=new Deferred,this.privConnectionState=lc.Connecting;try{if("undefined"==typeof WebSocket||WebsocketMessageAdapter.forceNpmWebSocket){const O={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve();const B=new CertCheckAgent(this.proxyInfo);O.agent=B.GetAgent();let U=new URL(this.privUri).protocol;"wss:"===(null==U?void 0:U.toLocaleLowerCase())?U="https:":"ws:"===(null==U?void 0:U.toLocaleLowerCase())&&(U="http:"),O.agent.protocol=U,this.privWebsocketClient=new(Sc())(this.privUri,O)}else this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new Queue_Queue,this.privDisconnectDeferral=new Deferred,this.privSendMessageQueue=new Queue_Queue,this.processSendQueue().catch((O=>{Events.instance.onEvent(new BackgroundEvent(O))}))}catch(O){return this.privConnectionEstablishDeferral.resolve(new ConnectionOpenResponse(500,O)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then((()=>{this.privConnectionState=lc.Connected,this.onEvent(new ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new ConnectionOpenResponse(200,""))}),(O=>{this.privConnectionEstablishDeferral.reject(O)}))},this.privWebsocketClient.onerror=O=>{this.onEvent(new ConnectionErrorEvent(this.privConnectionId,O.message,O.type)),this.privLastErrorReceived=O.message},this.privWebsocketClient.onclose=O=>{this.privConnectionState===lc.Connecting?(this.privConnectionState=lc.Disconnected,this.privConnectionEstablishDeferral.resolve(new ConnectionOpenResponse(O.code,O.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=lc.Disconnected,this.privWebsocketClient=null,this.onEvent(new ConnectionClosedEvent(this.privConnectionId,O.code,O.reason))),this.onClose(O.code,O.reason).catch((O=>{Events.instance.onEvent(new BackgroundEvent(O))}))},this.privWebsocketClient.onmessage=O=>{const B=(new Date).toISOString();if(this.privConnectionState===lc.Connected){const U=new Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(U.promise),O.data instanceof ArrayBuffer){const G=new RawWebsocketMessage(sc.Binary,O.data);this.privMessageFormatter.toConnectionMessage(G).then((O=>{this.onEvent(new ConnectionMessageReceivedEvent(this.privConnectionId,B,O)),U.resolve(O)}),(O=>{U.reject(`Invalid binary message format. Error: ${O}`)}))}else{const G=new RawWebsocketMessage(sc.Text,O.data);this.privMessageFormatter.toConnectionMessage(G).then((O=>{this.onEvent(new ConnectionMessageReceivedEvent(this.privConnectionId,B,O)),U.resolve(O)}),(O=>{U.reject(`Invalid text message format. Error: ${O}`)}))}}},this.privConnectionEstablishDeferral.promise}send(O){if(this.privConnectionState!==lc.Connected)return Promise.reject(`Cannot send on connection that is in ${lc[this.privConnectionState]} state`);const B=new Deferred,U=new Deferred;return this.privSendMessageQueue.enqueueFromPromise(U.promise),this.privMessageFormatter.fromConnectionMessage(O).then((G=>{U.resolve({Message:O,RawWebsocketMessage:G,sendStatusDeferral:B})}),(O=>{U.reject(`Error formatting the message. ${O}`)})),B.promise}read(){return this.privConnectionState!==lc.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(O){return this.privWebsocketClient?(this.privConnectionState!==lc.Disconnected&&this.privWebsocketClient.close(1e3,O||"Normal closure by client"),this.privDisconnectDeferral.promise):Promise.resolve()}get events(){return this.privConnectionEvents}sendRawMessage(O){try{return O?(this.onEvent(new ConnectionMessageSentEvent(this.privConnectionId,(new Date).toISOString(),O.Message)),this.isWebsocketOpen?(this.privWebsocketClient.send(O.RawWebsocketMessage.payload),Promise.resolve()):Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+O.Message.id+" "+(new Error).stack)):Promise.resolve()}catch(O){return Promise.reject(`websocket send error: ${O}`)}}onClose(O,B){return WebsocketMessageAdapter_awaiter(this,void 0,void 0,(function*(){const U=`Connection closed. ${O}: ${B}`;this.privConnectionState=lc.Disconnected,this.privDisconnectDeferral.resolve(),yield this.privReceivingMessageQueue.drainAndDispose((()=>{}),U),yield this.privSendMessageQueue.drainAndDispose((O=>{O.sendStatusDeferral.reject(U)}),U)}))}processSendQueue(){return WebsocketMessageAdapter_awaiter(this,void 0,void 0,(function*(){for(;;){const O=this.privSendMessageQueue.dequeue(),B=yield O;if(!B)return;try{yield this.sendRawMessage(B),B.sendStatusDeferral.resolve()}catch(O){B.sendStatusDeferral.reject(O)}}}))}onEvent(O){this.privConnectionEvents.onEvent(O),Events.instance.onEvent(O)}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}}WebsocketMessageAdapter.forceNpmWebSocket=!1;var WebsocketConnection_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class WebsocketConnection{constructor(O,B,U,G,q,j=!1,W){if(this.privIsDisposed=!1,!O)throw new ArgumentNullError("uri");if(!G)throw new ArgumentNullError("messageFormatter");this.privMessageFormatter=G;let Y="",K=0;if(B)for(const U in B)if(U){Y+=0===K&&-1===O.indexOf("?")?"?":"&";Y+=encodeURIComponent(U);let G=B[U];G&&(G=encodeURIComponent(G),Y+=`=${G}`),K++}if(U)for(const B in U)if(B){Y+=0===K&&-1===O.indexOf("?")?"?":"&";Y+=`${B}=${encodeURIComponent(U[B])}`,K++}this.privUri=O+Y,this.privId=W||createNoDashGuid(),this.privConnectionMessageAdapter=new WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,q,U,j)}dispose(){return WebsocketConnection_awaiter(this,void 0,void 0,(function*(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&(yield this.privConnectionMessageAdapter.close())}))}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(O){return this.privConnectionMessageAdapter.send(O)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}}class ProxyInfo{constructor(O,B,U,G){this.privProxyHostName=O,this.privProxyPort=B,this.privProxyUserName=U,this.privProxyPassword=G}static fromParameters(O){return new ProxyInfo(O.getProperty(Xl.SpeechServiceConnection_ProxyHostName),parseInt(O.getProperty(Xl.SpeechServiceConnection_ProxyPort),10),O.getProperty(Xl.SpeechServiceConnection_ProxyUserName),O.getProperty(Xl.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(O){return this.fromParameters(O.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}}class QueryParameterNames{}QueryParameterNames.BotId="botid",QueryParameterNames.CustomSpeechDeploymentId="cid",QueryParameterNames.CustomVoiceDeploymentId="deploymentId",QueryParameterNames.EnableAudioLogging="storeAudio",QueryParameterNames.EnableLanguageId="lidEnabled",QueryParameterNames.EnableWordLevelTimestamps="wordLevelTimestamps",QueryParameterNames.EndSilenceTimeoutMs="endSilenceTimeoutMs",QueryParameterNames.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",QueryParameterNames.Format="format",QueryParameterNames.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",QueryParameterNames.Language="language",QueryParameterNames.Profanity="profanity",QueryParameterNames.RequestBotStatusMessages="enableBotMessageStatus",QueryParameterNames.StableIntermediateThreshold="stableIntermediateThreshold",QueryParameterNames.StableTranslation="stableTranslation",QueryParameterNames.TestHooks="testhooks",QueryParameterNames.Postprocessing="postprocessing",QueryParameterNames.CtsMeetingId="meetingId",QueryParameterNames.CtsDeviceId="deviceId",QueryParameterNames.CtsIsParticipant="isParticipant";class ConnectionFactoryBase{static getHostSuffix(O){if(O){if(O.toLowerCase().startsWith("china"))return".azure.cn";if(O.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(O,B,U){new Map([[Xl.Speech_SegmentationSilenceTimeoutMs,QueryParameterNames.SegmentationSilenceTimeoutMs],[Xl.SpeechServiceConnection_EnableAudioLogging,QueryParameterNames.EnableAudioLogging],[Xl.SpeechServiceConnection_EndSilenceTimeoutMs,QueryParameterNames.EndSilenceTimeoutMs],[Xl.SpeechServiceConnection_InitialSilenceTimeoutMs,QueryParameterNames.InitialSilenceTimeoutMs],[Xl.SpeechServiceResponse_PostProcessingOption,QueryParameterNames.Postprocessing],[Xl.SpeechServiceResponse_ProfanityOption,QueryParameterNames.Profanity],[Xl.SpeechServiceResponse_RequestWordLevelTimestamps,QueryParameterNames.EnableWordLevelTimestamps],[Xl.SpeechServiceResponse_StablePartialResultThreshold,QueryParameterNames.StableIntermediateThreshold]]).forEach(((G,q)=>{this.setUrlParameter(q,G,O,B,U)}));const G=JSON.parse(O.parameters.getProperty(uc,"{}"));Object.keys(G).forEach((O=>{B[O]=G[O]}))}setUrlParameter(O,B,U,G,q){const j=U.parameters.getProperty(O,void 0);!j||q&&-1!==q.search(B)||(G[B]=j.toLocaleLowerCase())}}class WebsocketMessageFormatter{toConnectionMessage(O){const B=new Deferred;try{if(O.messageType===sc.Text){const U=O.textContent;let G={},q=null;if(U){const O=U.split("\r\n\r\n");O&&O.length>0&&(G=this.parseHeaders(O[0]),O.length>1&&(q=O[1]))}B.resolve(new ConnectionMessage(O.messageType,q,G,O.id))}else if(O.messageType===sc.Binary){const U=O.binaryContent;let G={},q=null;if(!U||U.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const j=new DataView(U),W=j.getInt16(0);if(U.byteLength<W+2)throw new Error("Invalid binary message format. Header content missing.");let Y="";for(let O=0;O<W;O++)Y+=String.fromCharCode(j.getInt8(O+2));G=this.parseHeaders(Y),U.byteLength>W+2&&(q=U.slice(2+W)),B.resolve(new ConnectionMessage(O.messageType,q,G,O.id))}}catch(O){B.reject(`Error formatting the message. Error: ${O}`)}return B.promise}fromConnectionMessage(O){const B=new Deferred;try{if(O.messageType===sc.Text){const U=`${this.makeHeaders(O)}\r\n${O.textBody?O.textBody:""}`;B.resolve(new RawWebsocketMessage(sc.Text,U,O.id))}else if(O.messageType===sc.Binary){const U=this.makeHeaders(O),G=O.binaryBody,q=this.stringToArrayBuffer(U),j=new Int8Array(q),W=j.byteLength,Y=new Int8Array(2+W+(G?G.byteLength:0));if(Y[0]=W>>8&255,Y[1]=255&W,Y.set(j,2),G){const O=new Int8Array(G);Y.set(O,2+W)}const K=Y.buffer;B.resolve(new RawWebsocketMessage(sc.Binary,K,O.id))}}catch(O){B.reject(`Error formatting the message. ${O}`)}return B.promise}makeHeaders(O){let B="";if(O.headers)for(const U in O.headers)U&&(B+=`${U}: ${O.headers[U]}\r\n`);return B}parseHeaders(O){const B={};if(O){const U=O.match(/[^\r\n]+/g);if(B)for(const O of U)if(O){const U=O.indexOf(":"),G=U>0?O.substr(0,U).trim().toLowerCase():O,q=U>0&&O.length>U+1?O.substr(U+1).trim():"";B[G]=q}}return B}stringToArrayBuffer(O){const B=new ArrayBuffer(O.length),U=new DataView(B);for(let B=0;B<O.length;B++)U.setUint8(B,O.charCodeAt(B));return B}}class SpeechConnectionFactory extends ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(O,B,U){let G=O.parameters.getProperty(Xl.SpeechServiceConnection_Endpoint,void 0);const q=O.parameters.getProperty(Xl.SpeechServiceConnection_Region,void 0),j=ConnectionFactoryBase.getHostSuffix(q),W=O.parameters.getProperty(Xl.SpeechServiceConnection_Host,"wss://"+q+".stt.speech"+j),Y={},K=O.parameters.getProperty(Xl.SpeechServiceConnection_EndpointId,void 0),Q=O.parameters.getProperty(Xl.SpeechServiceConnection_RecoLanguage,void 0);if(K?G&&-1!==G.search(QueryParameterNames.CustomSpeechDeploymentId)||(Y[QueryParameterNames.CustomSpeechDeploymentId]=K):Q&&(G&&-1!==G.search(QueryParameterNames.Language)||(Y[QueryParameterNames.Language]=Q)),G&&-1!==G.search(QueryParameterNames.Format)||(Y[QueryParameterNames.Format]=O.parameters.getProperty(dc,yc[yc.Simple]).toLowerCase()),void 0!==O.autoDetectSourceLanguages&&(Y[QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(O,Y,G),!G)switch(O.recognitionMode){case Jl.Conversation:G="true"===O.parameters.getProperty(hc,"false")?W+this.dictationRelativeUri:void 0!==O.recognitionEndpointVersion&&parseInt(O.recognitionEndpointVersion,10)>1?`${W}${this.universalUri}${O.recognitionEndpointVersion}`:W+this.conversationRelativeUri;break;case Jl.Dictation:G=W+this.dictationRelativeUri;break;default:G=void 0!==O.recognitionEndpointVersion&&parseInt(O.recognitionEndpointVersion,10)>1?`${W}${this.universalUri}${O.recognitionEndpointVersion}`:W+this.interactiveRelativeUri}const Z={};void 0!==B.token&&""!==B.token&&(Z[B.headerName]=B.token),Z[HeaderNames.ConnectionId]=U;const X="true"===O.parameters.getProperty("SPEECH-EnableWebsocketCompression","false"),J=new WebsocketConnection(G,Y,Z,new WebsocketMessageFormatter,ProxyInfo.fromRecognizerConfig(O),X,U),ee=J.uri;return O.parameters.setProperty(Xl.SpeechServiceConnection_Url,ee),J}}class RecognitionResult{constructor(O,B,U,G,q,j,W,Y,K,Q){this.privResultId=O,this.privReason=B,this.privText=U,this.privDuration=G,this.privOffset=q,this.privLanguage=j,this.privLanguageDetectionConfidence=W,this.privErrorDetails=Y,this.privJson=K,this.privProperties=Q}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}class SpeechRecognitionResult extends RecognitionResult{constructor(O,B,U,G,q,j,W,Y,K,Q,Z){super(O,B,U,G,q,j,W,K,Q,Z),this.privSpeakerId=Y}get speakerId(){return this.privSpeakerId}}class SessionEventArgs{constructor(O){this.privSessionId=O}get sessionId(){return this.privSessionId}}class RecognitionEventArgs extends SessionEventArgs{constructor(O,B){super(B),this.privOffset=O}get offset(){return this.privOffset}}class SpeechRecognitionEventArgs extends RecognitionEventArgs{constructor(O,B,U){super(B,U),this.privResult=O}get result(){return this.privResult}}class CancellationEventArgsBase extends RecognitionEventArgs{constructor(O,B,U,G,q){super(G,q),this.privReason=O,this.privErrorDetails=B,this.privErrorCode=U}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class SpeechRecognitionCanceledEventArgs extends CancellationEventArgsBase{}class ReplayableAudioNode{constructor(O,B){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=O,this.privBytesPerSecond=B}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&0!==this.privBuffers.length){const O=this.privReplayOffset-this.privBufferStartOffset;let B=Math.round(O*this.privBytesPerSecond*1e-7);0!=B%2&&B++;let U=0;for(;U<this.privBuffers.length&&B>=this.privBuffers[U].chunk.buffer.byteLength;)B-=this.privBuffers[U++].chunk.buffer.byteLength;if(U<this.privBuffers.length){const O=this.privBuffers[U].chunk.buffer.slice(B);return this.privReplayOffset+=O.byteLength/this.privBytesPerSecond*1e7,U===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:O,isEnd:!1,timeReceived:this.privBuffers[U].chunk.timeReceived})}}return this.privAudioNode.read().then((O=>(O&&O.buffer&&(this.privBuffers.push(new BufferEntry(O,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=O.buffer.byteLength),O)))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(O){if(void 0===this.privBuffers||0===this.privBuffers.length)return;this.privLastShrinkOffset=O;const B=O-this.privBufferStartOffset;let U=Math.round(B*this.privBytesPerSecond*1e-7),G=0;for(;G<this.privBuffers.length&&U>=this.privBuffers[G].chunk.buffer.byteLength;)U-=this.privBuffers[G++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(O-U/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(G)}findTimeAtOffset(O){if(O<this.privBufferStartOffset||void 0===this.privBuffers)return 0;for(const B of this.privBuffers){const U=B.byteOffset/this.privBytesPerSecond*1e7,G=U+B.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(O>=U&&O<=G)return B.chunk.timeReceived}return 0}}class BufferEntry{constructor(O,B,U){this.chunk=O,this.serial=B,this.byteOffset=U}}class Timeout{static load(){const O=new Map([[0,()=>{}]]),B=new Map,U="data:text/javascript;base64,"+btoa('!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error(\'The given method "\'.concat(e.method,\'" is not supported\'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);'),G=new Worker(U);G.addEventListener("message",(({data:U})=>{if(Timeout.isCallNotification(U)){const{params:{timerId:G}}=U,q=O.get(G);if("number"==typeof q){const O=B.get(q);if(void 0===O||O!==G)throw new Error("The timer is in an undefined state.")}else{if(void 0===q)throw new Error("The timer is in an undefined state.");q(),O.delete(G)}}else{if(!Timeout.isClearResponse(U)){const{error:{message:O}}=U;throw new Error(O)}{const{id:G}=U,q=B.get(G);if(void 0===q)throw new Error("The timer is in an undefined state.");B.delete(G),O.delete(q)}}}));return{clearTimeout:U=>{const q=Math.random();B.set(q,U),O.set(U,q),G.postMessage({id:q,method:"clear",params:{timerId:U}})},setTimeout:(B,U)=>{const q=Math.random();return O.set(q,B),G.postMessage({id:null,method:"set",params:{delay:U,now:performance.now(),timerId:q}}),q}}}static loadWorkerTimers(){return()=>(null!==Timeout.workerTimers||(Timeout.workerTimers=Timeout.load()),Timeout.workerTimers)}static isCallNotification(O){return void 0!==O.method&&"call"===O.method}static isClearResponse(O){return null===O.error&&"number"==typeof O.id}}Timeout.workerTimers=null,Timeout.clearTimeout=O=>Timeout.timers().clearTimeout(O),Timeout.setTimeout=(O,B)=>Timeout.timers().setTimeout(O,B),Timeout.timers=Timeout.loadWorkerTimers();class SpeechRecognitionEvent extends PlatformEvent{constructor(O,B,U,G=nc.Info){super(O,G),this.privRequestId=B,this.privSessionId=U}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}class RecognitionTriggeredEvent extends SpeechRecognitionEvent{constructor(O,B,U,G){super("RecognitionTriggeredEvent",O,B),this.privAudioSourceId=U,this.privAudioNodeId=G}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class ListeningStartedEvent extends SpeechRecognitionEvent{constructor(O,B,U,G){super("ListeningStartedEvent",O,B),this.privAudioSourceId=U,this.privAudioNodeId=G}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class ConnectingToServiceEvent extends SpeechRecognitionEvent{constructor(O,B,U){super("ConnectingToServiceEvent",O,U),this.privAuthFetchEventid=B}get authFetchEventid(){return this.privAuthFetchEventid}}class RecognitionStartedEvent extends SpeechRecognitionEvent{constructor(O,B,U,G,q){super("RecognitionStartedEvent",O,q),this.privAudioSourceId=B,this.privAudioNodeId=U,this.privAuthFetchEventId=G}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}var Pc;(function(O){O[O.Success=0]="Success",O[O.AudioSourceError=1]="AudioSourceError",O[O.AudioSourceTimeout=2]="AudioSourceTimeout",O[O.AuthTokenFetchError=3]="AuthTokenFetchError",O[O.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",O[O.UnAuthorized=5]="UnAuthorized",O[O.ConnectTimeout=6]="ConnectTimeout",O[O.ConnectError=7]="ConnectError",O[O.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",O[O.UnknownError=9]="UnknownError"})(Pc||(Pc={}));class ServiceTelemetryListener{constructor(O,B,U){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=O,this.privAudioSourceId=B,this.privAudioNodeId=U,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(O){O>0&&this.privPhraseLatencies.push(Date.now()-O)}hypothesisReceived(O){O>0&&this.privHypothesisLatencies.push(Date.now()-O)}onEvent(O){if(!this.privIsDisposed&&(O instanceof RecognitionTriggeredEvent&&O.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:O.eventTime,Name:"ListeningTrigger",Start:O.eventTime}),O instanceof AudioStreamNodeAttachingEvent&&O.audioSourceId===this.privAudioSourceId&&O.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=O.eventTime),O instanceof AudioStreamNodeAttachedEvent&&O.audioSourceId===this.privAudioSourceId&&O.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=O.eventTime),O instanceof AudioSourceErrorEvent&&O.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:O.eventTime,Error:O.error,Name:"Microphone",Start:this.privMicStartTime})),O instanceof AudioStreamNodeErrorEvent&&O.audioSourceId===this.privAudioSourceId&&O.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:O.eventTime,Error:O.error,Name:"Microphone",Start:this.privMicStartTime})),O instanceof AudioStreamNodeDetachedEvent&&O.audioSourceId===this.privAudioSourceId&&O.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:O.eventTime,Name:"Microphone",Start:this.privMicStartTime})),O instanceof ConnectingToServiceEvent&&O.requestId===this.privRequestId&&(this.privConnectionId=O.sessionId),O instanceof ConnectionStartEvent&&O.connectionId===this.privConnectionId&&(this.privConnectionStartTime=O.eventTime),O instanceof ConnectionEstablishedEvent&&O.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:O.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),O instanceof ConnectionEstablishErrorEvent&&O.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:O.eventTime,Error:this.getConnectionError(O.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),O instanceof ConnectionMessageReceivedEvent&&O.connectionId===this.privConnectionId&&O.message&&O.message.headers&&O.message.headers.path)){this.privReceivedMessages[O.message.headers.path]||(this.privReceivedMessages[O.message.headers.path]=new Array);const B=50;this.privReceivedMessages[O.message.headers.path].length<B&&this.privReceivedMessages[O.message.headers.path].push(O.networkReceivedTime)}}getTelemetry(){const O=new Array;this.privListeningTriggerMetric&&O.push(this.privListeningTriggerMetric),this.privMicMetric&&O.push(this.privMicMetric),this.privConnectionEstablishMetric&&O.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&O.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&O.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const B={Metrics:O,ReceivedMessages:this.privReceivedMessages},U=JSON.stringify(B);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],U}get hasTelemetry(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length}dispose(){this.privIsDisposed=!0}getConnectionError(O){switch(O){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+O.toString()}}}var RequestSession_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class RequestSession{constructor(O){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=O,this.privRequestId=createNoDashGuid(),this.privAudioNodeId=createNoDashGuid(),this.privTurnDeferral=new Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}listenForServiceTelemetry(O){this.privServiceTelemetryListener&&this.privDetachables.push(O.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onAudioSourceAttachCompleted(O,B){return RequestSession_awaiter(this,void 0,void 0,(function*(){this.privAudioNode=O,this.privIsAudioNodeDetached=!1,B?yield this.onComplete():this.onEvent(new ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}))}onPreConnectionStart(O,B){this.privAuthFetchEventId=O,this.privSessionId=B,this.onEvent(new ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}onAuthCompleted(O){return RequestSession_awaiter(this,void 0,void 0,(function*(){O&&(yield this.onComplete())}))}onConnectionEstablishCompleted(O,B){return RequestSession_awaiter(this,void 0,void 0,(function*(){if(200===O)return this.onEvent(new RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,void(this.privBytesSent=0);403===O&&(yield this.onComplete())}))}onServiceTurnEndResponse(O){return RequestSession_awaiter(this,void 0,void 0,(function*(){this.privTurnDeferral.resolve(),!O||this.isSpeechEnded?(yield this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}))}onSpeechContext(){this.privRequestId=createNoDashGuid()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new Deferred}onHypothesis(O){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(O)))}onPhraseRecognized(O){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(O)),this.onServiceRecognized(O)}onServiceRecognized(O){this.privLastRecoOffset=O,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(O),this.privConnectionAttempts=0}onAudioSent(O){this.privBytesSent+=O}onRetryConnection(){this.privConnectionAttempts++}dispose(){return RequestSession_awaiter(this,void 0,void 0,(function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const O of this.privDetachables)yield O.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}))}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}onStopRecognizing(){return RequestSession_awaiter(this,void 0,void 0,(function*(){yield this.onComplete()}))}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(O){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(O),Events.instance.onEvent(O)}onComplete(){return RequestSession_awaiter(this,void 0,void 0,(function*(){this.privIsRecognizing&&(this.privIsRecognizing=!1,yield this.detachAudioNode())}))}detachAudioNode(){return RequestSession_awaiter(this,void 0,void 0,(function*(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&(yield this.privAudioNode.detach()))}))}}class DynamicGrammarBuilder{addPhrase(O){this.privPhrases||(this.privPhrases=[]),O instanceof Array?this.privPhrases=this.privPhrases.concat(O):this.privPhrases.push(O)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(O){this.privGrammars||(this.privGrammars=[]),O instanceof Array?this.privGrammars=this.privGrammars.concat(O):this.privGrammars.push(O)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(void 0===this.privGrammars&&void 0===this.privPhrases)return;const O={};if(O.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){const B=[];this.privPhrases.forEach((O=>{B.push({Text:O})})),O.Groups=[{Type:"Generic",Items:B}]}return O}}class SpeechContext{constructor(O){this.privContext={},this.privDynamicGrammar=O}setSection(O,B){this.privContext[O]=B}setPronunciationAssessmentParams(O){void 0===this.privContext.phraseDetection&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(O),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),-1===this.privContext.phraseOutput.detailed.options.indexOf("SNR")&&this.privContext.phraseOutput.detailed.options.push("SNR")}setWordLevelTimings(){void 0===this.privContext.phraseOutput&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),void 0===this.privContext.phraseOutput.detailed&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",-1===this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}toJSON(){const O=this.privDynamicGrammar.generateGrammarObject();this.setSection("dgi",O);return JSON.stringify(this.privContext)}}class SpeechDetected{constructor(O){this.privSpeechStartDetected=JSON.parse(O)}static fromJSON(O){return new SpeechDetected(O)}get Offset(){return this.privSpeechStartDetected.Offset}}var Nc,Oc,ServiceRecognizerBase_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class ServiceRecognizerBase{constructor(O,B,U,G,q){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!O)throw new ArgumentNullError("authentication");if(!B)throw new ArgumentNullError("connectionFactory");if(!U)throw new ArgumentNullError("audioSource");if(!G)throw new ArgumentNullError("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=O,this.privConnectionFactory=B,this.privAudioSource=U,this.privRecognizerConfig=G,this.privIsDisposed=!1,this.privRecognizer=q,this.privRequestSession=new RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new EventSource_EventSource,this.privServiceEvents=new EventSource_EventSource,this.privDynamicGrammar=new DynamicGrammarBuilder,this.privSpeechContext=new SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new AgentConfig,"undefined"!=typeof Blob&&"undefined"!=typeof Worker&&(this.privSetTimeout=Timeout.setTimeout),this.connectionEvents.attach((O=>{if("ConnectionClosedEvent"===O.name){const B=O;(1003===B.statusCode||1007===B.statusCode||1002===B.statusCode||4e3===B.statusCode||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(cc.Error,1007===B.statusCode?Zl.BadRequestParameters:Zl.ConnectionFailure,`${B.reason} websocket error code: ${B.statusCode}`)}}))}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(O){this.privRecognizerConfig.parameters.setProperty(Xl.ConversationTranslator_Token,O)}set authentication(O){this.privAuthentication=this.authentication}isDisposed(){return this.privIsDisposed}dispose(O){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privConnectionConfigurationPromise)try{const B=yield this.privConnectionConfigurationPromise;yield B.dispose(O)}catch(O){return}}))}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(O,B,U){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){if(void 0!==this.recognizeOverride)return void(yield this.recognizeOverride(O,B,U));this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=O,this.privSuccessCallback=B,this.privErrorCallback=U,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const G=this.connectImpl();let q;try{const O=yield this.audioSource.attach(this.privRequestSession.audioNodeId),B=yield this.audioSource.format,U=yield this.audioSource.deviceInfo;this.privIsLiveAudio=U.type&&U.type===ic.Microphones,q=new ReplayableAudioNode(O,B.avgBytesPerSec),yield this.privRequestSession.onAudioSourceAttachCompleted(q,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:U}}catch(O){throw yield this.privRequestSession.onStopRecognizing(),O}const j=new SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,j);try{yield G}catch(O){return void(yield this.cancelRecognitionLocal(cc.Error,Zl.ConnectionFailure,O))}this.receiveMessage();this.sendAudio(q).catch((O=>ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){yield this.cancelRecognitionLocal(cc.Error,Zl.RuntimeError,O)}))))}))}stopRecognizing(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing)try{yield this.audioSource.turnOff(),yield this.sendFinalAudio(),yield this.privRequestSession.onStopRecognizing(),yield this.privRequestSession.turnCompletionPromise}finally{yield this.privRequestSession.dispose()}}))}connect(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){return yield this.connectImpl(),Promise.resolve()}))}connectAsync(O,B){this.connectImpl().then((()=>{try{O&&O()}catch(O){B&&B(O)}}),(O=>{try{B&&B(O)}catch(O){}}))}disconnect(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){if(yield this.cancelRecognitionLocal(cc.Error,Zl.NoError,"Disconnecting"),void 0!==this.disconnectOverride&&(yield this.disconnectOverride()),void 0!==this.privConnectionPromise)try{yield(yield this.privConnectionPromise).dispose()}catch(O){}this.privConnectionPromise=void 0}))}sendMessage(O){}sendNetworkMessage(O,B){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){const U="string"==typeof B?sc.Text:sc.Binary,G="string"==typeof B?"application/json":"";return(yield this.fetchConnection()).send(new SpeechConnectionMessage(U,O,this.privRequestSession.requestId,G,B))}))}set activityTemplate(O){this.privActivityTemplate=O}get activityTemplate(){return this.privActivityTemplate}sendTelemetryData(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){const O=this.privRequestSession.getTelemetry();if(!0!==ServiceRecognizerBase.telemetryDataEnabled||this.privIsDisposed||null===O)return;if(ServiceRecognizerBase.telemetryData)try{ServiceRecognizerBase.telemetryData(O)}catch(O){}const B=yield this.fetchConnection();yield B.send(new SpeechConnectionMessage(sc.Text,"telemetry",this.privRequestSession.requestId,"application/json",O))}))}cancelRecognitionLocal(O,B,U){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,O,B,U))}))}receiveMessage(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){try{if(this.privIsDisposed)return;let O=yield this.fetchConnection();const B=yield O.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(!B)return this.privRequestSession.isRecognizing?this.receiveMessage():void 0;this.privServiceHasSentMessage=!0;const U=SpeechConnectionMessage.fromConnectionMessage(B);if(U.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(U.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const B=SpeechDetected.fromJSON(U.textBody),G=new RecognitionEventArgs(B.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,G);break;case"speech.enddetected":let q;q=U.textBody.length>0?U.textBody:"{ Offset: 0 }";const j=SpeechDetected.fromJSON(q);this.privRecognizerConfig.isContinuousRecognition&&this.privRequestSession.onServiceRecognized(j.Offset+this.privRequestSession.currentTurnAudioOffset);const W=new RecognitionEventArgs(j.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,W);break;case"turn.end":yield this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,yield this.cancelRecognitionLocal(cc.EndOfStream,Zl.NoError,void 0));const Y=new SessionEventArgs(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)return void(this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,Y));O=yield this.fetchConnection(),yield this.sendPrePayloadJSON(O);break;default:(yield this.processTypeSpecificMessages(U))||this.privServiceEvents&&this.serviceEvents.onEvent(new ServiceEvent(U.path.toLowerCase(),U.textBody))}return this.receiveMessage()}catch(O){return null}}))}sendSpeechContext(O,B){const U=this.speechContext.toJSON();if(B&&this.privRequestSession.onSpeechContext(),U)return O.send(new SpeechConnectionMessage(sc.Text,"speech.context",this.privRequestSession.requestId,"application/json",U))}sendPrePayloadJSON(O,B=!0){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){if(void 0!==this.sendPrePayloadJSONOverride)return this.sendPrePayloadJSONOverride(O);yield this.sendSpeechContext(O,B),yield this.sendWaveHeader(O)}))}sendWaveHeader(O){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){const B=yield this.audioSource.format;return O.send(new SpeechConnectionMessage(sc.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",B.header))}))}connectImpl(){return void 0!==this.privConnectionPromise?this.privConnectionPromise.then((O=>O.state()===lc.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()))):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch((()=>{})),void 0!==this.postConnectImplOverride?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(O,B,U){if(B.onSpeechContext(),!0!==ServiceRecognizerBase.telemetryDataEnabled){const O={context:{system:JSON.parse(U).context.system}};U=JSON.stringify(O)}if("true"===this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()){const O=JSON.parse(U);O.context.DisableReferenceChannel="True",O.context.MicSpec="1_0_0",U=JSON.stringify(O)}if(U)return O.send(new SpeechConnectionMessage(sc.Text,"speech.config",B.requestId,"application/json",U))}fetchConnection(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((O=>O.state()===lc.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}sendAudio(O){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){const B=yield this.audioSource.format;let U=Date.now();const G=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),q=B.avgBytesPerSec/1e3*parseInt(G,10),j=this.privRequestSession.recogNumber,readAndUploadCycle=()=>ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===j){const G=yield this.fetchConnection(),W=yield O.read();if(this.privRequestSession.isSpeechEnded)return;let Y,K;if(!W||W.isEnd?(Y=null,K=0):(Y=W.buffer,this.privRequestSession.onAudioSent(Y.byteLength),K=q>=this.privRequestSession.bytesSent?0:Math.max(0,U-Date.now())),0!==K&&(yield this.delay(K)),null!==Y&&(U=Date.now()+1e3*Y.byteLength/(2*B.avgBytesPerSec)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===j){if(G.send(new SpeechConnectionMessage(sc.Binary,"audio",this.privRequestSession.requestId,null,Y)).catch((()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch((()=>{}))})),!(null==W?void 0:W.isEnd))return readAndUploadCycle();this.privIsLiveAudio||this.privRequestSession.onSpeechEnded()}}}));return readAndUploadCycle()}))}retryableConnect(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){let O=!1;this.privAuthFetchEventId=createNoDashGuid();const B=this.privRequestSession.sessionId;this.privConnectionId=void 0!==B?B:createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let U=0,G="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const B=O?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId),q=yield B;yield this.privRequestSession.onAuthCompleted(!1);const j=this.privConnectionFactory.create(this.privRecognizerConfig,q,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(j.events),j.events.attach((O=>{this.connectionEvents.onEvent(O)}));const W=yield j.open();if(200===W.statusCode)return yield this.privRequestSession.onConnectionEstablishCompleted(W.statusCode),Promise.resolve(j);1006===W.statusCode&&(O=!0),U=W.statusCode,G=W.reason,this.privRequestSession.onRetryConnection()}return yield this.privRequestSession.onConnectionEstablishCompleted(U,G),Promise.reject(`Unable to contact server. StatusCode: ${U}, ${this.privRecognizerConfig.parameters.getProperty(Xl.SpeechServiceConnection_Endpoint)} Reason: ${G}`)}))}delay(O){return new Promise((B=>this.privSetTimeout(B,O)))}writeBufferToConsole(O){let B="Buffer Size: ";if(null===O)B+="null";else{const U=new Uint8Array(O);B+=`${O.byteLength}\r\n`;for(let G=0;G<O.byteLength;G++)B+=U[G].toString(16).padStart(2,"0")+" ",(G+1)%16==0&&(console.info(B),B="")}console.info(B)}sendFinalAudio(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){const O=yield this.fetchConnection();yield O.send(new SpeechConnectionMessage(sc.Binary,"audio",this.privRequestSession.requestId,null,null))}))}configureConnection(){return ServiceRecognizerBase_awaiter(this,void 0,void 0,(function*(){const O=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(O):(yield this.sendSpeechServiceConfig(O,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendPrePayloadJSON(O,!1),O)}))}}ServiceRecognizerBase.telemetryDataEnabled=!0;class SpeechHypothesis{constructor(O){this.privSpeechHypothesis=JSON.parse(O)}static fromJSON(O){return new SpeechHypothesis(O)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}}(function(O){O[O.Success=0]="Success",O[O.SynthesisEnd=1]="SynthesisEnd",O[O.Error=2]="Error"})(Nc||(Nc={})),function(O){O[O.Success=0]="Success",O[O.NoMatch=1]="NoMatch",O[O.InitialSilenceTimeout=2]="InitialSilenceTimeout",O[O.BabbleTimeout=3]="BabbleTimeout",O[O.Error=4]="Error",O[O.EndOfDictation=5]="EndOfDictation",O[O.TooManyRequests=6]="TooManyRequests",O[O.BadRequest=7]="BadRequest",O[O.Forbidden=8]="Forbidden"}(Oc||(Oc={}));class SimpleSpeechPhrase{constructor(O){this.privSimpleSpeechPhrase=JSON.parse(O),this.privSimpleSpeechPhrase.RecognitionStatus=Oc[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(O){return new SimpleSpeechPhrase(O)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}}class EnumTranslation{static implTranslateRecognitionResult(O){let B=Ql.Canceled;switch(O){case Oc.Success:B=Ql.RecognizedSpeech;break;case Oc.NoMatch:case Oc.InitialSilenceTimeout:case Oc.BabbleTimeout:case Oc.EndOfDictation:B=Ql.NoMatch;break;case Oc.Error:case Oc.BadRequest:case Oc.Forbidden:default:B=Ql.Canceled}return B}static implTranslateCancelResult(O){let B=cc.EndOfStream;switch(O){case Oc.Success:case Oc.EndOfDictation:case Oc.NoMatch:B=cc.EndOfStream;break;case Oc.InitialSilenceTimeout:case Oc.BabbleTimeout:case Oc.Error:case Oc.BadRequest:case Oc.Forbidden:default:B=cc.Error}return B}static implTranslateCancelErrorCode(O){let B=Zl.NoError;switch(O){case Oc.Error:B=Zl.ServiceError;break;case Oc.TooManyRequests:B=Zl.TooManyRequests;break;case Oc.BadRequest:B=Zl.BadRequestParameters;break;case Oc.Forbidden:B=Zl.Forbidden;break;default:B=Zl.NoError}return B}static implTranslateErrorDetails(O){let B="The speech service encountered an internal error and could not continue.";switch(O){case Zl.Forbidden:B="The recognizer is using a free subscription that ran out of quota.";break;case Zl.BadRequestParameters:B="Invalid parameter or unsupported audio format in the request.";break;case Zl.TooManyRequests:B="The number of parallel requests exceeded the number of allowed concurrent transcriptions."}return B}}class DetailedSpeechPhrase{constructor(O){this.privDetailedSpeechPhrase=JSON.parse(O),this.privDetailedSpeechPhrase.RecognitionStatus=Oc[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(O){return new DetailedSpeechPhrase(O)}getJsonWithCorrectedOffsets(O){if(this.privDetailedSpeechPhrase.NBest){let B;for(const O of this.privDetailedSpeechPhrase.NBest)if(O.Words&&O.Words[0]){B=O.Words[0].Offset;break}if(B&&B<O){const U=O-B;for(const O of this.privDetailedSpeechPhrase.NBest)if(O.Words)for(const B of O.Words)B.Offset+=U}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}}var SpeechServiceRecognizer_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class SpeechServiceRecognizer extends ServiceRecognizerBase{constructor(O,B,U,G,q){super(O,B,U,G,q),this.privSpeechRecognizer=q;const j={},W=G.parameters.getProperty(Xl.Speech_SegmentationSilenceTimeoutMs,void 0);if(void 0!==W){const O=parseInt(W,10);j.mode="INTERACTIVE",j.INTERACTIVE={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:O}}}if(void 0!==G.autoDetectSourceLanguages){const O=G.autoDetectSourceLanguages.split(",");let B;B="Continuous"===G.languageIdMode?"DetectContinuous":"DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:O,mode:B,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});const U=G.sourceLanguageModels;void 0!==U&&(j.customModels=U,j.onInterim={action:"None"},j.onSuccess={action:"None"})}(O=>{for(const B in O)return!1;return!0})(j)||this.privSpeechContext.setSection("phraseDetection",j)}processTypeSpecificMessages(O){return SpeechServiceRecognizer_awaiter(this,void 0,void 0,(function*(){let B;const U=new PropertyCollection;U.setProperty(Xl.SpeechServiceResponse_JsonResult,O.textBody);let G=!1;switch(O.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const q=SpeechHypothesis.fromJSON(O.textBody),j=q.Offset+this.privRequestSession.currentTurnAudioOffset;B=new SpeechRecognitionResult(this.privRequestSession.requestId,Ql.RecognizingSpeech,q.Text,q.Duration,j,q.Language,q.LanguageDetectionConfidence,void 0,void 0,O.textBody,U),this.privRequestSession.onHypothesis(j);const W=new SpeechRecognitionEventArgs(B,q.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,W)}catch(O){}G=!0;break;case"speech.phrase":const Y=SimpleSpeechPhrase.fromJSON(O.textBody),K=EnumTranslation.implTranslateRecognitionResult(Y.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+Y.Offset+Y.Duration),Ql.Canceled===K){const O=EnumTranslation.implTranslateCancelResult(Y.RecognitionStatus),B=EnumTranslation.implTranslateCancelErrorCode(Y.RecognitionStatus);yield this.cancelRecognitionLocal(O,B,EnumTranslation.implTranslateErrorDetails(B))}else{if(!this.privRequestSession.isSpeechEnded||K!==Ql.NoMatch||Y.RecognitionStatus===Oc.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(dc)===yc[yc.Simple])B=new SpeechRecognitionResult(this.privRequestSession.requestId,K,Y.DisplayText,Y.Duration,Y.Offset+this.privRequestSession.currentTurnAudioOffset,Y.Language,Y.LanguageDetectionConfidence,void 0,void 0,O.textBody,U);else{const G=DetailedSpeechPhrase.fromJSON(O.textBody),q=G.Offset+this.privRequestSession.currentTurnAudioOffset,j=G.getJsonWithCorrectedOffsets(q);B=new SpeechRecognitionResult(this.privRequestSession.requestId,K,G.RecognitionStatus===Oc.Success?G.NBest[0].Display:void 0,G.Duration,q,G.Language,G.LanguageDetectionConfidence,void 0,void 0,j,U)}const G=new SpeechRecognitionEventArgs(B,B.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,G)}catch(O){}}if(this.privSuccessCallback){try{this.privSuccessCallback(B)}catch(O){this.privErrorCallback&&this.privErrorCallback(O)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}G=!0}return G}))}cancelRecognition(O,B,U,G,q){const j=new PropertyCollection;if(j.setProperty(pc,Zl[G]),this.privSpeechRecognizer.canceled){const B=new SpeechRecognitionCanceledEventArgs(U,q,G,void 0,O);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,B)}catch(O){}}if(this.privSuccessCallback){const O=new SpeechRecognitionResult(B,Ql.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,q,void 0,j);try{this.privSuccessCallback(O),this.privSuccessCallback=void 0}catch(O){}}}}class AuthInfo{constructor(O,B){this.privHeaderName=O,this.privToken=B}get headerName(){return this.privHeaderName}get token(){return this.privToken}}class CognitiveSubscriptionKeyAuthentication{constructor(O){if(!O)throw new ArgumentNullError("subscriptionKey");this.privAuthInfo=new AuthInfo(HeaderNames.AuthKey,O)}fetch(O){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(O){return Promise.resolve(this.privAuthInfo)}}class CognitiveTokenAuthentication{constructor(O,B){if(!O)throw new ArgumentNullError("fetchCallback");if(!B)throw new ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=O,this.privFetchOnExpiryCallback=B}fetch(O){return this.privFetchCallback(O).then((O=>new AuthInfo(HeaderNames.Authorization,void 0===O?void 0:CognitiveTokenAuthentication.privTokenPrefix+O)))}fetchOnExpiry(O){return this.privFetchOnExpiryCallback(O).then((O=>new AuthInfo(HeaderNames.Authorization,void 0===O?void 0:CognitiveTokenAuthentication.privTokenPrefix+O)))}}CognitiveTokenAuthentication.privTokenPrefix="bearer ";var Recognizer_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class Recognizer{constructor(O,B,U){this.audioConfig=void 0!==O?O:AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=B.clone(),this.privConnectionFactory=U,this.implCommonRecognizerSetup()}close(O,B){Contracts.throwIfDisposed(this.privDisposed),marshalPromiseToCallbacks(this.dispose(!0),O,B)}get internalData(){return this.privReco}dispose(O){return Recognizer_awaiter(this,void 0,void 0,(function*(){this.privDisposed||(this.privDisposed=!0,O&&this.privReco&&(yield this.privReco.audioSource.turnOff(),yield this.privReco.dispose()))}))}static get telemetryEnabled(){return ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(O){ServiceRecognizerBase.telemetryDataEnabled=O}implCommonRecognizerSetup(){let O="undefined"!=typeof window?"Browser":"Node",B="unknown",U="unknown";"undefined"!=typeof navigator&&(O=O+"/"+navigator.platform,B=navigator.userAgent,U=navigator.appVersion);const G=this.createRecognizerConfig(new SpeechServiceConfig(new Context(new RecognizerConfig_OS(O,B,U))));this.privReco=this.createServiceRecognizer(Recognizer.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,G)}recognizeOnceAsyncImpl(O){return Recognizer_awaiter(this,void 0,void 0,(function*(){Contracts.throwIfDisposed(this.privDisposed);const B=new Deferred;yield this.implRecognizerStop(),yield this.privReco.recognize(O,B.resolve,B.reject);const U=yield B.promise;return yield this.implRecognizerStop(),U}))}startContinuousRecognitionAsyncImpl(O){return Recognizer_awaiter(this,void 0,void 0,(function*(){Contracts.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop(),yield this.privReco.recognize(O,void 0,void 0)}))}stopContinuousRecognitionAsyncImpl(){return Recognizer_awaiter(this,void 0,void 0,(function*(){Contracts.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop()}))}implRecognizerStop(){return Recognizer_awaiter(this,void 0,void 0,(function*(){this.privReco&&(yield this.privReco.stopRecognizing())}))}static getAuthFromProperties(O){const B=O.getProperty(Xl.SpeechServiceConnection_Key,void 0);return B&&""!==B?new CognitiveSubscriptionKeyAuthentication(B):new CognitiveTokenAuthentication((()=>{const B=O.getProperty(Xl.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(B)}),(()=>{const B=O.getProperty(Xl.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(B)}))}}var SpeechRecognizer_awaiter=function(O,B,U,G){return new(U||(U=Promise))((function(q,j){function fulfilled(O){try{step(G.next(O))}catch(O){j(O)}}function rejected(O){try{step(G.throw(O))}catch(O){j(O)}}function step(O){O.done?q(O.value):function(O){return O instanceof U?O:new U((function(B){B(O)}))}(O.value).then(fulfilled,rejected)}step((G=G.apply(O,B||[])).next())}))};class SpeechRecognizer extends Recognizer{constructor(O,B){const U=O;Contracts.throwIfNull(U,"speechConfig"),Contracts.throwIfNullOrWhitespace(U.properties.getProperty(Xl.SpeechServiceConnection_RecoLanguage),Xl[Xl.SpeechServiceConnection_RecoLanguage]),super(B,U.properties,new SpeechConnectionFactory),this.privDisposedRecognizer=!1}static FromConfig(O,B,U){const G=O;B.properties.mergeTo(G.properties);return new SpeechRecognizer(O,U)}get endpointId(){return Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Xl.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(Xl.SpeechServiceAuthorization_Token)}set authorizationToken(O){Contracts.throwIfNullOrWhitespace(O,"token"),this.properties.setProperty(Xl.SpeechServiceAuthorization_Token,O)}get speechRecognitionLanguage(){return Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Xl.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(dc,yc[yc.Simple])===yc[yc.Simple]?yc.Simple:yc.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(O,B){marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(Jl.Interactive),O,B)}startContinuousRecognitionAsync(O,B){marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(Jl.Conversation),O,B)}stopContinuousRecognitionAsync(O,B){marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),O,B)}startKeywordRecognitionAsync(O,B,U){Contracts.throwIfNull(O,"model"),U&&U("Not yet implemented.")}stopKeywordRecognitionAsync(O){O&&O()}close(O,B){Contracts.throwIfDisposed(this.privDisposedRecognizer),marshalPromiseToCallbacks(this.dispose(!0),O,B)}dispose(O){const B=Object.create(null,{dispose:{get:()=>super.dispose}});return SpeechRecognizer_awaiter(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(O&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield B.dispose.call(this,O))}))}createRecognizerConfig(O){return new RecognizerConfig(O,this.properties)}createServiceRecognizer(O,B,U,G){return new SpeechServiceRecognizer(O,B,U,G,this)}}class ConnectionMessageImpl{constructor(O){this.privConnectionMessage=O,this.privProperties=new PropertyCollection,this.privConnectionMessage.headers[HeaderNames.ConnectionId]&&this.privProperties.setProperty(Xl.Speech_SessionId,this.privConnectionMessage.headers[HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach((O=>{this.privProperties.setProperty(O,this.privConnectionMessage.headers[O])}))}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find((O=>O.toLowerCase()==="path".toLowerCase()))]}get isTextMessage(){return this.privConnectionMessage.messageType===sc.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===sc.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}class ConnectionEventArgs extends SessionEventArgs{}class ConnectionMessageEventArgs{constructor(O){this.privConnectionMessage=O}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}}class ServiceEventArgs extends SessionEventArgs{constructor(O,B,U){super(U),this.privJsonResult=O,this.privEventName=B}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}}class Connection{static fromRecognizer(O){const B=O.internalData,U=new Connection;return U.privInternalData=B,U.setupEvents(),U}static fromSynthesizer(O){const B=O.internalData,U=new Connection;return U.privInternalData=B,U.setupEvents(),U}openConnection(O,B){marshalPromiseToCallbacks(this.privInternalData.connect(),O,B)}closeConnection(O,B){if(this.privInternalData instanceof SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");marshalPromiseToCallbacks(this.privInternalData.disconnect(),O,B)}setMessageProperty(O,B,U){if(Contracts.throwIfNullOrWhitespace(B,"propertyName"),this.privInternalData instanceof ServiceRecognizerBase){if("speech.context"!==O.toLowerCase())throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(B,U)}else if(this.privInternalData instanceof SynthesisAdapterBase){if("synthesis.context"!==O.toLowerCase())throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(B,U)}}sendMessageAsync(O,B,U,G){marshalPromiseToCallbacks(this.privInternalData.sendNetworkMessage(O,B),U,G)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach((O=>{"ConnectionEstablishedEvent"===O.name?this.connected&&this.connected(new ConnectionEventArgs(O.connectionId)):"ConnectionClosedEvent"===O.name?this.disconnected&&this.disconnected(new ConnectionEventArgs(O.connectionId)):"ConnectionMessageSentEvent"===O.name?this.messageSent&&this.messageSent(new ConnectionMessageEventArgs(new ConnectionMessageImpl(O.message))):"ConnectionMessageReceivedEvent"===O.name&&this.messageReceived&&this.messageReceived(new ConnectionMessageEventArgs(new ConnectionMessageImpl(O.message)))})),this.privServiceEventListener=this.privInternalData.serviceEvents.attach((O=>{this.receivedServiceMessage&&this.receivedServiceMessage(new ServiceEventArgs(O.jsonString,O.name))}))}}const Mc=kt.createInterface("IChatService"),Dc=kt.createInterface();var Lc,Bc;(function(O){O.Inactive="Inactive",O.Pending="Pending",O.Active="Active"})(Lc||(Lc={})),function(O){O.Default="Default",O.Shared="Shared"}(Bc||(Bc={}));class CoreUtils{static clamp(O,B,U){return isNaN(O)||O<=B?B:O>=U?U:O}static uuid(){return(this.partUUID()+this.partUUID()+"-"+this.partUUID()+"-"+this.partUUID()+"-"+this.partUUID()+"-"+this.partUUID()+this.partUUID()+this.partUUID()).toLowerCase()}static partUUID(){return(65536*(1+Math.random())|0).toString(16).substring(1)}}const Fc=kt.createInterface("ISpeechService");var zc;(function(O){O[O.MicInitializing=0]="MicInitializing",O[O.ReadyToBeUsed=1]="ReadyToBeUsed",O[O.NoPermissionError=2]="NoPermissionError",O[O.MediaNotReachableError=3]="MediaNotReachableError",O[O.FailedRecognitionError=4]="FailedRecognitionError",O[O.AuthenticationError=5]="AuthenticationError",O[O.UnknownError=6]="UnknownError",O[O.AudioPlaybackError=7]="AudioPlaybackError",O[O.Listening=8]="Listening",O[O.Loading=9]="Loading",O[O.ReadingOut=10]="ReadingOut",O[O.PendingAudio=11]="PendingAudio",O[O.WaitingForStreamToFinish=12]="WaitingForStreamToFinish"})(zc||(zc={}));const $c=kt.createInterface("ITelemetryService");class StreamEventNotifier extends lifecycle_Disposable{constructor(){super(...arguments),this.onBeginEmitter=this._register(new Emitter),this.onUpdateEmitter=this._register(new Emitter),this.onResponseEmitter=this._register(new Emitter),this.onCompleteEmitter=this._register(new Emitter)}get onBegin(){return this.onBeginEmitter.event}get onUpdate(){return this.onUpdateEmitter.event}get onResponse(){return this.onResponseEmitter.event}get onComplete(){return this.onCompleteEmitter.event}}const Uc=kt.createInterface("IErrorStateService");var Vc,Gc,Hc;(function(O){O.OK="ok"})(Vc||(Vc={})),function(O){O.OK="ok",O.ChatDisabled="disabled",O.ChatSuspended="suspended",O.ConversationLimit="conversation-limit",O.ConversationLimitForMuidUsers="conversation-limit-muid-users",O.DailyLimit="daily-limit",O.Disengaged="disengaged",O.Forbidden="forbidden",O.Generic="generic",O.NetworkFailure="network-failure",O.NetworkOffline="network-offline",O.TooManyRequests="too-many-requests",O.Unauthorized="unauthorized",O.Unrecoverable="unrecoverable",O.AttemptingToReconnect="attempting-to-reconnect",O.NetworkSettings="network-settings",O.LostConnection="lost-connection",O.MessageError="message-error",O.CaptchaChallenge="captcha-challenge",O.MuidUserConsentNotGiven="muid-user-consent-not-given"}(Gc||(Gc={})),function(O){O.Processing="processing",O.OK="ok"}(Hc||(Hc={}));const qc=kt.createInterface("IPerformanceService");var jc,Wc,Yc,Kc,Qc;(function(O){O.AlreadyRecognizing="AlreadyRecognizing",O.NoPermission="NoPermission",O.MediaNotReachable="MediaNotReachable",O.NoChatData="NoChatData",O.Unknown="Unknown"})(jc||(jc={}));class SpeechSessionError extends Error{constructor(O,B){super(jc[O]),this.name="SpeechSessionError",B instanceof Error?this.cause=B:this.cause=new Error(String(B))}}(function(O){O.Idle="VoiceIdle",O.Initiated="VoiceInitiated",O.RecognitionStarted="VoiceRecognitionStarted",O.Listening="VoiceListeningStarted",O.RecognizedSuccess="VoiceRecognizedSuccess",O.MessageSent="VoiceMessageSend",O.FirstTTS="VoiceFirstTTS",O.ChatFirstTokenTTS="VoiceChatFirstTokenTTS",O.TTSCompleted="VoiceTTSComplete"})(Wc||(Wc={})),function(O){O.RecongitionCanceled="VoiceRecognitionCanceled",O.ReadoutCanceled="VoiceReadoutCanceled"}(Yc||(Yc={})),function(O){O.RecognitionStartFailure="VoiceRecognitionStartedFailed",O.RecognizingFailure="VoiceRecognitionFailed",O.MessageSentFailure="VoiceMessageSendFailed",O.TTSFailed="VoiceTTSFailed"}(Kc||(Kc={})),function(O){O.PlayNextAudio="VoicePlayNextAudio"}(Qc||(Qc={}));const Zc=kt.createInterface("INetworkErrorService");var Xc;(function(O){O[O.Idle=0]="Idle",O[O.WaitingForTts=1]="WaitingForTts",O[O.TtsPlaying=2]="TtsPlaying",O[O.TtsComplete=3]="TtsComplete"})(Xc||(Xc={}));let Jc=class extends StreamEventNotifier{constructor(O,B,U,G,q,j,W,Y,K){var Q;super(),this.services=O,this.captcha=B,this.config=U,this.conversation=G,this.telemetry=q,this.networkError=j,this.errorState=W,this.perfTracker=Y,this.log=K,this._speechStatus=zc.ReadyToBeUsed,this.onSpeechStatusUpdatedEmitter=this._register(new Emitter),this.onSendMessageEmitter=this._register(new Emitter),this._recognizedText="",this.onRecognizedTextUpdatedEmitter=this._register(new Emitter),this.didUserCancelRecognition=!1,this.shouldReadoutResponse=!1,this.audioCurrentlyPlaying=void 0,this.audiosToBePlayed=[],this.readoutState=Xc.Idle,this.lastRequest=null,this.recognizing=!1,this.chatRequestPending=!1,this.successFunnelState=Wc.Idle,this.handlePendingRequestStateChanged=O=>{this.chatRequestPending=O,O?this.speechStatus===zc.ReadyToBeUsed&&(this.speechStatus=zc.WaitingForStreamToFinish):this.updateSpeechStatusOnResponseFinish()},this.onConnectedAsync=async O=>{var B,U;if(!this.config.features.enableSpeechChatDataAfterPhrase)try{if(null===(B=this.log)||void 0===B||B.debug(this,this.onConnectedAsync,"connection established started, sending chat data",O).write(),!this.config.features.enableSimpleVoiceInput){if(this.lastRequest=await this.services.get(Mc).createChatRequestAsync("",Ji.Speech,!1),!this.lastRequest)throw null===(U=this.log)||void 0===U||U.error(this,this.onConnectedAsync,"Chat data null").write(),new SpeechSessionError(jc.NoChatData);this.sendChatData()}}catch(O){const B=ensureErrorInstance(O);this.telemetry.trackEvent("Error",Kc.MessageSentFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:ErrorUtils_getErrorMessage(B),funnel:this.successFunnelState,caller:"onConnectedAsync"})}),this.speechStatus=zc.AuthenticationError}},this.handleReceivedServiceMessage=O=>{var B;if(this.config.features.enableSimpleVoiceInput)return;const U=O.eventName.toLowerCase(),G=JSON.parse(O.jsonString);if("uqu.message"===U)this.handleUquMessage(G);else null===(B=this.log)||void 0===B||B.warn(this,this.handleReceivedServiceMessage,`Event ${U} still not implemented.`,O).write()},this.error=async O=>{var B,U;if(null===(B=this.log)||void 0===B||B.error(this,this.error,"error",O).write(),this.cancelPendingRequest(),O===Wi.Throttled){const O=this.config.features.enableMUIDUserMode?Gc.ConversationLimitForMuidUsers:Gc.DailyLimit;this.errorState.setChatErrorState(O)}else if(O===Wi.CaptchaChallenge){await this.captcha.getCaptchaChallengeResultAsync()&&this.errorState.setChatErrorState(Gc.OK)}else this.networkError.trackNetworkErrorEvent(this.lastRequest,void 0,O,{messageObject:JSON.stringify(null===(U=this.lastRequest)||void 0===U?void 0:U.message)}),this.errorState.setChatErrorState(Gc.NetworkFailure)},this.updateSpeechStatusOnResponseFinish=()=>{this.chatRequestPending||this.shouldReadoutResponse&&this.audioCurrentlyPlaying?this.chatRequestPending&&!this.shouldReadoutResponse&&(this.speechStatus=zc.WaitingForStreamToFinish):(this.speechStatus=zc.ReadyToBeUsed,this.readoutState=Xc.Idle,this.successFunnelState=Wc.Idle,this.recognizing=!1)},this.playNextAudioAsync=async O=>{var B,U,G,q,j;if(null===(B=this.log)||void 0===B||B.trace(this,this.playNextAudioAsync,"Reading out 1st element of audio queue",this.audiosToBePlayed).write(),this.config.features.enableSpeechTTSLatencyLogging&&this.telemetry.trackEvent("SystemEvent",Qc.PlayNextAudio,{Namespace:"Conversation",CustomData:JSON.stringify({shouldReadoutResponse:this.shouldReadoutResponse,audiosToBePlayed:this.audiosToBePlayed.length,chatRequestPending:this.chatRequestPending})}),this.shouldReadoutResponse&&this.audiosToBePlayed.length>0){this.audioCurrentlyPlaying=this.audiosToBePlayed.shift();try{this.speechStatus=zc.PendingAudio,await(null===(U=this.audioCurrentlyPlaying)||void 0===U?void 0:U.play()),this.config.features.enableSpeechTTSLatencyLogging&&!O&&this.perfTracker.markEvent("CurrentAudioStartedPlaying"),this.readoutState===Xc.Idle&&(this.readoutState=Xc.TtsPlaying,this.successFunnelState=Wc.FirstTTS,this.telemetry.trackEvent("SystemEvent",this.successFunnelState)),this.successFunnelState===Wc.ChatFirstTokenTTS||O||(this.successFunnelState=Wc.ChatFirstTokenTTS,this.perfTracker.markEvent("ChatFirstTokenTTS"),this.telemetry.trackEvent("SystemEvent",this.successFunnelState)),this.speechStatus=zc.ReadingOut}catch(O){const B=ensureErrorInstance(O);null===(G=this.log)||void 0===G||G.error(this,this.playNextAudioAsync,"Audio could not be played",B,this.audioCurrentlyPlaying),this.telemetry.trackEvent("Error",Kc.TTSFailed,{Namespace:"Conversation",CustomData:JSON.stringify({reason:ErrorUtils_getErrorMessage(B),funnel:this.successFunnelState})}),this.stopReadout(),this.updateSpeechStatusOnResponseFinish()}}else!0===this.chatRequestPending?(null===(q=this.log)||void 0===q||q.debug(this,this.playNextAudioAsync,"Readout queue is empty but last audio has not arrived.").write(),this.speechStatus=zc.PendingAudio,this.audioCurrentlyPlaying=void 0):(null===(j=this.log)||void 0===j||j.debug(this,this.playNextAudioAsync,"Readout has finished.").write(),this.audioCurrentlyPlaying=void 0,this.shouldReadoutResponse&&(this.readoutState=Xc.TtsComplete,this.successFunnelState=Wc.TTSCompleted,this.telemetry.trackEvent("SystemEvent",this.successFunnelState)),this.updateSpeechStatusOnResponseFinish())},this.onSessionStarted=(O,B)=>{this.speechStatus=zc.Listening,this.successFunnelState=Wc.Listening,this.perfTracker.markEvent("VoiceListeningStarted"),this.telemetry.trackEvent("SystemEvent",this.successFunnelState)},this.onSpeechStartDetected=(O,B)=>{var U;null===(U=this.log)||void 0===U||U.debug(this,this.onSpeechStartDetected,"speech start detected",B).write()},this.onRecognizing=(O,B)=>{var U;null===(U=this.log)||void 0===U||U.debug(this,this.onRecognizing,"ongoing recognition",B).write(),B.result.text&&(this.recognizedText=B.result.text)},this.onSpeechEndDetected=(O,B)=>{var U;null===(U=this.log)||void 0===U||U.debug(this,this.onSpeechEndDetected,"speech end detected",B).write()},this.onRecognizedAsync=async(O,B)=>{var U,G;if(null===(U=this.log)||void 0===U||U.info(this,this.onRecognizedAsync,"recognition finalized with status",Ql[B.result.reason]).write(),this.stopMicStream(),this.recognizing=!1,B.result.text&&!this.didUserCancelRecognition){if(this.successFunnelState=Wc.RecognizedSuccess,this.telemetry.trackEvent("SystemEvent",this.successFunnelState),this.recognizedText=B.result.text,this.speechStatus=zc.Loading,this.perfTracker.markEvent("QueryEntered"),this.perfTracker.markEvent("RequestSend"),this.successFunnelState=Wc.MessageSent,this.telemetry.trackEvent("SystemEvent",this.successFunnelState,this.messageSentCustomData),this.config.features.enableSimpleVoiceInput?this.onSendMessageEmitter.fire():this.onBeginEmitter.fire(this.lastRequest),this.readoutState=this.shouldReadoutResponse?Xc.WaitingForTts:Xc.Idle,this.config.features.enableSpeechChatDataAfterPhrase&&!this.config.features.enableSimpleVoiceInput)try{if(this.lastRequest=await this.services.get(Mc).createChatRequestAsync("",Ji.Speech),!this.lastRequest)throw null===(G=this.log)||void 0===G||G.error(this,this.onRecognizedAsync,"Chat data null").write(),new SpeechSessionError(jc.NoChatData);this.sendChatData()}catch(O){const B=ensureErrorInstance(O);this.telemetry.trackEvent("Error",Kc.MessageSentFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:ErrorUtils_getErrorMessage(B),funnel:this.successFunnelState,caller:"onConnectedAsync"})}),this.speechStatus=zc.AuthenticationError}}else this.speechStatus=zc.ReadyToBeUsed,this.recognizedText="",this.telemetry.trackEvent("Error",Kc.RecognizingFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:Ql[B.result.reason],funnel:this.successFunnelState})})},this.onSessionStopped=(O,B)=>{var U;null===(U=this.log)||void 0===U||U.debug(this,this.onSessionStopped,"session stopped",B).write()},this.onCanceled=(O,B)=>{var U,G;null===(U=this.log)||void 0===U||U.debug(this,this.onCanceled,"recognition canceled",B).write(),this.recognizedText="",this.recognizing=!1,B.errorCode===Zl.NoError?this.speechStatus=zc.ReadyToBeUsed:(null===(G=this.log)||void 0===G||G.error(this,this.onCanceled,"Recognition was canceled due to an error",B).write(),this.telemetry.trackEvent("Error",Kc.RecognizingFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:Zl[B.errorCode],funnel:this.successFunnelState})}),this.speechStatus=zc.FailedRecognitionError)},this.handleMicError=O=>{var B,U;null===(B=this.log)||void 0===B||B.error(this,this.handleMicError,"Starting speech failed.",O).write();const G=null!==(U=null==O?void 0:O.toLowerCase())&&void 0!==U?U:"unknown";let q=jc.Unknown;G.includes("permission denied")||G.includes("notallowed")||G.includes("denied permission")?(this.speechStatus=zc.NoPermissionError,q=jc.NoPermission):G.includes("not found")?(this.speechStatus=zc.MediaNotReachableError,q=jc.MediaNotReachable):this.speechStatus=zc.UnknownError,this.telemetry.trackEvent("Error",Kc.RecognizingFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:q,funnel:this.successFunnelState})}),this.cancelPendingRequest()},this.updateRequestSpecificUrlParams=()=>{let{uqurequestid:O}=this.config.speech.query;"<<uqurequestid>>"===O&&(O=CoreUtils.uuid()),this.config.features.enableSimpleVoiceInput?this.speechEndpointUrl.searchParams.set("uquclientversion",(0).toString()):this.speechEndpointUrl.searchParams.set("uquclientversion",1..toString()),this.config.speech.speechToTextProvider?this.uqurequestid=O:this.speechEndpointUrl.searchParams.set("uqurequestid",O)},null===(Q=this.log)||void 0===Q||Q.trace(this,"ctor",null).write(),this.initStaticSpeechConfigs()}get speechStatus(){return this._speechStatus}set speechStatus(O){this._speechStatus!==O&&(this.telemetry.trackEvent("SystemEvent","SpeechStatusChanged",{Namespace:"Conversation",CustomData:JSON.stringify({oldSpeechStatus:zc[this.speechStatus],newSpeechStatus:zc[O]})}),this._speechStatus=O,this.onSpeechStatusUpdatedEmitter.fire(O))}get onSpeechStatusUpdated(){return this.onSpeechStatusUpdatedEmitter.event}get onSendMessage(){return this.onSendMessageEmitter.event}get recognizedText(){return this._recognizedText}set recognizedText(O){this._recognizedText!==O&&(this._recognizedText=O,this.onRecognizedTextUpdatedEmitter.fire(O))}get onRecognizedTextUpdated(){return this.onRecognizedTextUpdatedEmitter.event}async tryStartSpeechRecognitionAsync(O=!1){var B,U,G,q,j,W,Y,K,Q;if(null===(B=this.log)||void 0===B||B.trace(this,this.tryStartSpeechRecognitionAsync,"Starting speech",new Date).write(),this.successFunnelState=Wc.Initiated,this.perfTracker.markEvent("VoiceInitiated"),this.telemetry.trackEvent("SystemEvent",this.successFunnelState),this.shouldReadoutResponse=O,this.config.features.enableSpeechErrorHandling&&this.errorState.setChatErrorState(),this.recognizing)return null===(U=this.log)||void 0===U||U.trace(this,this.tryStartSpeechRecognitionAsync,"Trying to start speech while already recognizing, don't do anything.").write(),this.telemetry.trackEvent("Error",Kc.RecognitionStartFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:jc.AlreadyRecognizing,funnel:this.successFunnelState})}),!0;this.recognizing=!0,this.speechStatus=zc.MicInitializing;try{await this.initMicPermissionAsync()}catch(O){const B=ensureErrorInstance(O);return null===(G=this.log)||void 0===G||G.error(this,this.tryStartSpeechRecognitionAsync,"initMicPermissionAsync failed.",B).write(),this.telemetry.trackEvent("Error",Kc.RecognitionStartFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:ErrorUtils_getErrorMessage(B),funnel:this.successFunnelState})}),this.speechStatus=zc.NoPermissionError,this.cancelPendingRequest(),!1}if("denied"===(null===(q=this.micPermission)||void 0===q?void 0:q.state))return this.telemetry.trackEvent("Error",Kc.RecognitionStartFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:jc.NoPermission,funnel:this.successFunnelState})}),this.cancelPendingRequest(),!1;if(this.config.features.enableSpeechEarconOnInput)try{null===(j=this.log)||void 0===j||j.debug(this,this.tryStartSpeechRecognitionAsync,"Playing earcon").write();let O=this.config.bing.baseUrl+"/vs/ecv3/start.mp3";this.config.features.enableSpeechTTSLatencyLogging?await this.config.speech.textToSpeechProvider(O,(()=>{}),!1,(()=>{}),(()=>{this.onTTSError(O)})).play():await this.config.speech.textToSpeechProvider(O,(()=>{}),!1).play()}catch(O){null===(W=this.log)||void 0===W||W.error(this,this.tryStartSpeechRecognitionAsync,"Error playing earcon",O).write()}try{null===(Y=this.log)||void 0===Y||Y.info(this,this.tryStartSpeechRecognitionAsync,"Mic permission is not denied, continuing with recognition").write(),this.config.features.enableSpeechGetUserMedia&&(this.mediaStream=await navigator.mediaDevices.getUserMedia({audio:!0})),this.initSpeechRecognizer(),this.didUserCancelRecognition=!1,this.recognizer.recognizeOnceAsync((O=>{}),this.handleMicError),this.successFunnelState=Wc.RecognitionStarted,this.telemetry.trackEvent("SystemEvent",this.successFunnelState),null===(K=this.log)||void 0===K||K.info(this,this.tryStartSpeechRecognitionAsync,"Speech starting.").write()}catch(O){null===(Q=this.log)||void 0===Q||Q.error(this,this.tryStartSpeechRecognitionAsync,"Starting speech threw exception.",O).write();const B=O instanceof Error&&O.message?O.message:"Unknown error- speech failed.";return this.handleMicError(B),!1}return!0}tryCancelSpeechRecognition(){var O,B;return null===(O=this.log)||void 0===O||O.info(this,this.tryCancelSpeechRecognition,"Canceling speech recognition.").write(),this.speechStatus===zc.Listening?(this.cancelPendingRequest(),!0):(null===(B=this.log)||void 0===B||B.warn(this,this.tryCancelSpeechRecognition,`Cannot cancel speech recognition when state is ${this.speechStatus}.`),!1)}stopReadout(){var O;null===(O=this.log)||void 0===O||O.info(this,this.stopReadout,"Stopping readout of current turn and removing remaining audios in queue.").write(),this.clearAudioQueue(),this.telemetry.trackEvent("SystemEvent",Yc.ReadoutCanceled,{Namespace:"Conversation",CustomData:JSON.stringify({funnel:this.successFunnelState})}),this.updateSpeechStatusOnResponseFinish()}cancelPendingRequest(){var O,B;null===(O=this.log)||void 0===O||O.trace(this,this.cancelPendingRequest,"Resetting the service and dropping any pending interaction.").write(),this.telemetry.trackEvent("SystemEvent",Yc.RecongitionCanceled,{Namespace:"Conversation",CustomData:JSON.stringify({funnel:this.successFunnelState,speechState:this.speechStatus})}),this.didUserCancelRecognition=!0,this.recognizing=!1,this.stopStreamAndCloseConnection(),this.stopMicStream(),null===(B=this.recognizer)||void 0===B||B.stopContinuousRecognitionAsync(),delete this.recognizer,this.speechStatus!==zc.NoPermissionError&&(this.speechStatus=zc.ReadyToBeUsed),this.lastRequest=null,this.clearAudioQueue(),this.successFunnelState=Wc.Idle}handleSpokenResponseUrl(O,B){this.handleAudioUrl(O,B)}clearAudioQueue(){var O,B;this.shouldReadoutResponse=!1,this.readoutState=Xc.Idle,null===(O=this.audioCurrentlyPlaying)||void 0===O||O.stop(),this.audioCurrentlyPlaying=void 0,null===(B=this.log)||void 0===B||B.trace(this,this.clearAudioQueue,`Removing ${this.audiosToBePlayed.length} audio tracks left.`).write(),this.audiosToBePlayed=[]}async initMicPermissionAsync(){var O,B;try{if(this.micPermission)return null===(O=this.log)||void 0===O||O.info(this,this.initMicPermissionAsync,"there's a mic permission already here").write(),void this.handleMicPermissionChanged();this.micPermission=this.config.speech.micPermissionProvider?await this.config.speech.micPermissionProvider():await navigator.permissions.query({name:"microphone"}),this.micPermission&&(this.micPermission.onchange=()=>this.handleMicPermissionChanged()),this.handleMicPermissionChanged()}catch(O){throw null===(B=this.log)||void 0===B||B.error(this,this.initMicPermissionAsync,"Permissions could not be queried",O).write(),this.speechStatus=zc.MediaNotReachableError,new SpeechSessionError(jc.MediaNotReachable,O)}}stopMicStream(){var O;this.config.speech.speechToTextProvider||null===(O=this.mediaStream)||void 0===O||O.getTracks().forEach((O=>{O.stop()}))}handleMicPermissionChanged(){var O,B,U;if(null===(O=this.log)||void 0===O||O.trace(this,this.handleMicPermissionChanged,`Mic permission status: '${null===(B=this.micPermission)||void 0===B?void 0:B.state}'`).write(),"denied"===(null===(U=this.micPermission)||void 0===U?void 0:U.state))this.speechStatus=zc.NoPermissionError;else this.recognizing||(this.speechStatus=zc.ReadyToBeUsed)}handleUquMessage(O){var B,U,G,q,j,W,Y;switch(O.Scenario){case"Chat":if(null===(B=this.log)||void 0===B||B.trace(this,this.handleUquMessage,"Chat:",O.Data).write(),null!==this.lastRequest)if(this.lastRequest=null,this.config.features.enableSpeechErrorHandling){const B=O.Data,j=null!==(G=null===(U=B.result)||void 0===U?void 0:U.value)&&void 0!==G?G:Wi.Unknown;j===Wi.Success?(B.type=ji.ChatResponse,this.onResponseEmitter.fire(B)):(null===(q=this.log)||void 0===q||q.trace(this,this.handleUquMessage,"result:",B.result).write(),this.error(j))}else this.onResponseEmitter.fire(O.Data);break;case"SpokenResponse":null===(j=this.log)||void 0===j||j.trace(this,this.handleUquMessage,"SpokenResponse").write(),null!==this.lastRequest&&this.handleSpokenResponse(O.Data);break;case"ChatStream":null!==this.lastRequest&&this.onUpdateEmitter.fire(O.Data);break;case"ChatStreamComplete":null===(W=this.log)||void 0===W||W.debug(this,this.handleUquMessage,"Chat stream complete").write(),this.chatRequestPending=!1,this.updateSpeechStatusOnResponseFinish(),this.onCompleteEmitter.fire();break;default:null===(Y=this.log)||void 0===Y||Y.warn(this,this.handleUquMessage,`Scenario ${O.Scenario} is not implemented`,O).write()}}sendChatData(){var O,B;if(!this.config.features.enableSimpleVoiceInput&&!this.config.speech.speechToTextProvider)if(null===(O=this.log)||void 0===O||O.debug(this,this.sendChatData,"Sending chat data to UQU").write(),null===this.lastRequest)null===(B=this.log)||void 0===B||B.error(this,this.sendChatData,"No chat data to send").write(),this.telemetry.trackEvent("Error",Kc.MessageSentFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:jc.NoChatData,funnel:this.successFunnelState,caller:"sendChatData"})});else{const O={data:this.lastRequest,scenario:"chatData"};this.sendUquMessage(O,void 0,(O=>{var B;null===(B=this.log)||void 0===B||B.error(this,this.sendChatData,"Failed to send chat data.",O).write(),this.telemetry.trackEvent("Error",Kc.MessageSentFailure,{Namespace:"Conversation",CustomData:JSON.stringify({reason:O,funnel:this.successFunnelState})})}))}}stopStreamAndCloseConnection(){var O;if(!this.config.speech.speechToTextProvider)if(this.config.features.enableSimpleVoiceInput)this.forceCloseConnection();else{null===(O=this.log)||void 0===O||O.debug(this,this.stopStreamAndCloseConnection,"Sending chat stop command to UQU and closing connection").write();const B={scenario:"chatInvoke",type:"stop",data:{}};this.sendUquMessage(B,this.forceCloseConnection.bind(this),this.forceCloseConnection.bind(this))}}sendUquMessage(O,B,U){var G;void 0===this.socketConnection?void 0!==U&&U("No connection to server"):null===(G=this.socketConnection)||void 0===G||G.sendMessageAsync("uqu.input",JSON.stringify(O),B,U)}handleSpokenResponse(O){O.url&&this.handleAudioUrl(O.url,O.isDefaultResponse)}handleAudioUrl(O,B){var U,G;if(null===(U=this.log)||void 0===U||U.debug(this,this.handleAudioUrl,`TTS Audio URL: ${O} isInternalSearchQueryTTS: ${B}`).write(),O&&this.shouldReadoutResponse){if(this.config.features.enableSpeechTTSLatencyLogging){this.perfTracker.markEvent("ChatResponseAudioUrl");const U=this.config.speech.textToSpeechProvider(O,(()=>{B||this.perfTracker.markEvent("CurrentAudioFinishedPlaying"),this.playNextAudioAsync(B)}),!!this.audioCurrentlyPlaying,(()=>{this.onTTSCanPlayThrough()}),(()=>{this.onTTSError(O)}));this.audiosToBePlayed.push(U)}else{const U=this.config.speech.textToSpeechProvider(O,(()=>{this.playNextAudioAsync(B)}),!!this.audioCurrentlyPlaying);this.audiosToBePlayed.push(U)}null===(G=this.log)||void 0===G||G.debug(this,this.handleAudioUrl,"speechStatus: ",zc[this.speechStatus]).write(),this.audioCurrentlyPlaying||this.playNextAudioAsync(B)}}onTTSError(O){this.telemetry.trackEvent("Error",Kc.TTSFailed,{Namespace:"Conversation",CustomData:JSON.stringify({reason:"Audio wasn't loaded properly.",url:O,funnel:this.successFunnelState})})}onTTSCanPlayThrough(){this.perfTracker.markEvent("ChatResponseAudioReady")}generateSpeechEndpoint(){const O=this.config.buildUrl(this.config.speech);return O.protocol="https:"===location.protocol?"wss:":"ws:",O}initStaticSpeechConfigs(){this.speechEndpointUrl=this.generateSpeechEndpoint(),this.audioConfig=AudioConfig.fromDefaultMicrophoneInput()}forceCloseConnection(){void 0!==this.socketConnection&&(this.socketConnection.closeConnection(),this.socketConnection.close(),delete this.socketConnection.receivedServiceMessage,delete this.socketConnection)}initSpeechRecognizer(){var O;if(delete this.recognizer,this.updateRequestSpecificUrlParams(),this.config.speech.speechToTextProvider)this.recognizer=this.config.speech.speechToTextProvider.initRecognizer(this.speechEndpointUrl,"key",this.uqurequestid);else{const B=SpeechConfig.fromEndpoint(this.speechEndpointUrl,"key");B.speechRecognitionLanguage="xx-yy",this.recognizer=new SpeechRecognizer(B,this.audioConfig),null===(O=this.recognizer.properties)||void 0===O||O.setProperty(Xl.SpeechServiceConnection_Endpoint,this.speechEndpointUrl.href),this.socketConnection=Connection.fromRecognizer(this.recognizer),this.socketConnection.receivedServiceMessage=this.handleReceivedServiceMessage,this.socketConnection.connected=this.onConnectedAsync}this.recognizer.sessionStarted=this.onSessionStarted,this.recognizer.speechStartDetected=this.onSpeechStartDetected,this.recognizer.recognizing=this.onRecognizing,this.recognizer.speechEndDetected=this.onSpeechEndDetected,this.recognizer.recognized=this.onRecognizedAsync,this.recognizer.sessionStopped=this.onSessionStopped,this.recognizer.canceled=this.onCanceled}get messageSentCustomData(){return{Namespace:"Conversation",CustomData:JSON.stringify({numCharacters:this.recognizedText.length,numWords:this.recognizedText.split(/\s+/).length,turnId:this.conversation.turnCount,convId:this.conversation.id}),EncryptedData:JSON.stringify({text:this.telemetry.getComplianceSafeMessage(this.recognizedText)})}}};function createAudio(O,B,U=!0,G,q){const j=new Audio(O);return j.onended=()=>{B()},q&&(j.onerror=()=>{q()}),G&&(j.oncanplaythrough=()=>{G()}),{play:()=>j.play(),stop:()=>{j.pause()}}}__decorate([observable,__metadata("design:type",Number)],Jc.prototype,"_speechStatus",void 0),Jc=__decorate([__param(0,Rt),__param(1,ei),__param(2,ql),__param(3,Dc),__param(4,$c),__param(5,Zc),__param(6,Uc),__param(7,qc),__param(8,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object])],Jc);const ed={isEnabled:!1,hookIncomingMessage:O=>!1},td={privacyStatement:"https://go.microsoft.com/fwlink/?LinkId=521839",termsOfUse:"https://www.bing.com/new/termsofuse",reportAConcern:"https://www.microsoft.com/concern/bing"},rd={letsChat:"Let's chat",pause:"Pause",play:"Play",stop:"Stop",canceling:"Canceling...",more:"more",expand:"Expand",clickToView:"click to view",seeMore:"See more",seeLess:"See less",raiSuggestions:"What is this?",close:"Close",refresh:"Refresh",next:"Next",cancel:"Cancel",preview:"Preview",of:"of",dismiss:"Dismiss",submit:"Submit",actionBarPlaceholder:"Ask me anything...",actionBarOngoingConvPlaceholder:"Type message",actionBarSuspendConvPlaceHolder:"Messaging is disabled for suspended accounts",actionBarComposeButton:"New topic",actionBarNewChatButtonDesktop:"Start a new chat",actionBarNewChatButtonMobile:"New chat",actionBarTextInputAriaLabel:"Ask Bing",actionBarAutoSuggestTab:"Tab",actionBarAutoSuggestTap:"Tap",actionBarKeyboardHint:"Enter",actionBarTextInputModeButtonAriaLabel:"Text input mode",actionBarSpeechInputModeButtonAriaLabel:"Enable speech input mode",actionBarSubmitButtonAriaLabel:"Submit",actionBarCancelSpeechInputButtonAriaLabel:"Cancel speech input/readout",actionBarEditModeButtonAriaLabel:"Edit mode",actionBarSpeechBtnStartListeningAriaLabel:"Start listening",actionBarSpeechBtnStopListeningAriaLabel:"Stop listening",actionBarSpeechBtnStopReadoutAriaLabel:"Stop readout",captchaTitle:"Verify your identity",captchaDescription:"To continue, enter the characters in the picture below.",captchaPlaceholder:"Enter the characters...",captchaPlaceholderError:"Sorry, please try again.",captchaRefreshBtnAriaLabel:"Refresh CAPTCHA image",captchaImgAlt:"CAPTCHA image",feedbackAccessed:"Accessed",feedbackSource:"Source: Conversation with Bing,",feedbackLikeButtonAriaLabel:"Like",feedbackDislikeButtonAriaLabel:"Dislike",feedbackOffensiveButtonAriaLabel:"Flag as offensive",feedbackCopyButtonAriaLabel:"Copy",feedbackExportButtonAriaLabel:"Export",feedbackExportPdfButtonAriaLabel:"PDF",feedbackExportTextButtonAriaLabel:"Text",feedbackExportWordButtonAriaLabel:"Word",feedbackShareButtonAriaLabel:"Share",feedbackShareAnswer:"Check out this Bing answer",feedbackShareGenerated:"Check out what I generated with Bing",feedbackShareContent:"Here's an answer I got using the new Bing, the worlds first AI-powered answer engine. Click to see the full answer and try it yourself.",feedbackShareTitleFormat:"{0} | {1}",serpfeedback:"Feedback",exportSuccessToastTitle:"File exported. Some formatting and images may not export.",exportedFileUserTitle:"User",exportedFileBotTitle:"Bing",shareConversation:"Share entire conversation",speechFailedRecognitionError:"Sorry, I can't listen to you because the speech server is down, please try again later.",speechLoading:"Waiting for audio...",speechListening:"I'm listening...",speechMediaNotReachableError:"Sorry, I can't listen to you because you don't have an available microphone.",speechNoPermissionError:"You will need to enable the mic for me to hear you.",speechAudioPlaybackError:"Something went wrong.",speechAuthenticationError:"Authentication failed, please try again later.",speechUnknownError:"Something went wrong.",typingIndicatorStopStreamingAriaLabel:"Stop streaming",typingIndicatorStopRespondingAriaLabel:"Stop responding",warmWelcomeTitle:"Welcome to the new Bing",welcomeContainerPrivacyStatement:"Privacy statement",welcomeContainerUseTerms:"Terms of use",welcomeMessageItemTitle1:" Ask complex questions",welcomeMessageItemTitle2:" Get better answers",welcomeMessageItemTitle3:" Get creative inspiration",discoverMessageItemTitle:" Rewrite text together",welcomeMessageItemContent1:"What are some meals I can make for my picky toddler who only eats orange-colored food?",welcomeMessageItemContent2:"What are the pros and cons of the top 3 selling pet vacuums?",welcomeMessageItemContent3:"Write a haiku about crocodiles in outer space in the voice of a pirate",welcomeMessageItemContent4:"Draw a corgi in space in a cowboy hat",welcomeSubtitleText:"Your AI-powered copilot for the web",welcomeTertiaryTitleText:"Use the power of AI to find answers from the web, create written content, and more.",welcomeMessageItemLabel4:"New in More Creative:",welcomeLearnSegment1:"Let's learn together. Bing is powered by AI, so surprises and mistakes are possible. Make sure to check the facts, and ",welcomeLearnSegment2:"share feedback ",welcomeLearnSegment3:"so we can learn and improve!",muidUsersTermsCond1:"By clicking the '{0}' and continuing your interaction with Bing, you are accepting the",muidUsersTermsCond2:"and confirm you have reviewed the",muidUserGetStartedText:"Get Started",discoverMessageItemContent:"Try selecting text from the page to see what we can do together.",discoverEdgeConsentTitle:"Give permissions",toneSelectorDescription:"Choose a conversation style",toneSelectorCreative:"Creative",toneSelectorCreativeModifier:"More",toneSelectorCreativeTooltip:"Clear your conversation and start an original and imaginative chat",toneSelectorBalanced:"Balanced",toneSelectorBalancedModifier:"More",toneSelectorBalancedTooltip:"Clear your conversation and start an informative and friendly chat",toneSelectorPrecise:"Precise",toneSelectorPreciseModifier:"More",toneSelectorPreciseTooltip:"Clear your conversation and start a concise and straightforward chat",welcomeMobSugg1:"How does Bing use AI?",welcomeMobSugg2:"What else can Bing do?",welcomeMobSugg3:"What is the latest news in tech?",welcomeMobCreativeSugg1:"Where can I see the stars?",welcomeMobCreativeSugg2:"Write a poem about polar bears",welcomeMobCreativeSugg3:"Draw a corgi in outer space",feedbackPromptPositive:"Glad you liked this answer!",feedbackFirstMessage:"Sorry that wasn't helpful to you. Can you tell me more about what you didn't like?",feedbackPromptMessage:"Thanks for the heads up. Please give feedback so the Bing team can take a look.",feedbackPromptGiveFeedback:"Give feedback",feedbackPromptGiveFeedbackAriaLabel:"Give feedback",feedbackPromptReportAConcern:"Report a concern",feedbackShareConversationQuery:"What is the new Bing?",feedbackFormTitleText:"Why wasnt this helpful?",feedbackFormInputDefaultText:"Add more details here. To help protect your privacy, dont include personal information such as your name or email address.",feedbackFormLegalText:"Legal or policy issue?",feedbackFormReportAConcern:"Report a concern",feedbackFormNotificationTitleText:"Feedback submitted",feedbackFormNotificationBodyText:"Thanks for helping Bing improve!",messageLearnMore:"Learn more:",messagePrivacyLabel:"Work content and chats cannot be seen outside your organization",messageSharedContent:"Shared Content",messageSentAriaLabelPrefix:"Sent message",messageReceivedAriaLabelPrefix:"Received message",metaInternalSearchQuery:"Searching for: `{0}`",metaInternalLoaderMessage:"Generating answers for you...",messageActionsCopy:"Copy",messageActionsCopying:"Copying",messageActionsCopied:"Copied",messageActionsCopyError:"Error",messageActionsReport:"Report",messageActionsExportPdf:"PDF",messageActionsExportText:"Text",messageActionsExportWord:"Word",tooltipPositive:"Like",tooltipNegative:"Dislike",tooltipShare:"Share",tooltipMore:"More",tooltipExport:"Export",newTopicPrompt:"New topic lets you begin a fresh conversation with Bing on any subject",newTopicGreet1:"Thanks for clearing my head! What can I help you with now?",newTopicGreet2:"Great, let's change the subject. What's on your mind?",newTopicGreet3:"Thank you! It's always helpful to know when you're ready to move on. What can I answer for you now?",newTopicGreet4:"It's always great to start fresh. Ask me anything!",newTopicGreet5:"All right, I've reset my brain for a new conversation. What would you like to chat about now?",newTopicGreet6:"No problem, I'm glad you enjoyed our previous conversation. Let's move on to a new topic. What do you want to know more about?",newTopicGreet7:"Sure thing, I'm ready for a new challenge. What can I do for you now?",newTopicGreet8:"Okay, I've cleared the slate for a fresh start. What can I help you explore now?",newTopicGreet9:"Got it, I've erased the past and focused on the present. What shall we discover now?",newTopicGreet10:"Of course, I'm happy to start over. What can I assist you with now?",newTopicGreet11:"Alright, I've wiped the slate clean for a new conversation. What can I chat with you about now?",newTopicGreet12:"No worries, I'm excited to try something new. What can I answer for you now?",newTopicSugg1:"What is the world's smallest mammal?",newTopicSugg2:"Make me laugh",newTopicSugg3:"What's happening in the news?",newTopicSugg4:"Teach me a new word",newTopicSugg5:"Show me inspirational quotes",newTopicSugg6:"Tell me a joke",newTopicSugg7:"I need help with homework",newTopicSugg8:"Looking for a non-fiction",newTopicSugg9:"Inspire me!",newTopicSugg10:"Show me recipes",newTopicSugg11:"How can I create a budget?",newTopicSugg12:"Teach me a new word",newTopicSugg13:"What's the weather?",newTopicSugg14:"I want to learn a new skill",newTopicSugg15:"How do I set achievable goals?",newTopicSugg16:"How did the universe begin?",newTopicSugg17:"Why do humans need sleep?",newTopicSugg18:"How do l bake a cake?",newTopicSugg19:"Why are flamingo's pink?",newTopicSugg20:"How do holograms work?",newTopicSugg21:"How were the pyramids built?",newTopicSugg22:"Teach me about the moon landing",newTopicSugg23:"Which is deepest ocean?",newTopicSugg24:"How many hours are in a year?",newTopicSugg25:"I want to learn a new skill",newUserGreet:"Hi there, this is Bing. I'm here to help you find answers, learn new things, and have fun, all using the power of AI. What would you like to do today?",newUserSugg1:"Search the web",newUserSugg2:"Tell me a joke",newUserSugg3:"Write me a poem",repeatUserGreet:"Welcome back. I'm happy to see you again. What can I help you with today?",repeatUserSugg1:"What's the latest news",repeatUserSugg2:"Create a song",repeatUserSugg3:"Show me something cool",notiReConnect:"Attempting to reconnect...",notiChatEnd:"Chat topic ended.",notiRestartChat:"Start a new topic in {0} hour(s)",notificationDisengaged:"It might be time to move onto a new topic.",notificationForbidden:"Sorry, looks like you no longer have access to this feature. Please check again in a few days.",notificationResetConversation:"Sorry, looks like something went wrong.",notificationResetConversationCta:"Let's start over.",notificationMaxTurnsPerDay:"This has been lovely, but youve reached your daily limit. Chat again tomorrow?",notificationMaxTurnsPerConversation:'Sorry, I think we need to move on! Use the "broom" button below to sweep this away and chat about something else.',notificationMaxTurnsForMuidUsers:"Sorry, this conversation has reached its limit.",notificationProcessing:"One moment while we try to connect",notificationTooManyRequests:"Sorry, we're experiencing exceptionally high demand. Please try again later.",notificationUnauthorized:"Sorry, it looks like you've been signed out.",notificationUnauthorizedCta:"Please sign-in again.",notificationUnauthorizedMuidUsersCta:"Sign in now to chat longer!",notificationAttemptingToReconnect:"Attempting to reconnect...",notificationNetworkSettings:"Sorry, looks like your network settings are preventing access to this feature.",notificationLostConnection:"Sorry, but it looks like your connection has been lost.",notificationLostConnectionCta:"Would you like to try re-connecting?",notificationMessageError:"It looks like your last message was interrupted.",notificationMessageErrorCta:"Would you like to try re-sending?",notificationInvalidSessionRecovered:"Looks like you've been away, so we had to reset the conversation. Previous messages will no longer be referenced.",notificationSharedTip:"This conversation &lt;strong&gt;'{0}'&lt;/strong&gt; was shared with you on {1}",creativeGreet:"Lets get creative! Do you have a topic in mind or should we wing it?",balancedGreet:"Okay, let's find answers and have a little chat, too. What can I do for you?",preciseGreet:"Hello, Im here to find answers for you. What questions do you have?",creativeSugg1:"Let's write a beat poem",creativeSugg2:"Tell me a story about puppies",creativeSugg3:"Tell me a weird fact",balancedSugg1:"Write a poem about popcorn",balancedSugg2:"Where can I see the stars nearby?",balancedSugg3:"I need some advice",preciseSugg1:"Tell me about the 22nd president",preciseSugg2:"When is the next solar eclipse",preciseSugg3:"I need help with research",workToggleDescription:"Workplace chat option",workToggleLabel:"Include work results",threadsTitle:"Chats",threadsRecentTitle:"Recent activity",threadsRecentTitleShort:"Recents",threadsSavedTitle:"Saved",threadsSeeAllRecent:"See all recent chats",threadsMinimizeRecent:"Minimize recent chats",threadsSeeAllSaved:"See all saved chats",threadsMinimizeSaved:"Minimize saved chats",threadsDefaultChatName:"Untitled chat",threadsDaysAgo:"{0} days ago",threadsYesterday:"Yesterday",threadsEdit:"Rename",threadsDelete:"Delete",threadsConfirm:"Confirm",threadsCancel:"Cancel",threadsChatHistory:"Chat history",threadsPreview:"Preview",threadsPreviewText:"Jump back into your recent chats",threadsDescription:"We recently added auto-saving chats to your Bing AI-powered copilot. All of your chats roam from desktop and mobile so you can easily pick up where you left off anywhere.",threadsDescriptionNote:"Note that all chats will be auto-deleted within 90 days unless specifically saved.",threadsSharedOnDate:"Shared on {0}",threadsLoad:"Load chat",threadsExportPanelTitle:"Select format",threadsExportPanelAriaLabel:"Select",pluginTitle:"Plugins",webPageContextPrefix:"Site visited"};var nd;(function(O){O.ChomskyIntent="ChomskyIntent"})(nd||(nd={}));const od={feedbackApi:{baseUrl:"https://substrate.office.com",path:"/tenantfeedback/api/v1/feedback/signals"},feedbackTokenApi:{baseUrl:"https://business.bing.com",path:"/api/v3/user/token/TenantFeedback"},tenantFeedBackClientName:"M365ChatMSB",tenantFeedBackAnswerType:"CopilotChatFeedback",isEnabled:!1,isWorkToggleEnabled:!1,hookIncomingMessage:(O,B)=>{const U=O[B];switch(U.messageType){case tr.Chat:(function(O){O.messageType=tr.IncomingBotResponse,function(O){if(O.text){const B=new RegExp(/\[([^\]]+)\]\(([^)]+)\)/g),U="[^$1^]($2)";O.text=O.text.replace(B,U),O.adaptiveCards&&O.adaptiveCards.length>0&&O.adaptiveCards[0]&&O.adaptiveCards[0].body&&O.adaptiveCards[0].body.length>0&&"TextBlock"===O.adaptiveCards[0].body[0].type&&(O.adaptiveCards[0].body[0]={...O.adaptiveCards[0].body[0],text:O.text})}}(O)})(U);break;case nd.ChomskyIntent:U.messageType=tr.Internal}return!1}};var ad;(function(O){O[O.secureConversation=0]="secureConversation",O[O.enableMetaMessages=1]="enableMetaMessages",O[O.enableLearnMore=2]="enableLearnMore",O[O.enableCitations=3]="enableCitations",O[O.enableWelcomeScreen=4]="enableWelcomeScreen",O[O.enableFeedbackOnFinalized=5]="enableFeedbackOnFinalized",O[O.enableShare=6]="enableShare",O[O.enableSharedAds=7]="enableSharedAds",O[O.enableShareConversation=8]="enableShareConversation",O[O.enableSendFeedback=9]="enableSendFeedback",O[O.enableShareCreator=10]="enableShareCreator",O[O.enableShareSemSerp=11]="enableShareSemSerp",O[O.enableShareClickOnly=12]="enableShareClickOnly",O[O.enableStopButton=13]="enableStopButton",O[O.enableAnswerCards=14]="enableAnswerCards",O[O.enableAds=15]="enableAds",O[O.enableTTSOnVoiceInput=16]="enableTTSOnVoiceInput",O[O.enableGhostedAutoSuggest=17]="enableGhostedAutoSuggest",O[O.enableTuringAutoSuggest=18]="enableTuringAutoSuggest",O[O.enableSuggHighTrigger=19]="enableSuggHighTrigger",O[O.enableApplyLinkToHoverAds=20]="enableApplyLinkToHoverAds",O[O.enableSpeechInput=21]="enableSpeechInput",O[O.enablePassBotGreetingInContext=22]="enablePassBotGreetingInContext",O[O.enableUpdateInternalLinksToOpenOnEdge=23]="enableUpdateInternalLinksToOpenOnEdge",O[O.enableLinkShare=24]="enableLinkShare",O[O.enableTextShare=25]="enableTextShare",O[O.enableInlineFeedback=26]="enableInlineFeedback",O[O.enableOffensiveFeedback=27]="enableOffensiveFeedback",O[O.enableErrorStateNotification=28]="enableErrorStateNotification",O[O.enableHoverCardAttributionFavicons=29]="enableHoverCardAttributionFavicons",O[O.enableErrorStateToastNotificationResetButton=30]="enableErrorStateToastNotificationResetButton",O[O.enableAnsCardSfx=31]="enableAnsCardSfx",O[O.enableErrorInstrumentaton=32]="enableErrorInstrumentaton",O[O.enableSecureUpdateConversation=33]="enableSecureUpdateConversation",O[O.enableSecureSendFeedback=34]="enableSecureSendFeedback",O[O.enableSpeechChatDataAfterPhrase=35]="enableSpeechChatDataAfterPhrase",O[O.enableSpeechEarconOnInput=36]="enableSpeechEarconOnInput",O[O.enableSimpleVoiceInput=37]="enableSimpleVoiceInput",O[O.enableSpeechFateTTSStop=38]="enableSpeechFateTTSStop",O[O.enableSpeechGetUserMedia=39]="enableSpeechGetUserMedia",O[O.enableSpeechErrorHandling=40]="enableSpeechErrorHandling",O[O.enableSpeechTTSLatencyLogging=41]="enableSpeechTTSLatencyLogging",O[O.enableVersionPrompt=42]="enableVersionPrompt",O[O.enableMaxTurnsPerConversation=43]="enableMaxTurnsPerConversation",O[O.enableMaxTurnsPerConversationWithoutTurnCounter=44]="enableMaxTurnsPerConversationWithoutTurnCounter",O[O.enableResponseToneSelector=45]="enableResponseToneSelector",O[O.enablePersistentResponseToneSelector=46]="enablePersistentResponseToneSelector",O[O.enableResponseToneColorThemes=47]="enableResponseToneColorThemes",O[O.enableNewTopicAutoExpand=48]="enableNewTopicAutoExpand",O[O.enableAdSlugsMobile=49]="enableAdSlugsMobile",O[O.enableAdSlugsDesktop=50]="enableAdSlugsDesktop",O[O.enableAdSlugsAtEndOfGroup=51]="enableAdSlugsAtEndOfGroup",O[O.enableSpeechAriaLabel=52]="enableSpeechAriaLabel",O[O.enableSydImageCreate=53]="enableSydImageCreate",O[O.enablePerfTracker=54]="enablePerfTracker",O[O.enableSinglePerfEventPerMessage=55]="enableSinglePerfEventPerMessage",O[O.enableRedirectToLoginUrl=56]="enableRedirectToLoginUrl",O[O.enableDeleteMessageUpdate=57]="enableDeleteMessageUpdate",O[O.enableAutoRecoverFromInvalidSession=58]="enableAutoRecoverFromInvalidSession",O[O.enableFullScreenMobile=59]="enableFullScreenMobile",O[O.enableFeedbackClientSideScreenshot=60]="enableFeedbackClientSideScreenshot",O[O.enableMMStaticMessage=61]="enableMMStaticMessage",O[O.enableShareWithNoMargin=62]="enableShareWithNoMargin",O[O.enableCreativeLandingPage=63]="enableCreativeLandingPage",O[O.enableTonePerf=64]="enableTonePerf",O[O.enableAutoRecoverFromInvalidSessionForFirstTurn=65]="enableAutoRecoverFromInvalidSessionForFirstTurn",O[O.enablePageHeaderOverlapClamping=66]="enablePageHeaderOverlapClamping",O[O.enableOneClickCopy=67]="enableOneClickCopy",O[O.enableActionBarIMEFix=68]="enableActionBarIMEFix",O[O.enableThreads=69]="enableThreads",O[O.enableThreadsTestData=70]="enableThreadsTestData",O[O.enableFeedbackMenuOverflow=71]="enableFeedbackMenuOverflow",O[O.enableKatexCopy=72]="enableKatexCopy",O[O.enableServerLogMerging=73]="enableServerLogMerging",O[O.enableShareQuestionWithResponse=74]="enableShareQuestionWithResponse",O[O.enableShareQuestionTitlePrefix=75]="enableShareQuestionTitlePrefix",O[O.enableMessageExport=76]="enableMessageExport",O[O.enableFlatActionBar=77]="enableFlatActionBar",O[O.enableStandaloneUtility=78]="enableStandaloneUtility",O[O.enableShareWholeThreadMockUp=79]="enableShareWholeThreadMockUp",O[O.enableMUIDUserMode=80]="enableMUIDUserMode",O[O.enableShareOnHostMessage=81]="enableShareOnHostMessage",O[O.enableLongDocument=82]="enableLongDocument",O[O.enableShareInlineAdsIframe=83]="enableShareInlineAdsIframe",O[O.enableCodexMuidConsent=84]="enableCodexMuidConsent",O[O.enableThreadShareLandingPage=85]="enableThreadShareLandingPage",O[O.enableThreadShareWithoutRenderCardRequest=86]="enableThreadShareWithoutRenderCardRequest",O[O.enableShareThreadWithNoCache=87]="enableShareThreadWithNoCache",O[O.enableShareLoadingUI=88]="enableShareLoadingUI",O[O.enableFeedbackInstrumentation=89]="enableFeedbackInstrumentation",O[O.enableShareModalDialog=90]="enableShareModalDialog",O[O.enableShareCenterAlignment=91]="enableShareCenterAlignment",O[O.enableThreadContextMenu=92]="enableThreadContextMenu",O[O.enableRichTextPaste=93]="enableRichTextPaste",O[O.enableAnswerScreenshot=94]="enableAnswerScreenshot",O[O.enableCopyButtonInstrumented=95]="enableCopyButtonInstrumented",O[O.enableMessageExportWithPlainText=96]="enableMessageExportWithPlainText",O[O.enableGetChats=97]="enableGetChats",O[O.enableExportDocxWithFormat=98]="enableExportDocxWithFormat",O[O.enableContextMessage=99]="enableContextMessage",O[O.enableUpdateConversationMessages=100]="enableUpdateConversationMessages",O[O.enableFlux3P=101]="enableFlux3P",O[O.enableServerMetaText=102]="enableServerMetaText",O[O.enableThreadSync=103]="enableThreadSync",O[O.enableCloudflareCaptcha=104]="enableCloudflareCaptcha",O[O.enableExportConversation=105]="enableExportConversation"})(ad||(ad={}));const sd={secureConversation:!0,enableMetaMessages:!0,enableLearnMore:!0,enableCitations:!0,enableWelcomeScreen:!0,enableShare:!1,enableSharedAds:!1,enableShareConversation:!1,enableSendFeedback:!1,enableShareCreator:!1,enableShareSemSerp:!1,enableShareClickOnly:!1,enableStopButton:!0,enableAnswerCards:!0,enableAds:!0,enableTTSOnVoiceInput:!0,enableExportConversation:!0,enableGhostedAutoSuggest:!1,enableTuringAutoSuggest:!1,enableSuggHighTrigger:!1,enableApplyLinkToHoverAds:!0,enableSpeechInput:!0,enablePassBotGreetingInContext:!0,enableUpdateInternalLinksToOpenOnEdge:!1,enableTextShare:!1,enableLinkShare:!1,enableInlineFeedback:!1,enableOffensiveFeedback:!1,enableErrorStateNotification:!1,enableFeedbackOnFinalized:!1,enableHoverCardAttributionFavicons:!1,enableErrorStateToastNotificationResetButton:!1,enableAnsCardSfx:!1,enableErrorInstrumentaton:!1,enableSecureUpdateConversation:!1,enableSecureSendFeedback:!1,enableSpeechChatDataAfterPhrase:!1,enableSpeechEarconOnInput:!1,enableSimpleVoiceInput:!1,enableSpeechFateTTSStop:!1,enableSpeechGetUserMedia:!1,enableSpeechErrorHandling:!1,enableSpeechTTSLatencyLogging:!1,enableVersionPrompt:!1,enableMaxTurnsPerConversation:!1,enableMaxTurnsPerConversationWithoutTurnCounter:!1,enableResponseToneSelector:!1,enablePersistentResponseToneSelector:!1,enableResponseToneColorThemes:!1,enableNewTopicAutoExpand:!1,enableAdSlugsMobile:!1,enableAdSlugsDesktop:!1,enableAdSlugsAtEndOfGroup:!1,enableSpeechAriaLabel:!1,enableShareLoadingUI:!1,enableSydImageCreate:!1,enablePerfTracker:!1,enableRedirectToLoginUrl:!1,enableDeleteMessageUpdate:!1,enableAutoRecoverFromInvalidSession:!1,enableFullScreenMobile:!1,enableFeedbackClientSideScreenshot:!1,enableMMStaticMessage:!1,enableShareWithNoMargin:!1,enableCreativeLandingPage:!1,enableTonePerf:!1,enableAutoRecoverFromInvalidSessionForFirstTurn:!1,enablePageHeaderOverlapClamping:!1,enableOneClickCopy:!1,enableActionBarIMEFix:!1,enableThreads:!1,enableThreadsTestData:!1,enableFeedbackMenuOverflow:!1,enableMUIDUserMode:!1,enableSinglePerfEventPerMessage:!1,enableLongDocument:!1,enableKatexCopy:!0,enableServerLogMerging:!1,enableShareQuestionWithResponse:!1,enableShareQuestionTitlePrefix:!1,enableMessageExport:!1,enableMessageExportWithPlainText:!1,enableStandaloneUtility:!1,enableShareWholeThreadMockUp:!1,enableFlatActionBar:!1,enableShareOnHostMessage:!1,enableCodexMuidConsent:!1,enableShareInlineAdsIframe:!1,enableThreadShareLandingPage:!1,enableThreadShareWithoutRenderCardRequest:!1,enableShareThreadWithNoCache:!1,enableShareModalDialog:!1,enableRichTextPaste:!1,enableThreadContextMenu:!1,enableShareCenterAlignment:!1,enableCopyButtonInstrumented:!1,enableGetChats:!1,enableExportDocxWithFormat:!1,enableContextMessage:!1,enableUpdateConversationMessages:!1,enableFlux3P:!1,enableServerMetaText:!1,enableThreadSync:!1,enableCloudflareCaptcha:!1};class ConfigBuilder{constructor(){}static getConfig(){const O=ConfigBuilder.getLocationData();let B="https://www.bing.com";new URLSearchParams(window.location.search).forEach(((O,U)=>{"testhooks"===U.toLowerCase()&&(B=window.location.origin)}));let U="/search?",G="/images/create?";if(new URLSearchParams(window.location.search).has("testhooks")){const O=["q","showselans","showadsonly","showselective"];new URLSearchParams(window.location.search).forEach(((B,q)=>{if(!O.includes(q.toLowerCase())){const O=`${q}=${B}&`;G+=O,U+=O}}))}const q=ConfigBuilder.getPartnerAppConfig();return{features:sd,messaging:{enableSyntheticStreaming:!0,attributionMatcher:/\[\^?\d+\^?\].+?"\n\n?/g,streamAnnRules:!0,streamCachedResponses:!0,streamSyntheticTextResponses:!1,messageBufferWorkerDefaultDelayMS:2e3,messageBufferWorkerStreamDelayMS:1e3/15,maxTurnsPerConversation:5},telemetry:{eventID:"Codex",instrumentedLinkName:"CodexInstLink",externalLinkName:"CodexInstExtLink",kSeedBase:6500,kSeedIncrement:500,instSuffix:0,instSuffixIncrement:1},ads:{baseUrl:B,path:U,query:{showonlyads:"1",codex_conid:"<<conversationId>>",codex_summ:"<<conversationSummary>>"}},answers:{baseUrl:B,path:U,query:{showselans:"1"},answerCardDimensionUpdateTimeout:1e4},captcha:{baseUrl:B,path:"/turing/captcha/challenge"},contentCreator:{baseUrl:B,path:G,query:{partner:"sydney",re:"1",showselective:"1",sude:"1"}},creator:{feedbackId:void 0},debug:{},demo:{},greeting:{adaptiveCard:[],shouldSendBotGreeting:!0,suggestionList:[]},speech:{isEnabled:!0,baseUrl:"https://sr.bing.com",path:"/opaluqu/speech/recognition/interactive/cognitiveservices/v1",query:{clientbuild:"sydney",referer:encodeURIComponent(document.location.href).substring(0,1e3),uqurequestid:"<<uqurequestid>>"},micPermissionProvider:void 0,textToSpeechProvider:createAudio,speechToTextProvider:void 0},semserp:{isEnabled:!0,baseUrl:B,path:U,query:{p1:'mustshow service="wholepagetemplate"',mkt:O.market,features:["deepleoprewon","sydneyxg","deepleopostwon","leowasth1","deepleowannpon","deepleostoryans","wpsemserp","wptempux"]}},suggestions:{isEnabled:!0,baseUrl:"https://www.bingapis.com",path:"/api/v7/suggestions",query:{appid:"B1513F135D0D1D1FC36E8C31C30A31BB25E804D0",setmkt:O.market}},textPrediction:{baseUrl:"https://turing-writingassistance.edge.microsoft.com/",pathAutoSuggest:"textprediction-v2/",lowTrigger:"en-v2-low-tr",highTrigger:"en-v2-high-tr",subscriptionKey:"c540f39b7c0541289123636852077ac6",query:{market:O.market}},bing:{sendClickBeacon:O=>{},baseUrl:B,stagingUrl:"https://www.staging-bing-int.com",isVisualParityRun:!1,pathCreateConversation:"/turing/conversation/create",pathCopyConversation:"/turing/conversation/copy",shouldShowConversation:!1,signIn:{baseUrl:B,path:"/fd/auth/signin",query:{return_url:`${window.location.href}&showconv=1`,action:"interactive",provider:"windows_live_id"}},requestLogin:O=>{window.location.assign(O.buildUrl(O.bing.signIn))}},logging:{logLevel:Kl.Off},sydney:{baseUrl:"https://sydney.bing.com",pathBase:"/sydney",pathChat:"/Chat",pathChatHub:"/ChatHub",pathFeedback:"/SendFeedback",pathUpdateConversation:"/UpdateConversation",pathDeleteSingleConversation:"/DeleteSingleConversation",pathGetConversation:"/GetConversation",pathGetSharedMessages:"/GetSharedMessages",pathShareMessages:"/ShareMessages",pathEditThread:"/RenameChat",pathDeleteConversation:"/DeleteConversation",queryGetConversation:{conversationId:"<<conversationId>>",source:"cib"},hostnamesToBypassSecureConnection:["www.staging-bing-int.com","cib-serp.azurewebsites.net","cib-serp-dev.azurewebsites.net","cib-serp-bugbash.azurewebsites.net","localhost"],slottedModeTurnIndex:0,retryConfigs:ConfigBuilder.getSydneyRetryConfigs(),request:{source:"cib",optionsSets:["nlu_direct_response_filter","deepleo","enable_debug_commands","disable_emoji_spoken_text","responsible_ai_policy_235","enablemm"],allowedMessageTypes:ConfigBuilder.getSydneyAllowedMessageTypes(),sliceIds:[],verbosity:"verbose"},message:{...O},LOCATION_OF_HUMAN_PARAM:"LOCATION_OF_HUMAN",LOCATION_OF_HUMAN_VALUE:"Redmond, WA"},partner:q,strings:rd,links:td,bingAtWork:od,edgeAction:ed,shareScreenshot:{dataHtmlToCanvasHiddenElement:"data-html2canvas-hidden-element",dataHtmlToCanvasHiddenIframeElement:"data-html2canvas-hidden-iframe-element",dataHtmlToCanvasIgnoreClassName:"data-html2canvas-ignore",base64MaxSize:2044e4,quality:1}}}static getSydneyAllowedMessageTypes(){return[tr.ActionRequest,tr.Chat,tr.Context,tr.InternalSearchQuery,tr.InternalSearchResult,tr.Disengaged,tr.InternalLoaderMessage,tr.RenderCardRequest,tr.AdsQuery,tr.SemanticSerp,tr.GenerateContentQuery,tr.SearchQuery]}static getPartnerAppConfig(){var O;return null!==(O=window.SydneyPartnerConfig)&&void 0!==O?O:{}}static getSydneyRetryConfigs(){return{defaultRetryCount:0,[Wi.InternalError]:3,[Wi.InvalidRequest]:0,[Wi.InvalidSession]:1}}static getLocationData(){var O;const B=null!==(O=window._G)&&void 0!==O?O:{Lang:"en-US",Mkt:"en-US",Region:"US"};return{locale:B.Lang,market:B.Mkt,region:B.Region,location:"lat:47.639557;long:-122.128159;re=1000m;"}}}var ld;class ConfigService extends lifecycle_Disposable{constructor(){super(),this.debug={},this.demo={},ld.set(this,void 0),__classPrivateFieldSet(this,ld,ConfigBuilder.getConfig(),"f")}get ads(){return __classPrivateFieldGet(this,ld,"f").ads}get bing(){return __classPrivateFieldGet(this,ld,"f").bing}get bingAtWork(){return __classPrivateFieldGet(this,ld,"f").bingAtWork}get edgeAction(){return __classPrivateFieldGet(this,ld,"f").edgeAction}get creator(){return __classPrivateFieldGet(this,ld,"f").creator}get answers(){return __classPrivateFieldGet(this,ld,"f").answers}get features(){return __classPrivateFieldGet(this,ld,"f").features}get greeting(){return __classPrivateFieldGet(this,ld,"f").greeting}get captcha(){return __classPrivateFieldGet(this,ld,"f").captcha}get contentCreator(){return __classPrivateFieldGet(this,ld,"f").contentCreator}get logging(){return __classPrivateFieldGet(this,ld,"f").logging}get messaging(){return __classPrivateFieldGet(this,ld,"f").messaging}get links(){return __classPrivateFieldGet(this,ld,"f").links}get sydney(){return __classPrivateFieldGet(this,ld,"f").sydney}get semserp(){return __classPrivateFieldGet(this,ld,"f").semserp}get suggestions(){return __classPrivateFieldGet(this,ld,"f").suggestions}get partner(){return __classPrivateFieldGet(this,ld,"f").partner}get strings(){return __classPrivateFieldGet(this,ld,"f").strings}get speech(){return __classPrivateFieldGet(this,ld,"f").speech}get telemetry(){return __classPrivateFieldGet(this,ld,"f").telemetry}get textPrediction(){return __classPrivateFieldGet(this,ld,"f").textPrediction}get shareScreenshot(){return __classPrivateFieldGet(this,ld,"f").shareScreenshot}buildUrl(O){const{baseUrl:B,path:U,query:G}=O;let q;if(q=U?new URL(U,B):new URL(B),G)for(const O in G)if(Object.prototype.hasOwnProperty.call(G,O)){const B=G[O];if(void 0!==B)if(Array.isArray(B))if("features"===O)q.searchParams.set(O,B.join(","));else for(const U of B)q.searchParams.append(O,U);else q.searchParams.set(O,B)}return q}}function types_isObject(O){return!("object"!=typeof O||null===O||Array.isArray(O)||O instanceof RegExp||O instanceof Date)}ld=new WeakMap;function isUndefinedOrNull(O){return function(O){return void 0===O}(O)||null===O}Object.prototype.hasOwnProperty;function types_isFunction(O){return"function"==typeof O}class ConsoleTextFragment{constructor(O,B=""){this.text=O,this.style=B}get textTemplate(){return""!==this.style?`%c${this.text}`:this.text}get textStyle(){return this.style}}const cd=new Map;cd.set(Kl.Trace,{logLevel:Kl.Trace,logMethod:console.debug,linePrefix:new ConsoleTextFragment(" TRACE","color: #888; margin-left: 10px;")}),cd.set(Kl.Debug,{logLevel:Kl.Debug,logMethod:console.info,linePrefix:new ConsoleTextFragment(" DEBUG","color: #888; margin-left: 10px; background: #eee;")}),cd.set(Kl.Info,{logLevel:Kl.Info,logMethod:console.info,linePrefix:new ConsoleTextFragment("  INFO","color: #33f; margin-left: 10px;")}),cd.set(Kl.Warning,{logLevel:Kl.Warning,logMethod:console.warn,linePrefix:new ConsoleTextFragment(" WARN","color: #993;")}),cd.set(Kl.Error,{logLevel:Kl.Error,logMethod:console.error,linePrefix:new ConsoleTextFragment("ERROR","color: #f33;")});let dd=class extends lifecycle_Disposable{constructor(O){super(),this.config=O}trace(O,B,U,...G){return this.createBoundLogger(Kl.Trace,O,B,U,G)}debug(O,B,U,...G){return this.createBoundLogger(Kl.Debug,O,B,U,G)}info(O,B,U,...G){return this.createBoundLogger(Kl.Info,O,B,U,G)}warn(O,B,U,...G){return this.createBoundLogger(Kl.Warning,O,B,U,G)}error(O,B,U,...G){return this.createBoundLogger(Kl.Error,O,B,U,G)}createBoundLogger(O,B,U,G,q){const j={write(){}};let W=[];if(this.config.logging.logLevel<=O){const Y=function(O,B){let U,G;"string"==typeof B&&(G=B);if("string"==typeof O)U=O;else if("object"==typeof O&&"function"==typeof O.constructor&&(U=O.constructor.name,!G&&"function"==typeof B&&(G=B.name,!G)))for(const U in O)if(O.hasOwnProperty(U)){const q=O[U];if(types_isFunction(q)&&q===B){G=U;break}}return U||(U="UnknownSource"),G||(G="UnknownCaller"),`${U}:${G}`}(B,U),K=cd.get(O);if(W=function(O,B,U,G){const q=function(O,B,U){const G=function(O){const B=getSegmentFragments("cib","color: orange; font-weight: bold;",!0);return B.push(...function(O){const B=[];if(O&&null!==O){const U=O.split(":");for(let O=0;O<U.length;O++){const G=Math.min(O,pd.length-1);B.push(...getSegmentFragments(U[O],`color: ${pd[G]};`))}}return B}(O)),B}(B);G.unshift(O);const q=[""];G.forEach((O=>function(O,B){O[0]+=B.textTemplate,""!==B.textStyle&&O.push(B.textStyle)}(q,O))),U&&null!==U&&(q[0]+=":",q.push(`${U}`));return q}(O.linePrefix,B,U);return q.push(...G),q}(K,Y,G,q),j.write=K.logMethod.bind(this,...W),this.config.bing.isVisualParityRun)try{JSON.stringify([this,W])}catch(O){j.write=()=>{console.error("Error serializing log arguments. This will break in SNR.",O)}}}return j}};dd=__decorate([__param(0,ql),__metadata("design:paramtypes",[Object])],dd);const pd=["#00f","#007","#004","#002"];const ud=new ConsoleTextFragment("[","color: black; margin-left: 10px;");function getSegmentFragments(O,B,U=!1){return[U?ud:new ConsoleTextFragment(":["),new ConsoleTextFragment(O,B),new ConsoleTextFragment("]","color: black;")]}const hd=kt.createInterface("IBingApiClient");class CreateConversationError extends Error{constructor(O,B,U){super(O),this.result=B,this.name="CreateConversationError",U&&(U instanceof Error?this.cause=U:this.cause=new Error(String(U)))}}class WindowManager{constructor(){this._zoomLevel=0,this._zoomFactor=1,this._fullscreen=!1,this._onDidChangeFullscreen=new Emitter,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(O,B){this._zoomLevel!==O&&(this._zoomLevel=O)}getZoomFactor(){return this._zoomFactor}setZoomFactor(O){this._zoomFactor=O}setFullscreen(O){this._fullscreen!==O&&(this._fullscreen=O,this._onDidChangeFullscreen.fire())}isFullscreen(){return this._fullscreen}}WindowManager.INSTANCE=new WindowManager;class DevicePixelRatioMonitor extends lifecycle_Disposable{constructor(){super(),this._onDidChange=this._register(new Emitter),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(!0),this._mediaQueryList=null,this._handleChange(!1)}_handleChange(O){var B;null===(B=this._mediaQueryList)||void 0===B||B.removeEventListener("change",this._listener),this._mediaQueryList=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),O&&this._onDidChange.fire()}}class PixelRatioImpl extends lifecycle_Disposable{constructor(){super(),this._onDidChange=this._register(new Emitter),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio();const O=this._register(new DevicePixelRatioMonitor);this._register(O.onDidChange((()=>{this._value=this._getPixelRatio(),this._onDidChange.fire(this._value)})))}get value(){return this._value}_getPixelRatio(){const O=document.createElement("canvas").getContext("2d");return(window.devicePixelRatio||1)/(O.webkitBackingStorePixelRatio||O.mozBackingStorePixelRatio||O.msBackingStorePixelRatio||O.oBackingStorePixelRatio||O.backingStorePixelRatio||1)}}new class{constructor(){this._pixelRatioMonitor=null}_getOrCreatePixelRatioMonitor(){return this._pixelRatioMonitor||(this._pixelRatioMonitor=function(O){return null==jt||jt.markAsSingleton(O),O}(new PixelRatioImpl)),this._pixelRatioMonitor}get value(){return this._getOrCreatePixelRatioMonitor().value}get onDidChange(){return this._getOrCreatePixelRatioMonitor().onDidChange}};WindowManager.INSTANCE.onDidChangeFullscreen;const md=navigator.userAgent,gd=(md.indexOf("Firefox"),md.indexOf("AppleWebKit"),md.indexOf("Chrome")>=0),fd=!gd&&md.indexOf("Safari")>=0;md.indexOf("Electron/"),md.indexOf("Android");let yd=!1;if(window.matchMedia){const O=window.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),B=window.matchMedia("(display-mode: fullscreen)");yd=O.matches,function(O,B){"string"==typeof O&&(O=window.matchMedia(O)),O.addEventListener("change",B)}(O,(({matches:O})=>{yd&&B.matches||(yd=O)}))}var _d;U(9870);(function(O){O[O.Always=0]="Always",O[O.FullScreen=1]="FullScreen",O[O.None=2]="None"})(_d||(_d={}));document.queryCommandSupported&&document.queryCommandSupported("copy")||navigator&&navigator.clipboard&&navigator.clipboard.writeText,navigator&&navigator.clipboard&&navigator.clipboard.readText,yd||navigator.keyboard,"ontouchstart"in window||navigator.maxTouchPoints,window.PointerEvent&&("ontouchstart"in window||window.navigator.maxTouchPoints>0||navigator.maxTouchPoints);var vd,bd;(function(O){O[O.DependsOnKbLayout=-1]="DependsOnKbLayout",O[O.Unknown=0]="Unknown",O[O.Backspace=1]="Backspace",O[O.Tab=2]="Tab",O[O.Enter=3]="Enter",O[O.Shift=4]="Shift",O[O.Ctrl=5]="Ctrl",O[O.Alt=6]="Alt",O[O.PauseBreak=7]="PauseBreak",O[O.CapsLock=8]="CapsLock",O[O.Escape=9]="Escape",O[O.Space=10]="Space",O[O.PageUp=11]="PageUp",O[O.PageDown=12]="PageDown",O[O.End=13]="End",O[O.Home=14]="Home",O[O.LeftArrow=15]="LeftArrow",O[O.UpArrow=16]="UpArrow",O[O.RightArrow=17]="RightArrow",O[O.DownArrow=18]="DownArrow",O[O.Insert=19]="Insert",O[O.Delete=20]="Delete",O[O.Digit0=21]="Digit0",O[O.Digit1=22]="Digit1",O[O.Digit2=23]="Digit2",O[O.Digit3=24]="Digit3",O[O.Digit4=25]="Digit4",O[O.Digit5=26]="Digit5",O[O.Digit6=27]="Digit6",O[O.Digit7=28]="Digit7",O[O.Digit8=29]="Digit8",O[O.Digit9=30]="Digit9",O[O.KeyA=31]="KeyA",O[O.KeyB=32]="KeyB",O[O.KeyC=33]="KeyC",O[O.KeyD=34]="KeyD",O[O.KeyE=35]="KeyE",O[O.KeyF=36]="KeyF",O[O.KeyG=37]="KeyG",O[O.KeyH=38]="KeyH",O[O.KeyI=39]="KeyI",O[O.KeyJ=40]="KeyJ",O[O.KeyK=41]="KeyK",O[O.KeyL=42]="KeyL",O[O.KeyM=43]="KeyM",O[O.KeyN=44]="KeyN",O[O.KeyO=45]="KeyO",O[O.KeyP=46]="KeyP",O[O.KeyQ=47]="KeyQ",O[O.KeyR=48]="KeyR",O[O.KeyS=49]="KeyS",O[O.KeyT=50]="KeyT",O[O.KeyU=51]="KeyU",O[O.KeyV=52]="KeyV",O[O.KeyW=53]="KeyW",O[O.KeyX=54]="KeyX",O[O.KeyY=55]="KeyY",O[O.KeyZ=56]="KeyZ",O[O.Meta=57]="Meta",O[O.ContextMenu=58]="ContextMenu",O[O.F1=59]="F1",O[O.F2=60]="F2",O[O.F3=61]="F3",O[O.F4=62]="F4",O[O.F5=63]="F5",O[O.F6=64]="F6",O[O.F7=65]="F7",O[O.F8=66]="F8",O[O.F9=67]="F9",O[O.F10=68]="F10",O[O.F11=69]="F11",O[O.F12=70]="F12",O[O.F13=71]="F13",O[O.F14=72]="F14",O[O.F15=73]="F15",O[O.F16=74]="F16",O[O.F17=75]="F17",O[O.F18=76]="F18",O[O.F19=77]="F19",O[O.NumLock=78]="NumLock",O[O.ScrollLock=79]="ScrollLock",O[O.Semicolon=80]="Semicolon",O[O.Equal=81]="Equal",O[O.Comma=82]="Comma",O[O.Minus=83]="Minus",O[O.Period=84]="Period",O[O.Slash=85]="Slash",O[O.Backquote=86]="Backquote",O[O.BracketLeft=87]="BracketLeft",O[O.Backslash=88]="Backslash",O[O.BracketRight=89]="BracketRight",O[O.Quote=90]="Quote",O[O.OEM_8=91]="OEM_8",O[O.IntlBackslash=92]="IntlBackslash",O[O.Numpad0=93]="Numpad0",O[O.Numpad1=94]="Numpad1",O[O.Numpad2=95]="Numpad2",O[O.Numpad3=96]="Numpad3",O[O.Numpad4=97]="Numpad4",O[O.Numpad5=98]="Numpad5",O[O.Numpad6=99]="Numpad6",O[O.Numpad7=100]="Numpad7",O[O.Numpad8=101]="Numpad8",O[O.Numpad9=102]="Numpad9",O[O.NumpadMultiply=103]="NumpadMultiply",O[O.NumpadAdd=104]="NumpadAdd",O[O.NUMPAD_SEPARATOR=105]="NUMPAD_SEPARATOR",O[O.NumpadSubtract=106]="NumpadSubtract",O[O.NumpadDecimal=107]="NumpadDecimal",O[O.NumpadDivide=108]="NumpadDivide",O[O.KEY_IN_COMPOSITION=109]="KEY_IN_COMPOSITION",O[O.ABNT_C1=110]="ABNT_C1",O[O.ABNT_C2=111]="ABNT_C2",O[O.AudioVolumeMute=112]="AudioVolumeMute",O[O.AudioVolumeUp=113]="AudioVolumeUp",O[O.AudioVolumeDown=114]="AudioVolumeDown",O[O.BrowserSearch=115]="BrowserSearch",O[O.BrowserHome=116]="BrowserHome",O[O.BrowserBack=117]="BrowserBack",O[O.BrowserForward=118]="BrowserForward",O[O.MediaTrackNext=119]="MediaTrackNext",O[O.MediaTrackPrevious=120]="MediaTrackPrevious",O[O.MediaStop=121]="MediaStop",O[O.MediaPlayPause=122]="MediaPlayPause",O[O.LaunchMediaPlayer=123]="LaunchMediaPlayer",O[O.LaunchMail=124]="LaunchMail",O[O.LaunchApp2=125]="LaunchApp2",O[O.Clear=126]="Clear",O[O.MAX_VALUE=127]="MAX_VALUE"})(vd||(vd={})),function(O){O[O.DependsOnKbLayout=-1]="DependsOnKbLayout",O[O.None=0]="None",O[O.Hyper=1]="Hyper",O[O.Super=2]="Super",O[O.Fn=3]="Fn",O[O.FnLock=4]="FnLock",O[O.Suspend=5]="Suspend",O[O.Resume=6]="Resume",O[O.Turbo=7]="Turbo",O[O.Sleep=8]="Sleep",O[O.WakeUp=9]="WakeUp",O[O.KeyA=10]="KeyA",O[O.KeyB=11]="KeyB",O[O.KeyC=12]="KeyC",O[O.KeyD=13]="KeyD",O[O.KeyE=14]="KeyE",O[O.KeyF=15]="KeyF",O[O.KeyG=16]="KeyG",O[O.KeyH=17]="KeyH",O[O.KeyI=18]="KeyI",O[O.KeyJ=19]="KeyJ",O[O.KeyK=20]="KeyK",O[O.KeyL=21]="KeyL",O[O.KeyM=22]="KeyM",O[O.KeyN=23]="KeyN",O[O.KeyO=24]="KeyO",O[O.KeyP=25]="KeyP",O[O.KeyQ=26]="KeyQ",O[O.KeyR=27]="KeyR",O[O.KeyS=28]="KeyS",O[O.KeyT=29]="KeyT",O[O.KeyU=30]="KeyU",O[O.KeyV=31]="KeyV",O[O.KeyW=32]="KeyW",O[O.KeyX=33]="KeyX",O[O.KeyY=34]="KeyY",O[O.KeyZ=35]="KeyZ",O[O.Digit1=36]="Digit1",O[O.Digit2=37]="Digit2",O[O.Digit3=38]="Digit3",O[O.Digit4=39]="Digit4",O[O.Digit5=40]="Digit5",O[O.Digit6=41]="Digit6",O[O.Digit7=42]="Digit7",O[O.Digit8=43]="Digit8",O[O.Digit9=44]="Digit9",O[O.Digit0=45]="Digit0",O[O.Enter=46]="Enter",O[O.Escape=47]="Escape",O[O.Backspace=48]="Backspace",O[O.Tab=49]="Tab",O[O.Space=50]="Space",O[O.Minus=51]="Minus",O[O.Equal=52]="Equal",O[O.BracketLeft=53]="BracketLeft",O[O.BracketRight=54]="BracketRight",O[O.Backslash=55]="Backslash",O[O.IntlHash=56]="IntlHash",O[O.Semicolon=57]="Semicolon",O[O.Quote=58]="Quote",O[O.Backquote=59]="Backquote",O[O.Comma=60]="Comma",O[O.Period=61]="Period",O[O.Slash=62]="Slash",O[O.CapsLock=63]="CapsLock",O[O.F1=64]="F1",O[O.F2=65]="F2",O[O.F3=66]="F3",O[O.F4=67]="F4",O[O.F5=68]="F5",O[O.F6=69]="F6",O[O.F7=70]="F7",O[O.F8=71]="F8",O[O.F9=72]="F9",O[O.F10=73]="F10",O[O.F11=74]="F11",O[O.F12=75]="F12",O[O.PrintScreen=76]="PrintScreen",O[O.ScrollLock=77]="ScrollLock",O[O.Pause=78]="Pause",O[O.Insert=79]="Insert",O[O.Home=80]="Home",O[O.PageUp=81]="PageUp",O[O.Delete=82]="Delete",O[O.End=83]="End",O[O.PageDown=84]="PageDown",O[O.ArrowRight=85]="ArrowRight",O[O.ArrowLeft=86]="ArrowLeft",O[O.ArrowDown=87]="ArrowDown",O[O.ArrowUp=88]="ArrowUp",O[O.NumLock=89]="NumLock",O[O.NumpadDivide=90]="NumpadDivide",O[O.NumpadMultiply=91]="NumpadMultiply",O[O.NumpadSubtract=92]="NumpadSubtract",O[O.NumpadAdd=93]="NumpadAdd",O[O.NumpadEnter=94]="NumpadEnter",O[O.Numpad1=95]="Numpad1",O[O.Numpad2=96]="Numpad2",O[O.Numpad3=97]="Numpad3",O[O.Numpad4=98]="Numpad4",O[O.Numpad5=99]="Numpad5",O[O.Numpad6=100]="Numpad6",O[O.Numpad7=101]="Numpad7",O[O.Numpad8=102]="Numpad8",O[O.Numpad9=103]="Numpad9",O[O.Numpad0=104]="Numpad0",O[O.NumpadDecimal=105]="NumpadDecimal",O[O.IntlBackslash=106]="IntlBackslash",O[O.ContextMenu=107]="ContextMenu",O[O.Power=108]="Power",O[O.NumpadEqual=109]="NumpadEqual",O[O.F13=110]="F13",O[O.F14=111]="F14",O[O.F15=112]="F15",O[O.F16=113]="F16",O[O.F17=114]="F17",O[O.F18=115]="F18",O[O.F19=116]="F19",O[O.F20=117]="F20",O[O.F21=118]="F21",O[O.F22=119]="F22",O[O.F23=120]="F23",O[O.F24=121]="F24",O[O.Open=122]="Open",O[O.Help=123]="Help",O[O.Select=124]="Select",O[O.Again=125]="Again",O[O.Undo=126]="Undo",O[O.Cut=127]="Cut",O[O.Copy=128]="Copy",O[O.Paste=129]="Paste",O[O.Find=130]="Find",O[O.AudioVolumeMute=131]="AudioVolumeMute",O[O.AudioVolumeUp=132]="AudioVolumeUp",O[O.AudioVolumeDown=133]="AudioVolumeDown",O[O.NumpadComma=134]="NumpadComma",O[O.IntlRo=135]="IntlRo",O[O.KanaMode=136]="KanaMode",O[O.IntlYen=137]="IntlYen",O[O.Convert=138]="Convert",O[O.NonConvert=139]="NonConvert",O[O.Lang1=140]="Lang1",O[O.Lang2=141]="Lang2",O[O.Lang3=142]="Lang3",O[O.Lang4=143]="Lang4",O[O.Lang5=144]="Lang5",O[O.Abort=145]="Abort",O[O.Props=146]="Props",O[O.NumpadParenLeft=147]="NumpadParenLeft",O[O.NumpadParenRight=148]="NumpadParenRight",O[O.NumpadBackspace=149]="NumpadBackspace",O[O.NumpadMemoryStore=150]="NumpadMemoryStore",O[O.NumpadMemoryRecall=151]="NumpadMemoryRecall",O[O.NumpadMemoryClear=152]="NumpadMemoryClear",O[O.NumpadMemoryAdd=153]="NumpadMemoryAdd",O[O.NumpadMemorySubtract=154]="NumpadMemorySubtract",O[O.NumpadClear=155]="NumpadClear",O[O.NumpadClearEntry=156]="NumpadClearEntry",O[O.ControlLeft=157]="ControlLeft",O[O.ShiftLeft=158]="ShiftLeft",O[O.AltLeft=159]="AltLeft",O[O.MetaLeft=160]="MetaLeft",O[O.ControlRight=161]="ControlRight",O[O.ShiftRight=162]="ShiftRight",O[O.AltRight=163]="AltRight",O[O.MetaRight=164]="MetaRight",O[O.BrightnessUp=165]="BrightnessUp",O[O.BrightnessDown=166]="BrightnessDown",O[O.MediaPlay=167]="MediaPlay",O[O.MediaRecord=168]="MediaRecord",O[O.MediaFastForward=169]="MediaFastForward",O[O.MediaRewind=170]="MediaRewind",O[O.MediaTrackNext=171]="MediaTrackNext",O[O.MediaTrackPrevious=172]="MediaTrackPrevious",O[O.MediaStop=173]="MediaStop",O[O.Eject=174]="Eject",O[O.MediaPlayPause=175]="MediaPlayPause",O[O.MediaSelect=176]="MediaSelect",O[O.LaunchMail=177]="LaunchMail",O[O.LaunchApp2=178]="LaunchApp2",O[O.LaunchApp1=179]="LaunchApp1",O[O.SelectTask=180]="SelectTask",O[O.LaunchScreenSaver=181]="LaunchScreenSaver",O[O.BrowserSearch=182]="BrowserSearch",O[O.BrowserHome=183]="BrowserHome",O[O.BrowserBack=184]="BrowserBack",O[O.BrowserForward=185]="BrowserForward",O[O.BrowserStop=186]="BrowserStop",O[O.BrowserRefresh=187]="BrowserRefresh",O[O.BrowserFavorites=188]="BrowserFavorites",O[O.ZoomToggle=189]="ZoomToggle",O[O.MailReply=190]="MailReply",O[O.MailForward=191]="MailForward",O[O.MailSend=192]="MailSend",O[O.MAX_VALUE=193]="MAX_VALUE"}(bd||(bd={}));class KeyCodeStrMap{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(O,B){this._keyCodeToStr[O]=B,this._strToKeyCode[B.toLowerCase()]=O}keyCodeToStr(O){return this._keyCodeToStr[O]}strToKeyCode(O){return this._strToKeyCode[O.toLowerCase()]||0}}const Sd=new KeyCodeStrMap,Cd=new KeyCodeStrMap,Ed=new KeyCodeStrMap,xd=new Array(230),Td={},wd=[],kd=Object.create(null),Ad=Object.create(null),Rd=[],Id=[];for(let O=0;O<=193;O++)Rd[O]=-1;for(let O=0;O<=127;O++)Id[O]=-1;var Pd,Nd,Od;(function(){const O="",B=[[0,1,0,"None",0,"unknown",0,"VK_UNKNOWN",O,O],[0,1,1,"Hyper",0,O,0,O,O,O],[0,1,2,"Super",0,O,0,O,O,O],[0,1,3,"Fn",0,O,0,O,O,O],[0,1,4,"FnLock",0,O,0,O,O,O],[0,1,5,"Suspend",0,O,0,O,O,O],[0,1,6,"Resume",0,O,0,O,O,O],[0,1,7,"Turbo",0,O,0,O,O,O],[0,1,8,"Sleep",0,O,0,"VK_SLEEP",O,O],[0,1,9,"WakeUp",0,O,0,O,O,O],[31,0,10,"KeyA",31,"A",65,"VK_A",O,O],[32,0,11,"KeyB",32,"B",66,"VK_B",O,O],[33,0,12,"KeyC",33,"C",67,"VK_C",O,O],[34,0,13,"KeyD",34,"D",68,"VK_D",O,O],[35,0,14,"KeyE",35,"E",69,"VK_E",O,O],[36,0,15,"KeyF",36,"F",70,"VK_F",O,O],[37,0,16,"KeyG",37,"G",71,"VK_G",O,O],[38,0,17,"KeyH",38,"H",72,"VK_H",O,O],[39,0,18,"KeyI",39,"I",73,"VK_I",O,O],[40,0,19,"KeyJ",40,"J",74,"VK_J",O,O],[41,0,20,"KeyK",41,"K",75,"VK_K",O,O],[42,0,21,"KeyL",42,"L",76,"VK_L",O,O],[43,0,22,"KeyM",43,"M",77,"VK_M",O,O],[44,0,23,"KeyN",44,"N",78,"VK_N",O,O],[45,0,24,"KeyO",45,"O",79,"VK_O",O,O],[46,0,25,"KeyP",46,"P",80,"VK_P",O,O],[47,0,26,"KeyQ",47,"Q",81,"VK_Q",O,O],[48,0,27,"KeyR",48,"R",82,"VK_R",O,O],[49,0,28,"KeyS",49,"S",83,"VK_S",O,O],[50,0,29,"KeyT",50,"T",84,"VK_T",O,O],[51,0,30,"KeyU",51,"U",85,"VK_U",O,O],[52,0,31,"KeyV",52,"V",86,"VK_V",O,O],[53,0,32,"KeyW",53,"W",87,"VK_W",O,O],[54,0,33,"KeyX",54,"X",88,"VK_X",O,O],[55,0,34,"KeyY",55,"Y",89,"VK_Y",O,O],[56,0,35,"KeyZ",56,"Z",90,"VK_Z",O,O],[22,0,36,"Digit1",22,"1",49,"VK_1",O,O],[23,0,37,"Digit2",23,"2",50,"VK_2",O,O],[24,0,38,"Digit3",24,"3",51,"VK_3",O,O],[25,0,39,"Digit4",25,"4",52,"VK_4",O,O],[26,0,40,"Digit5",26,"5",53,"VK_5",O,O],[27,0,41,"Digit6",27,"6",54,"VK_6",O,O],[28,0,42,"Digit7",28,"7",55,"VK_7",O,O],[29,0,43,"Digit8",29,"8",56,"VK_8",O,O],[30,0,44,"Digit9",30,"9",57,"VK_9",O,O],[21,0,45,"Digit0",21,"0",48,"VK_0",O,O],[3,1,46,"Enter",3,"Enter",13,"VK_RETURN",O,O],[9,1,47,"Escape",9,"Escape",27,"VK_ESCAPE",O,O],[1,1,48,"Backspace",1,"Backspace",8,"VK_BACK",O,O],[2,1,49,"Tab",2,"Tab",9,"VK_TAB",O,O],[10,1,50,"Space",10,"Space",32,"VK_SPACE",O,O],[83,0,51,"Minus",83,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[81,0,52,"Equal",81,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[87,0,53,"BracketLeft",87,"[",219,"VK_OEM_4","[","OEM_4"],[89,0,54,"BracketRight",89,"]",221,"VK_OEM_6","]","OEM_6"],[88,0,55,"Backslash",88,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,0,56,"IntlHash",0,O,0,O,O,O],[80,0,57,"Semicolon",80,";",186,"VK_OEM_1",";","OEM_1"],[90,0,58,"Quote",90,"'",222,"VK_OEM_7","'","OEM_7"],[86,0,59,"Backquote",86,"`",192,"VK_OEM_3","`","OEM_3"],[82,0,60,"Comma",82,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[84,0,61,"Period",84,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[85,0,62,"Slash",85,"/",191,"VK_OEM_2","/","OEM_2"],[8,1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",O,O],[59,1,64,"F1",59,"F1",112,"VK_F1",O,O],[60,1,65,"F2",60,"F2",113,"VK_F2",O,O],[61,1,66,"F3",61,"F3",114,"VK_F3",O,O],[62,1,67,"F4",62,"F4",115,"VK_F4",O,O],[63,1,68,"F5",63,"F5",116,"VK_F5",O,O],[64,1,69,"F6",64,"F6",117,"VK_F6",O,O],[65,1,70,"F7",65,"F7",118,"VK_F7",O,O],[66,1,71,"F8",66,"F8",119,"VK_F8",O,O],[67,1,72,"F9",67,"F9",120,"VK_F9",O,O],[68,1,73,"F10",68,"F10",121,"VK_F10",O,O],[69,1,74,"F11",69,"F11",122,"VK_F11",O,O],[70,1,75,"F12",70,"F12",123,"VK_F12",O,O],[0,1,76,"PrintScreen",0,O,0,O,O,O],[79,1,77,"ScrollLock",79,"ScrollLock",145,"VK_SCROLL",O,O],[7,1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",O,O],[19,1,79,"Insert",19,"Insert",45,"VK_INSERT",O,O],[14,1,80,"Home",14,"Home",36,"VK_HOME",O,O],[11,1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",O,O],[20,1,82,"Delete",20,"Delete",46,"VK_DELETE",O,O],[13,1,83,"End",13,"End",35,"VK_END",O,O],[12,1,84,"PageDown",12,"PageDown",34,"VK_NEXT",O,O],[17,1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",O],[15,1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",O],[18,1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",O],[16,1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",O],[78,1,89,"NumLock",78,"NumLock",144,"VK_NUMLOCK",O,O],[108,1,90,"NumpadDivide",108,"NumPad_Divide",111,"VK_DIVIDE",O,O],[103,1,91,"NumpadMultiply",103,"NumPad_Multiply",106,"VK_MULTIPLY",O,O],[106,1,92,"NumpadSubtract",106,"NumPad_Subtract",109,"VK_SUBTRACT",O,O],[104,1,93,"NumpadAdd",104,"NumPad_Add",107,"VK_ADD",O,O],[3,1,94,"NumpadEnter",3,O,0,O,O,O],[94,1,95,"Numpad1",94,"NumPad1",97,"VK_NUMPAD1",O,O],[95,1,96,"Numpad2",95,"NumPad2",98,"VK_NUMPAD2",O,O],[96,1,97,"Numpad3",96,"NumPad3",99,"VK_NUMPAD3",O,O],[97,1,98,"Numpad4",97,"NumPad4",100,"VK_NUMPAD4",O,O],[98,1,99,"Numpad5",98,"NumPad5",101,"VK_NUMPAD5",O,O],[99,1,100,"Numpad6",99,"NumPad6",102,"VK_NUMPAD6",O,O],[100,1,101,"Numpad7",100,"NumPad7",103,"VK_NUMPAD7",O,O],[101,1,102,"Numpad8",101,"NumPad8",104,"VK_NUMPAD8",O,O],[102,1,103,"Numpad9",102,"NumPad9",105,"VK_NUMPAD9",O,O],[93,1,104,"Numpad0",93,"NumPad0",96,"VK_NUMPAD0",O,O],[107,1,105,"NumpadDecimal",107,"NumPad_Decimal",110,"VK_DECIMAL",O,O],[92,0,106,"IntlBackslash",92,"OEM_102",226,"VK_OEM_102",O,O],[58,1,107,"ContextMenu",58,"ContextMenu",93,O,O,O],[0,1,108,"Power",0,O,0,O,O,O],[0,1,109,"NumpadEqual",0,O,0,O,O,O],[71,1,110,"F13",71,"F13",124,"VK_F13",O,O],[72,1,111,"F14",72,"F14",125,"VK_F14",O,O],[73,1,112,"F15",73,"F15",126,"VK_F15",O,O],[74,1,113,"F16",74,"F16",127,"VK_F16",O,O],[75,1,114,"F17",75,"F17",128,"VK_F17",O,O],[76,1,115,"F18",76,"F18",129,"VK_F18",O,O],[77,1,116,"F19",77,"F19",130,"VK_F19",O,O],[0,1,117,"F20",0,O,0,"VK_F20",O,O],[0,1,118,"F21",0,O,0,"VK_F21",O,O],[0,1,119,"F22",0,O,0,"VK_F22",O,O],[0,1,120,"F23",0,O,0,"VK_F23",O,O],[0,1,121,"F24",0,O,0,"VK_F24",O,O],[0,1,122,"Open",0,O,0,O,O,O],[0,1,123,"Help",0,O,0,O,O,O],[0,1,124,"Select",0,O,0,O,O,O],[0,1,125,"Again",0,O,0,O,O,O],[0,1,126,"Undo",0,O,0,O,O,O],[0,1,127,"Cut",0,O,0,O,O,O],[0,1,128,"Copy",0,O,0,O,O,O],[0,1,129,"Paste",0,O,0,O,O,O],[0,1,130,"Find",0,O,0,O,O,O],[0,1,131,"AudioVolumeMute",112,"AudioVolumeMute",173,"VK_VOLUME_MUTE",O,O],[0,1,132,"AudioVolumeUp",113,"AudioVolumeUp",175,"VK_VOLUME_UP",O,O],[0,1,133,"AudioVolumeDown",114,"AudioVolumeDown",174,"VK_VOLUME_DOWN",O,O],[105,1,134,"NumpadComma",105,"NumPad_Separator",108,"VK_SEPARATOR",O,O],[110,0,135,"IntlRo",110,"ABNT_C1",193,"VK_ABNT_C1",O,O],[0,1,136,"KanaMode",0,O,0,O,O,O],[0,0,137,"IntlYen",0,O,0,O,O,O],[0,1,138,"Convert",0,O,0,O,O,O],[0,1,139,"NonConvert",0,O,0,O,O,O],[0,1,140,"Lang1",0,O,0,O,O,O],[0,1,141,"Lang2",0,O,0,O,O,O],[0,1,142,"Lang3",0,O,0,O,O,O],[0,1,143,"Lang4",0,O,0,O,O,O],[0,1,144,"Lang5",0,O,0,O,O,O],[0,1,145,"Abort",0,O,0,O,O,O],[0,1,146,"Props",0,O,0,O,O,O],[0,1,147,"NumpadParenLeft",0,O,0,O,O,O],[0,1,148,"NumpadParenRight",0,O,0,O,O,O],[0,1,149,"NumpadBackspace",0,O,0,O,O,O],[0,1,150,"NumpadMemoryStore",0,O,0,O,O,O],[0,1,151,"NumpadMemoryRecall",0,O,0,O,O,O],[0,1,152,"NumpadMemoryClear",0,O,0,O,O,O],[0,1,153,"NumpadMemoryAdd",0,O,0,O,O,O],[0,1,154,"NumpadMemorySubtract",0,O,0,O,O,O],[0,1,155,"NumpadClear",126,"Clear",12,"VK_CLEAR",O,O],[0,1,156,"NumpadClearEntry",0,O,0,O,O,O],[5,1,0,O,5,"Ctrl",17,"VK_CONTROL",O,O],[4,1,0,O,4,"Shift",16,"VK_SHIFT",O,O],[6,1,0,O,6,"Alt",18,"VK_MENU",O,O],[57,1,0,O,57,"Meta",0,"VK_COMMAND",O,O],[5,1,157,"ControlLeft",5,O,0,"VK_LCONTROL",O,O],[4,1,158,"ShiftLeft",4,O,0,"VK_LSHIFT",O,O],[6,1,159,"AltLeft",6,O,0,"VK_LMENU",O,O],[57,1,160,"MetaLeft",57,O,0,"VK_LWIN",O,O],[5,1,161,"ControlRight",5,O,0,"VK_RCONTROL",O,O],[4,1,162,"ShiftRight",4,O,0,"VK_RSHIFT",O,O],[6,1,163,"AltRight",6,O,0,"VK_RMENU",O,O],[57,1,164,"MetaRight",57,O,0,"VK_RWIN",O,O],[0,1,165,"BrightnessUp",0,O,0,O,O,O],[0,1,166,"BrightnessDown",0,O,0,O,O,O],[0,1,167,"MediaPlay",0,O,0,O,O,O],[0,1,168,"MediaRecord",0,O,0,O,O,O],[0,1,169,"MediaFastForward",0,O,0,O,O,O],[0,1,170,"MediaRewind",0,O,0,O,O,O],[114,1,171,"MediaTrackNext",119,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",O,O],[115,1,172,"MediaTrackPrevious",120,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",O,O],[116,1,173,"MediaStop",121,"MediaStop",178,"VK_MEDIA_STOP",O,O],[0,1,174,"Eject",0,O,0,O,O,O],[117,1,175,"MediaPlayPause",122,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",O,O],[0,1,176,"MediaSelect",123,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",O,O],[0,1,177,"LaunchMail",124,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",O,O],[0,1,178,"LaunchApp2",125,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",O,O],[0,1,179,"LaunchApp1",0,O,0,"VK_MEDIA_LAUNCH_APP1",O,O],[0,1,180,"SelectTask",0,O,0,O,O,O],[0,1,181,"LaunchScreenSaver",0,O,0,O,O,O],[0,1,182,"BrowserSearch",115,"BrowserSearch",170,"VK_BROWSER_SEARCH",O,O],[0,1,183,"BrowserHome",116,"BrowserHome",172,"VK_BROWSER_HOME",O,O],[112,1,184,"BrowserBack",117,"BrowserBack",166,"VK_BROWSER_BACK",O,O],[113,1,185,"BrowserForward",118,"BrowserForward",167,"VK_BROWSER_FORWARD",O,O],[0,1,186,"BrowserStop",0,O,0,"VK_BROWSER_STOP",O,O],[0,1,187,"BrowserRefresh",0,O,0,"VK_BROWSER_REFRESH",O,O],[0,1,188,"BrowserFavorites",0,O,0,"VK_BROWSER_FAVORITES",O,O],[0,1,189,"ZoomToggle",0,O,0,O,O,O],[0,1,190,"MailReply",0,O,0,O,O,O],[0,1,191,"MailForward",0,O,0,O,O,O],[0,1,192,"MailSend",0,O,0,O,O,O],[109,1,0,O,109,"KeyInComposition",229,O,O,O],[111,1,0,O,111,"ABNT_C2",194,"VK_ABNT_C2",O,O],[91,1,0,O,91,"OEM_8",223,"VK_OEM_8",O,O],[0,1,0,O,0,O,0,"VK_KANA",O,O],[0,1,0,O,0,O,0,"VK_HANGUL",O,O],[0,1,0,O,0,O,0,"VK_JUNJA",O,O],[0,1,0,O,0,O,0,"VK_FINAL",O,O],[0,1,0,O,0,O,0,"VK_HANJA",O,O],[0,1,0,O,0,O,0,"VK_KANJI",O,O],[0,1,0,O,0,O,0,"VK_CONVERT",O,O],[0,1,0,O,0,O,0,"VK_NONCONVERT",O,O],[0,1,0,O,0,O,0,"VK_ACCEPT",O,O],[0,1,0,O,0,O,0,"VK_MODECHANGE",O,O],[0,1,0,O,0,O,0,"VK_SELECT",O,O],[0,1,0,O,0,O,0,"VK_PRINT",O,O],[0,1,0,O,0,O,0,"VK_EXECUTE",O,O],[0,1,0,O,0,O,0,"VK_SNAPSHOT",O,O],[0,1,0,O,0,O,0,"VK_HELP",O,O],[0,1,0,O,0,O,0,"VK_APPS",O,O],[0,1,0,O,0,O,0,"VK_PROCESSKEY",O,O],[0,1,0,O,0,O,0,"VK_PACKET",O,O],[0,1,0,O,0,O,0,"VK_DBE_SBCSCHAR",O,O],[0,1,0,O,0,O,0,"VK_DBE_DBCSCHAR",O,O],[0,1,0,O,0,O,0,"VK_ATTN",O,O],[0,1,0,O,0,O,0,"VK_CRSEL",O,O],[0,1,0,O,0,O,0,"VK_EXSEL",O,O],[0,1,0,O,0,O,0,"VK_EREOF",O,O],[0,1,0,O,0,O,0,"VK_PLAY",O,O],[0,1,0,O,0,O,0,"VK_ZOOM",O,O],[0,1,0,O,0,O,0,"VK_NONAME",O,O],[0,1,0,O,0,O,0,"VK_PA1",O,O],[0,1,0,O,0,O,0,"VK_OEM_CLEAR",O,O]],U=[],G=[];for(const O of B){const[B,q,j,W,Y,K,Q,Z,X,J]=O;if(G[j]||(G[j]=!0,wd[j]=W,kd[W]=j,Ad[W.toLowerCase()]=j,q&&(Rd[j]=Y,0!==Y&&3!==Y&&5!==Y&&4!==Y&&6!==Y&&57!==Y&&(Id[Y]=j))),!U[Y]){if(U[Y]=!0,!K)throw new Error(`String representation missing for key code ${Y} around scan code ${W}`);Sd.define(Y,K),Cd.define(Y,X||K),Ed.define(Y,J||X||K)}Q&&(xd[Q]=Y),Z&&(Td[Z]=Y)}Id[3]=46})(),function(O){O.toString=function(O){return Sd.keyCodeToStr(O)},O.fromString=function(O){return Sd.strToKeyCode(O)},O.toUserSettingsUS=function(O){return Cd.keyCodeToStr(O)},O.toUserSettingsGeneral=function(O){return Ed.keyCodeToStr(O)},O.fromUserSettings=function(O){return Cd.strToKeyCode(O)||Ed.strToKeyCode(O)},O.toElectronAccelerator=function(O){if(O>=93&&O<=108)return null;switch(O){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Sd.keyCodeToStr(O)}}(Pd||(Pd={})),function(O){O[O.CtrlCmd=2048]="CtrlCmd",O[O.Shift=1024]="Shift",O[O.Alt=512]="Alt",O[O.WinCtrl=256]="WinCtrl"}(Nd||(Nd={})),function(O){O[O.CtrlCmd=2048]="CtrlCmd",O[O.Shift=1024]="Shift",O[O.Alt=512]="Alt",O[O.WinCtrl=256]="WinCtrl",O[O.KeyCode=255]="KeyCode"}(Od||(Od={}));const Md={get platform(){return fi?"win32":yi?"darwin":"linux"},get arch(){},get env(){return{}},cwd:()=>"/"},Dd=Md.cwd,Ld=Md.env,Bd=Md.platform,Fd=(Md.arch,46),zd=47,$d=92,Ud=58;class ErrorInvalidArgType extends Error{constructor(O,B,U){let G;"string"==typeof B&&0===B.indexOf("not ")?(G="must not be",B=B.replace(/^not /,"")):G="must be";const q=-1!==O.indexOf(".")?"property":"argument";let j=`The "${O}" ${q} ${G} of type ${B}`;j+=". Received type "+typeof U,super(j),this.code="ERR_INVALID_ARG_TYPE"}}function validateString(O,B){if("string"!=typeof O)throw new ErrorInvalidArgType(B,"string",O)}function isPathSeparator(O){return O===zd||O===$d}function isPosixPathSeparator(O){return O===zd}function isWindowsDeviceRoot(O){return O>=65&&O<=90||O>=97&&O<=122}function normalizeString(O,B,U,G){let q="",j=0,W=-1,Y=0,K=0;for(let Q=0;Q<=O.length;++Q){if(Q<O.length)K=O.charCodeAt(Q);else{if(G(K))break;K=zd}if(G(K)){if(W===Q-1||1===Y);else if(2===Y){if(q.length<2||2!==j||q.charCodeAt(q.length-1)!==Fd||q.charCodeAt(q.length-2)!==Fd){if(q.length>2){const O=q.lastIndexOf(U);-1===O?(q="",j=0):(q=q.slice(0,O),j=q.length-1-q.lastIndexOf(U)),W=Q,Y=0;continue}if(0!==q.length){q="",j=0,W=Q,Y=0;continue}}B&&(q+=q.length>0?`${U}..`:"..",j=2)}else q.length>0?q+=`${U}${O.slice(W+1,Q)}`:q=O.slice(W+1,Q),j=Q-W-1;W=Q,Y=0}else K===Fd&&-1!==Y?++Y:Y=-1}return q}function _format(O,B){if(null===B||"object"!=typeof B)throw new ErrorInvalidArgType("pathObject","Object",B);const U=B.dir||B.root,G=B.base||`${B.name||""}${B.ext||""}`;return U?U===B.root?`${U}${G}`:`${U}${O}${G}`:G}const Vd={resolve(...O){let B="",U="",G=!1;for(let q=O.length-1;q>=-1;q--){let j;if(q>=0){if(j=O[q],validateString(j,"path"),0===j.length)continue}else 0===B.length?j=Dd():(j=Ld[`=${B}`]||Dd(),(void 0===j||j.slice(0,2).toLowerCase()!==B.toLowerCase()&&j.charCodeAt(2)===$d)&&(j=`${B}\\`));const W=j.length;let Y=0,K="",Q=!1;const Z=j.charCodeAt(0);if(1===W)isPathSeparator(Z)&&(Y=1,Q=!0);else if(isPathSeparator(Z))if(Q=!0,isPathSeparator(j.charCodeAt(1))){let O=2,B=O;for(;O<W&&!isPathSeparator(j.charCodeAt(O));)O++;if(O<W&&O!==B){const U=j.slice(B,O);for(B=O;O<W&&isPathSeparator(j.charCodeAt(O));)O++;if(O<W&&O!==B){for(B=O;O<W&&!isPathSeparator(j.charCodeAt(O));)O++;O!==W&&O===B||(K=`\\\\${U}\\${j.slice(B,O)}`,Y=O)}}}else Y=1;else isWindowsDeviceRoot(Z)&&j.charCodeAt(1)===Ud&&(K=j.slice(0,2),Y=2,W>2&&isPathSeparator(j.charCodeAt(2))&&(Q=!0,Y=3));if(K.length>0)if(B.length>0){if(K.toLowerCase()!==B.toLowerCase())continue}else B=K;if(G){if(B.length>0)break}else if(U=`${j.slice(Y)}\\${U}`,G=Q,Q&&B.length>0)break}return U=normalizeString(U,!G,"\\",isPathSeparator),G?`${B}\\${U}`:`${B}${U}`||"."},normalize(O){validateString(O,"path");const B=O.length;if(0===B)return".";let U,G=0,q=!1;const j=O.charCodeAt(0);if(1===B)return isPosixPathSeparator(j)?"\\":O;if(isPathSeparator(j))if(q=!0,isPathSeparator(O.charCodeAt(1))){let q=2,j=q;for(;q<B&&!isPathSeparator(O.charCodeAt(q));)q++;if(q<B&&q!==j){const W=O.slice(j,q);for(j=q;q<B&&isPathSeparator(O.charCodeAt(q));)q++;if(q<B&&q!==j){for(j=q;q<B&&!isPathSeparator(O.charCodeAt(q));)q++;if(q===B)return`\\\\${W}\\${O.slice(j)}\\`;q!==j&&(U=`\\\\${W}\\${O.slice(j,q)}`,G=q)}}}else G=1;else isWindowsDeviceRoot(j)&&O.charCodeAt(1)===Ud&&(U=O.slice(0,2),G=2,B>2&&isPathSeparator(O.charCodeAt(2))&&(q=!0,G=3));let W=G<B?normalizeString(O.slice(G),!q,"\\",isPathSeparator):"";return 0!==W.length||q||(W="."),W.length>0&&isPathSeparator(O.charCodeAt(B-1))&&(W+="\\"),void 0===U?q?`\\${W}`:W:q?`${U}\\${W}`:`${U}${W}`},isAbsolute(O){validateString(O,"path");const B=O.length;if(0===B)return!1;const U=O.charCodeAt(0);return isPathSeparator(U)||B>2&&isWindowsDeviceRoot(U)&&O.charCodeAt(1)===Ud&&isPathSeparator(O.charCodeAt(2))},join(...O){if(0===O.length)return".";let B,U;for(let G=0;G<O.length;++G){const q=O[G];validateString(q,"path"),q.length>0&&(void 0===B?B=U=q:B+=`\\${q}`)}if(void 0===B)return".";let G=!0,q=0;if("string"==typeof U&&isPathSeparator(U.charCodeAt(0))){++q;const O=U.length;O>1&&isPathSeparator(U.charCodeAt(1))&&(++q,O>2&&(isPathSeparator(U.charCodeAt(2))?++q:G=!1))}if(G){for(;q<B.length&&isPathSeparator(B.charCodeAt(q));)q++;q>=2&&(B=`\\${B.slice(q)}`)}return Vd.normalize(B)},relative(O,B){if(validateString(O,"from"),validateString(B,"to"),O===B)return"";const U=Vd.resolve(O),G=Vd.resolve(B);if(U===G)return"";if((O=U.toLowerCase())===(B=G.toLowerCase()))return"";let q=0;for(;q<O.length&&O.charCodeAt(q)===$d;)q++;let j=O.length;for(;j-1>q&&O.charCodeAt(j-1)===$d;)j--;const W=j-q;let Y=0;for(;Y<B.length&&B.charCodeAt(Y)===$d;)Y++;let K=B.length;for(;K-1>Y&&B.charCodeAt(K-1)===$d;)K--;const Q=K-Y,Z=W<Q?W:Q;let X=-1,J=0;for(;J<Z;J++){const U=O.charCodeAt(q+J);if(U!==B.charCodeAt(Y+J))break;U===$d&&(X=J)}if(J!==Z){if(-1===X)return G}else{if(Q>Z){if(B.charCodeAt(Y+J)===$d)return G.slice(Y+J+1);if(2===J)return G.slice(Y+J)}W>Z&&(O.charCodeAt(q+J)===$d?X=J:2===J&&(X=3)),-1===X&&(X=0)}let ee="";for(J=q+X+1;J<=j;++J)J!==j&&O.charCodeAt(J)!==$d||(ee+=0===ee.length?"..":"\\..");return Y+=X,ee.length>0?`${ee}${G.slice(Y,K)}`:(G.charCodeAt(Y)===$d&&++Y,G.slice(Y,K))},toNamespacedPath(O){if("string"!=typeof O)return O;if(0===O.length)return"";const B=Vd.resolve(O);if(B.length<=2)return O;if(B.charCodeAt(0)===$d){if(B.charCodeAt(1)===$d){const O=B.charCodeAt(2);if(63!==O&&O!==Fd)return`\\\\?\\UNC\\${B.slice(2)}`}}else if(isWindowsDeviceRoot(B.charCodeAt(0))&&B.charCodeAt(1)===Ud&&B.charCodeAt(2)===$d)return`\\\\?\\${B}`;return O},dirname(O){validateString(O,"path");const B=O.length;if(0===B)return".";let U=-1,G=0;const q=O.charCodeAt(0);if(1===B)return isPathSeparator(q)?O:".";if(isPathSeparator(q)){if(U=G=1,isPathSeparator(O.charCodeAt(1))){let q=2,j=q;for(;q<B&&!isPathSeparator(O.charCodeAt(q));)q++;if(q<B&&q!==j){for(j=q;q<B&&isPathSeparator(O.charCodeAt(q));)q++;if(q<B&&q!==j){for(j=q;q<B&&!isPathSeparator(O.charCodeAt(q));)q++;if(q===B)return O;q!==j&&(U=G=q+1)}}}}else isWindowsDeviceRoot(q)&&O.charCodeAt(1)===Ud&&(U=B>2&&isPathSeparator(O.charCodeAt(2))?3:2,G=U);let j=-1,W=!0;for(let U=B-1;U>=G;--U)if(isPathSeparator(O.charCodeAt(U))){if(!W){j=U;break}}else W=!1;if(-1===j){if(-1===U)return".";j=U}return O.slice(0,j)},basename(O,B){void 0!==B&&validateString(B,"ext"),validateString(O,"path");let U,G=0,q=-1,j=!0;if(O.length>=2&&isWindowsDeviceRoot(O.charCodeAt(0))&&O.charCodeAt(1)===Ud&&(G=2),void 0!==B&&B.length>0&&B.length<=O.length){if(B===O)return"";let W=B.length-1,Y=-1;for(U=O.length-1;U>=G;--U){const K=O.charCodeAt(U);if(isPathSeparator(K)){if(!j){G=U+1;break}}else-1===Y&&(j=!1,Y=U+1),W>=0&&(K===B.charCodeAt(W)?-1==--W&&(q=U):(W=-1,q=Y))}return G===q?q=Y:-1===q&&(q=O.length),O.slice(G,q)}for(U=O.length-1;U>=G;--U)if(isPathSeparator(O.charCodeAt(U))){if(!j){G=U+1;break}}else-1===q&&(j=!1,q=U+1);return-1===q?"":O.slice(G,q)},extname(O){validateString(O,"path");let B=0,U=-1,G=0,q=-1,j=!0,W=0;O.length>=2&&O.charCodeAt(1)===Ud&&isWindowsDeviceRoot(O.charCodeAt(0))&&(B=G=2);for(let Y=O.length-1;Y>=B;--Y){const B=O.charCodeAt(Y);if(isPathSeparator(B)){if(!j){G=Y+1;break}}else-1===q&&(j=!1,q=Y+1),B===Fd?-1===U?U=Y:1!==W&&(W=1):-1!==U&&(W=-1)}return-1===U||-1===q||0===W||1===W&&U===q-1&&U===G+1?"":O.slice(U,q)},format:_format.bind(null,"\\"),parse(O){validateString(O,"path");const B={root:"",dir:"",base:"",ext:"",name:""};if(0===O.length)return B;const U=O.length;let G=0,q=O.charCodeAt(0);if(1===U)return isPathSeparator(q)?(B.root=B.dir=O,B):(B.base=B.name=O,B);if(isPathSeparator(q)){if(G=1,isPathSeparator(O.charCodeAt(1))){let B=2,q=B;for(;B<U&&!isPathSeparator(O.charCodeAt(B));)B++;if(B<U&&B!==q){for(q=B;B<U&&isPathSeparator(O.charCodeAt(B));)B++;if(B<U&&B!==q){for(q=B;B<U&&!isPathSeparator(O.charCodeAt(B));)B++;B===U?G=B:B!==q&&(G=B+1)}}}}else if(isWindowsDeviceRoot(q)&&O.charCodeAt(1)===Ud){if(U<=2)return B.root=B.dir=O,B;if(G=2,isPathSeparator(O.charCodeAt(2))){if(3===U)return B.root=B.dir=O,B;G=3}}G>0&&(B.root=O.slice(0,G));let j=-1,W=G,Y=-1,K=!0,Q=O.length-1,Z=0;for(;Q>=G;--Q)if(q=O.charCodeAt(Q),isPathSeparator(q)){if(!K){W=Q+1;break}}else-1===Y&&(K=!1,Y=Q+1),q===Fd?-1===j?j=Q:1!==Z&&(Z=1):-1!==j&&(Z=-1);return-1!==Y&&(-1===j||0===Z||1===Z&&j===Y-1&&j===W+1?B.base=B.name=O.slice(W,Y):(B.name=O.slice(W,j),B.base=O.slice(W,Y),B.ext=O.slice(j,Y))),B.dir=W>0&&W!==G?O.slice(0,W-1):B.root,B},sep:"\\",delimiter:";",win32:null,posix:null},Gd={resolve(...O){let B="",U=!1;for(let G=O.length-1;G>=-1&&!U;G--){const q=G>=0?O[G]:Dd();validateString(q,"path"),0!==q.length&&(B=`${q}/${B}`,U=q.charCodeAt(0)===zd)}return B=normalizeString(B,!U,"/",isPosixPathSeparator),U?`/${B}`:B.length>0?B:"."},normalize(O){if(validateString(O,"path"),0===O.length)return".";const B=O.charCodeAt(0)===zd,U=O.charCodeAt(O.length-1)===zd;return 0===(O=normalizeString(O,!B,"/",isPosixPathSeparator)).length?B?"/":U?"./":".":(U&&(O+="/"),B?`/${O}`:O)},isAbsolute:O=>(validateString(O,"path"),O.length>0&&O.charCodeAt(0)===zd),join(...O){if(0===O.length)return".";let B;for(let U=0;U<O.length;++U){const G=O[U];validateString(G,"path"),G.length>0&&(void 0===B?B=G:B+=`/${G}`)}return void 0===B?".":Gd.normalize(B)},relative(O,B){if(validateString(O,"from"),validateString(B,"to"),O===B)return"";if((O=Gd.resolve(O))===(B=Gd.resolve(B)))return"";const U=O.length,G=U-1,q=B.length-1,j=G<q?G:q;let W=-1,Y=0;for(;Y<j;Y++){const U=O.charCodeAt(1+Y);if(U!==B.charCodeAt(1+Y))break;U===zd&&(W=Y)}if(Y===j)if(q>j){if(B.charCodeAt(1+Y)===zd)return B.slice(1+Y+1);if(0===Y)return B.slice(1+Y)}else G>j&&(O.charCodeAt(1+Y)===zd?W=Y:0===Y&&(W=0));let K="";for(Y=1+W+1;Y<=U;++Y)Y!==U&&O.charCodeAt(Y)!==zd||(K+=0===K.length?"..":"/..");return`${K}${B.slice(1+W)}`},toNamespacedPath:O=>O,dirname(O){if(validateString(O,"path"),0===O.length)return".";const B=O.charCodeAt(0)===zd;let U=-1,G=!0;for(let B=O.length-1;B>=1;--B)if(O.charCodeAt(B)===zd){if(!G){U=B;break}}else G=!1;return-1===U?B?"/":".":B&&1===U?"//":O.slice(0,U)},basename(O,B){void 0!==B&&validateString(B,"ext"),validateString(O,"path");let U,G=0,q=-1,j=!0;if(void 0!==B&&B.length>0&&B.length<=O.length){if(B===O)return"";let W=B.length-1,Y=-1;for(U=O.length-1;U>=0;--U){const K=O.charCodeAt(U);if(K===zd){if(!j){G=U+1;break}}else-1===Y&&(j=!1,Y=U+1),W>=0&&(K===B.charCodeAt(W)?-1==--W&&(q=U):(W=-1,q=Y))}return G===q?q=Y:-1===q&&(q=O.length),O.slice(G,q)}for(U=O.length-1;U>=0;--U)if(O.charCodeAt(U)===zd){if(!j){G=U+1;break}}else-1===q&&(j=!1,q=U+1);return-1===q?"":O.slice(G,q)},extname(O){validateString(O,"path");let B=-1,U=0,G=-1,q=!0,j=0;for(let W=O.length-1;W>=0;--W){const Y=O.charCodeAt(W);if(Y!==zd)-1===G&&(q=!1,G=W+1),Y===Fd?-1===B?B=W:1!==j&&(j=1):-1!==B&&(j=-1);else if(!q){U=W+1;break}}return-1===B||-1===G||0===j||1===j&&B===G-1&&B===U+1?"":O.slice(B,G)},format:_format.bind(null,"/"),parse(O){validateString(O,"path");const B={root:"",dir:"",base:"",ext:"",name:""};if(0===O.length)return B;const U=O.charCodeAt(0)===zd;let G;U?(B.root="/",G=1):G=0;let q=-1,j=0,W=-1,Y=!0,K=O.length-1,Q=0;for(;K>=G;--K){const B=O.charCodeAt(K);if(B!==zd)-1===W&&(Y=!1,W=K+1),B===Fd?-1===q?q=K:1!==Q&&(Q=1):-1!==q&&(Q=-1);else if(!Y){j=K+1;break}}if(-1!==W){const G=0===j&&U?1:j;-1===q||0===Q||1===Q&&q===W-1&&q===j+1?B.base=B.name=O.slice(G,W):(B.name=O.slice(G,q),B.base=O.slice(G,W),B.ext=O.slice(q,W))}return j>0?B.dir=O.slice(0,j-1):U&&(B.dir="/"),B},sep:"/",delimiter:":",win32:null,posix:null};Gd.win32=Vd.win32=Vd,Gd.posix=Vd.posix=Gd;"win32"===Bd?Vd.normalize:Gd.normalize,"win32"===Bd?Vd.isAbsolute:Gd.isAbsolute,"win32"===Bd?Vd.join:Gd.join,"win32"===Bd?Vd.resolve:Gd.resolve,"win32"===Bd?Vd.relative:Gd.relative,"win32"===Bd?Vd.dirname:Gd.dirname,"win32"===Bd?Vd.basename:Gd.basename,"win32"===Bd?Vd.extname:Gd.extname,"win32"===Bd?Vd.format:Gd.format,"win32"===Bd?Vd.parse:Gd.parse,"win32"===Bd?Vd.toNamespacedPath:Gd.toNamespacedPath,"win32"===Bd?Vd.sep:Gd.sep,"win32"===Bd?Vd.delimiter:Gd.delimiter;var Hd;(function(O){O.http="http",O.https="https",O.data="data",O.command="command"})(Hd||(Hd={}));class DomListener{constructor(O,B,U,G){this._node=O,this._type=B,this._handler=U,this._options=G||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function addDisposableListener(O,B,U,G){return new DomListener(O,B,U,G)}let qd,jd;class AnimationFrameQueueItem{constructor(O,B=0){this._runner=O,this.priority=B,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(O){errors_onUnexpectedError(O)}}static sort(O,B){return B.priority-O.priority}}(function(){let O=[],B=null,U=!1,G=!1;const animationFrameRunner=()=>{for(U=!1,B=O,O=[],G=!0;B.length>0;){B.sort(AnimationFrameQueueItem.sort);B.shift().execute()}G=!1};jd=(B,G=0)=>{const q=new AnimationFrameQueueItem(B,G);return O.push(q),U||(U=!0,requestAnimationFrame(animationFrameRunner)),q},qd=(O,U)=>{if(G){const G=new AnimationFrameQueueItem(O,U);return B.push(G),G}return jd(O,U)}})();class Dimension{constructor(O,B){this.width=O,this.height=B}with(O=this.width,B=this.height){return O!==this.width||B!==this.height?new Dimension(O,B):this}static is(O){return"object"==typeof O&&"number"==typeof O.height&&"number"==typeof O.width}static lift(O){return O instanceof Dimension?O:new Dimension(O.width,O.height)}static equals(O,B){return O===B||!(!O||!B)&&(O.width===B.width&&O.height===B.height)}}Dimension.None=new Dimension(0,0);function findElementsInShadowRoot(O,B){const U=[],G=new Set,q=B.querySelector(O);q&&!G.has(q)&&(U.push(q),G.add(q));const j=Array.from(B.children);B instanceof Element&&B.shadowRoot&&j.push(B.shadowRoot);for(const B of j){const q=findElementsInShadowRoot(O,B);for(const O of q)G.has(O)||(U.push(O),G.add(O))}return U}var Wd;(function(O){O.HTML="http://www.w3.org/1999/xhtml",O.SVG="http://www.w3.org/2000/svg"})(Wd||(Wd={}));var Yd;(function(O){O[O.DOCUMENT=1]="DOCUMENT",O[O.BROWSER=2]="BROWSER"})(Yd||(Yd={}));Hd.http,Hd.https,Hd.command,Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});const Kd=kt.createInterface("IChatStreamHandler");var Qd;(function(O){O[O.Text=0]="Text",O[O.Speech=1]="Speech"})(Qd||(Qd={}));class PhasedDelayRetryPolicyBase{constructor(O){this.log=O}nextRetryDelayInMilliseconds(O){var B;let U=null;const{previousRetryCount:G}=O;let q=0;for(let O=0;O<this.phaseAttempts.length;O++)if(q+=this.phaseAttempts[O],G<q){U=this.phaseDelays[O];break}return null===(B=this.log)||void 0===B||B.trace(this,this.nextRetryDelayInMilliseconds,`context: ${JSON.stringify(O)}; delay: '${U}'`).write(),U}}class ChatStreamConnectionRetryPolicy extends PhasedDelayRetryPolicyBase{constructor(){super(...arguments),this.phaseAttempts=[4,4,4,8,4,2,3e3],this.phaseDelays=[20,250,1e3,2e3,5e3,1e4,2e4]}}class ChatStreamResultRetryPolicy{constructor(O,B){this.config=O,this.log=B}nextRetryDelayInMilliseconds(O){var B,U;if(!(O.retryReason instanceof ChatStreamResultError))return null;const{result:G}=O.retryReason,{previousRetryCount:q}=O;if(q>=(null!==(B=this.config.sydney.retryConfigs[G])&&void 0!==B?B:this.config.sydney.retryConfigs.defaultRetryCount))return null;let j;switch(G){case Wi.InternalError:j=0;break;case Wi.InvalidSession:j=this.config.features.enableAutoRecoverFromInvalidSession?0:null;break;case Wi.InvalidRequest:j=0;break;default:j=null}return null===(U=this.log)||void 0===U||U.trace(this,this.nextRetryDelayInMilliseconds,`context: ${JSON.stringify(O)}; delay: '${j}'`).write(),j}}const Zd=kt.createInterface("ISystemEventBus");var Xd;(function(O){O[O.InvalidSessionRecovered=0]="InvalidSessionRecovered",O[O.ResponseToneChanged=1]="ResponseToneChanged",O[O.CreateUpdateThread=2]="CreateUpdateThread"})(Xd||(Xd={}));const Jd=kt.createInterface();var ep,tp,ip,rp,np,op,ap,sp,lp,cp,dp;(function(O){O[O.Idle=0]="Idle",O[O.PendingRequest=1]="PendingRequest",O[O.PendingResponse=2]="PendingResponse",O[O.Canceling=3]="Canceling"})(cp||(cp={})),function(O){O[O.Idle=0]="Idle",O[O.ProcessingResponse=1]="ProcessingResponse",O[O.ProcessingMessages=2]="ProcessingMessages",O[O.GeneratingStream=3]="GeneratingStream"}(dp||(dp={}));let pp=class extends lifecycle_Disposable{constructor(O,B,U,G,q,j,W,Y,K,Q,Z,X,J){var ee;super(),this.config=O,this.conversation=B,this.captcha=U,this.stream=G,this.speech=q,this.api=j,this.errorState=W,this.eventBus=Y,this.telemetry=K,this.networkError=Q,this.perfTracker=Z,this.hookProvider=X,this.log=J,ep.set(this,!1),tp.set(this,this._register(new lifecycle_MutableDisposable)),this.requestState=cp.Idle,this.responseState=dp.Idle,ip.set(this,this._register(new Emitter)),rp.set(this,this._register(new Emitter)),this.isRequestPending=!1,this.messageHandlerDisposer=lifecycle_Disposable.None,np.set(this,this._register(new Emitter)),op.set(this,this._register(new Emitter)),ap.set(this,this._register(new Emitter)),sp.set(this,this._register(new Emitter)),lp.set(this,this._register(new Emitter)),this.connectionRetryPolicy=new ChatStreamConnectionRetryPolicy(this.log),this.resultRetryPolicy=new ChatStreamResultRetryPolicy(this.config,this.log),this.useStreaming=!0,this.retryCount=0,this.requestToken=new DeferredPromise,this.cfCaptchaToken=new DeferredPromise,this.handleWindowMessage=O=>{"verificationComplete"===O.data&&(this.messageHandlerDisposer.dispose(),this.cfCaptchaToken.complete())},this.bufferDelayer=this._register(new Delayer(this.config.messaging.messageBufferWorkerDefaultDelayMS)),this.handleMessageBufferDrained=()=>{var O,B;(null===(O=__classPrivateFieldGet(this,tp,"f").value)||void 0===O?void 0:O.token.isCancellationRequested)&&(null===(B=this.log)||void 0===B||B.trace(this,this.handleMessageBufferDrained,"Request cancelled.").write(),__classPrivateFieldGet(this,tp,"f").clear())},this.messageBuffer=this.createMessageBuffer(),this.handleConversationReset=()=>{var O;null===(O=this.log)||void 0===O||O.trace(this,this.handleConversationReset,null).write(),__classPrivateFieldSet(this,ep,!1,"f")},this.handleStreamBegin=()=>{this.isRequestPending||this.initializeRequestState(),__classPrivateFieldSet(this,ep,!0,"f")},this.handleStreamUpdate=O=>{O.type=ji.GetMessagesResponse,this.responseState===dp.Idle&&(this.responseState=dp.ProcessingResponse),this.processResponse(O)},this.handleStreamResponse=O=>{var B;try{O.type=ji.ChatResponse,this.responseState=dp.ProcessingResponse,this.processResponse(O)}catch(O){throw null===(B=this.log)||void 0===B||B.error(this,this.handleStreamResponse,"error:",O).write(),this.resetResponseState(),O}},this.handleTextStreamComplete=()=>{this.hookProvider.fireOnChatTurnCompleted(),__classPrivateFieldGet(this,op,"f").fire(Qd.Text)},this.handleSpeechStreamComplete=()=>{__classPrivateFieldGet(this,op,"f").fire(Qd.Speech)},this.handleSystemEvent=O=>{if(O.type===Xd.ResponseToneChanged)this.tone=O.data},null===(ee=this.log)||void 0===ee||ee.trace(this,"ctor",null).write(),this.attachStreamEventListeners(),this._register(this.eventBus.onSystemEvent(this.handleSystemEvent))}requestStateChanged(O,B){var U;null===(U=this.log)||void 0===U||U.trace(this,this.requestStateChanged,`${cp[this.requestState]} -> ${cp[B]}`).write()}responseStateChanged(O,B){var U;null===(U=this.log)||void 0===U||U.trace(this,this.responseStateChanged,`${dp[this.responseState]} -> ${dp[B]}`).write()}get onPendingRequestStateChanged(){return __classPrivateFieldGet(this,ip,"f").event}get onPendingRequestCanceled(){return __classPrivateFieldGet(this,rp,"f").event}isRequestPendingChanged(O,B){this.speech.handlePendingRequestStateChanged(B),(this.config.features.enableMaxTurnsPerConversation||this.config.features.enableMaxTurnsPerConversationWithoutTurnCounter)&&!1===B&&this.checkMaxMessageLimit(),__classPrivateFieldGet(this,ip,"f").fire(B)}registerContext(O){var B;if(null==O?void 0:O.length){if(null===(B=this.pendingContext)||void 0===B?void 0:B.length)for(const B of O)B.messageType!==tr.Ads&&this.pendingContext.push(B);else this.pendingContext=O;this.conversation.isExpired||this.conversation.state!==Lc.Active||queueMicrotask((async()=>await this.tryApplyPendingContextAsync()))}}async tryApplyPendingContextAsync(){const O=this.getPendingContext(!0);O&&await this.updateConversationAsync(O)}getPendingContext(O){let B;return this.pendingContext&&(B=this.pendingContext,O&&(this.pendingContext=void 0)),B}async updateConversationAsync(O){var B,U,G;if(this.config.bingAtWork.isEnabled)return;null===(B=this.log)||void 0===B||B.trace(this,this.updateConversationAsync,`sending ${O.length} messages`).write();let q,j=null;const W=this.genTraceId();try{const{baseUrl:B,pathBase:G,pathUpdateConversation:W,request:Y}=this.config.sydney;j=new URL(`${B}${G}${W}`);const K={messages:O,conversationId:this.conversation.id,source:Y.source,traceId:this.genTraceId()};this.config.features.enableSecureUpdateConversation&&(K.participant={id:this.conversation.clientId},K.conversationSignature=this.conversation.hashedSignature);const replacer=(O,B)=>"onPropertyChanged"===O?null:B,Q={headers:[["Content-Type","application/json"]],method:"POST",body:JSON.stringify(K,replacer)};if(j&&(q=await fetch(j,Q)),!q||!q.ok)throw new Error("Update conversation failed.");null===(U=this.log)||void 0===U||U.trace(this,this.updateConversationAsync,"success").write(),this.errorState.setChatErrorState(),this.errorState.setAppErrorState()}catch(O){const B=O instanceof Error?O:"Conversation update failed.";throw this.networkError.trackNetworkErrorEvent(void 0,q,O,{requestUrl:null==j?void 0:j.href,traceId:W,convId:this.conversation.id}),this.config.partner.enableSilentUpdateConversationFail||this.errorState.setChatErrorState(Gc.NetworkFailure,{response:q,error:O}),null===(G=this.log)||void 0===G||G.error(this,"updateConversationAsync",B).write(),O}}get onMessage(){return __classPrivateFieldGet(this,np,"f").event}get onStreamingComplete(){return __classPrivateFieldGet(this,op,"f").event}get onConversationExpired(){return __classPrivateFieldGet(this,ap,"f").event}get onRequestGenerated(){return __classPrivateFieldGet(this,sp,"f").event}get onLoadConversationInvoked(){return __classPrivateFieldGet(this,lp,"f").event}cancelPendingRequest(){var O,B;null===(O=this.log)||void 0===O||O.trace(this,this.cancelPendingRequest,null).write(),null===(B=__classPrivateFieldGet(this,tp,"f").value)||void 0===B||B.cancel(),[cp.PendingRequest,cp.PendingResponse].includes(this.requestState)&&(this.responseState!==dp.Idle&&(this.requestToken.complete(),this.resetResponseState()),this.requestState=cp.Canceling),this.responseState!==dp.Idle&&this.resetResponseState(),__classPrivateFieldGet(this,rp,"f").fire()}clearPendingContext(){this.getPendingContext(!0)}submitMessage(O,B){this.initializeRequest(O,void 0,B)}submitSearchQuery(O){if(1!==this.conversation.messages.length)throw new Error("IChatService.submitSearchQuery can only be called as the first message of conversation.");this.initializeRequest(O,tr.SearchQuery)}initializeRequest(O,B,U){this.requestState!==cp.Idle||this.errorState.isChatDisabled()||(this.requestState=cp.PendingRequest,this.initializeRequestState(),this.conversation.setPending(),this.processRequestAsync(O,B,U))}initializeRequestState(){this.isRequestPending=!0,__classPrivateFieldGet(this,tp,"f").value=new cancellation_CancellationTokenSource}resetResponseState(){this.isRequestPending=!1,this.responseState=dp.Idle}clearErrorStates(){var O;this.errorState.isChatDisabled()&&(null===(O=this.log)||void 0===O||O.info(this,this.clearErrorStates,"Clearing app/chat error state.").write(),this.errorState.setChatErrorState(),this.errorState.setAppErrorState(),this.errorState.setChatWarningState())}async processRequestAsync(O,B,U){var G;let q;try{this.requestToken=new DeferredPromise,this.retryCount=0,q=await this.createChatRequestAsync(O,U,void 0,B),this.requestState=cp.PendingResponse,this.clearErrorStates(),this.useStreaming?this.requestStreamedResponseAsync(q):this.requestBatchedResponseAsync(q),await this.requestToken.p,this.clearErrorStates()}catch(O){this.clearErrorStates();const U=ensureErrorInstance(O),j=ErrorUtils_getErrorMessage(U);null===(G=this.log)||void 0===G||G.error(this,this.processRequestAsync,"Request failed:",j).write(),this.networkError.trackNetworkErrorEvent(q,void 0,U,{messageObject:JSON.stringify({text:j,messageType:B}),requestbody:U instanceof ChatStreamResultError&&U.result===Wi.InvalidSession?JSON.stringify(q):""});let W=!1,Y=null;if(U instanceof ChatStreamResultError)switch(U.result){case Wi.Throttled:Y=this.config.features.enableMUIDUserMode?Gc.ConversationLimitForMuidUsers:Gc.DailyLimit;break;case Wi.InternalError:W=!0,Y=Gc.MessageError;break;case Wi.UnauthorizedRequest:case Wi.InvalidSession:this.conversation.resetState(),Y=Gc.Unauthorized;break;case Wi.InvalidRequest:default:Y=Gc.Generic}else if(U instanceof ChatStreamTransportError)W=!0,Y=Gc.LostConnection;else if(U instanceof ChatStreamConnectionError)Y=Gc.Generic;else if(U instanceof CreateConversationError)if(U.cause instanceof CreateConversationNoContentError)Y=Gc.NetworkSettings;else switch(U.result){case lr.UnauthorizedRequest:Y=Gc.Unauthorized;break;case lr.Forbidden:Y=Gc.Forbidden;break;case lr.TooManyRequests:Y=Gc.TooManyRequests;break;case lr.CaptchaChallenge:Y=Gc.CaptchaChallenge;break;default:Y=Gc.Generic}else Y=Gc.Generic;W&&this.conversation.removeCurrentTurnBotMessages(),this.errorState.setChatErrorState(Y,{request:q,error:U}),this.resetResponseState()}finally{this.requestState===cp.Canceling&&this.responseState===dp.Idle&&this.resetResponseState(),this.requestState=cp.Idle}}async requestStreamedResponseAsync(O){var B,U,G;try{if(null===(B=__classPrivateFieldGet(this,tp,"f").value)||void 0===B?void 0:B.token.isCancellationRequested)return void this.requestToken.cancel();await this.stream.handleStreamEventsAsync(O,null===(U=__classPrivateFieldGet(this,tp,"f").value)||void 0===U?void 0:U.token),this.requestToken.complete(),this.telemetry.trackEvent("SystemEvent","ChatApiPerf",{Namespace:"Conversation",CustomData:JSON.stringify({attempt:this.retryCount,payload:"suc",convId:null==O?void 0:O.conversationId,rid:null==O?void 0:O.requestId})})}catch(B){const U=ensureErrorInstance(B);let q=null;if(U instanceof ChatStreamResultError)if(U.result===Wi.CaptchaChallenge)if(this.config.features.enableCloudflareCaptcha)this.errorState.setChatErrorState(Gc.CaptchaChallenge),await this.postCloudflareCaptchaMessageAsync(),this.errorState.setChatErrorState(),q=0;else{this.telemetry.trackEvent("SystemEvent","CaptchaChallenged");await this.captcha.getCaptchaChallengeResultAsync()?q=0:this.cancelPendingRequest()}else{const B=this.createRetryContext(U);q=this.resultRetryPolicy.nextRetryDelayInMilliseconds(B),null!==q&&U.result===Wi.InvalidSession&&(await this.tryReauthenticateRequest(O)||(q=null)),this.shouldInlineConversationReset(U,q)&&(await this.tryReauthenticateRequest(O)||(q=null))}else if(U instanceof ChatStreamConnectionError){const B=this.createRetryContext(U);q=this.connectionRetryPolicy.nextRetryDelayInMilliseconds(B),null!==q&&this.errorState.setChatErrorState(Gc.AttemptingToReconnect,{request:O,error:U})}else U instanceof ChatStreamTransportError||this.retryCount<=4&&(q=0);this.telemetry.trackEvent("SystemEvent","ChatApiPerf",{Namespace:"Conversation",CustomData:JSON.stringify({attempt:this.retryCount,lastAttempt:null===q,payload:String(U).slice(0,128),convId:null==O?void 0:O.conversationId,rid:null==O?void 0:O.requestId})}),this.networkError.trackNetworkErrorEvent(O,void 0,U,{messageObject:JSON.stringify(O.message),requestbody:U instanceof ChatStreamResultError&&U.result===Wi.InvalidSession?JSON.stringify(O):"",retryCount:this.retryCount.toString(),maxRetryExceeded:U instanceof ChatStreamResultError&&U.result===Wi.InvalidSession?(null===q).toString():""}),null===q?this.requestToken.error(U):(null===(G=__classPrivateFieldGet(this,tp,"f").value)||void 0===G?void 0:G.token.isCancellationRequested)?this.requestToken.cancel():(this.retryCount++,setTimeout((()=>{this.requestStreamedResponseAsync(O)}),q))}}shouldInlineConversationReset(O,B){return!!this.config.partner.enableInlineConversationRetry&&(O instanceof ChatStreamResultError&&null!==B&&O.result===Wi.InvalidRequest)}async postCloudflareCaptchaMessageAsync(){this.messageHandlerDisposer=addDisposableListener(window,"message",this.handleWindowMessage);const O={messages:[{text:"",author:"bot",messageType:"CaptchaChallenge"}]};return O.type=ji.CaptchaResponse,this.cfCaptchaToken=new DeferredPromise,this.loadCachedResponse(O),this.telemetry.trackEvent("SystemEvent","CaptchaServed"),await this.cfCaptchaToken.p}async tryReauthenticateRequest(O){let B;try{this.conversation.resetState(),this.conversation.removeCurrentTurnBotMessages(),O.isStartOfSession=!0,this.conversation.setPending(),this.config.features.secureConversation&&await this.secureConversationAsync(O),this.updateRequestConversationId(O),this.eventBus.sendSystemEvent(Xd.InvalidSessionRecovered),__classPrivateFieldGet(this,ap,"f").fire(),B=!0}catch(O){B=!1}return B}updateRequestConversationId(O){O.conversationId=this.conversation.id}createRetryContext(O){return{previousRetryCount:this.retryCount,retryReason:O}}async showTestCaptchaAsync(){return await this.captcha.getCaptchaChallengeResultAsync()}async requestBatchedResponseAsync(O){var B;try{const B=await this.api.sydney.chat.post(O);B.type=ji.ChatResponse,this.responseState=dp.ProcessingResponse,this.processResponse(B)}catch(O){throw null===(B=this.log)||void 0===B||B.error(this,this.requestBatchedResponseAsync,"error:",O).write(),this.resetResponseState(),O}}handleDeleteMessageUpdate(O){const{messageIdsToDelete:B}=O;B&&Array.isArray(B)&&B.length&&B.forEach((O=>{this.conversation.removeMessageById(O)}))}processResponse(O){var B,U,G,q,j,W;O.type!==ji.GetMessagesResponse&&(null===(B=this.log)||void 0===B||B.trace(this,this.processResponse,"response:",O).write());try{this.validateResponse(O),this.checkFateUserMessage(O)}catch(B){return void(null===(U=this.log)||void 0===U||U.error(this,this.processResponse,"response validation failed:",O,B).write())}const Y=function(O){return"string"==typeof O.requestId}(O)?O.requestId:this.genLocalIdentifier();if(this.perfTracker.botRequestId=Y,this.config.features.enableDeleteMessageUpdate&&this.isDeleteMessageUpdate(O)&&this.handleDeleteMessageUpdate(O),null===(G=O.messages)||void 0===G?void 0:G.length){const{messages:B}=O,U=function(O){return"number"==typeof O.firstNewMessageIndex}(O)?O.firstNewMessageIndex:0,G=B.length-U;for(let K=U;K<B.length;K++){this.responseState=dp.ProcessingMessages;const U=B[K];if(null!==(q=U.messageId)&&void 0!==q||(U.messageId=this.genLocalIdentifier()),null!==(j=U.requestId)&&void 0!==j||(U.requestId=Y),U.responseType=O.type,!(this.config.edgeAction.isEnabled&&this.config.edgeAction.hookIncomingMessage(U)||this.config.bingAtWork.isEnabled&&this.config.bingAtWork.hookIncomingMessage(B,K))){switch(U.responseType){case ji.GetSharedMessagesResponse:U.isShared=U.author===Yi.Bot;case ji.SerpCachedResponse:U.isFromCache=!0,this.config.messaging.streamCachedResponses&&(U.genStream=U.messageType===tr.IncomingBotResponse);break;case ji.ChatResponse:this.config.messaging.streamAnnRules&&(U.genStream=isAnnRules(U)&&1===G);case ji.GetConversationResponse:case ji.GetMessagesResponse:}if(O.type===ji.GetSharedMessagesResponse){const B=O.metadata;(null==B?void 0:B.renderUrl)&&(null===(W=B.renderUrl)||void 0===W?void 0:W.length)>0&&(U.renderUrl=B.renderUrl)}U.messageType===tr.AdsQuery&&U.requestId!==Y&&(U.requestId=Y),this.addToBuffer(U)}}}switch(O.type){case ji.ChatResponse:this.updateConversationData(O),this.perfTracker.markEvent("LastTokenResponse");break;case ji.SerpCachedResponse:case ji.GetSharedMessagesResponse:this.registerContext(O.messages);case ji.GetConversationResponse:case ji.GetMessagesResponse:case ji.CaptchaResponse:}O.type!==ji.GetMessagesResponse&&this.responseState===dp.ProcessingResponse&&setTimeout((()=>this.finalizeRequest()))}genLocalIdentifier(){return`local-gen-${CoreUtils.uuid()}`}finalizeRequest(){var O,B;this.resetResponseState();const U=this.conversation.messages.length-1>=0?null===(O=this.conversation.messages[this.conversation.messages.length-1])||void 0===O?void 0:O.finalize():void 0;null===(B=this.log)||void 0===B||B.trace(this,this.finalizeRequest,"finalizing last:",U).write()}updateConversationData(O){O.conversationId&&O.conversationExpiryTime&&this.conversation.updateId(O.conversationId,O.conversationExpiryTime)}validateResponse(O){var B,U,G;if(![ji.GetMessagesResponse,ji.CaptchaResponse,ji.SerpCachedResponse].includes(O.type)&&(null===(B=O.result)||void 0===B?void 0:B.value)!==Wi.Success&&(null===(U=O.result)||void 0===U?void 0:U.value)!==Wi.CaptchaChallenge)throw new Error(`Unexpected result value: ${null===(G=O.result)||void 0===G?void 0:G.value}`)}checkFateUserMessage(O){var B;if(null===(B=O.messages)||void 0===B?void 0:B.length){const B=O.messages.map((O=>O.author===Yi.User&&O.offense===nr.Offensive)).filter((O=>O)).length;this.errorState.increamentFateCounter(B)}}addToBuffer(O){var B;if(O.genStream&&this.config.messaging.enableSyntheticStreaming){this.responseState=dp.GeneratingStream;for(const U of this.tryGenerateMessageStream(O)){if(null===(B=__classPrivateFieldGet(this,tp,"f").value)||void 0===B?void 0:B.token.isCancellationRequested)return;this.config.messaging.streamSyntheticTextResponses&&this.messageBuffer.queue((()=>this.sleep())),this.messageBuffer.queue((()=>this.processMessageBufferAsync(U)))}this.responseState=dp.ProcessingMessages}this.config.messaging.streamSyntheticTextResponses&&this.messageBuffer.queue((()=>this.sleep())),this.messageBuffer.queue((()=>this.processMessageBufferAsync(O)))}sleep(){return new Promise((O=>setTimeout(O,this.config.messaging.messageBufferWorkerStreamDelayMS)))}async processMessageBufferAsync(O){var B;if(null===(B=__classPrivateFieldGet(this,tp,"f").value)||void 0===B?void 0:B.token.isCancellationRequested)return;let U=0;this.isPreviousGenStream?U=this.config.messaging.messageBufferWorkerStreamDelayMS:this.isPreviousFromCache&&[tr.IncomingBotResponse,tr.InternalSearchQuery,tr.InternalLoaderMessage].includes(O.messageType)&&(U=this.config.messaging.messageBufferWorkerDefaultDelayMS),await this.bufferDelayer.trigger((()=>this.fireMessageEvent(O)),U),this.isPreviousFromCache=O.isFromCache,this.isPreviousGenStream=O.genStream,this.messageBuffer.size<=1&&O.responseType!==ji.GetMessagesResponse&&setTimeout((()=>this.finalizeRequest()))}fireMessageEvent(O){var B;(null===(B=__classPrivateFieldGet(this,tp,"f").value)||void 0===B?void 0:B.token.isCancellationRequested)||__classPrivateFieldGet(this,np,"f").fire(O)}createMessageBuffer(){const O=this._register(new Queue);return this._register(O.onDrained(this.handleMessageBufferDrained)),O}loadCachedResponse(O){var B,U;null===(B=this.log)||void 0===B||B.trace(this,this.loadCachedResponse,null,O).write();try{this.initializeRequestState(),this.responseState=dp.ProcessingResponse,this.processResponse(O)}catch(O){throw null===(U=this.log)||void 0===U||U.error(this,this.loadCachedResponse,"error:",O).write(),this.resetResponseState(),O}}async loadSharedMessagesAsync(O){var B,U,G,q,j,W,Y,K,Q;null===(B=this.log)||void 0===B||B.trace(this,this.loadSharedMessagesAsync,"enter").write();try{this.initializeRequestState();const{source:B,sliceIds:Q}=this.config.sydney.request,Z=await this.api.sydney.sharing.getSharedMessagesAsync(O,B,this.genTraceId(),Q);if(Z.type=ji.GetSharedMessagesResponse,this.config.features.enableShareInlineAdsIframe&&Z.metadata){const{iframeImg:O,iframeSrc:B}=Z.metadata,K=`[![iframe](${O})](${B})`;(null===(Y=null===(W=null===(j=null===(q=null===(G=null===(U=Z.messages)||void 0===U?void 0:U[0])||void 0===G?void 0:G.adaptiveCards)||void 0===q?void 0:q[0])||void 0===j?void 0:j.body)||void 0===W?void 0:W[0])||void 0===Y?void 0:Y.text)&&O&&B&&(Z.messages[0].adaptiveCards[0].body[0].text+=K)}null===(K=this.log)||void 0===K||K.trace(this,this.loadSharedMessagesAsync,"result",Z).write(),this.responseState=dp.ProcessingResponse,this.config.features.enableThreadShareLandingPage&&(this.conversation.changeConversationType(Bc.Shared),this.stream.checkSharedNewThread(Z,O)),this.processResponse(Z)}catch(O){throw null===(Q=this.log)||void 0===Q||Q.error(this,this.loadSharedMessagesAsync,"error:",O).write(),this.resetResponseState(),O}}async loadConversationAsync(O){var B,U,G;null===(B=this.log)||void 0===B||B.trace(this,this.loadConversationAsync,"enter",O).write();try{this.initializeRequestState();const{baseUrl:B,pathBase:G,pathGetConversation:q,queryGetConversation:j}=this.config.sydney,W=new URL(`${B}${G}${q}`);for(const B in j)if(Object.prototype.hasOwnProperty.call(j,B)){const U=j[B];"<<conversationId>>"===U?W.searchParams.set(B,O):W.searchParams.set(B,U)}const Y=await fetch(W);if(!Y.ok)throw new Error("Load conversation failed.");{null===(U=this.log)||void 0===U||U.trace(this,this.loadConversationAsync,"success").write();const O=await Y.json();O.type=ji.GetConversationResponse,this.responseState=dp.ProcessingResponse,this.processResponse(O)}}catch(O){const B=O instanceof Error?O:"Conversation load failed.";throw null===(G=this.log)||void 0===G||G.error(this,"loadConversationAsync",B).write(),this.resetResponseState(),O}__classPrivateFieldGet(this,lp,"f").fire()}async copyConversationAsync(O){var B,U,G,q;null===(B=this.log)||void 0===B||B.trace(this,this.copyConversationAsync,"enter",O).write();try{this.initializeRequestState();const B={...this.config.sydney.request,isStartOfSession:!0,message:{...this.config.sydney.message,author:Yi.User,inputMethod:Ji.Keyboard,text:"",messageType:tr.Chat},tone:this.tone};if(this.config.features.secureConversation&&await this.secureConversationAsync(B),this.updateRequestConversationId(B),!this.conversation.id)return void(null===(U=this.log)||void 0===U||U.info(this,"copyConversationAsync","ConversationId does not exist").write());const{baseUrl:q,pathCopyConversation:j}=this.config.bing,W=new URL(`${q}${j}?sourceConversationId=${O}&conversationId=${this.conversation.id}`),Y=await fetch(W);if(!Y.ok)throw new Error("Copy conversation failed.");{null===(G=this.log)||void 0===G||G.trace(this,this.copyConversationAsync,"success").write();const B=await Y.json();B.type=ji.GetConversationResponse,this.responseState=dp.ProcessingResponse,this.processResponse(B),O=this.conversation.id,this.conversation.reset(),await this.loadConversationAsync(O)}}catch(O){const B=O instanceof Error?O:"Conversation load failed.";throw null===(q=this.log)||void 0===q||q.error(this,"copyConversationAsync",B).write(),this.resetResponseState(),O}}async createChatRequestAsync(O,B=Ji.Keyboard,U=!0,G=tr.Chat){var q;let j=this.conversation.isExpired||B===Ji.Speech&&!__classPrivateFieldGet(this,ep,"f");this.conversation.state===Lc.Inactive?(j=!0,this.conversation.setPending()):this.conversation.messages.some((O=>O.conversationId===this.conversation.id))||this.config.features.enableAutoRecoverFromInvalidSessionForFirstTurn&&(j=!0);const W={...this.config.sydney.request,isStartOfSession:j,message:{...this.config.sydney.message,author:Yi.User,inputMethod:B,text:O,messageType:G}};if(this.config.features.enableServerLogMerging){const O=CoreUtils.uuid();W.requestId=O,W.message.requestId=O,W.message.messageId=O}if(this.config.features.secureConversation&&await this.secureConversationAsync(W),this.config.features.enableServerLogMerging&&null!==this.conversation.id&&__classPrivateFieldGet(this,sp,"f").fire([W.message,this.conversation.id]),this.config.features.enableSimpleVoiceInput&&(this.config.features.enableTTSOnVoiceInput&&B===Ji.Speech?W.spokenTextMode=er.AudioUrl:W.spokenTextMode=er.None),this.updateRequestConversationId(W),j){const O=this.getPendingContext(U);O&&(W.previousMessages=O)}return null===(q=this.log)||void 0===q||q.trace(this,this.createChatRequestAsync,"request:",W).write(),W}commitChatRequest(O){O.isStartOfSession&&this.clearPendingContext()}async secureConversationAsync(O){var B,U,G,q,j;if(null===(B=this.log)||void 0===B||B.trace(this,this.secureConversationAsync,"enter").write(),this.config.sydney.hostnamesToBypassSecureConnection.includes(window.location.hostname))return null===(U=this.log)||void 0===U||U.trace(this,this.secureConversationAsync,"exiting - hostname is allowed to bypass").write(),O.isStartOfSession&&this.conversation.updateId(CoreUtils.uuid(),this.in6Hours()),void this.perfTracker.markEvent("RequestSend");if(!this.conversation.isExpired&&this.conversation.state!==Lc.Inactive&&!this.conversation.hashedSignature)throw new Error("Invalid conversation state.");if(!this.conversation.hashedSignature||!this.conversation.id){let O,B=null;try{const handler=()=>this.errorState.setChatWarningState(Hc.Processing);O=window.setTimeout(handler,4e3),B=await this.api.bing.conversation.create(),window.clearTimeout(O),this.errorState.setChatWarningState(),null!==B&&(this.validateBingCreateConversationResponse(B),this.conversation.updateId(B.conversationId,this.in6Hours(),B.clientId,B.conversationSignature)),null===(G=this.log)||void 0===G||G.trace(this,this.secureConversationAsync,"result:",B).write()}catch(U){throw window.clearTimeout(O),null===(q=this.log)||void 0===q||q.error(this,this.secureConversationAsync,"error:",U).write(),this.networkError.trackNetworkErrorEvent(void 0,void 0,U,{responseMessage:JSON.stringify(null==B?void 0:B.result)}),new CreateConversationError("Failed to secure the conversation.",null===(j=null==B?void 0:B.result)||void 0===j?void 0:j.value,U)}}this.perfTracker.markEvent("RequestSend"),O.conversationSignature=this.conversation.hashedSignature,this.conversation.clientId&&(O.participant={id:this.conversation.clientId})}in6Hours(){const O=new Date;return O.setMinutes(O.getMinutes()+360),O}validateBingCreateConversationResponse(O){if(O.result.value!==lr.Success)throw new Error(`Create conversation failed: ${O.result.value}`);if(!O.conversationId)throw new Error("Create conversation failed: conversation ID.");if(!O.conversationSignature)throw new Error("Create conversation failed: signature.");if(!O.clientId)throw new Error("Create conversation failed: client id.")}attachStreamEventListeners(){this._register(this.stream.onBegin(this.handleStreamBegin)),this._register(this.stream.onUpdate(this.handleStreamUpdate)),this._register(this.stream.onResponse(this.handleStreamResponse)),this._register(this.stream.onComplete(this.handleTextStreamComplete)),this._register(this.speech.onBegin(this.handleStreamBegin)),this._register(this.speech.onUpdate(this.handleStreamUpdate)),this._register(this.speech.onResponse(this.handleStreamResponse)),this._register(this.speech.onComplete(this.handleSpeechStreamComplete)),this._register(this.conversation.onReset(this.handleConversationReset))}genTraceId(){return CoreUtils.uuid()}*tryGenerateMessageStream(O){if(function(O){var B,U;if((null===(B=O.adaptiveCards)||void 0===B?void 0:B.length)&&(null===(U=O.adaptiveCards[0].body)||void 0===U?void 0:U.length)&&O.adaptiveCards[0].body[0].type===qi.TextBlock)return!0;return!1}(O)){const B=O.adaptiveCards[0].body[0].text;for(const[U,G]of this.generateStreamSequence(B)){const B=JSON.parse(JSON.stringify(O));B.responseType=ji.GetMessagesResponse,B.text=G,B.spokenText=G,B.adaptiveCards[0].body[0].text=`${U}${G}`,yield B}}}*generateStreamSequence(O){const[B,U]=this.separateStreamableTextPrefix(O,this.config.messaging.attributionMatcher),G=U.split(" ");let q="";for(let O=0;O<G.length;O++)q=O?`${q} ${G[O]}`:G[O],yield[B,q]}separateStreamableTextPrefix(O,B){let U,G="",q=O;const j=O.matchAll(B);for(const O of j)U=O;if(null==U?void 0:U.index){const B=U.index+U[0].length;G=O.substring(0,B),q=O.substring(B)}return[G,q]}checkMaxMessageLimit(){const O=this.conversation.messages[0].author===Yi.Bot?this.conversation.turnCount-1:this.conversation.turnCount;(this.config.features.enableMaxTurnsPerConversation||this.config.features.enableMaxTurnsPerConversationWithoutTurnCounter)&&this.config.messaging.maxTurnsPerConversation&&O===this.config.messaging.maxTurnsPerConversation&&this.errorState.setChatErrorState(this.config.features.enableMUIDUserMode?Gc.ConversationLimitForMuidUsers:Gc.ConversationLimit)}isDeleteMessageUpdate(O){return O.type===ji.GetMessagesResponse&&!!O.messageIdsToDelete}};function isAnnRules(O){return O.contentOrigin===Ki.AnnRules}var up;ep=new WeakMap,tp=new WeakMap,ip=new WeakMap,rp=new WeakMap,np=new WeakMap,op=new WeakMap,ap=new WeakMap,sp=new WeakMap,lp=new WeakMap,__decorate([observable,__metadata("design:type",Number)],pp.prototype,"requestState",void 0),__decorate([observable,__metadata("design:type",Number)],pp.prototype,"responseState",void 0),__decorate([observable,__metadata("design:type",Boolean)],pp.prototype,"isRequestPending",void 0),pp=__decorate([__param(0,ql),__param(1,Dc),__param(2,ei),__param(3,Kd),__param(4,Fc),__param(5,Ii),__param(6,Uc),__param(7,Zd),__param(8,$c),__param(9,Zc),__param(10,qc),__param(11,Jd),__param(12,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],pp),function(O){O.Txt="txt",O.Docx="docx",O.Pdf="pdf"}(up||(up={}));const hp=kt.createInterface();const mp=U(5031);var gp=U(4868),fp=U.n(gp);const yp="Powered by AI",_p={[up.Txt]:{filename:"Answer.txt"},[up.Docx]:{filename:"Answer.docx",slogan:yp},[up.Pdf]:{filename:"Answer.pdf",slogan:yp}};function isPlainObject(O){return"object"==typeof O&&null!==O&&!Array.isArray(O)}function merge(O,B){const U={...O};return Object.keys(B).forEach((O=>{const G=B[O],q=U[O];isPlainObject(G)&&isPlainObject(q)?U[O]=merge(q,G):U[O]=G})),U}function getMergedOptions(O,B){return merge(_p[O],B||{})}var vp,bp;function isTextMessageModel(O){return O.type===vp.Text}function isEmptyMessageModel(O){if(O.author!==Yi.Bot)return!1;switch(O.type){case vp.Text:const B=O;return""===(null==B?void 0:B.text)&&0===B.adaptiveCards.length;case vp.Meta:const U=O;return(null==U?void 0:U.messageType)!==tr.InternalSearchQuery&&(null==U?void 0:U.messageType)!==tr.InternalLoaderMessage&&""===U.text;case vp.ExternalHTML:return""===O.text;case vp.FullBleed:return""===O.text;default:return!1}}function getDocxStyleConfig(O){const{LevelFormat:B,AlignmentType:U,convertInchesToTwip:G}=O;return{styles:{paragraphStyles:[{id:"user-title",name:"User Title Style",run:{color:"#005366",bold:!0,size:24,font:"Inter"},paragraph:{spacing:{line:276,before:144,after:72}}},{id:"bot-title",name:"Bot Title Style",run:{color:"#123BB6",bold:!0,size:24,font:"Inter"},paragraph:{spacing:{line:276,before:144,after:72}}},{id:"paragraph-text",name:"Paragraph Text Style",run:{color:"#000000",size:26,font:"Inter"},paragraph:{spacing:{line:276,before:144,after:72}}},{id:"header",name:"Header Style",run:{color:"#767676",size:24,font:"Inter"}},{id:"code",name:"Code Style",run:{kern:0,font:"Consolas"},paragraph:{spacing:{after:0}}}]},numbering:{config:[{reference:"bing-chat-numbering",levels:[{level:0,format:B.DECIMAL,text:"%1.",alignment:U.START,style:{paragraph:{indent:{left:G(.5),hanging:G(.18)}}}},{level:1,format:B.LOWER_LETTER,text:"%2.",alignment:U.START,style:{paragraph:{indent:{left:G(.75),hanging:G(.18)}}}},{level:2,format:B.UPPER_LETTER,text:"%3)",alignment:U.START,style:{paragraph:{indent:{left:G(1),hanging:G(.18)}}}},{level:3,format:B.UPPER_ROMAN,text:"%4)",alignment:U.START,style:{paragraph:{indent:{left:2880,hanging:2420}}}}]}]}}}function createSections(O,B){var U;const{AlignmentType:G,Paragraph:q,Header:j}=O;return{properties:{page:{margin:{top:30,footer:20}}},headers:{default:new j({children:[new q({text:null!==(U=B.slogan)&&void 0!==U?U:yp,style:"header",alignment:G.CENTER})]})}}}(function(O){O.Text="text",O.Meta="meta",O.Host="host",O.ExternalHTML="externalhtml",O.FullBleed="fullbleed",O.Context="context"})(vp||(vp={})),function(O){O.Ads="ads",O.Answer="answer",O.Captcha="captcha",O.ImageContentCreator="IMAGE",O.SemSerp="semserp"}(bp||(bp={}));const Sp=kt.createInterface(),Cp={};function one(O,B,U){if(function(O){return Boolean(O&&"object"==typeof O)}(O)){if("value"in O)return"html"!==O.type||U?O.value:"";if(B&&"alt"in O&&O.alt)return O.alt;if("children"in O)return lib_all(O.children,B,U)}return Array.isArray(O)?lib_all(O,B,U):""}function lib_all(O,B,U){const G=[];let q=-1;for(;++q<O.length;)G[q]=one(O[q],B,U);return G.join("")}function splice(O,B,U,G){const q=O.length;let j,W=0;if(B=B<0?-B>q?0:q+B:B>q?q:B,U=U>0?U:0,G.length<1e4)j=Array.from(G),j.unshift(B,U),[].splice.apply(O,j);else for(U&&[].splice.apply(O,[B,U]);W<G.length;)j=G.slice(W,W+1e4),j.unshift(B,0),[].splice.apply(O,j),W+=1e4,B+=1e4}function push(O,B){return O.length>0?(splice(O,O.length,0,B),O):B}const Ep={}.hasOwnProperty;function syntaxExtension(O,B){let U;for(U in B){const G=(Ep.call(O,U)?O[U]:void 0)||(O[U]={}),q=B[U];let j;for(j in q){Ep.call(G,j)||(G[j]=[]);const O=q[j];constructs(G[j],Array.isArray(O)?O:O?[O]:[])}}}function constructs(O,B){let U=-1;const G=[];for(;++U<B.length;)("after"===B[U].add?O:G).push(B[U]);splice(O,0,0,G)}const xp=regexCheck(/[A-Za-z]/),Tp=regexCheck(/\d/),wp=regexCheck(/[\dA-Fa-f]/),kp=regexCheck(/[\dA-Za-z]/),Ap=regexCheck(/[!-/:-@[-`{-~]/),Rp=regexCheck(/[#-'*+\--9=?A-Z^-~]/);function asciiControl(O){return null!==O&&(O<32||127===O)}function markdownLineEndingOrSpace(O){return null!==O&&(O<0||32===O)}function markdownLineEnding(O){return null!==O&&O<-2}function markdownSpace(O){return-2===O||-1===O||32===O}const Ip=regexCheck(/\s/),Pp=regexCheck(/[!-/:-@[-`{-~\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/);function regexCheck(O){return function(B){return null!==B&&O.test(String.fromCharCode(B))}}function factorySpace(O,B,U,G){const q=G?G-1:Number.POSITIVE_INFINITY;let j=0;return function(G){if(markdownSpace(G))return O.enter(U),prefix(G);return B(G)};function prefix(G){return markdownSpace(G)&&j++<q?(O.consume(G),prefix):(O.exit(U),B(G))}}const Np={tokenize:function(O){const B=O.attempt(this.parser.constructs.contentInitial,(function(U){if(null===U)return void O.consume(U);return O.enter("lineEnding"),O.consume(U),O.exit("lineEnding"),factorySpace(O,B,"linePrefix")}),(function(B){return O.enter("paragraph"),lineStart(B)}));let U;return B;function lineStart(B){const G=O.enter("chunkText",{contentType:"text",previous:U});return U&&(U.next=G),U=G,data(B)}function data(B){return null===B?(O.exit("chunkText"),O.exit("paragraph"),void O.consume(B)):markdownLineEnding(B)?(O.consume(B),O.exit("chunkText"),lineStart):(O.consume(B),data)}}};const Op={tokenize:function(O){const B=this,U=[];let G,q,j,W=0;return start;function start(G){if(W<U.length){const q=U[W];return B.containerState=q[1],O.attempt(q[0].continuation,documentContinue,checkNewContainers)(G)}return checkNewContainers(G)}function documentContinue(O){if(W++,B.containerState._closeFlow){B.containerState._closeFlow=void 0,G&&closeFlow();const U=B.events.length;let q,j=U;for(;j--;)if("exit"===B.events[j][0]&&"chunkFlow"===B.events[j][1].type){q=B.events[j][1].end;break}exitContainers(W);let Y=U;for(;Y<B.events.length;)B.events[Y][1].end=Object.assign({},q),Y++;return splice(B.events,j+1,0,B.events.slice(U)),B.events.length=Y,checkNewContainers(O)}return start(O)}function checkNewContainers(q){if(W===U.length){if(!G)return documentContinued(q);if(G.currentConstruct&&G.currentConstruct.concrete)return flowStart(q);B.interrupt=Boolean(G.currentConstruct&&!G._gfmTableDynamicInterruptHack)}return B.containerState={},O.check(Mp,thereIsANewContainer,thereIsNoNewContainer)(q)}function thereIsANewContainer(O){return G&&closeFlow(),exitContainers(W),documentContinued(O)}function thereIsNoNewContainer(O){return B.parser.lazy[B.now().line]=W!==U.length,j=B.now().offset,flowStart(O)}function documentContinued(U){return B.containerState={},O.attempt(Mp,containerContinue,flowStart)(U)}function containerContinue(O){return W++,U.push([B.currentConstruct,B.containerState]),documentContinued(O)}function flowStart(U){return null===U?(G&&closeFlow(),exitContainers(0),void O.consume(U)):(G=G||B.parser.flow(B.now()),O.enter("chunkFlow",{contentType:"flow",previous:q,_tokenizer:G}),flowContinue(U))}function flowContinue(U){return null===U?(writeToChild(O.exit("chunkFlow"),!0),exitContainers(0),void O.consume(U)):markdownLineEnding(U)?(O.consume(U),writeToChild(O.exit("chunkFlow")),W=0,B.interrupt=void 0,start):(O.consume(U),flowContinue)}function writeToChild(O,U){const Y=B.sliceStream(O);if(U&&Y.push(null),O.previous=q,q&&(q.next=O),q=O,G.defineSkip(O.start),G.write(Y),B.parser.lazy[O.start.line]){let O=G.events.length;for(;O--;)if(G.events[O][1].start.offset<j&&(!G.events[O][1].end||G.events[O][1].end.offset>j))return;const U=B.events.length;let q,Y,K=U;for(;K--;)if("exit"===B.events[K][0]&&"chunkFlow"===B.events[K][1].type){if(q){Y=B.events[K][1].end;break}q=!0}for(exitContainers(W),O=U;O<B.events.length;)B.events[O][1].end=Object.assign({},Y),O++;splice(B.events,K+1,0,B.events.slice(U)),B.events.length=O}}function exitContainers(G){let q=U.length;for(;q-- >G;){const G=U[q];B.containerState=G[1],G[0].exit.call(B,O)}U.length=G}function closeFlow(){G.write([null]),q=void 0,G=void 0,B.containerState._closeFlow=void 0}}},Mp={tokenize:function(O,B,U){return factorySpace(O,O.attempt(this.parser.constructs.document,B,U),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};const Dp={tokenize:function(O,B,U){return factorySpace(O,(function(O){return null===O||markdownLineEnding(O)?B(O):U(O)}),"linePrefix")},partial:!0};function subtokenize(O){const B={};let U,G,q,j,W,Y,K,Q=-1;for(;++Q<O.length;){for(;Q in B;)Q=B[Q];if(U=O[Q],Q&&"chunkFlow"===U[1].type&&"listItemPrefix"===O[Q-1][1].type&&(Y=U[1]._tokenizer.events,q=0,q<Y.length&&"lineEndingBlank"===Y[q][1].type&&(q+=2),q<Y.length&&"content"===Y[q][1].type))for(;++q<Y.length&&"content"!==Y[q][1].type;)"chunkText"===Y[q][1].type&&(Y[q][1]._isInFirstContentOfListItem=!0,q++);if("enter"===U[0])U[1].contentType&&(Object.assign(B,subcontent(O,Q)),Q=B[Q],K=!0);else if(U[1]._container){for(q=Q,G=void 0;q--&&(j=O[q],"lineEnding"===j[1].type||"lineEndingBlank"===j[1].type);)"enter"===j[0]&&(G&&(O[G][1].type="lineEndingBlank"),j[1].type="lineEnding",G=q);G&&(U[1].end=Object.assign({},O[G][1].start),W=O.slice(G,Q),W.unshift(U),splice(O,G,Q-G+1,W))}}return!K}function subcontent(O,B){const U=O[B][1],G=O[B][2];let q=B-1;const j=[],W=U._tokenizer||G.parser[U.contentType](U.start),Y=W.events,K=[],Q={};let Z,X,J=-1,ee=U,te=0,ie=0;const re=[ie];for(;ee;){for(;O[++q][1]!==ee;);j.push(q),ee._tokenizer||(Z=G.sliceStream(ee),ee.next||Z.push(null),X&&W.defineSkip(ee.start),ee._isInFirstContentOfListItem&&(W._gfmTasklistFirstContentOfListItem=!0),W.write(Z),ee._isInFirstContentOfListItem&&(W._gfmTasklistFirstContentOfListItem=void 0)),X=ee,ee=ee.next}for(ee=U;++J<Y.length;)"exit"===Y[J][0]&&"enter"===Y[J-1][0]&&Y[J][1].type===Y[J-1][1].type&&Y[J][1].start.line!==Y[J][1].end.line&&(ie=J+1,re.push(ie),ee._tokenizer=void 0,ee.previous=void 0,ee=ee.next);for(W.events=[],ee?(ee._tokenizer=void 0,ee.previous=void 0):re.pop(),J=re.length;J--;){const B=Y.slice(re[J],re[J+1]),U=j.pop();K.unshift([U,U+B.length-1]),splice(O,U,2,B)}for(J=-1;++J<K.length;)Q[te+K[J][0]]=te+K[J][1],te+=K[J][1]-K[J][0]-1;return Q}const Lp={tokenize:function(O,B){let U;return function(B){return O.enter("content"),U=O.enter("chunkContent",{contentType:"content"}),data(B)};function data(B){return null===B?contentEnd(B):markdownLineEnding(B)?O.check(Bp,contentContinue,contentEnd)(B):(O.consume(B),data)}function contentEnd(U){return O.exit("chunkContent"),O.exit("content"),B(U)}function contentContinue(B){return O.consume(B),O.exit("chunkContent"),U.next=O.enter("chunkContent",{contentType:"content",previous:U}),U=U.next,data}},resolve:function(O){return subtokenize(O),O}},Bp={tokenize:function(O,B,U){const G=this;return function(B){return O.exit("chunkContent"),O.enter("lineEnding"),O.consume(B),O.exit("lineEnding"),factorySpace(O,prefixed,"linePrefix")};function prefixed(q){if(null===q||markdownLineEnding(q))return U(q);const j=G.events[G.events.length-1];return!G.parser.constructs.disable.null.includes("codeIndented")&&j&&"linePrefix"===j[1].type&&j[2].sliceSerialize(j[1],!0).length>=4?B(q):O.interrupt(G.parser.constructs.flow,U,B)(q)}},partial:!0};const Fp={tokenize:function(O){const B=this,U=O.attempt(Dp,(function(G){if(null===G)return void O.consume(G);return O.enter("lineEndingBlank"),O.consume(G),O.exit("lineEndingBlank"),B.currentConstruct=void 0,U}),O.attempt(this.parser.constructs.flowInitial,afterConstruct,factorySpace(O,O.attempt(this.parser.constructs.flow,afterConstruct,O.attempt(Lp,afterConstruct)),"linePrefix")));return U;function afterConstruct(G){if(null!==G)return O.enter("lineEnding"),O.consume(G),O.exit("lineEnding"),B.currentConstruct=void 0,U;O.consume(G)}}};const zp={resolveAll:text_createResolver()},$p=initializeFactory("string"),Up=initializeFactory("text");function initializeFactory(O){return{tokenize:function(B){const U=this,G=this.parser.constructs[O],q=B.attempt(G,start,notText);return start;function start(O){return atBreak(O)?q(O):notText(O)}function notText(O){if(null!==O)return B.enter("data"),B.consume(O),data;B.consume(O)}function data(O){return atBreak(O)?(B.exit("data"),q(O)):(B.consume(O),data)}function atBreak(O){if(null===O)return!0;const B=G[O];let q=-1;if(B)for(;++q<B.length;){const O=B[q];if(!O.previous||O.previous.call(U,U.previous))return!0}return!1}},resolveAll:text_createResolver("text"===O?resolveAllLineSuffixes:void 0)}}function text_createResolver(O){return function(B,U){let G,q=-1;for(;++q<=B.length;)void 0===G?B[q]&&"data"===B[q][1].type&&(G=q,q++):B[q]&&"data"===B[q][1].type||(q!==G+2&&(B[G][1].end=B[q-1][1].end,B.splice(G+2,q-G-2),q=G+2),G=void 0);return O?O(B,U):B}}function resolveAllLineSuffixes(O,B){let U=0;for(;++U<=O.length;)if((U===O.length||"lineEnding"===O[U][1].type)&&"data"===O[U-1][1].type){const G=O[U-1][1],q=B.sliceStream(G);let j,W=q.length,Y=-1,K=0;for(;W--;){const O=q[W];if("string"==typeof O){for(Y=O.length;32===O.charCodeAt(Y-1);)K++,Y--;if(Y)break;Y=-1}else if(-2===O)j=!0,K++;else if(-1!==O){W++;break}}if(K){const q={type:U===O.length||j||K<2?"lineSuffix":"hardBreakTrailing",start:{line:G.end.line,column:G.end.column-K,offset:G.end.offset-K,_index:G.start._index+W,_bufferIndex:W?Y:G.start._bufferIndex+Y},end:Object.assign({},G.end)};G.end=Object.assign({},q.start),G.start.offset===G.end.offset?Object.assign(G,q):(O.splice(U,0,["enter",q,B],["exit",q,B]),U+=2)}U++}return O}function resolveAll(O,B,U){const G=[];let q=-1;for(;++q<O.length;){const j=O[q].resolveAll;j&&!G.includes(j)&&(B=j(B,U),G.push(j))}return B}function createTokenizer(O,B,U){let G=Object.assign(U?Object.assign({},U):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const q={},j=[];let W=[],Y=[],K=!0;const Q={consume:function(O){markdownLineEnding(O)?(G.line++,G.column=1,G.offset+=-3===O?2:1,accountForPotentialSkip()):-1!==O&&(G.column++,G.offset++);G._bufferIndex<0?G._index++:(G._bufferIndex++,G._bufferIndex===W[G._index].length&&(G._bufferIndex=-1,G._index++));Z.previous=O,K=!0},enter:function(O,B){const U=B||{};return U.type=O,U.start=now(),Z.events.push(["enter",U,Z]),Y.push(U),U},exit:function(O){const B=Y.pop();return B.end=now(),Z.events.push(["exit",B,Z]),B},attempt:constructFactory((function(O,B){addResult(O,B.from)})),check:constructFactory(onsuccessfulcheck),interrupt:constructFactory(onsuccessfulcheck,{interrupt:!0})},Z={previous:null,code:null,containerState:{},events:[],parser:O,sliceStream,sliceSerialize:function(O,B){return function(O,B){let U=-1;const G=[];let q;for(;++U<O.length;){const j=O[U];let W;if("string"==typeof j)W=j;else switch(j){case-5:W="\r";break;case-4:W="\n";break;case-3:W="\r\n";break;case-2:W=B?" ":"\t";break;case-1:if(!B&&q)continue;W=" ";break;default:W=String.fromCharCode(j)}q=-2===j,G.push(W)}return G.join("")}(sliceStream(O),B)},now,defineSkip:function(O){q[O.line]=O.column,accountForPotentialSkip()},write:function(O){if(W=push(W,O),main(),null!==W[W.length-1])return[];return addResult(B,0),Z.events=resolveAll(j,Z.events,Z),Z.events}};let X,J=B.tokenize.call(Z,Q);return B.resolveAll&&j.push(B),Z;function sliceStream(O){return function(O,B){const U=B.start._index,G=B.start._bufferIndex,q=B.end._index,j=B.end._bufferIndex;let W;U===q?W=[O[U].slice(G,j)]:(W=O.slice(U,q),G>-1&&(W[0]=W[0].slice(G)),j>0&&W.push(O[q].slice(0,j)));return W}(W,O)}function now(){return Object.assign({},G)}function main(){let O;for(;G._index<W.length;){const B=W[G._index];if("string"==typeof B)for(O=G._index,G._bufferIndex<0&&(G._bufferIndex=0);G._index===O&&G._bufferIndex<B.length;)go(B.charCodeAt(G._bufferIndex));else go(B)}}function go(O){K=void 0,X=O,J=J(O)}function onsuccessfulcheck(O,B){B.restore()}function constructFactory(O,B){return function(U,q,j){let W,X,J,ee;return Array.isArray(U)?handleListOfConstructs(U):"tokenize"in U?handleListOfConstructs([U]):function(O){return start;function start(B){const U=null!==B&&O[B],G=null!==B&&O.null;return handleListOfConstructs([...Array.isArray(U)?U:U?[U]:[],...Array.isArray(G)?G:G?[G]:[]])(B)}}(U);function handleListOfConstructs(O){return W=O,X=0,0===O.length?j:handleConstruct(O[X])}function handleConstruct(O){return function(U){ee=function(){const O=now(),B=Z.previous,U=Z.currentConstruct,q=Z.events.length,j=Array.from(Y);return{restore,from:q};function restore(){G=O,Z.previous=B,Z.currentConstruct=U,Z.events.length=q,Y=j,accountForPotentialSkip()}}(),J=O,O.partial||(Z.currentConstruct=O);if(O.name&&Z.parser.constructs.disable.null.includes(O.name))return nok(U);return O.tokenize.call(B?Object.assign(Object.create(Z),B):Z,Q,ok,nok)(U)}}function ok(B){return K=!0,O(J,ee),q}function nok(O){return K=!0,ee.restore(),++X<W.length?handleConstruct(W[X]):j}}}function addResult(O,B){O.resolveAll&&!j.includes(O)&&j.push(O),O.resolve&&splice(Z.events,B,Z.events.length-B,O.resolve(Z.events.slice(B),Z)),O.resolveTo&&(Z.events=O.resolveTo(Z.events,Z))}function accountForPotentialSkip(){G.line in q&&G.column<2&&(G.column=q[G.line],G.offset+=q[G.line]-1)}}const Vp={name:"thematicBreak",tokenize:function(O,B,U){let G,q=0;return function(B){return O.enter("thematicBreak"),G=B,atBreak(B)};function atBreak(j){return j===G?(O.enter("thematicBreakSequence"),sequence(j)):markdownSpace(j)?factorySpace(O,atBreak,"whitespace")(j):q<3||null!==j&&!markdownLineEnding(j)?U(j):(O.exit("thematicBreak"),B(j))}function sequence(B){return B===G?(O.consume(B),q++,sequence):(O.exit("thematicBreakSequence"),atBreak(B))}}};const Gp={name:"list",tokenize:function(O,B,U){const G=this,q=G.events[G.events.length-1];let j=q&&"linePrefix"===q[1].type?q[2].sliceSerialize(q[1],!0).length:0,W=0;return function(B){const q=G.containerState.type||(42===B||43===B||45===B?"listUnordered":"listOrdered");if("listUnordered"===q?!G.containerState.marker||B===G.containerState.marker:Tp(B)){if(G.containerState.type||(G.containerState.type=q,O.enter(q,{_container:!0})),"listUnordered"===q)return O.enter("listItemPrefix"),42===B||45===B?O.check(Vp,U,atMarker)(B):atMarker(B);if(!G.interrupt||49===B)return O.enter("listItemPrefix"),O.enter("listItemValue"),inside(B)}return U(B)};function inside(B){return Tp(B)&&++W<10?(O.consume(B),inside):(!G.interrupt||W<2)&&(G.containerState.marker?B===G.containerState.marker:41===B||46===B)?(O.exit("listItemValue"),atMarker(B)):U(B)}function atMarker(B){return O.enter("listItemMarker"),O.consume(B),O.exit("listItemMarker"),G.containerState.marker=G.containerState.marker||B,O.check(Dp,G.interrupt?U:onBlank,O.attempt(Hp,endOfPrefix,otherPrefix))}function onBlank(O){return G.containerState.initialBlankLine=!0,j++,endOfPrefix(O)}function otherPrefix(B){return markdownSpace(B)?(O.enter("listItemPrefixWhitespace"),O.consume(B),O.exit("listItemPrefixWhitespace"),endOfPrefix):U(B)}function endOfPrefix(U){return G.containerState.size=j+G.sliceSerialize(O.exit("listItemPrefix"),!0).length,B(U)}},continuation:{tokenize:function(O,B,U){const G=this;return G.containerState._closeFlow=void 0,O.check(Dp,(function(U){return G.containerState.furtherBlankLines=G.containerState.furtherBlankLines||G.containerState.initialBlankLine,factorySpace(O,B,"listItemIndent",G.containerState.size+1)(U)}),(function(U){if(G.containerState.furtherBlankLines||!markdownSpace(U))return G.containerState.furtherBlankLines=void 0,G.containerState.initialBlankLine=void 0,notInCurrentItem(U);return G.containerState.furtherBlankLines=void 0,G.containerState.initialBlankLine=void 0,O.attempt(qp,B,notInCurrentItem)(U)}));function notInCurrentItem(q){return G.containerState._closeFlow=!0,G.interrupt=void 0,factorySpace(O,O.attempt(Gp,B,U),"linePrefix",G.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(q)}}},exit:function(O){O.exit(this.containerState.type)}},Hp={tokenize:function(O,B,U){const G=this;return factorySpace(O,(function(O){const q=G.events[G.events.length-1];return!markdownSpace(O)&&q&&"listItemPrefixWhitespace"===q[1].type?B(O):U(O)}),"listItemPrefixWhitespace",G.parser.constructs.disable.null.includes("codeIndented")?void 0:5)},partial:!0},qp={tokenize:function(O,B,U){const G=this;return factorySpace(O,(function(O){const q=G.events[G.events.length-1];return q&&"listItemIndent"===q[1].type&&q[2].sliceSerialize(q[1],!0).length===G.containerState.size?B(O):U(O)}),"listItemIndent",G.containerState.size+1)},partial:!0};const jp={name:"blockQuote",tokenize:function(O,B,U){const G=this;return function(B){if(62===B){const U=G.containerState;return U.open||(O.enter("blockQuote",{_container:!0}),U.open=!0),O.enter("blockQuotePrefix"),O.enter("blockQuoteMarker"),O.consume(B),O.exit("blockQuoteMarker"),after}return U(B)};function after(U){return markdownSpace(U)?(O.enter("blockQuotePrefixWhitespace"),O.consume(U),O.exit("blockQuotePrefixWhitespace"),O.exit("blockQuotePrefix"),B):(O.exit("blockQuotePrefix"),B(U))}},continuation:{tokenize:function(O,B,U){return factorySpace(O,O.attempt(jp,B,U),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}},exit:function(O){O.exit("blockQuote")}};function factoryDestination(O,B,U,G,q,j,W,Y,K){const Q=K||Number.POSITIVE_INFINITY;let Z=0;return function(B){if(60===B)return O.enter(G),O.enter(q),O.enter(j),O.consume(B),O.exit(j),destinationEnclosedBefore;if(null===B||41===B||asciiControl(B))return U(B);return O.enter(G),O.enter(W),O.enter(Y),O.enter("chunkString",{contentType:"string"}),destinationRaw(B)};function destinationEnclosedBefore(U){return 62===U?(O.enter(j),O.consume(U),O.exit(j),O.exit(q),O.exit(G),B):(O.enter(Y),O.enter("chunkString",{contentType:"string"}),destinationEnclosed(U))}function destinationEnclosed(B){return 62===B?(O.exit("chunkString"),O.exit(Y),destinationEnclosedBefore(B)):null===B||60===B||markdownLineEnding(B)?U(B):(O.consume(B),92===B?destinationEnclosedEscape:destinationEnclosed)}function destinationEnclosedEscape(B){return 60===B||62===B||92===B?(O.consume(B),destinationEnclosed):destinationEnclosed(B)}function destinationRaw(q){return 40===q?++Z>Q?U(q):(O.consume(q),destinationRaw):41===q?Z--?(O.consume(q),destinationRaw):(O.exit("chunkString"),O.exit(Y),O.exit(W),O.exit(G),B(q)):null===q||markdownLineEndingOrSpace(q)?Z?U(q):(O.exit("chunkString"),O.exit(Y),O.exit(W),O.exit(G),B(q)):asciiControl(q)?U(q):(O.consume(q),92===q?destinationRawEscape:destinationRaw)}function destinationRawEscape(B){return 40===B||41===B||92===B?(O.consume(B),destinationRaw):destinationRaw(B)}}function factoryLabel(O,B,U,G,q,j){const W=this;let Y,K=0;return function(B){return O.enter(G),O.enter(q),O.consume(B),O.exit(q),O.enter(j),atBreak};function atBreak(Q){return null===Q||91===Q||93===Q&&!Y||94===Q&&!K&&"_hiddenFootnoteSupport"in W.parser.constructs||K>999?U(Q):93===Q?(O.exit(j),O.enter(q),O.consume(Q),O.exit(q),O.exit(G),B):markdownLineEnding(Q)?(O.enter("lineEnding"),O.consume(Q),O.exit("lineEnding"),atBreak):(O.enter("chunkString",{contentType:"string"}),label(Q))}function label(B){return null===B||91===B||93===B||markdownLineEnding(B)||K++>999?(O.exit("chunkString"),atBreak(B)):(O.consume(B),Y=Y||!markdownSpace(B),92===B?labelEscape:label)}function labelEscape(B){return 91===B||92===B||93===B?(O.consume(B),K++,label):label(B)}}function factoryTitle(O,B,U,G,q,j){let W;return function(B){return O.enter(G),O.enter(q),O.consume(B),O.exit(q),W=40===B?41:B,atFirstTitleBreak};function atFirstTitleBreak(U){return U===W?(O.enter(q),O.consume(U),O.exit(q),O.exit(G),B):(O.enter(j),atTitleBreak(U))}function atTitleBreak(B){return B===W?(O.exit(j),atFirstTitleBreak(W)):null===B?U(B):markdownLineEnding(B)?(O.enter("lineEnding"),O.consume(B),O.exit("lineEnding"),factorySpace(O,atTitleBreak,"linePrefix")):(O.enter("chunkString",{contentType:"string"}),title(B))}function title(B){return B===W||null===B||markdownLineEnding(B)?(O.exit("chunkString"),atTitleBreak(B)):(O.consume(B),92===B?titleEscape:title)}function titleEscape(B){return B===W||92===B?(O.consume(B),title):title(B)}}function factoryWhitespace(O,B){let U;return function start(G){if(markdownLineEnding(G))return O.enter("lineEnding"),O.consume(G),O.exit("lineEnding"),U=!0,start;if(markdownSpace(G))return factorySpace(O,start,U?"linePrefix":"lineSuffix")(G);return B(G)}}function normalizeIdentifier(O){return O.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Wp={name:"definition",tokenize:function(O,B,U){const G=this;let q;return function(B){return O.enter("definition"),factoryLabel.call(G,O,labelAfter,U,"definitionLabel","definitionLabelMarker","definitionLabelString")(B)};function labelAfter(B){return q=normalizeIdentifier(G.sliceSerialize(G.events[G.events.length-1][1]).slice(1,-1)),58===B?(O.enter("definitionMarker"),O.consume(B),O.exit("definitionMarker"),factoryWhitespace(O,factoryDestination(O,O.attempt(Yp,factorySpace(O,after,"whitespace"),factorySpace(O,after,"whitespace")),U,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):U(B)}function after(j){return null===j||markdownLineEnding(j)?(O.exit("definition"),G.parser.defined.includes(q)||G.parser.defined.push(q),B(j)):U(j)}}},Yp={tokenize:function(O,B,U){return function(B){return markdownLineEndingOrSpace(B)?factoryWhitespace(O,before)(B):U(B)};function before(B){return 34===B||39===B||40===B?factoryTitle(O,factorySpace(O,after,"whitespace"),U,"definitionTitle","definitionTitleMarker","definitionTitleString")(B):U(B)}function after(O){return null===O||markdownLineEnding(O)?B(O):U(O)}},partial:!0};const Kp={name:"codeIndented",tokenize:function(O,B,U){const G=this;return function(B){return O.enter("codeIndented"),factorySpace(O,afterStartPrefix,"linePrefix",5)(B)};function afterStartPrefix(O){const B=G.events[G.events.length-1];return B&&"linePrefix"===B[1].type&&B[2].sliceSerialize(B[1],!0).length>=4?afterPrefix(O):U(O)}function afterPrefix(B){return null===B?after(B):markdownLineEnding(B)?O.attempt(Qp,afterPrefix,after)(B):(O.enter("codeFlowValue"),content(B))}function content(B){return null===B||markdownLineEnding(B)?(O.exit("codeFlowValue"),afterPrefix(B)):(O.consume(B),content)}function after(U){return O.exit("codeIndented"),B(U)}}},Qp={tokenize:function(O,B,U){const G=this;return start;function start(B){return G.parser.lazy[G.now().line]?U(B):markdownLineEnding(B)?(O.enter("lineEnding"),O.consume(B),O.exit("lineEnding"),start):factorySpace(O,afterPrefix,"linePrefix",5)(B)}function afterPrefix(O){const q=G.events[G.events.length-1];return q&&"linePrefix"===q[1].type&&q[2].sliceSerialize(q[1],!0).length>=4?B(O):markdownLineEnding(O)?start(O):U(O)}},partial:!0};const Zp={name:"headingAtx",tokenize:function(O,B,U){const G=this;let q=0;return function(B){return O.enter("atxHeading"),O.enter("atxHeadingSequence"),fenceOpenInside(B)};function fenceOpenInside(j){return 35===j&&q++<6?(O.consume(j),fenceOpenInside):null===j||markdownLineEndingOrSpace(j)?(O.exit("atxHeadingSequence"),G.interrupt?B(j):headingBreak(j)):U(j)}function headingBreak(U){return 35===U?(O.enter("atxHeadingSequence"),sequence(U)):null===U||markdownLineEnding(U)?(O.exit("atxHeading"),B(U)):markdownSpace(U)?factorySpace(O,headingBreak,"whitespace")(U):(O.enter("atxHeadingText"),data(U))}function sequence(B){return 35===B?(O.consume(B),sequence):(O.exit("atxHeadingSequence"),headingBreak(B))}function data(B){return null===B||35===B||markdownLineEndingOrSpace(B)?(O.exit("atxHeadingText"),headingBreak(B)):(O.consume(B),data)}},resolve:function(O,B){let U,G,q=O.length-2,j=3;"whitespace"===O[j][1].type&&(j+=2);q-2>j&&"whitespace"===O[q][1].type&&(q-=2);"atxHeadingSequence"===O[q][1].type&&(j===q-1||q-4>j&&"whitespace"===O[q-2][1].type)&&(q-=j+1===q?2:4);q>j&&(U={type:"atxHeadingText",start:O[j][1].start,end:O[q][1].end},G={type:"chunkText",start:O[j][1].start,end:O[q][1].end,contentType:"text"},splice(O,j,q-j+1,[["enter",U,B],["enter",G,B],["exit",G,B],["exit",U,B]]));return O}};const Xp={name:"setextUnderline",tokenize:function(O,B,U){const G=this;let q,j,W=G.events.length;for(;W--;)if("lineEnding"!==G.events[W][1].type&&"linePrefix"!==G.events[W][1].type&&"content"!==G.events[W][1].type){j="paragraph"===G.events[W][1].type;break}return function(B){if(!G.parser.lazy[G.now().line]&&(G.interrupt||j))return O.enter("setextHeadingLine"),O.enter("setextHeadingLineSequence"),q=B,closingSequence(B);return U(B)};function closingSequence(B){return B===q?(O.consume(B),closingSequence):(O.exit("setextHeadingLineSequence"),factorySpace(O,closingSequenceEnd,"lineSuffix")(B))}function closingSequenceEnd(G){return null===G||markdownLineEnding(G)?(O.exit("setextHeadingLine"),B(G)):U(G)}},resolveTo:function(O,B){let U,G,q,j=O.length;for(;j--;)if("enter"===O[j][0]){if("content"===O[j][1].type){U=j;break}"paragraph"===O[j][1].type&&(G=j)}else"content"===O[j][1].type&&O.splice(j,1),q||"definition"!==O[j][1].type||(q=j);const W={type:"setextHeading",start:Object.assign({},O[G][1].start),end:Object.assign({},O[O.length-1][1].end)};O[G][1].type="setextHeadingText",q?(O.splice(G,0,["enter",W,B]),O.splice(q+1,0,["exit",O[U][1],B]),O[U][1].end=Object.assign({},O[q][1].end)):O[U][1]=W;return O.push(["exit",W,B]),O}};const Jp=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],eu=["pre","script","style","textarea"],tu={name:"htmlFlow",tokenize:function(O,B,U){const G=this;let q,j,W,Y,K;return function(B){return O.enter("htmlFlow"),O.enter("htmlFlowData"),O.consume(B),open};function open(Y){return 33===Y?(O.consume(Y),declarationStart):47===Y?(O.consume(Y),tagCloseStart):63===Y?(O.consume(Y),q=3,G.interrupt?B:continuationDeclarationInside):xp(Y)?(O.consume(Y),W=String.fromCharCode(Y),j=!0,tagName):U(Y)}function declarationStart(j){return 45===j?(O.consume(j),q=2,commentOpenInside):91===j?(O.consume(j),q=5,W="CDATA[",Y=0,cdataOpenInside):xp(j)?(O.consume(j),q=4,G.interrupt?B:continuationDeclarationInside):U(j)}function commentOpenInside(q){return 45===q?(O.consume(q),G.interrupt?B:continuationDeclarationInside):U(q)}function cdataOpenInside(q){return q===W.charCodeAt(Y++)?(O.consume(q),Y===W.length?G.interrupt?B:continuation:cdataOpenInside):U(q)}function tagCloseStart(B){return xp(B)?(O.consume(B),W=String.fromCharCode(B),tagName):U(B)}function tagName(Y){return null===Y||47===Y||62===Y||markdownLineEndingOrSpace(Y)?47!==Y&&j&&eu.includes(W.toLowerCase())?(q=1,G.interrupt?B(Y):continuation(Y)):Jp.includes(W.toLowerCase())?(q=6,47===Y?(O.consume(Y),basicSelfClosing):G.interrupt?B(Y):continuation(Y)):(q=7,G.interrupt&&!G.parser.lazy[G.now().line]?U(Y):j?completeAttributeNameBefore(Y):completeClosingTagAfter(Y)):45===Y||kp(Y)?(O.consume(Y),W+=String.fromCharCode(Y),tagName):U(Y)}function basicSelfClosing(q){return 62===q?(O.consume(q),G.interrupt?B:continuation):U(q)}function completeClosingTagAfter(B){return markdownSpace(B)?(O.consume(B),completeClosingTagAfter):completeEnd(B)}function completeAttributeNameBefore(B){return 47===B?(O.consume(B),completeEnd):58===B||95===B||xp(B)?(O.consume(B),completeAttributeName):markdownSpace(B)?(O.consume(B),completeAttributeNameBefore):completeEnd(B)}function completeAttributeName(B){return 45===B||46===B||58===B||95===B||kp(B)?(O.consume(B),completeAttributeName):completeAttributeNameAfter(B)}function completeAttributeNameAfter(B){return 61===B?(O.consume(B),completeAttributeValueBefore):markdownSpace(B)?(O.consume(B),completeAttributeNameAfter):completeAttributeNameBefore(B)}function completeAttributeValueBefore(B){return null===B||60===B||61===B||62===B||96===B?U(B):34===B||39===B?(O.consume(B),K=B,completeAttributeValueQuoted):markdownSpace(B)?(O.consume(B),completeAttributeValueBefore):(K=null,completeAttributeValueUnquoted(B))}function completeAttributeValueQuoted(B){return null===B||markdownLineEnding(B)?U(B):B===K?(O.consume(B),completeAttributeValueQuotedAfter):(O.consume(B),completeAttributeValueQuoted)}function completeAttributeValueUnquoted(B){return null===B||34===B||39===B||60===B||61===B||62===B||96===B||markdownLineEndingOrSpace(B)?completeAttributeNameAfter(B):(O.consume(B),completeAttributeValueUnquoted)}function completeAttributeValueQuotedAfter(O){return 47===O||62===O||markdownSpace(O)?completeAttributeNameBefore(O):U(O)}function completeEnd(B){return 62===B?(O.consume(B),completeAfter):U(B)}function completeAfter(B){return markdownSpace(B)?(O.consume(B),completeAfter):null===B||markdownLineEnding(B)?continuation(B):U(B)}function continuation(B){return 45===B&&2===q?(O.consume(B),continuationCommentInside):60===B&&1===q?(O.consume(B),continuationRawTagOpen):62===B&&4===q?(O.consume(B),continuationClose):63===B&&3===q?(O.consume(B),continuationDeclarationInside):93===B&&5===q?(O.consume(B),continuationCharacterDataInside):!markdownLineEnding(B)||6!==q&&7!==q?null===B||markdownLineEnding(B)?continuationAtLineEnding(B):(O.consume(B),continuation):O.check(iu,continuationClose,continuationAtLineEnding)(B)}function continuationAtLineEnding(B){return O.exit("htmlFlowData"),htmlContinueStart(B)}function htmlContinueStart(B){return null===B?done(B):markdownLineEnding(B)?O.attempt({tokenize:htmlLineEnd,partial:!0},htmlContinueStart,done)(B):(O.enter("htmlFlowData"),continuation(B))}function htmlLineEnd(O,B,U){return function(B){return O.enter("lineEnding"),O.consume(B),O.exit("lineEnding"),lineStart};function lineStart(O){return G.parser.lazy[G.now().line]?U(O):B(O)}}function continuationCommentInside(B){return 45===B?(O.consume(B),continuationDeclarationInside):continuation(B)}function continuationRawTagOpen(B){return 47===B?(O.consume(B),W="",continuationRawEndTag):continuation(B)}function continuationRawEndTag(B){return 62===B&&eu.includes(W.toLowerCase())?(O.consume(B),continuationClose):xp(B)&&W.length<8?(O.consume(B),W+=String.fromCharCode(B),continuationRawEndTag):continuation(B)}function continuationCharacterDataInside(B){return 93===B?(O.consume(B),continuationDeclarationInside):continuation(B)}function continuationDeclarationInside(B){return 62===B?(O.consume(B),continuationClose):45===B&&2===q?(O.consume(B),continuationDeclarationInside):continuation(B)}function continuationClose(B){return null===B||markdownLineEnding(B)?(O.exit("htmlFlowData"),done(B)):(O.consume(B),continuationClose)}function done(U){return O.exit("htmlFlow"),B(U)}},resolveTo:function(O){let B=O.length;for(;B--&&("enter"!==O[B][0]||"htmlFlow"!==O[B][1].type););B>1&&"linePrefix"===O[B-2][1].type&&(O[B][1].start=O[B-2][1].start,O[B+1][1].start=O[B-2][1].start,O.splice(B-2,2));return O},concrete:!0},iu={tokenize:function(O,B,U){return function(G){return O.exit("htmlFlowData"),O.enter("lineEndingBlank"),O.consume(G),O.exit("lineEndingBlank"),O.attempt(Dp,B,U)}},partial:!0};const ru={name:"codeFenced",tokenize:function(O,B,U){const G=this,q={tokenize:function(O,B,U){let G=0;return factorySpace(O,closingSequenceStart,"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function closingSequenceStart(B){return O.enter("codeFencedFence"),O.enter("codeFencedFenceSequence"),closingSequence(B)}function closingSequence(B){return B===K?(O.consume(B),G++,closingSequence):G<Q?U(B):(O.exit("codeFencedFenceSequence"),factorySpace(O,closingSequenceEnd,"whitespace")(B))}function closingSequenceEnd(G){return null===G||markdownLineEnding(G)?(O.exit("codeFencedFence"),B(G)):U(G)}},partial:!0},j={tokenize:function(O,B,U){const G=this;return start;function start(B){return O.enter("lineEnding"),O.consume(B),O.exit("lineEnding"),lineStart}function lineStart(O){return G.parser.lazy[G.now().line]?U(O):B(O)}},partial:!0},W=this.events[this.events.length-1],Y=W&&"linePrefix"===W[1].type?W[2].sliceSerialize(W[1],!0).length:0;let K,Q=0;return function(B){return O.enter("codeFenced"),O.enter("codeFencedFence"),O.enter("codeFencedFenceSequence"),K=B,sequenceOpen(B)};function sequenceOpen(B){return B===K?(O.consume(B),Q++,sequenceOpen):(O.exit("codeFencedFenceSequence"),Q<3?U(B):factorySpace(O,infoOpen,"whitespace")(B))}function infoOpen(B){return null===B||markdownLineEnding(B)?openAfter(B):(O.enter("codeFencedFenceInfo"),O.enter("chunkString",{contentType:"string"}),info(B))}function info(B){return null===B||markdownLineEndingOrSpace(B)?(O.exit("chunkString"),O.exit("codeFencedFenceInfo"),factorySpace(O,infoAfter,"whitespace")(B)):96===B&&B===K?U(B):(O.consume(B),info)}function infoAfter(B){return null===B||markdownLineEnding(B)?openAfter(B):(O.enter("codeFencedFenceMeta"),O.enter("chunkString",{contentType:"string"}),meta(B))}function meta(B){return null===B||markdownLineEnding(B)?(O.exit("chunkString"),O.exit("codeFencedFenceMeta"),openAfter(B)):96===B&&B===K?U(B):(O.consume(B),meta)}function openAfter(U){return O.exit("codeFencedFence"),G.interrupt?B(U):contentStart(U)}function contentStart(B){return null===B?after(B):markdownLineEnding(B)?O.attempt(j,O.attempt(q,after,Y?factorySpace(O,contentStart,"linePrefix",Y+1):contentStart),after)(B):(O.enter("codeFlowValue"),contentContinue(B))}function contentContinue(B){return null===B||markdownLineEnding(B)?(O.exit("codeFlowValue"),contentStart(B)):(O.consume(B),contentContinue)}function after(U){return O.exit("codeFenced"),B(U)}},concrete:!0};const nu=document.createElement("i");function decodeNamedCharacterReference(O){const B="&"+O+";";nu.innerHTML=B;const U=nu.textContent;return(59!==U.charCodeAt(U.length-1)||"semi"===O)&&(U!==B&&U)}const ou={name:"characterReference",tokenize:function(O,B,U){const G=this;let q,j,W=0;return function(B){return O.enter("characterReference"),O.enter("characterReferenceMarker"),O.consume(B),O.exit("characterReferenceMarker"),open};function open(B){return 35===B?(O.enter("characterReferenceMarkerNumeric"),O.consume(B),O.exit("characterReferenceMarkerNumeric"),numeric):(O.enter("characterReferenceValue"),q=31,j=kp,value(B))}function numeric(B){return 88===B||120===B?(O.enter("characterReferenceMarkerHexadecimal"),O.consume(B),O.exit("characterReferenceMarkerHexadecimal"),O.enter("characterReferenceValue"),q=6,j=wp,value):(O.enter("characterReferenceValue"),q=7,j=Tp,value(B))}function value(Y){let K;return 59===Y&&W?(K=O.exit("characterReferenceValue"),j!==kp||decodeNamedCharacterReference(G.sliceSerialize(K))?(O.enter("characterReferenceMarker"),O.consume(Y),O.exit("characterReferenceMarker"),O.exit("characterReference"),B):U(Y)):j(Y)&&W++<q?(O.consume(Y),value):U(Y)}}};const au={name:"characterEscape",tokenize:function(O,B,U){return function(B){return O.enter("characterEscape"),O.enter("escapeMarker"),O.consume(B),O.exit("escapeMarker"),open};function open(G){return Ap(G)?(O.enter("characterEscapeValue"),O.consume(G),O.exit("characterEscapeValue"),O.exit("characterEscape"),B):U(G)}}};const su={name:"lineEnding",tokenize:function(O,B){return function(U){return O.enter("lineEnding"),O.consume(U),O.exit("lineEnding"),factorySpace(O,B,"linePrefix")}}};const lu={name:"labelEnd",tokenize:function(O,B,U){const G=this;let q,j,W=G.events.length;for(;W--;)if(("labelImage"===G.events[W][1].type||"labelLink"===G.events[W][1].type)&&!G.events[W][1]._balanced){q=G.events[W][1];break}return function(B){if(!q)return U(B);return q._inactive?balanced(B):(j=G.parser.defined.includes(normalizeIdentifier(G.sliceSerialize({start:q.end,end:G.now()}))),O.enter("labelEnd"),O.enter("labelMarker"),O.consume(B),O.exit("labelMarker"),O.exit("labelEnd"),afterLabelEnd)};function afterLabelEnd(U){return 40===U?O.attempt(cu,B,j?B:balanced)(U):91===U?O.attempt(du,B,j?O.attempt(pu,B,balanced):balanced)(U):j?B(U):balanced(U)}function balanced(O){return q._balanced=!0,U(O)}},resolveTo:function(O,B){let U,G,q,j,W=O.length,Y=0;for(;W--;)if(U=O[W][1],G){if("link"===U.type||"labelLink"===U.type&&U._inactive)break;"enter"===O[W][0]&&"labelLink"===U.type&&(U._inactive=!0)}else if(q){if("enter"===O[W][0]&&("labelImage"===U.type||"labelLink"===U.type)&&!U._balanced&&(G=W,"labelLink"!==U.type)){Y=2;break}}else"labelEnd"===U.type&&(q=W);const K={type:"labelLink"===O[G][1].type?"link":"image",start:Object.assign({},O[G][1].start),end:Object.assign({},O[O.length-1][1].end)},Q={type:"label",start:Object.assign({},O[G][1].start),end:Object.assign({},O[q][1].end)},Z={type:"labelText",start:Object.assign({},O[G+Y+2][1].end),end:Object.assign({},O[q-2][1].start)};return j=[["enter",K,B],["enter",Q,B]],j=push(j,O.slice(G+1,G+Y+3)),j=push(j,[["enter",Z,B]]),j=push(j,resolveAll(B.parser.constructs.insideSpan.null,O.slice(G+Y+4,q-3),B)),j=push(j,[["exit",Z,B],O[q-2],O[q-1],["exit",Q,B]]),j=push(j,O.slice(q+1)),j=push(j,[["exit",K,B]]),splice(O,G,O.length,j),O},resolveAll:function(O){let B,U=-1;for(;++U<O.length;)B=O[U][1],"labelImage"!==B.type&&"labelLink"!==B.type&&"labelEnd"!==B.type||(O.splice(U+1,"labelImage"===B.type?4:2),B.type="data",U++);return O}},cu={tokenize:function(O,B,U){return function(B){return O.enter("resource"),O.enter("resourceMarker"),O.consume(B),O.exit("resourceMarker"),factoryWhitespace(O,open)};function open(B){return 41===B?end(B):factoryDestination(O,destinationAfter,U,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(B)}function destinationAfter(B){return markdownLineEndingOrSpace(B)?factoryWhitespace(O,between)(B):end(B)}function between(B){return 34===B||39===B||40===B?factoryTitle(O,factoryWhitespace(O,end),U,"resourceTitle","resourceTitleMarker","resourceTitleString")(B):end(B)}function end(G){return 41===G?(O.enter("resourceMarker"),O.consume(G),O.exit("resourceMarker"),O.exit("resource"),B):U(G)}}},du={tokenize:function(O,B,U){const G=this;return function(B){return factoryLabel.call(G,O,afterLabel,U,"reference","referenceMarker","referenceString")(B)};function afterLabel(O){return G.parser.defined.includes(normalizeIdentifier(G.sliceSerialize(G.events[G.events.length-1][1]).slice(1,-1)))?B(O):U(O)}}},pu={tokenize:function(O,B,U){return function(B){return O.enter("reference"),O.enter("referenceMarker"),O.consume(B),O.exit("referenceMarker"),open};function open(G){return 93===G?(O.enter("referenceMarker"),O.consume(G),O.exit("referenceMarker"),O.exit("reference"),B):U(G)}}};const uu={name:"labelStartImage",tokenize:function(O,B,U){const G=this;return function(B){return O.enter("labelImage"),O.enter("labelImageMarker"),O.consume(B),O.exit("labelImageMarker"),open};function open(B){return 91===B?(O.enter("labelMarker"),O.consume(B),O.exit("labelMarker"),O.exit("labelImage"),after):U(B)}function after(O){return 94===O&&"_hiddenFootnoteSupport"in G.parser.constructs?U(O):B(O)}},resolveAll:lu.resolveAll};function classifyCharacter(O){return null===O||markdownLineEndingOrSpace(O)||Ip(O)?1:Pp(O)?2:void 0}const hu={name:"attention",tokenize:function(O,B){const U=this.parser.constructs.attentionMarkers.null,G=this.previous,q=classifyCharacter(G);let j;return function(B){return O.enter("attentionSequence"),j=B,sequence(B)};function sequence(W){if(W===j)return O.consume(W),sequence;const Y=O.exit("attentionSequence"),K=classifyCharacter(W),Q=!K||2===K&&q||U.includes(W),Z=!q||2===q&&K||U.includes(G);return Y._open=Boolean(42===j?Q:Q&&(q||!Z)),Y._close=Boolean(42===j?Z:Z&&(K||!Q)),B(W)}},resolveAll:function(O,B){let U,G,q,j,W,Y,K,Q,Z=-1;for(;++Z<O.length;)if("enter"===O[Z][0]&&"attentionSequence"===O[Z][1].type&&O[Z][1]._close)for(U=Z;U--;)if("exit"===O[U][0]&&"attentionSequence"===O[U][1].type&&O[U][1]._open&&B.sliceSerialize(O[U][1]).charCodeAt(0)===B.sliceSerialize(O[Z][1]).charCodeAt(0)){if((O[U][1]._close||O[Z][1]._open)&&(O[Z][1].end.offset-O[Z][1].start.offset)%3&&!((O[U][1].end.offset-O[U][1].start.offset+O[Z][1].end.offset-O[Z][1].start.offset)%3))continue;Y=O[U][1].end.offset-O[U][1].start.offset>1&&O[Z][1].end.offset-O[Z][1].start.offset>1?2:1;const X=Object.assign({},O[U][1].end),J=Object.assign({},O[Z][1].start);movePoint(X,-Y),movePoint(J,Y),j={type:Y>1?"strongSequence":"emphasisSequence",start:X,end:Object.assign({},O[U][1].end)},W={type:Y>1?"strongSequence":"emphasisSequence",start:Object.assign({},O[Z][1].start),end:J},q={type:Y>1?"strongText":"emphasisText",start:Object.assign({},O[U][1].end),end:Object.assign({},O[Z][1].start)},G={type:Y>1?"strong":"emphasis",start:Object.assign({},j.start),end:Object.assign({},W.end)},O[U][1].end=Object.assign({},j.start),O[Z][1].start=Object.assign({},W.end),K=[],O[U][1].end.offset-O[U][1].start.offset&&(K=push(K,[["enter",O[U][1],B],["exit",O[U][1],B]])),K=push(K,[["enter",G,B],["enter",j,B],["exit",j,B],["enter",q,B]]),K=push(K,resolveAll(B.parser.constructs.insideSpan.null,O.slice(U+1,Z),B)),K=push(K,[["exit",q,B],["enter",W,B],["exit",W,B],["exit",G,B]]),O[Z][1].end.offset-O[Z][1].start.offset?(Q=2,K=push(K,[["enter",O[Z][1],B],["exit",O[Z][1],B]])):Q=0,splice(O,U-1,Z-U+3,K),Z=U+K.length-Q-2;break}Z=-1;for(;++Z<O.length;)"attentionSequence"===O[Z][1].type&&(O[Z][1].type="data");return O}};function movePoint(O,B){O.column+=B,O.offset+=B,O._bufferIndex+=B}const mu={name:"autolink",tokenize:function(O,B,U){let G=1;return function(B){return O.enter("autolink"),O.enter("autolinkMarker"),O.consume(B),O.exit("autolinkMarker"),O.enter("autolinkProtocol"),open};function open(B){return xp(B)?(O.consume(B),schemeOrEmailAtext):Rp(B)?emailAtext(B):U(B)}function schemeOrEmailAtext(O){return 43===O||45===O||46===O||kp(O)?schemeInsideOrEmailAtext(O):emailAtext(O)}function schemeInsideOrEmailAtext(B){return 58===B?(O.consume(B),urlInside):(43===B||45===B||46===B||kp(B))&&G++<32?(O.consume(B),schemeInsideOrEmailAtext):emailAtext(B)}function urlInside(B){return 62===B?(O.exit("autolinkProtocol"),end(B)):null===B||32===B||60===B||asciiControl(B)?U(B):(O.consume(B),urlInside)}function emailAtext(B){return 64===B?(O.consume(B),G=0,emailAtSignOrDot):Rp(B)?(O.consume(B),emailAtext):U(B)}function emailAtSignOrDot(O){return kp(O)?emailLabel(O):U(O)}function emailLabel(B){return 46===B?(O.consume(B),G=0,emailAtSignOrDot):62===B?(O.exit("autolinkProtocol").type="autolinkEmail",end(B)):emailValue(B)}function emailValue(B){return(45===B||kp(B))&&G++<63?(O.consume(B),45===B?emailValue:emailLabel):U(B)}function end(U){return O.enter("autolinkMarker"),O.consume(U),O.exit("autolinkMarker"),O.exit("autolink"),B}}};const gu={name:"htmlText",tokenize:function(O,B,U){const G=this;let q,j,W,Y;return function(B){return O.enter("htmlText"),O.enter("htmlTextData"),O.consume(B),open};function open(B){return 33===B?(O.consume(B),declarationOpen):47===B?(O.consume(B),tagCloseStart):63===B?(O.consume(B),instruction):xp(B)?(O.consume(B),tagOpen):U(B)}function declarationOpen(B){return 45===B?(O.consume(B),commentOpen):91===B?(O.consume(B),j="CDATA[",W=0,cdataOpen):xp(B)?(O.consume(B),declaration):U(B)}function commentOpen(B){return 45===B?(O.consume(B),commentStart):U(B)}function commentStart(B){return null===B||62===B?U(B):45===B?(O.consume(B),commentStartDash):comment(B)}function commentStartDash(O){return null===O||62===O?U(O):comment(O)}function comment(B){return null===B?U(B):45===B?(O.consume(B),commentClose):markdownLineEnding(B)?(Y=comment,atLineEnding(B)):(O.consume(B),comment)}function commentClose(B){return 45===B?(O.consume(B),end):comment(B)}function cdataOpen(B){return B===j.charCodeAt(W++)?(O.consume(B),W===j.length?cdata:cdataOpen):U(B)}function cdata(B){return null===B?U(B):93===B?(O.consume(B),cdataClose):markdownLineEnding(B)?(Y=cdata,atLineEnding(B)):(O.consume(B),cdata)}function cdataClose(B){return 93===B?(O.consume(B),cdataEnd):cdata(B)}function cdataEnd(B){return 62===B?end(B):93===B?(O.consume(B),cdataEnd):cdata(B)}function declaration(B){return null===B||62===B?end(B):markdownLineEnding(B)?(Y=declaration,atLineEnding(B)):(O.consume(B),declaration)}function instruction(B){return null===B?U(B):63===B?(O.consume(B),instructionClose):markdownLineEnding(B)?(Y=instruction,atLineEnding(B)):(O.consume(B),instruction)}function instructionClose(O){return 62===O?end(O):instruction(O)}function tagCloseStart(B){return xp(B)?(O.consume(B),tagClose):U(B)}function tagClose(B){return 45===B||kp(B)?(O.consume(B),tagClose):tagCloseBetween(B)}function tagCloseBetween(B){return markdownLineEnding(B)?(Y=tagCloseBetween,atLineEnding(B)):markdownSpace(B)?(O.consume(B),tagCloseBetween):end(B)}function tagOpen(B){return 45===B||kp(B)?(O.consume(B),tagOpen):47===B||62===B||markdownLineEndingOrSpace(B)?tagOpenBetween(B):U(B)}function tagOpenBetween(B){return 47===B?(O.consume(B),end):58===B||95===B||xp(B)?(O.consume(B),tagOpenAttributeName):markdownLineEnding(B)?(Y=tagOpenBetween,atLineEnding(B)):markdownSpace(B)?(O.consume(B),tagOpenBetween):end(B)}function tagOpenAttributeName(B){return 45===B||46===B||58===B||95===B||kp(B)?(O.consume(B),tagOpenAttributeName):tagOpenAttributeNameAfter(B)}function tagOpenAttributeNameAfter(B){return 61===B?(O.consume(B),tagOpenAttributeValueBefore):markdownLineEnding(B)?(Y=tagOpenAttributeNameAfter,atLineEnding(B)):markdownSpace(B)?(O.consume(B),tagOpenAttributeNameAfter):tagOpenBetween(B)}function tagOpenAttributeValueBefore(B){return null===B||60===B||61===B||62===B||96===B?U(B):34===B||39===B?(O.consume(B),q=B,tagOpenAttributeValueQuoted):markdownLineEnding(B)?(Y=tagOpenAttributeValueBefore,atLineEnding(B)):markdownSpace(B)?(O.consume(B),tagOpenAttributeValueBefore):(O.consume(B),q=void 0,tagOpenAttributeValueUnquoted)}function tagOpenAttributeValueQuoted(B){return B===q?(O.consume(B),tagOpenAttributeValueQuotedAfter):null===B?U(B):markdownLineEnding(B)?(Y=tagOpenAttributeValueQuoted,atLineEnding(B)):(O.consume(B),tagOpenAttributeValueQuoted)}function tagOpenAttributeValueQuotedAfter(O){return 62===O||47===O||markdownLineEndingOrSpace(O)?tagOpenBetween(O):U(O)}function tagOpenAttributeValueUnquoted(B){return null===B||34===B||39===B||60===B||61===B||96===B?U(B):62===B||markdownLineEndingOrSpace(B)?tagOpenBetween(B):(O.consume(B),tagOpenAttributeValueUnquoted)}function atLineEnding(B){return O.exit("htmlTextData"),O.enter("lineEnding"),O.consume(B),O.exit("lineEnding"),factorySpace(O,afterPrefix,"linePrefix",G.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function afterPrefix(B){return O.enter("htmlTextData"),Y(B)}function end(G){return 62===G?(O.consume(G),O.exit("htmlTextData"),O.exit("htmlText"),B):U(G)}}};const fu={name:"labelStartLink",tokenize:function(O,B,U){const G=this;return function(B){return O.enter("labelLink"),O.enter("labelMarker"),O.consume(B),O.exit("labelMarker"),O.exit("labelLink"),after};function after(O){return 94===O&&"_hiddenFootnoteSupport"in G.parser.constructs?U(O):B(O)}},resolveAll:lu.resolveAll};const yu={name:"codeText",tokenize:function(O,B,U){let G,q,j=0;return function(B){return O.enter("codeText"),O.enter("codeTextSequence"),openingSequence(B)};function openingSequence(B){return 96===B?(O.consume(B),j++,openingSequence):(O.exit("codeTextSequence"),gap(B))}function gap(B){return null===B?U(B):96===B?(q=O.enter("codeTextSequence"),G=0,closingSequence(B)):32===B?(O.enter("space"),O.consume(B),O.exit("space"),gap):markdownLineEnding(B)?(O.enter("lineEnding"),O.consume(B),O.exit("lineEnding"),gap):(O.enter("codeTextData"),data(B))}function data(B){return null===B||32===B||96===B||markdownLineEnding(B)?(O.exit("codeTextData"),gap(B)):(O.consume(B),data)}function closingSequence(U){return 96===U?(O.consume(U),G++,closingSequence):G===j?(O.exit("codeTextSequence"),O.exit("codeText"),B(U)):(q.type="codeTextData",data(U))}},resolve:function(O){let B,U,G=O.length-4,q=3;if(!("lineEnding"!==O[q][1].type&&"space"!==O[q][1].type||"lineEnding"!==O[G][1].type&&"space"!==O[G][1].type))for(B=q;++B<G;)if("codeTextData"===O[B][1].type){O[q][1].type="codeTextPadding",O[G][1].type="codeTextPadding",q+=2,G-=2;break}B=q-1,G++;for(;++B<=G;)void 0===U?B!==G&&"lineEnding"!==O[B][1].type&&(U=B):B!==G&&"lineEnding"!==O[B][1].type||(O[U][1].type="codeTextData",B!==U+2&&(O[U][1].end=O[B-1][1].end,O.splice(U+2,B-U-2),G-=B-U-2,B=U+2),U=void 0);return O},previous:function(O){return 96!==O||"characterEscape"===this.events[this.events.length-1][1].type}};const _u={42:Gp,43:Gp,45:Gp,48:Gp,49:Gp,50:Gp,51:Gp,52:Gp,53:Gp,54:Gp,55:Gp,56:Gp,57:Gp,62:jp},vu={91:Wp},bu={[-2]:Kp,[-1]:Kp,32:Kp},Su={35:Zp,42:Vp,45:[Xp,Vp],60:tu,61:Xp,95:Vp,96:ru,126:ru},Cu={38:ou,92:au},Eu={[-5]:su,[-4]:su,[-3]:su,33:uu,38:ou,42:hu,60:[mu,gu],91:fu,92:[{name:"hardBreakEscape",tokenize:function(O,B,U){return function(B){return O.enter("hardBreakEscape"),O.enter("escapeMarker"),O.consume(B),open};function open(G){return markdownLineEnding(G)?(O.exit("escapeMarker"),O.exit("hardBreakEscape"),B(G)):U(G)}}},au],93:lu,95:hu,96:yu},xu={null:[hu,zp]},Tu={null:[42,95]},wu={null:[]};function parse_parse(O={}){const B=function(O){const B={};let U=-1;for(;++U<O.length;)syntaxExtension(B,O[U]);return B}([K].concat(O.extensions||[])),U={defined:[],lazy:{},constructs:B,content:create(Np),document:create(Op),flow:create(Fp),string:create($p),text:create(Up)};return U;function create(O){return function(B){return createTokenizer(U,O,B)}}}const ku=/[\0\t\n\r]/g;function decodeNumericCharacterReference(O,B){const U=Number.parseInt(O,B);return U<9||11===U||U>13&&U<32||U>126&&U<160||U>55295&&U<57344||U>64975&&U<65008||65535==(65535&U)||65534==(65535&U)||U>1114111?"":String.fromCharCode(U)}const Au=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function decode(O,B,U){if(B)return B;if(35===U.charCodeAt(0)){const O=U.charCodeAt(1),B=120===O||88===O;return decodeNumericCharacterReference(U.slice(B?2:1),B?16:10)}return decodeNamedCharacterReference(U)||O}function stringifyPosition(O){return O&&"object"==typeof O?"position"in O||"type"in O?lib_position(O.position):"start"in O||"end"in O?lib_position(O):"line"in O||"column"in O?point(O):"":""}function point(O){return index(O&&O.line)+":"+index(O&&O.column)}function lib_position(O){return point(O&&O.start)+"-"+point(O&&O.end)}function index(O){return O&&"number"==typeof O?O:1}const Ru={}.hasOwnProperty,fromMarkdown=function(O,B,U){return"string"!=typeof B&&(U=B,B=void 0),function(O){const B={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:opener(link),autolinkProtocol:onenterdata,autolinkEmail:onenterdata,atxHeading:opener(heading),blockQuote:opener(blockQuote),characterEscape:onenterdata,characterReference:onenterdata,codeFenced:opener(codeFlow),codeFencedFenceInfo:buffer,codeFencedFenceMeta:buffer,codeIndented:opener(codeFlow,buffer),codeText:opener(codeText,buffer),codeTextData:onenterdata,data:onenterdata,codeFlowValue:onenterdata,definition:opener(definition),definitionDestinationString:buffer,definitionLabelString:buffer,definitionTitleString:buffer,emphasis:opener(emphasis),hardBreakEscape:opener(hardBreak),hardBreakTrailing:opener(hardBreak),htmlFlow:opener(html,buffer),htmlFlowData:onenterdata,htmlText:opener(html,buffer),htmlTextData:onenterdata,image:opener(image),label:buffer,link:opener(link),listItem:opener(listItem),listItemValue:onenterlistitemvalue,listOrdered:opener(list,onenterlistordered),listUnordered:opener(list),paragraph:opener(paragraph),reference:onenterreference,referenceString:buffer,resourceDestinationString:buffer,resourceTitleString:buffer,setextHeading:opener(heading),strong:opener(strong),thematicBreak:opener(thematicBreak)},exit:{atxHeading:closer(),atxHeadingSequence:onexitatxheadingsequence,autolink:closer(),autolinkEmail:onexitautolinkemail,autolinkProtocol:onexitautolinkprotocol,blockQuote:closer(),characterEscapeValue:onexitdata,characterReferenceMarkerHexadecimal:onexitcharacterreferencemarker,characterReferenceMarkerNumeric:onexitcharacterreferencemarker,characterReferenceValue:onexitcharacterreferencevalue,codeFenced:closer(onexitcodefenced),codeFencedFence:onexitcodefencedfence,codeFencedFenceInfo:onexitcodefencedfenceinfo,codeFencedFenceMeta:onexitcodefencedfencemeta,codeFlowValue:onexitdata,codeIndented:closer(onexitcodeindented),codeText:closer(onexitcodetext),codeTextData:onexitdata,data:onexitdata,definition:closer(),definitionDestinationString:onexitdefinitiondestinationstring,definitionLabelString:onexitdefinitionlabelstring,definitionTitleString:onexitdefinitiontitlestring,emphasis:closer(),hardBreakEscape:closer(onexithardbreak),hardBreakTrailing:closer(onexithardbreak),htmlFlow:closer(onexithtmlflow),htmlFlowData:onexitdata,htmlText:closer(onexithtmltext),htmlTextData:onexitdata,image:closer(onexitimage),label:onexitlabel,labelText:onexitlabeltext,lineEnding:onexitlineending,link:closer(onexitlink),listItem:closer(),listOrdered:closer(),listUnordered:closer(),paragraph:closer(),referenceString:onexitreferencestring,resourceDestinationString:onexitresourcedestinationstring,resourceTitleString:onexitresourcetitlestring,resource:onexitresource,setextHeading:closer(onexitsetextheading),setextHeadingLineSequence:onexitsetextheadinglinesequence,setextHeadingText:onexitsetextheadingtext,strong:closer(),thematicBreak:closer()}};configure(B,(O||{}).mdastExtensions||[]);const U={};return compile;function compile(O){let U={type:"root",children:[]};const G={stack:[U],tokenStack:[],config:B,enter,exit,buffer,resume,setData,getData},q=[];let j=-1;for(;++j<O.length;)if("listOrdered"===O[j][1].type||"listUnordered"===O[j][1].type)if("enter"===O[j][0])q.push(j);else{j=prepareList(O,q.pop(),j)}for(j=-1;++j<O.length;){const U=B[O[j][0]];Ru.call(U,O[j][1].type)&&U[O[j][1].type].call(Object.assign({sliceSerialize:O[j][2].sliceSerialize},G),O[j][1])}if(G.tokenStack.length>0){const O=G.tokenStack[G.tokenStack.length-1];(O[1]||defaultOnError).call(G,void 0,O[0])}for(U.position={start:lib_point(O.length>0?O[0][1].start:{line:1,column:1,offset:0}),end:lib_point(O.length>0?O[O.length-2][1].end:{line:1,column:1,offset:0})},j=-1;++j<B.transforms.length;)U=B.transforms[j](U)||U;return U}function prepareList(O,B,U){let G,q,j,W,Y=B-1,K=-1,Q=!1;for(;++Y<=U;){const B=O[Y];if("listUnordered"===B[1].type||"listOrdered"===B[1].type||"blockQuote"===B[1].type?("enter"===B[0]?K++:K--,W=void 0):"lineEndingBlank"===B[1].type?"enter"===B[0]&&(!G||W||K||j||(j=Y),W=void 0):"linePrefix"===B[1].type||"listItemValue"===B[1].type||"listItemMarker"===B[1].type||"listItemPrefix"===B[1].type||"listItemPrefixWhitespace"===B[1].type||(W=void 0),!K&&"enter"===B[0]&&"listItemPrefix"===B[1].type||-1===K&&"exit"===B[0]&&("listUnordered"===B[1].type||"listOrdered"===B[1].type)){if(G){let W=Y;for(q=void 0;W--;){const B=O[W];if("lineEnding"===B[1].type||"lineEndingBlank"===B[1].type){if("exit"===B[0])continue;q&&(O[q][1].type="lineEndingBlank",Q=!0),B[1].type="lineEnding",q=W}else if("linePrefix"!==B[1].type&&"blockQuotePrefix"!==B[1].type&&"blockQuotePrefixWhitespace"!==B[1].type&&"blockQuoteMarker"!==B[1].type&&"listItemIndent"!==B[1].type)break}j&&(!q||j<q)&&(G._spread=!0),G.end=Object.assign({},q?O[q][1].start:B[1].end),O.splice(q||Y,0,["exit",G,B[2]]),Y++,U++}"listItemPrefix"===B[1].type&&(G={type:"listItem",_spread:!1,start:Object.assign({},B[1].start)},O.splice(Y,0,["enter",G,B[2]]),Y++,U++,j=void 0,W=!0)}}return O[B][1]._spread=Q,U}function setData(O,B){U[O]=B}function getData(O){return U[O]}function opener(O,B){return open;function open(U){enter.call(this,O(U),U),B&&B.call(this,U)}}function buffer(){this.stack.push({type:"fragment",children:[]})}function enter(O,B,U){return this.stack[this.stack.length-1].children.push(O),this.stack.push(O),this.tokenStack.push([B,U]),O.position={start:lib_point(B.start)},O}function closer(O){return close;function close(B){O&&O.call(this,B),exit.call(this,B)}}function exit(O,B){const U=this.stack.pop(),G=this.tokenStack.pop();if(!G)throw new Error("Cannot close `"+O.type+"` ("+stringifyPosition({start:O.start,end:O.end})+"): its not open");if(G[0].type!==O.type)if(B)B.call(this,O,G[0]);else{(G[1]||defaultOnError).call(this,O,G[0])}return U.position.end=lib_point(O.end),U}function resume(){return function(O,B){const U=B||Cp;return one(O,"boolean"!=typeof U.includeImageAlt||U.includeImageAlt,"boolean"!=typeof U.includeHtml||U.includeHtml)}(this.stack.pop())}function onenterlistordered(){setData("expectingFirstListItemValue",!0)}function onenterlistitemvalue(O){if(getData("expectingFirstListItemValue")){this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(O),10),setData("expectingFirstListItemValue")}}function onexitcodefencedfenceinfo(){const O=this.resume();this.stack[this.stack.length-1].lang=O}function onexitcodefencedfencemeta(){const O=this.resume();this.stack[this.stack.length-1].meta=O}function onexitcodefencedfence(){getData("flowCodeInside")||(this.buffer(),setData("flowCodeInside",!0))}function onexitcodefenced(){const O=this.resume();this.stack[this.stack.length-1].value=O.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),setData("flowCodeInside")}function onexitcodeindented(){const O=this.resume();this.stack[this.stack.length-1].value=O.replace(/(\r?\n|\r)$/g,"")}function onexitdefinitionlabelstring(O){const B=this.resume(),U=this.stack[this.stack.length-1];U.label=B,U.identifier=normalizeIdentifier(this.sliceSerialize(O)).toLowerCase()}function onexitdefinitiontitlestring(){const O=this.resume();this.stack[this.stack.length-1].title=O}function onexitdefinitiondestinationstring(){const O=this.resume();this.stack[this.stack.length-1].url=O}function onexitatxheadingsequence(O){const B=this.stack[this.stack.length-1];if(!B.depth){const U=this.sliceSerialize(O).length;B.depth=U}}function onexitsetextheadingtext(){setData("setextHeadingSlurpLineEnding",!0)}function onexitsetextheadinglinesequence(O){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(O).charCodeAt(0)?1:2}function onexitsetextheading(){setData("setextHeadingSlurpLineEnding")}function onenterdata(O){const B=this.stack[this.stack.length-1];let U=B.children[B.children.length-1];U&&"text"===U.type||(U=text(),U.position={start:lib_point(O.start)},B.children.push(U)),this.stack.push(U)}function onexitdata(O){const B=this.stack.pop();B.value+=this.sliceSerialize(O),B.position.end=lib_point(O.end)}function onexitlineending(O){const U=this.stack[this.stack.length-1];if(getData("atHardBreak")){return U.children[U.children.length-1].position.end=lib_point(O.end),void setData("atHardBreak")}!getData("setextHeadingSlurpLineEnding")&&B.canContainEols.includes(U.type)&&(onenterdata.call(this,O),onexitdata.call(this,O))}function onexithardbreak(){setData("atHardBreak",!0)}function onexithtmlflow(){const O=this.resume();this.stack[this.stack.length-1].value=O}function onexithtmltext(){const O=this.resume();this.stack[this.stack.length-1].value=O}function onexitcodetext(){const O=this.resume();this.stack[this.stack.length-1].value=O}function onexitlink(){const O=this.stack[this.stack.length-1];if(getData("inReference")){const B=getData("referenceType")||"shortcut";O.type+="Reference",O.referenceType=B,delete O.url,delete O.title}else delete O.identifier,delete O.label;setData("referenceType")}function onexitimage(){const O=this.stack[this.stack.length-1];if(getData("inReference")){const B=getData("referenceType")||"shortcut";O.type+="Reference",O.referenceType=B,delete O.url,delete O.title}else delete O.identifier,delete O.label;setData("referenceType")}function onexitlabeltext(O){const B=this.sliceSerialize(O),U=this.stack[this.stack.length-2];U.label=function(O){return O.replace(Au,decode)}(B),U.identifier=normalizeIdentifier(B).toLowerCase()}function onexitlabel(){const O=this.stack[this.stack.length-1],B=this.resume(),U=this.stack[this.stack.length-1];if(setData("inReference",!0),"link"===U.type){const B=O.children;U.children=B}else U.alt=B}function onexitresourcedestinationstring(){const O=this.resume();this.stack[this.stack.length-1].url=O}function onexitresourcetitlestring(){const O=this.resume();this.stack[this.stack.length-1].title=O}function onexitresource(){setData("inReference")}function onenterreference(){setData("referenceType","collapsed")}function onexitreferencestring(O){const B=this.resume(),U=this.stack[this.stack.length-1];U.label=B,U.identifier=normalizeIdentifier(this.sliceSerialize(O)).toLowerCase(),setData("referenceType","full")}function onexitcharacterreferencemarker(O){setData("characterReferenceType",O.type)}function onexitcharacterreferencevalue(O){const B=this.sliceSerialize(O),U=getData("characterReferenceType");let G;if(U)G=decodeNumericCharacterReference(B,"characterReferenceMarkerNumeric"===U?10:16),setData("characterReferenceType");else{G=decodeNamedCharacterReference(B)}const q=this.stack.pop();q.value+=G,q.position.end=lib_point(O.end)}function onexitautolinkprotocol(O){onexitdata.call(this,O);this.stack[this.stack.length-1].url=this.sliceSerialize(O)}function onexitautolinkemail(O){onexitdata.call(this,O);this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(O)}function blockQuote(){return{type:"blockquote",children:[]}}function codeFlow(){return{type:"code",lang:null,meta:null,value:""}}function codeText(){return{type:"inlineCode",value:""}}function definition(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function emphasis(){return{type:"emphasis",children:[]}}function heading(){return{type:"heading",depth:void 0,children:[]}}function hardBreak(){return{type:"break"}}function html(){return{type:"html",value:""}}function image(){return{type:"image",title:null,url:"",alt:null}}function link(){return{type:"link",title:null,url:"",children:[]}}function list(O){return{type:"list",ordered:"listOrdered"===O.type,start:null,spread:O._spread,children:[]}}function listItem(O){return{type:"listItem",spread:O._spread,checked:null,children:[]}}function paragraph(){return{type:"paragraph",children:[]}}function strong(){return{type:"strong",children:[]}}function text(){return{type:"text",value:""}}function thematicBreak(){return{type:"thematicBreak"}}}(U)(function(O){for(;!subtokenize(O););return O}(parse_parse(U).document().write(function(){let O,B=1,U="",G=!0;return function(q,j,W){const Y=[];let K,Q,Z,X,J;for(q=U+q.toString(j),Z=0,U="",G&&(65279===q.charCodeAt(0)&&Z++,G=void 0);Z<q.length;){if(ku.lastIndex=Z,K=ku.exec(q),X=K&&void 0!==K.index?K.index:q.length,J=q.charCodeAt(X),!K){U=q.slice(Z);break}if(10===J&&Z===X&&O)Y.push(-3),O=void 0;else switch(O&&(Y.push(-5),O=void 0),Z<X&&(Y.push(q.slice(Z,X)),B+=X-Z),J){case 0:Y.push(65533),B++;break;case 9:for(Q=4*Math.ceil(B/4),Y.push(-2);B++<Q;)Y.push(-1);break;case 10:Y.push(-4),B=1;break;default:O=!0,B=1}Z=X+1}return W&&(O&&Y.push(-5),U&&Y.push(U),Y.push(null)),Y}}()(O,B,!0))))};function lib_point(O){return{line:O.line,column:O.column,offset:O.offset}}function configure(O,B){let U=-1;for(;++U<B.length;){const G=B[U];Array.isArray(G)?configure(O,G):extension(O,G)}}function extension(O,B){let U;for(U in B)if(Ru.call(B,U))if("canContainEols"===U){const G=B[U];G&&O[U].push(...G)}else if("transforms"===U){const G=B[U];G&&O[U].push(...G)}else if("enter"===U||"exit"===U){const G=B[U];G&&Object.assign(O[U],G)}}function defaultOnError(O,B){throw O?new Error("Cannot close `"+O.type+"` ("+stringifyPosition({start:O.start,end:O.end})+"): a different token (`"+B.type+"`, "+stringifyPosition({start:B.start,end:B.end})+") is open"):new Error("Cannot close document, a token (`"+B.type+"`, "+stringifyPosition({start:B.start,end:B.end})+") is still open")}const Iu={flow:{null:{tokenize:function(O,B,U){const G=this,q=[];let j,W,Y=0;return function(B){if(O.enter("table")._align=q,O.enter("tableHead"),O.enter("tableRow"),124===B)return cellDividerHead(B);return Y++,O.enter("temporaryTableCellContent"),inCellContentHead(B)};function cellDividerHead(B){return O.enter("tableCellDivider"),O.consume(B),O.exit("tableCellDivider"),j=!0,cellBreakHead}function cellBreakHead(B){return null===B||markdownLineEnding(B)?function(B){if(null===B)return U(B);O.exit("tableRow"),O.exit("tableHead");const q=G.interrupt;return G.interrupt=!0,O.attempt({tokenize:tokenizeRowEnd,partial:!0},(function(B){return G.interrupt=q,O.enter("tableDelimiterRow"),atDelimiterRowBreak(B)}),(function(O){return G.interrupt=q,U(O)}))(B)}(B):markdownSpace(B)?(O.enter("whitespace"),O.consume(B),inWhitespaceHead):(j&&(j=void 0,Y++),124===B?cellDividerHead(B):(O.enter("temporaryTableCellContent"),inCellContentHead(B)))}function inWhitespaceHead(B){return markdownSpace(B)?(O.consume(B),inWhitespaceHead):(O.exit("whitespace"),cellBreakHead(B))}function inCellContentHead(B){return null===B||124===B||markdownLineEndingOrSpace(B)?(O.exit("temporaryTableCellContent"),cellBreakHead(B)):(O.consume(B),92===B?inCellContentEscapeHead:inCellContentHead)}function inCellContentEscapeHead(B){return 92===B||124===B?(O.consume(B),inCellContentHead):inCellContentHead(B)}function atDelimiterRowBreak(B){return null===B||markdownLineEnding(B)?rowEndDelimiter(B):markdownSpace(B)?(O.enter("whitespace"),O.consume(B),inWhitespaceDelimiter):45===B?(O.enter("tableDelimiterFiller"),O.consume(B),W=!0,q.push("none"),inFillerDelimiter):58===B?(O.enter("tableDelimiterAlignment"),O.consume(B),O.exit("tableDelimiterAlignment"),q.push("left"),afterLeftAlignment):124===B?(O.enter("tableCellDivider"),O.consume(B),O.exit("tableCellDivider"),atDelimiterRowBreak):U(B)}function inWhitespaceDelimiter(B){return markdownSpace(B)?(O.consume(B),inWhitespaceDelimiter):(O.exit("whitespace"),atDelimiterRowBreak(B))}function inFillerDelimiter(B){return 45===B?(O.consume(B),inFillerDelimiter):(O.exit("tableDelimiterFiller"),58===B?(O.enter("tableDelimiterAlignment"),O.consume(B),O.exit("tableDelimiterAlignment"),q[q.length-1]="left"===q[q.length-1]?"center":"right",afterRightAlignment):atDelimiterRowBreak(B))}function afterLeftAlignment(B){return 45===B?(O.enter("tableDelimiterFiller"),O.consume(B),W=!0,inFillerDelimiter):U(B)}function afterRightAlignment(B){return null===B||markdownLineEnding(B)?rowEndDelimiter(B):markdownSpace(B)?(O.enter("whitespace"),O.consume(B),inWhitespaceDelimiter):124===B?(O.enter("tableCellDivider"),O.consume(B),O.exit("tableCellDivider"),atDelimiterRowBreak):U(B)}function rowEndDelimiter(B){return O.exit("tableDelimiterRow"),W&&Y===q.length?null===B?tableClose(B):O.check(Pu,tableClose,O.attempt({tokenize:tokenizeRowEnd,partial:!0},factorySpace(O,bodyStart,"linePrefix",4),tableClose))(B):U(B)}function tableClose(U){return O.exit("table"),B(U)}function bodyStart(B){return O.enter("tableBody"),rowStartBody(B)}function rowStartBody(B){return O.enter("tableRow"),124===B?cellDividerBody(B):(O.enter("temporaryTableCellContent"),inCellContentBody(B))}function cellDividerBody(B){return O.enter("tableCellDivider"),O.consume(B),O.exit("tableCellDivider"),cellBreakBody}function cellBreakBody(B){return null===B||markdownLineEnding(B)?function(B){if(O.exit("tableRow"),null===B)return tableBodyClose(B);return O.check(Pu,tableBodyClose,O.attempt({tokenize:tokenizeRowEnd,partial:!0},factorySpace(O,rowStartBody,"linePrefix",4),tableBodyClose))(B)}(B):markdownSpace(B)?(O.enter("whitespace"),O.consume(B),inWhitespaceBody):124===B?cellDividerBody(B):(O.enter("temporaryTableCellContent"),inCellContentBody(B))}function inWhitespaceBody(B){return markdownSpace(B)?(O.consume(B),inWhitespaceBody):(O.exit("whitespace"),cellBreakBody(B))}function inCellContentBody(B){return null===B||124===B||markdownLineEndingOrSpace(B)?(O.exit("temporaryTableCellContent"),cellBreakBody(B)):(O.consume(B),92===B?inCellContentEscapeBody:inCellContentBody)}function inCellContentEscapeBody(B){return 92===B||124===B?(O.consume(B),inCellContentBody):inCellContentBody(B)}function tableBodyClose(B){return O.exit("tableBody"),tableClose(B)}function tokenizeRowEnd(O,B,U){return function(B){return O.enter("lineEnding"),O.consume(B),O.exit("lineEnding"),factorySpace(O,prefixed,"linePrefix")};function prefixed(q){if(G.parser.lazy[G.now().line]||null===q||markdownLineEnding(q))return U(q);const j=G.events[G.events.length-1];return!G.parser.constructs.disable.null.includes("codeIndented")&&j&&"linePrefix"===j[1].type&&j[2].sliceSerialize(j[1],!0).length>=4?U(q):(G._gfmTableDynamicInterruptHack=!0,O.check(G.parser.constructs.flow,(function(O){return G._gfmTableDynamicInterruptHack=!1,U(O)}),(function(O){return G._gfmTableDynamicInterruptHack=!1,B(O)}))(q))}}},resolve:function(O,B){let U,G,q,j,W,Y,K,Q=-1;for(;++Q<O.length;){const Z=O[Q][1];if(q&&("temporaryTableCellContent"===Z.type&&(j=j||Q,W=Q),("tableCellDivider"===Z.type||"tableRow"===Z.type)&&W)){const U={type:"tableContent",start:O[j][1].start,end:O[W][1].end},G={type:"chunkText",start:U.start,end:U.end,contentType:"text"};O.splice(j,W-j+1,["enter",U,B],["enter",G,B],["exit",G,B],["exit",U,B]),Q-=W-j-3,j=void 0,W=void 0}if("exit"===O[Q][0]&&void 0!==Y&&Y+(K?0:1)<Q&&("tableCellDivider"===Z.type||"tableRow"===Z.type&&(Y+3<Q||"whitespace"!==O[Y][1].type))){const q={type:G?"tableDelimiter":U?"tableHeader":"tableData",start:O[Y][1].start,end:O[Q][1].end};O.splice(Q+("tableCellDivider"===Z.type?1:0),0,["exit",q,B]),O.splice(Y,0,["enter",q,B]),Q+=2,Y=Q+1,K=!0}"tableRow"===Z.type&&(q="enter"===O[Q][0],q&&(Y=Q+1,K=!1)),"tableDelimiterRow"===Z.type&&(G="enter"===O[Q][0],G&&(Y=Q+1,K=!1)),"tableHead"===Z.type&&(U="enter"===O[Q][0])}return O}}}},Pu={tokenize:function(O,B,U){let G=0;return function(B){return O.enter("check"),O.consume(B),whitespace};function whitespace(q){return-1===q||32===q?(O.consume(q),G++,4===G?B:whitespace):null===q||markdownLineEndingOrSpace(q)?B(q):U(q)}},partial:!0};const Nu={enter:{table:function(O){const B=O._align;this.enter({type:"table",align:B.map((O=>"none"===O?null:O)),children:[]},O),this.setData("inTable",!0)},tableData:enterCell,tableHeader:enterCell,tableRow:function(O){this.enter({type:"tableRow",children:[]},O)}},exit:{codeText:function(O){let B=this.resume();this.getData("inTable")&&(B=B.replace(/\\([\\|])/g,replace));this.stack[this.stack.length-1].value=B,this.exit(O)},table:function(O){this.exit(O),this.setData("inTable")},tableData:lib_exit,tableHeader:lib_exit,tableRow:lib_exit}};function lib_exit(O){this.exit(O)}function enterCell(O){this.enter({type:"tableCell",children:[]},O)}function replace(O,B){return"|"===B?B:O}const Ou=class{constructor(O){const B=[],U=/\r?\n|\r/g;for(;U.test(O);)B.push(U.lastIndex);B.push(O.length+1),this.indices=B}toPoint(O){let B=-1;if("number"==typeof O&&O>-1&&O<this.indices[this.indices.length-1])for(;++B<this.indices.length;)if(this.indices[B]>O)return{line:B+1,column:O-(B>0?this.indices[B-1]:0)+1,offset:O};return{line:void 0,column:void 0,offset:void 0}}toOffset(O){const B=O&&O.line,U=O&&O.column;if("number"==typeof B&&"number"==typeof U&&!Number.isNaN(B)&&!Number.isNaN(U)&&B-1 in this.indices){const O=(this.indices[B-2]||0)+U-1||0;if(O>-1&&O<this.indices[this.indices.length-1])return O}return-1}},isMdastParagraph=O=>"paragraph"===O.type,isMdastList=O=>"list"===O.type;var Mu;(function(O){O.Normal="normal",O.OrderedList="ordered-list",O.UnorderedList="unordered-list"})(Mu||(Mu={}));const Du=class{constructor({docx:O,options:B}){this.docx=O,this.options=B}renderDocx(O,B={}){const U=fromMarkdown(O,{extensions:[Iu],mdastExtensions:[Nu]}),G=[];return U.children.forEach((B=>{G.push(...this.renderMarkdownNodeToDocx(B,{source:O,mode:Mu.Normal,listLevelStack:[],listNumberStack:[]}))})),new this.docx.Document({...getDocxStyleConfig(this.docx),sections:[{...createSections(this.docx,this.options),children:G}]})}renderToText(O,B){return Array.isArray(O)?O.map((O=>this.renderToText(O,B))).join(""):"text"===O.type?O.value:isMdastParagraph(O)?O.children.map((O=>this.renderToText(O,B))).join(""):O.position&&((O,B)=>{const U=/\r?\n|\r/g,G=O,q=new Ou(O);if(!B||!B.start||!B.end)return null;const j=q.toOffset(B.end);let W=q.toOffset(B.start);if(-1===j||-1===W)return null;const Y=[];for(;W<j;){U.lastIndex=W;const O=U.exec(G),B=O&&O.index<j?O.index:j;Y.push(G.slice(W,B)),W=B,O&&O.index<j&&(W+=O[0].length,Y.push(O[0]))}return Y.join("")})(B.source,O.position)||""}textToParagraphs(O,B){return O.split("\n").map((O=>new this.docx.Paragraph({style:B,children:[new this.docx.TextRun(O)]})))}renderList(O,B){const traverseList=(O,B)=>{const U=[],G={...B};return"listItem"===O.type&&(U.push({content:O.children.filter((O=>"list"!==O.type)).map((O=>this.renderToText(O,B))).join(""),level:B.listLevelStack.length,type:B.mode===Mu.OrderedList?"numbering":"bullet"}),G.listNumberStack[G.listNumberStack.length-1]+=1),(O=>void 0!==O.children)(O)?(O.children.forEach((O=>{isMdastList(O)&&U.push(...traverseList(O,{...G,mode:O.ordered?Mu.OrderedList:Mu.UnorderedList,listLevelStack:[...B.listLevelStack,O.ordered?Mu.OrderedList:Mu.UnorderedList],listNumberStack:[...B.listNumberStack,0]})),U.push(...traverseList(O,G))})),U):[]};return traverseList(O,{...B,mode:!0===O.ordered?Mu.OrderedList:Mu.UnorderedList,listLevelStack:[]}).map((O=>"numbering"===O.type?new this.docx.Paragraph({text:O.content,numbering:{reference:"bing-chat-numbering",level:O.level}}):new this.docx.Paragraph({text:O.content,bullet:{level:O.level}})))}renderCode(O,B){return this.textToParagraphs(O.value,"code")}renderMarkdownNodeToDocx(O,B){if(isMdastParagraph(O)){const U=O.children.map((O=>"inlineCode"===O.type?new this.docx.TextRun({text:O.value,shading:{fill:"#F1F1F1",type:this.docx.ShadingType.CLEAR,color:"auto"},color:"#111111"}):(O=>"emphasis"===O.type)(O)?new this.docx.TextRun({text:this.renderToText(O.children,B),italics:!0}):(O=>"strong"===O.type)(O)?new this.docx.TextRun({text:this.renderToText(O.children,B),bold:!0}):new this.docx.TextRun(this.renderToText(O,B))));return[new this.docx.Paragraph({children:U})]}if(isMdastList(O))return this.renderList(O,B);if("heading"===O.type){const mdastHeadingDepthToDocxHeadingLevel=O=>{switch(O){case 1:default:return this.docx.HeadingLevel.HEADING_1;case 2:return this.docx.HeadingLevel.HEADING_2;case 3:return this.docx.HeadingLevel.HEADING_3;case 4:return this.docx.HeadingLevel.HEADING_4;case 5:return this.docx.HeadingLevel.HEADING_5;case 6:return this.docx.HeadingLevel.HEADING_6}};return[new this.docx.Paragraph({children:O.children.map((O=>new this.docx.TextRun(this.renderToText(O,B)))),heading:mdastHeadingDepthToDocxHeadingLevel(O.depth)})]}if((O=>"code"===O.type)(O))return this.renderCode(O,B);if((O=>"html"===O.type)(O)){if(O.value.startsWith("<user-message>")){const B=O.value.replace("<user-message>","").replace("</user-message>","");return this.textToParagraphs(B,"user-title")}if(O.value.startsWith("<bot-message>")){const B=O.value.replace("<bot-message>","").replace("</bot-message>","");return this.textToParagraphs(B,"bot-title")}return this.textToParagraphs(O.value)}return this.textToParagraphs(this.renderToText(O,B))}};function getDefaults(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let Lu={async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};const Bu=/[&<>"']/,Fu=new RegExp(Bu.source,"g"),zu=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,$u=new RegExp(zu.source,"g"),Uu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=O=>Uu[O];function marked_esm_escape(O,B){if(B){if(Bu.test(O))return O.replace(Fu,getEscapeReplacement)}else if(zu.test(O))return O.replace($u,getEscapeReplacement);return O}const Vu=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function marked_esm_unescape(O){return O.replace(Vu,((O,B)=>"colon"===(B=B.toLowerCase())?":":"#"===B.charAt(0)?"x"===B.charAt(1)?String.fromCharCode(parseInt(B.substring(2),16)):String.fromCharCode(+B.substring(1)):""))}const Gu=/(^|[^\[])\^/g;function edit(O,B){O="string"==typeof O?O:O.source,B=B||"";const U={replace:(B,G)=>(G=(G=G.source||G).replace(Gu,"$1"),O=O.replace(B,G),U),getRegex:()=>new RegExp(O,B)};return U}const Hu=/[^\w:]/g,qu=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(O,B,U){if(O){let O;try{O=decodeURIComponent(marked_esm_unescape(U)).replace(Hu,"").toLowerCase()}catch(O){return null}if(0===O.indexOf("javascript:")||0===O.indexOf("vbscript:")||0===O.indexOf("data:"))return null}B&&!qu.test(U)&&(U=function(O,B){ju[" "+O]||(Wu.test(O)?ju[" "+O]=O+"/":ju[" "+O]=rtrim(O,"/",!0));const U=-1===(O=ju[" "+O]).indexOf(":");return"//"===B.substring(0,2)?U?B:O.replace(Yu,"$1")+B:"/"===B.charAt(0)?U?B:O.replace(Ku,"$1")+B:O+B}(B,U));try{U=encodeURI(U).replace(/%25/g,"%")}catch(O){return null}return U}const ju={},Wu=/^[^:]+:\/*[^/]*$/,Yu=/^([^:]+:)[\s\S]*$/,Ku=/^([^:]+:\/*[^/]*)[\s\S]*$/;const Qu={exec:function(){}};function splitCells(O,B){const U=O.replace(/\|/g,((O,B,U)=>{let G=!1,q=B;for(;--q>=0&&"\\"===U[q];)G=!G;return G?"|":" |"})),G=U.split(/ \|/);let q=0;if(G[0].trim()||G.shift(),G.length>0&&!G[G.length-1].trim()&&G.pop(),G.length>B)G.splice(B);else for(;G.length<B;)G.push("");for(;q<G.length;q++)G[q]=G[q].trim().replace(/\\\|/g,"|");return G}function rtrim(O,B,U){const G=O.length;if(0===G)return"";let q=0;for(;q<G;){const j=O.charAt(G-q-1);if(j!==B||U){if(j===B||!U)break;q++}else q++}return O.slice(0,G-q)}function repeatString(O,B){if(B<1)return"";let U="";for(;B>1;)1&B&&(U+=O),B>>=1,O+=O;return U+O}function outputLink(O,B,U,G){const q=B.href,j=B.title?marked_esm_escape(B.title):null,W=O[1].replace(/\\([\[\]])/g,"$1");if("!"!==O[0].charAt(0)){G.state.inLink=!0;const O={type:"link",raw:U,href:q,title:j,text:W,tokens:G.inlineTokens(W)};return G.state.inLink=!1,O}return{type:"image",raw:U,href:q,title:j,text:marked_esm_escape(W)}}class Tokenizer{constructor(O){this.options=O||Lu}space(O){const B=this.rules.block.newline.exec(O);if(B&&B[0].length>0)return{type:"space",raw:B[0]}}code(O){const B=this.rules.block.code.exec(O);if(B){const O=B[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:B[0],codeBlockStyle:"indented",text:this.options.pedantic?O:rtrim(O,"\n")}}}fences(O){const B=this.rules.block.fences.exec(O);if(B){const O=B[0],U=function(O,B){const U=O.match(/^(\s+)(?:```)/);if(null===U)return B;const G=U[1];return B.split("\n").map((O=>{const B=O.match(/^\s+/);if(null===B)return O;const[U]=B;return U.length>=G.length?O.slice(G.length):O})).join("\n")}(O,B[3]||"");return{type:"code",raw:O,lang:B[2]?B[2].trim().replace(this.rules.inline._escapes,"$1"):B[2],text:U}}}heading(O){const B=this.rules.block.heading.exec(O);if(B){let O=B[2].trim();if(/#$/.test(O)){const B=rtrim(O,"#");this.options.pedantic?O=B.trim():B&&!/ $/.test(B)||(O=B.trim())}return{type:"heading",raw:B[0],depth:B[1].length,text:O,tokens:this.lexer.inline(O)}}}hr(O){const B=this.rules.block.hr.exec(O);if(B)return{type:"hr",raw:B[0]}}blockquote(O){const B=this.rules.block.blockquote.exec(O);if(B){const O=B[0].replace(/^ *>[ \t]?/gm,""),U=this.lexer.state.top;this.lexer.state.top=!0;const G=this.lexer.blockTokens(O);return this.lexer.state.top=U,{type:"blockquote",raw:B[0],tokens:G,text:O}}}list(O){let B=this.rules.block.list.exec(O);if(B){let U,G,q,j,W,Y,K,Q,Z,X,J,ee,te=B[1].trim();const ie=te.length>1,re={type:"list",raw:"",ordered:ie,start:ie?+te.slice(0,-1):"",loose:!1,items:[]};te=ie?`\\d{1,9}\\${te.slice(-1)}`:`\\${te}`,this.options.pedantic&&(te=ie?te:"[*+-]");const ne=new RegExp(`^( {0,3}${te})((?:[\t ][^\\n]*)?(?:\\n|$))`);for(;O&&(ee=!1,B=ne.exec(O))&&!this.rules.block.hr.test(O);){if(U=B[0],O=O.substring(U.length),Q=B[2].split("\n",1)[0].replace(/^\t+/,(O=>" ".repeat(3*O.length))),Z=O.split("\n",1)[0],this.options.pedantic?(j=2,J=Q.trimLeft()):(j=B[2].search(/[^ ]/),j=j>4?1:j,J=Q.slice(j),j+=B[1].length),Y=!1,!Q&&/^ *$/.test(Z)&&(U+=Z+"\n",O=O.substring(Z.length+1),ee=!0),!ee){const B=new RegExp(`^ {0,${Math.min(3,j-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),G=new RegExp(`^ {0,${Math.min(3,j-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),q=new RegExp(`^ {0,${Math.min(3,j-1)}}(?:\`\`\`|~~~)`),W=new RegExp(`^ {0,${Math.min(3,j-1)}}#`);for(;O&&(X=O.split("\n",1)[0],Z=X,this.options.pedantic&&(Z=Z.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!q.test(Z))&&!W.test(Z)&&!B.test(Z)&&!G.test(O);){if(Z.search(/[^ ]/)>=j||!Z.trim())J+="\n"+Z.slice(j);else{if(Y)break;if(Q.search(/[^ ]/)>=4)break;if(q.test(Q))break;if(W.test(Q))break;if(G.test(Q))break;J+="\n"+Z}Y||Z.trim()||(Y=!0),U+=X+"\n",O=O.substring(X.length+1),Q=Z.slice(j)}}re.loose||(K?re.loose=!0:/\n *\n *$/.test(U)&&(K=!0)),this.options.gfm&&(G=/^\[[ xX]\] /.exec(J),G&&(q="[ ] "!==G[0],J=J.replace(/^\[[ xX]\] +/,""))),re.items.push({type:"list_item",raw:U,task:!!G,checked:q,loose:!1,text:J}),re.raw+=U}re.items[re.items.length-1].raw=U.trimRight(),re.items[re.items.length-1].text=J.trimRight(),re.raw=re.raw.trimRight();const oe=re.items.length;for(W=0;W<oe;W++)if(this.lexer.state.top=!1,re.items[W].tokens=this.lexer.blockTokens(re.items[W].text,[]),!re.loose){const O=re.items[W].tokens.filter((O=>"space"===O.type)),B=O.length>0&&O.some((O=>/\n.*\n/.test(O.raw)));re.loose=B}if(re.loose)for(W=0;W<oe;W++)re.items[W].loose=!0;return re}}html(O){const B=this.rules.block.html.exec(O);if(B){const O={type:"html",raw:B[0],pre:!this.options.sanitizer&&("pre"===B[1]||"script"===B[1]||"style"===B[1]),text:B[0]};if(this.options.sanitize){const U=this.options.sanitizer?this.options.sanitizer(B[0]):marked_esm_escape(B[0]);O.type="paragraph",O.text=U,O.tokens=this.lexer.inline(U)}return O}}def(O){const B=this.rules.block.def.exec(O);if(B){const O=B[1].toLowerCase().replace(/\s+/g," "),U=B[2]?B[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",G=B[3]?B[3].substring(1,B[3].length-1).replace(this.rules.inline._escapes,"$1"):B[3];return{type:"def",tag:O,raw:B[0],href:U,title:G}}}table(O){const B=this.rules.block.table.exec(O);if(B){const O={type:"table",header:splitCells(B[1]).map((O=>({text:O}))),align:B[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:B[3]&&B[3].trim()?B[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(O.header.length===O.align.length){O.raw=B[0];let U,G,q,j,W=O.align.length;for(U=0;U<W;U++)/^ *-+: *$/.test(O.align[U])?O.align[U]="right":/^ *:-+: *$/.test(O.align[U])?O.align[U]="center":/^ *:-+ *$/.test(O.align[U])?O.align[U]="left":O.align[U]=null;for(W=O.rows.length,U=0;U<W;U++)O.rows[U]=splitCells(O.rows[U],O.header.length).map((O=>({text:O})));for(W=O.header.length,G=0;G<W;G++)O.header[G].tokens=this.lexer.inline(O.header[G].text);for(W=O.rows.length,G=0;G<W;G++)for(j=O.rows[G],q=0;q<j.length;q++)j[q].tokens=this.lexer.inline(j[q].text);return O}}}lheading(O){const B=this.rules.block.lheading.exec(O);if(B)return{type:"heading",raw:B[0],depth:"="===B[2].charAt(0)?1:2,text:B[1],tokens:this.lexer.inline(B[1])}}paragraph(O){const B=this.rules.block.paragraph.exec(O);if(B){const O="\n"===B[1].charAt(B[1].length-1)?B[1].slice(0,-1):B[1];return{type:"paragraph",raw:B[0],text:O,tokens:this.lexer.inline(O)}}}text(O){const B=this.rules.block.text.exec(O);if(B)return{type:"text",raw:B[0],text:B[0],tokens:this.lexer.inline(B[0])}}escape(O){const B=this.rules.inline.escape.exec(O);if(B)return{type:"escape",raw:B[0],text:marked_esm_escape(B[1])}}tag(O){const B=this.rules.inline.tag.exec(O);if(B)return!this.lexer.state.inLink&&/^<a /i.test(B[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(B[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(B[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(B[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:B[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(B[0]):marked_esm_escape(B[0]):B[0]}}link(O){const B=this.rules.inline.link.exec(O);if(B){const O=B[2].trim();if(!this.options.pedantic&&/^</.test(O)){if(!/>$/.test(O))return;const B=rtrim(O.slice(0,-1),"\\");if((O.length-B.length)%2==0)return}else{const O=function(O,B){if(-1===O.indexOf(B[1]))return-1;const U=O.length;let G=0,q=0;for(;q<U;q++)if("\\"===O[q])q++;else if(O[q]===B[0])G++;else if(O[q]===B[1]&&(G--,G<0))return q;return-1}(B[2],"()");if(O>-1){const U=(0===B[0].indexOf("!")?5:4)+B[1].length+O;B[2]=B[2].substring(0,O),B[0]=B[0].substring(0,U).trim(),B[3]=""}}let U=B[2],G="";if(this.options.pedantic){const O=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(U);O&&(U=O[1],G=O[3])}else G=B[3]?B[3].slice(1,-1):"";return U=U.trim(),/^</.test(U)&&(U=this.options.pedantic&&!/>$/.test(O)?U.slice(1):U.slice(1,-1)),outputLink(B,{href:U?U.replace(this.rules.inline._escapes,"$1"):U,title:G?G.replace(this.rules.inline._escapes,"$1"):G},B[0],this.lexer)}}reflink(O,B){let U;if((U=this.rules.inline.reflink.exec(O))||(U=this.rules.inline.nolink.exec(O))){let O=(U[2]||U[1]).replace(/\s+/g," ");if(O=B[O.toLowerCase()],!O){const O=U[0].charAt(0);return{type:"text",raw:O,text:O}}return outputLink(U,O,U[0],this.lexer)}}emStrong(O,B,U=""){let G=this.rules.inline.emStrong.lDelim.exec(O);if(!G)return;if(G[3]&&U.match(/[\p{L}\p{N}]/u))return;const q=G[1]||G[2]||"";if(!q||q&&(""===U||this.rules.inline.punctuation.exec(U))){const U=G[0].length-1;let q,j,W=U,Y=0;const K="*"===G[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(K.lastIndex=0,B=B.slice(-1*O.length+U);null!=(G=K.exec(B));){if(q=G[1]||G[2]||G[3]||G[4]||G[5]||G[6],!q)continue;if(j=q.length,G[3]||G[4]){W+=j;continue}if((G[5]||G[6])&&U%3&&!((U+j)%3)){Y+=j;continue}if(W-=j,W>0)continue;j=Math.min(j,j+W+Y);const B=O.slice(0,U+G.index+(G[0].length-q.length)+j);if(Math.min(U,j)%2){const O=B.slice(1,-1);return{type:"em",raw:B,text:O,tokens:this.lexer.inlineTokens(O)}}const K=B.slice(2,-2);return{type:"strong",raw:B,text:K,tokens:this.lexer.inlineTokens(K)}}}}codespan(O){const B=this.rules.inline.code.exec(O);if(B){let O=B[2].replace(/\n/g," ");const U=/[^ ]/.test(O),G=/^ /.test(O)&&/ $/.test(O);return U&&G&&(O=O.substring(1,O.length-1)),O=marked_esm_escape(O,!0),{type:"codespan",raw:B[0],text:O}}}br(O){const B=this.rules.inline.br.exec(O);if(B)return{type:"br",raw:B[0]}}del(O){const B=this.rules.inline.del.exec(O);if(B)return{type:"del",raw:B[0],text:B[2],tokens:this.lexer.inlineTokens(B[2])}}autolink(O,B){const U=this.rules.inline.autolink.exec(O);if(U){let O,G;return"@"===U[2]?(O=marked_esm_escape(this.options.mangle?B(U[1]):U[1]),G="mailto:"+O):(O=marked_esm_escape(U[1]),G=O),{type:"link",raw:U[0],text:O,href:G,tokens:[{type:"text",raw:O,text:O}]}}}url(O,B){let U;if(U=this.rules.inline.url.exec(O)){let O,G;if("@"===U[2])O=marked_esm_escape(this.options.mangle?B(U[0]):U[0]),G="mailto:"+O;else{let B;do{B=U[0],U[0]=this.rules.inline._backpedal.exec(U[0])[0]}while(B!==U[0]);O=marked_esm_escape(U[0]),G="www."===U[1]?"http://"+U[0]:U[0]}return{type:"link",raw:U[0],text:O,href:G,tokens:[{type:"text",raw:O,text:O}]}}}inlineText(O,B){const U=this.rules.inline.text.exec(O);if(U){let O;return O=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(U[0]):marked_esm_escape(U[0]):U[0]:marked_esm_escape(this.options.smartypants?B(U[0]):U[0]),{type:"text",raw:U[0],text:O}}}}const Zu={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Qu,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Zu.def=edit(Zu.def).replace("label",Zu._label).replace("title",Zu._title).getRegex(),Zu.bullet=/(?:[*+-]|\d{1,9}[.)])/,Zu.listItemStart=edit(/^( *)(bull) */).replace("bull",Zu.bullet).getRegex(),Zu.list=edit(Zu.list).replace(/bull/g,Zu.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Zu.def.source+")").getRegex(),Zu._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Zu._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Zu.html=edit(Zu.html,"i").replace("comment",Zu._comment).replace("tag",Zu._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Zu.paragraph=edit(Zu._paragraph).replace("hr",Zu.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zu._tag).getRegex(),Zu.blockquote=edit(Zu.blockquote).replace("paragraph",Zu.paragraph).getRegex(),Zu.normal={...Zu},Zu.gfm={...Zu.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"},Zu.gfm.table=edit(Zu.gfm.table).replace("hr",Zu.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zu._tag).getRegex(),Zu.gfm.paragraph=edit(Zu._paragraph).replace("hr",Zu.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Zu.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zu._tag).getRegex(),Zu.pedantic={...Zu.normal,html:edit("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Zu._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Qu,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:edit(Zu.normal._paragraph).replace("hr",Zu.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Zu.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const Xu={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Qu,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Qu,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function smartypants(O){return O.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function mangle(O){let B,U,G="";const q=O.length;for(B=0;B<q;B++)U=O.charCodeAt(B),Math.random()>.5&&(U="x"+U.toString(16)),G+="&#"+U+";";return G}Xu._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",Xu.punctuation=edit(Xu.punctuation).replace(/punctuation/g,Xu._punctuation).getRegex(),Xu.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Xu.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g,Xu._comment=edit(Zu._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Xu.emStrong.lDelim=edit(Xu.emStrong.lDelim).replace(/punct/g,Xu._punctuation).getRegex(),Xu.emStrong.rDelimAst=edit(Xu.emStrong.rDelimAst,"g").replace(/punct/g,Xu._punctuation).getRegex(),Xu.emStrong.rDelimUnd=edit(Xu.emStrong.rDelimUnd,"g").replace(/punct/g,Xu._punctuation).getRegex(),Xu._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Xu._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Xu._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Xu.autolink=edit(Xu.autolink).replace("scheme",Xu._scheme).replace("email",Xu._email).getRegex(),Xu._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Xu.tag=edit(Xu.tag).replace("comment",Xu._comment).replace("attribute",Xu._attribute).getRegex(),Xu._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Xu._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Xu._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Xu.link=edit(Xu.link).replace("label",Xu._label).replace("href",Xu._href).replace("title",Xu._title).getRegex(),Xu.reflink=edit(Xu.reflink).replace("label",Xu._label).replace("ref",Zu._label).getRegex(),Xu.nolink=edit(Xu.nolink).replace("ref",Zu._label).getRegex(),Xu.reflinkSearch=edit(Xu.reflinkSearch,"g").replace("reflink",Xu.reflink).replace("nolink",Xu.nolink).getRegex(),Xu.normal={...Xu},Xu.pedantic={...Xu.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",Xu._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Xu._label).getRegex()},Xu.gfm={...Xu.normal,escape:edit(Xu.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Xu.gfm.url=edit(Xu.gfm.url,"i").replace("email",Xu.gfm._extended_email).getRegex(),Xu.breaks={...Xu.gfm,br:edit(Xu.br).replace("{2,}","*").getRegex(),text:edit(Xu.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};class Lexer{constructor(O){this.tokens=[],this.tokens.links=Object.create(null),this.options=O||Lu,this.options.tokenizer=this.options.tokenizer||new Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const B={block:Zu.normal,inline:Xu.normal};this.options.pedantic?(B.block=Zu.pedantic,B.inline=Xu.pedantic):this.options.gfm&&(B.block=Zu.gfm,this.options.breaks?B.inline=Xu.breaks:B.inline=Xu.gfm),this.tokenizer.rules=B}static get rules(){return{block:Zu,inline:Xu}}static lex(O,B){return new Lexer(B).lex(O)}static lexInline(O,B){return new Lexer(B).inlineTokens(O)}lex(O){let B;for(O=O.replace(/\r\n|\r/g,"\n"),this.blockTokens(O,this.tokens);B=this.inlineQueue.shift();)this.inlineTokens(B.src,B.tokens);return this.tokens}blockTokens(O,B=[]){let U,G,q,j;for(O=this.options.pedantic?O.replace(/\t/g,"    ").replace(/^ +$/gm,""):O.replace(/^( *)(\t+)/gm,((O,B,U)=>B+"    ".repeat(U.length)));O;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((G=>!!(U=G.call({lexer:this},O,B))&&(O=O.substring(U.raw.length),B.push(U),!0)))))if(U=this.tokenizer.space(O))O=O.substring(U.raw.length),1===U.raw.length&&B.length>0?B[B.length-1].raw+="\n":B.push(U);else if(U=this.tokenizer.code(O))O=O.substring(U.raw.length),G=B[B.length-1],!G||"paragraph"!==G.type&&"text"!==G.type?B.push(U):(G.raw+="\n"+U.raw,G.text+="\n"+U.text,this.inlineQueue[this.inlineQueue.length-1].src=G.text);else if(U=this.tokenizer.fences(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.heading(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.hr(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.blockquote(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.list(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.html(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.def(O))O=O.substring(U.raw.length),G=B[B.length-1],!G||"paragraph"!==G.type&&"text"!==G.type?this.tokens.links[U.tag]||(this.tokens.links[U.tag]={href:U.href,title:U.title}):(G.raw+="\n"+U.raw,G.text+="\n"+U.raw,this.inlineQueue[this.inlineQueue.length-1].src=G.text);else if(U=this.tokenizer.table(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.lheading(O))O=O.substring(U.raw.length),B.push(U);else{if(q=O,this.options.extensions&&this.options.extensions.startBlock){let B=1/0;const U=O.slice(1);let G;this.options.extensions.startBlock.forEach((function(O){G=O.call({lexer:this},U),"number"==typeof G&&G>=0&&(B=Math.min(B,G))})),B<1/0&&B>=0&&(q=O.substring(0,B+1))}if(this.state.top&&(U=this.tokenizer.paragraph(q)))G=B[B.length-1],j&&"paragraph"===G.type?(G.raw+="\n"+U.raw,G.text+="\n"+U.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=G.text):B.push(U),j=q.length!==O.length,O=O.substring(U.raw.length);else if(U=this.tokenizer.text(O))O=O.substring(U.raw.length),G=B[B.length-1],G&&"text"===G.type?(G.raw+="\n"+U.raw,G.text+="\n"+U.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=G.text):B.push(U);else if(O){const B="Infinite loop on byte: "+O.charCodeAt(0);if(this.options.silent){console.error(B);break}throw new Error(B)}}return this.state.top=!0,B}inline(O,B=[]){return this.inlineQueue.push({src:O,tokens:B}),B}inlineTokens(O,B=[]){let U,G,q,j,W,Y,K=O;if(this.tokens.links){const O=Object.keys(this.tokens.links);if(O.length>0)for(;null!=(j=this.tokenizer.rules.inline.reflinkSearch.exec(K));)O.includes(j[0].slice(j[0].lastIndexOf("[")+1,-1))&&(K=K.slice(0,j.index)+"["+repeatString("a",j[0].length-2)+"]"+K.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(j=this.tokenizer.rules.inline.blockSkip.exec(K));)K=K.slice(0,j.index)+"["+repeatString("a",j[0].length-2)+"]"+K.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(j=this.tokenizer.rules.inline.escapedEmSt.exec(K));)K=K.slice(0,j.index+j[0].length-2)+"++"+K.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;O;)if(W||(Y=""),W=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((G=>!!(U=G.call({lexer:this},O,B))&&(O=O.substring(U.raw.length),B.push(U),!0)))))if(U=this.tokenizer.escape(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.tag(O))O=O.substring(U.raw.length),G=B[B.length-1],G&&"text"===U.type&&"text"===G.type?(G.raw+=U.raw,G.text+=U.text):B.push(U);else if(U=this.tokenizer.link(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.reflink(O,this.tokens.links))O=O.substring(U.raw.length),G=B[B.length-1],G&&"text"===U.type&&"text"===G.type?(G.raw+=U.raw,G.text+=U.text):B.push(U);else if(U=this.tokenizer.emStrong(O,K,Y))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.codespan(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.br(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.del(O))O=O.substring(U.raw.length),B.push(U);else if(U=this.tokenizer.autolink(O,mangle))O=O.substring(U.raw.length),B.push(U);else if(this.state.inLink||!(U=this.tokenizer.url(O,mangle))){if(q=O,this.options.extensions&&this.options.extensions.startInline){let B=1/0;const U=O.slice(1);let G;this.options.extensions.startInline.forEach((function(O){G=O.call({lexer:this},U),"number"==typeof G&&G>=0&&(B=Math.min(B,G))})),B<1/0&&B>=0&&(q=O.substring(0,B+1))}if(U=this.tokenizer.inlineText(q,smartypants))O=O.substring(U.raw.length),"_"!==U.raw.slice(-1)&&(Y=U.raw.slice(-1)),W=!0,G=B[B.length-1],G&&"text"===G.type?(G.raw+=U.raw,G.text+=U.text):B.push(U);else if(O){const B="Infinite loop on byte: "+O.charCodeAt(0);if(this.options.silent){console.error(B);break}throw new Error(B)}}else O=O.substring(U.raw.length),B.push(U);return B}}class Renderer{constructor(O){this.options=O||Lu}code(O,B,U){const G=(B||"").match(/\S*/)[0];if(this.options.highlight){const B=this.options.highlight(O,G);null!=B&&B!==O&&(U=!0,O=B)}return O=O.replace(/\n$/,"")+"\n",G?'<pre><code class="'+this.options.langPrefix+marked_esm_escape(G)+'">'+(U?O:marked_esm_escape(O,!0))+"</code></pre>\n":"<pre><code>"+(U?O:marked_esm_escape(O,!0))+"</code></pre>\n"}blockquote(O){return`<blockquote>\n${O}</blockquote>\n`}html(O){return O}heading(O,B,U,G){if(this.options.headerIds){return`<h${B} id="${this.options.headerPrefix+G.slug(U)}">${O}</h${B}>\n`}return`<h${B}>${O}</h${B}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(O,B,U){const G=B?"ol":"ul";return"<"+G+(B&&1!==U?' start="'+U+'"':"")+">\n"+O+"</"+G+">\n"}listitem(O){return`<li>${O}</li>\n`}checkbox(O){return"<input "+(O?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(O){return`<p>${O}</p>\n`}table(O,B){return B&&(B=`<tbody>${B}</tbody>`),"<table>\n<thead>\n"+O+"</thead>\n"+B+"</table>\n"}tablerow(O){return`<tr>\n${O}</tr>\n`}tablecell(O,B){const U=B.header?"th":"td";return(B.align?`<${U} align="${B.align}">`:`<${U}>`)+O+`</${U}>\n`}strong(O){return`<strong>${O}</strong>`}em(O){return`<em>${O}</em>`}codespan(O){return`<code>${O}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(O){return`<del>${O}</del>`}link(O,B,U){if(null===(O=cleanUrl(this.options.sanitize,this.options.baseUrl,O)))return U;let G='<a href="'+O+'"';return B&&(G+=' title="'+B+'"'),G+=">"+U+"</a>",G}image(O,B,U){if(null===(O=cleanUrl(this.options.sanitize,this.options.baseUrl,O)))return U;let G=`<img src="${O}" alt="${U}"`;return B&&(G+=` title="${B}"`),G+=this.options.xhtml?"/>":">",G}text(O){return O}}class TextRenderer{strong(O){return O}em(O){return O}codespan(O){return O}del(O){return O}html(O){return O}text(O){return O}link(O,B,U){return""+U}image(O,B,U){return""+U}br(){return""}}class Slugger{constructor(){this.seen={}}serialize(O){return O.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(O,B){let U=O,G=0;if(this.seen.hasOwnProperty(U)){G=this.seen[O];do{G++,U=O+"-"+G}while(this.seen.hasOwnProperty(U))}return B||(this.seen[O]=G,this.seen[U]=0),U}slug(O,B={}){const U=this.serialize(O);return this.getNextSafeSlug(U,B.dryrun)}}class Parser{constructor(O){this.options=O||Lu,this.options.renderer=this.options.renderer||new Renderer,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}static parse(O,B){return new Parser(B).parse(O)}static parseInline(O,B){return new Parser(B).parseInline(O)}parse(O,B=!0){let U,G,q,j,W,Y,K,Q,Z,X,J,ee,te,ie,re,ne,oe,ae,se,le="";const ce=O.length;for(U=0;U<ce;U++)if(X=O[U],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[X.type]&&(se=this.options.extensions.renderers[X.type].call({parser:this},X),!1!==se||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(X.type)))le+=se||"";else switch(X.type){case"space":continue;case"hr":le+=this.renderer.hr();continue;case"heading":le+=this.renderer.heading(this.parseInline(X.tokens),X.depth,marked_esm_unescape(this.parseInline(X.tokens,this.textRenderer)),this.slugger);continue;case"code":le+=this.renderer.code(X.text,X.lang,X.escaped);continue;case"table":for(Q="",K="",j=X.header.length,G=0;G<j;G++)K+=this.renderer.tablecell(this.parseInline(X.header[G].tokens),{header:!0,align:X.align[G]});for(Q+=this.renderer.tablerow(K),Z="",j=X.rows.length,G=0;G<j;G++){for(Y=X.rows[G],K="",W=Y.length,q=0;q<W;q++)K+=this.renderer.tablecell(this.parseInline(Y[q].tokens),{header:!1,align:X.align[q]});Z+=this.renderer.tablerow(K)}le+=this.renderer.table(Q,Z);continue;case"blockquote":Z=this.parse(X.tokens),le+=this.renderer.blockquote(Z);continue;case"list":for(J=X.ordered,ee=X.start,te=X.loose,j=X.items.length,Z="",G=0;G<j;G++)re=X.items[G],ne=re.checked,oe=re.task,ie="",re.task&&(ae=this.renderer.checkbox(ne),te?re.tokens.length>0&&"paragraph"===re.tokens[0].type?(re.tokens[0].text=ae+" "+re.tokens[0].text,re.tokens[0].tokens&&re.tokens[0].tokens.length>0&&"text"===re.tokens[0].tokens[0].type&&(re.tokens[0].tokens[0].text=ae+" "+re.tokens[0].tokens[0].text)):re.tokens.unshift({type:"text",text:ae}):ie+=ae),ie+=this.parse(re.tokens,te),Z+=this.renderer.listitem(ie,oe,ne);le+=this.renderer.list(Z,J,ee);continue;case"html":le+=this.renderer.html(X.text);continue;case"paragraph":le+=this.renderer.paragraph(this.parseInline(X.tokens));continue;case"text":for(Z=X.tokens?this.parseInline(X.tokens):X.text;U+1<ce&&"text"===O[U+1].type;)X=O[++U],Z+="\n"+(X.tokens?this.parseInline(X.tokens):X.text);le+=B?this.renderer.paragraph(Z):Z;continue;default:{const O='Token with "'+X.type+'" type was not found.';if(this.options.silent)return void console.error(O);throw new Error(O)}}return le}parseInline(O,B){B=B||this.renderer;let U,G,q,j="";const W=O.length;for(U=0;U<W;U++)if(G=O[U],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[G.type]&&(q=this.options.extensions.renderers[G.type].call({parser:this},G),!1!==q||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(G.type)))j+=q||"";else switch(G.type){case"escape":case"text":j+=B.text(G.text);break;case"html":j+=B.html(G.text);break;case"link":j+=B.link(G.href,G.title,this.parseInline(G.tokens,B));break;case"image":j+=B.image(G.href,G.title,G.text);break;case"strong":j+=B.strong(this.parseInline(G.tokens,B));break;case"em":j+=B.em(this.parseInline(G.tokens,B));break;case"codespan":j+=B.codespan(G.text);break;case"br":j+=B.br();break;case"del":j+=B.del(this.parseInline(G.tokens,B));break;default:{const O='Token with "'+G.type+'" type was not found.';if(this.options.silent)return void console.error(O);throw new Error(O)}}return j}}class Hooks{constructor(O){this.options=O||Lu}static passThroughHooks=new Set(["preprocess","postprocess"]);preprocess(O){return O}postprocess(O){return O}}function parseMarkdown(O,B){return(U,G,q)=>{"function"==typeof G&&(q=G,G=null);const j={...G},W=function(O,B,U){return G=>{if(G.message+="\nPlease report this to https://github.com/markedjs/marked.",O){const O="<p>An error occurred:</p><pre>"+marked_esm_escape(G.message+"",!0)+"</pre>";return B?Promise.resolve(O):U?void U(null,O):O}if(B)return Promise.reject(G);if(!U)throw G;U(G)}}((G={...marked.defaults,...j}).silent,G.async,q);if(null==U)return W(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof U)return W(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(U)+", string expected"));if(function(O){O&&O.sanitize&&!O.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}(G),G.hooks&&(G.hooks.options=G),q){const j=G.highlight;let Y;try{G.hooks&&(U=G.hooks.preprocess(U)),Y=O(U,G)}catch(O){return W(O)}const done=function(O){let U;if(!O)try{G.walkTokens&&marked.walkTokens(Y,G.walkTokens),U=B(Y,G),G.hooks&&(U=G.hooks.postprocess(U))}catch(B){O=B}return G.highlight=j,O?W(O):q(null,U)};if(!j||j.length<3)return done();if(delete G.highlight,!Y.length)return done();let K=0;return marked.walkTokens(Y,(function(O){"code"===O.type&&(K++,setTimeout((()=>{j(O.text,O.lang,(function(B,U){if(B)return done(B);null!=U&&U!==O.text&&(O.text=U,O.escaped=!0),K--,0===K&&done()}))}),0))})),void(0===K&&done())}if(G.async)return Promise.resolve(G.hooks?G.hooks.preprocess(U):U).then((B=>O(B,G))).then((O=>G.walkTokens?Promise.all(marked.walkTokens(O,G.walkTokens)).then((()=>O)):O)).then((O=>B(O,G))).then((O=>G.hooks?G.hooks.postprocess(O):O)).catch(W);try{G.hooks&&(U=G.hooks.preprocess(U));const q=O(U,G);G.walkTokens&&marked.walkTokens(q,G.walkTokens);let j=B(q,G);return G.hooks&&(j=G.hooks.postprocess(j)),j}catch(O){return W(O)}}}function marked(O,B,U){return parseMarkdown(Lexer.lex,Parser.parse)(O,B,U)}marked.options=marked.setOptions=function(O){var B;return marked.defaults={...marked.defaults,...O},B=marked.defaults,Lu=B,marked},marked.getDefaults=getDefaults,marked.defaults=Lu,marked.use=function(...O){const B=marked.defaults.extensions||{renderers:{},childTokens:{}};O.forEach((O=>{const U={...O};if(U.async=marked.defaults.async||U.async||!1,O.extensions&&(O.extensions.forEach((O=>{if(!O.name)throw new Error("extension name required");if(O.renderer){const U=B.renderers[O.name];B.renderers[O.name]=U?function(...B){let G=O.renderer.apply(this,B);return!1===G&&(G=U.apply(this,B)),G}:O.renderer}if(O.tokenizer){if(!O.level||"block"!==O.level&&"inline"!==O.level)throw new Error("extension level must be 'block' or 'inline'");B[O.level]?B[O.level].unshift(O.tokenizer):B[O.level]=[O.tokenizer],O.start&&("block"===O.level?B.startBlock?B.startBlock.push(O.start):B.startBlock=[O.start]:"inline"===O.level&&(B.startInline?B.startInline.push(O.start):B.startInline=[O.start]))}O.childTokens&&(B.childTokens[O.name]=O.childTokens)})),U.extensions=B),O.renderer){const B=marked.defaults.renderer||new Renderer;for(const U in O.renderer){const G=B[U];B[U]=(...q)=>{let j=O.renderer[U].apply(B,q);return!1===j&&(j=G.apply(B,q)),j}}U.renderer=B}if(O.tokenizer){const B=marked.defaults.tokenizer||new Tokenizer;for(const U in O.tokenizer){const G=B[U];B[U]=(...q)=>{let j=O.tokenizer[U].apply(B,q);return!1===j&&(j=G.apply(B,q)),j}}U.tokenizer=B}if(O.hooks){const B=marked.defaults.hooks||new Hooks;for(const U in O.hooks){const G=B[U];Hooks.passThroughHooks.has(U)?B[U]=q=>{if(marked.defaults.async)return Promise.resolve(O.hooks[U].call(B,q)).then((O=>G.call(B,O)));const j=O.hooks[U].call(B,q);return G.call(B,j)}:B[U]=(...q)=>{let j=O.hooks[U].apply(B,q);return!1===j&&(j=G.apply(B,q)),j}}U.hooks=B}if(O.walkTokens){const B=marked.defaults.walkTokens;U.walkTokens=function(U){let G=[];return G.push(O.walkTokens.call(this,U)),B&&(G=G.concat(B.call(this,U))),G}}marked.setOptions(U)}))},marked.walkTokens=function(O,B){let U=[];for(const G of O)switch(U=U.concat(B.call(marked,G)),G.type){case"table":for(const O of G.header)U=U.concat(marked.walkTokens(O.tokens,B));for(const O of G.rows)for(const G of O)U=U.concat(marked.walkTokens(G.tokens,B));break;case"list":U=U.concat(marked.walkTokens(G.items,B));break;default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[G.type]?marked.defaults.extensions.childTokens[G.type].forEach((function(O){U=U.concat(marked.walkTokens(G[O],B))})):G.tokens&&(U=U.concat(marked.walkTokens(G.tokens,B)))}return U},marked.parseInline=parseMarkdown(Lexer.lexInline,Parser.parseInline),marked.Parser=Parser,marked.parser=Parser.parse,marked.Renderer=Renderer,marked.TextRenderer=TextRenderer,marked.Lexer=Lexer,marked.lexer=Lexer.lex,marked.Tokenizer=Tokenizer,marked.Slugger=Slugger,marked.Hooks=Hooks,marked.parse=marked;marked.options,marked.setOptions,marked.use,marked.walkTokens,marked.parseInline;const Ju={options:{},code:(O,B)=>(B?"\n["+B+"]":"")+"\n"+function(O){const B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U=/[&<>"']/g,G=RegExp(U.source);return O&&G.test(O)?O.replace(U,(O=>B[O])):O||""}(O)+"\n",blockquote:O=>O+"\n",html:O=>O+"\n",heading:O=>O+"\n",hr:()=>"\n\n",list:O=>O+"\n",listitem:O=>" - "+O+"\n",checkbox:()=>"",paragraph:O=>O+"\n",table:(O,B)=>O+B+"\n",tablerow:O=>O+"\n",tablecell:(O,B)=>O+"  \t",strong:O=>O,em:O=>O,codespan:O=>O,br:()=>"\n\n",del:O=>"",link:(O,B,U)=>U,image:(O,B,U)=>U,text:O=>O};const markdown_to_plain_text=function(O){return marked.use({renderer:Ju}),function(O){const B={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},U=/&(?:amp|lt|gt|quot|#(0+)?39);/g,G=RegExp(U.source);return O&&G.test(O)?O.replace(U,(O=>B[O]||"'")):O||""}(marked.parse(O)).replace(/(\n{3,})/g,"\n\n")};let eh=class{constructor(O,B,U,G){this.config=O,this.telemetry=B,this.screenshotService=U,this.log=G,this.enableMessageExportWithPlainText=!!this.config.features.enableMessageExportWithPlainText,this.pdfIframeID="print-pdf-iframe",this.pdfWindowRenderTimeoutMs=100,this.pdfWindow=null,this.fileType=up.Txt,this.concatenatedMdStr="",this.contextMessages=[],this.currentDocTitle="",this.exportOptions=null,this.markdownParser=new(fp())({html:!0,typographer:!0,highlight:(O,B)=>{let U="";if(B&&mp.getLanguage(B))try{U=mp.highlight(O,{language:B,ignoreIllegals:!0}).value}catch(O){}return U}})}dynamicImportDocx(O){O&&U.e(667).then(U.t.bind(U,2667,23)).then((O=>{window.docx=O})).catch((O=>{var B;null===(B=this.log)||void 0===B||B.error(this,this.dynamicImportDocx,`Failed to import docx. ${O}`).write()}))}async exportToFile(O,B,U){var G;try{switch(this.fileType=B,this.exportOptions=getMergedOptions(B,U),this.contextMessages=O.filter((O=>O.type!==vp.Meta)),this.concatenatedMdStr=await this.concatContextText(this.contextMessages),B){case up.Txt:return this.exportToTxt();case up.Docx:return await this.exportToDocx();case up.Pdf:return await this.exportToPdf();default:throw new Error(`Invalid file type: ${B}`)}}catch(O){const B=ErrorUtils_getErrorMessage(ensureErrorInstance(O));throw null===(G=this.log)||void 0===G||G.error(this,this.exportToFile,`Failed to export. ${B}`).write(),this.telemetry.trackEvent("Error","exportToFile",{Namespace:"Conversation",CustomData:JSON.stringify({reason:B})}),O}finally{B===up.Pdf&&(this.removePdfContainer(),document.title=this.currentDocTitle)}}replacePlaceholder(O){return O.replace(/{DOUBLE_HASHTAG}/g,"##")}async concatContextText(O){if(!O||0===O.length)throw new Error("No messages to export.");return(await Promise.all(O.map((async O=>{const{author:B,text:U,type:G}=O;if(!U)return"";switch(B){case Yi.User:return this.formatUserMessage(U);case Yi.Bot:return G===vp.Host?await this.formatBotHostMessage(O,U):this.formatBotTextMessage(U);default:return""}})))).filter((O=>O)).join("\n\n")}exportToTxt(){var O;const B=this.replacePlaceholder(this.enableMessageExportWithPlainText?markdown_to_plain_text(this.concatenatedMdStr):this.concatenatedMdStr);null===(O=this.log)||void 0===O||O.trace(this,this.exportToTxt,`Exporting to txt: ${B}`);const U=new Blob([B],{type:"text/plain;charset=utf-8"});this.downloadFile(U)}async exportToDocx(){var O;if(null===(O=this.log)||void 0===O||O.trace(this,this.exportToDocx,`Exporting to docx: ${this.concatenatedMdStr}`),null===window||void 0===window?void 0:window.docx){if(this.config.features.enableExportDocxWithFormat){const O=new Du({docx:window.docx,options:this.exportOptions}).renderDocx(this.concatenatedMdStr);return void await this.generateDocxFileByDocxLibFormatted(window.docx,O)}await this.generateDocxFileByDocxLib(window.docx)}}async exportToPdf(){var O,B,U;this.currentDocTitle=document.title,document.title=null!==(B=null===(O=this.exportOptions)||void 0===O?void 0:O.filename)&&void 0!==B?B:"";const G=this.renderHtml(this.concatenatedMdStr),q=function(O,B){return`\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset="UTF-8">\n        <meta http-equiv="X-UA-Compatible" content="IE=edge">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <style media="print">\n          @page {\n            margin: 0;\n          }\n        </style>\n        <style>\n          \n  .pdf-print-container {\n    padding: 20px 32px 32px 32px;\n  }\n  .slogan-header {\n    text-align: center;\n    border-bottom: 1px solid lightgray;\n    margin-bottom: 16px;\n    font-size: 12px;\n  }\n  .user-title {\n    font-weight: 700;\n    color: #005366;\n  }\n  .bot-title {\n    font-weight: 700;\n    color: #123BB6;\n  }\n  pre code.hljs {\n    display: block;\n    overflow-x: auto;\n    padding: 1em;\n  }\n  code.hljs {\n    padding: 3px 5px;\n  }\n  .hljs {\n    background: #fff;\n    color: #000;\n  }\n  .hljs-comment,\n  .hljs-quote,\n  .hljs-variable {\n    color: green;\n  }\n  .hljs-built_in,\n  .hljs-keyword,\n  .hljs-name,\n  .hljs-selector-tag,\n  .hljs-tag {\n    color: #00f;\n  }\n  .hljs-addition,\n  .hljs-attribute,\n  .hljs-literal,\n  .hljs-section,\n  .hljs-string,\n  .hljs-template-tag,\n  .hljs-template-variable,\n  .hljs-title,\n  .hljs-type {\n    color: #a31515;\n  }\n  .hljs-deletion,\n  .hljs-meta,\n  .hljs-selector-attr,\n  .hljs-selector-pseudo {\n    color: #2b91af;\n  }\n  .hljs-doctag {\n    color: grey;\n  }\n  .hljs-attr {\n    color: red;\n  }\n  .hljs-bullet,\n  .hljs-link,\n  .hljs-symbol {\n    color: #00b0e8;\n  }\n  .hljs-emphasis {\n    font-style: italic;\n  }\n  .hljs-strong {\n    font-weight: 700;\n  }\n\n        </style>\n      </head>\n      <body>\n        <div class="pdf-print-container">\n          <div class="slogan-header">${(null==B?void 0:B.slogan)||""}</div>\n          ${O}\n        </div>\n      </body>\n    </html>\n  `}(G,this.exportOptions);null===(U=this.log)||void 0===U||U.trace(this,this.exportToPdf,`Exporting to pdf: ${G}`),_i?await this.exportToPdfWithNewWindow(q):await this.exportToPdfWithIframe(q)}async exportToPdfWithIframe(O){const B=this.createPdfIframe(O);return new Promise(((O,U)=>{B.onload=()=>{const G=B.contentWindow;G?(G.print(),G.onafterprint=()=>{document.body.removeChild(B),O()},G.onerror=O=>U(O)):U(new Error("Pdf iframe window is null."))},B.onerror=O=>U(O)}))}async exportToPdfWithNewWindow(O){return new Promise(((B,U)=>{const G=window.open("","");this.pdfWindow=G,G?(G.document.write(O),G.document.close(),G.onerror=O=>U(O),G.document.onerror=O=>U(O),setTimeout((()=>{G.focus(),G.print(),G.close(),B()}),this.pdfWindowRenderTimeoutMs)):U(new Error("Pdf window is null."))}))}downloadFile(O){var B,U;let G=null!==(U=null===(B=this.exportOptions)||void 0===B?void 0:B.filename)&&void 0!==U?U:"";G=-1===G.indexOf(".")?`${G}.${this.fileType}`:G;const q=document.createElement("a");document.body.appendChild(q),q.href=URL.createObjectURL(O),q.setAttribute("download",G),q.click(),document.body.removeChild(q),URL.revokeObjectURL(q.href)}async generateDocxFileByDocxLibFormatted(O,B){const{Packer:U}=O,G=await U.toBlob(B);this.downloadFile(G)}async getImageWidthAndHeight(O){return new Promise((B=>{const U=new Image;U.src=O,U.onload=()=>{B({width:U.width,height:U.height})},U.onerror=O=>{var U;null===(U=this.log)||void 0===U||U.error(this,this.getImageWidthAndHeight,`Get image width and height failed: ${O}`),B({width:0,height:0})}}))}async generateDocxFileByDocxLib(O){const{Document:B,Paragraph:U,Packer:G,ExternalHyperlink:q,ImageRun:j,AlignmentType:W}=O,Y=await this.contextMessages.reduce((async(O,B)=>{const{type:G,author:Y,text:K=""}=B,Q=this.enableMessageExportWithPlainText?markdown_to_plain_text(K):K,{exportedFileUserTitle:Z,exportedFileBotTitle:X}=this.config.strings,createParagraphText=O=>new U({text:O,style:"paragraph-text"}),createBotHostParagraph=async()=>{const O=await this.getAnswerScreenshot(B),G=this.removeAnswerCardUrlParam(B.contentUrl),{width:Y,height:K}=await this.getImageWidthAndHeight(O);return Y&&K?[createParagraphText(""),new U({children:[new q({children:[new j({data:O,transformation:{width:700,height:550}})],link:G})],alignment:W.CENTER}),createParagraphText("")]:[createParagraphText(Q),createParagraphText(G)]},createBotTextParagraphs=()=>{const O=this.removeCitation(Q).split("\n");return[new U({text:X,style:"bot-title"}),...O.map(createParagraphText)]};return Y===Yi.User?[...await O,new U({text:Z,style:"user-title"}),createParagraphText(Q)]:Y===Yi.Bot&&G===vp.Host?[...await O,...await createBotHostParagraph()]:Y===Yi.Bot&&G===vp.Text?[...await O,...createBotTextParagraphs()]:O}),Promise.resolve([])),K=new B(function(O,B,U){return{...getDocxStyleConfig(B),sections:[{...createSections(B,U),children:O}]}}(Y,window.docx,this.exportOptions)),Q=await G.toBlob(K);this.downloadFile(Q)}createPdfIframe(O){const B=document.createElement("iframe");return B.id=this.pdfIframeID,B.style.display="none",B.srcdoc=O,document.body.appendChild(B),B}removePdfContainer(){this.pdfWindow&&(this.pdfWindow.close(),this.pdfWindow=null);const O=document.getElementById(this.pdfIframeID);O&&"IFRAME"===O.tagName&&document.body.removeChild(O)}renderHtml(O){return this.markdownParser.render(O)}formatUserMessage(O){const{exportedFileUserTitle:B}=this.config.strings;switch(this.fileType){case up.Pdf:return`<div class="user-title">${B}</div>\n\n${O}\n`;case up.Docx:return this.config.features.enableExportDocxWithFormat?`<user-message>\n${B}\n</user-message>\n\n${O}\n`:`{DOUBLE_HASHTAG} ${B}\n\n${O}\n`;case up.Txt:default:return`{DOUBLE_HASHTAG} ${B}\n\n${O}\n`}}formatBotTextMessage(O){const{exportedFileBotTitle:B}=this.config.strings;switch(O=this.removeCitation(O),this.fileType){case up.Pdf:return`<div class="bot-title">${B}</div>\n\n${O}\n`;case up.Docx:return this.config.features.enableExportDocxWithFormat?`<bot-message>\n${B}\n</bot-message>\n\n${O}\n`:`{DOUBLE_HASHTAG} ${B}\n\n${O}\n`;case up.Txt:default:return`{DOUBLE_HASHTAG} ${B}\n\n${O}\n`}}removeAnswerCardUrlParam(O){return O.replace("showselans=1&","")}async formatBotHostMessage(O,B){const{contentUrl:U}=O,G=this.removeAnswerCardUrlParam(U),{exportedFileBotTitle:q}=this.config.strings;switch(this.fileType){case up.Pdf:{const U=await this.getAnswerScreenshot(O);return`<div class="bot-title">${q}</div>${U?`\n\n<a href="${G}" target="_blank" style="width:100%;height:auto;display:block;"><img style="width:100%;height:auto;" src="${U}" alt="${B}"></img></a>\n`:`\n\n${B}\n\n${G}\n\n`}`}case up.Docx:return`<bot-message>\n${q}\n</bot-message>\n\n${B}\n\n${G}\n\n`;case up.Txt:default:return`{DOUBLE_HASHTAG} ${q}\n\n${B}\n${G}\n\n`}}removeCitation(O){return O.replace(/\[\^\d+\^\]/g,"")}async getAnswerScreenshot(O){var B,U;const G=null===(B=document.querySelector(".cib-serp-main"))||void 0===B?void 0:B.shadowRoot;if(!G)return"";let q=null;const j=findElementsInShadowRoot("iframe",G);for(let B=0;B<(null==j?void 0:j.length);B++){const U=j[B];if(new URL(U.src).searchParams.get("iframeid")===O.messageId){q=U;break}}if(!q)return"";try{return await this.screenshotService.captureIframeImageAsync(q)}catch(O){return null===(U=this.log)||void 0===U||U.error(this,this.getAnswerScreenshot,`Capture iframe image failed: ${O}`),""}}};var th;eh=__decorate([__param(0,ql),__param(1,$c),__param(2,Sp),__param(3,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object])],eh),function(O){O.Positive="Positive",O.Negative="Negative",O.Offensive="Offensive"}(th||(th={}));const ih=kt.createInterface();let rh=class{constructor(O,B,U){var G;this.config=O,this.log=U,null===(G=this.log)||void 0===G||G.trace(this,"ctor",null).write(),this._conversation=B}async sendFeedbackAsync(O,B,U){var G,q,j,W;null===(G=this.log)||void 0===G||G.trace(this,this.sendFeedbackAsync,"enter").write(),this.sydneyMessage=B;const Y=B.messageId,K=await this.postFeedbackAsync(O,Y,U);if(K.ok)return null===(q=this.log)||void 0===q||q.trace(this,this.sendFeedbackAsync,"successful exit").write(),K.json();{const O=await K.json();throw null===(j=this.log)||void 0===j||j.error(this,this.sendFeedbackAsync,`non-2xx from SendFeedback - status: ${K.status} - statusText ${K.statusText} - body: ${JSON.stringify(O)}`).write(),null===(W=this.log)||void 0===W||W.trace(this,this.sendFeedbackAsync,"non-200: throwing exit").write(),new Error("non-2xx from SendFeedback")}}async sendInlineFeedbackAsync(O,B){var U,G,q,j;null===(U=this.log)||void 0===U||U.trace(this,this.sendInlineFeedbackAsync,"enter").write();const W=await this.postFeedbackFormAsync(B,O);if(W.ok)return null===(G=this.log)||void 0===G||G.trace(this,this.sendInlineFeedbackAsync,"successful exit").write(),W.json();{const O=await W.json();throw null===(q=this.log)||void 0===q||q.error(this,this.sendInlineFeedbackAsync,`non-2xx from SendFeedbackForm - status: ${W.status} - statusText ${W.statusText} - body: ${JSON.stringify(O)}`).write(),null===(j=this.log)||void 0===j||j.trace(this,this.sendInlineFeedbackAsync,"non-200: throwing exit").write(),new Error("non-2xx from SendFeedbackForm")}}async postFeedbackAsync(O,B,U){var G;const{baseUrl:q,pathBase:j,pathFeedback:W}=this.config.sydney,Y=`${q}${j}${W}`,K={feedback:{type:"Positive"===O?"Positive":"Negative",updatedOn:(new Date).toISOString(),tag:O},isAdding:U,messageId:B,conversationId:this._conversation.id,source:this.config.sydney.request.source,traceId:this.config.sydney.request.messageCorrelationId,sliceIds:this.config.sydney.request.sliceIds};return this.config.features.enableSecureSendFeedback&&(K.conversationSignature=this._conversation.hashedSignature,K.participant={id:this._conversation.clientId}),null===(G=this.log)||void 0===G||G.trace(this,this.postFeedbackAsync,`body: ${JSON.stringify(K)}`).write(),fetch(Y,{body:JSON.stringify(K),headers:{"content-type":"application/json"},method:"POST"})}async postFeedbackFormAsync(O,B){var U,G,q,j,W;const Y=(new Date).toISOString(),K=window.location.href,Q=new URL(K).searchParams.get("q"),Z=null===(U=window._G)||void 0===U?void 0:U.EventID,X=null===(G=window._G)||void 0===G?void 0:G.IG,J=this.sydneyMessage.text,ee=this._conversation.messages.findIndex((O=>O.messageId===this.sydneyMessage.messageId)),te=null===(q=this._conversation.messages.slice(0,ee).reverse().find((O=>"user"===O.author)))||void 0===q?void 0:q.text,ie=null===(j=this._conversation.messages.slice(0,ee).reverse().find((O=>O.requestId===this.sydneyMessage.requestId&&"InternalSearchQuery"===O.messageType)))||void 0===j?void 0:j.text,re=this._conversation.suggestions.map((O=>O.text)),ne={partner:"BingLegacy",type:"3",feedbackType:"feedback",vertical:"web",text:O,query:Q,url:K,timeStamp:Y,structured_data:{conversationId:this._conversation.id,userDSATReason:B,userMessage:te,sydneySearchQuery:ie,sydneyMessage:J,suggestionchips:re,optionSets:this.config.sydney.request.optionsSets},traceId:Z,impression_guid:X};return null===(W=this.log)||void 0===W||W.trace(this,this.postFeedbackAsync,`body: ${JSON.stringify(ne)}`).write(),fetch("/feedback/submission",{body:JSON.stringify(ne),headers:{"content-type":"application/json"},method:"POST"})}};rh=__decorate([__param(0,ql),__param(1,Dc),__param(2,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object])],rh);const nh=kt.createInterface();var oh,ah;(function(O){O[O.None=0]="None",O[O.AnswerIncorrectOrIrrelevant=4]="AnswerIncorrectOrIrrelevant",O[O.Other=64]="Other",O[O.Inappropriate=16384]="Inappropriate",O[O.Inaccurate=33554432]="Inaccurate",O[O.Offensive=67108864]="Offensive"})(oh||(oh={})),function(O){O[O.None=0]="None",O[O.ThumbsDown=1]="ThumbsDown",O[O.ThumbsUp=2]="ThumbsUp"}(ah||(ah={}));let sh=class{constructor(O,B,U){var G;this.config=O,this.log=U,null===(G=this.log)||void 0===G||G.trace(this,"ctor",null).write(),this._conversation=B}async sendFeedbackAsync(O,B){var U,G,q,j;null===(U=this.log)||void 0===U||U.trace(this,this.sendFeedbackAsync,"enter").write(),this.sydneyMessage=B;const W=B.messageId,Y=await this.postFeedbackAsync(O,W);if(Y.ok)return null===(G=this.log)||void 0===G||G.trace(this,this.sendFeedbackAsync,"successful exit").write(),Y.json();{const O=await Y.json();throw null===(q=this.log)||void 0===q||q.error(this,this.sendFeedbackAsync,`non-2xx from SendFeedback - status: ${Y.status} - statusText ${Y.statusText} - body: ${JSON.stringify(O)}`).write(),null===(j=this.log)||void 0===j||j.trace(this,this.sendFeedbackAsync,"non-200: throwing exit").write(),new Error("non-2xx from SendFeedback")}}async sendInlineFeedbackAsync(O,B){var U,G,q,j,W;null===(U=this.log)||void 0===U||U.trace(this,this.sendInlineFeedbackAsync,"enter").write();const Y=null===(G=this._conversation.lastMessage)||void 0===G?void 0:G.messageId,K=B,Q=this.mapTo3sReasonType(O),Z=await this.postFeedbackAsync("Negative",Y,K,Q);if(Z.ok)return null===(q=this.log)||void 0===q||q.trace(this,this.sendInlineFeedbackAsync,"successful exit").write(),Z.json();{const O=await Z.json();throw null===(j=this.log)||void 0===j||j.error(this,this.sendInlineFeedbackAsync,`non-2xx from sendInlineFeedbackAsync - status: ${Z.status} - statusText ${Z.statusText} - body: ${JSON.stringify(O)}`).write(),null===(W=this.log)||void 0===W||W.trace(this,this.sendInlineFeedbackAsync,"non-200: throwing exit").write(),new Error("non-2xx from sendInlineFeedbackAsync")}}async postFeedbackAsync(O,B,U="",G=oh.None){var q;const j=this.getIdTokenFromUrl(),W=await this.acquireTenantFeedbackToken(j),{feedbackApi:Y}=this.config.bingAtWork,K=this.mapFeedBackKindToRating(O),Q={attachments:[],feedbackId:B,clientName:this.config.bingAtWork.tenantFeedBackClientName,correlationId:this._conversation.id,answerType:this.config.bingAtWork.tenantFeedBackAnswerType,description:U,feedbackRating:K,userConsentGiven:!0,date:(new Date).toUTCString(),feedbackReasonType:G,optionalFields:{ConvId:this._conversation.id,TraceId:B,Endpoint:this.getSydneyEndpoint()}};return null===(q=this.log)||void 0===q||q.trace(this,this.postFeedbackAsync,`body: ${JSON.stringify(Q)}`).write(),fetch(this.config.buildUrl(Y),{body:JSON.stringify(Q),headers:{Authorization:"Bearer "+W,"content-type":"application/json",accept:"application/json",credentials:"include"},method:"POST"})}mapFeedBackKindToRating(O){return"Positive"===O?ah.ThumbsUp:"Negative"===O?ah.ThumbsDown:ah.None}async acquireTenantFeedbackToken(O){var B,U,G;const q=[];O&&q.push(["authorization","Bearer "+O]);const j=await fetch(this.config.buildUrl(this.config.bingAtWork.feedbackTokenApi),{headers:q,method:"GET",credentials:"include"});if(!j.ok){const O=await j.json();throw null===(U=this.log)||void 0===U||U.error(this,this.acquireTenantFeedbackToken,`non-2xx from acquireTenantFeedbackToken - status: ${j.status} - statusText ${j.statusText} - body: ${JSON.stringify(O)}`).write(),null===(G=this.log)||void 0===G||G.trace(this,this.acquireTenantFeedbackToken,"non-200: throwing exit").write(),new Error("non-2xx from acquireTenantFeedbackToken")}null===(B=this.log)||void 0===B||B.trace(this,this.acquireTenantFeedbackToken,"successful exit").write();return(await j.json()).token}getIdTokenFromUrl(){const O=window.location.search;return new URLSearchParams(O).get("token")}getSydneyEndpoint(){const{baseUrl:O,pathBase:B,pathChatHub:U}=this.config.sydney;return`${O.replace("https://","wss://")}${B}${U.split("?")[0]}`}mapTo3sReasonType(O){switch(O){case"Inaccurate":return oh.Inaccurate;case"Inappropriate":return oh.Inappropriate;case"Offensive":return oh.Offensive;case"Irrelevant":return oh.AnswerIncorrectOrIrrelevant;case"Other":return oh.Other}return oh.None}};sh=__decorate([__param(0,ql),__param(1,Dc),__param(2,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object])],sh);const lh=kt.createInterface("IFeedbackFormService");var ch;(function(O){O.Modal="modal",O.Tooltip="tooltip"})(ch||(ch={}));let dh=class FeedbackFormService{constructor(O,B,U){var G;this.conversation=O,this.config=B,this.log=U,null===(G=this.log)||void 0===G||G.trace(this,"ctor",null).write()}openFeedbackForm(){var O,B,U,G;window.sj_evt&&window.sj_evt.fire?(this.conversation.id||null===(B=this.log)||void 0===B||B.info(this,this.openFeedbackForm,"No conversationId found").write(),null===(U=this.log)||void 0===U||U.info(this,this.openFeedbackForm,"Attempting to open feedback form").write(),window.sj_evt.fire("feedbackformrequested",{structuredData:{conversationId:null!==(G=this.conversation.id)&&void 0!==G?G:""},clientSideScreenshot:!!this.config.features.enableFeedbackClientSideScreenshot})):null===(O=this.log)||void 0===O||O.info(this,this.openFeedbackForm,"window.sj_evt object not found, failed to open form").write()}createShareControl(O,B,U){var G,q,j;const W="GlobalActionMenuV2Wrapper.Create",Y=O,K=null!==(G=this.createConfig)&&void 0!==G?G:{CustomizedTitle:this.config.strings.feedbackShareAnswer,CustomizedContent:this.config.strings.feedbackShareContent,ScenarioNameUsedForLog:B,DisablePositioningActionMenuContent:!0,DisableTopActions:!0,DisplayMode:U,ElementIdForScreenshot:"enable"};null===(q=this.log)||void 0===q||q.info(this,this.createShareControl,`Firing ${W} with args:`,{targetElement:Y,config:K}).write(),null===(j=window.sj_evt)||void 0===j||j.fire(W,Y,K)}updateShareControl(O,B,U,G,q){var j,W,Y;const K=null!==(j=this.updateConfig)&&void 0!==j?j:{UrlOverride:B,CustomizedTitle:U,ElementForScreenshot:G};q&&(null==q?void 0:q.length)>0?K.ScreenshotThumbnailId=q:(null==O?void 0:O.hasAttribute(FeedbackFormService.shareControlThumbnailIdDataKey))&&(null==O||O.removeAttribute(FeedbackFormService.shareControlThumbnailIdDataKey)),null===(W=this.log)||void 0===W||W.info(this,this.updateShareControl,"Firing GlobalActionMenuV2Wrapper.Update with args:",{shareControl:O,config:K}).write(),null===(Y=window.sj_evt)||void 0===Y||Y.fire("GlobalActionMenuV2Wrapper.Update",O,K)}populateShareControl(O,B,U,G,q){var j,W,Y;const K=null!==(j=this.updateConfig)&&void 0!==j?j:{UrlOverride:B,CustomizedTitle:U,ElementForScreenshot:G,LoadingUI:!0};q&&(null==q?void 0:q.length)>0?K.ScreenshotThumbnailId=q:(null==O?void 0:O.hasAttribute(FeedbackFormService.shareControlThumbnailIdDataKey))&&(null==O||O.removeAttribute(FeedbackFormService.shareControlThumbnailIdDataKey)),null===(W=this.log)||void 0===W||W.info(this,this.populateShareControl,"Firing GlobalActionMenuV2Wrapper.Update with args:",{shareControl:O,config:K}).write(),null===(Y=window.sj_evt)||void 0===Y||Y.fire("GlobalActionMenuV2Wrapper.Update",O,K)}showShareControl(O,B){var U,G;null===(U=this.log)||void 0===U||U.info(this,this.showShareControl,"Firing GlobalActionMenuV2Wrapper.ShowActionMenuContent",{shareCommonControl:O,shareButton:B}).write(),null===(G=window.sj_evt)||void 0===G||G.fire("GlobalActionMenuV2Wrapper.ShowActionMenuContent",O,B)}showShareControlWithLoadingUI(O,B){var U,G;null===(U=this.log)||void 0===U||U.info(this,this.showShareControl,"Firing GlobalActionMenuV2Wrapper.ShowActionMenuContentWithLoadingUI",{shareCommonControl:O,shareButton:B}).write(),null===(G=window.sj_evt)||void 0===G||G.fire("GlobalActionMenuV2Wrapper.ShowActionMenuContentWithLoadingUI",O,B)}hideShareControl(O){var B,U;null===(B=this.log)||void 0===B||B.info(this,this.hideShareControl,"Firing GlobalActionMenuV2Wrapper.HideActionMenuContent",O).write(),null===(U=window.sj_evt)||void 0===U||U.fire("GlobalActionMenuV2Wrapper.HideActionMenuContent",O)}};dh.shareControlThumbnailIdDataKey="data-thumbnailid",dh=__decorate([__param(0,Dc),__param(1,ql),__param(2,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object])],dh);class MessagingHooksProvider extends lifecycle_Disposable{constructor(){super(...arguments),this._sydneyMessageRendered=this._register(new Emitter),this._sydneyInteractionReady=this._register(new Emitter),this._chatTurnCompleted=this._register(new Emitter)}registerMessagingHooks(O){O.handleChatTurnCompleted&&this._register(this.onChatTurnCompleted(O.handleChatTurnCompleted)),O.handleSydneyInteractionReady&&this._register(this.onSydneyInteractionReady(O.handleSydneyInteractionReady)),O.handleSydneyMessageRendered&&this._register(this.onSydneyMessageRendered(O.handleSydneyMessageRendered)),O.hookIncomingSydneyMessageAsync&&(this.hookIncomingSydneyMessageAsync=O.hookIncomingSydneyMessageAsync),O.hookOutgoingUserMessageAsync&&(this.hookOutgoingUserMessageAsync=O.hookOutgoingUserMessageAsync)}fireOnSydneyMessageRendered(O){this._sydneyMessageRendered.fire(O)}get onSydneyMessageRendered(){return this._sydneyMessageRendered.event}get onSydneyInteractionReady(){return this._sydneyInteractionReady.event}fireOnSydneyInteractionReady(){this._sydneyInteractionReady.fire()}get onChatTurnCompleted(){return this._chatTurnCompleted.event}fireOnChatTurnCompleted(){return this._chatTurnCompleted.fire()}}var ph;(function(O){O[O.NormalMessage=0]="NormalMessage",O[O.NewTopicMessage=1]="NewTopicMessage",O[O.CustomMessage=2]="CustomMessage"})(ph||(ph={}));const uh=kt.createInterface("IConversationManager"),hh=kt.createInterface("IMessageModelFactory");let mh=class extends lifecycle_Disposable{constructor(O,B,U){super(),this.manager=O,this.chat=B,this.modelFactory=U}sendOnBehalfUserAsync(O,B){var U;return null===(U=this.manager)||void 0===U||U.sendMessage(O,!1,B),Promise.resolve()}sendOnBehalfOfSydneyAsync(O){var B;return null===(B=this.manager)||void 0===B||B.addBotMessage(O),Promise.resolve()}triggerTypingIndicator(){this.toggleConversationState(!0)}endTriggerTypingIndicator(){this.toggleConversationState(!1)}toggleConversationState(O){this.chat.isRequestPending=O}createTextMessageModel(O,B){const U=Yi.Bot,G=this.modelFactory.createLocalText({text:O,author:U,reportable:!1});if(!B)return G;for(let O=0;O<B.length;O++){const U=this.createSuggestedResponse(B[O]);G.suggestedResponses.push(U)}return G}createActionChipTextMessageModel(O,B){const U=Yi.Bot,G=this.modelFactory.createLocalText({text:O,author:U,reportable:!1});if(!B)return G;for(let O=0;O<B.length;O++){const U=this.updateActionChipSuggestedResponse(B[O]);G.suggestedResponses.push(U)}return G}createAdaptiveCardTextMessageModel(O,B){var U;const G=this.createTextMessageModel("",B);return null===O||(null===G.adaptiveCards?(G.adaptiveCards=[],G.adaptiveCards.push(O)):null===(U=G.adaptiveCards)||void 0===U||U.push(O)),G}createMetaMessageModel(O,B){const U=Yi.Bot;return this.modelFactory.createLocalMeta({text:O,author:U,reportable:!1},!1,B)}createExternalHTMLMessageModel(O,B){const U=Yi.Bot,G=this.modelFactory.createLocalHTML({text:O,author:U});if(!B)return G;for(let O=0;O<B.length;O++){const U=this.createSuggestedResponse(B[O]);G.suggestedResponses.push(U)}return G}createFullBleedMessageModel(O,B){const U=Yi.Bot,G=this.modelFactory.createLocalFullBleed({text:O,author:U});if(!B)return G;for(let O=0;O<B.length;O++){const U=this.createSuggestedResponse(B[O]);G.suggestedResponses.push(U)}return G}createSuggestedResponse(O){return{text:O,author:void 0,messageType:tr.Suggestion,contentOrigin:Ki.DeepLeo,offense:nr.Unknown,messageId:"",requestId:void 0,hiddenText:void 0,privacy:null}}updateActionChipSuggestedResponse(O){return{text:null==O?void 0:O.text,author:void 0,messageType:tr.Suggestion,contentOrigin:Ki.DeepLeo,offense:nr.Unknown,messageId:"",requestId:void 0,hiddenText:void 0,privacy:null,action:null==O?void 0:O.action}}};mh=__decorate([__param(0,uh),__param(1,Mc),__param(2,hh),__metadata("design:paramtypes",[Object,Object,Object])],mh);const gh=kt.createInterface(),fh=kt.createInterface();let yh=class extends lifecycle_Disposable{constructor(O,B){var U;super(),this.provider=O,this.log=B,null===(U=this.log)||void 0===U||U.trace(this,"ctor",null).write()}get activeState(){return this.provider.activeState}get onActiveStateChanged(){return this.provider.onActiveStateChanged}};yh=__decorate([__param(0,fh),__param(1,Nt(Pi)),__metadata("design:paramtypes",[Object,Object])],yh);const _h=kt.createInterface();var vh,bh;(function(O){O.Inline="inline",O.Toast="toast",O.StackedInline="stacked-inline"})(vh||(vh={})),function(O){O[O.Loading=0]="Loading",O[O.Warning=1]="Warning",O[O.Information=2]="Information",O[O.Success=3]="Success"}(bh||(bh={}));class NotificationService{constructor(){}get floatingBarNotification(){return this._floatingNotification}sendFloatingBarNotification(O=null){this._floatingNotification=O}removeFloatingBarNotification(){const O=this._floatingNotification;return this.sendFloatingBarNotification(),O}get bottomBarNotification(){return this._bottomBarNotification}sendBottomBarNotification(O=null){this._bottomBarNotification=O}removeBottomBarNotification(){const O=this._bottomBarNotification;return this.sendBottomBarNotification(),O}get isNotificationActive(){var O;return null!==(null!==(O=this.bottomBarNotification)&&void 0!==O?O:this.floatingBarNotification)}}__decorate([observable,__metadata("design:type",Object)],NotificationService.prototype,"_floatingNotification",void 0),__decorate([observable,__metadata("design:type",Object)],NotificationService.prototype,"_bottomBarNotification",void 0);const Sh=kt.createInterface();let Ch=class{constructor(O,B,U){var G;this.config=O,this.log=U,null===(G=this.log)||void 0===G||G.trace(this,"ctor",null).write(),this.conversation=B}async saveEdits(O){var B,U,G;null===(B=this.log)||void 0===B||B.trace(this,this.saveEdits,"enter").write();try{const B=this.createRequest(O),G=await this.postRenameChatAsync(B);if(G.ok)return G.json();{const O=await G.json();throw null===(U=this.log)||void 0===U||U.error(this,this.saveEdits,`non-2xx from Edit/Rename thread - status: ${G.status} - statusText ${G.statusText} - body: ${JSON.stringify(O)}`).write(),new Error(`non-2xx from Rename/Edit thread - status: ${G.status} - statusText ${G.statusText}`)}}catch(O){null===(G=this.log)||void 0===G||G.error(this,this.saveEdits,`Error saving edits while renaming ${this.conversation.id}: ${O}`).write();const B=`Rename/Edit thread failed.: ${this.conversation.id}`,U=ensureErrorInstance(O);throw new Error(B,U)}}createRequest(O){var B;if(!O||!O.conversationId||!O.conversationSignature)throw null===(B=this.log)||void 0===B||B.trace(this,this.createRequest,"Thread is required to generate renameChat request").write(),new Error("Unable to generate rename chat request");return{conversationId:O.conversationId,participant:{id:this.conversation.clientId},chatName:O.chatName,conversationSignature:O.conversationSignature,source:"cib",optionsSets:["autosave"]}}async postRenameChatAsync(O){const{baseUrl:B,pathBase:U,pathEditThread:G}=this.config.sydney;return fetch(`${B}${U}${G}`,{body:JSON.stringify(O),headers:{"content-type":"application/json"},method:"POST"})}};Ch=__decorate([__param(0,ql),__param(1,Dc),__param(2,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object])],Ch);const Eh=kt.createInterface();let xh=class{constructor(O,B,U){var G;this.config=O,this.conversation=B,this.log=U,this.optionSets=["autosave"],null===(G=this.log)||void 0===G||G.trace(this,"ctor",null).write()}async deleteConversation(O){var B,U;try{const U=this.createRequest(O),G=await this.postDeleteConversationAsync(U);if(G.ok)return G.json();{const O=await G.json();throw null===(B=this.log)||void 0===B||B.error(this,this.deleteConversation,`non-2xx from DeleteConversation - status: ${G.status} - statusText ${G.statusText} - body: ${JSON.stringify(O)}`).write(),new Error(`non-2xx from DeleteConversation - ${G.statusText}`)}}catch(B){null===(U=this.log)||void 0===U||U.error(this,this.deleteConversation,`Failed to DeleteConversation/s: ${B}`).write();const G=`Failed to DeleteConversation/s for conversationIdsToDelete: ${O}`,q=ensureErrorInstance(B);throw new Error(G,q)}}async deleteSingleConversationAsync(O){var B,U;try{const U=this.createSingleDeleteRequest(O),G=await this.postSingleDeleteConversationAsync(U);if(G.ok)return G.json();{const O=await G.json();throw null===(B=this.log)||void 0===B||B.error(this,this.deleteSingleConversationAsync,`non-2xx from DeleteConversation - status: ${G.status} - statusText ${G.statusText} - body: ${JSON.stringify(O)}`).write(),new Error("non-2xx from DeleteConversation")}}catch(B){null===(U=this.log)||void 0===U||U.error(this,this.deleteConversation,`Failed to DeleteConversation/s: ${B}`).write();const G=`Failed to DeleteConversation/s for conversationIdsToDelete: ${O}`,q=ensureErrorInstance(B);throw new Error(G,q)}}createRequest(O){var B;if(O&&Array.isArray(O)&&0!==O.length)return{conversationIdsToDelete:O};throw null===(B=this.log)||void 0===B||B.trace(this,this.createRequest,`Unable to generate Delete conversation request: conversationIdsToDelete: ${O}`).write(),new Error("ConversationIdsToDelete is required to create a DeleteConversation request")}createSingleDeleteRequest(O){return{conversationId:O.conversationId,conversationSignature:O.conversationSignature,participant:{id:this.conversation.clientId},source:this.config.sydney.request.source,optionsSets:this.optionSets}}async postDeleteConversationAsync(O){const{baseUrl:B,pathBase:U,pathDeleteConversation:G}=this.config.sydney;return fetch(`${B}${U}${G}`,{body:JSON.stringify(O),headers:{"content-type":"application/json"},method:"POST"})}async postSingleDeleteConversationAsync(O){const{baseUrl:B,pathBase:U,pathDeleteSingleConversation:G}=this.config.sydney;return fetch(`${B}${U}${G}`,{body:JSON.stringify(O),headers:{"content-type":"application/json"},method:"POST"})}};xh=__decorate([__param(0,ql),__param(1,Dc),__param(2,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object])],xh);const Th=kt.createInterface();let wh=class{constructor(O,B){var U;this.api=O,this.log=B,null===(U=this.log)||void 0===U||U.trace(this,"ctor",null).write()}async getChats(){var O,B,U;try{const U=await this.api.bing.conversation.getChats();if(this.isResponseValid(U))return null===(O=this.log)||void 0===O||O.trace(this,this.getChats,"Successfully fetched the chats for the current user").write(),U;{const O="No chats found for the current user";throw null===(B=this.log)||void 0===B||B.error(this,this.getChats,O).write(),new Error(O)}}catch(O){null===(U=this.log)||void 0===U||U.error(this,this.getChats,`Error getting chats: ${O}`).write();const B=ensureErrorInstance(O);throw new Error("Error getting chats",B)}}isResponseValid(O){var B;return!!O.chats||(null===(B=this.log)||void 0===B||B.error(this,this.isResponseValid,"No chats were found in the /chats response").write(),!1)}};wh=__decorate([__param(0,Ii),__param(1,Nt(Pi)),__metadata("design:paramtypes",[Object,Object])],wh);let kh=class extends lifecycle_Disposable{constructor(O,B,U,G,q,j){var W;super(),this.notification=O,this.services=B,this.config=U,this.telemetry=G,this.networkError=q,this.log=j,this.onAppErrorStateChangeEmitter=this._register(new Emitter),this.onChatErrorStateChangeEmitter=this._register(new Emitter),this.onChatWarningStateChangeEmitter=this._register(new Emitter),this._chatErrorState=Gc.OK,this._appErrorState=Vc.OK,this._chatWarningState=Hc.OK,this._fateCounter=0,this._suspensionEndTime=Number.MAX_SAFE_INTEGER,this._suspensionTimeLocalstorageKey="cib__suspended",this.handleResetRequest=O=>{this.telemetry.trackEvent("InteractionEvent","NotificationResetClick",{Namespace:"Conversation",CustomData:this.networkError.createNetworkErrorCustomdatafromNotification(O)}),this.clearAllNotifications(),this.services.get(uh).resetConversation()},this.handleLoginRequest=O=>{var B;if(this.config.features.enableRedirectToLoginUrl)if(this.telemetry.trackEvent("InteractionEvent","NotificationLoginClick",{Namespace:"Conversation",CustomData:this.networkError.createNetworkErrorCustomdatafromNotification(O)}),this.config.partner.openLinksWindowTop){const O=null!==(B=this.config.partner.overrideRedirectUrl)&&void 0!==B?B:this.config.buildUrl(this.config.bing.signIn);window.open(O,"_top")}else this.config.bing.requestLogin(this.config)},this.handleResendLastMessage=O=>{var B;this.telemetry.trackEvent("InteractionEvent","NotificationResendLastMessageClick",{Namespace:"Conversation",CustomData:this.networkError.createNetworkErrorCustomdatafromNotification(O)}),this.clearAllNotifications();const{messages:U}=this.services.get(Dc),G=U[U.length-1];G.author===Yi.User?this.services.get(Mc).submitMessage(G.text):null===(B=this.log)||void 0===B||B.warn(this,this.handleResendLastMessage,"User elected to resend last message, but last message was authored by the bot.").write()},null===(W=this.log)||void 0===W||W.trace(this,"ctor",null).write(),this.config.features.enableErrorStateNotification&&(this.checkSuspensionState(),this.attachNetworkStateEvents())}get onAppErrorStateChange(){return this.onAppErrorStateChangeEmitter.event}get appErrorState(){return this._appErrorState}setAppErrorState(O=Vc.OK,B){if(this.config.features.enableErrorStateNotification)if(this._appErrorState=O,O===Vc.OK)this.clearAllNotifications();else if(!this.notification.isNotificationActive){const U=this.createNotificationBody(O,B);this.notification.sendFloatingBarNotification(U),this.onAppErrorStateChangeEmitter.fire(O)}}isChatDisabled(){return!!this.config.features.enableErrorStateNotification&&(this._chatErrorState!==Gc.OK||this._appErrorState!==Vc.OK||this._chatWarningState!==Hc.OK)}get onChatErrorStateChange(){return this.onChatErrorStateChangeEmitter.event}get chatErrorState(){return this._chatErrorState}setChatErrorState(O=Gc.OK,B){if(this.config.features.enableErrorStateNotification)if(this._chatErrorState=O,O===Gc.OK)this.clearAllNotifications();else{const U=this.createNotificationBody(O,B);this.notification.sendBottomBarNotification(U),this.onChatErrorStateChangeEmitter.fire(O)}}increamentFateCounter(O=1){if(this.config.features.enableErrorStateNotification)if(0===O)this._fateCounter=0;else if(this._fateCounter+=O,this._fateCounter>3){this.setChatErrorState(Gc.ChatSuspended);const O=Date.now()+864e5-6e4;localStorage.setItem(this._suspensionTimeLocalstorageKey,O.toString())}return this._fateCounter}get onChatWarningStateChange(){return this.onChatWarningStateChangeEmitter.event}get chatWarningState(){return this._chatWarningState}setChatWarningState(O=Hc.OK){if(this.config.features.enableErrorStateNotification)if(this._chatWarningState=O,O===Hc.OK)this.clearAllNotifications();else{const B=this.createNotificationBody(O);this.notification.sendFloatingBarNotification(B),this.onChatWarningStateChangeEmitter.fire(O)}}clearAllNotifications(){this._chatErrorState=Gc.OK,this._appErrorState=Vc.OK,this._chatWarningState=Hc.OK;const O=this.notification.removeFloatingBarNotification();(null==O?void 0:O.resetHandler)&&delete O.resetHandler;const B=this.notification.removeBottomBarNotification();(null==B?void 0:B.resetHandler)&&delete B.resetHandler}checkSuspensionState(){const O=localStorage.getItem(this._suspensionTimeLocalstorageKey);if(null!==O){const B=parseInt(O),U=B-Date.now();U>0?(this._suspensionEndTime=B,this.setChatErrorState(Gc.ChatSuspended),setTimeout((()=>{this.checkSuspensionState()}),U+100)):(localStorage.removeItem(this._suspensionTimeLocalstorageKey),this._chatErrorState===Gc.ChatSuspended&&this.clearAllNotifications())}}attachNetworkStateEvents(){window.addEventListener("online",(()=>{this.clearAllNotifications()})),window.addEventListener("offline",(()=>{this.setChatErrorState(Gc.NetworkOffline)}))}createNotificationBody(O,B){const U={notificationText:void 0,errorState:O,triggeredError:B};switch(O){case Gc.Generic:case Gc.NetworkFailure:case Gc.NetworkOffline:return U.notificationText=this.config.strings.notificationResetConversation,{text:this.config.strings.notificationResetConversation,cta:this.config.strings.notificationResetConversationCta,icon:bh.Warning,type:vh.Inline,resetHandler:()=>this.handleResetRequest(U)};case Gc.ChatDisabled:case Gc.ChatSuspended:const O=this.getSuspensionHoursLeftFormattedString();return{text:this.config.strings.notiChatEnd,subText:this.config.strings.notiRestartChat.replace("{0}",O),icon:bh.Warning,type:vh.Inline};case Gc.DailyLimit:case Gc.Unrecoverable:return{text:this.config.strings.notificationMaxTurnsPerDay,icon:bh.Warning,type:vh.Inline};case Gc.ConversationLimit:return{text:this.config.strings.notificationMaxTurnsPerConversation,icon:bh.Warning,type:vh.Inline};case Gc.ConversationLimitForMuidUsers:return U.notificationText=this.config.strings.notificationMaxTurnsForMuidUsers,{text:this.config.strings.notificationMaxTurnsForMuidUsers,cta:this.config.strings.notificationUnauthorizedMuidUsersCta,icon:bh.Warning,type:vh.Inline,resetHandler:()=>this.handleLoginRequest(U)};case Gc.Disengaged:return U.notificationText=this.config.strings.notificationDisengaged,{text:this.config.strings.notificationDisengaged,cta:this.config.strings.notificationResetConversationCta,icon:bh.Warning,type:vh.Inline,resetHandler:()=>this.handleResetRequest(U)};case Gc.Forbidden:return{text:this.config.strings.notificationForbidden,icon:bh.Warning,type:vh.Inline};case Gc.TooManyRequests:return{text:this.config.strings.notificationTooManyRequests,icon:bh.Warning,type:vh.Inline};case Gc.Unauthorized:return U.notificationText=this.config.strings.notificationUnauthorized,{text:this.config.strings.notificationUnauthorized,cta:this.config.strings.notificationUnauthorizedCta,icon:bh.Warning,type:vh.Inline,resetHandler:()=>this.handleLoginRequest(U)};case Gc.AttemptingToReconnect:return{text:this.config.strings.notificationAttemptingToReconnect,icon:bh.Warning,type:vh.Inline};case Gc.NetworkSettings:return{text:this.config.strings.notificationNetworkSettings,icon:bh.Warning,type:vh.Inline};case Gc.LostConnection:return U.notificationText=this.config.strings.notificationLostConnection,{text:this.config.strings.notificationLostConnection,cta:this.config.strings.notificationLostConnectionCta,icon:bh.Warning,type:vh.Inline,resetHandler:()=>this.handleResendLastMessage(U)};case Gc.MessageError:return U.notificationText=this.config.strings.notificationMessageError,{text:this.config.strings.notificationMessageError,cta:this.config.strings.notificationMessageErrorCta,icon:bh.Warning,type:vh.Inline,resetHandler:()=>this.handleResendLastMessage(U)};case Hc.Processing:return{text:this.config.strings.notificationProcessing,icon:bh.Loading,type:vh.Inline};case Gc.CaptchaChallenge:}return null}getSuspensionHoursLeftFormattedString(){if(this._suspensionEndTime>0){const O=(this._suspensionEndTime-Date.now())/36e5;return O<=1?"<1":O>=24?"24":Math.ceil(O).toString()}return""}};__decorate([observable,__metadata("design:type",String)],kh.prototype,"_chatErrorState",void 0),__decorate([observable,__metadata("design:type",String)],kh.prototype,"_appErrorState",void 0),__decorate([observable,__metadata("design:type",String)],kh.prototype,"_chatWarningState",void 0),kh=__decorate([__param(0,_h),__param(1,Rt),__param(2,ql),__param(3,$c),__param(4,Zc),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],kh);const Ah=kt.createInterface();var Rh;(function(O){O.FRE="FRE",O.RAI="RAI"})(Rh||(Rh={}));let Ih=class{constructor(O,B){var U;this.config=O,this.log=B,this.url="https://services.bingapis.com/suggestionchips/api/v1/cannedChips",null===(U=this.log)||void 0===U||U.trace(this,"ctor",null).write(),this.language=this.config.sydney.message.locale.split("-")[0]}async getFRESuggestions(O=1){var B,U,G,q;null===(B=this.log)||void 0===B||B.trace(this,this.getFRESuggestions,"enter").write();const j={type:Rh.FRE,Language:this.language,NumberOfChips:O};null===(U=this.log)||void 0===U||U.info(this,this.getFRESuggestions,`FRE suggestions payload: ${JSON.stringify(j)}`).write();try{return(await this.getCannedSuggestions(this.url,j)).suggestionChips}catch(O){throw O instanceof Error?null===(G=this.log)||void 0===G||G.error(this,this.getFRESuggestions,O.message).write():null===(q=this.log)||void 0===q||q.error(this,this.getFRESuggestions,"getFRESuggestions error").write(),new Error("Get FRE Suggestions error",{cause:O})}}async getRAISuggestions(O=3){var B,U,G,q;null===(B=this.log)||void 0===B||B.trace(this,this.getRAISuggestions,"enter").write();const j={type:Rh.RAI,Language:this.language,NumberOfChips:O};null===(U=this.log)||void 0===U||U.info(this,this.getRAISuggestions,`RAI suggestions payload: ${JSON.stringify(j)}`).write();try{return(await this.getCannedSuggestions(this.url,j)).suggestionChips}catch(O){throw O instanceof Error?null===(G=this.log)||void 0===G||G.error(this,this.getRAISuggestions,O.message).write():null===(q=this.log)||void 0===q||q.error(this,this.getRAISuggestions,"getRAISuggestions error").write(),new Error("Get RAI Suggestions error",{cause:O})}}async getCannedSuggestions(O,B){const U=await fetch(O,{body:JSON.stringify(B),headers:{"content-type":"application/json"},method:"POST"});if(U.ok)return U.json();const G=await U.json();throw new Error(`Get Canned Suggestiosn Request failed: non-2xx - status: ${U.status} - statusText ${U.statusText} - body: ${JSON.stringify(G)}`)}};Ih=__decorate([__param(0,ql),__param(1,Nt(Pi)),__metadata("design:paramtypes",[Object,Object])],Ih);const Ph=kt.createInterface();let Nh=class{constructor(O){this.config=O,this._firstTimeAccessedLocalStorageKey="cib__firstTimeAccessed",this._isFirstTime=!1,isUndefinedOrNull(localStorage)?this._isFirstTime=!1:(this._isFirstTime=!this.config.partner.disableFreTasks&&null===localStorage.getItem(this._firstTimeAccessedLocalStorageKey),this._isFirstTime&&localStorage.setItem(this._firstTimeAccessedLocalStorageKey,Date.now().toString()))}get isFirstTime(){return this._isFirstTime}};Nh=__decorate([__param(0,ql),__metadata("design:paramtypes",[Object])],Nh);const Oh=kt.createInterface();function createBotMessage(O,B){return{text:O,author:Yi.Bot,adaptiveCards:[],suggestedResponses:B.map((O=>function(O){return{text:O,contentOrigin:Ki.DeepLeo,messageType:tr.Suggestion,messageId:CoreUtils.uuid(),hiddenText:void 0,offense:nr.Unknown}}(O))),messageId:CoreUtils.uuid()}}let Mh=class{constructor(O,B){this.firstExpService=O,this.config=B}shouldAddInPrompt(){return!!this.config.features.enablePassBotGreetingInContext}get message(){return this.firstExpService.isFirstTime?createBotMessage(this.config.strings.newUserGreet,[this.config.strings.newUserSugg1,this.config.strings.newUserSugg2,this.config.strings.newUserSugg3]):createBotMessage(this.config.strings.repeatUserGreet,[this.config.strings.repeatUserSugg1,this.config.strings.repeatUserSugg2,this.config.strings.repeatUserSugg3])}get newTopicMessage(){const O=this.getRandomNumbers(1,10)[0],B=this.getRandomNumbers(3,25);return createBotMessage(this.config.strings[`newTopicGreet${O}`],B.map((O=>this.config.strings[`newTopicSugg${O}`])))}customGreetingMessage(O,B){return createBotMessage(O,B)}getToneGreetingMessage(O){let B,U;switch(O){case sr.Balanced:B=this.config.strings.balancedGreet,U=[this.config.strings.balancedSugg1,this.config.strings.balancedSugg2,this.config.strings.balancedSugg3];break;case sr.Creative:B=this.config.strings.creativeGreet,U=[this.config.strings.creativeSugg1,this.config.strings.creativeSugg2,this.config.strings.creativeSugg3];break;case sr.Precise:B=this.config.strings.preciseGreet,U=[this.config.strings.preciseSugg1,this.config.strings.preciseSugg2,this.config.strings.preciseSugg3]}return{message:B,suggestions:U}}getRandomNumbers(O,B,U=1){const G=new Set;for(;G.size<O;)G.add(U+Math.floor(Math.random()*B));return Array.from(G)}};Mh=__decorate([__param(0,Ph),__param(1,ql),__metadata("design:paramtypes",[Object,Object])],Mh);const Dh=kt.createInterface();class KatexCopyService{constructor(){this.defaultCopyDelimiters={inline:["$","$"],display:["$$","$$"]}}handleCopyEvent(O){var B;const U=O.currentTarget.parentNode,G=U&&U.getSelection&&U.getSelection();if(!G||!O.clipboardData)return!0;const q=O.clipboardData,j=G.getRangeAt(0);if(!j||j.collapsed)return!0;const W=this.closestKatex(j.startContainer);W&&j.setStartBefore(W);const Y=this.closestKatex(j.endContainer);Y&&j.setEndAfter(Y);const K=j.cloneContents();if(!K.querySelector(".katex-mathml, .katex math"))return!0;const Q=this.katexReplaceWithTex(j.cloneContents()),Z=K.querySelector("math")&&(null===(B=K.querySelector("math"))||void 0===B?void 0:B.outerHTML),X=Array.prototype.map.call(Q.childNodes,(O=>O instanceof Text?O.textContent:O.outerHTML)).join(""),J=Q.textContent;j.startContainer===j.endContainer&&Z?(q.setData("text/plain",Z),O.preventDefault()):J&&(q.setData("text/html",X),q.setData("text/plain",J),O.preventDefault())}katexReplaceWithTex(O,B=this.defaultCopyDelimiters){if(!O)return O;const U=O.querySelectorAll(".katex-mathml + .katex-html");for(let O=0;O<U.length;O++){const B=U[O].previousElementSibling;B&&B.remove?B.remove():B&&B.parentNode&&B.parentNode.removeChild(B)}return O}closestKatex(O){const B=O instanceof Element?O:O.parentElement;return B&&B.closest(".katex")}}const Lh=kt.createInterface("IShareService");let Bh=class{constructor(O,B,U){var G;this.config=O,this.chat=B,this.log=U,null===(G=this.log)||void 0===G||G.trace(this,"ctor",null).write(),this.shareMessagesUrl=this.config.sydney.baseUrl+this.config.sydney.pathBase+this.config.sydney.pathShareMessages}async getSharedMessagesAsync(O){var B;null===(B=this.log)||void 0===B||B.trace(this,this.getSharedMessagesAsync,null).write(),await this.chat.loadSharedMessagesAsync(O)}async shareMessagesAsync(O,B){var U,G,q,j,W;const Y=this.toMessages(O);if(0===Y.length)return null===(U=this.log)||void 0===U||U.error(this,this.shareMessagesAsync,"No message to share",O),Promise.reject(new Error("No message to share"));const K={messages:Y,source:"cib",metadata:B},Q=null===(G=O.find((O=>O.type===vp.Host&&O.renderUrl&&O.renderUrl.length>0)))||void 0===G?void 0:G.renderUrl;Q&&Q.length>0&&(K.metadata={renderUrl:Q});const Z=await fetch(this.shareMessagesUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...this.config.sydney.request,...K})});if(!Z.ok){null===(q=this.log)||void 0===q||q.error(this,this.shareMessagesAsync,"Failed to share messages",Z);const O=await Z.json();throw new Error(`Failed to share messages: ${null===(j=O.result)||void 0===j?void 0:j.message}`)}const X=await Z.json();return null===(W=this.log)||void 0===W||W.trace(this,this.shareMessagesAsync,"ShareMessages successfully returned shareId",X.shareId,X).write(),X}toMessages(O){const B=[];return O.forEach((O=>{var U;switch(O.type){case vp.Text:B.push({author:O.author,text:O.text,adaptiveCards:O.adaptiveCards,sourceAttributions:isTextMessageModel(O)?O.sourceAttributions:void 0,messageId:O.messageId,contentOrigin:O.contentOrigin});break;case vp.Host:B.push({author:O.author,text:O.text,adaptiveCards:O.adaptiveCards,messageId:O.messageId,contentOrigin:O.contentOrigin,contentType:O.contentType,messageType:O.messageType});break;default:null===(U=this.log)||void 0===U||U.error(this,this.toMessages,`Unsupported message type: ${O.type}`)}})),B}};var Fh,zh,$h,Uh,Vh,Gh,Hh;Bh=__decorate([__param(0,ql),__param(1,Mc),__param(2,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object])],Bh);class SystemEventBus extends lifecycle_Disposable{constructor(){super(...arguments),Fh.add(this),zh.set(this,this._register(new Emitter)),$h.set(this,this._register(new Emitter))}get onSystemCommand(){return __classPrivateFieldGet(this,zh,"f").event}get onSystemEvent(){return __classPrivateFieldGet(this,$h,"f").event}sendSystemCommand(O,B){__classPrivateFieldGet(this,Fh,"m",Vh).call(this,O,__classPrivateFieldGet(this,Fh,"m",Gh).call(this,B))}sendSystemEvent(O,B){__classPrivateFieldGet(this,Fh,"m",Uh).call(this,O,__classPrivateFieldGet(this,Fh,"m",Gh).call(this,B))}}zh=new WeakMap,$h=new WeakMap,Fh=new WeakSet,Uh=function(O,B){const U={type:O,data:B};__classPrivateFieldGet(this,$h,"f").fire(U)},Vh=function(O,B){const U={type:O,data:B};__classPrivateFieldGet(this,zh,"f").fire(U)},Gh=function(O){let B="";return null!=O&&(B="string"==typeof O?O:JSON.stringify(O)),B},function(O){O[O.ShowDialog=0]="ShowDialog",O[O.SetResponseTone=1]="SetResponseTone"}(Hh||(Hh={}));let qh=class{constructor(O){this.config=O}getTextSuggestion(O,B,U){let G=this.config.textPrediction.pathAutoSuggest;this.config.features.enableSuggHighTrigger?G+=this.config.textPrediction.highTrigger:G+=this.config.textPrediction.lowTrigger;const q=new URL(G,this.config.textPrediction.baseUrl);return fetch(q,this.getFetchOptions(O,B,U))}getFetchOptions(O,B,U){var G;return{method:"POST",headers:{"content-type":"application/json","Ocp-Apim-Subscription-Key":this.config.textPrediction.subscriptionKey},mode:"cors",body:JSON.stringify({text:O,previousText:B,market:U||(null===(G=this.config.textPrediction.query)||void 0===G?void 0:G.market)})}}};qh=__decorate([__param(0,ql),__metadata("design:paramtypes",[Object])],qh);const jh=kt.createInterface("ITuringAutoSuggestService");var Wh,Yh,Kh;let Qh=class extends lifecycle_Disposable{constructor(O,B){super(),this.config=O,this.log=B,Wh.set(this,void 0),Yh.set(this,null),Kh.set(this,null),this.currentKSeed=this.config.telemetry.kSeedBase,this.instSuffix=this.config.telemetry.instSuffix,this.configureBingHooks()}get externalLinkId(){var O;return __classPrivateFieldSet(this,Wh,null!==(O=__classPrivateFieldGet(this,Wh,"f"))&&void 0!==O?O:this.tryGetExternalLinkId(),"f"),__classPrivateFieldGet(this,Wh,"f")}get instrumentedLink(){var O;return __classPrivateFieldSet(this,Yh,null!==(O=__classPrivateFieldGet(this,Yh,"f"))&&void 0!==O?O:this.tryGetInstrumentedLink(),"f"),__classPrivateFieldGet(this,Yh,"f")}get externalLink(){var O;return __classPrivateFieldSet(this,Kh,null!==(O=__classPrivateFieldGet(this,Kh,"f"))&&void 0!==O?O:this.tryGetExternalLink(),"f"),__classPrivateFieldGet(this,Kh,"f")}getNextKSeed(){return this.currentKSeed+=this.config.telemetry.kSeedIncrement,this.currentKSeed}getNextInstSuffix(){return this.config.features.enableAnsCardSfx?(this.instSuffix+=this.config.telemetry.instSuffixIncrement,this.instSuffix>1?`${this.instSuffix}`:""):""}getComplianceSafeMessage(O){return this.config.bingAtWork.isEnabled?"<stripped/>":O}trackInteractionEvent(O){O.currentTarget instanceof HTMLAnchorElement?this.trackLinkExternal(O):this.trackInternalInteraction(O)}trackEvent(O,B,U={}){const G=Object.entries(U).flatMap((O=>O));this.logEvent(O,B,!1,...G)}trackInternalInteraction(O){null!==this.instrumentedLink&&(this.bingClickTracker(this.instrumentedLink,!1,O),this.logEvent("ClientInst","ConversationalUiLinkClick",!1))}trackLinkExternal(O){var B;this.config.bing.sendClickBeacon(O),this.logEvent("Click","Click",!1,"href",null===(B=O.currentTarget)||void 0===B?void 0:B.href),null!==this.externalLink&&this.bingClickTracker(this.externalLink,!1,O)}trackError(O,B){var U;null===(U=this.log)||void 0===U||U.info(this,this.trackError,O).write(),this.trackEvent("ClientInst","ConversationalUiError",{payload:B})}configureBingHooks(){var O,B,U;(null===(O=window.Log)||void 0===O?void 0:O.Log)&&(null===(B=this.log)||void 0===B||B.info(this,this.configureBingHooks,"window.Log.Log object found").write(),this.bingEventLogger=window.Log.Log),window.si_ct&&(null===(U=this.log)||void 0===U||U.info(this,this.configureBingHooks,"window.si_ct function found").write(),this.bingClickTracker=window.si_ct)}logEvent(O,B,U,...G){this.config.bingAtWork.isEnabled&&G.push("IsBizChat",this.config.bingAtWork.isEnabled.toString());const q=this.config.telemetry.eventID;this.bingEventLogger(O,q,B,U,...G)}bingEventLogger(O,B,U,G,...q){var j;null===(j=this.log)||void 0===j||j.info(this,this.logEvent,`Log.Log('${O}','${B}','${U}','${G}')`,...q).write()}bingClickTracker(O,B,U){var G;null===(G=this.log)||void 0===G||G.info(this,this.bingClickTracker,`si_ct('${O.nodeName}','${B}','${U.type}')`).write()}tryGetInstrumentedLink(){const O=this.config.telemetry.instrumentedLinkName,B=document.getElementById(O);return null===B&&this.trackError(`Could not find Instrumented Link with Name '${O}'`,"No InstLink"),B}tryGetExternalLink(){const O=this.config.telemetry.externalLinkName,B=document.getElementById(O);return null===B&&this.trackError(`Could not find External Link with Name '${O}'`,"No InstLink"),B}tryGetExternalLinkId(){var O;let B;return(null===(O=this.instrumentedLink)||void 0===O?void 0:O.dataset.exlk)?B=`ID=${this.instrumentedLink.dataset.exlk}.1`:this.trackError("Could not find External Link Id","No InstExtLinkId"),B}};var Zh,Xh,Jh,em,tm,im,rm;Wh=new WeakMap,Yh=new WeakMap,Kh=new WeakMap,Qh=__decorate([__param(0,ql),__param(1,Nt(Pi)),__metadata("design:paramtypes",[Object,Object])],Qh),function(O){O.ClientInst="ClientInst",O.Click="Click",O.SendText="SendText",O.Show="Show",O.Hide="Hide",O.InteractionEvent="InteractionEvent",O.ClickMic="ClickMic",O.MessageEvent="MessageEvent",O.SendSR="SendSR",O.SelectFeedback="SelectFeedback",O.ClickChip="ClickChip",O.HoverInfo="HoverInfo",O.HoverLogo="HoverLogo",O.Scroll="Scroll",O.StopMic="StopMic",O.SystemEvent="SystemEvent",O.Error="Error"}(Zh||(Zh={})),function(O){O.Namespace="Namespace",O.CustomData="CustomData",O.EncryptedData="EncryptedData"}(Xh||(Xh={})),function(O){O.Conversation="Conversation",O.RightRail="RightRail",O.Pole="Pole",O.Creator="Creator",O.Thread="Thread"}(Jh||(Jh={})),function(O){O.QueryEntered="QueryEntered",O.RequestSend="RequestSend",O.FirstTokenResponse="FirstTokenResponse",O.FirstTokenRender="FirstTokenRender",O.VoiceInitiated="VoiceInitiated",O.VoiceListeningStarted="VoiceListeningStarted",O.ChatFirstTokenTTS="ChatFirstTokenTTS",O.ChatResponseAudioUrl="ChatResponseAudioUrl",O.ChatResponseAudioReady="ChatResponseAudioReady",O.CurrentAudioStartedPlaying="CurrentAudioStartedPlaying",O.CurrentAudioFinishedPlaying="CurrentAudioFinishedPlaying",O.LastTokenResponse="LastTokenResponse",O.LastTokenRender="LastTokenRender",O.SearchingRender="SearchingRender"}(em||(em={})),function(O){O.ChatRequest="ChatRequest",O.ChatFirstTokenRender="ChatFTR",O.ChatResponseToRender="ChatRespToRender",O.ChatRequestToResponse="ChatReqToResp",O.ChatSearching="ChatSearching",O.ChatFirstToLast="ChatFirstToLast",O.ChatLastTokenRender="ChatLastTokenRender"}(tm||(tm={})),function(O){O.InitiatedToListeningStarted="MicToListening",O.ChatFirstTokenTTS="ChatFirstTokenTTS",O.TTSAudioReady="TTSAudioReady",O.TTSPauseDuration="TTSPauseDuration"}(im||(im={})),function(O){O.Tone="Tone",O.BotRequestId="BotRequestId"}(rm||(rm={}));const nm=kt.createInterface("IPasteService"),filter=(O,B)=>(((O,B,U)=>{if(!O)return!1;if(U=U||O,function(O){return void 0!==O.length}(O)){for(let G=0,q=O.length;G<q;G++)if(!1===B.call(U,O[G],G,O))return!1}else for(const G in O)if(Object.hasOwnProperty.call(O,G)&&!1===B.call(U,O[G],G,O))return!1})(B,(B=>{O=function(O,B){return types_isObject(O)&&((O,B,U)=>{var G;return!!U(O,B.prototype)||(null===(G=O.constructor)||void 0===G?void 0:G.name)===B.name})(O,B,((O,B)=>Object.getPrototypeOf(O)===B))}(B,RegExp)?O.replace(B,""):O.replace(B[0],B[1])})),O),om=["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"],am=["script","noscript","style","textarea","video","audio","iframe","object"],sm=["hr","table","tbody","thead","tfoot","th","tr","td","li","ol","ul","caption","dl","dt","dd","noscript","menu","isindex","option","datalist","select","optgroup","figcaption","details","summary","h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","main","nav","figure"],getInnerText=O=>{const B=new DOMParser;O=(O=>filter(O,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(O,B,U)=>B||U?" ":" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]))(O=filter(O,[/<!\[[^\]]+\]>/g]));const U=B.parseFromString(O,"text/html");let G="";const walk=(O,B)=>{var U;let q="";O.nodeType===Node.ELEMENT_NODE&&(q=O.tagName.toLowerCase());const j=O;let W=B.mode;const Y=B.listLevelStack,K=B.listNumberStack,Q=B.metrics;if("br"===q)return void(G+="\n");if("wbr"===q)return;if(om.includes(q)&&(G+=" "),am.includes(q))return void(G+=" ");if("ul"!==q&&"ol"!==q||(W="ul"===q?"unordered-list":"ordered-list",Y.push(W),K.push(0),"ul"===q?Q.bulletPoints++:Q.numberlist++),"li"===q){0===Y.length&&(Y.push("unordered-list"),K.push(0));const O=Y.length;O>1&&0===K[K.length-1]&&(G+="\n"),G+=new Array(O-1).fill("\t").join(""),"ordered-list"===Y[Y.length-1]?G+=`${K[K.length-1]+1}.\t`:G+="\t",K[K.length-1]+=1}O.nodeType===Node.TEXT_NODE&&(G+=O.nodeValue);if(!om.includes(null===(U=O.tagName)||void 0===U?void 0:U.toLowerCase())&&O.firstChild){let B=O.firstChild;if(B)do{walk(B,{mode:W,listLevelStack:Y,listNumberStack:K,metrics:Q}),B=B.nextSibling}while(B)}if("ul"===q||"ol"===q){K.pop();const O=Y.pop();W=O||"normal"}sm.includes(q)&&j.nextSibling&&(G+="\n","p"===q&&(G+="\n",Q.paragraph++))},q={mode:"normal",listLevelStack:[],listNumberStack:[],metrics:{paragraph:0,bulletPoints:0,numberlist:0}};return walk(U.body,q),G=G.trimStart().trimEnd(),{text:G,walkContext:q}};let lm=class extends lifecycle_Disposable{constructor(O){super(),this.telemetry=O}pasteHtmlAsText(O){const B=getInnerText(O);return B.walkContext.metrics.paragraph>0&&this.telemetry.trackEvent("InteractionEvent","ParagraphPasted",{CustomData:B.walkContext.metrics.paragraph.toString()}),B.walkContext.metrics.bulletPoints>0&&this.telemetry.trackEvent("InteractionEvent","BulletPointsPasted",{CustomData:B.walkContext.metrics.bulletPoints.toString()}),B.walkContext.metrics.numberlist>0&&this.telemetry.trackEvent("InteractionEvent","NumberlistPasted",{CustomData:B.walkContext.metrics.numberlist.toString()}),B.text}};var cm,dm,pm;lm=__decorate([__param(0,$c),__metadata("design:paramtypes",[Object])],lm);let um=class extends lifecycle_Disposable{constructor(O,B,U,G,q,j,W,Y,K){super(),this.config=O,this.modelFactory=B,this.conversation=U,this.chat=G,this.speech=q,this.greeting=j,this.perfTracker=W,this.hookProvider=Y,this.log=K,cm.set(this,this._register(new Emitter)),dm.set(this,this._register(new Emitter)),pm.set(this,this._register(new Emitter)),this.processContextMessage=O=>{O.messageType===tr.Context&&this.addUserContextMessage(O)},this.handleSpeechStreamBegin=()=>{this.addUserMessage(this.speech.recognizedText)},this.handleSpeechSendMessage=()=>{this.config.features.enableSimpleVoiceInput&&this.sendMessage(this.speech.recognizedText,!1,void 0,void 0,Ji.Speech)},this.handleAudioUrl=(O,B)=>{this.speech.handleSpokenResponseUrl(O,B)},this.processMessage=O=>{var B,U,G,q,j;try{if(O.author===Yi.User){if(this.config.features.enableShareQuestionWithResponse&&!this.config.features.enableThreadShareLandingPage&&O.responseType===ji.GetSharedMessagesResponse)return;if(this.config.features.enableContextMessage&&O.messageType===tr.Context)return void this.processContextMessage(O);if((O.isFromCache||O.responseType===ji.GetConversationResponse)&&O.text)return void this.addUserMessage(O.text)}const j=this.conversation.messages.length-1>=0?this.conversation.messages[this.conversation.messages.length-1]:void 0;(null==j?void 0:j.messageId)&&!j.isFinalized&&j.messageId!==O.messageId&&(null===(B=this.log)||void 0===B||B.trace(this,this.processMessage,"finalizing last",j).write(),j.finalize()),O.audioUrl&&this.config.features.enableSimpleVoiceInput&&(null===(U=this.log)||void 0===U||U.trace(this,this.processMessage,"Audio Url received",O.audioUrl).write(),this.handleAudioUrl(O.audioUrl,O.messageType===tr.InternalSearchQuery));let W=this.tryGetExistingModel(O);null!==W&&W.type===vp.Text?W.update(O):W=this.modelFactory.createIncoming(O),null!==W&&(this.hookProvider.hookIncomingSydneyMessageAsync?this.hookedProcessMessage(W,O,j):(W.type===vp.Host&&W.contentType===bp.Ads?(null===(G=this.log)||void 0===G||G.trace(this,this.processMessage,"hosted ads model - compare vs last - model:",W,j).write(),(null==j?void 0:j.requestId)===W.requestId&&(null==j?void 0:j.type)===vp.Text&&(null===(q=this.log)||void 0===q||q.trace(this,this.processMessage,"inline ads success",W).write(),j.inlineAdsModel=W)):(O.responseType!==ji.GetMessagesResponse&&W.finalize(),this.conversation.addMessage(W),W.type===vp.Text?this.perfTracker.markEvent("FirstTokenRender"):W.type===vp.Meta&&O.messageType===tr.InternalSearchQuery&&this.perfTracker.markEvent("SearchingRender")),(null==W?void 0:W.type)===vp.Text&&this.conversation.updateSuggestions(W),!this.config.features.enableSpeechFateTTSStop||(null==W?void 0:W.contentOrigin)!==Ki.Apology&&(null==W?void 0:W.contentOrigin)!==Ki.TopicChanger||this.speech.stopReadout(),this.hookProvider.fireOnSydneyMessageRendered(W)))}catch(B){null===(j=this.log)||void 0===j||j.error(this,this.processMessage,"Error processing message:",O.messageId,B)}},this.hookedProcessMessage=(O,B,U)=>{this.hookProvider.hookIncomingSydneyMessageAsync&&(this.config.features.enableLongDocument&&B&&B.responseType!==ji.GetMessagesResponse&&O.finalize(),this.hookProvider.hookIncomingSydneyMessageAsync(O).then((O=>{null!==O&&(O.type===vp.Host&&O.contentType===bp.Ads?(null==U?void 0:U.requestId)===O.requestId&&(null==U?void 0:U.type)===vp.Text&&(U.inlineAdsModel=O):(this.conversation.addMessage(O),(null==O?void 0:O.type)===vp.Text&&this.perfTracker.markEvent("FirstTokenRender")),(null==O?void 0:O.type)===vp.Text?this.conversation.updateSuggestions(O):(null==O?void 0:O.type)===vp.Meta&&(null==B?void 0:B.messageType)===tr.InternalSearchQuery&&this.perfTracker.markEvent("SearchingRender"),this.hookProvider.fireOnSydneyMessageRendered(O))})).catch((()=>{var O;return null===(O=this.log)||void 0===O?void 0:O.trace(this,this.processMessage,"error hooking message.")})))},this._register(this.chat.onMessage(this.processMessage)),this._register(this.speech.onBegin(this.handleSpeechStreamBegin)),this._register(this.speech.onSendMessage(this.handleSpeechSendMessage))}get onResetConversationInvoked(){return __classPrivateFieldGet(this,cm,"f").event}get onConversationLoadStart(){return __classPrivateFieldGet(this,dm,"f").event}fireConversationLoadStart(){__classPrivateFieldGet(this,dm,"f").fire()}get onConversationLoadEnd(){return __classPrivateFieldGet(this,pm,"f").event}fireConversationLoadEnd(){__classPrivateFieldGet(this,pm,"f").fire()}resetConversation(O,B=!0){var U;if(null===(U=this.log)||void 0===U||U.trace(this,this.resetConversation,null).write(),this.chat.cancelPendingRequest(),this.speech.cancelPendingRequest(),this.conversation.reset(),this.config.greeting.shouldSendBotGreeting&&(this.chat.clearPendingContext(),B))if(O){const B=this.greeting.getToneGreetingMessage(O);this.addBotGreeting(ph.CustomMessage,B.message,B.suggestions)}else this.addBotGreeting(ph.NewTopicMessage);__classPrivateFieldGet(this,cm,"f").fire()}async beginConversationAsync(){var O,B,U;try{switch(null===(O=this.log)||void 0===O||O.trace(this,this.beginConversationAsync,"enter").write(),this.conversation.state){case Lc.Pending:break;case Lc.Active:this.conversation.resetState();case Lc.Inactive:this.config.greeting.shouldSendBotGreeting&&!this.config.partner.disableConversationGreeting&&this.addBotGreeting()}}catch(O){const U=O instanceof Error?O:"An error occurred.";null===(B=this.log)||void 0===B||B.error(this,this.beginConversationAsync,U).write()}null===(U=this.log)||void 0===U||U.trace(this,this.beginConversationAsync,"exit").write()}sendMessage(O,B=!1,U=!0,G,q){var j;if(null===(j=this.log)||void 0===j||j.trace(this,this.sendMessage,"manager send message:",O).write(),this.addUserMessage(O,U,G),this.config.features.enableVersionPrompt&&"/version"===O){const O=createBotMessage(JSON.stringify(Gt),[]);this.processMessage(O)}else if(this.hookProvider.hookOutgoingUserMessageAsync){const B=this.modelFactory.createLocalText({text:O});this.hookProvider.hookOutgoingUserMessageAsync(B).then((B=>{null!==B&&this.chat.submitMessage(O,q)})).catch((()=>{var O;return null===(O=this.log)||void 0===O?void 0:O.trace(this,this.addUserMessage,"error in hook.")}))}else B||this.chat.submitMessage(O,q)}addBotMessage(O){return this.hookProvider.hookIncomingSydneyMessageAsync?this.hookProvider.hookIncomingSydneyMessageAsync(O).then((B=>{null!==B&&(this.conversation.addMessage(B),((null==O?void 0:O.type)===vp.Text||(null==O?void 0:O.type)===vp.ExternalHTML||(null==O?void 0:O.type)===vp.FullBleed)&&this.conversation.updateSuggestions(B),this.hookProvider.fireOnSydneyMessageRendered(B))})).catch((()=>{var O;return null===(O=this.log)||void 0===O?void 0:O.trace(this,this.addBotMessage,"error in hook.")})):(this.conversation.addMessage(O),(null==O?void 0:O.type)!==vp.Text&&(null==O?void 0:O.type)!==vp.ExternalHTML&&(null==O?void 0:O.type)!==vp.FullBleed||this.conversation.updateSuggestions(O),this.hookProvider.fireOnSydneyMessageRendered(O)),this.conversation.addMessage(O),!0}sendSearchQuery(O){var B;if(null===(B=this.log)||void 0===B||B.trace(this,this.sendSearchQuery,"manager send search query:",O).write(),this.conversation.messages.length)throw new Error("IConversationManager.sendSearchQuery can only be called as the first message of conversation.");this.addUserMessage(O),this.chat.submitSearchQuery(O)}addBotGreeting(O=ph.NormalMessage,B,U){var G;let q;switch(null===(G=this.log)||void 0===G||G.trace(this,this.addBotGreeting,"manager send bot greeting message:",O).write(),O){case ph.CustomMessage:q=void 0!==B&&void 0!==U?this.greeting.customGreetingMessage(B,U):this.greeting.message;break;case ph.NewTopicMessage:q=this.greeting.newTopicMessage;break;default:q=this.greeting.message}return this.greeting.shouldAddInPrompt()&&this.chat.registerContext([q]),this.processMessage(q),q}addUserContextMessage(O){if(O.messageType!==tr.Context||O.contextType!==Zi.WebPage)return;const B=this.modelFactory.createLocalContext(O,Zi.WebPage);this.conversation.addMessage(B)}addUserMessage(O,B=!0,U=tr.Chat){var G;null===(G=this.log)||void 0===G||G.trace(this,this.addUserMessage,`manager add user message: "${O}" type: ${U}`).write();const q=this.modelFactory.createLocalText({text:O,messageType:U});B&&this.conversation.addMessage(q)}tryGetExistingModel(O){var B;let U;return O.messageId?(U=this.conversation.messages.find((B=>this.isExistingModelPredicate(B,O.messageId,O.messageType))),U&&O.messageType===tr.AdsQuery&&(U=U.inlineAdsModel)):null===(B=this.log)||void 0===B||B.warn(this,this.tryGetExistingModel,"Cannot get existing model for message with no ID.").write(),null!=U?U:null}isExistingModelPredicate(O,B,U){var G;return O.messageId===B||U===tr.AdsQuery&&O.type===vp.Text&&(null===(G=O.inlineAdsModel)||void 0===G?void 0:G.messageId)===B}};var hm,mm;cm=new WeakMap,dm=new WeakMap,pm=new WeakMap,um=__decorate([__param(0,ql),__param(1,hh),__param(2,Dc),__param(3,Mc),__param(4,Fc),__param(5,Oh),__param(6,qc),__param(7,Jd),__param(8,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object])],um);let gm=class{constructor(O,B,U){this.config=O,this.telemetry=B,this.log=U,this.lastMessage=null,this.expiry=null,hm.set(this,""),mm.set(this,""),this._suggestions=[],this._turnCount=0,this._state=Lc.Inactive,this._id=null,this._messages=[],this._conversationType=Bc.Default,this._onResetEmitter=new Emitter,this._onMessageAddedEmitter=new Emitter,this._onBotMessageResetEmitter=new Emitter,this._onIdChangedEmitter=new Emitter,this._onConversationTypeChangedEmitter=new Emitter}get suggestions(){return this._suggestions}get turnCount(){return this._turnCount}get suggestionMessageId(){return this._suggestionMessageId}get suggestionRequestId(){return this._suggestionRequestId}get state(){return this._state}get id(){return this._id}set id(O){this._id!==O&&this._onIdChangedEmitter.fire(O),this._id=O}get messages(){return this._messages}get conversationType(){return this._conversationType}onReset(O){return this._onResetEmitter.event(O)}onMessageAdded(O){return this._onMessageAddedEmitter.event(O)}onBotMessageReset(O){return this._onBotMessageResetEmitter.event(O)}onIdChanged(O){return this._onIdChangedEmitter.event(O)}onConversationTypeChanged(O){return this._onConversationTypeChangedEmitter.event(O)}get clientId(){return __classPrivateFieldGet(this,mm,"f")}get hashedSignature(){return __classPrivateFieldGet(this,hm,"f")}get isExpired(){return null===this.expiry||new Date(this.expiry).valueOf()<Date.now()}removeMessageById(O){if(!O)return;const B=this.getBotMessageIndexById(O);if(B>=0){this._messages.splice(B,1)[0].remove()}}processMessageUpdate(O){const B=this.getBotMessageById(O.messageId);B&&B.append(O.appendText)}updateSuggestions(O){this._suggestions=O.suggestedResponses,this._suggestionMessageId=O.messageId,this._suggestionRequestId=O.requestId}reset(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.reset,null).write(),this.updateId(),this.lastMessage=null,this._suggestions=[],this._suggestionMessageId=void 0,this._suggestionRequestId=void 0,this._messages.splice(0,this._messages.length),this._onResetEmitter.fire(),this.config.features.enableThreadShareLandingPage&&this.changeConversationType(Bc.Default)}addMessage(O){var B,U;this.fireMessageTelemetry(O);const G=this.getBotMessageById(O.messageId);G?(null===(B=this.log)||void 0===B||B.trace(this,this.addMessage,"model update existing:").write(),G.update(O)):(null===(U=this.log)||void 0===U||U.trace(this,this.addMessage,"model add message").write(),this._messages.push(O),this._onMessageAddedEmitter.fire(O)),O.author===Yi.Bot&&O.type===vp.Text&&(this.lastMessage=O)}createConversationSummary(O){let B="";const U=Math.max(Math.min(this.messages.length,O),0);if(U>0){const O=[];for(let B=U-1;B>=0;B--){const{author:U,text:G}=this.messages[B],q={author:U,text:G};O.push(q)}B=JSON.stringify(O)}return B}updateId(O=null,B=null,U,G){null===O||null===B?(this.id=this.expiry=null,this.config.features.enableThreads||__classPrivateFieldSet(this,mm,"","f"),__classPrivateFieldSet(this,hm,"","f"),this.setState(Lc.Inactive)):(this.id=O,this.expiry=B,U&&__classPrivateFieldSet(this,mm,U,"f"),G&&__classPrivateFieldSet(this,hm,G,"f"))}setClientId(O){!__classPrivateFieldGet(this,mm,"f")&&O&&__classPrivateFieldSet(this,mm,O,"f")}setTurnCount(O){this._turnCount=O}setPending(){this.state===Lc.Inactive&&this.setState(Lc.Pending)}setActive(){this.state===Lc.Pending&&this.id&&this.expiry&&this.setState(Lc.Active)}resetState(){var O;null===(O=this.log)||void 0===O||O.debug(this,this.resetState,null).write(),this.updateId()}removeCurrentTurnBotMessages(){if(this.messages.length){for(;this.messages.length&&this.messages[this.messages.length-1].author===Yi.Bot;)this._messages.pop();this._onBotMessageResetEmitter.fire()}}changeConversationType(O){this._conversationType=O,this._onConversationTypeChangedEmitter.fire(O)}setState(O){var B,U;this._state!==O&&(this._state=O,O===Lc.Active?null===(B=this.log)||void 0===B||B.debug(this,this.setState,"[state -> active] convId:",this.id).write():null===(U=this.log)||void 0===U||U.debug(this,this.setState,"[state ->",O,"]").write())}getBotMessageById(O){const B=this.getBotMessageIndexById(O);return B>=0?this.messages[B]:void 0}getBotMessageIndexById(O){return this.messages.findIndex((B=>B.messageId===O&&B.author===Yi.Bot))}fireMessageTelemetry(O){var B;if(!this.config.features.enableServerLogMerging){const U=(this.messages.length-1).toString();O.type===vp.Meta&&O.messageType===tr.InternalSearchQuery&&O.contentOrigin===Ki.DeepLeo&&this.telemetry.trackEvent("MessageEvent","WebSearch",{Namespace:"Conversation",CustomData:JSON.stringify({turnId:U,convId:this.id,query:this.telemetry.getComplianceSafeMessage(null===(B=/`(.*?)`/.exec(O.text))||void 0===B?void 0:B[1])})}),O.type===vp.Host&&O.contentType===bp.ImageContentCreator&&this.telemetry.trackEvent("MessageEvent","ContentCreatorRender",{Namespace:"Conversation",CustomData:JSON.stringify({turnId:U,convId:this.id,userMessage:this.messages.length>0?this.messages[this.messages.length-1].text:"",searchQuery:this.telemetry.getComplianceSafeMessage(O.text)})})}O.contentOrigin===Ki.AnnRules&&(this.telemetry.trackEvent("ClientInst","AnnHit"),O.offense===nr.OffenseResponse&&this.telemetry.trackEvent("ClientInst","AnnHitOffensive")),O.text&&O.text.includes("@failover_hyperlink")&&(O.rewrittenMessage||(null==O?void 0:O.text))&&this.telemetry.trackEvent("ClientInst","FATELink")}};var fm,ym,_m;hm=new WeakMap,mm=new WeakMap,__decorate([observable,__metadata("design:type",Object)],gm.prototype,"lastMessage",void 0),__decorate([observable,__metadata("design:type",Array)],gm.prototype,"_suggestions",void 0),__decorate([observable,__metadata("design:type",Number)],gm.prototype,"_turnCount",void 0),gm=__decorate([__param(0,ql),__param(1,$c),__param(2,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object])],gm),function(O){O[O.None=0]="None",O[O.WebSockets=1]="WebSockets",O[O.ServerSentEvents=2]="ServerSentEvents",O[O.LongPolling=4]="LongPolling"}(fm||(fm={})),function(O){O[O.Text=1]="Text",O[O.Binary=2]="Binary"}(ym||(ym={})),function(O){O[O.Trace=0]="Trace",O[O.Debug=1]="Debug",O[O.Information=2]="Information",O[O.Warning=3]="Warning",O[O.Error=4]="Error",O[O.Critical=5]="Critical",O[O.None=6]="None"}(_m||(_m={}));const vm=[0,2e3,1e4,3e4,null];class DefaultReconnectPolicy{constructor(O){this._retryDelays=void 0!==O?[...O,null]:vm}nextRetryDelayInMilliseconds(O){return this._retryDelays[O.previousRetryCount]}}class HeaderNames_HeaderNames{}HeaderNames_HeaderNames.Authorization="Authorization",HeaderNames_HeaderNames.Cookie="Cookie";class HttpResponse{constructor(O,B,U){this.statusCode=O,this.statusText=B,this.content=U}}class HttpClient{get(O,B){return this.send({...B,method:"GET",url:O})}post(O,B){return this.send({...B,method:"POST",url:O})}delete(O,B){return this.send({...B,method:"DELETE",url:O})}getCookieString(O){return""}}class AccessTokenHttpClient extends HttpClient{constructor(O,B){super(),this._innerClient=O,this._accessTokenFactory=B}async send(O){let B=!0;this._accessTokenFactory&&(!this._accessToken||O.url&&O.url.indexOf("/negotiate?")>0)&&(B=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(O);const U=await this._innerClient.send(O);return B&&401===U.statusCode&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(O),await this._innerClient.send(O)):U}_setAuthorizationHeader(O){O.headers||(O.headers={}),this._accessToken?O.headers[HeaderNames_HeaderNames.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&O.headers[HeaderNames_HeaderNames.Authorization]&&delete O.headers[HeaderNames_HeaderNames.Authorization]}getCookieString(O){return this._innerClient.getCookieString(O)}}class HttpError extends Error{constructor(O,B){const U=new.target.prototype;super(`${O}: Status code '${B}'`),this.statusCode=B,this.__proto__=U}}class TimeoutError extends Error{constructor(O="A timeout occurred."){const B=new.target.prototype;super(O),this.__proto__=B}}class Errors_AbortError extends Error{constructor(O="An abort occurred."){const B=new.target.prototype;super(O),this.__proto__=B}}class UnsupportedTransportError extends Error{constructor(O,B){const U=new.target.prototype;super(O),this.transport=B,this.errorType="UnsupportedTransportError",this.__proto__=U}}class DisabledTransportError extends Error{constructor(O,B){const U=new.target.prototype;super(O),this.transport=B,this.errorType="DisabledTransportError",this.__proto__=U}}class FailedToStartTransportError extends Error{constructor(O,B){const U=new.target.prototype;super(O),this.transport=B,this.errorType="FailedToStartTransportError",this.__proto__=U}}class FailedToNegotiateWithServerError extends Error{constructor(O){const B=new.target.prototype;super(O),this.errorType="FailedToNegotiateWithServerError",this.__proto__=B}}class AggregateErrors extends Error{constructor(O,B){const U=new.target.prototype;super(O),this.innerErrors=B,this.__proto__=U}}class NullLogger{constructor(){}log(O,B){}}NullLogger.instance=new NullLogger;class Arg{static isRequired(O,B){if(null==O)throw new Error(`The '${B}' argument is required.`)}static isNotEmpty(O,B){if(!O||O.match(/^\s*$/))throw new Error(`The '${B}' argument should not be empty.`)}static isIn(O,B,U){if(!(O in B))throw new Error(`Unknown ${U} value: ${O}.`)}}class Utils_Platform{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&void 0===window.document}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function getDataDetail(O,B){let U="";return isArrayBuffer(O)?(U=`Binary data of length ${O.byteLength}`,B&&(U+=`. Content: '${function(O){const B=new Uint8Array(O);let U="";return B.forEach((O=>{U+=`0x${O<16?"0":""}${O.toString(16)} `})),U.substr(0,U.length-1)}(O)}'`)):"string"==typeof O&&(U=`String data of length ${O.length}`,B&&(U+=`. Content: '${O}'`)),U}function isArrayBuffer(O){return O&&"undefined"!=typeof ArrayBuffer&&(O instanceof ArrayBuffer||O.constructor&&"ArrayBuffer"===O.constructor.name)}async function sendMessage(O,B,U,G,q,j){const W={},[Y,K]=getUserAgentHeader();W[Y]=K,O.log(_m.Trace,`(${B} transport) sending data. ${getDataDetail(q,j.logMessageContent)}.`);const Q=isArrayBuffer(q)?"arraybuffer":"text",Z=await U.post(G,{content:q,headers:{...W,...j.headers},responseType:Q,timeout:j.timeout,withCredentials:j.withCredentials});O.log(_m.Trace,`(${B} transport) request complete. Response status: ${Z.statusCode}.`)}class SubjectSubscription{constructor(O,B){this._subject=O,this._observer=B}dispose(){const O=this._subject.observers.indexOf(this._observer);O>-1&&this._subject.observers.splice(O,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch((O=>{}))}}class ConsoleLogger{constructor(O){this._minLevel=O,this.out=console}log(O,B){if(O>=this._minLevel){const U=`[${(new Date).toISOString()}] ${_m[O]}: ${B}`;switch(O){case _m.Critical:case _m.Error:this.out.error(U);break;case _m.Warning:this.out.warn(U);break;case _m.Information:this.out.info(U);break;default:this.out.log(U)}}}}function getUserAgentHeader(){let O="X-SignalR-User-Agent";return Utils_Platform.isNode&&(O="User-Agent"),[O,constructUserAgent("7.0.0",getOsName(),getRuntime(),getRuntimeVersion())]}function constructUserAgent(O,B,U,G){let q="Microsoft SignalR/";const j=O.split(".");return q+=`${j[0]}.${j[1]}`,q+=` (${O}; `,q+=B&&""!==B?`${B}; `:"Unknown OS; ",q+=`${U}`,q+=G?`; ${G}`:"; Unknown Runtime Version",q+=")",q}function getOsName(){if(!Utils_Platform.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function getRuntimeVersion(){if(Utils_Platform.isNode)return process.versions.node}function getRuntime(){return Utils_Platform.isNode?"NodeJS":"Browser"}function getErrorString(O){return O.stack?O.stack:O.message?O.message:`${O}`}class FetchHttpClient_FetchHttpClient extends HttpClient{constructor(O){if(super(),this._logger=O,"undefined"==typeof fetch){const O=require;this._jar=new(O("tough-cookie").CookieJar),this._fetchType=O("node-fetch"),this._fetchType=O("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==U.g)return U.g;throw new Error("could not find global")}());if("undefined"==typeof AbortController){const O=require;this._abortControllerType=O("abort-controller")}else this._abortControllerType=AbortController}async send(O){if(O.abortSignal&&O.abortSignal.aborted)throw new Errors_AbortError;if(!O.method)throw new Error("No method defined.");if(!O.url)throw new Error("No url defined.");const B=new this._abortControllerType;let U;O.abortSignal&&(O.abortSignal.onabort=()=>{B.abort(),U=new Errors_AbortError});let G,q=null;if(O.timeout){const G=O.timeout;q=setTimeout((()=>{B.abort(),this._logger.log(_m.Warning,"Timeout from HTTP request."),U=new TimeoutError}),G)}""===O.content&&(O.content=void 0),O.content&&(O.headers=O.headers||{},isArrayBuffer(O.content)?O.headers["Content-Type"]="application/octet-stream":O.headers["Content-Type"]="text/plain;charset=UTF-8");try{G=await this._fetchType(O.url,{body:O.content,cache:"no-cache",credentials:!0===O.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...O.headers},method:O.method,mode:"cors",redirect:"follow",signal:B.signal})}catch(O){if(U)throw U;throw this._logger.log(_m.Warning,`Error from HTTP request. ${O}.`),O}finally{q&&clearTimeout(q),O.abortSignal&&(O.abortSignal.onabort=null)}if(!G.ok){const O=await deserializeContent(G,"text");throw new HttpError(O||G.statusText,G.status)}const j=deserializeContent(G,O.responseType),W=await j;return new HttpResponse(G.status,G.statusText,W)}getCookieString(O){let B="";return Utils_Platform.isNode&&this._jar&&this._jar.getCookies(O,((O,U)=>B=U.join("; "))),B}}function deserializeContent(O,B){let U;switch(B){case"arraybuffer":U=O.arrayBuffer();break;case"text":default:U=O.text();break;case"blob":case"document":case"json":throw new Error(`${B} is not supported.`)}return U}class XhrHttpClient_XhrHttpClient extends HttpClient{constructor(O){super(),this._logger=O}send(O){return O.abortSignal&&O.abortSignal.aborted?Promise.reject(new Errors_AbortError):O.method?O.url?new Promise(((B,U)=>{const G=new XMLHttpRequest;G.open(O.method,O.url,!0),G.withCredentials=void 0===O.withCredentials||O.withCredentials,G.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===O.content&&(O.content=void 0),O.content&&(isArrayBuffer(O.content)?G.setRequestHeader("Content-Type","application/octet-stream"):G.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const q=O.headers;q&&Object.keys(q).forEach((O=>{G.setRequestHeader(O,q[O])})),O.responseType&&(G.responseType=O.responseType),O.abortSignal&&(O.abortSignal.onabort=()=>{G.abort(),U(new Errors_AbortError)}),O.timeout&&(G.timeout=O.timeout),G.onload=()=>{O.abortSignal&&(O.abortSignal.onabort=null),G.status>=200&&G.status<300?B(new HttpResponse(G.status,G.statusText,G.response||G.responseText)):U(new HttpError(G.response||G.responseText||G.statusText,G.status))},G.onerror=()=>{this._logger.log(_m.Warning,`Error from HTTP request. ${G.status}: ${G.statusText}.`),U(new HttpError(G.statusText,G.status))},G.ontimeout=()=>{this._logger.log(_m.Warning,"Timeout from HTTP request."),U(new TimeoutError)},G.send(O.content)})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class DefaultHttpClient extends HttpClient{constructor(O){if(super(),"undefined"!=typeof fetch||Utils_Platform.isNode)this._httpClient=new FetchHttpClient_FetchHttpClient(O);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this._httpClient=new XhrHttpClient_XhrHttpClient(O)}}send(O){return O.abortSignal&&O.abortSignal.aborted?Promise.reject(new Errors_AbortError):O.method?O.url?this._httpClient.send(O):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(O){return this._httpClient.getCookieString(O)}}class esm_AbortController_AbortController{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class LongPollingTransport{constructor(O,B,U){this._httpClient=O,this._logger=B,this._pollAbort=new esm_AbortController_AbortController,this._options=U,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}async connect(O,B){if(Arg.isRequired(O,"url"),Arg.isRequired(B,"transferFormat"),Arg.isIn(B,ym,"transferFormat"),this._url=O,this._logger.log(_m.Trace,"(LongPolling transport) Connecting."),B===ym.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[U,G]=getUserAgentHeader(),q={[U]:G,...this._options.headers},j={abortSignal:this._pollAbort.signal,headers:q,timeout:1e5,withCredentials:this._options.withCredentials};B===ym.Binary&&(j.responseType="arraybuffer");const W=`${O}&_=${Date.now()}`;this._logger.log(_m.Trace,`(LongPolling transport) polling: ${W}.`);const Y=await this._httpClient.get(W,j);200!==Y.statusCode?(this._logger.log(_m.Error,`(LongPolling transport) Unexpected response code: ${Y.statusCode}.`),this._closeError=new HttpError(Y.statusText||"",Y.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,j)}async _poll(O,B){try{for(;this._running;)try{const U=`${O}&_=${Date.now()}`;this._logger.log(_m.Trace,`(LongPolling transport) polling: ${U}.`);const G=await this._httpClient.get(U,B);204===G.statusCode?(this._logger.log(_m.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):200!==G.statusCode?(this._logger.log(_m.Error,`(LongPolling transport) Unexpected response code: ${G.statusCode}.`),this._closeError=new HttpError(G.statusText||"",G.statusCode),this._running=!1):G.content?(this._logger.log(_m.Trace,`(LongPolling transport) data received. ${getDataDetail(G.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(G.content)):this._logger.log(_m.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(O){this._running?O instanceof TimeoutError?this._logger.log(_m.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=O,this._running=!1):this._logger.log(_m.Trace,`(LongPolling transport) Poll errored after shutdown: ${O.message}`)}}finally{this._logger.log(_m.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(O){return this._running?sendMessage(this._logger,"LongPolling",this._httpClient,this._url,O,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(_m.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(_m.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const O={},[B,U]=getUserAgentHeader();O[B]=U;const G={headers:{...O,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};await this._httpClient.delete(this._url,G),this._logger.log(_m.Trace,"(LongPolling transport) DELETE request sent.")}finally{this._logger.log(_m.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let O="(LongPolling transport) Firing onclose event.";this._closeError&&(O+=" Error: "+this._closeError),this._logger.log(_m.Trace,O),this.onclose(this._closeError)}}}class ServerSentEventsTransport{constructor(O,B,U,G){this._httpClient=O,this._accessToken=B,this._logger=U,this._options=G,this.onreceive=null,this.onclose=null}async connect(O,B){return Arg.isRequired(O,"url"),Arg.isRequired(B,"transferFormat"),Arg.isIn(B,ym,"transferFormat"),this._logger.log(_m.Trace,"(SSE transport) Connecting."),this._url=O,this._accessToken&&(O+=(O.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise(((U,G)=>{let q,j=!1;if(B===ym.Text){if(Utils_Platform.isBrowser||Utils_Platform.isWebWorker)q=new this._options.EventSource(O,{withCredentials:this._options.withCredentials});else{const B=this._httpClient.getCookieString(O),U={};U.Cookie=B;const[G,j]=getUserAgentHeader();U[G]=j,q=new this._options.EventSource(O,{withCredentials:this._options.withCredentials,headers:{...U,...this._options.headers}})}try{q.onmessage=O=>{if(this.onreceive)try{this._logger.log(_m.Trace,`(SSE transport) data received. ${getDataDetail(O.data,this._options.logMessageContent)}.`),this.onreceive(O.data)}catch(O){return void this._close(O)}},q.onerror=O=>{j?this._close():G(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},q.onopen=()=>{this._logger.log(_m.Information,`SSE connected to ${this._url}`),this._eventSource=q,j=!0,U()}}catch(O){return void G(O)}}else G(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))}async send(O){return this._eventSource?sendMessage(this._logger,"SSE",this._httpClient,this._url,O,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(O){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(O))}}class WebSocketTransport{constructor(O,B,U,G,q,j){this._logger=U,this._accessTokenFactory=B,this._logMessageContent=G,this._webSocketConstructor=q,this._httpClient=O,this.onreceive=null,this.onclose=null,this._headers=j}async connect(O,B){let U;return Arg.isRequired(O,"url"),Arg.isRequired(B,"transferFormat"),Arg.isIn(B,ym,"transferFormat"),this._logger.log(_m.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory&&(U=await this._accessTokenFactory()),new Promise(((G,q)=>{let j;O=O.replace(/^http/,"ws");const W=this._httpClient.getCookieString(O);let Y=!1;if(Utils_Platform.isNode||Utils_Platform.isReactNative){const B={},[G,q]=getUserAgentHeader();B[G]=q,U&&(B[HeaderNames_HeaderNames.Authorization]=`Bearer ${U}`),W&&(B[HeaderNames_HeaderNames.Cookie]=W),j=new this._webSocketConstructor(O,void 0,{headers:{...B,...this._headers}})}else U&&(O+=(O.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(U)}`);j||(j=new this._webSocketConstructor(O)),B===ym.Binary&&(j.binaryType="arraybuffer"),j.onopen=B=>{this._logger.log(_m.Information,`WebSocket connected to ${O}.`),this._webSocket=j,Y=!0,G()},j.onerror=O=>{let B=null;B="undefined"!=typeof ErrorEvent&&O instanceof ErrorEvent?O.error:"There was an error with the transport",this._logger.log(_m.Information,`(WebSockets transport) ${B}.`)},j.onmessage=O=>{if(this._logger.log(_m.Trace,`(WebSockets transport) data received. ${getDataDetail(O.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(O.data)}catch(O){return void this._close(O)}},j.onclose=O=>{if(Y)this._close(O);else{let B=null;B="undefined"!=typeof ErrorEvent&&O instanceof ErrorEvent?O.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",q(new Error(B))}}}))}send(O){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(_m.Trace,`(WebSockets transport) sending data. ${getDataDetail(O,this._logMessageContent)}.`),this._webSocket.send(O),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(O){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(_m.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(O)||!1!==O.wasClean&&1e3===O.code?O instanceof Error?this.onclose(O):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${O.code} (${O.reason||"no reason given"}).`)))}_isCloseEvent(O){return O&&"boolean"==typeof O.wasClean&&"number"==typeof O.code}}class HttpConnection{constructor(O,B={}){var U;if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,Arg.isRequired(O,"url"),this._logger=void 0===(U=B.logger)?new ConsoleLogger(_m.Information):null===U?NullLogger.instance:void 0!==U.log?U:new ConsoleLogger(U),this.baseUrl=this._resolveUrl(O),(B=B||{}).logMessageContent=void 0!==B.logMessageContent&&B.logMessageContent,"boolean"!=typeof B.withCredentials&&void 0!==B.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");B.withCredentials=void 0===B.withCredentials||B.withCredentials,B.timeout=void 0===B.timeout?1e5:B.timeout;let G=null,q=null;if(Utils_Platform.isNode){const O=require;G=O("ws"),q=O("eventsource")}Utils_Platform.isNode||"undefined"==typeof WebSocket||B.WebSocket?Utils_Platform.isNode&&!B.WebSocket&&G&&(B.WebSocket=G):B.WebSocket=WebSocket,Utils_Platform.isNode||"undefined"==typeof EventSource||B.EventSource?Utils_Platform.isNode&&!B.EventSource&&void 0!==q&&(B.EventSource=q):B.EventSource=EventSource,this._httpClient=new AccessTokenHttpClient(B.httpClient||new DefaultHttpClient(this._logger),B.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=B,this.onreceive=null,this.onclose=null}async start(O){if(O=O||ym.Binary,Arg.isIn(O,ym,"transferFormat"),this._logger.log(_m.Debug,`Starting connection with transfer format '${ym[O]}'.`),"Disconnected"!==this._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(O),await this._startInternalPromise,"Disconnecting"===this._connectionState){const O="Failed to start the HttpConnection before stop() was called.";return this._logger.log(_m.Error,O),await this._stopPromise,Promise.reject(new Errors_AbortError(O))}if("Connected"!==this._connectionState){const O="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(_m.Error,O),Promise.reject(new Errors_AbortError(O))}this._connectionStarted=!0}send(O){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new TransportSendQueue(this.transport)),this._sendQueue.send(O))}async stop(O){return"Disconnected"===this._connectionState?(this._logger.log(_m.Debug,`Call to HttpConnection.stop(${O}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===this._connectionState?(this._logger.log(_m.Debug,`Call to HttpConnection.stop(${O}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState="Disconnecting",this._stopPromise=new Promise((O=>{this._stopPromiseResolver=O})),await this._stopInternal(O),void await this._stopPromise)}async _stopInternal(O){this._stopError=O;try{await this._startInternalPromise}catch(O){}if(this.transport){try{await this.transport.stop()}catch(O){this._logger.log(_m.Error,`HttpConnection.transport.stop() threw error '${O}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(_m.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(O){let B=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation){if(this._options.transport!==fm.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this._constructTransport(fm.WebSockets),await this._startTransport(B,O)}else{let U=null,G=0;do{if(U=await this._getNegotiationResponse(B),"Disconnecting"===this._connectionState||"Disconnected"===this._connectionState)throw new Errors_AbortError("The connection was stopped during negotiation.");if(U.error)throw new Error(U.error);if(U.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(U.url&&(B=U.url),U.accessToken){const O=U.accessToken;this._accessTokenFactory=()=>O,this._httpClient._accessToken=O,this._httpClient._accessTokenFactory=void 0}G++}while(U.url&&G<100);if(100===G&&U.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(B,this._options.transport,U,O)}this.transport instanceof LongPollingTransport&&(this.features.inherentKeepAlive=!0),"Connecting"===this._connectionState&&(this._logger.log(_m.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(O){return this._logger.log(_m.Error,"Failed to start the connection: "+O),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(O)}}async _getNegotiationResponse(O){const B={},[U,G]=getUserAgentHeader();B[U]=G;const q=this._resolveNegotiateUrl(O);this._logger.log(_m.Debug,`Sending negotiation request: ${q}.`);try{const O=await this._httpClient.post(q,{content:"",headers:{...B,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(200!==O.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${O.statusCode}'`));const U=JSON.parse(O.content);return(!U.negotiateVersion||U.negotiateVersion<1)&&(U.connectionToken=U.connectionId),U}catch(O){let B="Failed to complete negotiation with the server: "+O;return O instanceof HttpError&&404===O.statusCode&&(B+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(_m.Error,B),Promise.reject(new FailedToNegotiateWithServerError(B))}}_createConnectUrl(O,B){return B?O+(-1===O.indexOf("?")?"?":"&")+`id=${B}`:O}async _createTransport(O,B,U,G){let q=this._createConnectUrl(O,U.connectionToken);if(this._isITransport(B))return this._logger.log(_m.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=B,await this._startTransport(q,G),void(this.connectionId=U.connectionId);const j=[],W=U.availableTransports||[];let Y=U;for(const U of W){const W=this._resolveTransportOrError(U,B,G);if(W instanceof Error)j.push(`${U.transport} failed:`),j.push(W);else if(this._isITransport(W)){if(this.transport=W,!Y){try{Y=await this._getNegotiationResponse(O)}catch(O){return Promise.reject(O)}q=this._createConnectUrl(O,Y.connectionToken)}try{return await this._startTransport(q,G),void(this.connectionId=Y.connectionId)}catch(O){if(this._logger.log(_m.Error,`Failed to start the transport '${U.transport}': ${O}`),Y=void 0,j.push(new FailedToStartTransportError(`${U.transport} failed: ${O}`,fm[U.transport])),"Connecting"!==this._connectionState){const O="Failed to select transport before stop() was called.";return this._logger.log(_m.Debug,O),Promise.reject(new Errors_AbortError(O))}}}}return j.length>0?Promise.reject(new AggregateErrors(`Unable to connect to the server with any of the available transports. ${j.join(" ")}`,j)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(O){switch(O){case fm.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new WebSocketTransport(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case fm.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new ServerSentEventsTransport(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case fm.LongPolling:return new LongPollingTransport(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${O}.`)}}_startTransport(O,B){return this.transport.onreceive=this.onreceive,this.transport.onclose=O=>this._stopConnection(O),this.transport.connect(O,B)}_resolveTransportOrError(O,B,U){const G=fm[O.transport];if(null==G)return this._logger.log(_m.Debug,`Skipping transport '${O.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${O.transport}' because it is not supported by this client.`);if(!function(O,B){return!O||0!=(B&O)}(B,G))return this._logger.log(_m.Debug,`Skipping transport '${fm[G]}' because it was disabled by the client.`),new DisabledTransportError(`'${fm[G]}' is disabled by the client.`,G);{const B=O.transferFormats.map((O=>ym[O]));if(!(B.indexOf(U)>=0))return this._logger.log(_m.Debug,`Skipping transport '${fm[G]}' because it does not support the requested transfer format '${ym[U]}'.`),new Error(`'${fm[G]}' does not support ${ym[U]}.`);if(G===fm.WebSockets&&!this._options.WebSocket||G===fm.ServerSentEvents&&!this._options.EventSource)return this._logger.log(_m.Debug,`Skipping transport '${fm[G]}' because it is not supported in your environment.'`),new UnsupportedTransportError(`'${fm[G]}' is not supported in your environment.`,G);this._logger.log(_m.Debug,`Selecting transport '${fm[G]}'.`);try{return this._constructTransport(G)}catch(O){return O}}}_isITransport(O){return O&&"object"==typeof O&&"connect"in O}_stopConnection(O){if(this._logger.log(_m.Debug,`HttpConnection.stopConnection(${O}) called while in state ${this._connectionState}.`),this.transport=void 0,O=this._stopError||O,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(_m.Warning,`Call to HttpConnection.stopConnection(${O}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${O}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),O?this._logger.log(_m.Error,`Connection disconnected with error '${O}'.`):this._logger.log(_m.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch((O=>{this._logger.log(_m.Error,`TransportSendQueue.stop() threw error '${O}'.`)})),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(O)}catch(B){this._logger.log(_m.Error,`HttpConnection.onclose(${O}) threw error '${B}'.`)}}}else this._logger.log(_m.Debug,`Call to HttpConnection.stopConnection(${O}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(O){if(0===O.lastIndexOf("https://",0)||0===O.lastIndexOf("http://",0))return O;if(!Utils_Platform.isBrowser)throw new Error(`Cannot resolve '${O}'.`);const B=window.document.createElement("a");return B.href=O,this._logger.log(_m.Information,`Normalizing '${O}' to '${B.href}'.`),B.href}_resolveNegotiateUrl(O){const B=O.indexOf("?");let U=O.substring(0,-1===B?O.length:B);return"/"!==U[U.length-1]&&(U+="/"),U+="negotiate",U+=-1===B?"":O.substring(B),-1===U.indexOf("negotiateVersion")&&(U+=-1===B?"?":"&",U+="negotiateVersion="+this._negotiateVersion),U}}class TransportSendQueue{constructor(O){this._transport=O,this._buffer=[],this._executing=!0,this._sendBufferedData=new PromiseSource,this._transportResult=new PromiseSource,this._sendLoopPromise=this._sendLoop()}send(O){return this._bufferData(O),this._transportResult||(this._transportResult=new PromiseSource),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(O){if(this._buffer.length&&typeof this._buffer[0]!=typeof O)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof O}`);this._buffer.push(O),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new PromiseSource;const O=this._transportResult;this._transportResult=void 0;const B="string"==typeof this._buffer[0]?this._buffer.join(""):TransportSendQueue._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(B),O.resolve()}catch(B){O.reject(B)}}}static _concatBuffers(O){const B=O.map((O=>O.byteLength)).reduce(((O,B)=>O+B)),U=new Uint8Array(B);let G=0;for(const B of O)U.set(new Uint8Array(B),G),G+=B.byteLength;return U.buffer}}class PromiseSource{constructor(){this.promise=new Promise(((O,B)=>[this._resolver,this._rejecter]=[O,B]))}resolve(){this._resolver()}reject(O){this._rejecter(O)}}class TextMessageFormat{static write(O){return`${O}${TextMessageFormat.RecordSeparator}`}static parse(O){if(O[O.length-1]!==TextMessageFormat.RecordSeparator)throw new Error("Message is incomplete.");const B=O.split(TextMessageFormat.RecordSeparator);return B.pop(),B}}TextMessageFormat.RecordSeparatorCode=30,TextMessageFormat.RecordSeparator=String.fromCharCode(TextMessageFormat.RecordSeparatorCode);class HandshakeProtocol{writeHandshakeRequest(O){return TextMessageFormat.write(JSON.stringify(O))}parseHandshakeResponse(O){let B,U;if(isArrayBuffer(O)){const G=new Uint8Array(O),q=G.indexOf(TextMessageFormat.RecordSeparatorCode);if(-1===q)throw new Error("Message is incomplete.");const j=q+1;B=String.fromCharCode.apply(null,Array.prototype.slice.call(G.slice(0,j))),U=G.byteLength>j?G.slice(j).buffer:null}else{const G=O,q=G.indexOf(TextMessageFormat.RecordSeparator);if(-1===q)throw new Error("Message is incomplete.");const j=q+1;B=G.substring(0,j),U=G.length>j?G.substring(j):null}const G=TextMessageFormat.parse(B),q=JSON.parse(G[0]);if(q.type)throw new Error("Expected a handshake response from the server.");return[U,q]}}var bm;(function(O){O[O.Invocation=1]="Invocation",O[O.StreamItem=2]="StreamItem",O[O.Completion=3]="Completion",O[O.StreamInvocation=4]="StreamInvocation",O[O.CancelInvocation=5]="CancelInvocation",O[O.Ping=6]="Ping",O[O.Close=7]="Close"})(bm||(bm={}));class Subject{constructor(){this.observers=[]}next(O){for(const B of this.observers)B.next(O)}error(O){for(const B of this.observers)B.error&&B.error(O)}complete(){for(const O of this.observers)O.complete&&O.complete()}subscribe(O){return this.observers.push(O),new SubjectSubscription(this,O)}}var Sm;(function(O){O.Disconnected="Disconnected",O.Connecting="Connecting",O.Connected="Connected",O.Disconnecting="Disconnecting",O.Reconnecting="Reconnecting"})(Sm||(Sm={}));class HubConnection{constructor(O,B,U,G){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(_m.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},Arg.isRequired(O,"connection"),Arg.isRequired(B,"logger"),Arg.isRequired(U,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=B,this._protocol=U,this.connection=O,this._reconnectPolicy=G,this._handshakeProtocol=new HandshakeProtocol,this.connection.onreceive=O=>this._processIncomingData(O),this.connection.onclose=O=>this._connectionClosed(O),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Sm.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:bm.Ping})}static create(O,B,U,G){return new HubConnection(O,B,U,G)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(O){if(this._connectionState!==Sm.Disconnected&&this._connectionState!==Sm.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!O)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=O}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==Sm.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=Sm.Connecting,this._logger.log(_m.Debug,"Starting HubConnection.");try{await this._startInternal(),Utils_Platform.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=Sm.Connected,this._connectionStarted=!0,this._logger.log(_m.Debug,"HubConnection connected successfully.")}catch(O){return this._connectionState=Sm.Disconnected,this._logger.log(_m.Debug,`HubConnection failed to start successfully because of error '${O}'.`),Promise.reject(O)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const O=new Promise(((O,B)=>{this._handshakeResolver=O,this._handshakeRejecter=B}));await this.connection.start(this._protocol.transferFormat);try{const B={protocol:this._protocol.name,version:this._protocol.version};if(this._logger.log(_m.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(B)),this._logger.log(_m.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await O,this._stopDuringStartError)throw this._stopDuringStartError;this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(O){throw this._logger.log(_m.Debug,`Hub handshake failed with error '${O}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(O),O}}async stop(){const O=this._startPromise;this._stopPromise=this._stopInternal(),await this._stopPromise;try{await O}catch(O){}}_stopInternal(O){return this._connectionState===Sm.Disconnected?(this._logger.log(_m.Debug,`Call to HubConnection.stop(${O}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===Sm.Disconnecting?(this._logger.log(_m.Debug,`Call to HttpConnection.stop(${O}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=Sm.Disconnecting,this._logger.log(_m.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(_m.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=O||new Errors_AbortError("The connection was stopped before the hub handshake could complete."),this.connection.stop(O)))}stream(O,...B){const[U,G]=this._replaceStreamingParams(B),q=this._createStreamInvocation(O,B,G);let j;const W=new Subject;return W.cancelCallback=()=>{const O=this._createCancelInvocation(q.invocationId);return delete this._callbacks[q.invocationId],j.then((()=>this._sendWithProtocol(O)))},this._callbacks[q.invocationId]=(O,B)=>{B?W.error(B):O&&(O.type===bm.Completion?O.error?W.error(new Error(O.error)):W.complete():W.next(O.item))},j=this._sendWithProtocol(q).catch((O=>{W.error(O),delete this._callbacks[q.invocationId]})),this._launchStreams(U,j),W}_sendMessage(O){return this._resetKeepAliveInterval(),this.connection.send(O)}_sendWithProtocol(O){return this._sendMessage(this._protocol.writeMessage(O))}send(O,...B){const[U,G]=this._replaceStreamingParams(B),q=this._sendWithProtocol(this._createInvocation(O,B,!0,G));return this._launchStreams(U,q),q}invoke(O,...B){const[U,G]=this._replaceStreamingParams(B),q=this._createInvocation(O,B,!1,G),j=new Promise(((O,B)=>{this._callbacks[q.invocationId]=(U,G)=>{G?B(G):U&&(U.type===bm.Completion?U.error?B(new Error(U.error)):O(U.result):B(new Error(`Unexpected message type: ${U.type}`)))};const G=this._sendWithProtocol(q).catch((O=>{B(O),delete this._callbacks[q.invocationId]}));this._launchStreams(U,G)}));return j}on(O,B){O&&B&&(O=O.toLowerCase(),this._methods[O]||(this._methods[O]=[]),-1===this._methods[O].indexOf(B)&&this._methods[O].push(B))}off(O,B){if(!O)return;O=O.toLowerCase();const U=this._methods[O];if(U)if(B){const G=U.indexOf(B);-1!==G&&(U.splice(G,1),0===U.length&&delete this._methods[O])}else delete this._methods[O]}onclose(O){O&&this._closedCallbacks.push(O)}onreconnecting(O){O&&this._reconnectingCallbacks.push(O)}onreconnected(O){O&&this._reconnectedCallbacks.push(O)}_processIncomingData(O){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(O=this._processHandshakeResponse(O),this._receivedHandshakeResponse=!0),O){const B=this._protocol.parseMessages(O,this._logger);for(const O of B)switch(O.type){case bm.Invocation:this._invokeClientMethod(O);break;case bm.StreamItem:case bm.Completion:{const B=this._callbacks[O.invocationId];if(B){O.type===bm.Completion&&delete this._callbacks[O.invocationId];try{B(O)}catch(O){this._logger.log(_m.Error,`Stream callback threw error: ${getErrorString(O)}`)}}break}case bm.Ping:break;case bm.Close:{this._logger.log(_m.Information,"Close message received from server.");const B=O.error?new Error("Server returned an error on close: "+O.error):void 0;!0===O.allowReconnect?this.connection.stop(B):this._stopPromise=this._stopInternal(B);break}default:this._logger.log(_m.Warning,`Invalid message type: ${O.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(O){let B,U;try{[U,B]=this._handshakeProtocol.parseHandshakeResponse(O)}catch(O){const B="Error parsing handshake response: "+O;this._logger.log(_m.Error,B);const U=new Error(B);throw this._handshakeRejecter(U),U}if(B.error){const O="Server returned handshake error: "+B.error;this._logger.log(_m.Error,O);const U=new Error(O);throw this._handshakeRejecter(U),U}return this._logger.log(_m.Debug,"Server handshake complete."),this._handshakeResolver(),U}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout((()=>this.serverTimeout()),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let O=this._nextKeepAlive-(new Date).getTime();O<0&&(O=0),this._pingServerHandle=setTimeout((async()=>{if(this._connectionState===Sm.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}}),O)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(O){const B=O.target.toLowerCase(),U=this._methods[B];if(!U)return this._logger.log(_m.Warning,`No client method with the name '${B}' found.`),void(O.invocationId&&(this._logger.log(_m.Warning,`No result given for '${B}' method and invocation ID '${O.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(O.invocationId,"Client didn't provide a result.",null))));const G=U.slice(),q=!!O.invocationId;let j,W,Y;for(const U of G)try{const G=j;j=await U.apply(this,O.arguments),q&&j&&G&&(this._logger.log(_m.Error,`Multiple results provided for '${B}'. Sending error to server.`),Y=this._createCompletionMessage(O.invocationId,"Client provided multiple results.",null)),W=void 0}catch(O){W=O,this._logger.log(_m.Error,`A callback for the method '${B}' threw error '${O}'.`)}Y?await this._sendWithProtocol(Y):q?(W?Y=this._createCompletionMessage(O.invocationId,`${W}`,null):void 0!==j?Y=this._createCompletionMessage(O.invocationId,null,j):(this._logger.log(_m.Warning,`No result given for '${B}' method and invocation ID '${O.invocationId}'.`),Y=this._createCompletionMessage(O.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(Y)):j&&this._logger.log(_m.Error,`Result given for '${B}' method but server is not expecting a result.`)}_connectionClosed(O){this._logger.log(_m.Debug,`HubConnection.connectionClosed(${O}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||O||new Errors_AbortError("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(O||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Sm.Disconnecting?this._completeClose(O):this._connectionState===Sm.Connected&&this._reconnectPolicy?this._reconnect(O):this._connectionState===Sm.Connected&&this._completeClose(O)}_completeClose(O){if(this._connectionStarted){this._connectionState=Sm.Disconnected,this._connectionStarted=!1,Utils_Platform.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach((B=>B.apply(this,[O])))}catch(B){this._logger.log(_m.Error,`An onclose callback called with error '${O}' threw error '${B}'.`)}}}async _reconnect(O){const B=Date.now();let U=0,G=void 0!==O?O:new Error("Attempting to reconnect due to a unknown error."),q=this._getNextRetryDelay(U++,0,G);if(null===q)return this._logger.log(_m.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this._completeClose(O);if(this._connectionState=Sm.Reconnecting,O?this._logger.log(_m.Information,`Connection reconnecting because of error '${O}'.`):this._logger.log(_m.Information,"Connection reconnecting."),0!==this._reconnectingCallbacks.length){try{this._reconnectingCallbacks.forEach((B=>B.apply(this,[O])))}catch(B){this._logger.log(_m.Error,`An onreconnecting callback called with error '${O}' threw error '${B}'.`)}if(this._connectionState!==Sm.Reconnecting)return void this._logger.log(_m.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==q;){if(this._logger.log(_m.Information,`Reconnect attempt number ${U} will start in ${q} ms.`),await new Promise((O=>{this._reconnectDelayHandle=setTimeout(O,q)})),this._reconnectDelayHandle=void 0,this._connectionState!==Sm.Reconnecting)return void this._logger.log(_m.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this._startInternal(),this._connectionState=Sm.Connected,this._logger.log(_m.Information,"HubConnection reconnected successfully."),0!==this._reconnectedCallbacks.length)try{this._reconnectedCallbacks.forEach((O=>O.apply(this,[this.connection.connectionId])))}catch(O){this._logger.log(_m.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${O}'.`)}return}catch(O){if(this._logger.log(_m.Information,`Reconnect attempt failed because of error '${O}'.`),this._connectionState!==Sm.Reconnecting)return this._logger.log(_m.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this._connectionState===Sm.Disconnecting&&this._completeClose());G=O instanceof Error?O:new Error(O.toString()),q=this._getNextRetryDelay(U++,Date.now()-B,G)}}this._logger.log(_m.Information,`Reconnect retries have been exhausted after ${Date.now()-B} ms and ${U} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(O,B,U){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:B,previousRetryCount:O,retryReason:U})}catch(U){return this._logger.log(_m.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${O}, ${B}) threw error '${U}'.`),null}}_cancelCallbacksWithError(O){const B=this._callbacks;this._callbacks={},Object.keys(B).forEach((U=>{const G=B[U];try{G(null,O)}catch(B){this._logger.log(_m.Error,`Stream 'error' callback called with '${O}' threw error: ${getErrorString(B)}`)}}))}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(O,B,U,G){if(U)return 0!==G.length?{arguments:B,streamIds:G,target:O,type:bm.Invocation}:{arguments:B,target:O,type:bm.Invocation};{const U=this._invocationId;return this._invocationId++,0!==G.length?{arguments:B,invocationId:U.toString(),streamIds:G,target:O,type:bm.Invocation}:{arguments:B,invocationId:U.toString(),target:O,type:bm.Invocation}}}_launchStreams(O,B){if(0!==O.length){B||(B=Promise.resolve());for(const U in O)O[U].subscribe({complete:()=>{B=B.then((()=>this._sendWithProtocol(this._createCompletionMessage(U))))},error:O=>{let G;G=O instanceof Error?O.message:O&&O.toString?O.toString():"Unknown error",B=B.then((()=>this._sendWithProtocol(this._createCompletionMessage(U,G))))},next:O=>{B=B.then((()=>this._sendWithProtocol(this._createStreamItemMessage(U,O))))}})}}_replaceStreamingParams(O){const B=[],U=[];for(let G=0;G<O.length;G++){const q=O[G];if(this._isObservable(q)){const j=this._invocationId;this._invocationId++,B[j]=q,U.push(j.toString()),O.splice(G,1)}}return[B,U]}_isObservable(O){return O&&O.subscribe&&"function"==typeof O.subscribe}_createStreamInvocation(O,B,U){const G=this._invocationId;return this._invocationId++,0!==U.length?{arguments:B,invocationId:G.toString(),streamIds:U,target:O,type:bm.StreamInvocation}:{arguments:B,invocationId:G.toString(),target:O,type:bm.StreamInvocation}}_createCancelInvocation(O){return{invocationId:O,type:bm.CancelInvocation}}_createStreamItemMessage(O,B){return{invocationId:O,item:B,type:bm.StreamItem}}_createCompletionMessage(O,B,U){return B?{error:B,invocationId:O,type:bm.Completion}:{invocationId:O,result:U,type:bm.Completion}}}class JsonHubProtocol{constructor(){this.name="json",this.version=1,this.transferFormat=ym.Text}parseMessages(O,B){if("string"!=typeof O)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!O)return[];null===B&&(B=NullLogger.instance);const U=TextMessageFormat.parse(O),G=[];for(const O of U){const U=JSON.parse(O);if("number"!=typeof U.type)throw new Error("Invalid payload.");switch(U.type){case bm.Invocation:this._isInvocationMessage(U);break;case bm.StreamItem:this._isStreamItemMessage(U);break;case bm.Completion:this._isCompletionMessage(U);break;case bm.Ping:case bm.Close:break;default:B.log(_m.Information,"Unknown message type '"+U.type+"' ignored.");continue}G.push(U)}return G}writeMessage(O){return TextMessageFormat.write(JSON.stringify(O))}_isInvocationMessage(O){this._assertNotEmptyString(O.target,"Invalid payload for Invocation message."),void 0!==O.invocationId&&this._assertNotEmptyString(O.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(O){if(this._assertNotEmptyString(O.invocationId,"Invalid payload for StreamItem message."),void 0===O.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(O){if(O.result&&O.error)throw new Error("Invalid payload for Completion message.");!O.result&&O.error&&this._assertNotEmptyString(O.error,"Invalid payload for Completion message."),this._assertNotEmptyString(O.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(O,B){if("string"!=typeof O||""===O)throw new Error(B)}}const Cm={trace:_m.Trace,debug:_m.Debug,info:_m.Information,information:_m.Information,warn:_m.Warning,warning:_m.Warning,error:_m.Error,critical:_m.Critical,none:_m.None};class HubConnectionBuilder{configureLogging(O){if(Arg.isRequired(O,"logging"),void 0!==O.log)this.logger=O;else if("string"==typeof O){const B=function(O){const B=Cm[O.toLowerCase()];if(void 0!==B)return B;throw new Error(`Unknown log level: ${O}`)}(O);this.logger=new ConsoleLogger(B)}else this.logger=new ConsoleLogger(O);return this}withUrl(O,B){return Arg.isRequired(O,"url"),Arg.isNotEmpty(O,"url"),this.url=O,this.httpConnectionOptions="object"==typeof B?{...this.httpConnectionOptions,...B}:{...this.httpConnectionOptions,transport:B},this}withHubProtocol(O){return Arg.isRequired(O,"protocol"),this.protocol=O,this}withAutomaticReconnect(O){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return O?Array.isArray(O)?this.reconnectPolicy=new DefaultReconnectPolicy(O):this.reconnectPolicy=O:this.reconnectPolicy=new DefaultReconnectPolicy,this}build(){const O=this.httpConnectionOptions||{};if(void 0===O.logger&&(O.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const B=new HttpConnection(this.url,O);return HubConnection.create(B,this.logger||NullLogger.instance,this.protocol||new JsonHubProtocol,this.reconnectPolicy)}}class DisposableDeferredPromise_DeferredPromise{constructor(){this._p=this.reconstructPromise(),this.rejected=!1,this.resolved=!1}get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}get p(){return this._p}dispose(){this._p&&(delete this._p,this.isSettled||this.completeCallback(void 0),delete this.completeCallback,delete this.errorCallback)}reset(){this.dispose(),this.rejected=!1,this.resolved=!1,this._p=this.reconstructPromise()}complete(O){return new Promise((B=>{this.completeCallback(O),this.resolved=!0,B()}))}error(O){return new Promise((B=>{this.errorCallback(O),this.rejected=!0,B()}))}cancel(){new Promise((O=>{this.errorCallback(new errors_CancellationError),this.rejected=!0,O()}))}reconstructPromise(){return new Promise(((O,B)=>{this.completeCallback=O,this.errorCallback=B}))}}var Em,xm,Tm;(function(O){O[O.Default=0]="Default",O[O.Shared=1]="Shared"})(Em||(Em={}));let wm=class extends StreamEventNotifier{constructor(O,B,U,G,q){var j;super(),this.config=O,this.errorState=B,this.eventBus=U,this.conversation=G,this.log=q,xm.set(this,void 0),Tm.set(this,void 0),this.subscription=this._register(new lifecycle_MutableDisposable),this._deferred=this._register(new lifecycle_MutableDisposable),this._closed=!1,this.update=O=>{var B;this.conversation.setActive(),(null===(B=__classPrivateFieldGet(this,Tm,"f"))||void 0===B?void 0:B.isCancellationRequested)?this.cancelPendingRequest():(O.type=ji.GetMessagesResponse,this.onUpdateEmitter.fire(O))},this.next=O=>{var B,U,G,q;if(this.conversation.setActive(),null===(B=__classPrivateFieldGet(this,Tm,"f"))||void 0===B?void 0:B.isCancellationRequested)return void this.cancelPendingRequest();O.type=ji.ChatResponse;const j=null!==(G=null===(U=O.result)||void 0===U?void 0:U.value)&&void 0!==G?G:Wi.Unknown;j===Wi.Success?(this.onResponseEmitter.fire(O),this.checkNewThread(O)):(null===(q=this.log)||void 0===q||q.trace(this,this.next,Yl.Error,"result:",O.result).write(),this.error(new ChatStreamResultError(j)))},this.error=async O=>{var B;const U=O instanceof ChatStreamResultError?O:new ChatStreamTransportError("Internal connection error.",O);null===(B=this.log)||void 0===B||B.error(this,this.error,Yl.Error,U).write(),await this.stopConnectionAsync(),this.deferred.error(U).finally((()=>this.finalizeStreamSubscription()))},this.complete=async()=>{var O;null===(O=this.log)||void 0===O||O.trace(this,this.complete,Yl.Complete).write(),await this.stopConnectionAsync(),this.deferred.complete().finally((()=>this.finalizeStreamSubscription())),this.onCompleteEmitter.fire()},null===(j=this.log)||void 0===j||j.trace(this,"ctor",null).write(),this.finalizeStreamSubscription()}get connection(){var O;return __classPrivateFieldSet(this,xm,null!==(O=__classPrivateFieldGet(this,xm,"f"))&&void 0!==O?O:this.buildHubConnection(),"f"),__classPrivateFieldGet(this,xm,"f")}get deferred(){return this._deferred.value}get closed(){return this._closed}set closed(O){this._closed||this._closed===O||(this._closed=O,this._closed&&(this.deferred.cancel(),this.finalizeStreamSubscription()))}async handleStreamEventsAsync(O,B=oi.None){var U;return __classPrivateFieldSet(this,Tm,B,"f"),null===(U=this.log)||void 0===U||U.trace(this,this.handleStreamEventsAsync,null).write(),await this.startConnectionAsync(),this.errorState.chatErrorState===Gc.AttemptingToReconnect&&this.errorState.setChatErrorState(),this.subscription.value=this.connection.stream("chat",O).subscribe(this),this.onBeginEmitter.fire(O),this.deferred.p}checkSharedNewThread(O,B){var U,G,q,j;const W=O.messages.find((O=>O.author===Yi.Bot&&O.messageType===tr.IncomingBotResponse));this.eventBus.sendSystemEvent(Xd.CreateUpdateThread,{id:B,text:null!==(G=null===(U=null==W?void 0:W.text)||void 0===U?void 0:U.substring(0,60))&&void 0!==G?G:"",expiry:null!==(j=null===(q=O.metadata)||void 0===q?void 0:q.expiryDate)&&void 0!==j?j:-1,type:Em.Shared,conversationSignature:this.conversation.hashedSignature})}finalizeStreamSubscription(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.finalizeStreamSubscription,null).write(),this._closed=!1,this.subscription.clear(),this._deferred.value=new DisposableDeferredPromise_DeferredPromise,this.clearCancellationToken()}async startConnectionAsync(){try{this.connection.baseUrl=this.getConnectionBaseUrl(),await this.connection.start()}catch(O){throw new ChatStreamConnectionError("Failed to start connection.",O)}}async stopConnectionAsync(){await this.connection.stop()}buildHubConnection(){const O={timeout:1e4,transport:fm.WebSockets,skipNegotiation:!0,withCredentials:!1};let B=this.config.logging.logLevel;B===Kl.Off&&(B=_m.None);const U=this.getConnectionBaseUrl(),G=(new HubConnectionBuilder).withUrl(U,O).configureLogging(_m[B]).build();return G.on("update",this.update),G}getConnectionBaseUrl(){const{baseUrl:O,pathBase:B,pathChatHub:U}=this.config.sydney;return`${O}${B}${U}`}cancelPendingRequest(){this.subscription.clear(),this.complete(),this.clearCancellationToken()}clearCancellationToken(){__classPrivateFieldSet(this,Tm,void 0,"f")}dispose(){this.connection.off("update",this.update),this.connection.state===Sm.Connected&&this.stopConnectionAsync(),this._closed=!0,this.clearCancellationToken(),super.dispose()}checkNewThread(O){var B;const U=O.messages.find((O=>O.author===Yi.Bot&&(O.messageType===tr.IncomingBotResponse||this.config.features.enableContextMessage&&O.messageType===tr.Context)));this.eventBus.sendSystemEvent(Xd.CreateUpdateThread,{id:O.conversationId,text:O.defaultChatName?O.defaultChatName:null===(B=null==U?void 0:U.text)||void 0===B?void 0:B.substring(0,60),expiry:O.conversationExpiryTime,type:Em.Default,conversationSignature:this.conversation.hashedSignature})}};var km;xm=new WeakMap,Tm=new WeakMap,wm=__decorate([__param(0,ql),__param(1,Uc),__param(2,Zd),__param(3,Dc),__param(4,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object])],wm),function(O){O[O.MinWindowWidth=0]="MinWindowWidth",O[O.MinElementWidth=1]="MinElementWidth"}(km||(km={}));const Am=[{trigger:km.MinWindowWidth,name:"big",value:1200},{trigger:km.MinWindowWidth,name:"medium",value:800},{trigger:km.MinWindowWidth,name:"small",value:0}],Rm=[{trigger:km.MinElementWidth,name:"big",value:1200},{trigger:km.MinElementWidth,name:"medium",value:800},{trigger:km.MinElementWidth,name:"small",value:0}];class LayoutStateProviderBase extends lifecycle_Disposable{constructor(O){var B;super(),this.log=O,this._activeState=null,this.activeStateChangedEmitter=this._register(new Emitter),null===(B=this.log)||void 0===B||B.trace(this,"ctor",null).write()}get activeState(){return this._activeState}get onActiveStateChanged(){return this.activeStateChangedEmitter.event}updateActiveState(O){var B;this._activeState!==O&&(null===(B=this.log)||void 0===B||B.trace(this,this.updateActiveState,"state:",O).write(),this._activeState=O,this.activeStateChangedEmitter.fire(O))}}__decorate([observable,__metadata("design:type",Object)],LayoutStateProviderBase.prototype,"_activeState",void 0);let Im=class extends LayoutStateProviderBase{constructor(O){super(O),this.elementResizeObserver=null,this.element=null,this.handleResized=O=>{var B;null===(B=this.log)||void 0===B||B.trace(this,this.handleResized,null).write();for(const B of Rm)if(O[0].target.clientWidth>=B.value)return void super.updateActiveState(B)},this.configureResizeObserver()}dispose(){super.dispose(),this.element&&this.elementResizeObserver&&(this.elementResizeObserver.unobserve(this.element),this.elementResizeObserver=null,this.element=null)}configureResizeObserver(){this.element=document.querySelector("cib-serp"),this.element&&(this.elementResizeObserver=new ResizeObserver(this.handleResized),this.elementResizeObserver.observe(this.element))}};Im=__decorate([__param(0,Nt(Pi)),__metadata("design:paramtypes",[Object])],Im);let Pm=class extends LayoutStateProviderBase{constructor(O){super(O),this.breakpointMediaQueryMap=new Map,this.handleMediaQueryChange=O=>{var B;if(O.target instanceof MediaQueryList&&O.matches){null===(B=this.log)||void 0===B||B.trace(this,this.handleMediaQueryChange,null,O).write();const U=this.breakpointMediaQueryMap.get(O.target);U&&super.updateActiveState(U)}},this.configureMatchMediaQueries()}configureMatchMediaQueries(){var O;let B=!1;for(const U of Am){const G=matchMedia(`(min-width: ${U.value}px)`);this.breakpointMediaQueryMap.set(G,U),this._register(addDisposableListener(G,"change",this.handleMediaQueryChange)),G.matches&&!B&&(B=!0,null===(O=this.log)||void 0===O||O.trace(this,this.configureMatchMediaQueries,"initial state:",U.name).write(),super.updateActiveState(U))}}};var Nm;Pm=__decorate([__param(0,Nt(Pi)),__metadata("design:paramtypes",[Object])],Pm),function(O){const B={text:"any",messageId:"any",author:Yi.Bot,contentOrigin:Ki.DeepLeo,messageType:void 0,hiddenText:void 0},U={...B,contentOrigin:Ki.DeepLeo,hiddenText:"any",messageType:tr.Any},G={...U,messageType:tr.InternalSearchQuery},q={...U,messageType:tr.InternalLoaderMessage},j={...U,messageType:tr.CaptchaChallenge},W={...U,messageType:tr.Disengaged},Y={...U,messageType:tr.RenderCardRequest},K={...U,messageType:tr.SemanticSerp},Q={...U,messageType:tr.AdsQuery},Z={...U,messageType:tr.GenerateContentQuery};O.isBaseMessage=function(O){const{text:U,author:G,messageId:q}=B;return O.author===G&&typeof O.messageId==typeof q&&(typeof O.text==typeof U||Array.isArray(O.adaptiveCards))},O.isMessageTypeBase=function(B){const{hiddenText:G,messageType:q,contentOrigin:j}=U;return B.contentOrigin===j&&typeof B.messageType==typeof q&&typeof B.hiddenText==typeof G&&O.isBaseMessage(B)},O.isDisengagedMessage=function(B){const{messageType:U}=W;return B.messageType===U&&O.isMessageTypeBase(B)},O.isInternalSearchQuery=function(B){const{messageType:U}=G;return B.messageType===U&&O.isMessageTypeBase(B)},O.isInternalLoaderMessage=function(B){const{messageType:U}=q;return B.messageType===U&&O.isMessageTypeBase(B)},O.isRenderCardRequest=function(B){const{messageType:U,contentOrigin:G}=Y;return B.messageType===U&&B.contentOrigin===G&&O.isBaseMessage(B)},O.isSemanticSerp=function(B){const{messageType:U,contentOrigin:G}=K;return B.messageType===U&&B.contentOrigin===G&&O.isBaseMessage(B)},O.isAdsQuery=function(B){const{messageType:U,contentOrigin:G}=Q;return B.messageType===U&&B.contentOrigin===G&&O.isBaseMessage(B)},O.isGenerateContentQuery=function(B){const{messageType:U,contentOrigin:G}=Z;return B.messageType===U&&B.contentOrigin===G&&void 0!==B.contentType&&Object.values(Qi).includes(B.contentType)&&O.isBaseMessage(B)},O.isCaptchaChallenge=function(B){const{messageType:U}=j;return B.messageType===U&&O.isBaseMessage(B)}}(Nm||(Nm={}));class MessageModelBase{constructor(O){var B,U,G,q,j;this.isFinalized=!1,this._onMessageRemovedEmitter=new Emitter,this.text=null!==(U=null===(B=O.text)||void 0===B?void 0:B.trim())&&void 0!==U?U:"",this.requestId=null!==(G=O.requestId)&&void 0!==G?G:CoreUtils.uuid(),this.messageId=null!==(q=O.messageId)&&void 0!==q?q:CoreUtils.uuid(),this.isShared=O.isShared||!1,this.messageType=O.messageType,this.author=null!==(j=O.author)&&void 0!==j?j:Yi.User,this.contentOrigin=O.contentOrigin,this.adaptiveCards=this.getAdaptiveCards(O),this.onPropertyChanged=pt.getNotifier(this)}update(O){var B;this.adaptiveCards=this.getAdaptiveCards(O);const U=(null!==(B=O.text)&&void 0!==B?B:this.text).trim();this.text!==U&&(this.text=U)}finalize(){return this.isFinalized||(this.isFinalized=!0),this}append(O){O&&(this.text+=O)}onMessageRemoved(O){return this._onMessageRemovedEmitter.event(O)}remove(){this._onMessageRemovedEmitter.fire()}getAdaptiveCards(O){return O.adaptiveCards?Array.from(O.adaptiveCards):[]}}__decorate([observable,__metadata("design:type",Boolean)],MessageModelBase.prototype,"isFinalized",void 0),__decorate([observable,__metadata("design:type",String)],MessageModelBase.prototype,"text",void 0),__decorate([observable,__metadata("design:type",Array)],MessageModelBase.prototype,"adaptiveCards",void 0),__decorate([observable,__metadata("design:type",String)],MessageModelBase.prototype,"contentOrigin",void 0);class FullBleedMessageModel extends MessageModelBase{constructor(O){super(O),this.type=vp.FullBleed,this.suggestedResponses=FullBleedMessageModel.getSuggestedResponses(O)}static getSuggestedResponses(O){var B,U;return null!==(U=null===(B=O.suggestedResponses)||void 0===B?void 0:B.map((O=>({...O}))))&&void 0!==U?U:[]}}class ExternalHTMLMessageModel extends MessageModelBase{constructor(O){super(O),this.type=vp.ExternalHTML,this.suggestedResponses=ExternalHTMLMessageModel.getSuggestedResponses(O)}static getSuggestedResponses(O){var B,U;return null!==(U=null===(B=O.suggestedResponses)||void 0===B?void 0:B.map((O=>({...O}))))&&void 0!==U?U:[]}}class ContextMessageModel extends MessageModelBase{constructor(O,B){super(B),this.type=vp.Context,this.description=B.description,this.sourceUrl=B.sourceUrl,this.sourceName=B.sourceName,this.contextType=O}}class TextMessageModel extends MessageModelBase{constructor(O,B){var U,G;super(O),this.type=vp.Text,this._additionalAttributionDetails=B,this.sourceAttributions=TextMessageModel.getSourceAttributions(O),this.suggestedResponses=TextMessageModel.getSuggestedResponses(O),this.feedbackPrompt=null!==(U=O.feedbackPrompt)&&void 0!==U&&U,this.reportable=null===(G=O.reportable)||void 0===G||G}update(O){var B,U;this.sourceAttributions=TextMessageModel.getSourceAttributions(O,this._additionalAttributionDetails),this.suggestedResponses=TextMessageModel.getSuggestedResponses(O),this.adaptiveCards=this.getAdaptiveCards(O);let G=null;this.contentOrigin!==O.contentOrigin&&(O.contentOrigin===Ki.Apology&&(G=null!==(B=O.topicChangerText)&&void 0!==B?B:""),this.contentOrigin=O.contentOrigin),null!=G||(G=null!==(U=O.text)&&void 0!==U?U:this.text),G=G.trim(),this.text!==G&&(this.text=G)}static getSuggestedResponses(O){var B,U;return O.contentOrigin===Ki.Apology?[]:null!==(U=null===(B=O.suggestedResponses)||void 0===B?void 0:B.map((O=>({...O}))))&&void 0!==U?U:[]}static getSourceAttributions(O,B){var U,G;return O.contentOrigin===Ki.Apology?[]:null!==(G=null===(U=null==O?void 0:O.sourceAttributions)||void 0===U?void 0:U.map((O=>({...O,snippets:this.getSnippet(O.seeMoreUrl,B)}))))&&void 0!==G?G:[]}static getSnippet(O,B){var U,G;return null!==(G=null===(U=null==B?void 0:B.find((B=>B.url===O)))||void 0===U?void 0:U.snippets)&&void 0!==G?G:[]}}__decorate([observable,__metadata("design:type",Object)],TextMessageModel.prototype,"inlineAdsModel",void 0),__decorate([observable,__metadata("design:type",Array)],TextMessageModel.prototype,"sourceAttributions",void 0);class MetaMessageModel extends MessageModelBase{constructor(O,B,U){super(B),this.type=vp.Meta,this.isHidden=O,this.disableIcon=U}}class HostMessageModel extends MessageModelBase{constructor(O,B,U){if(super(U),this.type=vp.Host,this.isShareable=!1,this.messageData=U,this.contentType=O,this.contentUrl=B,this.renderUrl=U.renderUrl,U.messageId)this.iframeid=U.messageId;else{this.iframeid=CoreUtils.uuid();const O=new URL(this.contentUrl);O.searchParams.set("iframeid",this.iframeid),this.contentUrl=O.href}}}let Om=class MessageModelFactory{constructor(O,B,U,G,q){this.config=O,this.conversation=B,this.telemetry=U,this.errorState=G,this.log=q,this._additionalAttributionDetails=[]}get additionalAttributionDetails(){return this._additionalAttributionDetails}createIncoming(O){var B,U;let G=null;switch(!O.messageType&&Nm.isBaseMessage(O)&&(O.messageType=tr.Chat),!O.messageType||O.messageType===tr.Chat&&O.responseType===ji.GetMessagesResponse||null===(B=this.log)||void 0===B||B.trace(this,this.createIncoming,O.messageType,O).write(),O.messageType){case tr.InternalSearchQuery:this.config.features.enableMetaMessages&&Nm.isInternalSearchQuery(O)&&(G=this.createLocalMeta(O,!1));break;case tr.InternalStateMarker:break;case tr.InternalLoaderMessage:this.config.features.enableMetaMessages&&Nm.isInternalLoaderMessage(O)&&(G=this.createLocalMeta(O,!1));break;case tr.RenderCardRequest:this.config.features.enableAnswerCards&&Nm.isRenderCardRequest(O)&&(G=this.createAnswerHostMessageInternal(O));break;case tr.SemanticSerp:this.config.semserp.isEnabled&&Nm.isSemanticSerp(O)&&(G=this.createSemSerpHostMessageInternal(O));break;case tr.AdsQuery:this.config.features.enableAds&&Nm.isAdsQuery(O)&&(G=this.createAdsHostMessageInternal(O));break;case tr.GenerateContentQuery:this.config.features.enableSydImageCreate&&Nm.isGenerateContentQuery(O)&&(G=this.createContentCreatorHostMessageInternal(O));break;case tr.CaptchaChallenge:Nm.isCaptchaChallenge(O)&&(G=this.createCaptchaHostMessageInternal(O));break;case tr.SearchQuery:case tr.Internal:case tr.Ads:break;case tr.Disengaged:Nm.isDisengagedMessage(O)&&this.handleConversationDisengagement();break;case tr.InternalSearchResult:this.extractAdditionalAttributionDetails(O);break;case tr.InternalActionMarker:case tr.InternalSuggestions:case tr.Suggestion:break;case tr.Chat:default:Nm.isBaseMessage(O)?G=this.createLocalText(O):null===(U=this.log)||void 0===U||U.warn(this,this.createIncoming,`UNMATCHED content origin: '${O.contentOrigin}'`,O).write()}return this.config.features.enableAutoRecoverFromInvalidSessionForFirstTurn&&G&&(G.conversationId=this.conversation.id),G}extractAdditionalAttributionDetails(O){var B;if(O.messageType===tr.InternalSearchResult&&O.hiddenText){const U=null===(B=O.hiddenText.match("```json([^```]*)"))||void 0===B?void 0:B[1];if(!U)return;this._additionalAttributionDetails=[...JSON.parse(U).question_answering_results,...JSON.parse(U).web_search_results]||[]}}createLocalHTML(O){return new ExternalHTMLMessageModel(O)}createLocalFullBleed(O){return new FullBleedMessageModel(O)}createLocalText(O){return new TextMessageModel(O,this.additionalAttributionDetails)}createLocalMeta(O,B=!1,U){return new MetaMessageModel(B,O,null!=U&&U)}createLocalHost(O,B){const U={...this.generateLocalMessageData(O),contentOrigin:Ki.DeepLeo,messageType:tr.Any,author:Yi.Bot,hiddenText:""};let G=null;switch(B){case bp.Ads:U.messageType=tr.AdsQuery,G=this.createAdsHostMessageInternal(U);break;case bp.Answer:U.messageType=tr.RenderCardRequest,G=this.createAnswerHostMessageInternal(U);break;case bp.Captcha:U.messageType=tr.CaptchaChallenge,G=this.createCaptchaHostMessageInternal(U);break;case bp.ImageContentCreator:U.messageType=tr.GenerateContentQuery,G=this.createContentCreatorHostMessageInternal(U);break;case bp.SemSerp:U.messageType=tr.SemanticSerp,G=this.createSemSerpHostMessageInternal(U)}return G}createLocalContext(O,B){let U=null;if(B===Zi.WebPage)U=new ContextMessageModel(Zi.WebPage,O);return U}handleConversationDisengagement(){this.errorState.setChatErrorState(Gc.Disengaged)}getConversationId(){return null===this.conversation.id?"":this.conversation.id}createAdsHostMessageInternal(O){var B;this.config.ads.query.kseed=`${this.telemetry.getNextKSeed()}`,this.config.ads.query.SFX=this.telemetry.getNextInstSuffix();const U=this.buildHostedContentUrl(this.config.ads,O.text,O.messageId);U.searchParams.set("codex_conid",this.getConversationId());let G=3;do{U.searchParams.set("codex_summ",this.conversation.createConversationSummary(G--))}while(U.href.length>2e3);return null===(B=this.log)||void 0===B||B.trace(this,this.createAdsHostMessageInternal,`AdsQuery hosted content URL (length: ${U.href.length}):`,U.href).write(),new HostMessageModel(bp.Ads,U.href,O)}createAnswerHostMessageInternal(O){this.config.answers.query.kseed=`${this.telemetry.getNextKSeed()}`,this.config.answers.query.SFX=this.telemetry.getNextInstSuffix();const B=this.buildHostedContentUrl(this.config.answers,O.text,O.messageId);return new HostMessageModel(bp.Answer,B.href,O)}createCaptchaHostMessageInternal(O){const B=this.buildHostedContentUrl(this.config.captcha,O.text,O.messageId);return new HostMessageModel(bp.Captcha,B.href,O)}createContentCreatorHostMessageInternal(O){this.config.contentCreator.query.kseed=`${this.telemetry.getNextKSeed()}`,this.config.contentCreator.query.SFX=this.telemetry.getNextInstSuffix();const B=this.buildHostedContentUrl(this.config.contentCreator,O.text,O.messageId,O.isShared?O.renderUrl:void 0);return new HostMessageModel(bp.ImageContentCreator,B.href,O)}createSemSerpHostMessageInternal(O){const B=this.buildHostedContentUrl(this.config.semserp,O.text,O.messageId);return new HostMessageModel(bp.SemSerp,B.href,O)}buildHostedContentUrl(O,B,U,G){const q=G?new URL(G):this.config.buildUrl(O);return q.searchParams.has(MessageModelFactory.queryParamKey)||q.searchParams.set(MessageModelFactory.queryParamKey,this.applyTextTransformations(B)),q.searchParams.has(MessageModelFactory.iframeUrlParamKey)||q.searchParams.set(MessageModelFactory.iframeUrlParamKey,U),q}generateLocalMessageData(O){var B,U,G,q,j;return{...O,text:null!==(B=O.text)&&void 0!==B?B:"",requestId:null!==(U=O.requestId)&&void 0!==U?U:CoreUtils.uuid(),messageId:null!==(G=O.requestId)&&void 0!==G?G:CoreUtils.uuid(),author:null!==(q=O.author)&&void 0!==q?q:Yi.Bot,contentOrigin:this.config.sydney.request.source,adaptiveCards:[],reportable:null===(j=O.reportable)||void 0===j||j}}applyTextTransformations(O){const{LOCATION_OF_HUMAN_PARAM:B,LOCATION_OF_HUMAN_VALUE:U}=this.config.sydney;return(O=O.replaceAll(B,U)).startsWith("> ")&&(O=O.substring(2)),O}};Om.queryParamKey="q",Om.iframeUrlParamKey="iframeid",Om=__decorate([__param(0,ql),__param(1,Dc),__param(2,$c),__param(3,Uc),__param(4,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object])],Om);class ThreadDataBase{constructor(O,B,U,G,q,j,W){this.chatName=null!=O?O:"",this.tone=null!=B?B:"",this.createTimeUtc=null!=U?U:-1,this.updateTimeUtc=null!=G?G:-1,this.expiryTimeUtc=null!=q?q:-1,this.conversationId=j,this.conversationSignature=W}}class ThreadData extends ThreadDataBase{constructor(O,B,U,G,q,j,W){super(O,B,U,G,q,j,W)}}class SharedThreadData extends ThreadDataBase{constructor(O,B,U,G,q,j,W){super(O,B,U,G,q,j,W),this.sharedId=null!=j?j:""}}const Mm=kt.createInterface("IThreadModelFactory");class ThreadModel{constructor(O){this._onThreadRemovedEmitter=new Emitter,this.threadData=O,this.id=O.conversationId}onThreadRemoved(O){return this._onThreadRemovedEmitter.event(O)}remove(){this._onThreadRemovedEmitter.fire()}}class ThreadSharedModel{constructor(O){this._onThreadRemovedEmitter=new Emitter,this.threadData=O,this.id=O.sharedId}onThreadRemoved(O){return this._onThreadRemovedEmitter.event(O)}remove(){this._onThreadRemovedEmitter.fire()}}class ThreadModelFactory{createThreadModel(O){return O instanceof SharedThreadData?new ThreadSharedModel(O):new ThreadModel(O)}}const Dm=kt.createInterface();var Lm=U(8911);const Bm=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function superscript(O,B){const U=O.posMax,G=O.pos;if(94!==O.src.charCodeAt(G))return!1;if(B)return!1;if(G+2>=U)return!1;let q=!1;for(O.pos=G+1;O.pos<U;){if(94===O.src.charCodeAt(O.pos)){q=!0;break}O.md.inline.skipToken(O)}if(!q||G+1===O.pos)return O.pos=G,!1;const j=O.src.slice(G+1,O.pos);if(j.match(/(^|[^\\])(\\\\)*\s/))return O.pos=G,!1;O.posMax=O.pos,O.pos=G+1;let W=O.push("sup_open","sup",1);return W.markup="^",W=O.push("text","",0),W.content=j.replace(Bm,"$1"),W=O.push("sup_close","sup",-1),W.markup="^",O.pos=O.posMax+1,O.posMax=U,!0}function MarkdownItSup(O){O.inline.ruler.after("emphasis","sup",superscript)}class SourceLocation{constructor(O,B,U){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=O,this.start=B,this.end=U}static range(O,B){return B?O&&O.loc&&B.loc&&O.loc.lexer===B.loc.lexer?new SourceLocation(O.loc.lexer,O.loc.start,B.loc.end):null:O&&O.loc}}class Token{constructor(O,B){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=O,this.loc=B}range(O,B){return new Token(B,SourceLocation.range(this,O))}}class ParseError{constructor(O,B){this.position=void 0;var U,G="KaTeX parse error: "+O,q=B&&B.loc;if(q&&q.start<=q.end){var j=q.lexer.input;U=q.start;var W=q.end;U===j.length?G+=" at end of input: ":G+=" at position "+(U+1)+": ";var Y=j.slice(U,W).replace(/[^]/g,"$&");G+=(U>15?""+j.slice(U-15,U):j.slice(0,U))+Y+(W+15<j.length?j.slice(W,W+15)+"":j.slice(W))}var K=new Error(G);return K.name="ParseError",K.__proto__=ParseError.prototype,K.position=U,K}}ParseError.prototype.__proto__=Error.prototype;var Fm=/([A-Z])/g,zm={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},$m=/[&><"']/g;var Um=function getBaseElem(O){return"ordgroup"===O.type||"color"===O.type?1===O.body.length?getBaseElem(O.body[0]):O:"font"===O.type?getBaseElem(O.body):O},Vm={contains:function(O,B){return-1!==O.indexOf(B)},deflt:function(O,B){return void 0===O?B:O},escape:function(O){return String(O).replace($m,(O=>zm[O]))},hyphenate:function(O){return O.replace(Fm,"-$1").toLowerCase()},getBaseElem:Um,isCharacterBox:function(O){var B=Um(O);return"mathord"===B.type||"textord"===B.type||"atom"===B.type},protocolFromUrl:function(O){var B=/^\s*([^\\/#]*?)(?::|&#0*58|&#x0*3a)/i.exec(O);return null!=B?B[1]:"_relative"}},Gm={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:O=>"#"+O},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(O,B)=>(B.push(O),B)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:O=>Math.max(0,O),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:O=>Math.max(0,O),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:O=>Math.max(0,O),cli:"-e, --max-expand <n>",cliProcessor:O=>"Infinity"===O?1/0:parseInt(O)},globalGroup:{type:"boolean",cli:!1}};function getDefaultValue(O){if(O.default)return O.default;var B=O.type,U=Array.isArray(B)?B[0]:B;if("string"!=typeof U)return U.enum[0];switch(U){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class Settings{constructor(O){for(var B in this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,O=O||{},Gm)if(Gm.hasOwnProperty(B)){var U=Gm[B];this[B]=void 0!==O[B]?U.processor?U.processor(O[B]):O[B]:getDefaultValue(U)}}reportNonstrict(O,B,U){var G=this.strict;if("function"==typeof G&&(G=G(O,B,U)),G&&"ignore"!==G){if(!0===G||"error"===G)throw new ParseError("LaTeX-incompatible input and strict mode is set to 'error': "+B+" ["+O+"]",U);"warn"===G?"undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+B+" ["+O+"]"):"undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to unrecognized '"+G+"': "+B+" ["+O+"]")}}useStrictBehavior(O,B,U){var G=this.strict;if("function"==typeof G)try{G=G(O,B,U)}catch(O){G="error"}return!(!G||"ignore"===G)&&(!0===G||"error"===G||("warn"===G?("undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+B+" ["+O+"]"),!1):("undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to unrecognized '"+G+"': "+B+" ["+O+"]"),!1)))}isTrusted(O){O.url&&!O.protocol&&(O.protocol=Vm.protocolFromUrl(O.url));var B="function"==typeof this.trust?this.trust(O):this.trust;return Boolean(B)}}class Style{constructor(O,B,U){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=O,this.size=B,this.cramped=U}sup(){return Hm[qm[this.id]]}sub(){return Hm[jm[this.id]]}fracNum(){return Hm[Wm[this.id]]}fracDen(){return Hm[Ym[this.id]]}cramp(){return Hm[Km[this.id]]}text(){return Hm[Qm[this.id]]}isTight(){return this.size>=2}}var Hm=[new Style(0,0,!1),new Style(1,0,!0),new Style(2,1,!1),new Style(3,1,!0),new Style(4,2,!1),new Style(5,2,!0),new Style(6,3,!1),new Style(7,3,!0)],qm=[4,5,4,5,6,7,6,7],jm=[5,5,5,5,7,7,7,7],Wm=[2,3,4,5,6,7,6,7],Ym=[3,3,5,5,7,7,7,7],Km=[1,1,3,3,5,5,7,7],Qm=[0,1,2,3,2,3,2,3],Zm={DISPLAY:Hm[0],TEXT:Hm[2],SCRIPT:Hm[4],SCRIPTSCRIPT:Hm[6]},Xm=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];var Jm=[];function supportedCodepoint(O){for(var B=0;B<Jm.length;B+=2)if(O>=Jm[B]&&O<=Jm[B+1])return!0;return!1}Xm.forEach((O=>O.blocks.forEach((O=>Jm.push(...O)))));var eg=80,tg={doubleleftarrow:"M262 157\nl10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3\n 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28\n 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5\nc2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5\n 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87\n-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7\n-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z\nm8 0v40h399730v-40zm0 194v40h399730v-40z",doublerightarrow:"M399738 392l\n-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5\n 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88\n-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68\n-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18\n-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782\nc-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3\n-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z",leftarrow:"M400000 241H110l3-3c68.7-52.7 113.7-120\n 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8\n-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247\nc-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208\n 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3\n 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202\n l-3-3h399890zM100 241v40h399900v-40z",leftbrace:"M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z",leftbraceunder:"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z",leftgroup:"M400000 80\nH435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0\n 435 0h399565z",leftgroupunder:"M400000 262\nH435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219\n 435 219h399565z",leftharpoon:"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3\n-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5\n-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7\n-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z",leftharpoonplus:"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5\n 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3\n-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7\n-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z\nm0 0v40h400000v-40z",leftharpoondown:"M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333\n 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5\n 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667\n-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z",leftharpoondownplus:"M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12\n 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7\n-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0\nv40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z",lefthook:"M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5\n-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3\n-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21\n 71.5 23h399859zM103 281v-40h399897v40z",leftlinesegment:"M40 281 V428 H0 V94 H40 V241 H400000 v40z\nM40 281 V428 H0 V94 H40 V241 H400000 v40z",leftmapsto:"M40 281 V448H0V74H40V241H400000v40z\nM40 281 V448H0V74H40V241H400000v40z",leftToFrom:"M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23\n-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8\nc28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3\n 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z",longequal:"M0 50 h400000 v40H0z m0 194h40000v40H0z\nM0 50 h400000 v40H0z m0 194h40000v40H0z",midbrace:"M200428 334\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z",midbraceunder:"M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z",oiintSize1:"M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6\n-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z\nm368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8\n60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z",oiintSize2:"M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8\n-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z\nm502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2\nc0 110 84 276 504 276s502.4-166 502.4-276z",oiiintSize1:"M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6\n-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z\nm525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0\n85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z",oiiintSize2:"M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8\n-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z\nm770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1\nc0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z",rightarrow:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z",rightbrace:"M400000 542l\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z",rightbraceunder:"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z",rightgroup:"M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0\n 3-1 3-3v-38c-76-158-257-219-435-219H0z",rightgroupunder:"M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18\n 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z",rightharpoon:"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3\n-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2\n-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58\n 69.2 92 94.5zm0 0v40h399900v-40z",rightharpoonplus:"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11\n-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7\n 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z\nm0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z",rightharpoondown:"M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8\n 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5\n-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95\n-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z",rightharpoondownplus:"M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8\n 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3\n 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3\n-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z\nm0-194v40h400000v-40zm0 0v40h400000v-40z",righthook:"M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3\n 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0\n-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21\n 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z",rightlinesegment:"M399960 241 V94 h40 V428 h-40 V281 H0 v-40z\nM399960 241 V94 h40 V428 h-40 V281 H0 v-40z",rightToFrom:"M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23\n 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32\n-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142\n-167z M100 147v40h399900v-40zM0 341v40h399900v-40z",twoheadleftarrow:"M0 167c68 40\n 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69\n-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3\n-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19\n-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101\n 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z",twoheadrightarrow:"M400000 167\nc-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3\n 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42\n 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333\n-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70\n 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z",tilde1:"M200 55.538c-77 0-168 73.953-177 73.953-3 0-7\n-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0\n 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0\n 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128\n-68.267.847-113-73.952-191-73.952z",tilde2:"M344 55.266c-142 0-300.638 81.316-311.5 86.418\n-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9\n 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114\nc1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751\n 181.476 676 181.476c-149 0-189-126.21-332-126.21z",tilde3:"M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457\n-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0\n 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697\n 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696\n -338 0-409-156.573-744-156.573z",tilde4:"M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345\n-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409\n 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9\n 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409\n -175.236-744-175.236z",vec:"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z",widehat1:"M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z",widehat2:"M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widehat3:"M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widehat4:"M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widecheck1:"M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,\n-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z",widecheck2:"M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",widecheck3:"M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",widecheck4:"M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",baraboveleftarrow:"M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202\nc4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5\nc-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130\ns-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47\n121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6\ns2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11\nc0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z\nM100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z",rightarrowabovebar:"M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32\n-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0\n13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39\n-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5\n-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z",baraboveshortleftharpoon:"M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17\nc2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21\nc-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40\nc-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z\nM0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z",rightharpoonaboveshortbar:"M0,241 l0,40c399126,0,399993,0,399993,0\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\nM0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z",shortbaraboveleftharpoon:"M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,\n1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,\n-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z\nM93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z",shortrightharpoonabovebar:"M53,241l0,40c398570,0,399437,0,399437,0\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\nM500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z"};class DocumentFragment{constructor(O){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=O,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(O){return Vm.contains(this.classes,O)}toNode(){for(var O=document.createDocumentFragment(),B=0;B<this.children.length;B++)O.appendChild(this.children[B].toNode());return O}toMarkup(){for(var O="",B=0;B<this.children.length;B++)O+=this.children[B].toMarkup();return O}toText(){return this.children.map((O=>O.toText())).join("")}}var ig={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},rg={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},ng={:"A",:"D",:"o",:"a",:"d",:"o",:"A",:"B",:"B",:"F",:"A",:"E",:"K",:"3",:"N",:"N",:"K",:"N",:"M",:"H",:"O",:"N",:"P",:"C",:"T",:"y",:"O",:"X",:"U",:"h",:"W",:"W",:"B",:"X",:"B",:"3",:"X",:"R",:"a",:"b",:"a",:"r",:"y",:"e",:"m",:"e",:"n",:"n",:"n",:"n",:"m",:"n",:"o",:"n",:"p",:"c",:"o",:"y",:"b",:"x",:"n",:"n",:"w",:"w",:"a",:"m",:"a",:"e",:"m",:"r"};function getCharacterMetrics(O,B,U){if(!ig[B])throw new Error("Font metrics not found for font: "+B+".");var G=O.charCodeAt(0),q=ig[B][G];if(!q&&O[0]in ng&&(G=ng[O[0]].charCodeAt(0),q=ig[B][G]),q||"text"!==U||supportedCodepoint(G)&&(q=ig[B][77]),q)return{depth:q[0],height:q[1],italic:q[2],skew:q[3],width:q[4]}}var og={};var ag=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],sg=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],sizeAtStyle=function(O,B){return B.size<2?O:ag[O-1][B.size-1]};class Options{constructor(O){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=O.style,this.color=O.color,this.size=O.size||Options.BASESIZE,this.textSize=O.textSize||this.size,this.phantom=!!O.phantom,this.font=O.font||"",this.fontFamily=O.fontFamily||"",this.fontWeight=O.fontWeight||"",this.fontShape=O.fontShape||"",this.sizeMultiplier=sg[this.size-1],this.maxSize=O.maxSize,this.minRuleThickness=O.minRuleThickness,this._fontMetrics=void 0}extend(O){var B={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var U in O)O.hasOwnProperty(U)&&(B[U]=O[U]);return new Options(B)}havingStyle(O){return this.style===O?this:this.extend({style:O,size:sizeAtStyle(this.textSize,O)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(O){return this.size===O&&this.textSize===O?this:this.extend({style:this.style.text(),size:O,textSize:O,sizeMultiplier:sg[O-1]})}havingBaseStyle(O){O=O||this.style.text();var B=sizeAtStyle(Options.BASESIZE,O);return this.size===B&&this.textSize===Options.BASESIZE&&this.style===O?this:this.extend({style:O,size:B})}havingBaseSizing(){var O;switch(this.style.id){case 4:case 5:O=3;break;case 6:case 7:O=1;break;default:O=6}return this.extend({style:this.style.text(),size:O})}withColor(O){return this.extend({color:O})}withPhantom(){return this.extend({phantom:!0})}withFont(O){return this.extend({font:O})}withTextFontFamily(O){return this.extend({fontFamily:O,font:""})}withTextFontWeight(O){return this.extend({fontWeight:O,font:""})}withTextFontShape(O){return this.extend({fontShape:O,font:""})}sizingClasses(O){return O.size!==this.size?["sizing","reset-size"+O.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==Options.BASESIZE?["sizing","reset-size"+this.size,"size"+Options.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=function(O){var B;if(!og[B=O>=5?0:O>=3?1:2]){var U=og[B]={cssEmPerMu:rg.quad[B]/18};for(var G in rg)rg.hasOwnProperty(G)&&(U[G]=rg[G][B])}return og[B]}(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}Options.BASESIZE=6;var lg={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:1.00375,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:1.00375},cg={ex:!0,em:!0,mu:!0},validUnit=function(O){return"string"!=typeof O&&(O=O.unit),O in lg||O in cg||"ex"===O},calculateSize=function(O,B){var U;if(O.unit in lg)U=lg[O.unit]/B.fontMetrics().ptPerEm/B.sizeMultiplier;else if("mu"===O.unit)U=B.fontMetrics().cssEmPerMu;else{var G;if(G=B.style.isTight()?B.havingStyle(B.style.text()):B,"ex"===O.unit)U=G.fontMetrics().xHeight;else{if("em"!==O.unit)throw new ParseError("Invalid unit: '"+O.unit+"'");U=G.fontMetrics().quad}G!==B&&(U*=G.sizeMultiplier/B.sizeMultiplier)}return Math.min(O.number*U,B.maxSize)},makeEm=function(O){return+O.toFixed(4)+"em"},createClass=function(O){return O.filter((O=>O)).join(" ")},initNode=function(O,B,U){if(this.classes=O||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=U||{},B){B.style.isTight()&&this.classes.push("mtight");var G=B.getColor();G&&(this.style.color=G)}},toNode=function(O){var B=document.createElement(O);for(var U in B.className=createClass(this.classes),this.style)this.style.hasOwnProperty(U)&&(B.style[U]=this.style[U]);for(var G in this.attributes)this.attributes.hasOwnProperty(G)&&B.setAttribute(G,this.attributes[G]);for(var q=0;q<this.children.length;q++)B.appendChild(this.children[q].toNode());return B},toMarkup=function(O){var B="<"+O;this.classes.length&&(B+=' class="'+Vm.escape(createClass(this.classes))+'"');var U="";for(var G in this.style)this.style.hasOwnProperty(G)&&(U+=Vm.hyphenate(G)+":"+this.style[G]+";");for(var q in U&&(B+=' style="'+Vm.escape(U)+'"'),this.attributes)this.attributes.hasOwnProperty(q)&&(B+=" "+q+'="'+Vm.escape(this.attributes[q])+'"');B+=">";for(var j=0;j<this.children.length;j++)B+=this.children[j].toMarkup();return B+="</"+O+">"};class Span{constructor(O,B,U,G){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,initNode.call(this,O,U,G),this.children=B||[]}setAttribute(O,B){this.attributes[O]=B}hasClass(O){return Vm.contains(this.classes,O)}toNode(){return toNode.call(this,"span")}toMarkup(){return toMarkup.call(this,"span")}}class Anchor{constructor(O,B,U,G){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,initNode.call(this,B,G),this.children=U||[],this.setAttribute("href",O)}setAttribute(O,B){this.attributes[O]=B}hasClass(O){return Vm.contains(this.classes,O)}toNode(){return toNode.call(this,"a")}toMarkup(){return toMarkup.call(this,"a")}}class Img{constructor(O,B,U){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=B,this.src=O,this.classes=["mord"],this.style=U}hasClass(O){return Vm.contains(this.classes,O)}toNode(){var O=document.createElement("img");for(var B in O.src=this.src,O.alt=this.alt,O.className="mord",this.style)this.style.hasOwnProperty(B)&&(O.style[B]=this.style[B]);return O}toMarkup(){var O="<img  src='"+this.src+" 'alt='"+this.alt+"' ",B="";for(var U in this.style)this.style.hasOwnProperty(U)&&(B+=Vm.hyphenate(U)+":"+this.style[U]+";");return B&&(O+=' style="'+Vm.escape(B)+'"'),O+="'/>"}}var dg={:"",:"",:"",:""};class SymbolNode{constructor(O,B,U,G,q,j,W,Y){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=O,this.height=B||0,this.depth=U||0,this.italic=G||0,this.skew=q||0,this.width=j||0,this.classes=W||[],this.style=Y||{},this.maxFontSize=0;var K=function(O){for(var B=0;B<Xm.length;B++)for(var U=Xm[B],G=0;G<U.blocks.length;G++){var q=U.blocks[G];if(O>=q[0]&&O<=q[1])return U.name}return null}(this.text.charCodeAt(0));K&&this.classes.push(K+"_fallback"),/[]/.test(this.text)&&(this.text=dg[this.text])}hasClass(O){return Vm.contains(this.classes,O)}toNode(){var O=document.createTextNode(this.text),B=null;for(var U in this.italic>0&&((B=document.createElement("span")).style.marginRight=makeEm(this.italic)),this.classes.length>0&&((B=B||document.createElement("span")).className=createClass(this.classes)),this.style)this.style.hasOwnProperty(U)&&((B=B||document.createElement("span")).style[U]=this.style[U]);return B?(B.appendChild(O),B):O}toMarkup(){var O=!1,B="<span";this.classes.length&&(O=!0,B+=' class="',B+=Vm.escape(createClass(this.classes)),B+='"');var U="";for(var G in this.italic>0&&(U+="margin-right:"+this.italic+"em;"),this.style)this.style.hasOwnProperty(G)&&(U+=Vm.hyphenate(G)+":"+this.style[G]+";");U&&(O=!0,B+=' style="'+Vm.escape(U)+'"');var q=Vm.escape(this.text);return O?(B+=">",B+=q,B+="</span>"):q}}class SvgNode{constructor(O,B){this.children=void 0,this.attributes=void 0,this.children=O||[],this.attributes=B||{}}toNode(){var O=document.createElementNS("http://www.w3.org/2000/svg","svg");for(var B in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,B)&&O.setAttribute(B,this.attributes[B]);for(var U=0;U<this.children.length;U++)O.appendChild(this.children[U].toNode());return O}toMarkup(){var O='<svg xmlns="http://www.w3.org/2000/svg"';for(var B in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,B)&&(O+=" "+B+"='"+this.attributes[B]+"'");O+=">";for(var U=0;U<this.children.length;U++)O+=this.children[U].toMarkup();return O+="</svg>"}}class PathNode{constructor(O,B){this.pathName=void 0,this.alternate=void 0,this.pathName=O,this.alternate=B}toNode(){var O=document.createElementNS("http://www.w3.org/2000/svg","path");return this.alternate?O.setAttribute("d",this.alternate):O.setAttribute("d",tg[this.pathName]),O}toMarkup(){return this.alternate?"<path d='"+this.alternate+"'/>":"<path d='"+tg[this.pathName]+"'/>"}}class LineNode{constructor(O){this.attributes=void 0,this.attributes=O||{}}toNode(){var O=document.createElementNS("http://www.w3.org/2000/svg","line");for(var B in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,B)&&O.setAttribute(B,this.attributes[B]);return O}toMarkup(){var O="<line";for(var B in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,B)&&(O+=" "+B+"='"+this.attributes[B]+"'");return O+="/>"}}function assertSymbolDomNode(O){if(O instanceof SymbolNode)return O;throw new Error("Expected symbolNode but got "+String(O)+".")}var pg={bin:1,close:1,inner:1,open:1,punct:1,rel:1},ug={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},hg={math:{},text:{}};function defineSymbol(O,B,U,G,q,j){hg[O][q]={font:B,group:U,replace:G},j&&G&&(hg[O][G]=hg[O][q])}var mg="math",gg="text",fg="main",yg="ams",_g="accent-token",vg="bin",bg="close",Sg="inner",Cg="mathord",Eg="op-token",xg="open",Tg="punct",wg="rel",kg="spacing",Ag="textord";defineSymbol(mg,fg,wg,"","\\equiv",!0),defineSymbol(mg,fg,wg,"","\\prec",!0),defineSymbol(mg,fg,wg,"","\\succ",!0),defineSymbol(mg,fg,wg,"","\\sim",!0),defineSymbol(mg,fg,wg,"","\\perp"),defineSymbol(mg,fg,wg,"","\\preceq",!0),defineSymbol(mg,fg,wg,"","\\succeq",!0),defineSymbol(mg,fg,wg,"","\\simeq",!0),defineSymbol(mg,fg,wg,"","\\mid",!0),defineSymbol(mg,fg,wg,"","\\ll",!0),defineSymbol(mg,fg,wg,"","\\gg",!0),defineSymbol(mg,fg,wg,"","\\asymp",!0),defineSymbol(mg,fg,wg,"","\\parallel"),defineSymbol(mg,fg,wg,"","\\bowtie",!0),defineSymbol(mg,fg,wg,"","\\smile",!0),defineSymbol(mg,fg,wg,"","\\sqsubseteq",!0),defineSymbol(mg,fg,wg,"","\\sqsupseteq",!0),defineSymbol(mg,fg,wg,"","\\doteq",!0),defineSymbol(mg,fg,wg,"","\\frown",!0),defineSymbol(mg,fg,wg,"","\\ni",!0),defineSymbol(mg,fg,wg,"","\\propto",!0),defineSymbol(mg,fg,wg,"","\\vdash",!0),defineSymbol(mg,fg,wg,"","\\dashv",!0),defineSymbol(mg,fg,wg,"","\\owns"),defineSymbol(mg,fg,Tg,".","\\ldotp"),defineSymbol(mg,fg,Tg,"","\\cdotp"),defineSymbol(mg,fg,Ag,"#","\\#"),defineSymbol(gg,fg,Ag,"#","\\#"),defineSymbol(mg,fg,Ag,"&","\\&"),defineSymbol(gg,fg,Ag,"&","\\&"),defineSymbol(mg,fg,Ag,"","\\aleph",!0),defineSymbol(mg,fg,Ag,"","\\forall",!0),defineSymbol(mg,fg,Ag,"","\\hbar",!0),defineSymbol(mg,fg,Ag,"","\\exists",!0),defineSymbol(mg,fg,Ag,"","\\nabla",!0),defineSymbol(mg,fg,Ag,"","\\flat",!0),defineSymbol(mg,fg,Ag,"","\\ell",!0),defineSymbol(mg,fg,Ag,"","\\natural",!0),defineSymbol(mg,fg,Ag,"","\\clubsuit",!0),defineSymbol(mg,fg,Ag,"","\\wp",!0),defineSymbol(mg,fg,Ag,"","\\sharp",!0),defineSymbol(mg,fg,Ag,"","\\diamondsuit",!0),defineSymbol(mg,fg,Ag,"","\\Re",!0),defineSymbol(mg,fg,Ag,"","\\heartsuit",!0),defineSymbol(mg,fg,Ag,"","\\Im",!0),defineSymbol(mg,fg,Ag,"","\\spadesuit",!0),defineSymbol(mg,fg,Ag,"","\\S",!0),defineSymbol(gg,fg,Ag,"","\\S"),defineSymbol(mg,fg,Ag,"","\\P",!0),defineSymbol(gg,fg,Ag,"","\\P"),defineSymbol(mg,fg,Ag,"","\\dag"),defineSymbol(gg,fg,Ag,"","\\dag"),defineSymbol(gg,fg,Ag,"","\\textdagger"),defineSymbol(mg,fg,Ag,"","\\ddag"),defineSymbol(gg,fg,Ag,"","\\ddag"),defineSymbol(gg,fg,Ag,"","\\textdaggerdbl"),defineSymbol(mg,fg,bg,"","\\rmoustache",!0),defineSymbol(mg,fg,xg,"","\\lmoustache",!0),defineSymbol(mg,fg,bg,"","\\rgroup",!0),defineSymbol(mg,fg,xg,"","\\lgroup",!0),defineSymbol(mg,fg,vg,"","\\mp",!0),defineSymbol(mg,fg,vg,"","\\ominus",!0),defineSymbol(mg,fg,vg,"","\\uplus",!0),defineSymbol(mg,fg,vg,"","\\sqcap",!0),defineSymbol(mg,fg,vg,"","\\ast"),defineSymbol(mg,fg,vg,"","\\sqcup",!0),defineSymbol(mg,fg,vg,"","\\bigcirc",!0),defineSymbol(mg,fg,vg,"","\\bullet",!0),defineSymbol(mg,fg,vg,"","\\ddagger"),defineSymbol(mg,fg,vg,"","\\wr",!0),defineSymbol(mg,fg,vg,"","\\amalg"),defineSymbol(mg,fg,vg,"&","\\And"),defineSymbol(mg,fg,wg,"","\\longleftarrow",!0),defineSymbol(mg,fg,wg,"","\\Leftarrow",!0),defineSymbol(mg,fg,wg,"","\\Longleftarrow",!0),defineSymbol(mg,fg,wg,"","\\longrightarrow",!0),defineSymbol(mg,fg,wg,"","\\Rightarrow",!0),defineSymbol(mg,fg,wg,"","\\Longrightarrow",!0),defineSymbol(mg,fg,wg,"","\\leftrightarrow",!0),defineSymbol(mg,fg,wg,"","\\longleftrightarrow",!0),defineSymbol(mg,fg,wg,"","\\Leftrightarrow",!0),defineSymbol(mg,fg,wg,"","\\Longleftrightarrow",!0),defineSymbol(mg,fg,wg,"","\\mapsto",!0),defineSymbol(mg,fg,wg,"","\\longmapsto",!0),defineSymbol(mg,fg,wg,"","\\nearrow",!0),defineSymbol(mg,fg,wg,"","\\hookleftarrow",!0),defineSymbol(mg,fg,wg,"","\\hookrightarrow",!0),defineSymbol(mg,fg,wg,"","\\searrow",!0),defineSymbol(mg,fg,wg,"","\\leftharpoonup",!0),defineSymbol(mg,fg,wg,"","\\rightharpoonup",!0),defineSymbol(mg,fg,wg,"","\\swarrow",!0),defineSymbol(mg,fg,wg,"","\\leftharpoondown",!0),defineSymbol(mg,fg,wg,"","\\rightharpoondown",!0),defineSymbol(mg,fg,wg,"","\\nwarrow",!0),defineSymbol(mg,fg,wg,"","\\rightleftharpoons",!0),defineSymbol(mg,yg,wg,"","\\nless",!0),defineSymbol(mg,yg,wg,"","\\@nleqslant"),defineSymbol(mg,yg,wg,"","\\@nleqq"),defineSymbol(mg,yg,wg,"","\\lneq",!0),defineSymbol(mg,yg,wg,"","\\lneqq",!0),defineSymbol(mg,yg,wg,"","\\@lvertneqq"),defineSymbol(mg,yg,wg,"","\\lnsim",!0),defineSymbol(mg,yg,wg,"","\\lnapprox",!0),defineSymbol(mg,yg,wg,"","\\nprec",!0),defineSymbol(mg,yg,wg,"","\\npreceq",!0),defineSymbol(mg,yg,wg,"","\\precnsim",!0),defineSymbol(mg,yg,wg,"","\\precnapprox",!0),defineSymbol(mg,yg,wg,"","\\nsim",!0),defineSymbol(mg,yg,wg,"","\\@nshortmid"),defineSymbol(mg,yg,wg,"","\\nmid",!0),defineSymbol(mg,yg,wg,"","\\nvdash",!0),defineSymbol(mg,yg,wg,"","\\nvDash",!0),defineSymbol(mg,yg,wg,"","\\ntriangleleft"),defineSymbol(mg,yg,wg,"","\\ntrianglelefteq",!0),defineSymbol(mg,yg,wg,"","\\subsetneq",!0),defineSymbol(mg,yg,wg,"","\\@varsubsetneq"),defineSymbol(mg,yg,wg,"","\\subsetneqq",!0),defineSymbol(mg,yg,wg,"","\\@varsubsetneqq"),defineSymbol(mg,yg,wg,"","\\ngtr",!0),defineSymbol(mg,yg,wg,"","\\@ngeqslant"),defineSymbol(mg,yg,wg,"","\\@ngeqq"),defineSymbol(mg,yg,wg,"","\\gneq",!0),defineSymbol(mg,yg,wg,"","\\gneqq",!0),defineSymbol(mg,yg,wg,"","\\@gvertneqq"),defineSymbol(mg,yg,wg,"","\\gnsim",!0),defineSymbol(mg,yg,wg,"","\\gnapprox",!0),defineSymbol(mg,yg,wg,"","\\nsucc",!0),defineSymbol(mg,yg,wg,"","\\nsucceq",!0),defineSymbol(mg,yg,wg,"","\\succnsim",!0),defineSymbol(mg,yg,wg,"","\\succnapprox",!0),defineSymbol(mg,yg,wg,"","\\ncong",!0),defineSymbol(mg,yg,wg,"","\\@nshortparallel"),defineSymbol(mg,yg,wg,"","\\nparallel",!0),defineSymbol(mg,yg,wg,"","\\nVDash",!0),defineSymbol(mg,yg,wg,"","\\ntriangleright"),defineSymbol(mg,yg,wg,"","\\ntrianglerighteq",!0),defineSymbol(mg,yg,wg,"","\\@nsupseteqq"),defineSymbol(mg,yg,wg,"","\\supsetneq",!0),defineSymbol(mg,yg,wg,"","\\@varsupsetneq"),defineSymbol(mg,yg,wg,"","\\supsetneqq",!0),defineSymbol(mg,yg,wg,"","\\@varsupsetneqq"),defineSymbol(mg,yg,wg,"","\\nVdash",!0),defineSymbol(mg,yg,wg,"","\\precneqq",!0),defineSymbol(mg,yg,wg,"","\\succneqq",!0),defineSymbol(mg,yg,wg,"","\\@nsubseteqq"),defineSymbol(mg,yg,vg,"","\\unlhd"),defineSymbol(mg,yg,vg,"","\\unrhd"),defineSymbol(mg,yg,wg,"","\\nleftarrow",!0),defineSymbol(mg,yg,wg,"","\\nrightarrow",!0),defineSymbol(mg,yg,wg,"","\\nLeftarrow",!0),defineSymbol(mg,yg,wg,"","\\nRightarrow",!0),defineSymbol(mg,yg,wg,"","\\nleftrightarrow",!0),defineSymbol(mg,yg,wg,"","\\nLeftrightarrow",!0),defineSymbol(mg,yg,wg,"","\\vartriangle"),defineSymbol(mg,yg,Ag,"","\\hslash"),defineSymbol(mg,yg,Ag,"","\\triangledown"),defineSymbol(mg,yg,Ag,"","\\lozenge"),defineSymbol(mg,yg,Ag,"","\\circledS"),defineSymbol(mg,yg,Ag,"","\\circledR"),defineSymbol(gg,yg,Ag,"","\\circledR"),defineSymbol(mg,yg,Ag,"","\\measuredangle",!0),defineSymbol(mg,yg,Ag,"","\\nexists"),defineSymbol(mg,yg,Ag,"","\\mho"),defineSymbol(mg,yg,Ag,"","\\Finv",!0),defineSymbol(mg,yg,Ag,"","\\Game",!0),defineSymbol(mg,yg,Ag,"","\\backprime"),defineSymbol(mg,yg,Ag,"","\\blacktriangle"),defineSymbol(mg,yg,Ag,"","\\blacktriangledown"),defineSymbol(mg,yg,Ag,"","\\blacksquare"),defineSymbol(mg,yg,Ag,"","\\blacklozenge"),defineSymbol(mg,yg,Ag,"","\\bigstar"),defineSymbol(mg,yg,Ag,"","\\sphericalangle",!0),defineSymbol(mg,yg,Ag,"","\\complement",!0),defineSymbol(mg,yg,Ag,"","\\eth",!0),defineSymbol(gg,fg,Ag,"",""),defineSymbol(mg,yg,Ag,"","\\diagup"),defineSymbol(mg,yg,Ag,"","\\diagdown"),defineSymbol(mg,yg,Ag,"","\\square"),defineSymbol(mg,yg,Ag,"","\\Box"),defineSymbol(mg,yg,Ag,"","\\Diamond"),defineSymbol(mg,yg,Ag,"","\\yen",!0),defineSymbol(gg,yg,Ag,"","\\yen",!0),defineSymbol(mg,yg,Ag,"","\\checkmark",!0),defineSymbol(gg,yg,Ag,"","\\checkmark"),defineSymbol(mg,yg,Ag,"","\\beth",!0),defineSymbol(mg,yg,Ag,"","\\daleth",!0),defineSymbol(mg,yg,Ag,"","\\gimel",!0),defineSymbol(mg,yg,Ag,"","\\digamma",!0),defineSymbol(mg,yg,Ag,"","\\varkappa"),defineSymbol(mg,yg,xg,"","\\@ulcorner",!0),defineSymbol(mg,yg,bg,"","\\@urcorner",!0),defineSymbol(mg,yg,xg,"","\\@llcorner",!0),defineSymbol(mg,yg,bg,"","\\@lrcorner",!0),defineSymbol(mg,yg,wg,"","\\leqq",!0),defineSymbol(mg,yg,wg,"","\\leqslant",!0),defineSymbol(mg,yg,wg,"","\\eqslantless",!0),defineSymbol(mg,yg,wg,"","\\lesssim",!0),defineSymbol(mg,yg,wg,"","\\lessapprox",!0),defineSymbol(mg,yg,wg,"","\\approxeq",!0),defineSymbol(mg,yg,vg,"","\\lessdot"),defineSymbol(mg,yg,wg,"","\\lll",!0),defineSymbol(mg,yg,wg,"","\\lessgtr",!0),defineSymbol(mg,yg,wg,"","\\lesseqgtr",!0),defineSymbol(mg,yg,wg,"","\\lesseqqgtr",!0),defineSymbol(mg,yg,wg,"","\\doteqdot"),defineSymbol(mg,yg,wg,"","\\risingdotseq",!0),defineSymbol(mg,yg,wg,"","\\fallingdotseq",!0),defineSymbol(mg,yg,wg,"","\\backsim",!0),defineSymbol(mg,yg,wg,"","\\backsimeq",!0),defineSymbol(mg,yg,wg,"","\\subseteqq",!0),defineSymbol(mg,yg,wg,"","\\Subset",!0),defineSymbol(mg,yg,wg,"","\\sqsubset",!0),defineSymbol(mg,yg,wg,"","\\preccurlyeq",!0),defineSymbol(mg,yg,wg,"","\\curlyeqprec",!0),defineSymbol(mg,yg,wg,"","\\precsim",!0),defineSymbol(mg,yg,wg,"","\\precapprox",!0),defineSymbol(mg,yg,wg,"","\\vartriangleleft"),defineSymbol(mg,yg,wg,"","\\trianglelefteq"),defineSymbol(mg,yg,wg,"","\\vDash",!0),defineSymbol(mg,yg,wg,"","\\Vvdash",!0),defineSymbol(mg,yg,wg,"","\\smallsmile"),defineSymbol(mg,yg,wg,"","\\smallfrown"),defineSymbol(mg,yg,wg,"","\\bumpeq",!0),defineSymbol(mg,yg,wg,"","\\Bumpeq",!0),defineSymbol(mg,yg,wg,"","\\geqq",!0),defineSymbol(mg,yg,wg,"","\\geqslant",!0),defineSymbol(mg,yg,wg,"","\\eqslantgtr",!0),defineSymbol(mg,yg,wg,"","\\gtrsim",!0),defineSymbol(mg,yg,wg,"","\\gtrapprox",!0),defineSymbol(mg,yg,vg,"","\\gtrdot"),defineSymbol(mg,yg,wg,"","\\ggg",!0),defineSymbol(mg,yg,wg,"","\\gtrless",!0),defineSymbol(mg,yg,wg,"","\\gtreqless",!0),defineSymbol(mg,yg,wg,"","\\gtreqqless",!0),defineSymbol(mg,yg,wg,"","\\eqcirc",!0),defineSymbol(mg,yg,wg,"","\\circeq",!0),defineSymbol(mg,yg,wg,"","\\triangleq",!0),defineSymbol(mg,yg,wg,"","\\thicksim"),defineSymbol(mg,yg,wg,"","\\thickapprox"),defineSymbol(mg,yg,wg,"","\\supseteqq",!0),defineSymbol(mg,yg,wg,"","\\Supset",!0),defineSymbol(mg,yg,wg,"","\\sqsupset",!0),defineSymbol(mg,yg,wg,"","\\succcurlyeq",!0),defineSymbol(mg,yg,wg,"","\\curlyeqsucc",!0),defineSymbol(mg,yg,wg,"","\\succsim",!0),defineSymbol(mg,yg,wg,"","\\succapprox",!0),defineSymbol(mg,yg,wg,"","\\vartriangleright"),defineSymbol(mg,yg,wg,"","\\trianglerighteq"),defineSymbol(mg,yg,wg,"","\\Vdash",!0),defineSymbol(mg,yg,wg,"","\\shortmid"),defineSymbol(mg,yg,wg,"","\\shortparallel"),defineSymbol(mg,yg,wg,"","\\between",!0),defineSymbol(mg,yg,wg,"","\\pitchfork",!0),defineSymbol(mg,yg,wg,"","\\varpropto"),defineSymbol(mg,yg,wg,"","\\blacktriangleleft"),defineSymbol(mg,yg,wg,"","\\therefore",!0),defineSymbol(mg,yg,wg,"","\\backepsilon"),defineSymbol(mg,yg,wg,"","\\blacktriangleright"),defineSymbol(mg,yg,wg,"","\\because",!0),defineSymbol(mg,yg,wg,"","\\llless"),defineSymbol(mg,yg,wg,"","\\gggtr"),defineSymbol(mg,yg,vg,"","\\lhd"),defineSymbol(mg,yg,vg,"","\\rhd"),defineSymbol(mg,yg,wg,"","\\eqsim",!0),defineSymbol(mg,fg,wg,"","\\Join"),defineSymbol(mg,yg,wg,"","\\Doteq",!0),defineSymbol(mg,yg,vg,"","\\dotplus",!0),defineSymbol(mg,yg,vg,"","\\smallsetminus"),defineSymbol(mg,yg,vg,"","\\Cap",!0),defineSymbol(mg,yg,vg,"","\\Cup",!0),defineSymbol(mg,yg,vg,"","\\doublebarwedge",!0),defineSymbol(mg,yg,vg,"","\\boxminus",!0),defineSymbol(mg,yg,vg,"","\\boxplus",!0),defineSymbol(mg,yg,vg,"","\\divideontimes",!0),defineSymbol(mg,yg,vg,"","\\ltimes",!0),defineSymbol(mg,yg,vg,"","\\rtimes",!0),defineSymbol(mg,yg,vg,"","\\leftthreetimes",!0),defineSymbol(mg,yg,vg,"","\\rightthreetimes",!0),defineSymbol(mg,yg,vg,"","\\curlywedge",!0),defineSymbol(mg,yg,vg,"","\\curlyvee",!0),defineSymbol(mg,yg,vg,"","\\circleddash",!0),defineSymbol(mg,yg,vg,"","\\circledast",!0),defineSymbol(mg,yg,vg,"","\\centerdot"),defineSymbol(mg,yg,vg,"","\\intercal",!0),defineSymbol(mg,yg,vg,"","\\doublecap"),defineSymbol(mg,yg,vg,"","\\doublecup"),defineSymbol(mg,yg,vg,"","\\boxtimes",!0),defineSymbol(mg,yg,wg,"","\\dashrightarrow",!0),defineSymbol(mg,yg,wg,"","\\dashleftarrow",!0),defineSymbol(mg,yg,wg,"","\\leftleftarrows",!0),defineSymbol(mg,yg,wg,"","\\leftrightarrows",!0),defineSymbol(mg,yg,wg,"","\\Lleftarrow",!0),defineSymbol(mg,yg,wg,"","\\twoheadleftarrow",!0),defineSymbol(mg,yg,wg,"","\\leftarrowtail",!0),defineSymbol(mg,yg,wg,"","\\looparrowleft",!0),defineSymbol(mg,yg,wg,"","\\leftrightharpoons",!0),defineSymbol(mg,yg,wg,"","\\curvearrowleft",!0),defineSymbol(mg,yg,wg,"","\\circlearrowleft",!0),defineSymbol(mg,yg,wg,"","\\Lsh",!0),defineSymbol(mg,yg,wg,"","\\upuparrows",!0),defineSymbol(mg,yg,wg,"","\\upharpoonleft",!0),defineSymbol(mg,yg,wg,"","\\downharpoonleft",!0),defineSymbol(mg,fg,wg,"","\\origof",!0),defineSymbol(mg,fg,wg,"","\\imageof",!0),defineSymbol(mg,yg,wg,"","\\multimap",!0),defineSymbol(mg,yg,wg,"","\\leftrightsquigarrow",!0),defineSymbol(mg,yg,wg,"","\\rightrightarrows",!0),defineSymbol(mg,yg,wg,"","\\rightleftarrows",!0),defineSymbol(mg,yg,wg,"","\\twoheadrightarrow",!0),defineSymbol(mg,yg,wg,"","\\rightarrowtail",!0),defineSymbol(mg,yg,wg,"","\\looparrowright",!0),defineSymbol(mg,yg,wg,"","\\curvearrowright",!0),defineSymbol(mg,yg,wg,"","\\circlearrowright",!0),defineSymbol(mg,yg,wg,"","\\Rsh",!0),defineSymbol(mg,yg,wg,"","\\downdownarrows",!0),defineSymbol(mg,yg,wg,"","\\upharpoonright",!0),defineSymbol(mg,yg,wg,"","\\downharpoonright",!0),defineSymbol(mg,yg,wg,"","\\rightsquigarrow",!0),defineSymbol(mg,yg,wg,"","\\leadsto"),defineSymbol(mg,yg,wg,"","\\Rrightarrow",!0),defineSymbol(mg,yg,wg,"","\\restriction"),defineSymbol(mg,fg,Ag,"","`"),defineSymbol(mg,fg,Ag,"$","\\$"),defineSymbol(gg,fg,Ag,"$","\\$"),defineSymbol(gg,fg,Ag,"$","\\textdollar"),defineSymbol(mg,fg,Ag,"%","\\%"),defineSymbol(gg,fg,Ag,"%","\\%"),defineSymbol(mg,fg,Ag,"_","\\_"),defineSymbol(gg,fg,Ag,"_","\\_"),defineSymbol(gg,fg,Ag,"_","\\textunderscore"),defineSymbol(mg,fg,Ag,"","\\angle",!0),defineSymbol(mg,fg,Ag,"","\\infty",!0),defineSymbol(mg,fg,Ag,"","\\prime"),defineSymbol(mg,fg,Ag,"","\\triangle"),defineSymbol(mg,fg,Ag,"","\\Gamma",!0),defineSymbol(mg,fg,Ag,"","\\Delta",!0),defineSymbol(mg,fg,Ag,"","\\Theta",!0),defineSymbol(mg,fg,Ag,"","\\Lambda",!0),defineSymbol(mg,fg,Ag,"","\\Xi",!0),defineSymbol(mg,fg,Ag,"","\\Pi",!0),defineSymbol(mg,fg,Ag,"","\\Sigma",!0),defineSymbol(mg,fg,Ag,"","\\Upsilon",!0),defineSymbol(mg,fg,Ag,"","\\Phi",!0),defineSymbol(mg,fg,Ag,"","\\Psi",!0),defineSymbol(mg,fg,Ag,"","\\Omega",!0),defineSymbol(mg,fg,Ag,"A",""),defineSymbol(mg,fg,Ag,"B",""),defineSymbol(mg,fg,Ag,"E",""),defineSymbol(mg,fg,Ag,"Z",""),defineSymbol(mg,fg,Ag,"H",""),defineSymbol(mg,fg,Ag,"I",""),defineSymbol(mg,fg,Ag,"K",""),defineSymbol(mg,fg,Ag,"M",""),defineSymbol(mg,fg,Ag,"N",""),defineSymbol(mg,fg,Ag,"O",""),defineSymbol(mg,fg,Ag,"P",""),defineSymbol(mg,fg,Ag,"T",""),defineSymbol(mg,fg,Ag,"X",""),defineSymbol(mg,fg,Ag,"","\\neg",!0),defineSymbol(mg,fg,Ag,"","\\lnot"),defineSymbol(mg,fg,Ag,"","\\top"),defineSymbol(mg,fg,Ag,"","\\bot"),defineSymbol(mg,fg,Ag,"","\\emptyset"),defineSymbol(mg,yg,Ag,"","\\varnothing"),defineSymbol(mg,fg,Cg,"","\\alpha",!0),defineSymbol(mg,fg,Cg,"","\\beta",!0),defineSymbol(mg,fg,Cg,"","\\gamma",!0),defineSymbol(mg,fg,Cg,"","\\delta",!0),defineSymbol(mg,fg,Cg,"","\\epsilon",!0),defineSymbol(mg,fg,Cg,"","\\zeta",!0),defineSymbol(mg,fg,Cg,"","\\eta",!0),defineSymbol(mg,fg,Cg,"","\\theta",!0),defineSymbol(mg,fg,Cg,"","\\iota",!0),defineSymbol(mg,fg,Cg,"","\\kappa",!0),defineSymbol(mg,fg,Cg,"","\\lambda",!0),defineSymbol(mg,fg,Cg,"","\\mu",!0),defineSymbol(mg,fg,Cg,"","\\nu",!0),defineSymbol(mg,fg,Cg,"","\\xi",!0),defineSymbol(mg,fg,Cg,"","\\omicron",!0),defineSymbol(mg,fg,Cg,"","\\pi",!0),defineSymbol(mg,fg,Cg,"","\\rho",!0),defineSymbol(mg,fg,Cg,"","\\sigma",!0),defineSymbol(mg,fg,Cg,"","\\tau",!0),defineSymbol(mg,fg,Cg,"","\\upsilon",!0),defineSymbol(mg,fg,Cg,"","\\phi",!0),defineSymbol(mg,fg,Cg,"","\\chi",!0),defineSymbol(mg,fg,Cg,"","\\psi",!0),defineSymbol(mg,fg,Cg,"","\\omega",!0),defineSymbol(mg,fg,Cg,"","\\varepsilon",!0),defineSymbol(mg,fg,Cg,"","\\vartheta",!0),defineSymbol(mg,fg,Cg,"","\\varpi",!0),defineSymbol(mg,fg,Cg,"","\\varrho",!0),defineSymbol(mg,fg,Cg,"","\\varsigma",!0),defineSymbol(mg,fg,Cg,"","\\varphi",!0),defineSymbol(mg,fg,vg,"","*",!0),defineSymbol(mg,fg,vg,"+","+"),defineSymbol(mg,fg,vg,"","-",!0),defineSymbol(mg,fg,vg,"","\\cdot",!0),defineSymbol(mg,fg,vg,"","\\circ",!0),defineSymbol(mg,fg,vg,"","\\div",!0),defineSymbol(mg,fg,vg,"","\\pm",!0),defineSymbol(mg,fg,vg,"","\\times",!0),defineSymbol(mg,fg,vg,"","\\cap",!0),defineSymbol(mg,fg,vg,"","\\cup",!0),defineSymbol(mg,fg,vg,"","\\setminus",!0),defineSymbol(mg,fg,vg,"","\\land"),defineSymbol(mg,fg,vg,"","\\lor"),defineSymbol(mg,fg,vg,"","\\wedge",!0),defineSymbol(mg,fg,vg,"","\\vee",!0),defineSymbol(mg,fg,Ag,"","\\surd"),defineSymbol(mg,fg,xg,"","\\langle",!0),defineSymbol(mg,fg,xg,"","\\lvert"),defineSymbol(mg,fg,xg,"","\\lVert"),defineSymbol(mg,fg,bg,"?","?"),defineSymbol(mg,fg,bg,"!","!"),defineSymbol(mg,fg,bg,"","\\rangle",!0),defineSymbol(mg,fg,bg,"","\\rvert"),defineSymbol(mg,fg,bg,"","\\rVert"),defineSymbol(mg,fg,wg,"=","="),defineSymbol(mg,fg,wg,":",":"),defineSymbol(mg,fg,wg,"","\\approx",!0),defineSymbol(mg,fg,wg,"","\\cong",!0),defineSymbol(mg,fg,wg,"","\\ge"),defineSymbol(mg,fg,wg,"","\\geq",!0),defineSymbol(mg,fg,wg,"","\\gets"),defineSymbol(mg,fg,wg,">","\\gt",!0),defineSymbol(mg,fg,wg,"","\\in",!0),defineSymbol(mg,fg,wg,"","\\@not"),defineSymbol(mg,fg,wg,"","\\subset",!0),defineSymbol(mg,fg,wg,"","\\supset",!0),defineSymbol(mg,fg,wg,"","\\subseteq",!0),defineSymbol(mg,fg,wg,"","\\supseteq",!0),defineSymbol(mg,yg,wg,"","\\nsubseteq",!0),defineSymbol(mg,yg,wg,"","\\nsupseteq",!0),defineSymbol(mg,fg,wg,"","\\models"),defineSymbol(mg,fg,wg,"","\\leftarrow",!0),defineSymbol(mg,fg,wg,"","\\le"),defineSymbol(mg,fg,wg,"","\\leq",!0),defineSymbol(mg,fg,wg,"<","\\lt",!0),defineSymbol(mg,fg,wg,"","\\rightarrow",!0),defineSymbol(mg,fg,wg,"","\\to"),defineSymbol(mg,yg,wg,"","\\ngeq",!0),defineSymbol(mg,yg,wg,"","\\nleq",!0),defineSymbol(mg,fg,kg," ","\\ "),defineSymbol(mg,fg,kg," ","\\space"),defineSymbol(mg,fg,kg," ","\\nobreakspace"),defineSymbol(gg,fg,kg," ","\\ "),defineSymbol(gg,fg,kg," "," "),defineSymbol(gg,fg,kg," ","\\space"),defineSymbol(gg,fg,kg," ","\\nobreakspace"),defineSymbol(mg,fg,kg,null,"\\nobreak"),defineSymbol(mg,fg,kg,null,"\\allowbreak"),defineSymbol(mg,fg,Tg,",",","),defineSymbol(mg,fg,Tg,";",";"),defineSymbol(mg,yg,vg,"","\\barwedge",!0),defineSymbol(mg,yg,vg,"","\\veebar",!0),defineSymbol(mg,fg,vg,"","\\odot",!0),defineSymbol(mg,fg,vg,"","\\oplus",!0),defineSymbol(mg,fg,vg,"","\\otimes",!0),defineSymbol(mg,fg,Ag,"","\\partial",!0),defineSymbol(mg,fg,vg,"","\\oslash",!0),defineSymbol(mg,yg,vg,"","\\circledcirc",!0),defineSymbol(mg,yg,vg,"","\\boxdot",!0),defineSymbol(mg,fg,vg,"","\\bigtriangleup"),defineSymbol(mg,fg,vg,"","\\bigtriangledown"),defineSymbol(mg,fg,vg,"","\\dagger"),defineSymbol(mg,fg,vg,"","\\diamond"),defineSymbol(mg,fg,vg,"","\\star"),defineSymbol(mg,fg,vg,"","\\triangleleft"),defineSymbol(mg,fg,vg,"","\\triangleright"),defineSymbol(mg,fg,xg,"{","\\{"),defineSymbol(gg,fg,Ag,"{","\\{"),defineSymbol(gg,fg,Ag,"{","\\textbraceleft"),defineSymbol(mg,fg,bg,"}","\\}"),defineSymbol(gg,fg,Ag,"}","\\}"),defineSymbol(gg,fg,Ag,"}","\\textbraceright"),defineSymbol(mg,fg,xg,"{","\\lbrace"),defineSymbol(mg,fg,bg,"}","\\rbrace"),defineSymbol(mg,fg,xg,"[","\\lbrack",!0),defineSymbol(gg,fg,Ag,"[","\\lbrack",!0),defineSymbol(mg,fg,bg,"]","\\rbrack",!0),defineSymbol(gg,fg,Ag,"]","\\rbrack",!0),defineSymbol(mg,fg,xg,"(","\\lparen",!0),defineSymbol(mg,fg,bg,")","\\rparen",!0),defineSymbol(gg,fg,Ag,"<","\\textless",!0),defineSymbol(gg,fg,Ag,">","\\textgreater",!0),defineSymbol(mg,fg,xg,"","\\lfloor",!0),defineSymbol(mg,fg,bg,"","\\rfloor",!0),defineSymbol(mg,fg,xg,"","\\lceil",!0),defineSymbol(mg,fg,bg,"","\\rceil",!0),defineSymbol(mg,fg,Ag,"\\","\\backslash"),defineSymbol(mg,fg,Ag,"","|"),defineSymbol(mg,fg,Ag,"","\\vert"),defineSymbol(gg,fg,Ag,"|","\\textbar",!0),defineSymbol(mg,fg,Ag,"","\\|"),defineSymbol(mg,fg,Ag,"","\\Vert"),defineSymbol(gg,fg,Ag,"","\\textbardbl"),defineSymbol(gg,fg,Ag,"~","\\textasciitilde"),defineSymbol(gg,fg,Ag,"\\","\\textbackslash"),defineSymbol(gg,fg,Ag,"^","\\textasciicircum"),defineSymbol(mg,fg,wg,"","\\uparrow",!0),defineSymbol(mg,fg,wg,"","\\Uparrow",!0),defineSymbol(mg,fg,wg,"","\\downarrow",!0),defineSymbol(mg,fg,wg,"","\\Downarrow",!0),defineSymbol(mg,fg,wg,"","\\updownarrow",!0),defineSymbol(mg,fg,wg,"","\\Updownarrow",!0),defineSymbol(mg,fg,Eg,"","\\coprod"),defineSymbol(mg,fg,Eg,"","\\bigvee"),defineSymbol(mg,fg,Eg,"","\\bigwedge"),defineSymbol(mg,fg,Eg,"","\\biguplus"),defineSymbol(mg,fg,Eg,"","\\bigcap"),defineSymbol(mg,fg,Eg,"","\\bigcup"),defineSymbol(mg,fg,Eg,"","\\int"),defineSymbol(mg,fg,Eg,"","\\intop"),defineSymbol(mg,fg,Eg,"","\\iint"),defineSymbol(mg,fg,Eg,"","\\iiint"),defineSymbol(mg,fg,Eg,"","\\prod"),defineSymbol(mg,fg,Eg,"","\\sum"),defineSymbol(mg,fg,Eg,"","\\bigotimes"),defineSymbol(mg,fg,Eg,"","\\bigoplus"),defineSymbol(mg,fg,Eg,"","\\bigodot"),defineSymbol(mg,fg,Eg,"","\\oint"),defineSymbol(mg,fg,Eg,"","\\oiint"),defineSymbol(mg,fg,Eg,"","\\oiiint"),defineSymbol(mg,fg,Eg,"","\\bigsqcup"),defineSymbol(mg,fg,Eg,"","\\smallint"),defineSymbol(gg,fg,Sg,"","\\textellipsis"),defineSymbol(mg,fg,Sg,"","\\mathellipsis"),defineSymbol(gg,fg,Sg,"","\\ldots",!0),defineSymbol(mg,fg,Sg,"","\\ldots",!0),defineSymbol(mg,fg,Sg,"","\\@cdots",!0),defineSymbol(mg,fg,Sg,"","\\ddots",!0),defineSymbol(mg,fg,Ag,"","\\varvdots"),defineSymbol(mg,fg,_g,"","\\acute"),defineSymbol(mg,fg,_g,"","\\grave"),defineSymbol(mg,fg,_g,"","\\ddot"),defineSymbol(mg,fg,_g,"~","\\tilde"),defineSymbol(mg,fg,_g,"","\\bar"),defineSymbol(mg,fg,_g,"","\\breve"),defineSymbol(mg,fg,_g,"","\\check"),defineSymbol(mg,fg,_g,"^","\\hat"),defineSymbol(mg,fg,_g,"","\\vec"),defineSymbol(mg,fg,_g,"","\\dot"),defineSymbol(mg,fg,_g,"","\\mathring"),defineSymbol(mg,fg,Cg,"","\\@imath"),defineSymbol(mg,fg,Cg,"","\\@jmath"),defineSymbol(mg,fg,Ag,"",""),defineSymbol(mg,fg,Ag,"",""),defineSymbol(gg,fg,Ag,"","\\i",!0),defineSymbol(gg,fg,Ag,"","\\j",!0),defineSymbol(gg,fg,Ag,"","\\ss",!0),defineSymbol(gg,fg,Ag,"","\\ae",!0),defineSymbol(gg,fg,Ag,"","\\oe",!0),defineSymbol(gg,fg,Ag,"","\\o",!0),defineSymbol(gg,fg,Ag,"","\\AE",!0),defineSymbol(gg,fg,Ag,"","\\OE",!0),defineSymbol(gg,fg,Ag,"","\\O",!0),defineSymbol(gg,fg,_g,"","\\'"),defineSymbol(gg,fg,_g,"","\\`"),defineSymbol(gg,fg,_g,"","\\^"),defineSymbol(gg,fg,_g,"","\\~"),defineSymbol(gg,fg,_g,"","\\="),defineSymbol(gg,fg,_g,"","\\u"),defineSymbol(gg,fg,_g,"","\\."),defineSymbol(gg,fg,_g,"","\\c"),defineSymbol(gg,fg,_g,"","\\r"),defineSymbol(gg,fg,_g,"","\\v"),defineSymbol(gg,fg,_g,"",'\\"'),defineSymbol(gg,fg,_g,"","\\H"),defineSymbol(gg,fg,_g,"","\\textcircled");var Rg={"--":!0,"---":!0,"``":!0,"''":!0};defineSymbol(gg,fg,Ag,"","--",!0),defineSymbol(gg,fg,Ag,"","\\textendash"),defineSymbol(gg,fg,Ag,"","---",!0),defineSymbol(gg,fg,Ag,"","\\textemdash"),defineSymbol(gg,fg,Ag,"","`",!0),defineSymbol(gg,fg,Ag,"","\\textquoteleft"),defineSymbol(gg,fg,Ag,"","'",!0),defineSymbol(gg,fg,Ag,"","\\textquoteright"),defineSymbol(gg,fg,Ag,"","``",!0),defineSymbol(gg,fg,Ag,"","\\textquotedblleft"),defineSymbol(gg,fg,Ag,"","''",!0),defineSymbol(gg,fg,Ag,"","\\textquotedblright"),defineSymbol(mg,fg,Ag,"","\\degree",!0),defineSymbol(gg,fg,Ag,"","\\degree"),defineSymbol(gg,fg,Ag,"","\\textdegree",!0),defineSymbol(mg,fg,Ag,"","\\pounds"),defineSymbol(mg,fg,Ag,"","\\mathsterling",!0),defineSymbol(gg,fg,Ag,"","\\pounds"),defineSymbol(gg,fg,Ag,"","\\textsterling",!0),defineSymbol(mg,yg,Ag,"","\\maltese"),defineSymbol(gg,yg,Ag,"","\\maltese");for(var Ig='0123456789/@."',Pg=0;Pg<Ig.length;Pg++){var Ng=Ig.charAt(Pg);defineSymbol(mg,fg,Ag,Ng,Ng)}for(var Og='0123456789!@*()-=+";:?/.,',Mg=0;Mg<Og.length;Mg++){var Dg=Og.charAt(Mg);defineSymbol(gg,fg,Ag,Dg,Dg)}for(var Lg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Bg=0;Bg<Lg.length;Bg++){var Fg=Lg.charAt(Bg);defineSymbol(mg,fg,Cg,Fg,Fg),defineSymbol(gg,fg,Ag,Fg,Fg)}defineSymbol(mg,yg,Ag,"C",""),defineSymbol(gg,yg,Ag,"C",""),defineSymbol(mg,yg,Ag,"H",""),defineSymbol(gg,yg,Ag,"H",""),defineSymbol(mg,yg,Ag,"N",""),defineSymbol(gg,yg,Ag,"N",""),defineSymbol(mg,yg,Ag,"P",""),defineSymbol(gg,yg,Ag,"P",""),defineSymbol(mg,yg,Ag,"Q",""),defineSymbol(gg,yg,Ag,"Q",""),defineSymbol(mg,yg,Ag,"R",""),defineSymbol(gg,yg,Ag,"R",""),defineSymbol(mg,yg,Ag,"Z",""),defineSymbol(gg,yg,Ag,"Z",""),defineSymbol(mg,fg,Cg,"h",""),defineSymbol(gg,fg,Cg,"h","");for(var zg="",$g=0;$g<Lg.length;$g++){var Ug=Lg.charAt($g);defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56320+$g)),defineSymbol(gg,fg,Ag,Ug,zg),defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56372+$g)),defineSymbol(gg,fg,Ag,Ug,zg),defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56424+$g)),defineSymbol(gg,fg,Ag,Ug,zg),defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56580+$g)),defineSymbol(gg,fg,Ag,Ug,zg),defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56736+$g)),defineSymbol(gg,fg,Ag,Ug,zg),defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56788+$g)),defineSymbol(gg,fg,Ag,Ug,zg),defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56840+$g)),defineSymbol(gg,fg,Ag,Ug,zg),defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56944+$g)),defineSymbol(gg,fg,Ag,Ug,zg),$g<26&&(defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56632+$g)),defineSymbol(gg,fg,Ag,Ug,zg),defineSymbol(mg,fg,Cg,Ug,zg=String.fromCharCode(55349,56476+$g)),defineSymbol(gg,fg,Ag,Ug,zg))}defineSymbol(mg,fg,Cg,"k",zg=String.fromCharCode(55349,56668)),defineSymbol(gg,fg,Ag,"k",zg);for(var Vg=0;Vg<10;Vg++){var Gg=Vg.toString();defineSymbol(mg,fg,Cg,Gg,zg=String.fromCharCode(55349,57294+Vg)),defineSymbol(gg,fg,Ag,Gg,zg),defineSymbol(mg,fg,Cg,Gg,zg=String.fromCharCode(55349,57314+Vg)),defineSymbol(gg,fg,Ag,Gg,zg),defineSymbol(mg,fg,Cg,Gg,zg=String.fromCharCode(55349,57324+Vg)),defineSymbol(gg,fg,Ag,Gg,zg),defineSymbol(mg,fg,Cg,Gg,zg=String.fromCharCode(55349,57334+Vg)),defineSymbol(gg,fg,Ag,Gg,zg)}for(var Hg="",qg=0;qg<Hg.length;qg++){var jg=Hg.charAt(qg);defineSymbol(mg,fg,Cg,jg,jg),defineSymbol(gg,fg,Ag,jg,jg)}var Wg=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["","",""],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],Yg=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],lookupSymbol=function(O,B,U){return hg[U][O]&&hg[U][O].replace&&(O=hg[U][O].replace),{value:O,metrics:getCharacterMetrics(O,B,U)}},makeSymbol=function(O,B,U,G,q){var j,W=lookupSymbol(O,B,U),Y=W.metrics;if(O=W.value,Y){var K=Y.italic;("text"===U||G&&"mathit"===G.font)&&(K=0),j=new SymbolNode(O,Y.height,Y.depth,K,Y.skew,Y.width,q)}else"undefined"!=typeof console&&console.warn("No character metrics for '"+O+"' in style '"+B+"' and mode '"+U+"'"),j=new SymbolNode(O,0,0,0,0,0,q);if(G){j.maxFontSize=G.sizeMultiplier,G.style.isTight()&&j.classes.push("mtight");var Q=G.getColor();Q&&(j.style.color=Q)}return j},canCombine=(O,B)=>{if(createClass(O.classes)!==createClass(B.classes)||O.skew!==B.skew||O.maxFontSize!==B.maxFontSize)return!1;if(1===O.classes.length){var U=O.classes[0];if("mbin"===U||"mord"===U)return!1}for(var G in O.style)if(O.style.hasOwnProperty(G)&&O.style[G]!==B.style[G])return!1;for(var q in B.style)if(B.style.hasOwnProperty(q)&&O.style[q]!==B.style[q])return!1;return!0},sizeElementFromChildren=function(O){for(var B=0,U=0,G=0,q=0;q<O.children.length;q++){var j=O.children[q];j.height>B&&(B=j.height),j.depth>U&&(U=j.depth),j.maxFontSize>G&&(G=j.maxFontSize)}O.height=B,O.depth=U,O.maxFontSize=G},makeSpan$2=function(O,B,U,G){var q=new Span(O,B,U,G);return sizeElementFromChildren(q),q},makeSvgSpan=(O,B,U,G)=>new Span(O,B,U,G),makeFragment=function(O){var B=new DocumentFragment(O);return sizeElementFromChildren(B),B},retrieveTextFontName=function(O,B,U){var G="";switch(O){case"amsrm":G="AMS";break;case"textrm":G="Main";break;case"textsf":G="SansSerif";break;case"texttt":G="Typewriter";break;default:G=O}return G+"-"+("textbf"===B&&"textit"===U?"BoldItalic":"textbf"===B?"Bold":"textit"===B?"Italic":"Regular")},Kg={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},Qg={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},Zg={fontMap:Kg,makeSymbol,mathsym:function(O,B,U,G){return void 0===G&&(G=[]),"boldsymbol"===U.font&&lookupSymbol(O,"Main-Bold",B).metrics?makeSymbol(O,"Main-Bold",B,U,G.concat(["mathbf"])):"\\"===O||"main"===hg[B][O].font?makeSymbol(O,"Main-Regular",B,U,G):makeSymbol(O,"AMS-Regular",B,U,G.concat(["amsrm"]))},makeSpan:makeSpan$2,makeSvgSpan,makeLineSpan:function(O,B,U){var G=makeSpan$2([O],[],B);return G.height=Math.max(U||B.fontMetrics().defaultRuleThickness,B.minRuleThickness),G.style.borderBottomWidth=makeEm(G.height),G.maxFontSize=1,G},makeAnchor:function(O,B,U,G){var q=new Anchor(O,B,U,G);return sizeElementFromChildren(q),q},makeFragment,wrapFragment:function(O,B){return O instanceof DocumentFragment?makeSpan$2([],[O],B):O},makeVList:function(O,B){for(var{children:U,depth:G}=function(O){if("individualShift"===O.positionType){for(var B=O.children,U=[B[0]],G=-B[0].shift-B[0].elem.depth,q=G,j=1;j<B.length;j++){var W=-B[j].shift-q-B[j].elem.depth,Y=W-(B[j-1].elem.height+B[j-1].elem.depth);q+=W,U.push({type:"kern",size:Y}),U.push(B[j])}return{children:U,depth:G}}var K;if("top"===O.positionType){for(var Q=O.positionData,Z=0;Z<O.children.length;Z++){var X=O.children[Z];Q-="kern"===X.type?X.size:X.elem.height+X.elem.depth}K=Q}else if("bottom"===O.positionType)K=-O.positionData;else{var J=O.children[0];if("elem"!==J.type)throw new Error('First child must have type "elem".');if("shift"===O.positionType)K=-J.elem.depth-O.positionData;else{if("firstBaseline"!==O.positionType)throw new Error("Invalid positionType "+O.positionType+".");K=-J.elem.depth}}return{children:O.children,depth:K}}(O),q=0,j=0;j<U.length;j++){var W=U[j];if("elem"===W.type){var Y=W.elem;q=Math.max(q,Y.maxFontSize,Y.height)}}q+=2;var K=makeSpan$2(["pstrut"],[]);K.style.height=makeEm(q);for(var Q=[],Z=G,X=G,J=G,ee=0;ee<U.length;ee++){var te=U[ee];if("kern"===te.type)J+=te.size;else{var ie=te.elem,re=te.wrapperClasses||[],ne=te.wrapperStyle||{},oe=makeSpan$2(re,[K,ie],void 0,ne);oe.style.top=makeEm(-q-J-ie.depth),te.marginLeft&&(oe.style.marginLeft=te.marginLeft),te.marginRight&&(oe.style.marginRight=te.marginRight),Q.push(oe),J+=ie.height+ie.depth}Z=Math.min(Z,J),X=Math.max(X,J)}var ae,se=makeSpan$2(["vlist"],Q);if(se.style.height=makeEm(X),Z<0){var le=makeSpan$2([],[]),ce=makeSpan$2(["vlist"],[le]);ce.style.height=makeEm(-Z);var de=makeSpan$2(["vlist-s"],[new SymbolNode("")]);ae=[makeSpan$2(["vlist-r"],[se,de]),makeSpan$2(["vlist-r"],[ce])]}else ae=[makeSpan$2(["vlist-r"],[se])];var pe=makeSpan$2(["vlist-t"],ae);return 2===ae.length&&pe.classes.push("vlist-t2"),pe.height=X,pe.depth=-Z,pe},makeOrd:function(O,B,U){var G=O.mode,q=O.text,j=["mord"],W="math"===G||"text"===G&&B.font,Y=W?B.font:B.fontFamily;if(55349===q.charCodeAt(0)){var[K,Q]=function(O,B){var U=1024*(O.charCodeAt(0)-55296)+(O.charCodeAt(1)-56320)+65536,G="math"===B?0:1;if(119808<=U&&U<120484){var q=Math.floor((U-119808)/26);return[Wg[q][2],Wg[q][G]]}if(120782<=U&&U<=120831){var j=Math.floor((U-120782)/10);return[Yg[j][2],Yg[j][G]]}if(120485===U||120486===U)return[Wg[0][2],Wg[0][G]];if(120486<U&&U<120782)return["",""];throw new ParseError("Unsupported character: "+O)}(q,G);return makeSymbol(q,K,G,B,j.concat(Q))}if(Y){var Z,X;if("boldsymbol"===Y){var J=function(O,B,U,G,q){return"textord"!==q&&lookupSymbol(O,"Math-BoldItalic",B).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}}(q,G,0,0,U);Z=J.fontName,X=[J.fontClass]}else W?(Z=Kg[Y].fontName,X=[Y]):(Z=retrieveTextFontName(Y,B.fontWeight,B.fontShape),X=[Y,B.fontWeight,B.fontShape]);if(lookupSymbol(q,Z,G).metrics)return makeSymbol(q,Z,G,B,j.concat(X));if(Rg.hasOwnProperty(q)&&"Typewriter"===Z.slice(0,10)){for(var ee=[],te=0;te<q.length;te++)ee.push(makeSymbol(q[te],Z,G,B,j.concat(X)));return makeFragment(ee)}}if("mathord"===U)return makeSymbol(q,"Math-Italic",G,B,j.concat(["mathnormal"]));if("textord"===U){var ie=hg[G][q]&&hg[G][q].font;if("ams"===ie){var re=retrieveTextFontName("amsrm",B.fontWeight,B.fontShape);return makeSymbol(q,re,G,B,j.concat("amsrm",B.fontWeight,B.fontShape))}if("main"!==ie&&ie){var ne=retrieveTextFontName(ie,B.fontWeight,B.fontShape);return makeSymbol(q,ne,G,B,j.concat(ne,B.fontWeight,B.fontShape))}var oe=retrieveTextFontName("textrm",B.fontWeight,B.fontShape);return makeSymbol(q,oe,G,B,j.concat(B.fontWeight,B.fontShape))}throw new Error("unexpected type: "+U+" in makeOrd")},makeGlue:(O,B)=>{var U=makeSpan$2(["mspace"],[],B),G=calculateSize(O,B);return U.style.marginRight=makeEm(G),U},staticSvg:function(O,B){var[U,G,q]=Qg[O],j=new PathNode(U),W=new SvgNode([j],{width:makeEm(G),height:makeEm(q),style:"width:"+makeEm(G),viewBox:"0 0 "+1e3*G+" "+1e3*q,preserveAspectRatio:"xMinYMin"}),Y=makeSvgSpan(["overlay"],[W],B);return Y.height=q,Y.style.height=makeEm(q),Y.style.width=makeEm(G),Y},svgData:Qg,tryCombineChars:O=>{for(var B=0;B<O.length-1;B++){var U=O[B],G=O[B+1];U instanceof SymbolNode&&G instanceof SymbolNode&&canCombine(U,G)&&(U.text+=G.text,U.height=Math.max(U.height,G.height),U.depth=Math.max(U.depth,G.depth),U.italic=G.italic,O.splice(B+1,1),B--)}return O}},Xg={number:3,unit:"mu"},Jg={number:4,unit:"mu"},ef={number:5,unit:"mu"},tf={mord:{mop:Xg,mbin:Jg,mrel:ef,minner:Xg},mop:{mord:Xg,mop:Xg,mrel:ef,minner:Xg},mbin:{mord:Jg,mop:Jg,mopen:Jg,minner:Jg},mrel:{mord:ef,mop:ef,mopen:ef,minner:ef},mopen:{},mclose:{mop:Xg,mbin:Jg,mrel:ef,minner:Xg},mpunct:{mord:Xg,mop:Xg,mrel:ef,mopen:Xg,mclose:Xg,mpunct:Xg,minner:Xg},minner:{mord:Xg,mop:Xg,mbin:Jg,mrel:ef,mopen:Xg,mpunct:Xg,minner:Xg}},rf={mord:{mop:Xg},mop:{mord:Xg,mop:Xg},mbin:{},mrel:{},mopen:{},mclose:{mop:Xg},mpunct:{},minner:{mop:Xg}},nf={},of={},af={};function defineFunction(O){for(var{type:B,names:U,props:G,handler:q,htmlBuilder:j,mathmlBuilder:W}=O,Y={type:B,numArgs:G.numArgs,argTypes:G.argTypes,allowedInArgument:!!G.allowedInArgument,allowedInText:!!G.allowedInText,allowedInMath:void 0===G.allowedInMath||G.allowedInMath,numOptionalArgs:G.numOptionalArgs||0,infix:!!G.infix,primitive:!!G.primitive,handler:q},K=0;K<U.length;++K)nf[U[K]]=Y;B&&(j&&(of[B]=j),W&&(af[B]=W))}function defineFunctionBuilders(O){var{type:B,htmlBuilder:U,mathmlBuilder:G}=O;defineFunction({type:B,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:U,mathmlBuilder:G})}var normalizeArgument=function(O){return"ordgroup"===O.type&&1===O.body.length?O.body[0]:O},ordargument=function(O){return"ordgroup"===O.type?O.body:[O]},sf=Zg.makeSpan,lf=["leftmost","mbin","mopen","mrel","mop","mpunct"],cf=["rightmost","mrel","mclose","mpunct"],df={display:Zm.DISPLAY,text:Zm.TEXT,script:Zm.SCRIPT,scriptscript:Zm.SCRIPTSCRIPT},pf={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},buildExpression$1=function(O,B,U,G){void 0===G&&(G=[null,null]);for(var q=[],j=0;j<O.length;j++){var W=buildGroup$1(O[j],B);if(W instanceof DocumentFragment){var Y=W.children;q.push(...Y)}else q.push(W)}if(Zg.tryCombineChars(q),!U)return q;var K=B;if(1===O.length){var Q=O[0];"sizing"===Q.type?K=B.havingSize(Q.size):"styling"===Q.type&&(K=B.havingStyle(df[Q.style]))}var Z=sf([G[0]||"leftmost"],[],B),X=sf([G[1]||"rightmost"],[],B),J="root"===U;return uf(q,((O,B)=>{var U=B.classes[0],G=O.classes[0];"mbin"===U&&Vm.contains(cf,G)?B.classes[0]="mord":"mbin"===G&&Vm.contains(lf,U)&&(O.classes[0]="mord")}),{node:Z},X,J),uf(q,((O,B)=>{var U=getTypeOfDomTree(B),G=getTypeOfDomTree(O),q=U&&G?O.hasClass("mtight")?rf[U][G]:tf[U][G]:null;if(q)return Zg.makeGlue(q,K)}),{node:Z},X,J),q},uf=function traverseNonSpaceNodes(O,B,U,G,q){G&&O.push(G);for(var j=0;j<O.length;j++){var W=O[j],Y=checkPartialGroup(W);if(Y)traverseNonSpaceNodes(Y.children,B,U,null,q);else{var K=!W.hasClass("mspace");if(K){var Q=B(W,U.node);Q&&(U.insertAfter?U.insertAfter(Q):(O.unshift(Q),j++))}K?U.node=W:q&&W.hasClass("newline")&&(U.node=sf(["leftmost"])),U.insertAfter=(B=>U=>{O.splice(B+1,0,U),j++})(j)}}G&&O.pop()},checkPartialGroup=function(O){return O instanceof DocumentFragment||O instanceof Anchor||O instanceof Span&&O.hasClass("enclosing")?O:null},hf=function getOutermostNode(O,B){var U=checkPartialGroup(O);if(U){var G=U.children;if(G.length){if("right"===B)return getOutermostNode(G[G.length-1],"right");if("left"===B)return getOutermostNode(G[0],"left")}}return O},getTypeOfDomTree=function(O,B){return O?(B&&(O=hf(O,B)),pf[O.classes[0]]||null):null},makeNullDelimiter=function(O,B){var U=["nulldelimiter"].concat(O.baseSizingClasses());return sf(B.concat(U))},buildGroup$1=function(O,B,U){if(!O)return sf();if(of[O.type]){var G=of[O.type](O,B);if(U&&B.size!==U.size){G=sf(B.sizingClasses(U),[G],B);var q=B.sizeMultiplier/U.sizeMultiplier;G.height*=q,G.depth*=q}return G}throw new ParseError("Got group of unknown type: '"+O.type+"'")};function buildHTMLUnbreakable(O,B){var U=sf(["base"],O,B),G=sf(["strut"]);return G.style.height=makeEm(U.height+U.depth),U.depth&&(G.style.verticalAlign=makeEm(-U.depth)),U.children.unshift(G),U}function buildHTML(O,B){var U=null;1===O.length&&"tag"===O[0].type&&(U=O[0].tag,O=O[0].body);var G,q=buildExpression$1(O,B,"root");2===q.length&&q[1].hasClass("tag")&&(G=q.pop());for(var j,W=[],Y=[],K=0;K<q.length;K++)if(Y.push(q[K]),q[K].hasClass("mbin")||q[K].hasClass("mrel")||q[K].hasClass("allowbreak")){for(var Q=!1;K<q.length-1&&q[K+1].hasClass("mspace")&&!q[K+1].hasClass("newline");)K++,Y.push(q[K]),q[K].hasClass("nobreak")&&(Q=!0);Q||(W.push(buildHTMLUnbreakable(Y,B)),Y=[])}else q[K].hasClass("newline")&&(Y.pop(),Y.length>0&&(W.push(buildHTMLUnbreakable(Y,B)),Y=[]),W.push(q[K]));Y.length>0&&W.push(buildHTMLUnbreakable(Y,B)),U?((j=buildHTMLUnbreakable(buildExpression$1(U,B,!0))).classes=["tag"],W.push(j)):G&&W.push(G);var Z=sf(["katex-html"],W);if(Z.setAttribute("aria-hidden","true"),j){var X=j.children[0];X.style.height=makeEm(Z.height+Z.depth),Z.depth&&(X.style.verticalAlign=makeEm(-Z.depth))}return Z}function newDocumentFragment(O){return new DocumentFragment(O)}class MathNode{constructor(O,B,U){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=O,this.attributes={},this.children=B||[],this.classes=U||[]}setAttribute(O,B){this.attributes[O]=B}getAttribute(O){return this.attributes[O]}toNode(){var O=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var B in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,B)&&O.setAttribute(B,this.attributes[B]);this.classes.length>0&&(O.className=createClass(this.classes));for(var U=0;U<this.children.length;U++)O.appendChild(this.children[U].toNode());return O}toMarkup(){var O="<"+this.type;for(var B in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,B)&&(O+=" "+B+'="',O+=Vm.escape(this.attributes[B]),O+='"');this.classes.length>0&&(O+=' class ="'+Vm.escape(createClass(this.classes))+'"'),O+=">";for(var U=0;U<this.children.length;U++)O+=this.children[U].toMarkup();return O+="</"+this.type+">"}toText(){return this.children.map((O=>O.toText())).join("")}}class TextNode{constructor(O){this.text=void 0,this.text=O}toNode(){return document.createTextNode(this.text)}toMarkup(){return Vm.escape(this.toText())}toText(){return this.text}}var mf={MathNode,TextNode,SpaceNode:class{constructor(O){this.width=void 0,this.character=void 0,this.width=O,this.character=O>=.05555&&O<=.05556?"":O>=.1666&&O<=.1667?"":O>=.2222&&O<=.2223?"":O>=.2777&&O<=.2778?"":O>=-.05556&&O<=-.05555?"":O>=-.1667&&O<=-.1666?"":O>=-.2223&&O<=-.2222?"":O>=-.2778&&O<=-.2777?"":null}toNode(){if(this.character)return document.createTextNode(this.character);var O=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return O.setAttribute("width",makeEm(this.width)),O}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+makeEm(this.width)+'"/>'}toText(){return this.character?this.character:" "}},newDocumentFragment},makeText=function(O,B,U){return!hg[B][O]||!hg[B][O].replace||55349===O.charCodeAt(0)||Rg.hasOwnProperty(O)&&U&&(U.fontFamily&&"tt"===U.fontFamily.slice(4,6)||U.font&&"tt"===U.font.slice(4,6))||(O=hg[B][O].replace),new mf.TextNode(O)},makeRow=function(O){return 1===O.length?O[0]:new mf.MathNode("mrow",O)},getVariant=function(O,B){if("texttt"===B.fontFamily)return"monospace";if("textsf"===B.fontFamily)return"textit"===B.fontShape&&"textbf"===B.fontWeight?"sans-serif-bold-italic":"textit"===B.fontShape?"sans-serif-italic":"textbf"===B.fontWeight?"bold-sans-serif":"sans-serif";if("textit"===B.fontShape&&"textbf"===B.fontWeight)return"bold-italic";if("textit"===B.fontShape)return"italic";if("textbf"===B.fontWeight)return"bold";var U=B.font;if(!U||"mathnormal"===U)return null;var G=O.mode;if("mathit"===U)return"italic";if("boldsymbol"===U)return"textord"===O.type?"bold":"bold-italic";if("mathbf"===U)return"bold";if("mathbb"===U)return"double-struck";if("mathfrak"===U)return"fraktur";if("mathscr"===U||"mathcal"===U)return"script";if("mathsf"===U)return"sans-serif";if("mathtt"===U)return"monospace";var q=O.text;return Vm.contains(["\\imath","\\jmath"],q)?null:(hg[G][q]&&hg[G][q].replace&&(q=hg[G][q].replace),getCharacterMetrics(q,Zg.fontMap[U].fontName,G)?Zg.fontMap[U].variant:null)},buildExpression=function(O,B,U){if(1===O.length){var G=buildGroup(O[0],B);return U&&G instanceof MathNode&&"mo"===G.type&&(G.setAttribute("lspace","0em"),G.setAttribute("rspace","0em")),[G]}for(var q,j=[],W=0;W<O.length;W++){var Y=buildGroup(O[W],B);if(Y instanceof MathNode&&q instanceof MathNode){if("mtext"===Y.type&&"mtext"===q.type&&Y.getAttribute("mathvariant")===q.getAttribute("mathvariant")){q.children.push(...Y.children);continue}if("mn"===Y.type&&"mn"===q.type){q.children.push(...Y.children);continue}if("mi"===Y.type&&1===Y.children.length&&"mn"===q.type){var K=Y.children[0];if(K instanceof TextNode&&"."===K.text){q.children.push(...Y.children);continue}}else if("mi"===q.type&&1===q.children.length){var Q=q.children[0];if(Q instanceof TextNode&&""===Q.text&&("mo"===Y.type||"mi"===Y.type||"mn"===Y.type)){var Z=Y.children[0];Z instanceof TextNode&&Z.text.length>0&&(Z.text=Z.text.slice(0,1)+""+Z.text.slice(1),j.pop())}}}j.push(Y),q=Y}return j},buildExpressionRow=function(O,B,U){return makeRow(buildExpression(O,B,U))},buildGroup=function(O,B){if(!O)return new mf.MathNode("mrow");if(af[O.type])return af[O.type](O,B);throw new ParseError("Got group of unknown type: '"+O.type+"'")};function buildMathML(O,B,U,G,q){var j,W=buildExpression(O,U);j=1===W.length&&W[0]instanceof MathNode&&Vm.contains(["mrow","mtable"],W[0].type)?W[0]:new mf.MathNode("mrow",W);var Y=new mf.MathNode("annotation",[new mf.TextNode(B)]);Y.setAttribute("encoding","application/x-tex");var K=new mf.MathNode("semantics",[j,Y]),Q=new mf.MathNode("math",[K]);Q.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),G&&Q.setAttribute("display","block");var Z=q?"katex":"katex-mathml";return Zg.makeSpan([Z],[Q])}var optionsFromSettings=function(O){return new Options({style:O.displayMode?Zm.DISPLAY:Zm.TEXT,maxSize:O.maxSize,minRuleThickness:O.minRuleThickness})},displayWrap=function(O,B){if(B.displayMode){var U=["katex-display"];B.leqno&&U.push("leqno"),B.fleqn&&U.push("fleqn"),O=Zg.makeSpan(U,[O])}return O},gf={widehat:"^",widecheck:"",widetilde:"~",utilde:"~",overleftarrow:"",underleftarrow:"",xleftarrow:"",overrightarrow:"",underrightarrow:"",xrightarrow:"",underbrace:"",overbrace:"",overgroup:"",undergroup:"",overleftrightarrow:"",underleftrightarrow:"",xleftrightarrow:"",Overrightarrow:"",xRightarrow:"",overleftharpoon:"",xleftharpoonup:"",overrightharpoon:"",xrightharpoonup:"",xLeftarrow:"",xLeftrightarrow:"",xhookleftarrow:"",xhookrightarrow:"",xmapsto:"",xrightharpoondown:"",xleftharpoondown:"",xrightleftharpoons:"",xleftrightharpoons:"",xtwoheadleftarrow:"",xtwoheadrightarrow:"",xlongequal:"=",xtofrom:"",xrightleftarrows:"",xrightequilibrium:"",xleftequilibrium:"","\\cdrightarrow":"","\\cdleftarrow":"","\\cdlongequal":"="},ff={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},stretchy_encloseSpan=function(O,B,U,G,q){var j,W=O.height+O.depth+U+G;if(/fbox|color|angl/.test(B)){if(j=Zg.makeSpan(["stretchy",B],[],q),"fbox"===B){var Y=q.color&&q.getColor();Y&&(j.style.borderColor=Y)}}else{var K=[];/^[bx]cancel$/.test(B)&&K.push(new LineNode({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(B)&&K.push(new LineNode({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var Q=new SvgNode(K,{width:"100%",height:makeEm(W)});j=Zg.makeSvgSpan([],[Q],q)}return j.height=W,j.style.height=makeEm(W),j},stretchy_mathMLnode=function(O){var B=new mf.MathNode("mo",[new mf.TextNode(gf[O.replace(/^\\/,"")])]);return B.setAttribute("stretchy","true"),B},stretchy_svgSpan=function(O,B){var{span:U,minWidth:G,height:q}=function(){var U=4e5,G=O.label.slice(1);if(Vm.contains(["widehat","widecheck","widetilde","utilde"],G)){var q,j,W,Y="ordgroup"===(ee=O.base).type?ee.body.length:1;if(Y>5)"widehat"===G||"widecheck"===G?(q=420,U=2364,W=.42,j=G+"4"):(q=312,U=2340,W=.34,j="tilde4");else{var K=[1,1,2,2,3,3][Y];"widehat"===G||"widecheck"===G?(U=[0,1062,2364,2364,2364][K],q=[0,239,300,360,420][K],W=[0,.24,.3,.3,.36,.42][K],j=G+K):(U=[0,600,1033,2339,2340][K],q=[0,260,286,306,312][K],W=[0,.26,.286,.3,.306,.34][K],j="tilde"+K)}var Q=new PathNode(j),Z=new SvgNode([Q],{width:"100%",height:makeEm(W),viewBox:"0 0 "+U+" "+q,preserveAspectRatio:"none"});return{span:Zg.makeSvgSpan([],[Z],B),minWidth:0,height:W}}var X,J,ee,te=[],ie=ff[G],[re,ne,oe]=ie,ae=oe/1e3,se=re.length;if(1===se)X=["hide-tail"],J=[ie[3]];else if(2===se)X=["halfarrow-left","halfarrow-right"],J=["xMinYMin","xMaxYMin"];else{if(3!==se)throw new Error("Correct katexImagesData or update code here to support\n                    "+se+" children.");X=["brace-left","brace-center","brace-right"],J=["xMinYMin","xMidYMin","xMaxYMin"]}for(var le=0;le<se;le++){var ce=new PathNode(re[le]),de=new SvgNode([ce],{width:"400em",height:makeEm(ae),viewBox:"0 0 "+U+" "+oe,preserveAspectRatio:J[le]+" slice"}),pe=Zg.makeSvgSpan([X[le]],[de],B);if(1===se)return{span:pe,minWidth:ne,height:ae};pe.style.height=makeEm(ae),te.push(pe)}return{span:Zg.makeSpan(["stretchy"],te,B),minWidth:ne,height:ae}}();return U.height=q,U.style.height=makeEm(q),G>0&&(U.style.minWidth=makeEm(G)),U};function assertNodeType(O,B){if(!O||O.type!==B)throw new Error("Expected node of type "+B+", but got "+(O?"node of type "+O.type:String(O)));return O}function assertSymbolNodeType(O){var B=checkSymbolNodeType(O);if(!B)throw new Error("Expected node of symbol group type, but got "+(O?"node of type "+O.type:String(O)));return B}function checkSymbolNodeType(O){return O&&("atom"===O.type||ug.hasOwnProperty(O.type))?O:null}var htmlBuilder$a=(O,B)=>{var U,G,q;O&&"supsub"===O.type?(U=(G=assertNodeType(O.base,"accent")).base,O.base=U,q=function(O){if(O instanceof Span)return O;throw new Error("Expected span<HtmlDomNode> but got "+String(O)+".")}(buildGroup$1(O,B)),O.base=G):U=(G=assertNodeType(O,"accent")).base;var j=buildGroup$1(U,B.havingCrampedStyle()),W=0;if(G.isShifty&&Vm.isCharacterBox(U)){var Y=Vm.getBaseElem(U);W=assertSymbolDomNode(buildGroup$1(Y,B.havingCrampedStyle())).skew}var K,Q="\\c"===G.label,Z=Q?j.height+j.depth:Math.min(j.height,B.fontMetrics().xHeight);if(G.isStretchy)K=stretchy_svgSpan(G,B),K=Zg.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:j},{type:"elem",elem:K,wrapperClasses:["svg-align"],wrapperStyle:W>0?{width:"calc(100% - "+makeEm(2*W)+")",marginLeft:makeEm(2*W)}:void 0}]},B);else{var X,J;"\\vec"===G.label?(X=Zg.staticSvg("vec",B),J=Zg.svgData.vec[1]):((X=assertSymbolDomNode(X=Zg.makeOrd({mode:G.mode,text:G.label},B,"textord"))).italic=0,J=X.width,Q&&(Z+=X.depth)),K=Zg.makeSpan(["accent-body"],[X]);var ee="\\textcircled"===G.label;ee&&(K.classes.push("accent-full"),Z=j.height);var te=W;ee||(te-=J/2),K.style.left=makeEm(te),"\\textcircled"===G.label&&(K.style.top=".2em"),K=Zg.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:j},{type:"kern",size:-Z},{type:"elem",elem:K}]},B)}var ie=Zg.makeSpan(["mord","accent"],[K],B);return q?(q.children[0]=ie,q.height=Math.max(ie.height,q.height),q.classes[0]="mord",q):ie},mathmlBuilder$9=(O,B)=>{var U=O.isStretchy?stretchy_mathMLnode(O.label):new mf.MathNode("mo",[makeText(O.label,O.mode)]),G=new mf.MathNode("mover",[buildGroup(O.base,B),U]);return G.setAttribute("accent","true"),G},yf=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map((O=>"\\"+O)).join("|"));defineFunction({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(O,B)=>{var U=normalizeArgument(B[0]),G=!yf.test(O.funcName),q=!G||"\\widehat"===O.funcName||"\\widetilde"===O.funcName||"\\widecheck"===O.funcName;return{type:"accent",mode:O.parser.mode,label:O.funcName,isStretchy:G,isShifty:q,base:U}},htmlBuilder:htmlBuilder$a,mathmlBuilder:mathmlBuilder$9}),defineFunction({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(O,B)=>{var U=B[0],G=O.parser.mode;return"math"===G&&(O.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+O.funcName+" works only in text mode"),G="text"),{type:"accent",mode:G,label:O.funcName,isStretchy:!1,isShifty:!0,base:U}},htmlBuilder:htmlBuilder$a,mathmlBuilder:mathmlBuilder$9}),defineFunction({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(O,B)=>{var{parser:U,funcName:G}=O,q=B[0];return{type:"accentUnder",mode:U.mode,label:G,base:q}},htmlBuilder:(O,B)=>{var U=buildGroup$1(O.base,B),G=stretchy_svgSpan(O,B),q="\\utilde"===O.label?.12:0,j=Zg.makeVList({positionType:"top",positionData:U.height,children:[{type:"elem",elem:G,wrapperClasses:["svg-align"]},{type:"kern",size:q},{type:"elem",elem:U}]},B);return Zg.makeSpan(["mord","accentunder"],[j],B)},mathmlBuilder:(O,B)=>{var U=stretchy_mathMLnode(O.label),G=new mf.MathNode("munder",[buildGroup(O.base,B),U]);return G.setAttribute("accentunder","true"),G}});var paddedNode=O=>{var B=new mf.MathNode("mpadded",O?[O]:[]);return B.setAttribute("width","+0.6em"),B.setAttribute("lspace","0.3em"),B};defineFunction({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(O,B,U){var{parser:G,funcName:q}=O;return{type:"xArrow",mode:G.mode,label:q,body:B[0],below:U[0]}},htmlBuilder(O,B){var U,G=B.style,q=B.havingStyle(G.sup()),j=Zg.wrapFragment(buildGroup$1(O.body,q,B),B),W="\\x"===O.label.slice(0,2)?"x":"cd";j.classes.push(W+"-arrow-pad"),O.below&&(q=B.havingStyle(G.sub()),(U=Zg.wrapFragment(buildGroup$1(O.below,q,B),B)).classes.push(W+"-arrow-pad"));var Y,K=stretchy_svgSpan(O,B),Q=-B.fontMetrics().axisHeight+.5*K.height,Z=-B.fontMetrics().axisHeight-.5*K.height-.111;if((j.depth>.25||"\\xleftequilibrium"===O.label)&&(Z-=j.depth),U){var X=-B.fontMetrics().axisHeight+U.height+.5*K.height+.111;Y=Zg.makeVList({positionType:"individualShift",children:[{type:"elem",elem:j,shift:Z},{type:"elem",elem:K,shift:Q},{type:"elem",elem:U,shift:X}]},B)}else Y=Zg.makeVList({positionType:"individualShift",children:[{type:"elem",elem:j,shift:Z},{type:"elem",elem:K,shift:Q}]},B);return Y.children[0].children[0].children[1].classes.push("svg-align"),Zg.makeSpan(["mrel","x-arrow"],[Y],B)},mathmlBuilder(O,B){var U,G=stretchy_mathMLnode(O.label);if(G.setAttribute("minsize","x"===O.label.charAt(0)?"1.75em":"3.0em"),O.body){var q=paddedNode(buildGroup(O.body,B));if(O.below){var j=paddedNode(buildGroup(O.below,B));U=new mf.MathNode("munderover",[G,j,q])}else U=new mf.MathNode("mover",[G,q])}else if(O.below){var W=paddedNode(buildGroup(O.below,B));U=new mf.MathNode("munder",[G,W])}else U=paddedNode(),U=new mf.MathNode("mover",[G,U]);return U}});var _f=Zg.makeSpan;function htmlBuilder$9(O,B){var U=buildExpression$1(O.body,B,!0);return _f([O.mclass],U,B)}function mathmlBuilder$8(O,B){var U,G=buildExpression(O.body,B);return"minner"===O.mclass?U=new mf.MathNode("mpadded",G):"mord"===O.mclass?O.isCharacterBox?(U=G[0]).type="mi":U=new mf.MathNode("mi",G):(O.isCharacterBox?(U=G[0]).type="mo":U=new mf.MathNode("mo",G),"mbin"===O.mclass?(U.attributes.lspace="0.22em",U.attributes.rspace="0.22em"):"mpunct"===O.mclass?(U.attributes.lspace="0em",U.attributes.rspace="0.17em"):"mopen"===O.mclass||"mclose"===O.mclass?(U.attributes.lspace="0em",U.attributes.rspace="0em"):"minner"===O.mclass&&(U.attributes.lspace="0.0556em",U.attributes.width="+0.1111em")),U}defineFunction({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(O,B){var{parser:U,funcName:G}=O,q=B[0];return{type:"mclass",mode:U.mode,mclass:"m"+G.slice(5),body:ordargument(q),isCharacterBox:Vm.isCharacterBox(q)}},htmlBuilder:htmlBuilder$9,mathmlBuilder:mathmlBuilder$8});var binrelClass=O=>{var B="ordgroup"===O.type&&O.body.length?O.body[0]:O;return"atom"!==B.type||"bin"!==B.family&&"rel"!==B.family?"mord":"m"+B.family};defineFunction({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(O,B){var{parser:U}=O;return{type:"mclass",mode:U.mode,mclass:binrelClass(B[0]),body:ordargument(B[1]),isCharacterBox:Vm.isCharacterBox(B[1])}}}),defineFunction({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(O,B){var U,{parser:G,funcName:q}=O,j=B[1],W=B[0];U="\\stackrel"!==q?binrelClass(j):"mrel";var Y={type:"op",mode:j.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:"\\stackrel"!==q,body:ordargument(j)},K={type:"supsub",mode:W.mode,base:Y,sup:"\\underset"===q?null:W,sub:"\\underset"===q?W:null};return{type:"mclass",mode:G.mode,mclass:U,body:[K],isCharacterBox:Vm.isCharacterBox(K)}},htmlBuilder:htmlBuilder$9,mathmlBuilder:mathmlBuilder$8}),defineFunction({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(O,B){var{parser:U}=O;return{type:"pmb",mode:U.mode,mclass:binrelClass(B[0]),body:ordargument(B[0])}},htmlBuilder(O,B){var U=buildExpression$1(O.body,B,!0),G=Zg.makeSpan([O.mclass],U,B);return G.style.textShadow="0.02em 0.01em 0.04px",G},mathmlBuilder(O,B){var U=buildExpression(O.body,B),G=new mf.MathNode("mstyle",U);return G.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),G}});var vf={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},isStartOfArrow=O=>"textord"===O.type&&"@"===O.text,isLabelEnd=(O,B)=>("mathord"===O.type||"atom"===O.type)&&O.text===B;function cdArrow(O,B,U){var G=vf[O];switch(G){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return U.callFunction(G,[B[0]],[B[1]]);case"\\uparrow":case"\\downarrow":var q={type:"atom",text:G,mode:"math",family:"rel"},j={type:"ordgroup",mode:"math",body:[U.callFunction("\\\\cdleft",[B[0]],[]),U.callFunction("\\Big",[q],[]),U.callFunction("\\\\cdright",[B[1]],[])]};return U.callFunction("\\\\cdparent",[j],[]);case"\\\\cdlongequal":return U.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":return U.callFunction("\\Big",[{type:"textord",text:"\\Vert",mode:"math"}],[]);default:return{type:"textord",text:" ",mode:"math"}}}defineFunction({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(O,B){var{parser:U,funcName:G}=O;return{type:"cdlabel",mode:U.mode,side:G.slice(4),label:B[0]}},htmlBuilder(O,B){var U=B.havingStyle(B.style.sup()),G=Zg.wrapFragment(buildGroup$1(O.label,U,B),B);return G.classes.push("cd-label-"+O.side),G.style.bottom=makeEm(.8-G.depth),G.height=0,G.depth=0,G},mathmlBuilder(O,B){var U=new mf.MathNode("mrow",[buildGroup(O.label,B)]);return(U=new mf.MathNode("mpadded",[U])).setAttribute("width","0"),"left"===O.side&&U.setAttribute("lspace","-1width"),U.setAttribute("voffset","0.7em"),(U=new mf.MathNode("mstyle",[U])).setAttribute("displaystyle","false"),U.setAttribute("scriptlevel","1"),U}}),defineFunction({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(O,B){var{parser:U}=O;return{type:"cdlabelparent",mode:U.mode,fragment:B[0]}},htmlBuilder(O,B){var U=Zg.wrapFragment(buildGroup$1(O.fragment,B),B);return U.classes.push("cd-vert-arrow"),U},mathmlBuilder:(O,B)=>new mf.MathNode("mrow",[buildGroup(O.fragment,B)])}),defineFunction({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(O,B){for(var{parser:U}=O,G=assertNodeType(B[0],"ordgroup").body,q="",j=0;j<G.length;j++){q+=assertNodeType(G[j],"textord").text}var W,Y=parseInt(q);if(isNaN(Y))throw new ParseError("\\@char has non-numeric argument "+q);if(Y<0||Y>=1114111)throw new ParseError("\\@char with invalid code point "+q);return Y<=65535?W=String.fromCharCode(Y):(Y-=65536,W=String.fromCharCode(55296+(Y>>10),56320+(1023&Y))),{type:"textord",mode:U.mode,text:W}}});var htmlBuilder$8=(O,B)=>{var U=buildExpression$1(O.body,B.withColor(O.color),!1);return Zg.makeFragment(U)},mathmlBuilder$7=(O,B)=>{var U=buildExpression(O.body,B.withColor(O.color)),G=new mf.MathNode("mstyle",U);return G.setAttribute("mathcolor",O.color),G};defineFunction({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(O,B){var{parser:U}=O,G=assertNodeType(B[0],"color-token").color,q=B[1];return{type:"color",mode:U.mode,color:G,body:ordargument(q)}},htmlBuilder:htmlBuilder$8,mathmlBuilder:mathmlBuilder$7}),defineFunction({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(O,B){var{parser:U,breakOnTokenText:G}=O,q=assertNodeType(B[0],"color-token").color;U.gullet.macros.set("\\current@color",q);var j=U.parseExpression(!0,G);return{type:"color",mode:U.mode,color:q,body:j}},htmlBuilder:htmlBuilder$8,mathmlBuilder:mathmlBuilder$7}),defineFunction({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(O,B,U){var{parser:G}=O,q="["===G.gullet.future().text?G.parseSizeGroup(!0):null,j=!G.settings.displayMode||!G.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:G.mode,newLine:j,size:q&&assertNodeType(q,"size").value}},htmlBuilder(O,B){var U=Zg.makeSpan(["mspace"],[],B);return O.newLine&&(U.classes.push("newline"),O.size&&(U.style.marginTop=makeEm(calculateSize(O.size,B)))),U},mathmlBuilder(O,B){var U=new mf.MathNode("mspace");return O.newLine&&(U.setAttribute("linebreak","newline"),O.size&&U.setAttribute("height",makeEm(calculateSize(O.size,B)))),U}});var bf={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},checkControlSequence=O=>{var B=O.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(B))throw new ParseError("Expected a control sequence",O);return B},letCommand=(O,B,U,G)=>{var q=O.gullet.macros.get(U.text);null==q&&(U.noexpand=!0,q={tokens:[U],numArgs:0,unexpandable:!O.gullet.isExpandable(U.text)}),O.gullet.macros.set(B,q,G)};defineFunction({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(O){var{parser:B,funcName:U}=O;B.consumeSpaces();var G=B.fetch();if(bf[G.text])return"\\global"!==U&&"\\\\globallong"!==U||(G.text=bf[G.text]),assertNodeType(B.parseFunction(),"internal");throw new ParseError("Invalid token after macro prefix",G)}}),defineFunction({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(O){var{parser:B,funcName:U}=O,G=B.gullet.popToken(),q=G.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(q))throw new ParseError("Expected a control sequence",G);for(var j,W=0,Y=[[]];"{"!==B.gullet.future().text;)if("#"===(G=B.gullet.popToken()).text){if("{"===B.gullet.future().text){j=B.gullet.future(),Y[W].push("{");break}if(G=B.gullet.popToken(),!/^[1-9]$/.test(G.text))throw new ParseError('Invalid argument number "'+G.text+'"');if(parseInt(G.text)!==W+1)throw new ParseError('Argument number "'+G.text+'" out of order');W++,Y.push([])}else{if("EOF"===G.text)throw new ParseError("Expected a macro definition");Y[W].push(G.text)}var{tokens:K}=B.gullet.consumeArg();return j&&K.unshift(j),"\\edef"!==U&&"\\xdef"!==U||(K=B.gullet.expandTokens(K)).reverse(),B.gullet.macros.set(q,{tokens:K,numArgs:W,delimiters:Y},U===bf[U]),{type:"internal",mode:B.mode}}}),defineFunction({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(O){var{parser:B,funcName:U}=O,G=checkControlSequence(B.gullet.popToken());B.gullet.consumeSpaces();var q=(O=>{var B=O.gullet.popToken();return"="===B.text&&" "===(B=O.gullet.popToken()).text&&(B=O.gullet.popToken()),B})(B);return letCommand(B,G,q,"\\\\globallet"===U),{type:"internal",mode:B.mode}}}),defineFunction({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(O){var{parser:B,funcName:U}=O,G=checkControlSequence(B.gullet.popToken()),q=B.gullet.popToken(),j=B.gullet.popToken();return letCommand(B,G,j,"\\\\globalfuture"===U),B.gullet.pushToken(j),B.gullet.pushToken(q),{type:"internal",mode:B.mode}}});var getMetrics=function(O,B,U){var G=getCharacterMetrics(hg.math[O]&&hg.math[O].replace||O,B,U);if(!G)throw new Error("Unsupported symbol "+O+" and font size "+B+".");return G},styleWrap=function(O,B,U,G){var q=U.havingBaseStyle(B),j=Zg.makeSpan(G.concat(q.sizingClasses(U)),[O],U),W=q.sizeMultiplier/U.sizeMultiplier;return j.height*=W,j.depth*=W,j.maxFontSize=q.sizeMultiplier,j},centerSpan=function(O,B,U){var G=B.havingBaseStyle(U),q=(1-B.sizeMultiplier/G.sizeMultiplier)*B.fontMetrics().axisHeight;O.classes.push("delimcenter"),O.style.top=makeEm(q),O.height-=q,O.depth+=q},makeLargeDelim=function(O,B,U,G,q,j){var W=function(O,B,U,G){return Zg.makeSymbol(O,"Size"+B+"-Regular",U,G)}(O,B,q,G),Y=styleWrap(Zg.makeSpan(["delimsizing","size"+B],[W],G),Zm.TEXT,G,j);return U&&centerSpan(Y,G,Zm.TEXT),Y},makeGlyphSpan=function(O,B,U){var G;return G="Size1-Regular"===B?"delim-size1":"delim-size4",{type:"elem",elem:Zg.makeSpan(["delimsizinginner",G],[Zg.makeSpan([],[Zg.makeSymbol(O,B,U)])])}},makeInner=function(O,B,U){var G=ig["Size4-Regular"][O.charCodeAt(0)]?ig["Size4-Regular"][O.charCodeAt(0)][4]:ig["Size1-Regular"][O.charCodeAt(0)][4],q=new PathNode("inner",function(O,B){switch(O){case"":return"M291 0 H417 V"+B+" H291z M291 0 H417 V"+B+" H291z";case"":return"M145 0 H188 V"+B+" H145z M145 0 H188 V"+B+" H145z";case"":return"M145 0 H188 V"+B+" H145z M145 0 H188 V"+B+" H145zM367 0 H410 V"+B+" H367z M367 0 H410 V"+B+" H367z";case"":return"M457 0 H583 V"+B+" H457z M457 0 H583 V"+B+" H457z";case"":return"M319 0 H403 V"+B+" H319z M319 0 H403 V"+B+" H319z";case"":return"M263 0 H347 V"+B+" H263z M263 0 H347 V"+B+" H263z";case"":return"M384 0 H504 V"+B+" H384z M384 0 H504 V"+B+" H384z";case"":return"M312 0 H355 V"+B+" H312z M312 0 H355 V"+B+" H312z";case"":return"M257 0 H300 V"+B+" H257z M257 0 H300 V"+B+" H257zM478 0 H521 V"+B+" H478z M478 0 H521 V"+B+" H478z";default:return""}}(O,Math.round(1e3*B))),j=new SvgNode([q],{width:makeEm(G),height:makeEm(B),style:"width:"+makeEm(G),viewBox:"0 0 "+1e3*G+" "+Math.round(1e3*B),preserveAspectRatio:"xMinYMin"}),W=Zg.makeSvgSpan([],[j],U);return W.height=B,W.style.height=makeEm(B),W.style.width=makeEm(G),{type:"elem",elem:W}},Sf={type:"kern",size:-.008},Cf=["|","\\lvert","\\rvert","\\vert"],Ef=["\\|","\\lVert","\\rVert","\\Vert"],makeStackedDelim=function(O,B,U,G,q,j){var W,Y,K,Q,Z="",X=0;W=K=Q=O,Y=null;var J="Size1-Regular";"\\uparrow"===O?K=Q="":"\\Uparrow"===O?K=Q="":"\\downarrow"===O?W=K="":"\\Downarrow"===O?W=K="":"\\updownarrow"===O?(W="\\uparrow",K="",Q="\\downarrow"):"\\Updownarrow"===O?(W="\\Uparrow",K="",Q="\\Downarrow"):Vm.contains(Cf,O)?(K="",Z="vert",X=333):Vm.contains(Ef,O)?(K="",Z="doublevert",X=556):"["===O||"\\lbrack"===O?(W="",K="",Q="",J="Size4-Regular",Z="lbrack",X=667):"]"===O||"\\rbrack"===O?(W="",K="",Q="",J="Size4-Regular",Z="rbrack",X=667):"\\lfloor"===O||""===O?(K=W="",Q="",J="Size4-Regular",Z="lfloor",X=667):"\\lceil"===O||""===O?(W="",K=Q="",J="Size4-Regular",Z="lceil",X=667):"\\rfloor"===O||""===O?(K=W="",Q="",J="Size4-Regular",Z="rfloor",X=667):"\\rceil"===O||""===O?(W="",K=Q="",J="Size4-Regular",Z="rceil",X=667):"("===O||"\\lparen"===O?(W="",K="",Q="",J="Size4-Regular",Z="lparen",X=875):")"===O||"\\rparen"===O?(W="",K="",Q="",J="Size4-Regular",Z="rparen",X=875):"\\{"===O||"\\lbrace"===O?(W="",Y="",Q="",K="",J="Size4-Regular"):"\\}"===O||"\\rbrace"===O?(W="",Y="",Q="",K="",J="Size4-Regular"):"\\lgroup"===O||""===O?(W="",Q="",K="",J="Size4-Regular"):"\\rgroup"===O||""===O?(W="",Q="",K="",J="Size4-Regular"):"\\lmoustache"===O||""===O?(W="",Q="",K="",J="Size4-Regular"):"\\rmoustache"!==O&&""!==O||(W="",Q="",K="",J="Size4-Regular");var ee=getMetrics(W,J,q),te=ee.height+ee.depth,ie=getMetrics(K,J,q),re=ie.height+ie.depth,ne=getMetrics(Q,J,q),oe=ne.height+ne.depth,ae=0,se=1;if(null!==Y){var le=getMetrics(Y,J,q);ae=le.height+le.depth,se=2}var ce=te+oe+ae,de=ce+Math.max(0,Math.ceil((B-ce)/(se*re)))*se*re,pe=G.fontMetrics().axisHeight;U&&(pe*=G.sizeMultiplier);var ue=de/2-pe,he=[];if(Z.length>0){var me=de-te-oe,ge=Math.round(1e3*de),fe=function(O,B){switch(O){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+B+" v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v"+B+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+B+" v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v"+B+" v1759 h84z";case"vert":return"M145 15 v585 v"+B+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-B+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v"+B+" v585 h43z";case"doublevert":return"M145 15 v585 v"+B+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-B+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v"+B+" v585 h43z\nM367 15 v585 v"+B+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-B+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M410 15 H367 v585 v"+B+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+B+" v1715 h263 v84 H319z\nMM319 602 V0 H403 V602 v"+B+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+B+" v1799 H0 v-84 H319z\nMM319 602 V0 H403 V602 v"+B+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+B+" v602 h84z\nM403 1759 V0 H319 V1759 v"+B+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+B+" v602 h84z\nM347 1759 V0 h-84 V1759 v"+B+" v602 h84z";case"lparen":return"M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\n-36,557 l0,"+(B+84)+"c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\nl0,-"+(B+92)+"c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z";case"rparen":return"M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,"+(B+9)+"\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\nl0,-"+(B+144)+"c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z";default:throw new Error("Unknown stretchy delimiter.")}}(Z,Math.round(1e3*me)),ye=new PathNode(Z,fe),_e=(X/1e3).toFixed(3)+"em",ve=(ge/1e3).toFixed(3)+"em",be=new SvgNode([ye],{width:_e,height:ve,viewBox:"0 0 "+X+" "+ge}),Se=Zg.makeSvgSpan([],[be],G);Se.height=ge/1e3,Se.style.width=_e,Se.style.height=ve,he.push({type:"elem",elem:Se})}else{if(he.push(makeGlyphSpan(Q,J,q)),he.push(Sf),null===Y){var Ce=de-te-oe+.016;he.push(makeInner(K,Ce,G))}else{var Ee=(de-te-oe-ae)/2+.016;he.push(makeInner(K,Ee,G)),he.push(Sf),he.push(makeGlyphSpan(Y,J,q)),he.push(Sf),he.push(makeInner(K,Ee,G))}he.push(Sf),he.push(makeGlyphSpan(W,J,q))}var xe=G.havingBaseStyle(Zm.TEXT),Te=Zg.makeVList({positionType:"bottom",positionData:ue,children:he},xe);return styleWrap(Zg.makeSpan(["delimsizing","mult"],[Te],xe),Zm.TEXT,G,j)},xf=.08,sqrtSvg=function(O,B,U,G,q){var j=function(O,B,U){B*=1e3;var G="";switch(O){case"sqrtMain":G=function(O,B){return"M95,"+(622+O+B)+"\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl"+O/2.075+" -"+O+"\nc5.3,-9.3,12,-14,20,-14\nH400000v"+(40+O)+"H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM"+(834+O)+" "+B+"h400000v"+(40+O)+"h-400000z"}(B,eg);break;case"sqrtSize1":G=function(O,B){return"M263,"+(601+O+B)+"c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl"+O/2.084+" -"+O+"\nc4.7,-7.3,11,-11,19,-11\nH40000v"+(40+O)+"H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM"+(1001+O)+" "+B+"h400000v"+(40+O)+"h-400000z"}(B,eg);break;case"sqrtSize2":G=function(O,B){return"M983 "+(10+O+B)+"\nl"+O/3.13+" -"+O+"\nc4,-6.7,10,-10,18,-10 H400000v"+(40+O)+"\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM"+(1001+O)+" "+B+"h400000v"+(40+O)+"h-400000z"}(B,eg);break;case"sqrtSize3":G=function(O,B){return"M424,"+(2398+O+B)+"\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl"+O/4.223+" -"+O+"c4,-6.7,10,-10,18,-10 H400000\nv"+(40+O)+"H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M"+(1001+O)+" "+B+"\nh400000v"+(40+O)+"h-400000z"}(B,eg);break;case"sqrtSize4":G=function(O,B){return"M473,"+(2713+O+B)+"\nc339.3,-1799.3,509.3,-2700,510,-2702 l"+O/5.298+" -"+O+"\nc3.3,-7.3,9.3,-11,18,-11 H400000v"+(40+O)+"H1017.7\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\n606zM"+(1001+O)+" "+B+"h400000v"+(40+O)+"H1017.7z"}(B,eg);break;case"sqrtTall":G=function(O,B,U){return"M702 "+(O+B)+"H400000"+(40+O)+"\nH742v"+(U-54-B-O)+"l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 "+B+"H400000v"+(40+O)+"H742z"}(B,eg,U)}return G}(O,G,U),W=new PathNode(O,j),Y=new SvgNode([W],{width:"400em",height:makeEm(B),viewBox:"0 0 400000 "+U,preserveAspectRatio:"xMinYMin slice"});return Zg.makeSvgSpan(["hide-tail"],[Y],q)},Tf=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","\\surd"],wf=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","",""],kf=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],Af=[0,1.2,1.8,2.4,3],Rf=[{type:"small",style:Zm.SCRIPTSCRIPT},{type:"small",style:Zm.SCRIPT},{type:"small",style:Zm.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],If=[{type:"small",style:Zm.SCRIPTSCRIPT},{type:"small",style:Zm.SCRIPT},{type:"small",style:Zm.TEXT},{type:"stack"}],Pf=[{type:"small",style:Zm.SCRIPTSCRIPT},{type:"small",style:Zm.SCRIPT},{type:"small",style:Zm.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],delimTypeToFont=function(O){if("small"===O.type)return"Main-Regular";if("large"===O.type)return"Size"+O.size+"-Regular";if("stack"===O.type)return"Size4-Regular";throw new Error("Add support for delim type '"+O.type+"' here.")},traverseSequence=function(O,B,U,G){for(var q=Math.min(2,3-G.style.size);q<U.length&&"stack"!==U[q].type;q++){var j=getMetrics(O,delimTypeToFont(U[q]),"math"),W=j.height+j.depth;if("small"===U[q].type&&(W*=G.havingBaseStyle(U[q].style).sizeMultiplier),W>B)return U[q]}return U[U.length-1]},makeCustomSizedDelim=function(O,B,U,G,q,j){var W;"<"===O||"\\lt"===O||""===O?O="\\langle":">"!==O&&"\\gt"!==O&&""!==O||(O="\\rangle"),W=Vm.contains(kf,O)?Rf:Vm.contains(Tf,O)?Pf:If;var Y=traverseSequence(O,B,W,G);return"small"===Y.type?function(O,B,U,G,q,j){var W=Zg.makeSymbol(O,"Main-Regular",q,G),Y=styleWrap(W,B,G,j);return U&&centerSpan(Y,G,B),Y}(O,Y.style,U,G,q,j):"large"===Y.type?makeLargeDelim(O,Y.size,U,G,q,j):makeStackedDelim(O,B,U,G,q,j)},Nf={sqrtImage:function(O,B){var U,G,q=B.havingBaseSizing(),j=traverseSequence("\\surd",O*q.sizeMultiplier,Pf,q),W=q.sizeMultiplier,Y=Math.max(0,B.minRuleThickness-B.fontMetrics().sqrtRuleThickness),K=0,Q=0,Z=0;return"small"===j.type?(O<1?W=1:O<1.4&&(W=.7),Q=(1+Y)/W,(U=sqrtSvg("sqrtMain",K=(1+Y+xf)/W,Z=1e3+1e3*Y+80,Y,B)).style.minWidth="0.853em",G=.833/W):"large"===j.type?(Z=1080*Af[j.size],Q=(Af[j.size]+Y)/W,K=(Af[j.size]+Y+xf)/W,(U=sqrtSvg("sqrtSize"+j.size,K,Z,Y,B)).style.minWidth="1.02em",G=1/W):(K=O+Y+xf,Q=O+Y,Z=Math.floor(1e3*O+Y)+80,(U=sqrtSvg("sqrtTall",K,Z,Y,B)).style.minWidth="0.742em",G=1.056),U.height=Q,U.style.height=makeEm(K),{span:U,advanceWidth:G,ruleWidth:(B.fontMetrics().sqrtRuleThickness+Y)*W}},sizedDelim:function(O,B,U,G,q){if("<"===O||"\\lt"===O||""===O?O="\\langle":">"!==O&&"\\gt"!==O&&""!==O||(O="\\rangle"),Vm.contains(Tf,O)||Vm.contains(kf,O))return makeLargeDelim(O,B,!1,U,G,q);if(Vm.contains(wf,O))return makeStackedDelim(O,Af[B],!1,U,G,q);throw new ParseError("Illegal delimiter: '"+O+"'")},sizeToMaxHeight:Af,customSizedDelim:makeCustomSizedDelim,leftRightDelim:function(O,B,U,G,q,j){var W=G.fontMetrics().axisHeight*G.sizeMultiplier,Y=5/G.fontMetrics().ptPerEm,K=Math.max(B-W,U+W),Q=Math.max(K/500*901,2*K-Y);return makeCustomSizedDelim(O,Q,!0,G,q,j)}},Of={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},Mf=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","<",">","\\langle","","\\rangle","","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","","","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function checkDelimiter(O,B){var U=checkSymbolNodeType(O);if(U&&Vm.contains(Mf,U.text))return U;throw new ParseError(U?"Invalid delimiter '"+U.text+"' after '"+B.funcName+"'":"Invalid delimiter type '"+O.type+"'",O)}function assertParsed(O){if(!O.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}defineFunction({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(O,B)=>{var U=checkDelimiter(B[0],O);return{type:"delimsizing",mode:O.parser.mode,size:Of[O.funcName].size,mclass:Of[O.funcName].mclass,delim:U.text}},htmlBuilder:(O,B)=>"."===O.delim?Zg.makeSpan([O.mclass]):Nf.sizedDelim(O.delim,O.size,B,O.mode,[O.mclass]),mathmlBuilder:O=>{var B=[];"."!==O.delim&&B.push(makeText(O.delim,O.mode));var U=new mf.MathNode("mo",B);"mopen"===O.mclass||"mclose"===O.mclass?U.setAttribute("fence","true"):U.setAttribute("fence","false"),U.setAttribute("stretchy","true");var G=makeEm(Nf.sizeToMaxHeight[O.size]);return U.setAttribute("minsize",G),U.setAttribute("maxsize",G),U}}),defineFunction({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(O,B)=>{var U=O.parser.gullet.macros.get("\\current@color");if(U&&"string"!=typeof U)throw new ParseError("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:O.parser.mode,delim:checkDelimiter(B[0],O).text,color:U}}}),defineFunction({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(O,B)=>{var U=checkDelimiter(B[0],O),G=O.parser;++G.leftrightDepth;var q=G.parseExpression(!1);--G.leftrightDepth,G.expect("\\right",!1);var j=assertNodeType(G.parseFunction(),"leftright-right");return{type:"leftright",mode:G.mode,body:q,left:U.text,right:j.delim,rightColor:j.color}},htmlBuilder:(O,B)=>{assertParsed(O);for(var U,G,q=buildExpression$1(O.body,B,!0,["mopen","mclose"]),j=0,W=0,Y=!1,K=0;K<q.length;K++)q[K].isMiddle?Y=!0:(j=Math.max(q[K].height,j),W=Math.max(q[K].depth,W));if(j*=B.sizeMultiplier,W*=B.sizeMultiplier,U="."===O.left?makeNullDelimiter(B,["mopen"]):Nf.leftRightDelim(O.left,j,W,B,O.mode,["mopen"]),q.unshift(U),Y)for(var Q=1;Q<q.length;Q++){var Z=q[Q].isMiddle;Z&&(q[Q]=Nf.leftRightDelim(Z.delim,j,W,Z.options,O.mode,[]))}if("."===O.right)G=makeNullDelimiter(B,["mclose"]);else{var X=O.rightColor?B.withColor(O.rightColor):B;G=Nf.leftRightDelim(O.right,j,W,X,O.mode,["mclose"])}return q.push(G),Zg.makeSpan(["minner"],q,B)},mathmlBuilder:(O,B)=>{assertParsed(O);var U=buildExpression(O.body,B);if("."!==O.left){var G=new mf.MathNode("mo",[makeText(O.left,O.mode)]);G.setAttribute("fence","true"),U.unshift(G)}if("."!==O.right){var q=new mf.MathNode("mo",[makeText(O.right,O.mode)]);q.setAttribute("fence","true"),O.rightColor&&q.setAttribute("mathcolor",O.rightColor),U.push(q)}return makeRow(U)}}),defineFunction({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(O,B)=>{var U=checkDelimiter(B[0],O);if(!O.parser.leftrightDepth)throw new ParseError("\\middle without preceding \\left",U);return{type:"middle",mode:O.parser.mode,delim:U.text}},htmlBuilder:(O,B)=>{var U;if("."===O.delim)U=makeNullDelimiter(B,[]);else{U=Nf.sizedDelim(O.delim,1,B,O.mode,[]);var G={delim:O.delim,options:B};U.isMiddle=G}return U},mathmlBuilder:(O,B)=>{var U="\\vert"===O.delim||"|"===O.delim?makeText("|","text"):makeText(O.delim,O.mode),G=new mf.MathNode("mo",[U]);return G.setAttribute("fence","true"),G.setAttribute("lspace","0.05em"),G.setAttribute("rspace","0.05em"),G}});var htmlBuilder$7=(O,B)=>{var U,G,q,j=Zg.wrapFragment(buildGroup$1(O.body,B),B),W=O.label.slice(1),Y=B.sizeMultiplier,K=0,Q=Vm.isCharacterBox(O.body);if("sout"===W)(U=Zg.makeSpan(["stretchy","sout"])).height=B.fontMetrics().defaultRuleThickness/Y,K=-.5*B.fontMetrics().xHeight;else if("phase"===W){var Z=calculateSize({number:.6,unit:"pt"},B),X=calculateSize({number:.35,unit:"ex"},B);Y/=B.havingBaseSizing().sizeMultiplier;var J=j.height+j.depth+Z+X;j.style.paddingLeft=makeEm(J/2+Z);var ee=Math.floor(1e3*J*Y),te="M400000 "+(G=ee)+" H0 L"+G/2+" 0 l65 45 L145 "+(G-80)+" H400000z",ie=new SvgNode([new PathNode("phase",te)],{width:"400em",height:makeEm(ee/1e3),viewBox:"0 0 400000 "+ee,preserveAspectRatio:"xMinYMin slice"});(U=Zg.makeSvgSpan(["hide-tail"],[ie],B)).style.height=makeEm(J),K=j.depth+Z+X}else{/cancel/.test(W)?Q||j.classes.push("cancel-pad"):"angl"===W?j.classes.push("anglpad"):j.classes.push("boxpad");var re=0,ne=0,oe=0;/box/.test(W)?(oe=Math.max(B.fontMetrics().fboxrule,B.minRuleThickness),ne=re=B.fontMetrics().fboxsep+("colorbox"===W?0:oe)):"angl"===W?(re=4*(oe=Math.max(B.fontMetrics().defaultRuleThickness,B.minRuleThickness)),ne=Math.max(0,.25-j.depth)):ne=re=Q?.2:0,U=stretchy_encloseSpan(j,W,re,ne,B),/fbox|boxed|fcolorbox/.test(W)?(U.style.borderStyle="solid",U.style.borderWidth=makeEm(oe)):"angl"===W&&.049!==oe&&(U.style.borderTopWidth=makeEm(oe),U.style.borderRightWidth=makeEm(oe)),K=j.depth+ne,O.backgroundColor&&(U.style.backgroundColor=O.backgroundColor,O.borderColor&&(U.style.borderColor=O.borderColor))}if(O.backgroundColor)q=Zg.makeVList({positionType:"individualShift",children:[{type:"elem",elem:U,shift:K},{type:"elem",elem:j,shift:0}]},B);else{var ae=/cancel|phase/.test(W)?["svg-align"]:[];q=Zg.makeVList({positionType:"individualShift",children:[{type:"elem",elem:j,shift:0},{type:"elem",elem:U,shift:K,wrapperClasses:ae}]},B)}return/cancel/.test(W)&&(q.height=j.height,q.depth=j.depth),/cancel/.test(W)&&!Q?Zg.makeSpan(["mord","cancel-lap"],[q],B):Zg.makeSpan(["mord"],[q],B)},mathmlBuilder$6=(O,B)=>{var U=0,G=new mf.MathNode(O.label.indexOf("colorbox")>-1?"mpadded":"menclose",[buildGroup(O.body,B)]);switch(O.label){case"\\cancel":G.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":G.setAttribute("notation","downdiagonalstrike");break;case"\\phase":G.setAttribute("notation","phasorangle");break;case"\\sout":G.setAttribute("notation","horizontalstrike");break;case"\\fbox":G.setAttribute("notation","box");break;case"\\angl":G.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(U=B.fontMetrics().fboxsep*B.fontMetrics().ptPerEm,G.setAttribute("width","+"+2*U+"pt"),G.setAttribute("height","+"+2*U+"pt"),G.setAttribute("lspace",U+"pt"),G.setAttribute("voffset",U+"pt"),"\\fcolorbox"===O.label){var q=Math.max(B.fontMetrics().fboxrule,B.minRuleThickness);G.setAttribute("style","border: "+q+"em solid "+String(O.borderColor))}break;case"\\xcancel":G.setAttribute("notation","updiagonalstrike downdiagonalstrike")}return O.backgroundColor&&G.setAttribute("mathbackground",O.backgroundColor),G};defineFunction({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(O,B,U){var{parser:G,funcName:q}=O,j=assertNodeType(B[0],"color-token").color,W=B[1];return{type:"enclose",mode:G.mode,label:q,backgroundColor:j,body:W}},htmlBuilder:htmlBuilder$7,mathmlBuilder:mathmlBuilder$6}),defineFunction({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(O,B,U){var{parser:G,funcName:q}=O,j=assertNodeType(B[0],"color-token").color,W=assertNodeType(B[1],"color-token").color,Y=B[2];return{type:"enclose",mode:G.mode,label:q,backgroundColor:W,borderColor:j,body:Y}},htmlBuilder:htmlBuilder$7,mathmlBuilder:mathmlBuilder$6}),defineFunction({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(O,B){var{parser:U}=O;return{type:"enclose",mode:U.mode,label:"\\fbox",body:B[0]}}}),defineFunction({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(O,B){var{parser:U,funcName:G}=O,q=B[0];return{type:"enclose",mode:U.mode,label:G,body:q}},htmlBuilder:htmlBuilder$7,mathmlBuilder:mathmlBuilder$6}),defineFunction({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(O,B){var{parser:U}=O;return{type:"enclose",mode:U.mode,label:"\\angl",body:B[0]}}});var Df={};function defineEnvironment(O){for(var{type:B,names:U,props:G,handler:q,htmlBuilder:j,mathmlBuilder:W}=O,Y={type:B,numArgs:G.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:q},K=0;K<U.length;++K)Df[U[K]]=Y;j&&(of[B]=j),W&&(af[B]=W)}var Lf={};function defineMacro(O,B){Lf[O]=B}function getHLines(O){var B=[];O.consumeSpaces();var U=O.fetch().text;for("\\relax"===U&&(O.consume(),O.consumeSpaces(),U=O.fetch().text);"\\hline"===U||"\\hdashline"===U;)O.consume(),B.push("\\hdashline"===U),O.consumeSpaces(),U=O.fetch().text;return B}var validateAmsEnvironmentContext=O=>{if(!O.parser.settings.displayMode)throw new ParseError("{"+O.envName+"} can be used only in display mode.")};function getAutoTag(O){if(-1===O.indexOf("ed"))return-1===O.indexOf("*")}function parseArray(O,B,U){var{hskipBeforeAndAfter:G,addJot:q,cols:j,arraystretch:W,colSeparationType:Y,autoTag:K,singleRow:Q,emptySingleRow:Z,maxNumCols:X,leqno:J}=B;if(O.gullet.beginGroup(),Q||O.gullet.macros.set("\\cr","\\\\\\relax"),!W){var ee=O.gullet.expandMacroAsText("\\arraystretch");if(null==ee)W=1;else if(!(W=parseFloat(ee))||W<0)throw new ParseError("Invalid \\arraystretch: "+ee)}O.gullet.beginGroup();var te=[],ie=[te],re=[],ne=[],oe=null!=K?[]:void 0;function beginRow(){K&&O.gullet.macros.set("\\@eqnsw","1",!0)}function endRow(){oe&&(O.gullet.macros.get("\\df@tag")?(oe.push(O.subparse([new Token("\\df@tag")])),O.gullet.macros.set("\\df@tag",void 0,!0)):oe.push(Boolean(K)&&"1"===O.gullet.macros.get("\\@eqnsw")))}for(beginRow(),ne.push(getHLines(O));;){var ae=O.parseExpression(!1,Q?"\\end":"\\\\");O.gullet.endGroup(),O.gullet.beginGroup(),ae={type:"ordgroup",mode:O.mode,body:ae},U&&(ae={type:"styling",mode:O.mode,style:U,body:[ae]}),te.push(ae);var se=O.fetch().text;if("&"===se){if(X&&te.length===X){if(Q||Y)throw new ParseError("Too many tab characters: &",O.nextToken);O.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}O.consume()}else{if("\\end"===se){endRow(),1===te.length&&"styling"===ae.type&&0===ae.body[0].body.length&&(ie.length>1||!Z)&&ie.pop(),ne.length<ie.length+1&&ne.push([]);break}if("\\\\"!==se)throw new ParseError("Expected & or \\\\ or \\cr or \\end",O.nextToken);O.consume();var le=void 0;" "!==O.gullet.future().text&&(le=O.parseSizeGroup(!0)),re.push(le?le.value:null),endRow(),ne.push(getHLines(O)),te=[],ie.push(te),beginRow()}}return O.gullet.endGroup(),O.gullet.endGroup(),{type:"array",mode:O.mode,addJot:q,arraystretch:W,body:ie,cols:j,rowGaps:re,hskipBeforeAndAfter:G,hLinesBeforeRow:ne,colSeparationType:Y,tags:oe,leqno:J}}function dCellStyle(O){return"d"===O.slice(0,1)?"display":"text"}var htmlBuilder$6=function(O,B){var U,G,q=O.body.length,j=O.hLinesBeforeRow,W=0,Y=new Array(q),K=[],Q=Math.max(B.fontMetrics().arrayRuleWidth,B.minRuleThickness),Z=1/B.fontMetrics().ptPerEm,X=5*Z;O.colSeparationType&&"small"===O.colSeparationType&&(X=B.havingStyle(Zm.SCRIPT).sizeMultiplier/B.sizeMultiplier*.2778);var J="CD"===O.colSeparationType?calculateSize({number:3,unit:"ex"},B):12*Z,ee=3*Z,te=O.arraystretch*J,ie=.7*te,re=.3*te,ne=0;function setHLinePos(O){for(var B=0;B<O.length;++B)B>0&&(ne+=.25),K.push({pos:ne,isDashed:O[B]})}for(setHLinePos(j[0]),U=0;U<O.body.length;++U){var oe=O.body[U],ae=ie,se=re;W<oe.length&&(W=oe.length);var le=new Array(oe.length);for(G=0;G<oe.length;++G){var ce=buildGroup$1(oe[G],B);se<ce.depth&&(se=ce.depth),ae<ce.height&&(ae=ce.height),le[G]=ce}var de=O.rowGaps[U],pe=0;de&&(pe=calculateSize(de,B))>0&&(se<(pe+=re)&&(se=pe),pe=0),O.addJot&&(se+=ee),le.height=ae,le.depth=se,ne+=ae,le.pos=ne,ne+=se+pe,Y[U]=le,setHLinePos(j[U+1])}var ue,he,me=ne/2+B.fontMetrics().axisHeight,ge=O.cols||[],fe=[],ye=[];if(O.tags&&O.tags.some((O=>O)))for(U=0;U<q;++U){var _e=Y[U],ve=_e.pos-me,be=O.tags[U],Se=void 0;(Se=!0===be?Zg.makeSpan(["eqn-num"],[],B):!1===be?Zg.makeSpan([],[],B):Zg.makeSpan([],buildExpression$1(be,B,!0),B)).depth=_e.depth,Se.height=_e.height,ye.push({type:"elem",elem:Se,shift:ve})}for(G=0,he=0;G<W||he<ge.length;++G,++he){for(var Ce=ge[he]||{},Ee=!0;"separator"===Ce.type;){if(Ee||((ue=Zg.makeSpan(["arraycolsep"],[])).style.width=makeEm(B.fontMetrics().doubleRuleSep),fe.push(ue)),"|"!==Ce.separator&&":"!==Ce.separator)throw new ParseError("Invalid separator type: "+Ce.separator);var xe="|"===Ce.separator?"solid":"dashed",Te=Zg.makeSpan(["vertical-separator"],[],B);Te.style.height=makeEm(ne),Te.style.borderRightWidth=makeEm(Q),Te.style.borderRightStyle=xe,Te.style.margin="0 "+makeEm(-Q/2);var we=ne-me;we&&(Te.style.verticalAlign=makeEm(-we)),fe.push(Te),Ce=ge[++he]||{},Ee=!1}if(!(G>=W)){var ke=void 0;(G>0||O.hskipBeforeAndAfter)&&0!==(ke=Vm.deflt(Ce.pregap,X))&&((ue=Zg.makeSpan(["arraycolsep"],[])).style.width=makeEm(ke),fe.push(ue));var Ae=[];for(U=0;U<q;++U){var Re=Y[U],Ie=Re[G];if(Ie){var Pe=Re.pos-me;Ie.depth=Re.depth,Ie.height=Re.height,Ae.push({type:"elem",elem:Ie,shift:Pe})}}Ae=Zg.makeVList({positionType:"individualShift",children:Ae},B),Ae=Zg.makeSpan(["col-align-"+(Ce.align||"c")],[Ae]),fe.push(Ae),(G<W-1||O.hskipBeforeAndAfter)&&0!==(ke=Vm.deflt(Ce.postgap,X))&&((ue=Zg.makeSpan(["arraycolsep"],[])).style.width=makeEm(ke),fe.push(ue))}}if(Y=Zg.makeSpan(["mtable"],fe),K.length>0){for(var Ne=Zg.makeLineSpan("hline",B,Q),Oe=Zg.makeLineSpan("hdashline",B,Q),Me=[{type:"elem",elem:Y,shift:0}];K.length>0;){var De=K.pop(),Le=De.pos-me;De.isDashed?Me.push({type:"elem",elem:Oe,shift:Le}):Me.push({type:"elem",elem:Ne,shift:Le})}Y=Zg.makeVList({positionType:"individualShift",children:Me},B)}if(0===ye.length)return Zg.makeSpan(["mord"],[Y],B);var Be=Zg.makeVList({positionType:"individualShift",children:ye},B);return Be=Zg.makeSpan(["tag"],[Be],B),Zg.makeFragment([Y,Be])},Bf={c:"center ",l:"left ",r:"right "},mathmlBuilder$5=function(O,B){for(var U=[],G=new mf.MathNode("mtd",[],["mtr-glue"]),q=new mf.MathNode("mtd",[],["mml-eqn-num"]),j=0;j<O.body.length;j++){for(var W=O.body[j],Y=[],K=0;K<W.length;K++)Y.push(new mf.MathNode("mtd",[buildGroup(W[K],B)]));O.tags&&O.tags[j]&&(Y.unshift(G),Y.push(G),O.leqno?Y.unshift(q):Y.push(q)),U.push(new mf.MathNode("mtr",Y))}var Q=new mf.MathNode("mtable",U),Z=.5===O.arraystretch?.1:.16+O.arraystretch-1+(O.addJot?.09:0);Q.setAttribute("rowspacing",makeEm(Z));var X="",J="";if(O.cols&&O.cols.length>0){var ee=O.cols,te="",ie=!1,re=0,ne=ee.length;"separator"===ee[0].type&&(X+="top ",re=1),"separator"===ee[ee.length-1].type&&(X+="bottom ",ne-=1);for(var oe=re;oe<ne;oe++)"align"===ee[oe].type?(J+=Bf[ee[oe].align],ie&&(te+="none "),ie=!0):"separator"===ee[oe].type&&ie&&(te+="|"===ee[oe].separator?"solid ":"dashed ",ie=!1);Q.setAttribute("columnalign",J.trim()),/[sd]/.test(te)&&Q.setAttribute("columnlines",te.trim())}if("align"===O.colSeparationType){for(var ae=O.cols||[],se="",le=1;le<ae.length;le++)se+=le%2?"0em ":"1em ";Q.setAttribute("columnspacing",se.trim())}else"alignat"===O.colSeparationType||"gather"===O.colSeparationType?Q.setAttribute("columnspacing","0em"):"small"===O.colSeparationType?Q.setAttribute("columnspacing","0.2778em"):"CD"===O.colSeparationType?Q.setAttribute("columnspacing","0.5em"):Q.setAttribute("columnspacing","1em");var ce="",de=O.hLinesBeforeRow;X+=de[0].length>0?"left ":"",X+=de[de.length-1].length>0?"right ":"";for(var pe=1;pe<de.length-1;pe++)ce+=0===de[pe].length?"none ":de[pe][0]?"dashed ":"solid ";return/[sd]/.test(ce)&&Q.setAttribute("rowlines",ce.trim()),""!==X&&(Q=new mf.MathNode("menclose",[Q])).setAttribute("notation",X.trim()),O.arraystretch&&O.arraystretch<1&&(Q=new mf.MathNode("mstyle",[Q])).setAttribute("scriptlevel","1"),Q},alignedHandler=function(O,B){-1===O.envName.indexOf("ed")&&validateAmsEnvironmentContext(O);var U,G=[],q=O.envName.indexOf("at")>-1?"alignat":"align",j="split"===O.envName,W=parseArray(O.parser,{cols:G,addJot:!0,autoTag:j?void 0:getAutoTag(O.envName),emptySingleRow:!0,colSeparationType:q,maxNumCols:j?2:void 0,leqno:O.parser.settings.leqno},"display"),Y=0,K={type:"ordgroup",mode:O.mode,body:[]};if(B[0]&&"ordgroup"===B[0].type){for(var Q="",Z=0;Z<B[0].body.length;Z++){Q+=assertNodeType(B[0].body[Z],"textord").text}U=Number(Q),Y=2*U}var X=!Y;W.body.forEach((function(O){for(var B=1;B<O.length;B+=2){var G=assertNodeType(O[B],"styling");assertNodeType(G.body[0],"ordgroup").body.unshift(K)}if(X)Y<O.length&&(Y=O.length);else{var q=O.length/2;if(U<q)throw new ParseError("Too many math in a row: expected "+U+", but got "+q,O[0])}}));for(var J=0;J<Y;++J){var ee="r",te=0;J%2==1?ee="l":J>0&&X&&(te=1),G[J]={type:"align",align:ee,pregap:te,postgap:0}}return W.colSeparationType=X?"align":"alignat",W};defineEnvironment({type:"array",names:["array","darray"],props:{numArgs:1},handler(O,B){var U=(checkSymbolNodeType(B[0])?[B[0]]:assertNodeType(B[0],"ordgroup").body).map((function(O){var B=assertSymbolNodeType(O).text;if(-1!=="lcr".indexOf(B))return{type:"align",align:B};if("|"===B)return{type:"separator",separator:"|"};if(":"===B)return{type:"separator",separator:":"};throw new ParseError("Unknown column alignment: "+B,O)})),G={cols:U,hskipBeforeAndAfter:!0,maxNumCols:U.length};return parseArray(O.parser,G,dCellStyle(O.envName))},htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(O){var B={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[O.envName.replace("*","")],U="c",G={hskipBeforeAndAfter:!1,cols:[{type:"align",align:U}]};if("*"===O.envName.charAt(O.envName.length-1)){var q=O.parser;if(q.consumeSpaces(),"["===q.fetch().text){if(q.consume(),q.consumeSpaces(),U=q.fetch().text,-1==="lcr".indexOf(U))throw new ParseError("Expected l or c or r",q.nextToken);q.consume(),q.consumeSpaces(),q.expect("]"),q.consume(),G.cols=[{type:"align",align:U}]}}var j=parseArray(O.parser,G,dCellStyle(O.envName)),W=Math.max(0,...j.body.map((O=>O.length)));return j.cols=new Array(W).fill({type:"align",align:U}),B?{type:"leftright",mode:O.mode,body:[j],left:B[0],right:B[1],rightColor:void 0}:j},htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(O){var B=parseArray(O.parser,{arraystretch:.5},"script");return B.colSeparationType="small",B},htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["subarray"],props:{numArgs:1},handler(O,B){var U=(checkSymbolNodeType(B[0])?[B[0]]:assertNodeType(B[0],"ordgroup").body).map((function(O){var B=assertSymbolNodeType(O).text;if(-1!=="lc".indexOf(B))return{type:"align",align:B};throw new ParseError("Unknown column alignment: "+B,O)}));if(U.length>1)throw new ParseError("{subarray} can contain only one column");var G={cols:U,hskipBeforeAndAfter:!1,arraystretch:.5};if((G=parseArray(O.parser,G,"script")).body.length>0&&G.body[0].length>1)throw new ParseError("{subarray} can contain only one column");return G},htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(O){var B=parseArray(O.parser,{arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},dCellStyle(O.envName));return{type:"leftright",mode:O.mode,body:[B],left:O.envName.indexOf("r")>-1?".":"\\{",right:O.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:alignedHandler,htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(O){Vm.contains(["gather","gather*"],O.envName)&&validateAmsEnvironmentContext(O);var B={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:getAutoTag(O.envName),emptySingleRow:!0,leqno:O.parser.settings.leqno};return parseArray(O.parser,B,"display")},htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:alignedHandler,htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(O){validateAmsEnvironmentContext(O);var B={autoTag:getAutoTag(O.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:O.parser.settings.leqno};return parseArray(O.parser,B,"display")},htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineEnvironment({type:"array",names:["CD"],props:{numArgs:0},handler:O=>(validateAmsEnvironmentContext(O),function(O){var B=[];for(O.gullet.beginGroup(),O.gullet.macros.set("\\cr","\\\\\\relax"),O.gullet.beginGroup();;){B.push(O.parseExpression(!1,"\\\\")),O.gullet.endGroup(),O.gullet.beginGroup();var U=O.fetch().text;if("&"!==U&&"\\\\"!==U){if("\\end"===U){0===B[B.length-1].length&&B.pop();break}throw new ParseError("Expected \\\\ or \\cr or \\end",O.nextToken)}O.consume()}for(var G=[],q=[G],j=0;j<B.length;j++){for(var W=B[j],Y={type:"styling",body:[],mode:"math",style:"display"},K=0;K<W.length;K++)if(isStartOfArrow(W[K])){G.push(Y);var Q=assertSymbolNodeType(W[K+=1]).text,Z=new Array(2);if(Z[0]={type:"ordgroup",mode:"math",body:[]},Z[1]={type:"ordgroup",mode:"math",body:[]},"=|.".indexOf(Q)>-1);else{if(!("<>AV".indexOf(Q)>-1))throw new ParseError('Expected one of "<>AV=|." after @',W[K]);for(var X=0;X<2;X++){for(var J=!0,ee=K+1;ee<W.length;ee++){if(isLabelEnd(W[ee],Q)){J=!1,K=ee;break}if(isStartOfArrow(W[ee]))throw new ParseError("Missing a "+Q+" character to complete a CD arrow.",W[ee]);Z[X].body.push(W[ee])}if(J)throw new ParseError("Missing a "+Q+" character to complete a CD arrow.",W[K])}}var te={type:"styling",body:[cdArrow(Q,Z,O)],mode:"math",style:"display"};G.push(te),Y={type:"styling",body:[],mode:"math",style:"display"}}else Y.body.push(W[K]);j%2==0?G.push(Y):G.shift(),G=[],q.push(G)}return O.gullet.endGroup(),O.gullet.endGroup(),{type:"array",mode:"math",body:q,arraystretch:1,addJot:!0,rowGaps:[null],cols:new Array(q[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25}),colSeparationType:"CD",hLinesBeforeRow:new Array(q.length+1).fill([])}}(O.parser)),htmlBuilder:htmlBuilder$6,mathmlBuilder:mathmlBuilder$5}),defineMacro("\\nonumber","\\gdef\\@eqnsw{0}"),defineMacro("\\notag","\\nonumber"),defineFunction({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(O,B){throw new ParseError(O.funcName+" valid only within array environment")}});var Ff=Df;defineFunction({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(O,B){var{parser:U,funcName:G}=O,q=B[0];if("ordgroup"!==q.type)throw new ParseError("Invalid environment name",q);for(var j="",W=0;W<q.body.length;++W)j+=assertNodeType(q.body[W],"textord").text;if("\\begin"===G){if(!Ff.hasOwnProperty(j))throw new ParseError("No such environment: "+j,q);var Y=Ff[j],{args:K,optArgs:Q}=U.parseArguments("\\begin{"+j+"}",Y),Z={mode:U.mode,envName:j,parser:U},X=Y.handler(Z,K,Q);U.expect("\\end",!1);var J=U.nextToken,ee=assertNodeType(U.parseFunction(),"environment");if(ee.name!==j)throw new ParseError("Mismatch: \\begin{"+j+"} matched by \\end{"+ee.name+"}",J);return X}return{type:"environment",mode:U.mode,name:j,nameGroup:q}}});var htmlBuilder$5=(O,B)=>{var U=O.font,G=B.withFont(U);return buildGroup$1(O.body,G)},mathmlBuilder$4=(O,B)=>{var U=O.font,G=B.withFont(U);return buildGroup(O.body,G)},zf={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};defineFunction({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(O,B)=>{var{parser:U,funcName:G}=O,q=normalizeArgument(B[0]),j=G;return j in zf&&(j=zf[j]),{type:"font",mode:U.mode,font:j.slice(1),body:q}},htmlBuilder:htmlBuilder$5,mathmlBuilder:mathmlBuilder$4}),defineFunction({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(O,B)=>{var{parser:U}=O,G=B[0],q=Vm.isCharacterBox(G);return{type:"mclass",mode:U.mode,mclass:binrelClass(G),body:[{type:"font",mode:U.mode,font:"boldsymbol",body:G}],isCharacterBox:q}}}),defineFunction({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(O,B)=>{var{parser:U,funcName:G,breakOnTokenText:q}=O,{mode:j}=U,W=U.parseExpression(!0,q);return{type:"font",mode:j,font:"math"+G.slice(1),body:{type:"ordgroup",mode:U.mode,body:W}}},htmlBuilder:htmlBuilder$5,mathmlBuilder:mathmlBuilder$4});var adjustStyle=(O,B)=>{var U=B;return"display"===O?U=U.id>=Zm.SCRIPT.id?U.text():Zm.DISPLAY:"text"===O&&U.size===Zm.DISPLAY.size?U=Zm.TEXT:"script"===O?U=Zm.SCRIPT:"scriptscript"===O&&(U=Zm.SCRIPTSCRIPT),U},htmlBuilder$4=(O,B)=>{var U,G=adjustStyle(O.size,B.style),q=G.fracNum(),j=G.fracDen();U=B.havingStyle(q);var W=buildGroup$1(O.numer,U,B);if(O.continued){var Y=8.5/B.fontMetrics().ptPerEm,K=3.5/B.fontMetrics().ptPerEm;W.height=W.height<Y?Y:W.height,W.depth=W.depth<K?K:W.depth}U=B.havingStyle(j);var Q,Z,X,J,ee,te,ie,re,ne,oe,ae=buildGroup$1(O.denom,U,B);if(O.hasBarLine?(O.barSize?(Z=calculateSize(O.barSize,B),Q=Zg.makeLineSpan("frac-line",B,Z)):Q=Zg.makeLineSpan("frac-line",B),Z=Q.height,X=Q.height):(Q=null,Z=0,X=B.fontMetrics().defaultRuleThickness),G.size===Zm.DISPLAY.size||"display"===O.size?(J=B.fontMetrics().num1,ee=Z>0?3*X:7*X,te=B.fontMetrics().denom1):(Z>0?(J=B.fontMetrics().num2,ee=X):(J=B.fontMetrics().num3,ee=3*X),te=B.fontMetrics().denom2),Q){var se=B.fontMetrics().axisHeight;J-W.depth-(se+.5*Z)<ee&&(J+=ee-(J-W.depth-(se+.5*Z))),se-.5*Z-(ae.height-te)<ee&&(te+=ee-(se-.5*Z-(ae.height-te)));var le=-(se-.5*Z);ie=Zg.makeVList({positionType:"individualShift",children:[{type:"elem",elem:ae,shift:te},{type:"elem",elem:Q,shift:le},{type:"elem",elem:W,shift:-J}]},B)}else{var ce=J-W.depth-(ae.height-te);ce<ee&&(J+=.5*(ee-ce),te+=.5*(ee-ce)),ie=Zg.makeVList({positionType:"individualShift",children:[{type:"elem",elem:ae,shift:te},{type:"elem",elem:W,shift:-J}]},B)}return U=B.havingStyle(G),ie.height*=U.sizeMultiplier/B.sizeMultiplier,ie.depth*=U.sizeMultiplier/B.sizeMultiplier,re=G.size===Zm.DISPLAY.size?B.fontMetrics().delim1:G.size===Zm.SCRIPTSCRIPT.size?B.havingStyle(Zm.SCRIPT).fontMetrics().delim2:B.fontMetrics().delim2,ne=null==O.leftDelim?makeNullDelimiter(B,["mopen"]):Nf.customSizedDelim(O.leftDelim,re,!0,B.havingStyle(G),O.mode,["mopen"]),oe=O.continued?Zg.makeSpan([]):null==O.rightDelim?makeNullDelimiter(B,["mclose"]):Nf.customSizedDelim(O.rightDelim,re,!0,B.havingStyle(G),O.mode,["mclose"]),Zg.makeSpan(["mord"].concat(U.sizingClasses(B)),[ne,Zg.makeSpan(["mfrac"],[ie]),oe],B)},mathmlBuilder$3=(O,B)=>{var U=new mf.MathNode("mfrac",[buildGroup(O.numer,B),buildGroup(O.denom,B)]);if(O.hasBarLine){if(O.barSize){var G=calculateSize(O.barSize,B);U.setAttribute("linethickness",makeEm(G))}}else U.setAttribute("linethickness","0px");var q=adjustStyle(O.size,B.style);if(q.size!==B.style.size){U=new mf.MathNode("mstyle",[U]);var j=q.size===Zm.DISPLAY.size?"true":"false";U.setAttribute("displaystyle",j),U.setAttribute("scriptlevel","0")}if(null!=O.leftDelim||null!=O.rightDelim){var W=[];if(null!=O.leftDelim){var Y=new mf.MathNode("mo",[new mf.TextNode(O.leftDelim.replace("\\",""))]);Y.setAttribute("fence","true"),W.push(Y)}if(W.push(U),null!=O.rightDelim){var K=new mf.MathNode("mo",[new mf.TextNode(O.rightDelim.replace("\\",""))]);K.setAttribute("fence","true"),W.push(K)}return makeRow(W)}return U};defineFunction({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(O,B)=>{var U,{parser:G,funcName:q}=O,j=B[0],W=B[1],Y=null,K=null,Q="auto";switch(q){case"\\dfrac":case"\\frac":case"\\tfrac":U=!0;break;case"\\\\atopfrac":U=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":U=!1,Y="(",K=")";break;case"\\\\bracefrac":U=!1,Y="\\{",K="\\}";break;case"\\\\brackfrac":U=!1,Y="[",K="]";break;default:throw new Error("Unrecognized genfrac command")}switch(q){case"\\dfrac":case"\\dbinom":Q="display";break;case"\\tfrac":case"\\tbinom":Q="text"}return{type:"genfrac",mode:G.mode,continued:!1,numer:j,denom:W,hasBarLine:U,leftDelim:Y,rightDelim:K,size:Q,barSize:null}},htmlBuilder:htmlBuilder$4,mathmlBuilder:mathmlBuilder$3}),defineFunction({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(O,B)=>{var{parser:U,funcName:G}=O,q=B[0],j=B[1];return{type:"genfrac",mode:U.mode,continued:!0,numer:q,denom:j,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}}),defineFunction({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(O){var B,{parser:U,funcName:G,token:q}=O;switch(G){case"\\over":B="\\frac";break;case"\\choose":B="\\binom";break;case"\\atop":B="\\\\atopfrac";break;case"\\brace":B="\\\\bracefrac";break;case"\\brack":B="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:U.mode,replaceWith:B,token:q}}});var $f=["display","text","script","scriptscript"],delimFromValue=function(O){var B=null;return O.length>0&&(B="."===(B=O)?null:B),B};defineFunction({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(O,B){var U,{parser:G}=O,q=B[4],j=B[5],W=normalizeArgument(B[0]),Y="atom"===W.type&&"open"===W.family?delimFromValue(W.text):null,K=normalizeArgument(B[1]),Q="atom"===K.type&&"close"===K.family?delimFromValue(K.text):null,Z=assertNodeType(B[2],"size"),X=null;U=!!Z.isBlank||(X=Z.value).number>0;var J="auto",ee=B[3];if("ordgroup"===ee.type){if(ee.body.length>0){var te=assertNodeType(ee.body[0],"textord");J=$f[Number(te.text)]}}else ee=assertNodeType(ee,"textord"),J=$f[Number(ee.text)];return{type:"genfrac",mode:G.mode,numer:q,denom:j,continued:!1,hasBarLine:U,barSize:X,leftDelim:Y,rightDelim:Q,size:J}},htmlBuilder:htmlBuilder$4,mathmlBuilder:mathmlBuilder$3}),defineFunction({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(O,B){var{parser:U,funcName:G,token:q}=O;return{type:"infix",mode:U.mode,replaceWith:"\\\\abovefrac",size:assertNodeType(B[0],"size").value,token:q}}}),defineFunction({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(O,B)=>{var{parser:U,funcName:G}=O,q=B[0],j=function(O){if(!O)throw new Error("Expected non-null, but got "+String(O));return O}(assertNodeType(B[1],"infix").size),W=B[2],Y=j.number>0;return{type:"genfrac",mode:U.mode,numer:q,denom:W,continued:!1,hasBarLine:Y,barSize:j,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:htmlBuilder$4,mathmlBuilder:mathmlBuilder$3});var htmlBuilder$3=(O,B)=>{var U,G,q=B.style;"supsub"===O.type?(U=O.sup?buildGroup$1(O.sup,B.havingStyle(q.sup()),B):buildGroup$1(O.sub,B.havingStyle(q.sub()),B),G=assertNodeType(O.base,"horizBrace")):G=assertNodeType(O,"horizBrace");var j,W=buildGroup$1(G.base,B.havingBaseStyle(Zm.DISPLAY)),Y=stretchy_svgSpan(G,B);if(G.isOver?(j=Zg.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:W},{type:"kern",size:.1},{type:"elem",elem:Y}]},B)).children[0].children[0].children[1].classes.push("svg-align"):(j=Zg.makeVList({positionType:"bottom",positionData:W.depth+.1+Y.height,children:[{type:"elem",elem:Y},{type:"kern",size:.1},{type:"elem",elem:W}]},B)).children[0].children[0].children[0].classes.push("svg-align"),U){var K=Zg.makeSpan(["mord",G.isOver?"mover":"munder"],[j],B);j=G.isOver?Zg.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:K},{type:"kern",size:.2},{type:"elem",elem:U}]},B):Zg.makeVList({positionType:"bottom",positionData:K.depth+.2+U.height+U.depth,children:[{type:"elem",elem:U},{type:"kern",size:.2},{type:"elem",elem:K}]},B)}return Zg.makeSpan(["mord",G.isOver?"mover":"munder"],[j],B)};defineFunction({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(O,B){var{parser:U,funcName:G}=O;return{type:"horizBrace",mode:U.mode,label:G,isOver:/^\\over/.test(G),base:B[0]}},htmlBuilder:htmlBuilder$3,mathmlBuilder:(O,B)=>{var U=stretchy_mathMLnode(O.label);return new mf.MathNode(O.isOver?"mover":"munder",[buildGroup(O.base,B),U])}}),defineFunction({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(O,B)=>{var{parser:U}=O,G=B[1],q=assertNodeType(B[0],"url").url;return U.settings.isTrusted({command:"\\href",url:q})?{type:"href",mode:U.mode,href:q,body:ordargument(G)}:U.formatUnsupportedCmd("\\href")},htmlBuilder:(O,B)=>{var U=buildExpression$1(O.body,B,!1);return Zg.makeAnchor(O.href,[],U,B)},mathmlBuilder:(O,B)=>{var U=buildExpressionRow(O.body,B);return U instanceof MathNode||(U=new MathNode("mrow",[U])),U.setAttribute("href",O.href),U}}),defineFunction({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(O,B)=>{var{parser:U}=O,G=assertNodeType(B[0],"url").url;if(!U.settings.isTrusted({command:"\\url",url:G}))return U.formatUnsupportedCmd("\\url");for(var q=[],j=0;j<G.length;j++){var W=G[j];"~"===W&&(W="\\textasciitilde"),q.push({type:"textord",mode:"text",text:W})}var Y={type:"text",mode:U.mode,font:"\\texttt",body:q};return{type:"href",mode:U.mode,href:G,body:ordargument(Y)}}}),defineFunction({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(O,B){var{parser:U}=O;return{type:"hbox",mode:U.mode,body:ordargument(B[0])}},htmlBuilder(O,B){var U=buildExpression$1(O.body,B,!1);return Zg.makeFragment(U)},mathmlBuilder:(O,B)=>new mf.MathNode("mrow",buildExpression(O.body,B))}),defineFunction({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(O,B)=>{var U,{parser:G,funcName:q,token:j}=O,W=assertNodeType(B[0],"raw").string,Y=B[1];G.settings.strict&&G.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var K={};switch(q){case"\\htmlClass":K.class=W,U={command:"\\htmlClass",class:W};break;case"\\htmlId":K.id=W,U={command:"\\htmlId",id:W};break;case"\\htmlStyle":K.style=W,U={command:"\\htmlStyle",style:W};break;case"\\htmlData":for(var Q=W.split(","),Z=0;Z<Q.length;Z++){var X=Q[Z].split("=");if(2!==X.length)throw new ParseError("Error parsing key-value for \\htmlData");K["data-"+X[0].trim()]=X[1].trim()}U={command:"\\htmlData",attributes:K};break;default:throw new Error("Unrecognized html command")}return G.settings.isTrusted(U)?{type:"html",mode:G.mode,attributes:K,body:ordargument(Y)}:G.formatUnsupportedCmd(q)},htmlBuilder:(O,B)=>{var U=buildExpression$1(O.body,B,!1),G=["enclosing"];O.attributes.class&&G.push(...O.attributes.class.trim().split(/\s+/));var q=Zg.makeSpan(G,U,B);for(var j in O.attributes)"class"!==j&&O.attributes.hasOwnProperty(j)&&q.setAttribute(j,O.attributes[j]);return q},mathmlBuilder:(O,B)=>buildExpressionRow(O.body,B)}),defineFunction({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(O,B)=>{var{parser:U}=O;return{type:"htmlmathml",mode:U.mode,html:ordargument(B[0]),mathml:ordargument(B[1])}},htmlBuilder:(O,B)=>{var U=buildExpression$1(O.html,B,!1);return Zg.makeFragment(U)},mathmlBuilder:(O,B)=>buildExpressionRow(O.mathml,B)});var sizeData=function(O){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(O))return{number:+O,unit:"bp"};var B=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(O);if(!B)throw new ParseError("Invalid size: '"+O+"' in \\includegraphics");var U={number:+(B[1]+B[2]),unit:B[3]};if(!validUnit(U))throw new ParseError("Invalid unit: '"+U.unit+"' in \\includegraphics.");return U};defineFunction({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(O,B,U)=>{var{parser:G}=O,q={number:0,unit:"em"},j={number:.9,unit:"em"},W={number:0,unit:"em"},Y="";if(U[0])for(var K=assertNodeType(U[0],"raw").string.split(","),Q=0;Q<K.length;Q++){var Z=K[Q].split("=");if(2===Z.length){var X=Z[1].trim();switch(Z[0].trim()){case"alt":Y=X;break;case"width":q=sizeData(X);break;case"height":j=sizeData(X);break;case"totalheight":W=sizeData(X);break;default:throw new ParseError("Invalid key: '"+Z[0]+"' in \\includegraphics.")}}}var J=assertNodeType(B[0],"url").url;return""===Y&&(Y=(Y=(Y=J).replace(/^.*[\\/]/,"")).substring(0,Y.lastIndexOf("."))),G.settings.isTrusted({command:"\\includegraphics",url:J})?{type:"includegraphics",mode:G.mode,alt:Y,width:q,height:j,totalheight:W,src:J}:G.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(O,B)=>{var U=calculateSize(O.height,B),G=0;O.totalheight.number>0&&(G=calculateSize(O.totalheight,B)-U);var q=0;O.width.number>0&&(q=calculateSize(O.width,B));var j={height:makeEm(U+G)};q>0&&(j.width=makeEm(q)),G>0&&(j.verticalAlign=makeEm(-G));var W=new Img(O.src,O.alt,j);return W.height=U,W.depth=G,W},mathmlBuilder:(O,B)=>{var U=new mf.MathNode("mglyph",[]);U.setAttribute("alt",O.alt);var G=calculateSize(O.height,B),q=0;if(O.totalheight.number>0&&(q=calculateSize(O.totalheight,B)-G,U.setAttribute("valign",makeEm(-q))),U.setAttribute("height",makeEm(G+q)),O.width.number>0){var j=calculateSize(O.width,B);U.setAttribute("width",makeEm(j))}return U.setAttribute("src",O.src),U}}),defineFunction({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(O,B){var{parser:U,funcName:G}=O,q=assertNodeType(B[0],"size");if(U.settings.strict){var j="m"===G[1],W="mu"===q.value.unit;j?(W||U.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+G+" supports only mu units, not "+q.value.unit+" units"),"math"!==U.mode&&U.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+G+" works only in math mode")):W&&U.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+G+" doesn't support mu units")}return{type:"kern",mode:U.mode,dimension:q.value}},htmlBuilder:(O,B)=>Zg.makeGlue(O.dimension,B),mathmlBuilder(O,B){var U=calculateSize(O.dimension,B);return new mf.SpaceNode(U)}}),defineFunction({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(O,B)=>{var{parser:U,funcName:G}=O,q=B[0];return{type:"lap",mode:U.mode,alignment:G.slice(5),body:q}},htmlBuilder:(O,B)=>{var U;"clap"===O.alignment?(U=Zg.makeSpan([],[buildGroup$1(O.body,B)]),U=Zg.makeSpan(["inner"],[U],B)):U=Zg.makeSpan(["inner"],[buildGroup$1(O.body,B)]);var G=Zg.makeSpan(["fix"],[]),q=Zg.makeSpan([O.alignment],[U,G],B),j=Zg.makeSpan(["strut"]);return j.style.height=makeEm(q.height+q.depth),q.depth&&(j.style.verticalAlign=makeEm(-q.depth)),q.children.unshift(j),q=Zg.makeSpan(["thinbox"],[q],B),Zg.makeSpan(["mord","vbox"],[q],B)},mathmlBuilder:(O,B)=>{var U=new mf.MathNode("mpadded",[buildGroup(O.body,B)]);if("rlap"!==O.alignment){var G="llap"===O.alignment?"-1":"-0.5";U.setAttribute("lspace",G+"width")}return U.setAttribute("width","0px"),U}}),defineFunction({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(O,B){var{funcName:U,parser:G}=O,q=G.mode;G.switchMode("math");var j="\\("===U?"\\)":"$",W=G.parseExpression(!1,j);return G.expect(j),G.switchMode(q),{type:"styling",mode:G.mode,style:"text",body:W}}}),defineFunction({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(O,B){throw new ParseError("Mismatched "+O.funcName)}});var chooseMathStyle=(O,B)=>{switch(B.style.size){case Zm.DISPLAY.size:return O.display;case Zm.TEXT.size:return O.text;case Zm.SCRIPT.size:return O.script;case Zm.SCRIPTSCRIPT.size:return O.scriptscript;default:return O.text}};defineFunction({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(O,B)=>{var{parser:U}=O;return{type:"mathchoice",mode:U.mode,display:ordargument(B[0]),text:ordargument(B[1]),script:ordargument(B[2]),scriptscript:ordargument(B[3])}},htmlBuilder:(O,B)=>{var U=chooseMathStyle(O,B),G=buildExpression$1(U,B,!1);return Zg.makeFragment(G)},mathmlBuilder:(O,B)=>{var U=chooseMathStyle(O,B);return buildExpressionRow(U,B)}});var assembleSupSub=(O,B,U,G,q,j,W)=>{O=Zg.makeSpan([],[O]);var Y,K,Q,Z=U&&Vm.isCharacterBox(U);if(B){var X=buildGroup$1(B,G.havingStyle(q.sup()),G);K={elem:X,kern:Math.max(G.fontMetrics().bigOpSpacing1,G.fontMetrics().bigOpSpacing3-X.depth)}}if(U){var J=buildGroup$1(U,G.havingStyle(q.sub()),G);Y={elem:J,kern:Math.max(G.fontMetrics().bigOpSpacing2,G.fontMetrics().bigOpSpacing4-J.height)}}if(K&&Y){var ee=G.fontMetrics().bigOpSpacing5+Y.elem.height+Y.elem.depth+Y.kern+O.depth+W;Q=Zg.makeVList({positionType:"bottom",positionData:ee,children:[{type:"kern",size:G.fontMetrics().bigOpSpacing5},{type:"elem",elem:Y.elem,marginLeft:makeEm(-j)},{type:"kern",size:Y.kern},{type:"elem",elem:O},{type:"kern",size:K.kern},{type:"elem",elem:K.elem,marginLeft:makeEm(j)},{type:"kern",size:G.fontMetrics().bigOpSpacing5}]},G)}else if(Y){var te=O.height-W;Q=Zg.makeVList({positionType:"top",positionData:te,children:[{type:"kern",size:G.fontMetrics().bigOpSpacing5},{type:"elem",elem:Y.elem,marginLeft:makeEm(-j)},{type:"kern",size:Y.kern},{type:"elem",elem:O}]},G)}else{if(!K)return O;var ie=O.depth+W;Q=Zg.makeVList({positionType:"bottom",positionData:ie,children:[{type:"elem",elem:O},{type:"kern",size:K.kern},{type:"elem",elem:K.elem,marginLeft:makeEm(j)},{type:"kern",size:G.fontMetrics().bigOpSpacing5}]},G)}var re=[Q];if(Y&&0!==j&&!Z){var ne=Zg.makeSpan(["mspace"],[],G);ne.style.marginRight=makeEm(j),re.unshift(ne)}return Zg.makeSpan(["mop","op-limits"],re,G)},Uf=["\\smallint"],htmlBuilder$2=(O,B)=>{var U,G,q,j=!1;"supsub"===O.type?(U=O.sup,G=O.sub,q=assertNodeType(O.base,"op"),j=!0):q=assertNodeType(O,"op");var W,Y=B.style,K=!1;if(Y.size===Zm.DISPLAY.size&&q.symbol&&!Vm.contains(Uf,q.name)&&(K=!0),q.symbol){var Q=K?"Size2-Regular":"Size1-Regular",Z="";if("\\oiint"!==q.name&&"\\oiiint"!==q.name||(Z=q.name.slice(1),q.name="oiint"===Z?"\\iint":"\\iiint"),W=Zg.makeSymbol(q.name,Q,"math",B,["mop","op-symbol",K?"large-op":"small-op"]),Z.length>0){var X=W.italic,J=Zg.staticSvg(Z+"Size"+(K?"2":"1"),B);W=Zg.makeVList({positionType:"individualShift",children:[{type:"elem",elem:W,shift:0},{type:"elem",elem:J,shift:K?.08:0}]},B),q.name="\\"+Z,W.classes.unshift("mop"),W.italic=X}}else if(q.body){var ee=buildExpression$1(q.body,B,!0);1===ee.length&&ee[0]instanceof SymbolNode?(W=ee[0]).classes[0]="mop":W=Zg.makeSpan(["mop"],ee,B)}else{for(var te=[],ie=1;ie<q.name.length;ie++)te.push(Zg.mathsym(q.name[ie],q.mode,B));W=Zg.makeSpan(["mop"],te,B)}var re=0,ne=0;return(W instanceof SymbolNode||"\\oiint"===q.name||"\\oiiint"===q.name)&&!q.suppressBaseShift&&(re=(W.height-W.depth)/2-B.fontMetrics().axisHeight,ne=W.italic),j?assembleSupSub(W,U,G,B,Y,ne,re):(re&&(W.style.position="relative",W.style.top=makeEm(re)),W)},mathmlBuilder$1=(O,B)=>{var U;if(O.symbol)U=new MathNode("mo",[makeText(O.name,O.mode)]),Vm.contains(Uf,O.name)&&U.setAttribute("largeop","false");else if(O.body)U=new MathNode("mo",buildExpression(O.body,B));else{U=new MathNode("mi",[new TextNode(O.name.slice(1))]);var G=new MathNode("mo",[makeText("","text")]);U=O.parentIsSupSub?new MathNode("mrow",[U,G]):newDocumentFragment([U,G])}return U},Vf={"":"\\prod","":"\\coprod","":"\\sum","":"\\bigwedge","":"\\bigvee","":"\\bigcap","":"\\bigcup","":"\\bigodot","":"\\bigoplus","":"\\bigotimes","":"\\biguplus","":"\\bigsqcup"};defineFunction({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","","","","","","","","","","","",""],props:{numArgs:0},handler:(O,B)=>{var{parser:U,funcName:G}=O,q=G;return 1===q.length&&(q=Vf[q]),{type:"op",mode:U.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:q}},htmlBuilder:htmlBuilder$2,mathmlBuilder:mathmlBuilder$1}),defineFunction({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(O,B)=>{var{parser:U}=O,G=B[0];return{type:"op",mode:U.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:ordargument(G)}},htmlBuilder:htmlBuilder$2,mathmlBuilder:mathmlBuilder$1});var Gf={"":"\\int","":"\\iint","":"\\iiint","":"\\oint","":"\\oiint","":"\\oiiint"};defineFunction({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(O){var{parser:B,funcName:U}=O;return{type:"op",mode:B.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:U}},htmlBuilder:htmlBuilder$2,mathmlBuilder:mathmlBuilder$1}),defineFunction({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(O){var{parser:B,funcName:U}=O;return{type:"op",mode:B.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:U}},htmlBuilder:htmlBuilder$2,mathmlBuilder:mathmlBuilder$1}),defineFunction({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","","","","","",""],props:{numArgs:0},handler(O){var{parser:B,funcName:U}=O,G=U;return 1===G.length&&(G=Gf[G]),{type:"op",mode:B.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:G}},htmlBuilder:htmlBuilder$2,mathmlBuilder:mathmlBuilder$1});var htmlBuilder$1=(O,B)=>{var U,G,q,j,W=!1;if("supsub"===O.type?(U=O.sup,G=O.sub,q=assertNodeType(O.base,"operatorname"),W=!0):q=assertNodeType(O,"operatorname"),q.body.length>0){for(var Y=q.body.map((O=>{var B=O.text;return"string"==typeof B?{type:"textord",mode:O.mode,text:B}:O})),K=buildExpression$1(Y,B.withFont("mathrm"),!0),Q=0;Q<K.length;Q++){var Z=K[Q];Z instanceof SymbolNode&&(Z.text=Z.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}j=Zg.makeSpan(["mop"],K,B)}else j=Zg.makeSpan(["mop"],[],B);return W?assembleSupSub(j,U,G,B,B.style,0,0):j};function sizingGroup(O,B,U){for(var G=buildExpression$1(O,B,!1),q=B.sizeMultiplier/U.sizeMultiplier,j=0;j<G.length;j++){var W=G[j].classes.indexOf("sizing");W<0?Array.prototype.push.apply(G[j].classes,B.sizingClasses(U)):G[j].classes[W+1]==="reset-size"+B.size&&(G[j].classes[W+1]="reset-size"+U.size),G[j].height*=q,G[j].depth*=q}return Zg.makeFragment(G)}defineFunction({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(O,B)=>{var{parser:U,funcName:G}=O,q=B[0];return{type:"operatorname",mode:U.mode,body:ordargument(q),alwaysHandleSupSub:"\\operatornamewithlimits"===G,limits:!1,parentIsSupSub:!1}},htmlBuilder:htmlBuilder$1,mathmlBuilder:(O,B)=>{for(var U=buildExpression(O.body,B.withFont("mathrm")),G=!0,q=0;q<U.length;q++){var j=U[q];if(j instanceof mf.SpaceNode);else if(j instanceof mf.MathNode)switch(j.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":var W=j.children[0];1===j.children.length&&W instanceof mf.TextNode?W.text=W.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):G=!1;break;default:G=!1}else G=!1}if(G){var Y=U.map((O=>O.toText())).join("");U=[new mf.TextNode(Y)]}var K=new mf.MathNode("mi",U);K.setAttribute("mathvariant","normal");var Q=new mf.MathNode("mo",[makeText("","text")]);return O.parentIsSupSub?new mf.MathNode("mrow",[K,Q]):mf.newDocumentFragment([K,Q])}}),defineMacro("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@"),defineFunctionBuilders({type:"ordgroup",htmlBuilder:(O,B)=>O.semisimple?Zg.makeFragment(buildExpression$1(O.body,B,!1)):Zg.makeSpan(["mord"],buildExpression$1(O.body,B,!0),B),mathmlBuilder:(O,B)=>buildExpressionRow(O.body,B,!0)}),defineFunction({type:"overline",names:["\\overline"],props:{numArgs:1},handler(O,B){var{parser:U}=O,G=B[0];return{type:"overline",mode:U.mode,body:G}},htmlBuilder(O,B){var U=buildGroup$1(O.body,B.havingCrampedStyle()),G=Zg.makeLineSpan("overline-line",B),q=B.fontMetrics().defaultRuleThickness,j=Zg.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:U},{type:"kern",size:3*q},{type:"elem",elem:G},{type:"kern",size:q}]},B);return Zg.makeSpan(["mord","overline"],[j],B)},mathmlBuilder(O,B){var U=new mf.MathNode("mo",[new mf.TextNode("")]);U.setAttribute("stretchy","true");var G=new mf.MathNode("mover",[buildGroup(O.body,B),U]);return G.setAttribute("accent","true"),G}}),defineFunction({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(O,B)=>{var{parser:U}=O,G=B[0];return{type:"phantom",mode:U.mode,body:ordargument(G)}},htmlBuilder:(O,B)=>{var U=buildExpression$1(O.body,B.withPhantom(),!1);return Zg.makeFragment(U)},mathmlBuilder:(O,B)=>{var U=buildExpression(O.body,B);return new mf.MathNode("mphantom",U)}}),defineFunction({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(O,B)=>{var{parser:U}=O,G=B[0];return{type:"hphantom",mode:U.mode,body:G}},htmlBuilder:(O,B)=>{var U=Zg.makeSpan([],[buildGroup$1(O.body,B.withPhantom())]);if(U.height=0,U.depth=0,U.children)for(var G=0;G<U.children.length;G++)U.children[G].height=0,U.children[G].depth=0;return U=Zg.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:U}]},B),Zg.makeSpan(["mord"],[U],B)},mathmlBuilder:(O,B)=>{var U=buildExpression(ordargument(O.body),B),G=new mf.MathNode("mphantom",U),q=new mf.MathNode("mpadded",[G]);return q.setAttribute("height","0px"),q.setAttribute("depth","0px"),q}}),defineFunction({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(O,B)=>{var{parser:U}=O,G=B[0];return{type:"vphantom",mode:U.mode,body:G}},htmlBuilder:(O,B)=>{var U=Zg.makeSpan(["inner"],[buildGroup$1(O.body,B.withPhantom())]),G=Zg.makeSpan(["fix"],[]);return Zg.makeSpan(["mord","rlap"],[U,G],B)},mathmlBuilder:(O,B)=>{var U=buildExpression(ordargument(O.body),B),G=new mf.MathNode("mphantom",U),q=new mf.MathNode("mpadded",[G]);return q.setAttribute("width","0px"),q}}),defineFunction({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(O,B){var{parser:U}=O,G=assertNodeType(B[0],"size").value,q=B[1];return{type:"raisebox",mode:U.mode,dy:G,body:q}},htmlBuilder(O,B){var U=buildGroup$1(O.body,B),G=calculateSize(O.dy,B);return Zg.makeVList({positionType:"shift",positionData:-G,children:[{type:"elem",elem:U}]},B)},mathmlBuilder(O,B){var U=new mf.MathNode("mpadded",[buildGroup(O.body,B)]),G=O.dy.number+O.dy.unit;return U.setAttribute("voffset",G),U}}),defineFunction({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0},handler(O){var{parser:B}=O;return{type:"internal",mode:B.mode}}}),defineFunction({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,argTypes:["size","size","size"]},handler(O,B,U){var{parser:G}=O,q=U[0],j=assertNodeType(B[0],"size"),W=assertNodeType(B[1],"size");return{type:"rule",mode:G.mode,shift:q&&assertNodeType(q,"size").value,width:j.value,height:W.value}},htmlBuilder(O,B){var U=Zg.makeSpan(["mord","rule"],[],B),G=calculateSize(O.width,B),q=calculateSize(O.height,B),j=O.shift?calculateSize(O.shift,B):0;return U.style.borderRightWidth=makeEm(G),U.style.borderTopWidth=makeEm(q),U.style.bottom=makeEm(j),U.width=G,U.height=q+j,U.depth=-j,U.maxFontSize=1.125*q*B.sizeMultiplier,U},mathmlBuilder(O,B){var U=calculateSize(O.width,B),G=calculateSize(O.height,B),q=O.shift?calculateSize(O.shift,B):0,j=B.color&&B.getColor()||"black",W=new mf.MathNode("mspace");W.setAttribute("mathbackground",j),W.setAttribute("width",makeEm(U)),W.setAttribute("height",makeEm(G));var Y=new mf.MathNode("mpadded",[W]);return q>=0?Y.setAttribute("height",makeEm(q)):(Y.setAttribute("height",makeEm(q)),Y.setAttribute("depth",makeEm(-q))),Y.setAttribute("voffset",makeEm(q)),Y}});var Hf=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"];defineFunction({type:"sizing",names:Hf,props:{numArgs:0,allowedInText:!0},handler:(O,B)=>{var{breakOnTokenText:U,funcName:G,parser:q}=O,j=q.parseExpression(!1,U);return{type:"sizing",mode:q.mode,size:Hf.indexOf(G)+1,body:j}},htmlBuilder:(O,B)=>{var U=B.havingSize(O.size);return sizingGroup(O.body,U,B)},mathmlBuilder:(O,B)=>{var U=B.havingSize(O.size),G=buildExpression(O.body,U),q=new mf.MathNode("mstyle",G);return q.setAttribute("mathsize",makeEm(U.sizeMultiplier)),q}}),defineFunction({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(O,B,U)=>{var{parser:G}=O,q=!1,j=!1,W=U[0]&&assertNodeType(U[0],"ordgroup");if(W)for(var Y="",K=0;K<W.body.length;++K){if("t"===(Y=W.body[K].text))q=!0;else{if("b"!==Y){q=!1,j=!1;break}j=!0}}else q=!0,j=!0;var Q=B[0];return{type:"smash",mode:G.mode,body:Q,smashHeight:q,smashDepth:j}},htmlBuilder:(O,B)=>{var U=Zg.makeSpan([],[buildGroup$1(O.body,B)]);if(!O.smashHeight&&!O.smashDepth)return U;if(O.smashHeight&&(U.height=0,U.children))for(var G=0;G<U.children.length;G++)U.children[G].height=0;if(O.smashDepth&&(U.depth=0,U.children))for(var q=0;q<U.children.length;q++)U.children[q].depth=0;var j=Zg.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:U}]},B);return Zg.makeSpan(["mord"],[j],B)},mathmlBuilder:(O,B)=>{var U=new mf.MathNode("mpadded",[buildGroup(O.body,B)]);return O.smashHeight&&U.setAttribute("height","0px"),O.smashDepth&&U.setAttribute("depth","0px"),U}}),defineFunction({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(O,B,U){var{parser:G}=O,q=U[0],j=B[0];return{type:"sqrt",mode:G.mode,body:j,index:q}},htmlBuilder(O,B){var U=buildGroup$1(O.body,B.havingCrampedStyle());0===U.height&&(U.height=B.fontMetrics().xHeight),U=Zg.wrapFragment(U,B);var G=B.fontMetrics().defaultRuleThickness,q=G;B.style.id<Zm.TEXT.id&&(q=B.fontMetrics().xHeight);var j=G+q/4,W=U.height+U.depth+j+G,{span:Y,ruleWidth:K,advanceWidth:Q}=Nf.sqrtImage(W,B),Z=Y.height-K;Z>U.height+U.depth+j&&(j=(j+Z-U.height-U.depth)/2);var X=Y.height-U.height-j-K;U.style.paddingLeft=makeEm(Q);var J=Zg.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:U,wrapperClasses:["svg-align"]},{type:"kern",size:-(U.height+X)},{type:"elem",elem:Y},{type:"kern",size:K}]},B);if(O.index){var ee=B.havingStyle(Zm.SCRIPTSCRIPT),te=buildGroup$1(O.index,ee,B),ie=.6*(J.height-J.depth),re=Zg.makeVList({positionType:"shift",positionData:-ie,children:[{type:"elem",elem:te}]},B),ne=Zg.makeSpan(["root"],[re]);return Zg.makeSpan(["mord","sqrt"],[ne,J],B)}return Zg.makeSpan(["mord","sqrt"],[J],B)},mathmlBuilder(O,B){var{body:U,index:G}=O;return G?new mf.MathNode("mroot",[buildGroup(U,B),buildGroup(G,B)]):new mf.MathNode("msqrt",[buildGroup(U,B)])}});var qf={display:Zm.DISPLAY,text:Zm.TEXT,script:Zm.SCRIPT,scriptscript:Zm.SCRIPTSCRIPT};defineFunction({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(O,B){var{breakOnTokenText:U,funcName:G,parser:q}=O,j=q.parseExpression(!0,U),W=G.slice(1,G.length-5);return{type:"styling",mode:q.mode,style:W,body:j}},htmlBuilder(O,B){var U=qf[O.style],G=B.havingStyle(U).withFont("");return sizingGroup(O.body,G,B)},mathmlBuilder(O,B){var U=qf[O.style],G=B.havingStyle(U),q=buildExpression(O.body,G),j=new mf.MathNode("mstyle",q),W={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]}[O.style];return j.setAttribute("scriptlevel",W[0]),j.setAttribute("displaystyle",W[1]),j}});defineFunctionBuilders({type:"supsub",htmlBuilder(O,B){var U=function(O,B){var U=O.base;return U?"op"===U.type?U.limits&&(B.style.size===Zm.DISPLAY.size||U.alwaysHandleSupSub)?htmlBuilder$2:null:"operatorname"===U.type?U.alwaysHandleSupSub&&(B.style.size===Zm.DISPLAY.size||U.limits)?htmlBuilder$1:null:"accent"===U.type?Vm.isCharacterBox(U.base)?htmlBuilder$a:null:"horizBrace"===U.type&&!O.sub===U.isOver?htmlBuilder$3:null:null}(O,B);if(U)return U(O,B);var G,q,j,{base:W,sup:Y,sub:K}=O,Q=buildGroup$1(W,B),Z=B.fontMetrics(),X=0,J=0,ee=W&&Vm.isCharacterBox(W);if(Y){var te=B.havingStyle(B.style.sup());G=buildGroup$1(Y,te,B),ee||(X=Q.height-te.fontMetrics().supDrop*te.sizeMultiplier/B.sizeMultiplier)}if(K){var ie=B.havingStyle(B.style.sub());q=buildGroup$1(K,ie,B),ee||(J=Q.depth+ie.fontMetrics().subDrop*ie.sizeMultiplier/B.sizeMultiplier)}j=B.style===Zm.DISPLAY?Z.sup1:B.style.cramped?Z.sup3:Z.sup2;var re,ne=B.sizeMultiplier,oe=makeEm(.5/Z.ptPerEm/ne),ae=null;if(q){var se=O.base&&"op"===O.base.type&&O.base.name&&("\\oiint"===O.base.name||"\\oiiint"===O.base.name);(Q instanceof SymbolNode||se)&&(ae=makeEm(-Q.italic))}if(G&&q){X=Math.max(X,j,G.depth+.25*Z.xHeight),J=Math.max(J,Z.sub2);var le=4*Z.defaultRuleThickness;if(X-G.depth-(q.height-J)<le){J=le-(X-G.depth)+q.height;var ce=.8*Z.xHeight-(X-G.depth);ce>0&&(X+=ce,J-=ce)}var de=[{type:"elem",elem:q,shift:J,marginRight:oe,marginLeft:ae},{type:"elem",elem:G,shift:-X,marginRight:oe}];re=Zg.makeVList({positionType:"individualShift",children:de},B)}else if(q){J=Math.max(J,Z.sub1,q.height-.8*Z.xHeight);var pe=[{type:"elem",elem:q,marginLeft:ae,marginRight:oe}];re=Zg.makeVList({positionType:"shift",positionData:J,children:pe},B)}else{if(!G)throw new Error("supsub must have either sup or sub.");X=Math.max(X,j,G.depth+.25*Z.xHeight),re=Zg.makeVList({positionType:"shift",positionData:-X,children:[{type:"elem",elem:G,marginRight:oe}]},B)}var ue=getTypeOfDomTree(Q,"right")||"mord";return Zg.makeSpan([ue],[Q,Zg.makeSpan(["msupsub"],[re])],B)},mathmlBuilder(O,B){var U,G=!1;O.base&&"horizBrace"===O.base.type&&!!O.sup===O.base.isOver&&(G=!0,U=O.base.isOver),!O.base||"op"!==O.base.type&&"operatorname"!==O.base.type||(O.base.parentIsSupSub=!0);var q,j=[buildGroup(O.base,B)];if(O.sub&&j.push(buildGroup(O.sub,B)),O.sup&&j.push(buildGroup(O.sup,B)),G)q=U?"mover":"munder";else if(O.sub)if(O.sup){var W=O.base;q=W&&"op"===W.type&&W.limits&&B.style===Zm.DISPLAY||W&&"operatorname"===W.type&&W.alwaysHandleSupSub&&(B.style===Zm.DISPLAY||W.limits)?"munderover":"msubsup"}else{var Y=O.base;q=Y&&"op"===Y.type&&Y.limits&&(B.style===Zm.DISPLAY||Y.alwaysHandleSupSub)||Y&&"operatorname"===Y.type&&Y.alwaysHandleSupSub&&(Y.limits||B.style===Zm.DISPLAY)?"munder":"msub"}else{var K=O.base;q=K&&"op"===K.type&&K.limits&&(B.style===Zm.DISPLAY||K.alwaysHandleSupSub)||K&&"operatorname"===K.type&&K.alwaysHandleSupSub&&(K.limits||B.style===Zm.DISPLAY)?"mover":"msup"}return new mf.MathNode(q,j)}}),defineFunctionBuilders({type:"atom",htmlBuilder:(O,B)=>Zg.mathsym(O.text,O.mode,B,["m"+O.family]),mathmlBuilder(O,B){var U=new mf.MathNode("mo",[makeText(O.text,O.mode)]);if("bin"===O.family){var G=getVariant(O,B);"bold-italic"===G&&U.setAttribute("mathvariant",G)}else"punct"===O.family?U.setAttribute("separator","true"):"open"!==O.family&&"close"!==O.family||U.setAttribute("stretchy","false");return U}});var jf={mi:"italic",mn:"normal",mtext:"normal"};defineFunctionBuilders({type:"mathord",htmlBuilder:(O,B)=>Zg.makeOrd(O,B,"mathord"),mathmlBuilder(O,B){var U=new mf.MathNode("mi",[makeText(O.text,O.mode,B)]),G=getVariant(O,B)||"italic";return G!==jf[U.type]&&U.setAttribute("mathvariant",G),U}}),defineFunctionBuilders({type:"textord",htmlBuilder:(O,B)=>Zg.makeOrd(O,B,"textord"),mathmlBuilder(O,B){var U,G=makeText(O.text,O.mode,B),q=getVariant(O,B)||"normal";return U="text"===O.mode?new mf.MathNode("mtext",[G]):/[0-9]/.test(O.text)?new mf.MathNode("mn",[G]):"\\prime"===O.text?new mf.MathNode("mo",[G]):new mf.MathNode("mi",[G]),q!==jf[U.type]&&U.setAttribute("mathvariant",q),U}});var Wf={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},Yf={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};defineFunctionBuilders({type:"spacing",htmlBuilder(O,B){if(Yf.hasOwnProperty(O.text)){var U=Yf[O.text].className||"";if("text"===O.mode){var G=Zg.makeOrd(O,B,"textord");return G.classes.push(U),G}return Zg.makeSpan(["mspace",U],[Zg.mathsym(O.text,O.mode,B)],B)}if(Wf.hasOwnProperty(O.text))return Zg.makeSpan(["mspace",Wf[O.text]],[],B);throw new ParseError('Unknown type of space "'+O.text+'"')},mathmlBuilder(O,B){if(!Yf.hasOwnProperty(O.text)){if(Wf.hasOwnProperty(O.text))return new mf.MathNode("mspace");throw new ParseError('Unknown type of space "'+O.text+'"')}return new mf.MathNode("mtext",[new mf.TextNode(" ")])}});var pad=()=>{var O=new mf.MathNode("mtd",[]);return O.setAttribute("width","50%"),O};defineFunctionBuilders({type:"tag",mathmlBuilder(O,B){var U=new mf.MathNode("mtable",[new mf.MathNode("mtr",[pad(),new mf.MathNode("mtd",[buildExpressionRow(O.body,B)]),pad(),new mf.MathNode("mtd",[buildExpressionRow(O.tag,B)])])]);return U.setAttribute("width","100%"),U}});var Kf={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},Qf={"\\textbf":"textbf","\\textmd":"textmd"},Zf={"\\textit":"textit","\\textup":"textup"},optionsWithFont=(O,B)=>{var U=O.font;return U?Kf[U]?B.withTextFontFamily(Kf[U]):Qf[U]?B.withTextFontWeight(Qf[U]):B.withTextFontShape(Zf[U]):B};defineFunction({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(O,B){var{parser:U,funcName:G}=O,q=B[0];return{type:"text",mode:U.mode,body:ordargument(q),font:G}},htmlBuilder(O,B){var U=optionsWithFont(O,B),G=buildExpression$1(O.body,U,!0);return Zg.makeSpan(["mord","text"],G,U)},mathmlBuilder(O,B){var U=optionsWithFont(O,B);return buildExpressionRow(O.body,U)}}),defineFunction({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(O,B){var{parser:U}=O;return{type:"underline",mode:U.mode,body:B[0]}},htmlBuilder(O,B){var U=buildGroup$1(O.body,B),G=Zg.makeLineSpan("underline-line",B),q=B.fontMetrics().defaultRuleThickness,j=Zg.makeVList({positionType:"top",positionData:U.height,children:[{type:"kern",size:q},{type:"elem",elem:G},{type:"kern",size:3*q},{type:"elem",elem:U}]},B);return Zg.makeSpan(["mord","underline"],[j],B)},mathmlBuilder(O,B){var U=new mf.MathNode("mo",[new mf.TextNode("")]);U.setAttribute("stretchy","true");var G=new mf.MathNode("munder",[buildGroup(O.body,B),U]);return G.setAttribute("accentunder","true"),G}}),defineFunction({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(O,B){var{parser:U}=O;return{type:"vcenter",mode:U.mode,body:B[0]}},htmlBuilder(O,B){var U=buildGroup$1(O.body,B),G=B.fontMetrics().axisHeight,q=.5*(U.height-G-(U.depth+G));return Zg.makeVList({positionType:"shift",positionData:q,children:[{type:"elem",elem:U}]},B)},mathmlBuilder:(O,B)=>new mf.MathNode("mpadded",[buildGroup(O.body,B)],["vcenter"])}),defineFunction({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(O,B,U){throw new ParseError("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(O,B){for(var U=makeVerb(O),G=[],q=B.havingStyle(B.style.text()),j=0;j<U.length;j++){var W=U[j];"~"===W&&(W="\\textasciitilde"),G.push(Zg.makeSymbol(W,"Typewriter-Regular",O.mode,q,["mord","texttt"]))}return Zg.makeSpan(["mord","text"].concat(q.sizingClasses(B)),Zg.tryCombineChars(G),q)},mathmlBuilder(O,B){var U=new mf.TextNode(makeVerb(O)),G=new mf.MathNode("mtext",[U]);return G.setAttribute("mathvariant","monospace"),G}});var makeVerb=O=>O.body.replace(/ /g,O.star?"":" "),Xf=nf,Jf=new RegExp("[-]+$");class katex_Lexer{constructor(O,B){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=O,this.settings=B,this.tokenRegex=new RegExp("([ \r\n\t]+)|\\\\(\n|[ \r\t]+\n?)[ \r\t]*|([!-\\[\\]---][-]*|[\ud800-\udbff][\udc00-\udfff][-]*|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5|(\\\\[a-zA-Z@]+)[ \r\n\t]*|\\\\[^\ud800-\udfff])","g"),this.catcodes={"%":14,"~":13}}setCatcode(O,B){this.catcodes[O]=B}lex(){var O=this.input,B=this.tokenRegex.lastIndex;if(B===O.length)return new Token("EOF",new SourceLocation(this,B,B));var U=this.tokenRegex.exec(O);if(null===U||U.index!==B)throw new ParseError("Unexpected character: '"+O[B]+"'",new Token(O[B],new SourceLocation(this,B,B+1)));var G=U[6]||U[3]||(U[2]?"\\ ":" ");if(14===this.catcodes[G]){var q=O.indexOf("\n",this.tokenRegex.lastIndex);return-1===q?(this.tokenRegex.lastIndex=O.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=q+1,this.lex()}return new Token(G,new SourceLocation(this,B,this.tokenRegex.lastIndex))}}class katex_Namespace{constructor(O,B){void 0===O&&(O={}),void 0===B&&(B={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=B,this.builtins=O,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(0===this.undefStack.length)throw new ParseError("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var O=this.undefStack.pop();for(var B in O)O.hasOwnProperty(B)&&(null==O[B]?delete this.current[B]:this.current[B]=O[B])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(O){return this.current.hasOwnProperty(O)||this.builtins.hasOwnProperty(O)}get(O){return this.current.hasOwnProperty(O)?this.current[O]:this.builtins[O]}set(O,B,U){if(void 0===U&&(U=!1),U){for(var G=0;G<this.undefStack.length;G++)delete this.undefStack[G][O];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][O]=B)}else{var q=this.undefStack[this.undefStack.length-1];q&&!q.hasOwnProperty(O)&&(q[O]=this.current[O])}null==B?delete this.current[O]:this.current[O]=B}}var ey=Lf;defineMacro("\\noexpand",(function(O){var B=O.popToken();return O.isExpandable(B.text)&&(B.noexpand=!0,B.treatAsRelax=!0),{tokens:[B],numArgs:0}})),defineMacro("\\expandafter",(function(O){var B=O.popToken();return O.expandOnce(!0),{tokens:[B],numArgs:0}})),defineMacro("\\@firstoftwo",(function(O){return{tokens:O.consumeArgs(2)[0],numArgs:0}})),defineMacro("\\@secondoftwo",(function(O){return{tokens:O.consumeArgs(2)[1],numArgs:0}})),defineMacro("\\@ifnextchar",(function(O){var B=O.consumeArgs(3);O.consumeSpaces();var U=O.future();return 1===B[0].length&&B[0][0].text===U.text?{tokens:B[1],numArgs:0}:{tokens:B[2],numArgs:0}})),defineMacro("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}"),defineMacro("\\TextOrMath",(function(O){var B=O.consumeArgs(2);return"text"===O.mode?{tokens:B[0],numArgs:0}:{tokens:B[1],numArgs:0}}));var ty={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};defineMacro("\\char",(function(O){var B,U=O.popToken(),G="";if("'"===U.text)B=8,U=O.popToken();else if('"'===U.text)B=16,U=O.popToken();else if("`"===U.text)if("\\"===(U=O.popToken()).text[0])G=U.text.charCodeAt(1);else{if("EOF"===U.text)throw new ParseError("\\char` missing argument");G=U.text.charCodeAt(0)}else B=10;if(B){if(null==(G=ty[U.text])||G>=B)throw new ParseError("Invalid base-"+B+" digit "+U.text);for(var q;null!=(q=ty[O.future().text])&&q<B;)G*=B,G+=q,O.popToken()}return"\\@char{"+G+"}"}));var newcommand=(O,B,U)=>{var G=O.consumeArg().tokens;if(1!==G.length)throw new ParseError("\\newcommand's first argument must be a macro name");var q=G[0].text,j=O.isDefined(q);if(j&&!B)throw new ParseError("\\newcommand{"+q+"} attempting to redefine "+q+"; use \\renewcommand");if(!j&&!U)throw new ParseError("\\renewcommand{"+q+"} when command "+q+" does not yet exist; use \\newcommand");var W=0;if(1===(G=O.consumeArg().tokens).length&&"["===G[0].text){for(var Y="",K=O.expandNextToken();"]"!==K.text&&"EOF"!==K.text;)Y+=K.text,K=O.expandNextToken();if(!Y.match(/^\s*[0-9]+\s*$/))throw new ParseError("Invalid number of arguments: "+Y);W=parseInt(Y),G=O.consumeArg().tokens}return O.macros.set(q,{tokens:G,numArgs:W}),""};defineMacro("\\newcommand",(O=>newcommand(O,!1,!0))),defineMacro("\\renewcommand",(O=>newcommand(O,!0,!1))),defineMacro("\\providecommand",(O=>newcommand(O,!0,!0))),defineMacro("\\message",(O=>{var B=O.consumeArgs(1)[0];return console.log(B.reverse().map((O=>O.text)).join("")),""})),defineMacro("\\errmessage",(O=>{var B=O.consumeArgs(1)[0];return console.error(B.reverse().map((O=>O.text)).join("")),""})),defineMacro("\\show",(O=>{var B=O.popToken(),U=B.text;return console.log(B,O.macros.get(U),Xf[U],hg.math[U],hg.text[U]),""})),defineMacro("\\bgroup","{"),defineMacro("\\egroup","}"),defineMacro("~","\\nobreakspace"),defineMacro("\\lq","`"),defineMacro("\\rq","'"),defineMacro("\\aa","\\r a"),defineMacro("\\AA","\\r A"),defineMacro("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`}"),defineMacro("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}"),defineMacro("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`}"),defineMacro("","\\mathscr{B}"),defineMacro("","\\mathscr{E}"),defineMacro("","\\mathscr{F}"),defineMacro("","\\mathscr{H}"),defineMacro("","\\mathscr{I}"),defineMacro("","\\mathscr{L}"),defineMacro("","\\mathscr{M}"),defineMacro("","\\mathscr{R}"),defineMacro("","\\mathfrak{C}"),defineMacro("","\\mathfrak{H}"),defineMacro("","\\mathfrak{Z}"),defineMacro("\\Bbbk","\\Bbb{k}"),defineMacro("","\\cdotp"),defineMacro("\\llap","\\mathllap{\\textrm{#1}}"),defineMacro("\\rlap","\\mathrlap{\\textrm{#1}}"),defineMacro("\\clap","\\mathclap{\\textrm{#1}}"),defineMacro("\\mathstrut","\\vphantom{(}"),defineMacro("\\underbar","\\underline{\\text{#1}}"),defineMacro("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}'),defineMacro("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`}}"),defineMacro("\\ne","\\neq"),defineMacro("","\\neq"),defineMacro("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`}}"),defineMacro("","\\notin"),defineMacro("","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`}}"),defineMacro("","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`}}"),defineMacro("","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`}}"),defineMacro("","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`}}"),defineMacro("","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`}}"),defineMacro("","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`}}"),defineMacro("","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`}}"),defineMacro("","\\perp"),defineMacro("","\\mathclose{!\\mkern-0.8mu!}"),defineMacro("","\\notni"),defineMacro("","\\ulcorner"),defineMacro("","\\urcorner"),defineMacro("","\\llcorner"),defineMacro("","\\lrcorner"),defineMacro("","\\copyright"),defineMacro("","\\textregistered"),defineMacro("","\\textregistered"),defineMacro("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}'),defineMacro("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}'),defineMacro("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}'),defineMacro("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}'),defineMacro("\\vdots","\\mathord{\\varvdots\\rule{0pt}{15pt}}"),defineMacro("","\\vdots"),defineMacro("\\varGamma","\\mathit{\\Gamma}"),defineMacro("\\varDelta","\\mathit{\\Delta}"),defineMacro("\\varTheta","\\mathit{\\Theta}"),defineMacro("\\varLambda","\\mathit{\\Lambda}"),defineMacro("\\varXi","\\mathit{\\Xi}"),defineMacro("\\varPi","\\mathit{\\Pi}"),defineMacro("\\varSigma","\\mathit{\\Sigma}"),defineMacro("\\varUpsilon","\\mathit{\\Upsilon}"),defineMacro("\\varPhi","\\mathit{\\Phi}"),defineMacro("\\varPsi","\\mathit{\\Psi}"),defineMacro("\\varOmega","\\mathit{\\Omega}"),defineMacro("\\substack","\\begin{subarray}{c}#1\\end{subarray}"),defineMacro("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax"),defineMacro("\\boxed","\\fbox{$\\displaystyle{#1}$}"),defineMacro("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;"),defineMacro("\\implies","\\DOTSB\\;\\Longrightarrow\\;"),defineMacro("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");var iy={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};defineMacro("\\dots",(function(O){var B="\\dotso",U=O.expandAfterFuture().text;return U in iy?B=iy[U]:("\\not"===U.slice(0,4)||U in hg.math&&Vm.contains(["bin","rel"],hg.math[U].group))&&(B="\\dotsb"),B}));var ry={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};defineMacro("\\dotso",(function(O){return O.future().text in ry?"\\ldots\\,":"\\ldots"})),defineMacro("\\dotsc",(function(O){var B=O.future().text;return B in ry&&","!==B?"\\ldots\\,":"\\ldots"})),defineMacro("\\cdots",(function(O){return O.future().text in ry?"\\@cdots\\,":"\\@cdots"})),defineMacro("\\dotsb","\\cdots"),defineMacro("\\dotsm","\\cdots"),defineMacro("\\dotsi","\\!\\cdots"),defineMacro("\\dotsx","\\ldots\\,"),defineMacro("\\DOTSI","\\relax"),defineMacro("\\DOTSB","\\relax"),defineMacro("\\DOTSX","\\relax"),defineMacro("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax"),defineMacro("\\,","\\tmspace+{3mu}{.1667em}"),defineMacro("\\thinspace","\\,"),defineMacro("\\>","\\mskip{4mu}"),defineMacro("\\:","\\tmspace+{4mu}{.2222em}"),defineMacro("\\medspace","\\:"),defineMacro("\\;","\\tmspace+{5mu}{.2777em}"),defineMacro("\\thickspace","\\;"),defineMacro("\\!","\\tmspace-{3mu}{.1667em}"),defineMacro("\\negthinspace","\\!"),defineMacro("\\negmedspace","\\tmspace-{4mu}{.2222em}"),defineMacro("\\negthickspace","\\tmspace-{5mu}{.277em}"),defineMacro("\\enspace","\\kern.5em "),defineMacro("\\enskip","\\hskip.5em\\relax"),defineMacro("\\quad","\\hskip1em\\relax"),defineMacro("\\qquad","\\hskip2em\\relax"),defineMacro("\\tag","\\@ifstar\\tag@literal\\tag@paren"),defineMacro("\\tag@paren","\\tag@literal{({#1})}"),defineMacro("\\tag@literal",(O=>{if(O.macros.get("\\df@tag"))throw new ParseError("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"})),defineMacro("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}"),defineMacro("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)"),defineMacro("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}"),defineMacro("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1"),defineMacro("\\newline","\\\\\\relax"),defineMacro("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var ny=makeEm(ig["Main-Regular"]["T".charCodeAt(0)][1]-.7*ig["Main-Regular"]["A".charCodeAt(0)][1]);defineMacro("\\LaTeX","\\textrm{\\html@mathml{L\\kern-.36em\\raisebox{"+ny+"}{\\scriptstyle A}\\kern-.15em\\TeX}{LaTeX}}"),defineMacro("\\KaTeX","\\textrm{\\html@mathml{K\\kern-.17em\\raisebox{"+ny+"}{\\scriptstyle A}\\kern-.15em\\TeX}{KaTeX}}"),defineMacro("\\hspace","\\@ifstar\\@hspacer\\@hspace"),defineMacro("\\@hspace","\\hskip #1\\relax"),defineMacro("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax"),defineMacro("\\ordinarycolon",":"),defineMacro("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}"),defineMacro("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}'),defineMacro("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}'),defineMacro("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}'),defineMacro("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}'),defineMacro("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}'),defineMacro("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}'),defineMacro("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}'),defineMacro("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}'),defineMacro("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}'),defineMacro("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}'),defineMacro("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}'),defineMacro("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}'),defineMacro("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}'),defineMacro("","\\dblcolon"),defineMacro("","\\eqcolon"),defineMacro("","\\coloneqq"),defineMacro("","\\eqqcolon"),defineMacro("","\\Coloneqq"),defineMacro("\\ratio","\\vcentcolon"),defineMacro("\\coloncolon","\\dblcolon"),defineMacro("\\colonequals","\\coloneqq"),defineMacro("\\coloncolonequals","\\Coloneqq"),defineMacro("\\equalscolon","\\eqqcolon"),defineMacro("\\equalscoloncolon","\\Eqqcolon"),defineMacro("\\colonminus","\\coloneq"),defineMacro("\\coloncolonminus","\\Coloneq"),defineMacro("\\minuscolon","\\eqcolon"),defineMacro("\\minuscoloncolon","\\Eqcolon"),defineMacro("\\coloncolonapprox","\\Colonapprox"),defineMacro("\\coloncolonsim","\\Colonsim"),defineMacro("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),defineMacro("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}"),defineMacro("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),defineMacro("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}"),defineMacro("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`}}"),defineMacro("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}"),defineMacro("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}"),defineMacro("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}"),defineMacro("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}"),defineMacro("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}"),defineMacro("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}"),defineMacro("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}"),defineMacro("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}"),defineMacro("\\gvertneqq","\\html@mathml{\\@gvertneqq}{}"),defineMacro("\\lvertneqq","\\html@mathml{\\@lvertneqq}{}"),defineMacro("\\ngeqq","\\html@mathml{\\@ngeqq}{}"),defineMacro("\\ngeqslant","\\html@mathml{\\@ngeqslant}{}"),defineMacro("\\nleqq","\\html@mathml{\\@nleqq}{}"),defineMacro("\\nleqslant","\\html@mathml{\\@nleqslant}{}"),defineMacro("\\nshortmid","\\html@mathml{\\@nshortmid}{}"),defineMacro("\\nshortparallel","\\html@mathml{\\@nshortparallel}{}"),defineMacro("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{}"),defineMacro("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{}"),defineMacro("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{}"),defineMacro("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{}"),defineMacro("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{}"),defineMacro("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{}"),defineMacro("\\imath","\\html@mathml{\\@imath}{}"),defineMacro("\\jmath","\\html@mathml{\\@jmath}{}"),defineMacro("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`}}"),defineMacro("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`}}"),defineMacro("","\\llbracket"),defineMacro("","\\rrbracket"),defineMacro("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`}}"),defineMacro("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`}}"),defineMacro("","\\lBrace"),defineMacro("","\\rBrace"),defineMacro("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`}}"),defineMacro("","\\minuso"),defineMacro("\\darr","\\downarrow"),defineMacro("\\dArr","\\Downarrow"),defineMacro("\\Darr","\\Downarrow"),defineMacro("\\lang","\\langle"),defineMacro("\\rang","\\rangle"),defineMacro("\\uarr","\\uparrow"),defineMacro("\\uArr","\\Uparrow"),defineMacro("\\Uarr","\\Uparrow"),defineMacro("\\N","\\mathbb{N}"),defineMacro("\\R","\\mathbb{R}"),defineMacro("\\Z","\\mathbb{Z}"),defineMacro("\\alef","\\aleph"),defineMacro("\\alefsym","\\aleph"),defineMacro("\\Alpha","\\mathrm{A}"),defineMacro("\\Beta","\\mathrm{B}"),defineMacro("\\bull","\\bullet"),defineMacro("\\Chi","\\mathrm{X}"),defineMacro("\\clubs","\\clubsuit"),defineMacro("\\cnums","\\mathbb{C}"),defineMacro("\\Complex","\\mathbb{C}"),defineMacro("\\Dagger","\\ddagger"),defineMacro("\\diamonds","\\diamondsuit"),defineMacro("\\empty","\\emptyset"),defineMacro("\\Epsilon","\\mathrm{E}"),defineMacro("\\Eta","\\mathrm{H}"),defineMacro("\\exist","\\exists"),defineMacro("\\harr","\\leftrightarrow"),defineMacro("\\hArr","\\Leftrightarrow"),defineMacro("\\Harr","\\Leftrightarrow"),defineMacro("\\hearts","\\heartsuit"),defineMacro("\\image","\\Im"),defineMacro("\\infin","\\infty"),defineMacro("\\Iota","\\mathrm{I}"),defineMacro("\\isin","\\in"),defineMacro("\\Kappa","\\mathrm{K}"),defineMacro("\\larr","\\leftarrow"),defineMacro("\\lArr","\\Leftarrow"),defineMacro("\\Larr","\\Leftarrow"),defineMacro("\\lrarr","\\leftrightarrow"),defineMacro("\\lrArr","\\Leftrightarrow"),defineMacro("\\Lrarr","\\Leftrightarrow"),defineMacro("\\Mu","\\mathrm{M}"),defineMacro("\\natnums","\\mathbb{N}"),defineMacro("\\Nu","\\mathrm{N}"),defineMacro("\\Omicron","\\mathrm{O}"),defineMacro("\\plusmn","\\pm"),defineMacro("\\rarr","\\rightarrow"),defineMacro("\\rArr","\\Rightarrow"),defineMacro("\\Rarr","\\Rightarrow"),defineMacro("\\real","\\Re"),defineMacro("\\reals","\\mathbb{R}"),defineMacro("\\Reals","\\mathbb{R}"),defineMacro("\\Rho","\\mathrm{P}"),defineMacro("\\sdot","\\cdot"),defineMacro("\\sect","\\S"),defineMacro("\\spades","\\spadesuit"),defineMacro("\\sub","\\subset"),defineMacro("\\sube","\\subseteq"),defineMacro("\\supe","\\supseteq"),defineMacro("\\Tau","\\mathrm{T}"),defineMacro("\\thetasym","\\vartheta"),defineMacro("\\weierp","\\wp"),defineMacro("\\Zeta","\\mathrm{Z}"),defineMacro("\\argmin","\\DOTSB\\operatorname*{arg\\,min}"),defineMacro("\\argmax","\\DOTSB\\operatorname*{arg\\,max}"),defineMacro("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits"),defineMacro("\\bra","\\mathinner{\\langle{#1}|}"),defineMacro("\\ket","\\mathinner{|{#1}\\rangle}"),defineMacro("\\braket","\\mathinner{\\langle{#1}\\rangle}"),defineMacro("\\Bra","\\left\\langle#1\\right|"),defineMacro("\\Ket","\\left|#1\\right\\rangle");var braketHelper=O=>B=>{var U=B.consumeArg().tokens,G=B.consumeArg().tokens,q=B.consumeArg().tokens,j=B.consumeArg().tokens,W=B.macros.get("|"),Y=B.macros.get("\\|");B.macros.beginGroup();var midMacro=B=>U=>{O&&(U.macros.set("|",W),q.length&&U.macros.set("\\|",Y));var j=B;!B&&q.length&&("|"===U.future().text&&(U.popToken(),j=!0));return{tokens:j?q:G,numArgs:0}};B.macros.set("|",midMacro(!1)),q.length&&B.macros.set("\\|",midMacro(!0));var K=B.consumeArg().tokens,Q=B.expandTokens([...j,...K,...U]);return B.macros.endGroup(),{tokens:Q.reverse(),numArgs:0}};defineMacro("\\bra@ket",braketHelper(!1)),defineMacro("\\bra@set",braketHelper(!0)),defineMacro("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}"),defineMacro("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}"),defineMacro("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}"),defineMacro("\\angln","{\\angl n}"),defineMacro("\\blue","\\textcolor{##6495ed}{#1}"),defineMacro("\\orange","\\textcolor{##ffa500}{#1}"),defineMacro("\\pink","\\textcolor{##ff00af}{#1}"),defineMacro("\\red","\\textcolor{##df0030}{#1}"),defineMacro("\\green","\\textcolor{##28ae7b}{#1}"),defineMacro("\\gray","\\textcolor{gray}{#1}"),defineMacro("\\purple","\\textcolor{##9d38bd}{#1}"),defineMacro("\\blueA","\\textcolor{##ccfaff}{#1}"),defineMacro("\\blueB","\\textcolor{##80f6ff}{#1}"),defineMacro("\\blueC","\\textcolor{##63d9ea}{#1}"),defineMacro("\\blueD","\\textcolor{##11accd}{#1}"),defineMacro("\\blueE","\\textcolor{##0c7f99}{#1}"),defineMacro("\\tealA","\\textcolor{##94fff5}{#1}"),defineMacro("\\tealB","\\textcolor{##26edd5}{#1}"),defineMacro("\\tealC","\\textcolor{##01d1c1}{#1}"),defineMacro("\\tealD","\\textcolor{##01a995}{#1}"),defineMacro("\\tealE","\\textcolor{##208170}{#1}"),defineMacro("\\greenA","\\textcolor{##b6ffb0}{#1}"),defineMacro("\\greenB","\\textcolor{##8af281}{#1}"),defineMacro("\\greenC","\\textcolor{##74cf70}{#1}"),defineMacro("\\greenD","\\textcolor{##1fab54}{#1}"),defineMacro("\\greenE","\\textcolor{##0d923f}{#1}"),defineMacro("\\goldA","\\textcolor{##ffd0a9}{#1}"),defineMacro("\\goldB","\\textcolor{##ffbb71}{#1}"),defineMacro("\\goldC","\\textcolor{##ff9c39}{#1}"),defineMacro("\\goldD","\\textcolor{##e07d10}{#1}"),defineMacro("\\goldE","\\textcolor{##a75a05}{#1}"),defineMacro("\\redA","\\textcolor{##fca9a9}{#1}"),defineMacro("\\redB","\\textcolor{##ff8482}{#1}"),defineMacro("\\redC","\\textcolor{##f9685d}{#1}"),defineMacro("\\redD","\\textcolor{##e84d39}{#1}"),defineMacro("\\redE","\\textcolor{##bc2612}{#1}"),defineMacro("\\maroonA","\\textcolor{##ffbde0}{#1}"),defineMacro("\\maroonB","\\textcolor{##ff92c6}{#1}"),defineMacro("\\maroonC","\\textcolor{##ed5fa6}{#1}"),defineMacro("\\maroonD","\\textcolor{##ca337c}{#1}"),defineMacro("\\maroonE","\\textcolor{##9e034e}{#1}"),defineMacro("\\purpleA","\\textcolor{##ddd7ff}{#1}"),defineMacro("\\purpleB","\\textcolor{##c6b9fc}{#1}"),defineMacro("\\purpleC","\\textcolor{##aa87ff}{#1}"),defineMacro("\\purpleD","\\textcolor{##7854ab}{#1}"),defineMacro("\\purpleE","\\textcolor{##543b78}{#1}"),defineMacro("\\mintA","\\textcolor{##f5f9e8}{#1}"),defineMacro("\\mintB","\\textcolor{##edf2df}{#1}"),defineMacro("\\mintC","\\textcolor{##e0e5cc}{#1}"),defineMacro("\\grayA","\\textcolor{##f6f7f7}{#1}"),defineMacro("\\grayB","\\textcolor{##f0f1f2}{#1}"),defineMacro("\\grayC","\\textcolor{##e3e5e6}{#1}"),defineMacro("\\grayD","\\textcolor{##d6d8da}{#1}"),defineMacro("\\grayE","\\textcolor{##babec2}{#1}"),defineMacro("\\grayF","\\textcolor{##888d93}{#1}"),defineMacro("\\grayG","\\textcolor{##626569}{#1}"),defineMacro("\\grayH","\\textcolor{##3b3e40}{#1}"),defineMacro("\\grayI","\\textcolor{##21242c}{#1}"),defineMacro("\\kaBlue","\\textcolor{##314453}{#1}"),defineMacro("\\kaGreen","\\textcolor{##71B307}{#1}");var oy={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class MacroExpander{constructor(O,B,U){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=B,this.expansionCount=0,this.feed(O),this.macros=new katex_Namespace(ey,B.macros),this.mode=U,this.stack=[]}feed(O){this.lexer=new katex_Lexer(O,this.settings)}switchMode(O){this.mode=O}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return 0===this.stack.length&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(O){this.stack.push(O)}pushTokens(O){this.stack.push(...O)}scanArgument(O){var B,U,G;if(O){if(this.consumeSpaces(),"["!==this.future().text)return null;B=this.popToken(),({tokens:G,end:U}=this.consumeArg(["]"]))}else({tokens:G,start:B,end:U}=this.consumeArg());return this.pushToken(new Token("EOF",U.loc)),this.pushTokens(G),B.range(U,"")}consumeSpaces(){for(;;){if(" "!==this.future().text)break;this.stack.pop()}}consumeArg(O){var B=[],U=O&&O.length>0;U||this.consumeSpaces();var G,q=this.future(),j=0,W=0;do{if(G=this.popToken(),B.push(G),"{"===G.text)++j;else if("}"===G.text){if(-1===--j)throw new ParseError("Extra }",G)}else if("EOF"===G.text)throw new ParseError("Unexpected end of input in a macro argument, expected '"+(O&&U?O[W]:"}")+"'",G);if(O&&U)if((0===j||1===j&&"{"===O[W])&&G.text===O[W]){if(++W===O.length){B.splice(-W,W);break}}else W=0}while(0!==j||U);return"{"===q.text&&"}"===B[B.length-1].text&&(B.pop(),B.shift()),B.reverse(),{tokens:B,start:q,end:G}}consumeArgs(O,B){if(B){if(B.length!==O+1)throw new ParseError("The length of delimiters doesn't match the number of args!");for(var U=B[0],G=0;G<U.length;G++){var q=this.popToken();if(U[G]!==q.text)throw new ParseError("Use of the macro doesn't match its definition",q)}}for(var j=[],W=0;W<O;W++)j.push(this.consumeArg(B&&B[W+1]).tokens);return j}expandOnce(O){var B=this.popToken(),U=B.text,G=B.noexpand?null:this._getExpansion(U);if(null==G||O&&G.unexpandable){if(O&&null==G&&"\\"===U[0]&&!this.isDefined(U))throw new ParseError("Undefined control sequence: "+U);return this.pushToken(B),!1}if(this.expansionCount++,this.expansionCount>this.settings.maxExpand)throw new ParseError("Too many expansions: infinite loop or need to increase maxExpand setting");var q=G.tokens,j=this.consumeArgs(G.numArgs,G.delimiters);if(G.numArgs)for(var W=(q=q.slice()).length-1;W>=0;--W){var Y=q[W];if("#"===Y.text){if(0===W)throw new ParseError("Incomplete placeholder at end of macro body",Y);if("#"===(Y=q[--W]).text)q.splice(W+1,1);else{if(!/^[1-9]$/.test(Y.text))throw new ParseError("Not a valid argument number",Y);q.splice(W,2,...j[+Y.text-1])}}}return this.pushTokens(q),q.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(!1===this.expandOnce()){var O=this.stack.pop();return O.treatAsRelax&&(O.text="\\relax"),O}throw new Error}expandMacro(O){return this.macros.has(O)?this.expandTokens([new Token(O)]):void 0}expandTokens(O){var B=[],U=this.stack.length;for(this.pushTokens(O);this.stack.length>U;)if(!1===this.expandOnce(!0)){var G=this.stack.pop();G.treatAsRelax&&(G.noexpand=!1,G.treatAsRelax=!1),B.push(G)}return B}expandMacroAsText(O){var B=this.expandMacro(O);return B?B.map((O=>O.text)).join(""):B}_getExpansion(O){var B=this.macros.get(O);if(null==B)return B;if(1===O.length){var U=this.lexer.catcodes[O];if(null!=U&&13!==U)return}var G="function"==typeof B?B(this):B;if("string"==typeof G){var q=0;if(-1!==G.indexOf("#"))for(var j=G.replace(/##/g,"");-1!==j.indexOf("#"+(q+1));)++q;for(var W=new katex_Lexer(G,this.settings),Y=[],K=W.lex();"EOF"!==K.text;)Y.push(K),K=W.lex();return Y.reverse(),{tokens:Y,numArgs:q}}return G}isDefined(O){return this.macros.has(O)||Xf.hasOwnProperty(O)||hg.math.hasOwnProperty(O)||hg.text.hasOwnProperty(O)||oy.hasOwnProperty(O)}isExpandable(O){var B=this.macros.get(O);return null!=B?"string"==typeof B||"function"==typeof B||!B.unexpandable:Xf.hasOwnProperty(O)&&!Xf[O].primitive}}var ay=/^[]/,sy=Object.freeze({"":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9",:"a",:"e",:"h",:"i",:"j",:"k",:"l",:"m",:"n",:"o",:"p",:"r",:"s",:"t",:"u",:"v",:"x",:"",:"",:"",:"",:"","":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9",:"A",:"B",:"D",:"E",:"G",:"H",:"I",:"J",:"K",:"L",:"M",:"N",:"O",:"P",:"R",:"T",:"U",:"V",:"W",:"a",:"b",:"c",:"d",:"e",:"f",:"g",:"h",:"i",:"j",:"k",:"l",:"m",:"n",:"o",:"p",:"r",:"s",:"t",:"u",:"v",:"w",:"x",:"y",:"z",:"",:"",:"",:"",:"",:""}),ly={"":{text:"\\'",math:"\\acute"},"":{text:"\\`",math:"\\grave"},"":{text:'\\"',math:"\\ddot"},"":{text:"\\~",math:"\\tilde"},"":{text:"\\=",math:"\\bar"},"":{text:"\\u",math:"\\breve"},"":{text:"\\v",math:"\\check"},"":{text:"\\^",math:"\\hat"},"":{text:"\\.",math:"\\dot"},"":{text:"\\r",math:"\\mathring"},"":{text:"\\H"},"":{text:"\\c"}},cy={:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"b",:"c",:"c",:"c",:"c",:"c",:"c",:"d",:"d",:"d",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"f",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"h",:"h",:"h",:"h",:"h",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"j",:"j",:"k",:"k",:"k",:"l",:"l",:"l",:"m",:"m",:"n",:"n",:"n",:"n",:"n",:"n",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"p",:"p",:"r",:"r",:"r",:"r",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"t",:"t",:"t",:"t",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"v",:"w",:"w",:"w",:"w",:"w",:"w",:"x",:"x",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"z",:"z",:"z",:"z",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"B",:"C",:"C",:"C",:"C",:"C",:"C",:"D",:"D",:"D",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"F",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"H",:"H",:"H",:"H",:"H",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"J",:"K",:"K",:"K",:"L",:"L",:"L",:"M",:"M",:"N",:"N",:"N",:"N",:"N",:"N",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"P",:"P",:"R",:"R",:"R",:"R",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"T",:"T",:"T",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"V",:"W",:"W",:"W",:"W",:"W",:"X",:"X",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Z",:"Z",:"Z",:"Z",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};class katex_Parser{constructor(O,B){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new MacroExpander(O,B,this.mode),this.settings=B,this.leftrightDepth=0}expect(O,B){if(void 0===B&&(B=!0),this.fetch().text!==O)throw new ParseError("Expected '"+O+"', got '"+this.fetch().text+"'",this.fetch());B&&this.consume()}consume(){this.nextToken=null}fetch(){return null==this.nextToken&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(O){this.mode=O,this.gullet.switchMode(O)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var O=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),O}finally{this.gullet.endGroups()}}subparse(O){var B=this.nextToken;this.consume(),this.gullet.pushToken(new Token("}")),this.gullet.pushTokens(O);var U=this.parseExpression(!1);return this.expect("}"),this.nextToken=B,U}parseExpression(O,B){for(var U=[];;){"math"===this.mode&&this.consumeSpaces();var G=this.fetch();if(-1!==katex_Parser.endOfExpression.indexOf(G.text))break;if(B&&G.text===B)break;if(O&&Xf[G.text]&&Xf[G.text].infix)break;var q=this.parseAtom(B);if(!q)break;"internal"!==q.type&&U.push(q)}return"text"===this.mode&&this.formLigatures(U),this.handleInfixNodes(U)}handleInfixNodes(O){for(var B,U=-1,G=0;G<O.length;G++)if("infix"===O[G].type){if(-1!==U)throw new ParseError("only one infix operator per group",O[G].token);U=G,B=O[G].replaceWith}if(-1!==U&&B){var q,j,W=O.slice(0,U),Y=O.slice(U+1);return q=1===W.length&&"ordgroup"===W[0].type?W[0]:{type:"ordgroup",mode:this.mode,body:W},j=1===Y.length&&"ordgroup"===Y[0].type?Y[0]:{type:"ordgroup",mode:this.mode,body:Y},["\\\\abovefrac"===B?this.callFunction(B,[q,O[U],j],[]):this.callFunction(B,[q,j],[])]}return O}handleSupSubscript(O){var B=this.fetch(),U=B.text;this.consume(),this.consumeSpaces();var G=this.parseGroup(O);if(!G)throw new ParseError("Expected group after '"+U+"'",B);return G}formatUnsupportedCmd(O){for(var B=[],U=0;U<O.length;U++)B.push({type:"textord",mode:"text",text:O[U]});var G={type:"text",mode:this.mode,body:B};return{type:"color",mode:this.mode,color:this.settings.errorColor,body:[G]}}parseAtom(O){var B,U,G=this.parseGroup("atom",O);if("text"===this.mode)return G;for(;;){this.consumeSpaces();var q=this.fetch();if("\\limits"===q.text||"\\nolimits"===q.text){if(G&&"op"===G.type){var j="\\limits"===q.text;G.limits=j,G.alwaysHandleSupSub=!0}else{if(!G||"operatorname"!==G.type)throw new ParseError("Limit controls must follow a math operator",q);G.alwaysHandleSupSub&&(G.limits="\\limits"===q.text)}this.consume()}else if("^"===q.text){if(B)throw new ParseError("Double superscript",q);B=this.handleSupSubscript("superscript")}else if("_"===q.text){if(U)throw new ParseError("Double subscript",q);U=this.handleSupSubscript("subscript")}else if("'"===q.text){if(B)throw new ParseError("Double superscript",q);var W={type:"textord",mode:this.mode,text:"\\prime"},Y=[W];for(this.consume();"'"===this.fetch().text;)Y.push(W),this.consume();"^"===this.fetch().text&&Y.push(this.handleSupSubscript("superscript")),B={type:"ordgroup",mode:this.mode,body:Y}}else{if(!sy[q.text])break;var K=sy[q.text],Q=ay.test(q.text);for(this.consume();;){var Z=this.fetch().text;if(!sy[Z])break;if(ay.test(Z)!==Q)break;this.consume(),K+=sy[Z]}var X=new katex_Parser(K,this.settings).parse();Q?U={type:"ordgroup",mode:"math",body:X}:B={type:"ordgroup",mode:"math",body:X}}}return B||U?{type:"supsub",mode:this.mode,base:G,sup:B,sub:U}:G}parseFunction(O,B){var U=this.fetch(),G=U.text,q=Xf[G];if(!q)return null;if(this.consume(),B&&"atom"!==B&&!q.allowedInArgument)throw new ParseError("Got function '"+G+"' with no arguments"+(B?" as "+B:""),U);if("text"===this.mode&&!q.allowedInText)throw new ParseError("Can't use function '"+G+"' in text mode",U);if("math"===this.mode&&!1===q.allowedInMath)throw new ParseError("Can't use function '"+G+"' in math mode",U);var{args:j,optArgs:W}=this.parseArguments(G,q);return this.callFunction(G,j,W,U,O)}callFunction(O,B,U,G,q){var j={funcName:O,parser:this,token:G,breakOnTokenText:q},W=Xf[O];if(W&&W.handler)return W.handler(j,B,U);throw new ParseError("No function handler for "+O)}parseArguments(O,B){var U=B.numArgs+B.numOptionalArgs;if(0===U)return{args:[],optArgs:[]};for(var G=[],q=[],j=0;j<U;j++){var W=B.argTypes&&B.argTypes[j],Y=j<B.numOptionalArgs;(B.primitive&&null==W||"sqrt"===B.type&&1===j&&null==q[0])&&(W="primitive");var K=this.parseGroupOfType("argument to '"+O+"'",W,Y);if(Y)q.push(K);else{if(null==K)throw new ParseError("Null argument, please report this as a bug");G.push(K)}}return{args:G,optArgs:q}}parseGroupOfType(O,B,U){switch(B){case"color":return this.parseColorGroup(U);case"size":return this.parseSizeGroup(U);case"url":return this.parseUrlGroup(U);case"math":case"text":return this.parseArgumentGroup(U,B);case"hbox":var G=this.parseArgumentGroup(U,"text");return null!=G?{type:"styling",mode:G.mode,body:[G],style:"text"}:null;case"raw":var q=this.parseStringGroup("raw",U);return null!=q?{type:"raw",mode:"text",string:q.text}:null;case"primitive":if(U)throw new ParseError("A primitive argument cannot be optional");var j=this.parseGroup(O);if(null==j)throw new ParseError("Expected group as "+O,this.fetch());return j;case"original":case null:case void 0:return this.parseArgumentGroup(U);default:throw new ParseError("Unknown group type as "+O,this.fetch())}}consumeSpaces(){for(;" "===this.fetch().text;)this.consume()}parseStringGroup(O,B){var U=this.gullet.scanArgument(B);if(null==U)return null;for(var G,q="";"EOF"!==(G=this.fetch()).text;)q+=G.text,this.consume();return this.consume(),U.text=q,U}parseRegexGroup(O,B){for(var U,G=this.fetch(),q=G,j="";"EOF"!==(U=this.fetch()).text&&O.test(j+U.text);)j+=(q=U).text,this.consume();if(""===j)throw new ParseError("Invalid "+B+": '"+G.text+"'",G);return G.range(q,j)}parseColorGroup(O){var B=this.parseStringGroup("color",O);if(null==B)return null;var U=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(B.text);if(!U)throw new ParseError("Invalid color: '"+B.text+"'",B);var G=U[0];return/^[0-9a-f]{6}$/i.test(G)&&(G="#"+G),{type:"color-token",mode:this.mode,color:G}}parseSizeGroup(O){var B,U=!1;if(this.gullet.consumeSpaces(),!(B=O||"{"===this.gullet.future().text?this.parseStringGroup("size",O):this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size")))return null;O||0!==B.text.length||(B.text="0pt",U=!0);var G=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(B.text);if(!G)throw new ParseError("Invalid size: '"+B.text+"'",B);var q={number:+(G[1]+G[2]),unit:G[3]};if(!validUnit(q))throw new ParseError("Invalid unit: '"+q.unit+"'",B);return{type:"size",mode:this.mode,value:q,isBlank:U}}parseUrlGroup(O){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var B=this.parseStringGroup("url",O);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),null==B)return null;var U=B.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:U}}parseArgumentGroup(O,B){var U=this.gullet.scanArgument(O);if(null==U)return null;var G=this.mode;B&&this.switchMode(B),this.gullet.beginGroup();var q=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var j={type:"ordgroup",mode:this.mode,loc:U.loc,body:q};return B&&this.switchMode(G),j}parseGroup(O,B){var U,G=this.fetch(),q=G.text;if("{"===q||"\\begingroup"===q){this.consume();var j="{"===q?"}":"\\endgroup";this.gullet.beginGroup();var W=this.parseExpression(!1,j),Y=this.fetch();this.expect(j),this.gullet.endGroup(),U={type:"ordgroup",mode:this.mode,loc:SourceLocation.range(G,Y),body:W,semisimple:"\\begingroup"===q||void 0}}else if(null==(U=this.parseFunction(B,O)||this.parseSymbol())&&"\\"===q[0]&&!oy.hasOwnProperty(q)){if(this.settings.throwOnError)throw new ParseError("Undefined control sequence: "+q,G);U=this.formatUnsupportedCmd(q),this.consume()}return U}formLigatures(O){for(var B=O.length-1,U=0;U<B;++U){var G=O[U],q=G.text;"-"===q&&"-"===O[U+1].text&&(U+1<B&&"-"===O[U+2].text?(O.splice(U,3,{type:"textord",mode:"text",loc:SourceLocation.range(G,O[U+2]),text:"---"}),B-=2):(O.splice(U,2,{type:"textord",mode:"text",loc:SourceLocation.range(G,O[U+1]),text:"--"}),B-=1)),"'"!==q&&"`"!==q||O[U+1].text!==q||(O.splice(U,2,{type:"textord",mode:"text",loc:SourceLocation.range(G,O[U+1]),text:q+q}),B-=1)}}parseSymbol(){var O=this.fetch(),B=O.text;if(/^\\verb[^a-zA-Z]/.test(B)){this.consume();var U=B.slice(5),G="*"===U.charAt(0);if(G&&(U=U.slice(1)),U.length<2||U.charAt(0)!==U.slice(-1))throw new ParseError("\\verb assertion failed --\n                    please report what input caused this bug");return{type:"verb",mode:"text",body:U=U.slice(1,-1),star:G}}cy.hasOwnProperty(B[0])&&!hg[this.mode][B[0]]&&(this.settings.strict&&"math"===this.mode&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+B[0]+'" used in math mode',O),B=cy[B[0]]+B.slice(1));var q,j=Jf.exec(B);if(j&&("i"===(B=B.substring(0,j.index))?B="":"j"===B&&(B="")),hg[this.mode][B]){this.settings.strict&&"math"===this.mode&&Hg.indexOf(B)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+B[0]+'" used in math mode',O);var W,Y=hg[this.mode][B].group,K=SourceLocation.range(O);if(pg.hasOwnProperty(Y)){var Q=Y;W={type:"atom",mode:this.mode,family:Q,loc:K,text:B}}else W={type:Y,mode:this.mode,loc:K,text:B};q=W}else{if(!(B.charCodeAt(0)>=128))return null;this.settings.strict&&(supportedCodepoint(B.charCodeAt(0))?"math"===this.mode&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+B[0]+'" used in math mode',O):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+B[0]+'" ('+B.charCodeAt(0)+")",O)),q={type:"textord",mode:"text",loc:SourceLocation.range(O),text:B}}if(this.consume(),j)for(var Z=0;Z<j[0].length;Z++){var X=j[0][Z];if(!ly[X])throw new ParseError("Unknown accent ' "+X+"'",O);var J=ly[X][this.mode]||ly[X].text;if(!J)throw new ParseError("Accent "+X+" unsupported in "+this.mode+" mode",O);q={type:"accent",mode:this.mode,loc:SourceLocation.range(O),label:J,isStretchy:!1,isShifty:!0,base:q}}return q}}katex_Parser.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var parseTree=function(O,B){if(!("string"==typeof O||O instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var U=new katex_Parser(O,B);delete U.gullet.macros.current["\\df@tag"];var G=U.parse();if(delete U.gullet.macros.current["\\current@color"],delete U.gullet.macros.current["\\color"],U.gullet.macros.get("\\df@tag")){if(!B.displayMode)throw new ParseError("\\tag works only in display equations");G=[{type:"tag",mode:"text",body:G,tag:U.subparse([new Token("\\df@tag")])}]}return G};"undefined"!=typeof document&&"CSS1Compat"!==document.compatMode&&("undefined"!=typeof console&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."));var renderError=function(O,B,U){if(U.throwOnError||!(O instanceof ParseError))throw O;var G=Zg.makeSpan(["katex-error"],[new SymbolNode(B)]);return G.setAttribute("title",O.toString()),G.setAttribute("style","color:"+U.errorColor),G},renderToDomTree=function(O,B){var U=new Settings(B);try{return function(O,B,U){var G,q=optionsFromSettings(U);if("mathml"===U.output)return buildMathML(O,B,q,U.displayMode,!0);if("html"===U.output){var j=buildHTML(O,q);G=Zg.makeSpan(["katex"],[j])}else{var W=buildMathML(O,B,q,U.displayMode,!1),Y=buildHTML(O,q);G=Zg.makeSpan(["katex"],[W,Y])}return displayWrap(G,U)}(parseTree(O,U),O,U)}catch(B){return renderError(B,O,U)}},katex_renderToString=function(O,B){return renderToDomTree(O,B).toMarkup()};function isValidInlineDelim(O,B){const U=O.src[B-1],G=O.src[B],q=O.src[B+1];if("$"!==G)return{can_open:!1,can_close:!1};let j=!1,W=!1;return"$"===U||"\\"===U||void 0!==U&&!isWhitespace(U)&&isWordCharacterOrNumber(U)||(j=!0),"$"===q||void 0!==q&&!isWhitespace(q)&&isWordCharacterOrNumber(q)||(W=!0),{can_open:j,can_close:W}}function isWhitespace(O){return/^\s$/u.test(O)}function isWordCharacterOrNumber(O){return/^[\w\d]$/u.test(O)}function isValidBlockDelim(O,B){const U=O.src[B-1],G=O.src[B],q=O.src[B+1],j=O.src[B+2];return"$"===G&&"$"!==U&&"\\"!==U&&"$"===q&&"$"!==j?{can_open:!0,can_close:!0}:{can_open:!1,can_close:!1}}function inlineMath(O,B){if("$"!==O.src[O.pos])return!1;const U=O.tokens.at(-1);if("html_inline"===(null==U?void 0:U.type)&&/^<\w+.+[^/]>$/.test(U.content))return!1;let G=isValidInlineDelim(O,O.pos);if(!G.can_open)return B||(O.pending+="$"),O.pos+=1,!0;const q=O.pos+1;let j,W=q;for(;-1!==(W=O.src.indexOf("$",W));){for(j=W-1;"\\"===O.src[j];)j-=1;if((W-j)%2==1)break;W+=1}if(-1===W)return B||(O.pending+="$"),O.pos=q,!0;if(W-q==0)return B||(O.pending+="$$"),O.pos=q+1,!0;if(G=isValidInlineDelim(O,W),!G.can_close)return B||(O.pending+="$"),O.pos=q,!0;if(!B){const B=O.push("math_inline","math",0);B.markup="$",B.content=O.src.slice(q,W)}return O.pos=W+1,!0}function inlineMathBlock(O,B){let U,G,q,j;if("$$"!==O.src.slice(O.pos,O.pos+2))return!1;if(q=isValidBlockDelim(O,O.pos),!q.can_open)return B||(O.pending+="$$"),O.pos+=2,!0;const W=O.pos+2;for(U=W;-1!==(U=O.src.indexOf("$$",U));){for(j=U-1;"\\"===O.src[j];)j-=1;if((U-j)%2==1)break;U+=2}return-1===U?(B||(O.pending+="$$"),O.pos=W,!0):U-W==0?(B||(O.pending+="$$$$"),O.pos=W+2,!0):(q=isValidBlockDelim(O,U),q.can_close?(B||(G=O.push("math_block","math",0),G.block=!0,G.markup="$$",G.content=O.src.slice(W,U)),O.pos=U+2,!0):(B||(O.pending+="$$"),O.pos=W,!0))}function inlineBareBlock(O,B){const U=O.src.slice(O.pos);if(!/^\n\\begin/.test(U))return!1;if(O.pos+=1,B)return!0;const G=U.split(/\n/g).slice(1),q=/^\\begin/,j=/^\\end/;let W,Y=0;for(let O=0;O<G.length;++O){const B=G[O];if(q.test(B))++Y;else if(j.test(B)&&(--Y,Y<=0)){W=O;break}}if(void 0===W)return!1;const K=G.slice(0,W+1).reduce(((O,B)=>O+B.length),0)+W+1;if(!B){const B=O.push("math_inline_bare_block","math",0);B.block=!0,B.markup="$$",B.content=U.slice(1,K)}return O.pos=O.pos+K,!0}function handleMathInHtml(O,B,U,G){const q=O.tokens;for(let O=q.length-1;O>=0;O--){const j=q[O],W=[];if("html_block"!==j.type)continue;const Y=j.content;for(const O of Y.matchAll(G)){if(!O.groups)continue;const G=O.groups.html_before_math,q=O.groups.math,Y=O.groups.html_after_math;G&&W.push({...j,type:"html_block",map:null,content:G}),q&&W.push({...j,type:B,map:null,content:q,markup:U,block:!0,tag:"math"}),Y&&W.push({...j,type:"html_block",map:null,content:Y})}W.length>0&&q.splice(O,1,...W)}return!0}function MarkdownItKatex(O,B){const U=(B=B||{}).enableBareBlocks,G=B.enableMathBlockInHtml,q=B.enableMathInlineInHtml,blockRenderer=(O,U)=>{return G=O[U].content,`<p class="katex-block">${katex_renderToString(G,{...B,displayMode:!0})}</p>\n`;var G};O.inline.ruler.after("escape","math_inline",inlineMath),O.inline.ruler.after("escape","math_inline_block",inlineMathBlock),U&&O.inline.ruler.before("text","math_inline_bare_block",inlineBareBlock),O.block.ruler.after("blockquote","math_block",((O,B,G,q)=>!(!U||!function(O,B,U,G){let q="",j=!1,W=O.bMarks[B]+O.tShift[B],Y=O.eMarks[B];const K=O.src.slice(W,Y);if(!/^\\begin/.test(K))return!1;if(B>0){const U=O.bMarks[B-1]+O.tShift[B-1],G=O.eMarks[B-1],q=O.src.slice(U,G);if(!/^\s*$/.test(q))return!1}if(G)return!0;let Q=B;if(!/\\end[\{\}\w]*\s*$/.test(K)){let B=0;for(;!(j||(Q++,Q>=U)||(W=O.bMarks[Q]+O.tShift[Q],Y=O.eMarks[Q],W<Y&&O.tShift[Q]<O.blkIndent));){const U=O.src.slice(W,Y);if(/\\begin/.test(U))++B;else if(/\\end/.test(U)&&(--B,B<0)){const B=Y;q=O.src.slice(W,B),j=!0}}}O.line=Q+1;const Z=O.push("math_block","math",0);return Z.block=!0,Z.content=(K&&K.trim()?K+"\n":"")+O.getLines(B+1,Q,O.tShift[B],!0)+(q&&q.trim()?q:""),Z.map=[B,O.line],Z.markup="$$",!0}(O,B,G,q))||function(O,B,U,G){let q,j,W="",Y=!1,K=O.bMarks[B]+O.tShift[B],Q=O.eMarks[B];if(K+2>Q)return!1;if("$$"!==O.src.slice(K,K+2))return!1;K+=2;let Z=O.src.slice(K,Q);if(G)return!0;for("$$"===Z.trim().slice(-2)&&(Z=Z.trim().slice(0,-2),Y=!0),q=B;!(Y||(q++,q>=U)||(K=O.bMarks[q]+O.tShift[q],Q=O.eMarks[q],K<Q&&O.tShift[q]<O.blkIndent));)"$$"===O.src.slice(K,Q).trim().slice(-2)?(j=O.src.slice(0,Q).lastIndexOf("$$"),W=O.src.slice(K,j),Y=!0):O.src.slice(K,Q).trim().includes("$$")&&(j=O.src.slice(0,Q).trim().indexOf("$$"),W=O.src.slice(K,j),Y=!0);O.line=q+1;const X=O.push("math_block","math",0);return X.block=!0,X.content=(Z&&Z.trim()?Z+"\n":"")+O.getLines(B+1,q,O.tShift[B],!0)+(W&&W.trim()?W:""),X.map=[B,O.line],X.markup="$$",!0}(O,B,G,q)),{alt:["paragraph","reference","blockquote","list"]});const j=/(?<html_before_math>[\s\S]*?)\$\$(?<math>[\s\S]+?)\$\$(?<html_after_math>(?:(?!\$\$[\s\S]+?\$\$)[\s\S])*)/gm,W=/(?<html_before_math>[\s\S]*?)\$(?<math>.*?)\$(?<html_after_math>(?:(?!\$.*?\$)[\s\S])*)/gm;G&&O.core.ruler.push("math_block_in_html_block",(O=>handleMathInHtml(O,"math_block","$$",j))),q&&O.core.ruler.push("math_inline_in_html_block",(O=>handleMathInHtml(O,"math_inline","$",W))),O.renderer.rules.math_inline=(O,U)=>(O=>{const U=/\\begin\{(align|equation|gather|cd|alignat)\}/gi.test(O);return katex_renderToString(O,{...B,displayMode:U})})(O[U].content),O.renderer.rules.math_inline_block=blockRenderer,O.renderer.rules.math_inline_bare_block=blockRenderer,O.renderer.rules.math_block=blockRenderer}const dy=U(1960);let py=class{constructor(O,B){this.config=O,this.log=B,this.highlightCodeBlock=(O,B)=>{let U="";if(B&&dy.getLanguage(B))try{U=dy.highlight(O,{language:B,ignoreIllegals:!0}).value}catch(O){}return U},this.handleProcessMarkdown=(O,B)=>{O=this.applyTextTransformations(O),B.outputHtml=this.markdown.render(O).replaceAll("</a> <a","</a><a"),B.didProcess=!0},this.markdown=this.createMarkdownRenderer(),this.card=this.createAdaptiveCardRenderer()}create(O){return this.card.parse(O),this.card.render()}renderMarkdownToHtml(O){return this.markdown.render(O)}createMarkdownRenderer(){const O={typographer:!0};return O.highlight=this.highlightCodeBlock,new(fp())(O).use(MarkdownItKatex).use(MarkdownItSup)}createAdaptiveCardRenderer(){Lm.AdaptiveCard.onProcessMarkdown=this.handleProcessMarkdown;const O=new Lm.AdaptiveCard;return O.hostConfig=new Lm.HostConfig({adaptiveCard:{allowCustomStyle:!1},fontTypes:{default:{fontFamily:"Roboto, Helvetica, sans-serif",fontSizes:{small:16,default:18,medium:22,large:24,extraLarge:28},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},separator:{lineThickness:1,lineColor:"#cccccc"}}),O}applyTextTransformations(O){O=O.replaceAll("^][^","^] [^");const{LOCATION_OF_HUMAN_PARAM:B,LOCATION_OF_HUMAN_VALUE:U}=this.config.sydney;return O.replaceAll(B,U)}};py=__decorate([__param(0,ql),__param(1,Nt(Pi)),__metadata("design:paramtypes",[Object,Object])],py);let uy=class extends lifecycle_Disposable{constructor(O,B,U,G){super(),this.telemetry=O,this.conversation=B,this.config=U,this.eventBus=G,this.handleSystemEvent=O=>{if(O.type===Xd.ResponseToneChanged)this.config.features.enableTonePerf&&O.data&&(this._tone=O.data)},this.id=CoreUtils.partUUID(),this.eventBus.onSystemEvent(this.handleSystemEvent),this.botRequestId="",this.wasPageHidden=!1,this.chatResponseAudioUrlIndex=0,this.chatResponseAudioReadyIndex=0,this.currentAudioStartedPlayingIndex=0,this.currentAudioFinishedPlayingIndex=0,document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&(this.wasPageHidden=!0)}))}markEvent(O){if(this.config.features.enablePerfTracker)switch(O){case"QueryEntered":return void this.markQueryEntered();case"RequestSend":return void this.markRequestSend();case"FirstTokenResponse":return void this.markFirstTokenReceive();case"FirstTokenRender":return void this.markFirstTokenRender();case"VoiceInitiated":return void this.markVoiceInitiated();case"VoiceListeningStarted":return void this.markVoiceListeningStarted();case"ChatFirstTokenTTS":return void this.markFirstTokenTTS();case"ChatResponseAudioUrl":return void this.markChatResponseAudioUrl();case"ChatResponseAudioReady":return void this.markChatResponseAudioReady();case"CurrentAudioStartedPlaying":return void this.markCurrentAudioStartedPlaying();case"CurrentAudioFinishedPlaying":return void this.markCurrentAudioFinishedPlaying();case"LastTokenResponse":return void this.markLastTokenResponse();case"LastTokenRender":return void this.markLastTokenRender();case"SearchingRender":return void this.markSearchingRender()}}resetTracker(){this.id=CoreUtils.partUUID(),this.botRequestId="",this.wasPageHidden=!1,this.chatResponseAudioUrlIndex=0,this.chatResponseAudioReadyIndex=0,this.currentAudioStartedPlayingIndex=0,this.currentAudioFinishedPlayingIndex=0}markVoiceInitiated(){this.resetTracker(),performance.mark(this.markerNameWithId("VoiceInitiated"))}markVoiceListeningStarted(){if(this.doesMarkerExist("VoiceInitiated")){performance.mark(this.markerNameWithId("VoiceListeningStarted")),performance.measure(this.markerNameWithId("MicToListening"),this.markerNameWithId("VoiceInitiated"),this.markerNameWithId("VoiceListeningStarted"));const O={metrics:{MicToListening:this.getMeasureDuration("MicToListening")},convId:this.conversation.id};this.sendPerformanceTelemetry(O,"Conversation")}}markFirstTokenTTS(){let O=0;this.doesMarkerExist("FirstTokenRender")&&(performance.mark(this.markerNameWithId("ChatFirstTokenTTS")),performance.measure(this.markerNameWithId("ChatFirstTokenTTS"),this.markerNameWithId("FirstTokenRender"),this.markerNameWithId("ChatFirstTokenTTS")),O=this.getMeasureDuration("ChatFirstTokenTTS"));const B={metrics:{ChatFirstTokenTTS:O},convId:this.conversation.id};this.sendPerformanceTelemetry(B,"Conversation")}markQueryEntered(){this.resetTracker(),performance.mark(this.markerNameWithId("QueryEntered"))}markRequestSend(){if(this.doesMarkerExist("QueryEntered")){performance.mark(this.markerNameWithId("RequestSend")),performance.measure(this.markerNameWithId("ChatRequest"),this.markerNameWithId("QueryEntered"),this.markerNameWithId("RequestSend"));const O={metrics:{ChatRequest:this.getMeasureDuration("ChatRequest")},convId:this.conversation.id};this.sendPerformanceTelemetry(O,"Conversation")}}markFirstTokenReceive(){this.doesMarkerExist("QueryEntered")&&this.doesMarkerExist("RequestSend")&&(performance.mark(this.markerNameWithId("FirstTokenResponse")),performance.measure(this.markerNameWithId("ChatReqToResp"),this.markerNameWithId("RequestSend"),this.markerNameWithId("FirstTokenResponse")))}markFirstTokenRender(){requestAnimationFrame((()=>{setTimeout((()=>{if(this.doesMarkerExist("QueryEntered")&&this.doesMarkerExist("FirstTokenResponse")&&(!this.config.features.enableSinglePerfEventPerMessage||this.config.features.enableSinglePerfEventPerMessage&&!this.doesMarkerExist("FirstTokenRender"))){performance.mark(this.markerNameWithId("FirstTokenRender")),performance.measure(this.markerNameWithId("ChatFTR"),this.markerNameWithId("QueryEntered"),this.markerNameWithId("FirstTokenRender")),performance.measure(this.markerNameWithId("ChatRespToRender"),this.markerNameWithId("FirstTokenResponse"),this.markerNameWithId("FirstTokenRender"));const O={ChatReqToResp:this.getMeasureDuration("ChatReqToResp"),ChatRespToRender:this.getMeasureDuration("ChatRespToRender"),ChatFTR:this.getMeasureDuration("ChatFTR")};this.doesMarkerExist("ChatSearching")&&(O.ChatSearching=this.getMeasureDuration("ChatSearching"));const B={metrics:O,convId:this.conversation.id};this.sendPerformanceTelemetry(B,"Conversation")}}),0)}))}markChatResponseAudioUrl(){performance.mark(this.markerNameWithIdAndIndex("ChatResponseAudioUrl",this.chatResponseAudioUrlIndex)),this.chatResponseAudioUrlIndex++}markChatResponseAudioReady(){if(this.doesMarkerWithIndexExist("ChatResponseAudioUrl",this.chatResponseAudioReadyIndex)){performance.mark(this.markerNameWithIdAndIndex("ChatResponseAudioReady",this.chatResponseAudioReadyIndex)),performance.measure(this.markerNameWithIdAndIndex("TTSAudioReady",this.chatResponseAudioReadyIndex),this.markerNameWithIdAndIndex("ChatResponseAudioUrl",this.chatResponseAudioReadyIndex),this.markerNameWithIdAndIndex("ChatResponseAudioReady",this.chatResponseAudioReadyIndex));const O={metrics:{TTSAudioReady:this.getMeasureWithIndexDuration("TTSAudioReady",this.chatResponseAudioReadyIndex)},convId:this.conversation.id};this.chatResponseAudioReadyIndex++,this.sendPerformanceTelemetry(O,"Conversation")}}markCurrentAudioFinishedPlaying(){performance.mark(this.markerNameWithIdAndIndex("CurrentAudioFinishedPlaying",this.currentAudioFinishedPlayingIndex)),this.currentAudioFinishedPlayingIndex++}markCurrentAudioStartedPlaying(){if(this.doesMarkerWithIndexExist("CurrentAudioFinishedPlaying",this.currentAudioStartedPlayingIndex)){performance.mark(this.markerNameWithIdAndIndex("CurrentAudioStartedPlaying",this.currentAudioStartedPlayingIndex)),performance.measure(this.markerNameWithIdAndIndex("TTSPauseDuration",this.currentAudioStartedPlayingIndex),this.markerNameWithIdAndIndex("CurrentAudioFinishedPlaying",this.currentAudioStartedPlayingIndex),this.markerNameWithIdAndIndex("CurrentAudioStartedPlaying",this.currentAudioStartedPlayingIndex));const O={metrics:{TTSPauseDuration:this.getMeasureWithIndexDuration("TTSPauseDuration",this.currentAudioStartedPlayingIndex)},convId:this.conversation.id};this.currentAudioStartedPlayingIndex++,this.sendPerformanceTelemetry(O,"Conversation")}}markSearchingRender(){this.config.features.enableTonePerf&&requestAnimationFrame((()=>{setTimeout((()=>{this.doesMarkerExist("QueryEntered")&&!this.doesMarkerExist("SearchingRender")&&(performance.mark(this.markerNameWithId("SearchingRender")),performance.measure(this.markerNameWithId("ChatSearching"),this.markerNameWithId("QueryEntered"),this.markerNameWithId("SearchingRender")))}),0)}))}markLastTokenResponse(){this.config.features.enableTonePerf&&this.doesMarkerExist("FirstTokenResponse")&&performance.mark(this.markerNameWithId("LastTokenResponse"))}markLastTokenRender(){this.config.features.enableTonePerf&&this.doesMarkerExist("FirstTokenRender")&&requestAnimationFrame((()=>{setTimeout((()=>{if(!this.doesMarkerExist("LastTokenRender")){performance.mark(this.markerNameWithId("LastTokenRender")),performance.measure(this.markerNameWithId("ChatFirstToLast"),this.markerNameWithId("FirstTokenRender"),this.markerNameWithId("LastTokenRender")),performance.measure(this.markerNameWithId("ChatLastTokenRender"),this.markerNameWithId("QueryEntered"),this.markerNameWithId("LastTokenRender"));const O={metrics:{ChatFirstToLast:this.getMeasureDuration("ChatFirstToLast"),ChatLastTokenRender:this.getMeasureDuration("ChatLastTokenRender")},convId:this.conversation.id};this.sendPerformanceTelemetry(O,"Conversation")}}),0)}))}markerNameWithId(O){return O+"-"+this.id}markerNameWithIdAndIndex(O,B){return O+"-"+this.id+"-"+B}getMeasureDuration(O){const B=this.markerNameWithId(O);return Math.round(performance.getEntriesByName(B)[0].duration)}getMeasureWithIndexDuration(O,B){const U=this.markerNameWithIdAndIndex(O,B);return Math.round(performance.getEntriesByName(U)[0].duration)}sendPerformanceTelemetry(O,B){this.config.features.enableTonePerf&&this.wasPageHidden||(this.config.features.enableTonePerf&&this._tone&&(O.Tone=this._tone),this.botRequestId&&(O.BotRequestId=this.botRequestId),this.telemetry.trackEvent("SystemEvent","PerformanceData",{Namespace:B,CustomData:JSON.stringify(O)}))}doesMarkerExist(O){return performance.getEntriesByName(this.markerNameWithId(O)).length>0}doesMarkerWithIndexExist(O,B){return performance.getEntriesByName(this.markerNameWithIdAndIndex(O,B)).length>0}};uy=__decorate([__param(0,$c),__param(1,Dc),__param(2,ql),__param(3,Zd),__metadata("design:paramtypes",[Object,Object,Object,Object])],uy);let hy=class extends lifecycle_Disposable{constructor(O,B,U){super(),this.telemetry=O,this.config=B,this.conversation=U}trackNetworkErrorEvent(O,B,U,G={}){if(this.config.features.enableErrorInstrumentaton){const q=this.createNetworkErrorCustomdata(O,B,U,G);this.telemetry.trackEvent("Error","InternetErrorEvent",{Namespace:"Conversation",CustomData:q})}}createNetworkErrorCustomdata(O,B,U,G={}){var q;return JSON.stringify({errorMessage:U instanceof Error?`${null==U?void 0:U.name} - ${null==U?void 0:U.message}`:String(U),traceId:null==O?void 0:O.traceId,convId:this.conversation.id,optionSet:`[${null===(q=null==O?void 0:O.optionsSets)||void 0===q?void 0:q.toString()}]`,responseMsg:JSON.stringify((null==B?void 0:B.ok)?"":null==B?void 0:B.body),callStack:U instanceof Error?U.stack:"",...G})}createNetworkErrorCustomdatafromNotification(O){const B=O.triggeredError;return this.createNetworkErrorCustomdata(null==B?void 0:B.request,null==B?void 0:B.response,null==B?void 0:B.error,{notificationState:O.errorState,notificationText:O.notificationText})}};hy=__decorate([__param(0,$c),__param(1,ql),__param(2,Dc),__metadata("design:paramtypes",[Object,Object,Object])],hy);let my=class{constructor(O,B){var U;this.config=O,this.log=B,null===(U=this.log)||void 0===U||U.trace(this,"ctor",null).write()}dynamicImportHtml2Canvas(O){O&&U.e(899).then(U.t.bind(U,9899,23)).then((O=>{window.html2canvas=O.default})).catch((O=>{var B;null===(B=this.log)||void 0===B||B.error(this,this.dynamicImportHtml2Canvas,`Failed to import html2canvas. ${O}`).write()}))}async captureIframeImageAsync(O,B){var U,G,q;null===(U=this.log)||void 0===U||U.trace(this,this.captureIframeImageAsync,"captureIframeImageAsync").write();const j=this.cloneIframeAndAppend(O,this.config.shareScreenshot.dataHtmlToCanvasHiddenIframeElement,B);if(!j)throw new Error("create new element fail!");const W=parseInt(null===(G=j.style.width.split("px"))||void 0===G?void 0:G[0]),Y=parseInt(null===(q=j.style.height.split("px"))||void 0===q?void 0:q[0]);return new Promise(((O,B)=>{window.html2canvas?window.html2canvas(j,{logging:!1,useCORS:!0,removeContainer:!1,scale:1,width:W,height:Y,ignoreElements:O=>O.classList.contains(this.config.shareScreenshot.dataHtmlToCanvasIgnoreClassName),onclone:O=>{const B=O.querySelector("."+this.config.shareScreenshot.dataHtmlToCanvasHiddenIframeElement);B&&(B.style.display="block")}}).then((B=>{const U=B.toDataURL("image/png",this.config.shareScreenshot.quality);if(U.length<this.config.shareScreenshot.base64MaxSize)O(U);else{const G=Math.floor(this.config.shareScreenshot.base64MaxSize/U.length*10)/10,q=B.width*G,j=B.height*G,W=new Image;W.src=U,W.onload=()=>{const B=document.createElement("canvas"),U=B.getContext("2d");B.width=q,B.height=j,null==U||U.drawImage(W,0,0,q,j),O(B.toDataURL("image/png",this.config.shareScreenshot.quality))}}})).catch(B).finally((()=>{j.remove()})):B(new Error("window.html2canvas is undefined!"))}))}cloneIframeAndAppend(O,B,U){var G,q,j,W;if(null===(G=this.log)||void 0===G||G.trace(this,this.cloneIframeAndAppend,"cloneIframeAndAppend").write(),!(null===(q=null==O?void 0:O.contentWindow)||void 0===q?void 0:q.document))return null;const Y=null===(j=O.contentWindow)||void 0===j?void 0:j.document,K=document.createElement("div");K.innerHTML=null===(W=Y.documentElement)||void 0===W?void 0:W.innerHTML;const Q=K.querySelector("#b_content");return Q&&(Q.style.padding="0"),K.style.display="none",K.style.width=O.style.width,K.style.height=O.style.height,K.style.minWidth="inherit",K.style.overflow="hidden",B&&K.classList.add(B),O.classList.forEach((O=>K.classList.add(O))),K.classList.remove(this.config.shareScreenshot.dataHtmlToCanvasIgnoreClassName),O.classList.add(this.config.shareScreenshot.dataHtmlToCanvasIgnoreClassName),O.after(K),null==U||U(K),K}};my=__decorate([__param(0,ql),__param(1,Nt(Pi)),__metadata("design:paramtypes",[Object,Object])],my);const gy={adsAug:{type:"string",default:void 0,isRequired:!1}};const fy={sydneyUrl:{type:"string",default:void 0,isRequired:!1},sydneyOptionsSets:{type:"string",default:void 0,isRequired:!1},sydneySliceIds:{type:"string",default:void 0,isRequired:!1}};class ArgsParser_ArgsParser{constructor(O){this.descriptors=Object.freeze(O),this.defaults=this.getDefaults()}generateUrl(O,B){const U=new URL("",O);let G,q;for(G in this.descriptors)G in B&&(q=B[G],null!=q&&""!==q&&U.searchParams.set(G,String(q)));return U}parseArgs(O){const B={},U=new URLSearchParams(O);let G;for(const O of Object.entries(this.descriptors)){const q=O[0],j=O[1];if(G=U.get(q),null!==G)switch(j.type){case"boolean":if(G=G.toLowerCase(),"true"!==G&&"false"!==G)throw new Error(`The ${q} parameter must be either 'true' or 'false'.`);B[q]="true"===G;break;case"number":const O=Number(G);if(isNaN(O))throw new Error(`The ${q} parameter must be a number.`);B[q]=O;break;default:B[q]=G}else!0===j.isRequired&&(B[q]=j.default)}return B}getDefaults(){const O={};let B;for(B in this.descriptors)O[B]=this.descriptors[B].default;return O}}const yy={shareId:{type:"string",default:void 0,isRequired:!1},showconv:{type:"string",default:void 0,isRequired:!1}};const _y={log:{type:"string",default:void 0,isRequired:!1},q:{type:"string",default:void 0,isRequired:!1},mode:{type:"string",default:void 0,isRequired:!1},mobile:{type:"boolean",default:!1,isRequired:!1},alignment:{type:"string",default:void 0,isRequired:!1},features:{type:"string",default:"",isRequired:!1},disableFeatures:{type:"string",default:"",isRequired:!1}};const vy={launch:{type:"boolean",default:!1,isRequired:!1},config:{type:"string",default:void 0,isRequired:!1}};function getILayoutStateProvider(O=!1){return O?Pm:Im}const by=kt.createInterface("IExternalHTMLViewModel"),Sy=kt.createInterface("IHostMessageViewModel");var Cy;(function(O){O.CheckMark="check-mark",O.LockClosed="lock-closed"})(Cy||(Cy={}));const Ey=kt.createInterface("IMetaMessageViewModel"),xy=kt.createInterface("ITextMessageViewModel");var Ty;(function(O){O[O.FateOverride=0]="FateOverride",O[O.AdaptiveCard=1]="AdaptiveCard",O[O.Text=2]="Text"})(Ty||(Ty={}));const wy=kt.createInterface("FullBleedViewModel"),ky=kt.createInterface("IContextMessageViewModel");var Ay,Ry;(function(O){O.Copy="Copy",O.Share="Share"})(Ay||(Ay={})),function(O){O[O.Like=0]="Like",O[O.Dislike=1]="Dislike",O[O.Share=2]="Share",O[O.Copy=3]="Copy",O[O.Export=4]="Export",O[O.Report=5]="Report"}(Ry||(Ry={}));const Iy=kt.createInterface("IMessageGroupViewModel");var Py,Ny;(function(O){O.Idle="Idle",O.Copying="Copying",O.Copied="Copied",O.Error="Error"})(Py||(Py={})),function(O){O.FeedbackMenu="Feedback",O.Sidebar="Sidebar"}(Ny||(Ny={}));const Oy=kt.createInterface("ICopyViewModel"),My=kt.createInterface("IThreadViewModel");var Dy,Ly;(function(O){O.Idle="Idle",O.Exporting="Exporting",O.Exported="Exported",O.Error="Error"})(Dy||(Dy={})),function(O){O.Thread="Thread",O.SingleMessage="SingleMessage"}(Ly||(Ly={}));const By=kt.createInterface("IExportViewModel"),Fy=kt.createInterface("IThreadContextMenuViewModel");let zy=class{constructor(O,B,U,G){this.app=O,this.messages=B,this.threadModelFactory=U,this.log=G}create(O){var B;return null===(B=this.log)||void 0===B||B.trace("ViewModelFactory","create","Create non-message view model:",O.toString()).write(),this.app.get(O)}createMessage(O){var B,U;let G;switch(null===(B=this.log)||void 0===B||B.trace("ViewModelFactory","createMessage",`Create message view model (${O.type})`).write(),O.type){case vp.Text:G=this.app.get(xy);break;case vp.Meta:G=this.app.get(Ey);break;case vp.Host:G=this.app.get(Sy);break;case vp.Context:G=this.app.get(ky);break;case vp.ExternalHTML:G=this.app.get(by);break;case vp.FullBleed:G=this.app.get(wy);break;default:throw new Error(`Unknown message type: '${JSON.stringify(O)}'`)}return G.initialize(O),null===(U=this.log)||void 0===U||U.trace("ViewModelFactory","createMessage","Message view model created").write(),G}createTextMessage(O="",B){var U;null===(U=this.log)||void 0===U||U.trace("ViewModelFactory","createTextMessage","Create text message view model.").write();const G=this.messages.createLocalText({text:O,author:B}),q=this.app.get(xy);return q.initialize(G),q}createCopy(O){var B;null===(B=this.log)||void 0===B||B.trace("ViewModelFactory","createCopy","Create copy view model.").write();const U=this.app.get(Oy);return U.initialize(O),U}createExport(O){var B;null===(B=this.log)||void 0===B||B.trace("ViewModelFactory","createExport","Create export view model.").write();const U=this.app.get(By);return U.initialize(O),U}createFeedback(O,B,U){var G;null===(G=this.log)||void 0===G||G.trace("ViewModelFactory","createFeedback","Create feedback view model.").write();const q=this.app.get(Iy);return q.initialize(O,B,U),q}createThread(O){var B;null===(B=this.log)||void 0===B||B.trace("ViewModelFactory","createThread","Create thread view model.").write();const U=this.threadModelFactory.createThreadModel(O),G=this.app.get(My);return G.initialize(U),G}createThreadContextMenu(O){var B;null===(B=this.log)||void 0===B||B.trace("ViewModelFactory","createThreadContextMenu","Create thread context menu view model.").write();const U=this.app.get(Fy);return U.initialize(O),U}};zy=__decorate([__param(0,Ht),__param(1,hh),__param(2,Mm),__param(3,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object])],zy);const $y=kt.createInterface("IActionBarViewModel");var Uy,Vy,Gy,Hy;function createDecorator(O){return(B,U,G)=>{let q=null,j=null;if("function"==typeof G.value?(q="value",j=G.value):"function"==typeof G.get&&(q="get",j=G.get),!j)throw new Error("not supported");G[q]=O(j,U)}}function debounce(O,B,U){return createDecorator(((G,q)=>{const j=`$debounce$${q}`,W=`$debounce$result$${q}`;return function(...q){this[W]||(this[W]=U?U():void 0),clearTimeout(this[j]),B&&(this[W]=B(this[W],...q),q=[this[W]]),this[j]=setTimeout((()=>{G.apply(this,q),this[W]=U?U():void 0}),O)}}))}(function(O){O.Hidden="hidden",O.Standby="standby",O.MicPending="micpending",O.Listening="listening",O.Loading="loading",O.Speaking="speaking",O.Blocked="blocked",O.Errored="errored"})(Uy||(Uy={})),function(O){O[O.Mic=0]="Mic",O[O.Orb=1]="Orb",O[O.External=2]="External"}(Vy||(Vy={})),function(O){O.Center="center",O.Left="left"}(Gy||(Gy={})),function(O){O.tryParse=function(B){let U;switch(null==B?void 0:B.toLowerCase()){case O.Center:U=O.Center;break;case O.Left:U=O.Left}return U}}(Gy||(Gy={})),function(O){O.Home="home",O.Search="search",O.Conversation="conversation",O.OffStage="off-stage"}(Hy||(Hy={})),function(O){let B=!1,U=O.OffStage,G=O.Conversation;O.tryParse=function(B){let U;switch(null==B?void 0:B.toLowerCase()){case O.Home:U=O.Home;break;case O.Search:U=O.Search;break;case O.Conversation:U=O.Conversation;break;case O.OffStage:U=O.OffStage}return U},O.getDefault=function(){return U},O.getInverse=function(){return G},O.overrideDefaults=function(O,q){B||(B=!0,U=O,G=q)}}(Hy||(Hy={}));const qy=kt.createInterface("ISerpContext");class ViewModelBase extends lifecycle_Disposable{constructor(O,B,U,G){super(),this.serp=O,this.layout=B,this.telemetry=U,this.log=G}}var jy;(function(O){O.None="none",O.Pole="pole",O.RightRail="right-rail",O.Creator="creator"})(jy||(jy={})),function(O){O.toTelemetryNamespace=function(B){let U;switch(B){case O.None:U="Conversation";break;case O.Pole:U="Pole";break;case O.RightRail:U="RightRail";break;case O.Creator:U="Creator";break;default:U="Conversation"}return U},O.tryParse=function(B){let U;switch(null==B?void 0:B.toLowerCase()){case O.None:U=O.None;break;case O.Pole:U=O.Pole;break;case O.RightRail:U=O.RightRail;break;case O.Creator:U=O.Creator}return U}}(jy||(jy={}));const Wy=kt.createInterface("IHoverCardViewModel"),Yy=kt.createInterface("IConversationViewModel"),Ky=kt.createInterface("ITypingIndicatorViewModel");var Qy;let Zy=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y,K,Q,Z,X,J,ee,te,ie){super(O,B,U,ie),this.perfTracker=G,this.config=q,this.speech=j,this.chat=W,this.paste=Y,this.firstRunExperienceService=K,this.errorState=Q,this.turingAutoSuggest=Z,this.manager=X,this.hoverCard=J,this.typingIndicator=ee,this.conversation=te,this.isPendingSubmit=!1,this.isEditModeEnabled=!1,this.enableSpeechAriaLabel=!!this.config.features.enableSpeechAriaLabel,this.enableSpeechInput=!!this.config.features.enableSpeechInput,this.enableNewTopicAutoExpand=!!this.config.features.enableNewTopicAutoExpand,this.enableIMEFix=!!this.config.features.enableActionBarIMEFix,this.isRefreshConversationEnabled=void 0===this.config.partner.disableRefreshConversation||!this.config.partner.disableRefreshConversation,this.speechIconState="hidden",this.speechOutputText="",this.autoSuggestText="",this.autoSuggestPrependedText="",this.autoSuggestAppendedText="",this.isFirstTime=this.firstRunExperienceService.isFirstTime,this.forceOngoingConversationPlaceholderText=!1,this.isInputFocused=!1,this.isComposeButtonCollapsed=!0,this.strings={placeholder:this.config.strings.actionBarPlaceholder,close:this.config.strings.close,ongoingConvPlaceholder:this.config.strings.actionBarOngoingConvPlaceholder,suspendedConvPlaceholder:this.config.strings.actionBarSuspendConvPlaceHolder,composeButton:this.config.strings.actionBarComposeButton,composeButtonTooltip:this.config.strings.newTopicPrompt,newChatButtonDesktop:this.config.strings.actionBarNewChatButtonDesktop,newChatButtonMobile:this.config.strings.actionBarNewChatButtonMobile,textInputAriaLabel:this.config.strings.actionBarTextInputAriaLabel,autoSuggestTab:this.config.strings.actionBarAutoSuggestTab,autoSuggestTap:this.config.strings.actionBarAutoSuggestTap,keyboardHint:this.config.strings.actionBarKeyboardHint,textInputModeButtonAriaLabel:this.config.strings.actionBarTextInputModeButtonAriaLabel,speechInputModeButtonAriaLabel:this.config.strings.actionBarSpeechInputModeButtonAriaLabel,submitButtonAriaLabel:this.config.strings.actionBarSubmitButtonAriaLabel,cancelSpeechInputButtonAriaLabel:this.config.strings.actionBarCancelSpeechInputButtonAriaLabel,editModeButtonAriaLabel:this.config.strings.actionBarEditModeButtonAriaLabel,stop:this.config.strings.stop},this.speechInputEnabled=void 0===this.config.partner.disableVoice||!this.config.partner.disableVoice,this.isDefaultExpanded=void 0!==this.config.partner.isInputBoxExpanded&&this.config.partner.isInputBoxExpanded,Qy.set(this,this._register(new Emitter)),this.enableTTSOnVoiceInput=!!this.config.features.enableTTSOnVoiceInput,this.anyMessageSent=!1,this.previousQuery="",this.composeButtonCollapseTimerId=null,this.isAutoSuggestSuspended=!1,this._inputText="",this._inputMethod=this.serp.isMobile?Ji.Speech:Ji.Keyboard,this.handleChatPendingRequestChanged=()=>{this.enableNewTopicAutoExpand&&!this.chat.isRequestPending&&this.isInputFocused&&this.composeButtonTimer.cancelAndSet((()=>{var O;this.isInputFocused&&(null===(O=this.log)||void 0===O||O.trace(this,this.handleSerpModeChanged,"isComposeButtonCollapsed",this.isComposeButtonCollapsed).write(),this.isComposeButtonCollapsed=!1)}),8e3)},this.handleComposeButtonCollapse=()=>{this.enableNewTopicAutoExpand&&(this.isComposeButtonCollapsed=!1)},this.handleComposeButtonExpand=()=>{this.enableNewTopicAutoExpand&&(this.isComposeButtonCollapsed=!0)},this.handleRecognizedTextUpdated=O=>{var B;null===(B=this.log)||void 0===B||B.trace(this,"handleRecognizedTextUpdated","text:",O).write(),this.speechOutputText=O},this.handleSpeechStatusChanged=O=>{var B,U;if(this._inputMethod===Ji.Speech)switch(null===(B=this.log)||void 0===B||B.trace(this,"handleSpeechStatusChanged","status:",zc[O]).write(),O){case zc.MicInitializing:this.speechOutputText="";break;case zc.NoPermissionError:this.speechIconState="blocked",this.speechOutputText=this.config.strings.speechNoPermissionError;break;case zc.MediaNotReachableError:this.speechIconState="blocked",this.speechOutputText=this.config.strings.speechMediaNotReachableError;break;case zc.FailedRecognitionError:this.speechIconState="errored",this.speechOutputText=this.config.strings.speechFailedRecognitionError;break;case zc.Listening:this.speechIconState="listening",this.speechOutputText=this.config.strings.speechListening;break;case zc.Loading:this.speechIconState="loading",this.previousQuery=this.speechOutputText.toLowerCase(),this.speechOutputText=this.config.strings.speechLoading;break;case zc.ReadingOut:this.speechIconState="speaking",this.speechOutputText="";break;case zc.PendingAudio:this.speechOutputText="";break;case zc.WaitingForStreamToFinish:this.speechIconState="micpending",this.speechOutputText="";break;case zc.ReadyToBeUsed:this._inputMethod!==Ji.Speech?this.speechIconState="hidden":this.speechIconState="standby",this.speechOutputText="";break;case zc.AudioPlaybackError:this.speechIconState="errored",this.speechOutputText=this.config.strings.speechAudioPlaybackError;break;case zc.AuthenticationError:this.speechIconState="errored",this.speechOutputText=this.config.strings.speechAuthenticationError;break;case zc.UnknownError:this.speechIconState="errored",this.speechOutputText=this.config.strings.speechUnknownError;break;default:null===(U=this.log)||void 0===U||U.warn(this,"handleSpeechStatusChanged",`Case '${zc[O]}' has not been implemented.`).write(),this.speechIconState="standby",this.speechOutputText=""}},this.initializeSerpContextObserver(),this.configureSpeechEventListeners(),this.composeButtonTimer=this._register(new async_TimeoutTimer),this.chat.onPendingRequestStateChanged(this.handleChatPendingRequestChanged),null!==this.serp.query&&(this.inputText=this.serp.query)}get isSpeechModeEnabled(){return this.inputMethod===Ji.Speech&&!this.isDisabled}get inputText(){return pt.track(this,"inputText"),this.handleInputTextChanged(),this._inputText}set inputText(O){this._inputText!==O&&(this._inputText=O,pt.notify(this,"inputText"),this.config.features.enableGhostedAutoSuggest&&this.refreshAutoSuggestText())}get isCancelEnabled(){return this.chat.isRequestPending}get isDisabled(){return this.errorState.chatErrorState!==Gc.OK||this.isAppStateError}get isNewTopicDisabled(){return this.serp.mode!==Hy.Conversation||this.errorState.chatErrorState===Gc.MuidUserConsentNotGiven}get isSuspended(){return this.errorState.chatErrorState===Gc.ChatSuspended}get isAppStateError(){return this.errorState.appErrorState!==Vc.OK}get placeholderText(){const O=this.forceOngoingConversationPlaceholderText,B=this.anyMessageSent;let U;return U=this.isSuspended?this.strings.suspendedConvPlaceholder:this.serp.isMobile?this.strings.placeholder:this.serp.mode===Hy.Conversation&&B||O?this.strings.ongoingConvPlaceholder:this.strings.placeholder,U}get inputMethod(){return pt.track(this,"inputMethod"),this._inputMethod}set inputMethod(O){var B,U;this._inputMethod!==O&&(this._inputMethod===Ji.Speech&&(null===(B=this.log)||void 0===B||B.trace(this,this.inputMethod,"InputMethod was Speech, cancelling any interaction before changing InputMethod").write(),this.cancelSpeechInteraction(),this.speechIconState="hidden"),this._inputMethod=O,this._inputMethod===Ji.Speech&&"hidden"===this.speechIconState&&(this.speech.speechStatus===zc.WaitingForStreamToFinish?this.speechIconState="micpending":this.speechIconState="standby"),null===(U=this.log)||void 0===U||U.debug(this,this.inputMethod,`InputMethod set to: ${this._inputMethod}`).write(),pt.notify(this,"inputMethod"),__classPrivateFieldGet(this,Qy,"f").fire(this._inputMethod))}get onInputMethodChanged(){return __classPrivateFieldGet(this,Qy,"f").event}toggleEditMode(){this.isEditModeEnabled=!this.isEditModeEnabled}async handleSpeechChangeAsync(O){var B,U,G,q,j,W,Y,K;if(this.inputMethod===Ji.Speech){switch(this.speechIconState){case"listening":null===(U=this.log)||void 0===U||U.trace(this,this.handleSpeechChangeAsync,"Speech service is listening, canceling now.").write(),this.telemetry.trackEvent("InteractionEvent","VoiceButtonClick",{Namespace:"Conversation",CustomData:JSON.stringify({start:0,source:Vy[O]})}),this.speech.tryCancelSpeechRecognition()||null===(G=this.log)||void 0===G||G.error(this,this.handleSpeechChangeAsync,"Cancelling did not succeded for some reason.").write();break;case"loading":null===(q=this.log)||void 0===q||q.debug(this,this.handleSpeechChangeAsync,`Speech is loading, won't do anything speechState: ${zc[this.speech.speechStatus]}`).write(),this.telemetry.trackEvent("InteractionEvent","speechConversation",{micComponent:"loading"});break;case"speaking":null===(j=this.log)||void 0===j||j.trace(this,this.handleSpeechChangeAsync,"Speech is reading out, stopping readout.").write(),this.telemetry.trackEvent("InteractionEvent","VoiceButtonClick",{Namespace:"Conversation",CustomData:JSON.stringify({start:-1,source:Vy[O]})}),this.telemetry.trackEvent("InteractionEvent","speechConversation",{spokenResponse:"userStopped"}),this.cancelSpeechInteraction();break;case"blocked":this.telemetry.trackEvent("InteractionEvent","speechConversation",{micComponent:"blocked"});break;case"errored":case"standby":if(this.telemetry.trackEvent("InteractionEvent","VoiceButtonClick",{Namespace:"Conversation",CustomData:JSON.stringify({start:1,source:Vy[O]})}),this.telemetry.trackEvent("InteractionEvent","speechConversation",{micComponent:"clicked"}),this.chat.isRequestPending)null===(W=this.log)||void 0===W||W.error(this,this.handleSpeechChangeAsync,"Speech cannot be started as there is a pending request.").write(),this.telemetry.trackEvent("InteractionEvent","speechConversation",{micComponent:"speechStartBlocked"});else{await this.speech.tryStartSpeechRecognitionAsync(this.enableTTSOnVoiceInput)||(null===(Y=this.log)||void 0===Y||Y.error(this,this.handleSpeechChangeAsync,"Speech could not get started for some reason.").write(),this.telemetry.trackEvent("InteractionEvent","speechConversation",{micComponent:"speechStartError"}))}break;default:null===(K=this.log)||void 0===K||K.warn(this,this.handleSpeechChangeAsync,`Case ${this.speechIconState} has not implemented`).write()}this.telemetry.trackEvent("SystemEvent","SpeechStateChanged",{Namespace:"Conversation",CustomData:JSON.stringify({source:Vy[O],speechStatus:zc[this.speech.speechStatus],speechIconState:this.speechIconState})})}else null===(B=this.log)||void 0===B||B.error(this,this.handleSpeechChangeAsync,"Speech should not be triggered when speech mode is not enabled.").write()}submitSuggestion(O){this.cancelSpeechInteraction(),this._inputText=O.text,this.submitInputText()}submitInputText(){var O;if(!this.chat.isRequestPending){null===(O=this.log)||void 0===O||O.trace(this,this.submitInputText,`input text: '${this.inputText}'`).write(),this.perfTracker.markEvent("QueryEntered");const B=this.isEditModeEnabled;if(this.isEditModeEnabled=!1,!this.inputText||0===this.inputText.trim().length)return;this.isPendingSubmit=!0;const U=this.inputText;this.autoSuggestText="",this.autoSuggestPrependedText="",this.autoSuggestAppendedText="",this.serp.inMode(Hy.Conversation)&&(this.inputText="");const submitQuery=()=>{this.previousQuery=U.toLowerCase(),this.serp.submitQuery(U),this.anyMessageSent=!0,this.serp.inMode(Hy.Conversation)?this.isPendingSubmit=!1:setTimeout((()=>{this.isPendingSubmit=!1}),1e3)};let G=0;B&&(G=666),setTimeout(submitQuery,G)}}cancelPendingRequest(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.cancelPendingRequest,"Cancelling requests from both text and speech.").write(),this.chat.cancelPendingRequest(),this.speech.cancelPendingRequest()}resetConversation(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.resetConversation,null).write(),this.manager.resetConversation(),this.perfTracker.resetTracker(),this.hoverCard.clear()}closeRAISuggestions(){this.conversation.closeRAISuggestions()}acceptAutoSuggestText(){this.inputText=this.autoSuggestText+" "}handleChange(O,B){if(O===this.serp)"mode"===B&&this.handleSerpModeChanged(),"isMobile"===B&&this.handleSerpIsMobileChanged()}cancelSpeechInteraction(){var O,B,U,G;null===(O=this.log)||void 0===O||O.trace(this,this.cancelSpeechInteraction,`icon state before cancelling: '${this.speechIconState}'`).write(),this.chat.isRequestPending?(null===(B=this.log)||void 0===B||B.debug(this,this.cancelSpeechInteraction,"Cancelling only TTS readout as the request is pending").write(),this.speech.stopReadout()):(null===(U=this.log)||void 0===U||U.debug(this,this.cancelSpeechInteraction,"Resetting Speech service as there is no pending request.").write(),this.speech.cancelPendingRequest()),null===(G=this.log)||void 0===G||G.trace(this,this.cancelSpeechInteraction,`icon state after cancelling: '${this.speechIconState}'`).write()}handleInputFocus(){this.isInputFocused=!0,this.enableNewTopicAutoExpand&&(this.handleComposeButtonExpand(),this.clearComposeButtonCollapseTimer())}handleInputBlur(){this.isInputFocused=!1,this.enableNewTopicAutoExpand&&(this.composeButtonTimer.cancel(),this.handleComposeButtonExpand(),this.serp.inMode(Hy.Conversation)&&this.startComposeButtonCollapseTimer())}handleInputComposingStart(){this.enableIMEFix&&(this.isAutoSuggestSuspended=!0)}handleInputComposingEnd(){this.enableIMEFix&&(this.isAutoSuggestSuspended=!1,this.refreshAutoSuggestText(!0))}handleInputTextChanged(){this.enableNewTopicAutoExpand&&this._inputText.length>0&&!this.isComposeButtonCollapsed&&this.handleComposeButtonExpand()}refreshAutoSuggestText(O){this.config.suggestions.isEnabled&&(!this.isAutoSuggestSuspended&&this.inputText.length>0&&(this.autoSuggestText!==this.inputText||O)?(this.autoSuggestText.length>=this.inputText.length&&this.inputText[this.inputText.length-1]!==this.autoSuggestText[this.inputText.length-1]&&this.resetAutoSuggestText(),this.updateAutoSuggestTextAsync(this.inputText)):this.resetAutoSuggestText())}resetAutoSuggestText(){this.config.suggestions.isEnabled&&(this.autoSuggestText="",this.autoSuggestPrependedText="",this.autoSuggestAppendedText="")}async updateAutoSuggestTextAsync(O){var B;const U=O.toLowerCase();let G="";try{const O=this.config.buildUrl(this.config.suggestions);if(O.searchParams.set("q",U),this.previousQuery&&O.searchParams.set("bq",this.previousQuery),this.config.features.enableTuringAutoSuggest){const O=await this.turingAutoSuggest.getTextSuggestion(U,this.conversation.lastBotTextMessage);if(O.ok){G=(await O.json()).nextText}}else{const B=await fetch(O,{mode:"cors"});if(B.ok){const O=await B.json(),{suggestionGroups:U}=O;if(U.length){const{searchSuggestions:O}=U[0];if(O.length){const{ghostText:B}=O[0];G=null!=B?B:""}}}}}catch(O){const U=O instanceof Error?O:"Search failed.";throw null===(B=this.log)||void 0===B||B.error(this,"updateAutoSuggestTextAsync",U).write(),O}0!==O.length&&G?O===this.inputText&&(G!==O&&G.toLowerCase().startsWith(U)?(this.autoSuggestText=`${O}${G.slice(O.length)}`,this.autoSuggestPrependedText=O,this.autoSuggestAppendedText=G.slice(O.length),this.telemetry.trackEvent("SystemEvent","TextGhostingSuggest",{Namespace:jy.toTelemetryNamespace(),CustomData:JSON.stringify({enteredTextLength:this.inputText.length,suggestedTextLength:this.autoSuggestText.length})})):this.config.features.enableTuringAutoSuggest&&G&&G!==this.inputText?(this.autoSuggestText=`${O}${G}`,this.autoSuggestPrependedText=O,this.autoSuggestAppendedText=G):this.resetAutoSuggestText()):this.resetAutoSuggestText()}handleSerpModeChanged(){var O;switch(null===(O=this.log)||void 0===O||O.trace(this,this.handleSerpModeChanged,"serp.mode:",this.serp.mode).write(),this.cancelSpeechInteraction(),this.serp.mode){case Hy.OffStage:case Hy.Search:this.enableNewTopicAutoExpand&&(this.clearComposeButtonCollapseTimer(),this.handleComposeButtonExpand());break;case Hy.Home:this.clearComposeButtonCollapseTimer();case Hy.Conversation:this.inputText="",this.startComposeButtonCollapseTimer()}}startComposeButtonCollapseTimer(){this.enableNewTopicAutoExpand&&(this.clearComposeButtonCollapseTimer(),this.composeButtonCollapseTimerId=window.setTimeout(this.handleComposeButtonCollapse,1333))}clearComposeButtonCollapseTimer(){this.enableNewTopicAutoExpand&&this.composeButtonCollapseTimerId&&(window.clearTimeout(this.composeButtonCollapseTimerId),this.composeButtonCollapseTimerId=null)}handleSerpIsMobileChanged(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.handleSerpIsMobileChanged,"serp.isMobile:",this.serp.isMobile).write(),this.inputMethod=this.config.features.enableSpeechInput&&this.serp.isMobile?Ji.Speech:Ji.Keyboard}initializeSerpContextObserver(){const O=pt.getNotifier(this.serp);O.subscribe(this,"mode"),this._register(lifecycle_toDisposable((()=>O.unsubscribe(this,"mode")))),O.subscribe(this,"isMobile"),this._register(lifecycle_toDisposable((()=>O.unsubscribe(this,"isMobile"))))}configureSpeechEventListeners(){this._register(this.speech.onRecognizedTextUpdated(this.handleRecognizedTextUpdated)),this._register(this.speech.onSpeechStatusUpdated(this.handleSpeechStatusChanged))}};Qy=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"isPendingSubmit",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"isEditModeEnabled",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"enableSpeechAriaLabel",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"enableSpeechInput",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"enableNewTopicAutoExpand",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"enableIMEFix",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"isRefreshConversationEnabled",void 0),__decorate([observable,__metadata("design:type",String)],Zy.prototype,"speechIconState",void 0),__decorate([observable,__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],Zy.prototype,"isSpeechModeEnabled",null),__decorate([observable,__metadata("design:type",String)],Zy.prototype,"speechOutputText",void 0),__decorate([observable,__metadata("design:type",String)],Zy.prototype,"autoSuggestText",void 0),__decorate([observable,__metadata("design:type",String)],Zy.prototype,"autoSuggestPrependedText",void 0),__decorate([observable,__metadata("design:type",String)],Zy.prototype,"autoSuggestAppendedText",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"isFirstTime",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"forceOngoingConversationPlaceholderText",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"isInputFocused",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"isComposeButtonCollapsed",void 0),__decorate([observable,__metadata("design:type",Object)],Zy.prototype,"strings",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"enableTTSOnVoiceInput",void 0),__decorate([observable,__metadata("design:type",Boolean)],Zy.prototype,"anyMessageSent",void 0),__decorate([debounce(100),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],Zy.prototype,"handleInputTextChanged",null),__decorate([debounce(10),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],Zy.prototype,"updateAutoSuggestTextAsync",null),Zy=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,qc),__param(4,ql),__param(5,Fc),__param(6,Mc),__param(7,nm),__param(8,Ph),__param(9,Uc),__param(10,jh),__param(11,uh),__param(12,Wy),__param(13,Ky),__param(14,Yy),__param(15,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],Zy);const Xy=kt.createInterface("IBackgroundViewModel");var Jy,e_,t_;(function(O){O[O.ColorScheme=0]="ColorScheme",O[O.Platform=1]="Platform",O[O.ResponseTone=2]="ResponseTone"})(Jy||(Jy={})),function(O){O[O.Light=0]="Light",O[O.Dark=1]="Dark"}(e_||(e_={})),function(O){O[O.DesktopWeb=0]="DesktopWeb",O[O.MobileIos=1]="MobileIos",O[O.MobileAndroid=2]="MobileAndroid",O[O.Windows=3]="Windows"}(t_||(t_={}));class DesignTokenManager{constructor(){this._element=document,this._tokens=null,this.isInitialized=!1}get element(){return this._element}set element(O){this._element=O}get tokens(){if(null===this._tokens)throw new Error("Design token manager must be initialized first.");return this._tokens}initialize(){this.isInitialized||(this.isInitialized=!0,this._tokens=this.getDesignTokens(),this.traverseDesignSystemKeys(this.defaultTokenValues))}reset(){this.tokens&&this.traverseDesignSystemKeys(this.defaultTokenValues)}mutate(O){this.initialize(),this.traverseDesignSystemKeys(O)}traverseDesignSystemKeys(O,B=[]){Object.entries(O).forEach((([O,U])=>{"string"==typeof U||"number"==typeof U?this.applyDesignTokenValue(U,B.concat(O)):"object"==typeof U&&null!==U&&this.traverseDesignSystemKeys(U,B.concat(O))}))}applyDesignTokenValue(O,B){if(null===this._tokens)return;let U=this._tokens;for(const O of B)U=U[O];if(!this.isCSSDesignToken(U))throw new Error(`Unable to resolve design token property path: root[${B.join("][")}]`);U.setValueFor(this.element,O)}isCSSDesignToken(O){const B=O;return"object"==typeof O&&null!==O&&"string"==typeof B.cssCustomProperty&&"function"==typeof B.setValueFor}}const i_="#EFF3FF00",r_="#EFF3FF",n_="#E2E9FF",o_="#D1DBFA",a_="#A2B7F4",s_="#174AE4",l_="#123BB6",c_="#0E2C89",d_="#091E5B",p_="#050F2E",u_="#EFF3FF00",h_="#FFF4F4",m_="#FBE2E2",g_="#F6D0D0",f_="#D7A7BB",y_="#75306C",v_="#66215D",b_="#570F4D",S_="#48033F",C_="#270022",E_="#EEF9FC00",x_="#EEF9FC",T_="#E1F8FD",w_="#CAEEF6",k_="#A7E0EB",A_="#006880",R_="#005366",I_="#003E4D",P_="#002A33",N_="#00151A",O_="#1A0DAB",M_="#82C7FF",D_="#006621",L_="#9EC3AE",B_="#C80000",F_="#D2393D",z_="linear-gradient(90deg, #2870EA 10.79%, #1B4AEF 87.08%)",$_="linear-gradient(90deg, #2870EA 10.79%, #1B4AEF 87.08%)",U_="linear-gradient(90deg, #2870EA 10.79%, #1B4AEF 87.08%)",V_="linear-gradient(90deg, #2870EA 10.79%, #1B4AEF 87.08%)",G_="linear-gradient(90deg, #2870EA 10.79%, #1B4AEF 87.08%)",H_="linear-gradient(90deg, #2870EA 10.79%, #1B4AEF 87.08%)",q_="linear-gradient(90deg, #006880 10.79%, #005366 87.08%)",j_="linear-gradient(90deg, #006880 10.79%, #005366 87.08%)",W_="linear-gradient(90deg, #006880 10.79%, #005366 87.08%)",Y_="linear-gradient(90deg, #904887 10.79%, #8B257E 87.08%)",K_="linear-gradient(90deg, #904887 10.79%, #8B257E 87.08%)",Q_="linear-gradient(90deg, #904887 10.79%, #8B257E 87.08%)",Z_="linear-gradient(90deg, #18C1ED 0%, #3495EA 50%, #2161EF 100%)",X_="radial-gradient(61.04% 89.69% at 100% 100%, rgba(200, 250, 255, 0.08) 0%, rgba(28, 210, 229, 0.08) 40.63%, rgba(28, 210, 229, 0) 100%), radial-gradient(43.78% 64.34% at 60.31% 100%, rgba(23, 74, 228, 0.08) 0%, rgba(23, 74, 228, 0) 100%), linear-gradient(180deg, rgba(23, 74, 228, 0) 29.44%, rgba(23, 74, 228, 0.06) 100%), linear-gradient(90deg, #F3F3F7 0%, #EBF0F9 100%)",J_="radial-gradient(29.08% 43.78% at 58.08% 100%, rgba(13, 12, 31, 0.1) 0%, rgba(28, 29, 36, 0) 100%), radial-gradient(39.32% 59.2% at 100% 0%, rgba(13, 18, 48, 0.2) 0%, rgba(26, 27, 32, 0) 100%), radial-gradient(66.42% 100% at 0% 0%, rgba(23, 24, 29, 0.6) 0%, rgba(27, 28, 35, 0) 100%), linear-gradient(90deg, #1B1C23 0%, #17181D 100%)",ev="rgba(0, 0, 0, 0.06)",tv="rgba(0, 0, 0, 0.1)",iv="rgba(0, 0, 0, 0.2)",rv="rgba(0, 0, 0, 0.3)",nv="rgba(255, 255, 255, 0.03)",ov="rgba(255, 255, 255, 0.06)",av="rgba(255, 255, 255, 0.1)",sv="rgba(255, 255, 255, 0.2)",lv="rgba(255, 255, 255, 0.3)",cv="rgba(255, 255, 255, 0.4)",dv="rgba(255, 255, 255, 0.6)",pv="rgba(255, 255, 255, 0.7)",uv="rgba(255, 255, 255, 1)",hv="#FAF9F8",mv="#EDEBE9",gv="#605E5C",fv="#484644",yv="#3B3A39",_v="#292827",vv="#252423",bv="#1B1A19",Sv="#11100F",Cv="#F9F9F9",Ev="#F5F5F5",xv="#F3F3F3",Tv="#919191",wv="#666666",kv="#444444",Av="#111111";function neutralColors(){return{background:{colorNeutralAppBackground:uv,colorNeutralAppBackgroundAlt:"#F3F3F3",colorNeutralDrawerBackground:Ev,colorNeutralLayerCard:dv,colorNeutralLayerCardAlt:Cv,colorNeutralLayerCardDisabled:lv,colorNeutralLayerCardInverted:vv,colorNeutralLayerOverlay:uv,colorNeutralLayerOverlayAlt:Cv,colorNeutralAttributionItemBackgroundHover:uv,colorNeutralInputBackground:uv,colorNeutralInputBackgroundAlt:uv,colorNeutralOverlayBackground:rv,colorNeutralPrimaryBackground:xv,colorNeutralPrimaryBackgroundHover:Cv,colorNeutralPrimaryBackgroundPressed:xv},foreground:{colorNeutralForeground:Av,colorNeutralForegroundHint:wv,colorNeutralForegroundHintLight:Tv,colorNeutralForegroundInverted:mv,colorNeutralPrimaryForeground:kv,colorNeutralPrimaryForegroundHover:kv,colorNeutralPrimaryForegroundPressed:kv},stroke:{colorNeutralStroke:tv,colorNeutralLayerOverlayStrokeAlt:tv,colorNeutralStrokeFocus:Av,colorNeutralAttributionItemStrokeHover:"transparent",colorNeutralPrimaryStroke:iv,colorNeutralPrimaryStrokeHover:iv,colorNeutralPrimaryStrokePressed:iv}}}function shadows(){const O={elevation1:"0px 0.075px 0.225px rgba(0, 0, 0, 0.12), 0px 0.4px 0.9px rgba(0, 0, 0, 0.16)",elevation2:"0px 0.15px 0.45px rgba(0, 0, 0, 0.12), 0px 0.8px 1.8px rgba(0, 0, 0, 0.16)",elevation4:"0px 0.3px 0.9px rgba(0, 0, 0, 0.12), 0px 1.6px 3.6px rgba(0, 0, 0, 0.16)",elevation8:"0px 0.6px 1.8px rgba(0, 0, 0, 0.12), 0px 3.2px 7.2px rgba(0, 0, 0, 0.16)",elevation16:"0px 1.2px 3.6px rgba(0, 0, 0, 0.16), 0px 6.4px 14.4px rgba(0, 0, 0, 0.2)",elevation28:"0px 14px 28px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)",elevation64:"0px 4.8px 14.4px rgba(0, 0, 0, 0.18), 0px 25.6px 57.6px rgba(0, 0, 0, 0.22)"};return{defaults:{card:O.elevation4,cardRaised:O.elevation8,dialog:O.elevation64,flyout:O.elevation16,layer:O.elevation2,panel:O.elevation28,tooltip:O.elevation16},elevations:O}}class css_directive_CSSDirective{createCSS(){return""}createBehavior(){}}function composedParent(O){const B=O.parentElement;if(B)return B;{const B=O.getRootNode();if(B.host instanceof HTMLElement)return B.host}return null}const Rv=document.createElement("div");class QueuedStyleSheetTarget{setProperty(O,B){dt.queueUpdate((()=>this.target.setProperty(O,B)))}removeProperty(O){dt.queueUpdate((()=>this.target.removeProperty(O)))}}class DocumentStyleSheetTarget extends QueuedStyleSheetTarget{constructor(){super();const O=new CSSStyleSheet;this.target=O.cssRules[O.insertRule(":root{}")].style,document.adoptedStyleSheets=[...document.adoptedStyleSheets,O]}}class HeadStyleElementStyleSheetTarget extends QueuedStyleSheetTarget{constructor(){super(),this.style=document.createElement("style"),document.head.appendChild(this.style);const{sheet:O}=this.style;if(O){const B=O.insertRule(":root{}",O.cssRules.length);this.target=O.cssRules[B].style}}}class StyleElementStyleSheetTarget{constructor(O){this.store=new Map,this.target=null;const B=O.$fastController;this.style=document.createElement("style"),B.addStyles(this.style),pt.getNotifier(B).subscribe(this,"isConnected"),this.handleChange(B,"isConnected")}targetChanged(){if(null!==this.target)for(const[O,B]of this.store.entries())this.target.setProperty(O,B)}setProperty(O,B){this.store.set(O,B),dt.queueUpdate((()=>{null!==this.target&&this.target.setProperty(O,B)}))}removeProperty(O){this.store.delete(O),dt.queueUpdate((()=>{null!==this.target&&this.target.removeProperty(O)}))}handleChange(O,B){const{sheet:U}=this.style;if(U){const O=U.insertRule(":host{}",U.cssRules.length);this.target=U.cssRules[O].style}else this.target=null}}tslib_es6_decorate([observable],StyleElementStyleSheetTarget.prototype,"target",void 0);class ElementStyleSheetTarget{constructor(O){this.target=O.style}setProperty(O,B){dt.queueUpdate((()=>this.target.setProperty(O,B)))}removeProperty(O){dt.queueUpdate((()=>this.target.removeProperty(O)))}}class RootStyleSheetTarget{setProperty(O,B){RootStyleSheetTarget.properties[O]=B;for(const U of RootStyleSheetTarget.roots.values())Nv.getOrCreate(RootStyleSheetTarget.normalizeRoot(U)).setProperty(O,B)}removeProperty(O){delete RootStyleSheetTarget.properties[O];for(const B of RootStyleSheetTarget.roots.values())Nv.getOrCreate(RootStyleSheetTarget.normalizeRoot(B)).removeProperty(O)}static registerRoot(O){const{roots:B}=RootStyleSheetTarget;if(!B.has(O)){B.add(O);const U=Nv.getOrCreate(this.normalizeRoot(O));for(const O in RootStyleSheetTarget.properties)U.setProperty(O,RootStyleSheetTarget.properties[O])}}static unregisterRoot(O){const{roots:B}=RootStyleSheetTarget;if(B.has(O)){B.delete(O);const U=Nv.getOrCreate(RootStyleSheetTarget.normalizeRoot(O));for(const O in RootStyleSheetTarget.properties)U.removeProperty(O)}}static normalizeRoot(O){return O===Rv?document:O}}RootStyleSheetTarget.roots=new Set,RootStyleSheetTarget.properties={};const Iv=new WeakMap,Pv=dt.supportsAdoptedStyleSheets?class extends QueuedStyleSheetTarget{constructor(O){super();const B=new CSSStyleSheet;this.target=B.cssRules[B.insertRule(":host{}")].style,O.$fastController.addStyles(element_styles_ElementStyles.create([B]))}}:StyleElementStyleSheetTarget,Nv=Object.freeze({getOrCreate(O){if(Iv.has(O))return Iv.get(O);let B;return O===Rv?B=new RootStyleSheetTarget:O instanceof Document?B=dt.supportsAdoptedStyleSheets?new DocumentStyleSheetTarget:new HeadStyleElementStyleSheetTarget:B=O instanceof St?new Pv(O):new ElementStyleSheetTarget(O),Iv.set(O,B),B}});class DesignTokenImpl extends css_directive_CSSDirective{constructor(O){super(),this.subscribers=new WeakMap,this._appliedTo=new Set,this.name=O.name,null!==O.cssCustomPropertyName&&(this.cssCustomProperty=`--${O.cssCustomPropertyName}`,this.cssVar=`var(${this.cssCustomProperty})`),this.id=DesignTokenImpl.uniqueId(),DesignTokenImpl.tokensById.set(this.id,this)}get appliedTo(){return[...this._appliedTo]}static from(O){return new DesignTokenImpl({name:"string"==typeof O?O:O.name,cssCustomPropertyName:"string"==typeof O?O:void 0===O.cssCustomPropertyName?O.name:O.cssCustomPropertyName})}static isCSSDesignToken(O){return"string"==typeof O.cssCustomProperty}static isDerivedDesignTokenValue(O){return"function"==typeof O}static getTokenById(O){return DesignTokenImpl.tokensById.get(O)}getOrCreateSubscriberSet(O=this){return this.subscribers.get(O)||this.subscribers.set(O,new Set)&&this.subscribers.get(O)}createCSS(){return this.cssVar||""}getValueFor(O){const B=DesignTokenNode.getOrCreate(O).get(this);if(void 0!==B)return B;throw new Error(`Value could not be retrieved for token named "${this.name}". Ensure the value is set for ${O} or an ancestor of ${O}.`)}setValueFor(O,B){return this._appliedTo.add(O),B instanceof DesignTokenImpl&&(B=this.alias(B)),DesignTokenNode.getOrCreate(O).set(this,B),this}deleteValueFor(O){return this._appliedTo.delete(O),DesignTokenNode.existsFor(O)&&DesignTokenNode.getOrCreate(O).delete(this),this}withDefault(O){return this.setValueFor(Rv,O),this}subscribe(O,B){const U=this.getOrCreateSubscriberSet(B);B&&!DesignTokenNode.existsFor(B)&&DesignTokenNode.getOrCreate(B),U.has(O)||U.add(O)}unsubscribe(O,B){const U=this.subscribers.get(B||this);U&&U.has(O)&&U.delete(O)}notify(O){const B=Object.freeze({token:this,target:O});this.subscribers.has(this)&&this.subscribers.get(this).forEach((O=>O.handleChange(B))),this.subscribers.has(O)&&this.subscribers.get(O).forEach((O=>O.handleChange(B)))}alias(O){return B=>O.getValueFor(B)}}DesignTokenImpl.uniqueId=(()=>{let O=0;return()=>(O++,O.toString(16))})(),DesignTokenImpl.tokensById=new Map;class DesignTokenBindingObserver{constructor(O,B,U){this.source=O,this.token=B,this.node=U,this.dependencies=new Set,this.observer=pt.binding(O,this,!1),this.observer.handleChange=this.observer.call,this.handleChange()}disconnect(){this.observer.disconnect()}handleChange(){this.node.store.set(this.token,this.observer.observe(this.node.target,ht))}}class Store{constructor(){this.values=new Map}set(O,B){this.values.get(O)!==B&&(this.values.set(O,B),pt.getNotifier(this).notify(O.id))}get(O){return pt.track(this,O.id),this.values.get(O)}delete(O){this.values.delete(O)}all(){return this.values.entries()}}const Ov=new WeakMap,Mv=new WeakMap;class DesignTokenNode{constructor(O){this.target=O,this.store=new Store,this.children=[],this.assignedValues=new Map,this.reflecting=new Set,this.bindingObservers=new Map,this.tokenValueChangeHandler={handleChange:(O,B)=>{const U=DesignTokenImpl.getTokenById(B);if(U&&(U.notify(this.target),DesignTokenImpl.isCSSDesignToken(U))){const B=this.parent,G=this.isReflecting(U);if(B){const q=B.get(U),j=O.get(U);q===j||G?q===j&&G&&this.stopReflectToCSS(U):this.reflectToCSS(U)}else G||this.reflectToCSS(U)}}},Ov.set(O,this),pt.getNotifier(this.store).subscribe(this.tokenValueChangeHandler),O instanceof St?O.$fastController.addBehaviors([this]):O.isConnected&&this.bind()}static getOrCreate(O){return Ov.get(O)||new DesignTokenNode(O)}static existsFor(O){return Ov.has(O)}static findParent(O){if(Rv!==O.target){let B=composedParent(O.target);for(;null!==B;){if(Ov.has(B))return Ov.get(B);B=composedParent(B)}return DesignTokenNode.getOrCreate(Rv)}return null}static findClosestAssignedNode(O,B){let U=B;do{if(U.has(O))return U;U=U.parent?U.parent:U.target!==Rv?DesignTokenNode.getOrCreate(Rv):null}while(null!==U);return null}get parent(){return Mv.get(this)||null}has(O){return this.assignedValues.has(O)}get(O){const B=this.store.get(O);if(void 0!==B)return B;const U=this.getRaw(O);return void 0!==U?(this.hydrate(O,U),this.get(O)):void 0}getRaw(O){var B;return this.assignedValues.has(O)?this.assignedValues.get(O):null===(B=DesignTokenNode.findClosestAssignedNode(O,this))||void 0===B?void 0:B.getRaw(O)}set(O,B){DesignTokenImpl.isDerivedDesignTokenValue(this.assignedValues.get(O))&&this.tearDownBindingObserver(O),this.assignedValues.set(O,B),DesignTokenImpl.isDerivedDesignTokenValue(B)?this.setupBindingObserver(O,B):this.store.set(O,B)}delete(O){this.assignedValues.delete(O),this.tearDownBindingObserver(O);const B=this.getRaw(O);B?this.hydrate(O,B):this.store.delete(O)}bind(){const O=DesignTokenNode.findParent(this);O&&O.appendChild(this);for(const O of this.assignedValues.keys())O.notify(this.target)}unbind(){if(this.parent){Mv.get(this).removeChild(this)}}appendChild(O){O.parent&&Mv.get(O).removeChild(O);const B=this.children.filter((B=>O.contains(B)));Mv.set(O,this),this.children.push(O),B.forEach((B=>O.appendChild(B))),pt.getNotifier(this.store).subscribe(O);for(const[B,U]of this.store.all())O.hydrate(B,this.bindingObservers.has(B)?this.getRaw(B):U)}removeChild(O){const B=this.children.indexOf(O);return-1!==B&&this.children.splice(B,1),pt.getNotifier(this.store).unsubscribe(O),O.parent===this&&Mv.delete(O)}contains(O){return function(O,B){let U=B;for(;null!==U;){if(U===O)return!0;U=composedParent(U)}return!1}(this.target,O.target)}reflectToCSS(O){this.isReflecting(O)||(this.reflecting.add(O),DesignTokenNode.cssCustomPropertyReflector.startReflection(O,this.target))}stopReflectToCSS(O){this.isReflecting(O)&&(this.reflecting.delete(O),DesignTokenNode.cssCustomPropertyReflector.stopReflection(O,this.target))}isReflecting(O){return this.reflecting.has(O)}handleChange(O,B){const U=DesignTokenImpl.getTokenById(B);U&&this.hydrate(U,this.getRaw(U))}hydrate(O,B){if(!this.has(O)){const U=this.bindingObservers.get(O);DesignTokenImpl.isDerivedDesignTokenValue(B)?U?U.source!==B&&(this.tearDownBindingObserver(O),this.setupBindingObserver(O,B)):this.setupBindingObserver(O,B):(U&&this.tearDownBindingObserver(O),this.store.set(O,B))}}setupBindingObserver(O,B){const U=new DesignTokenBindingObserver(B,O,this);return this.bindingObservers.set(O,U),U}tearDownBindingObserver(O){return!!this.bindingObservers.has(O)&&(this.bindingObservers.get(O).disconnect(),this.bindingObservers.delete(O),!0)}}DesignTokenNode.cssCustomPropertyReflector=new class{startReflection(O,B){O.subscribe(this,B),this.handleChange({token:O,target:B})}stopReflection(O,B){O.unsubscribe(this,B),this.remove(O,B)}handleChange(O){const{token:B,target:U}=O;this.add(B,U)}add(O,B){Nv.getOrCreate(B).setProperty(O.cssCustomProperty,this.resolveCSSValue(DesignTokenNode.getOrCreate(B).get(O)))}remove(O,B){Nv.getOrCreate(B).removeProperty(O.cssCustomProperty)}resolveCSSValue(O){return O&&"function"==typeof O.createCSS?O.createCSS():O}},tslib_es6_decorate([observable],DesignTokenNode.prototype,"children",void 0);const Dv=Object.freeze({create:function(O){return DesignTokenImpl.from(O)},notifyConnection:O=>!(!O.isConnected||!DesignTokenNode.existsFor(O))&&(DesignTokenNode.getOrCreate(O).bind(),!0),notifyDisconnection:O=>!(O.isConnected||!DesignTokenNode.existsFor(O))&&(DesignTokenNode.getOrCreate(O).unbind(),!0),registerRoot(O=Rv){RootStyleSheetTarget.registerRoot(O)},unregisterRoot(O=Rv){RootStyleSheetTarget.unregisterRoot(O)}}),{create:Lv}=Dv,Bv={background:{colorNeutralAppBackground:Lv("cib-color-neutral-app-background"),colorNeutralAppBackgroundAlt:Lv("cib-color-neutral-app-background-alt"),colorNeutralDrawerBackground:Lv("cib-color-neutral-drawer-background"),colorNeutralLayerCard:Lv("cib-color-neutral-layer-card"),colorNeutralLayerCardAlt:Lv("cib-color-neutral-layer-card-alt"),colorNeutralLayerCardDisabled:Lv("cib-color-neutral-layer-card-disabled"),colorNeutralLayerCardInverted:Lv("cib-color-neutral-layer-card-inverted"),colorNeutralAttributionItemBackgroundHover:Lv("cib-color-neutral-attribution-item-background-hover"),colorNeutralInputBackground:Lv("cib-color-neutral-input-inverted"),colorNeutralInputBackgroundAlt:Lv("cib-color-neutral-input-inverted-alt"),colorNeutralLayerOverlay:Lv("cib-color-neutral-layer-overlay"),colorNeutralLayerOverlayAlt:Lv("cib-color-neutral-layer-overlay-alt"),colorNeutralOverlayBackground:Lv("cib-color-neutral-overlay-background"),colorNeutralPrimaryBackground:Lv("cib-color-neutral-primary-background"),colorNeutralPrimaryBackgroundHover:Lv("cib-color-neutral-primary-background-hover"),colorNeutralPrimaryBackgroundPressed:Lv("cib-color-neutral-primary-background-pressed")},foreground:{colorNeutralForeground:Lv("cib-color-neutral-foreground"),colorNeutralForegroundHint:Lv("cib-color-neutral-foreground-hint"),colorNeutralForegroundHintLight:Lv("cib-color-neutral-foreground-hint-light"),colorNeutralForegroundInverted:Lv("cib-color-neutral-foreground-inverted"),colorNeutralPrimaryForeground:Lv("cib-color-neutral-primary-foreground"),colorNeutralPrimaryForegroundHover:Lv("cib-color-neutral-primary-foreground-hover"),colorNeutralPrimaryForegroundPressed:Lv("cib-color-neutral-primary-foreground-pressed")},stroke:{colorNeutralStroke:Lv("cib-color-neutral-stroke"),colorNeutralLayerOverlayStrokeAlt:Lv("cib-color-neutral-layer-overlay-stroke-alt"),colorNeutralStrokeFocus:Lv("cib-color-neutral-stroke-focus"),colorNeutralAttributionItemStrokeHover:Lv("cib-color-neutral-attribution-item-stroke-hover"),colorNeutralPrimaryStroke:Lv("cib-color-neutral-primary-stroke"),colorNeutralPrimaryStrokeHover:Lv("cib-color-neutral-primary-stroke-hover"),colorNeutralPrimaryStrokePressed:Lv("cib-color-neutral-primary-stroke-pressed")}},{create:Fv}=Dv,zv={background:{colorBrandBackgroundInverted:Fv("cib-color-brand-background-inverted"),colorBrandAlertBackground:Fv("cib-color-brand-alert-background"),colorBrandAppBackground:Fv("cib-color-brand-app-background"),colorBrandPrimaryBackground:Fv("cib-color-brand-primary-background"),colorBrandPrimaryBackgroundHover:Fv("cib-color-brand-primary-background-hover"),colorBrandPrimaryBackgroundPressed:Fv("cib-color-brand-primary-background-pressed"),colorBrandBalancedPrimaryBackground:Fv("cib-color-brand-balanced-primary-background"),colorBrandBalancedPrimaryBackgroundHover:Fv("cib-color-brand-balanced-primary-background-hover"),colorBrandBalancedPrimaryBackgroundPressed:Fv("cib-color-brand-balanced-primary-background-pressed"),colorBrandCreativePrimaryBackground:Fv("cib-color-brand-creative-primary-background"),colorBrandCreativePrimaryBackgroundHover:Fv("cib-color-brand-creative-primary-background-hover"),colorBrandCreativePrimaryBackgroundPressed:Fv("cib-color-brand-creative-primary-background-pressed"),colorBrandPrecisePrimaryBackground:Fv("cib-color-brand-precise-primary-background"),colorBrandPrecisePrimaryBackgroundHover:Fv("cib-color-brand-precise-primary-background-hover"),colorBrandPrecisePrimaryBackgroundPressed:Fv("cib-color-brand-precise-primary-background-pressed"),colorBrandSecondaryBackground:Fv("cib-color-brand-secondary-background"),colorBrandSecondaryBackgroundHover:Fv("cib-color-brand-secondary-background-hover"),colorBrandSecondaryBackgroundPressed:Fv("cib-color-brand-secondary-background-pressed"),colorBrandSecondaryBackgroundSolid:Fv("cib-color-brand-secondary-background-solid"),colorBrandSecondaryBackgroundTransparent:Fv("cib-color-brand-secondary-background-transparent"),colorBrandTertiaryBackground:Fv("cib-color-brand-tertiary-background"),colorBrandTertiaryBackgroundHover:Fv("cib-color-brand-tertiary-background-hover"),colorBrandTertiaryBackgroundPressed:Fv("cib-color-brand-tertiary-background-pressed"),colorBrandTextHighlightBackground:Fv("cib-color-brand-text-highlight-background")},foreground:{colorBrandForegroundInverted:Fv("cib-color-brand-foreground-inverted"),colorBrandAlertForeground:Fv("cib-color-brand-alert-foreground"),colorBrandLinkForeground:Fv("cib-color-brand-link-foreground"),colorBrandAttributionForeground:Fv("cib-color-brand-attribution-foreground"),colorBrandPrimaryForeground:Fv("cib-color-brand-primary-foreground"),colorBrandPrimaryForegroundHover:Fv("cib-color-brand-primary-foreground-hover"),colorBrandPrimaryForegroundPressed:Fv("cib-color-brand-primary-foreground-pressed"),colorBrandSecondaryForeground:Fv("cib-color-brand-secondary-foreground"),colorBrandSecondaryForegroundHover:Fv("cib-color-brand-secondary-foreground-hover"),colorBrandSecondaryForegroundPressed:Fv("cib-color-brand-secondary-foreground-pressed"),colorBrandTertiaryForeground:Fv("cib-color-brand-tertiary-foreground"),colorBrandTertiaryForegroundHover:Fv("cib-color-brand-tertiary-foreground-hover"),colorBrandTertiaryForegroundPressed:Fv("cib-color-brand-tertiary-foreground-pressed")},stroke:{colorBrandAlertStroke:Fv("cib-color-brand-alert-stroke"),colorBrandSecondaryStroke:Fv("cib-color-brand-secondary-stroke"),colorBrandSecondaryStrokeHover:Fv("cib-color-brand-secondary-stroke-hover"),colorBrandSecondaryStrokePressed:Fv("cib-color-brand-secondary-stroke-pressed")}},{create:$v}=Dv,Uv={core:$v("cib-color-brand-gradient-core"),vibrant:$v("cib-color-brand-gradient-vibrant"),background:$v("cib-color-brand-gradient-background")},{create:Vv}=Dv,Gv={background:{colorStealthPrimaryBackground:Vv("cib-color-stealth-primary-background"),colorStealthPrimaryBackgroundHover:Vv("cib-color-stealth-primary-background-hover"),colorStealthPrimaryBackgroundPressed:Vv("cib-color-stealth-primary-background-pressed"),colorStealthSecondaryBackground:Vv("cib-color-stealth-secondary-background"),colorStealthSecondaryBackgroundHover:Vv("cib-color-stealth-secondary-background-hover"),colorStealthSecondaryBackgroundPressed:Vv("cib-color-stealth-secondary-background-pressed")},foreground:{colorStealthPrimaryForeground:Vv("cib-color-stealth-primary-foreground"),colorStealthPrimaryForegroundHover:Vv("cib-color-stealth-primary-foreground-hover"),colorStealthPrimaryForegroundPressed:Vv("cib-color-stealth-primary-foreground-pressed"),colorStealthSecondaryForeground:Vv("cib-color-stealth-secondary-foreground"),colorStealthSecondaryForegroundHover:Vv("cib-color-stealth-secondary-foreground-hover"),colorStealthSecondaryForegroundPressed:Vv("cib-color-stealth-secondary-foreground-pressed")}},{create:Hv}=Dv,qv={themed:{background:Hv("cib-image-background")}},{create:jv}=Dv,Wv={corners:{narrow:jv("cib-corner-radius-narrow"),normal:jv("cib-corner-radius-normal"),wide:jv("cib-corner-radius-wide")}},{create:Yv}=Dv,Kv={duration:{faster:Yv("cib-motion-duration-faster"),fast:Yv("cib-motion-duration-fast"),normal:Yv("cib-motion-duration-normal"),slow:Yv("cib-motion-duration-slow"),slower:Yv("cib-motion-duration-slower"),slowest:Yv("cib-motion-duration-slowest")},durationNumber:{faster:Yv("cib-motion-duration-faster-number"),fast:Yv("cib-motion-duration-fast-number"),normal:Yv("cib-motion-duration-normal-number"),slow:Yv("cib-motion-duration-slow-number"),slower:Yv("cib-motion-duration-slower-number"),slowest:Yv("cib-motion-duration-slowest-number")},easingFunction:{linear:Yv("cib-motion-easing-linear"),motionIn:Yv("cib-motion-easing-in"),motionOut:Yv("cib-motion-easing-out"),motionStrong:Yv("cib-motion-easing-strong"),motionDirect:Yv("cib-motion-easing-direct"),motionTransition:Yv("cib-motion-easing-transition")}},{create:Qv}=Dv,Zv={defaults:{card:Qv("cib-shadow-card"),cardRaised:Qv("cib-shadow-card-raised"),dialog:Qv("cib-shadow-dialog"),flyout:Qv("cib-shadow-flyout"),layer:Qv("cib-shadow-layer"),panel:Qv("cib-shadow-panel"),tooltip:Qv("cib-shadow-tooltip")},elevations:{elevation1:Qv("cib-shadow-elevation-1"),elevation2:Qv("cib-shadow-elevation-2"),elevation4:Qv("cib-shadow-elevation-4"),elevation8:Qv("cib-shadow-elevation-8"),elevation16:Qv("cib-shadow-elevation-16"),elevation28:Qv("cib-shadow-elevation-28"),elevation64:Qv("cib-shadow-elevation-64")}},{create:Xv}=Dv,Jv={fonts:{text:Xv("cib-font-text"),icons:Xv("cib-font-icons")},typeRamp:{caption2:{fontSize:Xv("cib-type-caption2-font-size"),lineHeight:Xv("cib-type-caption2-line-height"),fontWeight:Xv("cib-type-caption2-font-weight"),fontVariationSettings:Xv("cib-type-caption2-font-variation-settings")},caption2Strong:{fontSize:Xv("cib-type-caption2-strong-font-size"),lineHeight:Xv("cib-type-caption2-strong-line-height"),fontWeight:Xv("cib-type-caption2-strong-font-weight"),fontVariationSettings:Xv("cib-type-caption2-strong-font-variation-settings")},caption1:{fontSize:Xv("cib-type-caption1-font-size"),lineHeight:Xv("cib-type-caption1-line-height"),fontWeight:Xv("cib-type-caption1-font-weight"),fontVariationSettings:Xv("cib-type-caption1-font-variation-settings")},caption1Strong:{fontSize:Xv("cib-type-caption1-strong-font-size"),lineHeight:Xv("cib-type-caption1-strong-line-height"),fontWeight:Xv("cib-type-caption1-strong-font-weight"),fontVariationSettings:Xv("cib-type-caption1-strong-font-variation-settings")},caption1Stronger:{fontSize:Xv("cib-type-caption1-stronger-font-size"),lineHeight:Xv("cib-type-caption1-stronger-line-height"),fontWeight:Xv("cib-type-caption1-stronger-font-weight"),fontVariationSettings:Xv("cib-type-caption1-stronger-font-variation-settings")},body1:{fontSize:Xv("cib-type-body1-font-size"),lineHeight:Xv("cib-type-body1-line-height"),fontWeight:Xv("cib-type-body1-font-weight"),fontVariationSettings:Xv("cib-type-body1-font-variation-settings")},body1Strong:{fontSize:Xv("cib-type-body1-strong-font-size"),lineHeight:Xv("cib-type-body1-strong-line-height"),fontWeight:Xv("cib-type-body1-strong-font-weight"),fontVariationSettings:Xv("cib-type-body1-strong-font-variation-settings")},body1Stronger:{fontSize:Xv("cib-type-body1-stronger-font-size"),lineHeight:Xv("cib-type-body1-stronger-line-height"),fontWeight:Xv("cib-type-body1-stronger-font-weight"),fontVariationSettings:Xv("cib-type-body1-stronger-font-variation-settings")},body2:{fontSize:Xv("cib-type-body2-font-size"),lineHeight:Xv("cib-type-body2-line-height"),fontWeight:Xv("cib-type-body2-font-weight"),fontVariationSettings:Xv("cib-type-body2-font-variation-settings")},subtitle2:{fontSize:Xv("cib-type-subtitle2-font-size"),lineHeight:Xv("cib-type-subtitle2-line-height"),fontWeight:Xv("cib-type-subtitle2-font-weight"),fontVariationSettings:Xv("cib-type-subtitle2-font-variation-settings")},subtitle2Stronger:{fontSize:Xv("cib-type-subtitle2-stronger-font-size"),lineHeight:Xv("cib-type-subtitle2-stronger-line-height"),fontWeight:Xv("cib-type-subtitle2-stronger-font-weight"),fontVariationSettings:Xv("cib-type-subtitle2-stronger-font-variation-settings")},subtitle1:{fontSize:Xv("cib-type-subtitle1-font-size"),lineHeight:Xv("cib-type-subtitle1-line-height"),fontWeight:Xv("cib-type-subtitle1-font-weight"),fontVariationSettings:Xv("cib-type-subtitle1-font-variation-settings")},message:{fontSize:Xv("cib-type-message-font-size"),lineHeight:Xv("cib-type-message-line-height"),fontWeight:Xv("cib-type-message-font-weight"),fontVariationSettings:Xv("cib-type-message-font-variation-settings")},messageStrong:{fontSize:Xv("cib-type-message-strong-font-size"),lineHeight:Xv("cib-type-message-strong-line-height"),fontWeight:Xv("cib-type-message-strong-font-weight"),fontVariationSettings:Xv("cib-type-message-strong-font-variation-settings")},title3:{fontSize:Xv("cib-type-title3-font-size"),lineHeight:Xv("cib-type-title3-line-height"),fontWeight:Xv("cib-type-title3-font-weight"),fontVariationSettings:Xv("cib-type-title3-font-variation-settings")},title2:{fontSize:Xv("cib-type-title2-font-size"),lineHeight:Xv("cib-type-title2-line-height"),fontWeight:Xv("cib-type-title2-font-weight"),fontVariationSettings:Xv("cib-type-title2-font-variation-settings")},title1:{fontSize:Xv("cib-type-title1-font-size"),lineHeight:Xv("cib-type-title1-line-height"),fontWeight:Xv("cib-type-title1-font-weight"),fontVariationSettings:Xv("cib-type-title1-font-variation-settings")},largeTitle:{fontSize:Xv("cib-type-large-title-font-size"),lineHeight:Xv("cib-type-large-title-line-height"),fontWeight:Xv("cib-type-large-title-font-weight"),fontVariationSettings:Xv("cib-type-large-title-font-variation-settings")},display:{fontSize:Xv("cib-type-display-font-size"),lineHeight:Xv("cib-type-display-line-height"),fontWeight:Xv("cib-type-display-font-weight"),fontVariationSettings:Xv("cib-type-display-font-variation-settings")}}},{create:eb}=Dv,tb={theme:{neutralColors:Bv,brandColors:zv,gradientColors:Uv,stealthColors:Gv,shadows:Zv,icons:{themed:{colorStatusPositivePrimary:eb("cib-color-icon-green-confirm"),colorStatusNegativePrimary:eb("cib-color-icon-red-cancel")}},images:qv},platform:{typography:Jv,measurements:Wv},static:{motion:Kv}};function brandColors(){return{background:{colorBrandBackgroundInverted:sv,colorBrandAlertBackground:"#e9dce3",colorBrandAppBackground:X_,colorBrandPrimaryBackground:z_,colorBrandPrimaryBackgroundHover:$_,colorBrandPrimaryBackgroundPressed:U_,colorBrandBalancedPrimaryBackground:V_,colorBrandBalancedPrimaryBackgroundHover:G_,colorBrandBalancedPrimaryBackgroundPressed:H_,colorBrandCreativePrimaryBackground:Y_,colorBrandCreativePrimaryBackgroundHover:K_,colorBrandCreativePrimaryBackgroundPressed:Q_,colorBrandPrecisePrimaryBackground:q_,colorBrandPrecisePrimaryBackgroundHover:j_,colorBrandPrecisePrimaryBackgroundPressed:W_,colorBrandSecondaryBackground:pv,colorBrandSecondaryBackgroundHover:r_,colorBrandSecondaryBackgroundPressed:o_,colorBrandSecondaryBackgroundSolid:r_,colorBrandSecondaryBackgroundTransparent:i_,colorBrandTertiaryBackground:o_,colorBrandTertiaryBackgroundHover:n_,colorBrandTertiaryBackgroundPressed:r_,colorBrandTextHighlightBackground:n_},foreground:{colorBrandForegroundInverted:o_,colorBrandAlertForeground:B_,colorBrandLinkForeground:O_,colorBrandAttributionForeground:D_,colorBrandPrimaryForeground:uv,colorBrandPrimaryForegroundHover:uv,colorBrandPrimaryForegroundPressed:uv,colorBrandSecondaryForeground:s_,colorBrandSecondaryForegroundHover:s_,colorBrandSecondaryForegroundPressed:c_,colorBrandTertiaryForeground:l_,colorBrandTertiaryForegroundHover:l_,colorBrandTertiaryForegroundPressed:l_},stroke:{colorBrandAlertStroke:"rgba(200, 0, 0, 0.5)",colorBrandSecondaryStroke:s_,colorBrandSecondaryStrokeHover:s_,colorBrandSecondaryStrokePressed:c_}}}function stealthColors(){return{background:{colorStealthPrimaryBackground:"transparent",colorStealthPrimaryBackgroundHover:ev,colorStealthPrimaryBackgroundPressed:ev,colorStealthSecondaryBackground:"transparent",colorStealthSecondaryBackgroundHover:ev,colorStealthSecondaryBackgroundPressed:ev},foreground:{colorStealthPrimaryForeground:l_,colorStealthPrimaryForegroundHover:c_,colorStealthPrimaryForegroundPressed:d_,colorStealthSecondaryForeground:wv,colorStealthSecondaryForegroundHover:kv,colorStealthSecondaryForegroundPressed:Av}}}function gradientColors(){return{core:z_,vibrant:Z_,background:J_}}const ib=function deepFreeze(O){for(const B of Object.values(O))(B&&"object"==typeof B||"function"==typeof B)&&deepFreeze(B);return Object.freeze(O)}({theme:{neutralColors:neutralColors(),brandColors:brandColors(),stealthColors:stealthColors(),gradientColors:gradientColors(),icons:{themed:{colorStatusNegativePrimary:"#c80000",colorStatusPositivePrimary:"#13a10e"}},images:{themed:{background:'url("https://www.bing.com/cdx/bg.jpg")'}},shadows:shadows()},platform:{measurements:{corners:{narrow:2,normal:4,wide:8}},typography:{fonts:{text:"-apple-system, Roboto, SegoeUI, 'Segoe UI', 'Helvetica Neue', Helvetica, 'Microsoft YaHei', 'Meiryo UI', Meiryo, Arial Unicode MS, sans-serif",icons:"'Fluent Icons'"},typeRamp:{caption2:{fontSize:"10px",lineHeight:"14px",fontWeight:"unset",fontVariationSettings:"'wght' 400, 'opsz' 8"},caption2Strong:{fontSize:"10px",lineHeight:"14px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 8"},caption1:{fontSize:"12px",lineHeight:"16px",fontWeight:"unset",fontVariationSettings:"'wght' 400, 'opsz' 10.5"},caption1Strong:{fontSize:"12px",lineHeight:"16px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 10.5"},caption1Stronger:{fontSize:"12px",lineHeight:"16px",fontWeight:"unset",fontVariationSettings:"'wght' 700, 'opsz' 10.5"},body1:{fontSize:"14px",lineHeight:"20px",fontWeight:"unset",fontVariationSettings:"'wght' 400, 'opsz' 10.5"},body1Strong:{fontSize:"14px",lineHeight:"20px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 10.5"},body1Stronger:{fontSize:"14px",lineHeight:"20px",fontWeight:"unset",fontVariationSettings:"'wght' 700, 'opsz' 10.5"},body2:{fontSize:"16px",lineHeight:"22px",fontWeight:"unset",fontVariationSettings:"'wght' 400, 'opsz' 10.5"},subtitle2:{fontSize:"16px",lineHeight:"22px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 10.5"},subtitle2Stronger:{fontSize:"16px",lineHeight:"22px",fontWeight:"unset",fontVariationSettings:"'wght' 700, 'opsz' 10.5"},subtitle1:{fontSize:"20px",lineHeight:"26px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 10.5"},message:{fontSize:"18px",lineHeight:"24px",fontWeight:"unset",fontVariationSettings:"'wght' 400, 'opsz' 36"},messageStrong:{fontSize:"18px",lineHeight:"24px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 36"},title3:{fontSize:"24px",lineHeight:"32px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 36"},title2:{fontSize:"28px",lineHeight:"36px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 36"},title1:{fontSize:"32px",lineHeight:"40px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 36"},largeTitle:{fontSize:"40px",lineHeight:"52px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 36"},display:{fontSize:"68px",lineHeight:"92px",fontWeight:"unset",fontVariationSettings:"'wght' 600, 'opsz' 36"}}}},static:{motion:{duration:{faster:"83ms",fast:"187ms",normal:"333ms",slow:"500ms",slower:"667ms",slowest:"1000ms"},durationNumber:{faster:83,fast:187,normal:333,slow:500,slower:667,slowest:1e3},easingFunction:{linear:"cubic-bezier(0,0,1,1)",motionIn:"cubic-bezier(0,0,0,1)",motionOut:"cubic-bezier(1,0,1,1)",motionStrong:"cubic-bezier(0.13,1.62,0,0.92)",motionDirect:"cubic-bezier(0.55,0.55,0,1)",motionTransition:"cubic-bezier(0.75, 0, 0.25, 1)"}}}});class ThemeManager extends DesignTokenManager{constructor(){super(...arguments),this.defaultTokenValues=ib}getDesignTokens(){return tb}}var rb;const nb={theme:{}},ab={neutralColors:neutralColors(),shadows:shadows(),images:{themed:{background:'url("https://www.bing.com/cdx/bg.jpg")'}}},sb={[sr.Balanced]:{brandColors:brandColors(),gradientColors:gradientColors(),stealthColors:stealthColors()},[sr.Creative]:{brandColors:{background:{colorBrandBackgroundInverted:sv,colorBrandAlertBackground:"#e9dce3",colorBrandAppBackground:X_,colorBrandPrimaryBackground:Y_,colorBrandPrimaryBackgroundHover:K_,colorBrandPrimaryBackgroundPressed:Q_,colorBrandBalancedPrimaryBackground:V_,colorBrandBalancedPrimaryBackgroundHover:G_,colorBrandBalancedPrimaryBackgroundPressed:H_,colorBrandCreativePrimaryBackground:Y_,colorBrandCreativePrimaryBackgroundHover:K_,colorBrandCreativePrimaryBackgroundPressed:Q_,colorBrandPrecisePrimaryBackground:q_,colorBrandPrecisePrimaryBackgroundHover:j_,colorBrandPrecisePrimaryBackgroundPressed:W_,colorBrandSecondaryBackground:pv,colorBrandSecondaryBackgroundHover:h_,colorBrandSecondaryBackgroundPressed:g_,colorBrandSecondaryBackgroundSolid:h_,colorBrandSecondaryBackgroundTransparent:u_,colorBrandTertiaryBackground:g_,colorBrandTertiaryBackgroundHover:m_,colorBrandTertiaryBackgroundPressed:h_,colorBrandTextHighlightBackground:m_},foreground:{colorBrandForegroundInverted:g_,colorBrandAlertForeground:B_,colorBrandLinkForeground:O_,colorBrandAttributionForeground:D_,colorBrandPrimaryForeground:uv,colorBrandPrimaryForegroundHover:uv,colorBrandPrimaryForegroundPressed:uv,colorBrandSecondaryForeground:y_,colorBrandSecondaryForegroundHover:y_,colorBrandSecondaryForegroundPressed:b_,colorBrandTertiaryForeground:v_,colorBrandTertiaryForegroundHover:v_,colorBrandTertiaryForegroundPressed:v_},stroke:{colorBrandAlertStroke:"rgba(200, 0, 0, 0.5)",colorBrandSecondaryStroke:y_,colorBrandSecondaryStrokeHover:y_,colorBrandSecondaryStrokePressed:b_}},gradientColors:{core:Y_,vibrant:Z_,background:J_},stealthColors:{background:{colorStealthPrimaryBackground:"transparent",colorStealthPrimaryBackgroundHover:ev,colorStealthPrimaryBackgroundPressed:ev,colorStealthSecondaryBackground:"transparent",colorStealthSecondaryBackgroundHover:ev,colorStealthSecondaryBackgroundPressed:ev},foreground:{colorStealthPrimaryForeground:v_,colorStealthPrimaryForegroundHover:b_,colorStealthPrimaryForegroundPressed:S_,colorStealthSecondaryForeground:wv,colorStealthSecondaryForegroundHover:kv,colorStealthSecondaryForegroundPressed:Av}}},[sr.Precise]:{brandColors:{background:{colorBrandBackgroundInverted:sv,colorBrandAlertBackground:"#e9dce3",colorBrandAppBackground:X_,colorBrandPrimaryBackground:q_,colorBrandPrimaryBackgroundHover:j_,colorBrandPrimaryBackgroundPressed:W_,colorBrandBalancedPrimaryBackground:V_,colorBrandBalancedPrimaryBackgroundHover:G_,colorBrandBalancedPrimaryBackgroundPressed:H_,colorBrandCreativePrimaryBackground:Y_,colorBrandCreativePrimaryBackgroundHover:K_,colorBrandCreativePrimaryBackgroundPressed:Q_,colorBrandPrecisePrimaryBackground:q_,colorBrandPrecisePrimaryBackgroundHover:j_,colorBrandPrecisePrimaryBackgroundPressed:W_,colorBrandSecondaryBackground:pv,colorBrandSecondaryBackgroundHover:x_,colorBrandSecondaryBackgroundPressed:w_,colorBrandSecondaryBackgroundSolid:x_,colorBrandSecondaryBackgroundTransparent:E_,colorBrandTertiaryBackground:w_,colorBrandTertiaryBackgroundHover:T_,colorBrandTertiaryBackgroundPressed:x_,colorBrandTextHighlightBackground:T_},foreground:{colorBrandForegroundInverted:w_,colorBrandAlertForeground:B_,colorBrandLinkForeground:O_,colorBrandAttributionForeground:D_,colorBrandPrimaryForeground:uv,colorBrandPrimaryForegroundHover:uv,colorBrandPrimaryForegroundPressed:uv,colorBrandSecondaryForeground:A_,colorBrandSecondaryForegroundHover:A_,colorBrandSecondaryForegroundPressed:I_,colorBrandTertiaryForeground:R_,colorBrandTertiaryForegroundHover:R_,colorBrandTertiaryForegroundPressed:R_},stroke:{colorBrandAlertStroke:"rgba(200, 0, 0, 0.5)",colorBrandSecondaryStroke:A_,colorBrandSecondaryStrokeHover:A_,colorBrandSecondaryStrokePressed:I_}},gradientColors:{core:q_,vibrant:Z_,background:J_},stealthColors:{background:{colorStealthPrimaryBackground:"transparent",colorStealthPrimaryBackgroundHover:ev,colorStealthPrimaryBackgroundPressed:ev,colorStealthSecondaryBackground:"transparent",colorStealthSecondaryBackgroundHover:ev,colorStealthSecondaryBackgroundPressed:ev},foreground:{colorStealthPrimaryForeground:R_,colorStealthPrimaryForegroundHover:I_,colorStealthPrimaryForegroundPressed:P_,colorStealthSecondaryForeground:wv,colorStealthSecondaryForegroundHover:kv,colorStealthSecondaryForegroundPressed:Av}}}},lb={neutralColors:{background:{colorNeutralAppBackground:Sv,colorNeutralAppBackgroundAlt:"#2B2B2B",colorNeutralDrawerBackground:vv,colorNeutralLayerCard:av,colorNeutralLayerCardAlt:_v,colorNeutralLayerCardDisabled:nv,colorNeutralLayerCardInverted:r_,colorNeutralLayerOverlay:bv,colorNeutralLayerOverlayAlt:bv,colorNeutralAttributionItemBackgroundHover:ov,colorNeutralInputBackground:av,colorNeutralInputBackgroundAlt:kv,colorNeutralOverlayBackground:rv,colorNeutralPrimaryBackground:yv,colorNeutralPrimaryBackgroundHover:_v,colorNeutralPrimaryBackgroundPressed:fv},foreground:{colorNeutralForeground:mv,colorNeutralForegroundHint:dv,colorNeutralForegroundHintLight:cv,colorNeutralForegroundInverted:Av,colorNeutralPrimaryForeground:mv,colorNeutralPrimaryForegroundHover:hv,colorNeutralPrimaryForegroundPressed:hv},stroke:{colorNeutralStroke:sv,colorNeutralLayerOverlayStrokeAlt:sv,colorNeutralAttributionItemStrokeHover:av,colorNeutralStrokeFocus:hv,colorNeutralPrimaryStroke:gv,colorNeutralPrimaryStrokeHover:gv,colorNeutralPrimaryStrokePressed:gv}},shadows:function(){const O={elevation1:"0px 0.5px 1px rgba(0, 0, 0, 0.28), 0px 0px 1px rgba(0, 0, 0, 0.24)",elevation2:"0px 1px 2px rgba(0, 0, 0, 0.28), 0px 0px 2px rgba(0, 0, 0, 0.24)",elevation4:"0px 2px 4px rgba(0, 0, 0, 0.28), 0px 0px 2px rgba(0, 0, 0, 0.24)",elevation8:"0px 4px 8px rgba(0, 0, 0, 0.28), 0px 0px 2px rgba(0, 0, 0, 0.24)",elevation16:"0px 8px 16px rgba(0, 0, 0, 0.28), 0px 0px 2px rgba(0, 0, 0, 0.24)",elevation28:"0px 14px 28px rgba(0, 0, 0, 0.48), 0px 0px 8px rgba(0, 0, 0, 0.4)",elevation64:"0px 32px 64px rgba(0, 0, 0, 0.48), 0px 0px 8px rgba(0, 0, 0, 0.4)"};return{defaults:{card:"0px 0px 0px 1px rgba(255, 255, 255, 0.2)",cardRaised:O.elevation8,dialog:O.elevation64,flyout:O.elevation16,layer:O.elevation2,panel:O.elevation28,tooltip:O.elevation16},elevations:O}}(),images:{themed:{background:'url("https://www.bing.com/cdx/bg-dark.jpg")'}}},cb={[sr.Balanced]:{brandColors:{background:{colorBrandBackgroundInverted:o_,colorBrandAlertBackground:bv,colorBrandAppBackground:J_,colorBrandPrimaryBackground:z_,colorBrandPrimaryBackgroundHover:$_,colorBrandPrimaryBackgroundPressed:U_,colorBrandBalancedPrimaryBackground:V_,colorBrandBalancedPrimaryBackgroundHover:G_,colorBrandBalancedPrimaryBackgroundPressed:H_,colorBrandCreativePrimaryBackground:Y_,colorBrandCreativePrimaryBackgroundHover:K_,colorBrandCreativePrimaryBackgroundPressed:Q_,colorBrandPrecisePrimaryBackground:q_,colorBrandPrecisePrimaryBackgroundHover:j_,colorBrandPrecisePrimaryBackgroundPressed:W_,colorBrandSecondaryBackground:av,colorBrandSecondaryBackgroundHover:sv,colorBrandSecondaryBackgroundPressed:lv,colorBrandSecondaryBackgroundSolid:"#30314c",colorBrandSecondaryBackgroundTransparent:"#30314c00",colorBrandTertiaryBackground:p_,colorBrandTertiaryBackgroundHover:d_,colorBrandTertiaryBackgroundPressed:c_,colorBrandTextHighlightBackground:ov},foreground:{colorBrandForegroundInverted:p_,colorBrandAlertForeground:F_,colorBrandLinkForeground:M_,colorBrandAttributionForeground:L_,colorBrandPrimaryForeground:uv,colorBrandPrimaryForegroundHover:uv,colorBrandPrimaryForegroundPressed:uv,colorBrandSecondaryForeground:a_,colorBrandSecondaryForegroundHover:a_,colorBrandSecondaryForegroundPressed:o_,colorBrandTertiaryForeground:a_,colorBrandTertiaryForegroundHover:a_,colorBrandTertiaryForegroundPressed:p_},stroke:{colorBrandAlertStroke:sv,colorBrandSecondaryStroke:a_,colorBrandSecondaryStrokeHover:a_,colorBrandSecondaryStrokePressed:o_}},gradientColors:{core:z_,vibrant:Z_,background:J_},stealthColors:{background:{colorStealthPrimaryBackground:"transparent",colorStealthPrimaryBackgroundHover:ov,colorStealthPrimaryBackgroundPressed:av,colorStealthSecondaryBackground:"transparent",colorStealthSecondaryBackgroundHover:ov,colorStealthSecondaryBackgroundPressed:av},foreground:{colorStealthPrimaryForeground:a_,colorStealthPrimaryForegroundHover:a_,colorStealthPrimaryForegroundPressed:a_,colorStealthSecondaryForeground:mv,colorStealthSecondaryForegroundHover:hv,colorStealthSecondaryForegroundPressed:hv}}},[sr.Creative]:{brandColors:{background:{colorBrandBackgroundInverted:g_,colorBrandAlertBackground:bv,colorBrandAppBackground:J_,colorBrandPrimaryBackground:Y_,colorBrandPrimaryBackgroundHover:K_,colorBrandPrimaryBackgroundPressed:Q_,colorBrandBalancedPrimaryBackground:V_,colorBrandBalancedPrimaryBackgroundHover:G_,colorBrandBalancedPrimaryBackgroundPressed:H_,colorBrandCreativePrimaryBackground:Y_,colorBrandCreativePrimaryBackgroundHover:K_,colorBrandCreativePrimaryBackgroundPressed:Q_,colorBrandPrecisePrimaryBackground:q_,colorBrandPrecisePrimaryBackgroundHover:j_,colorBrandPrecisePrimaryBackgroundPressed:W_,colorBrandSecondaryBackground:av,colorBrandSecondaryBackgroundHover:sv,colorBrandSecondaryBackgroundPressed:lv,colorBrandSecondaryBackgroundSolid:"#30314c",colorBrandSecondaryBackgroundTransparent:"#30314c00",colorBrandTertiaryBackground:C_,colorBrandTertiaryBackgroundHover:S_,colorBrandTertiaryBackgroundPressed:b_,colorBrandTextHighlightBackground:ov},foreground:{colorBrandForegroundInverted:C_,colorBrandAlertForeground:F_,colorBrandLinkForeground:M_,colorBrandAttributionForeground:L_,colorBrandPrimaryForeground:uv,colorBrandPrimaryForegroundHover:uv,colorBrandPrimaryForegroundPressed:uv,colorBrandSecondaryForeground:f_,colorBrandSecondaryForegroundHover:f_,colorBrandSecondaryForegroundPressed:g_,colorBrandTertiaryForeground:f_,colorBrandTertiaryForegroundHover:f_,colorBrandTertiaryForegroundPressed:C_},stroke:{colorBrandAlertStroke:sv,colorBrandSecondaryStroke:f_,colorBrandSecondaryStrokeHover:f_,colorBrandSecondaryStrokePressed:g_}},gradientColors:{core:Y_,vibrant:Z_,background:J_},stealthColors:{background:{colorStealthPrimaryBackground:"transparent",colorStealthPrimaryBackgroundHover:ov,colorStealthPrimaryBackgroundPressed:av,colorStealthSecondaryBackground:"transparent",colorStealthSecondaryBackgroundHover:ov,colorStealthSecondaryBackgroundPressed:av},foreground:{colorStealthPrimaryForeground:f_,colorStealthPrimaryForegroundHover:f_,colorStealthPrimaryForegroundPressed:f_,colorStealthSecondaryForeground:mv,colorStealthSecondaryForegroundHover:hv,colorStealthSecondaryForegroundPressed:hv}}},[sr.Precise]:{brandColors:{background:{colorBrandBackgroundInverted:w_,colorBrandAlertBackground:bv,colorBrandAppBackground:J_,colorBrandPrimaryBackground:q_,colorBrandPrimaryBackgroundHover:j_,colorBrandPrimaryBackgroundPressed:W_,colorBrandBalancedPrimaryBackground:V_,colorBrandBalancedPrimaryBackgroundHover:G_,colorBrandBalancedPrimaryBackgroundPressed:H_,colorBrandCreativePrimaryBackground:Y_,colorBrandCreativePrimaryBackgroundHover:K_,colorBrandCreativePrimaryBackgroundPressed:Q_,colorBrandPrecisePrimaryBackground:q_,colorBrandPrecisePrimaryBackgroundHover:j_,colorBrandPrecisePrimaryBackgroundPressed:W_,colorBrandSecondaryBackground:av,colorBrandSecondaryBackgroundHover:sv,colorBrandSecondaryBackgroundPressed:lv,colorBrandSecondaryBackgroundSolid:"#30314c",colorBrandSecondaryBackgroundTransparent:"#30314c00",colorBrandTertiaryBackground:N_,colorBrandTertiaryBackgroundHover:P_,colorBrandTertiaryBackgroundPressed:I_,colorBrandTextHighlightBackground:ov},foreground:{colorBrandForegroundInverted:N_,colorBrandAlertForeground:F_,colorBrandLinkForeground:M_,colorBrandAttributionForeground:L_,colorBrandPrimaryForeground:uv,colorBrandPrimaryForegroundHover:uv,colorBrandPrimaryForegroundPressed:uv,colorBrandSecondaryForeground:k_,colorBrandSecondaryForegroundHover:k_,colorBrandSecondaryForegroundPressed:w_,colorBrandTertiaryForeground:k_,colorBrandTertiaryForegroundHover:k_,colorBrandTertiaryForegroundPressed:N_},stroke:{colorBrandAlertStroke:sv,colorBrandSecondaryStroke:k_,colorBrandSecondaryStrokeHover:k_,colorBrandSecondaryStrokePressed:w_}},gradientColors:{core:q_,vibrant:Z_,background:J_},stealthColors:{background:{colorStealthPrimaryBackground:"transparent",colorStealthPrimaryBackgroundHover:ov,colorStealthPrimaryBackgroundPressed:av,colorStealthSecondaryBackground:"transparent",colorStealthSecondaryBackgroundHover:ov,colorStealthSecondaryBackgroundPressed:av},foreground:{colorStealthPrimaryForeground:k_,colorStealthPrimaryForegroundHover:k_,colorStealthPrimaryForegroundPressed:k_,colorStealthSecondaryForeground:mv,colorStealthSecondaryForegroundHover:hv,colorStealthSecondaryForegroundPressed:hv}}}};class DesignSystemManager extends lifecycle_Disposable{constructor(){super(),rb.set(this,this._register(new Emitter)),this.isInitialized=!1,this.tokens=new ThemeManager,this.colorScheme=e_.Light}get onDesignSystemChanged(){return __classPrivateFieldGet(this,rb,"f").event}initialize(O){this.isInitialized||(O&&this.updateTargetElement(O),this.tokens.initialize(),this.isInitialized=!0)}activateDefaults(O){null!==O&&this.updateTargetElement(O),this.initialize(O),this.tokens.reset(),this.colorSchemeChanged()}updateTargetElement(O){O&&(this.tokens.element=O)}colorSchemeChanged(){const O=this.updateBaseThemeValues(),B=this.updateResponseToneColors();(O||B)&&__classPrivateFieldGet(this,rb,"f").fire(this)}responseModeChanged(){this.updateResponseToneColors()&&__classPrivateFieldGet(this,rb,"f").fire(this)}updateBaseThemeValues(){if(void 0===this.colorScheme)return!1;switch(this.initialize(),this.colorScheme){case e_.Light:nb.theme=ab,this.tokens.mutate(nb);break;case e_.Dark:nb.theme=lb,this.tokens.mutate(nb)}return!0}updateResponseToneColors(){if(!this.responseMode)return!1;switch(this.initialize(),this.colorScheme){case e_.Light:nb.theme=sb[this.responseMode],this.tokens.mutate(nb);break;case e_.Dark:nb.theme=cb[this.responseMode],this.tokens.mutate(nb)}return!0}}rb=new WeakMap,__decorate([observable,__metadata("design:type",Number)],DesignSystemManager.prototype,"colorScheme",void 0),__decorate([observable,__metadata("design:type",String)],DesignSystemManager.prototype,"responseMode",void 0);const db=new DesignSystemManager;const pb=kt.createInterface("IWorkToggleViewModel");let ub=class extends ViewModelBase{constructor(O,B,U,G,q,j){var W;super(O,B,U,j),this.config=G,this.workToggle=q,this.imageTopLayerOpacity=1,this.imageTopLayerPositionX="0%",this.imageTopLayerPositionY="0%",this.imageBottomLayerPositionX="0%",this.imageBottomLayerPositionY="0%",this.imageLightThemePositionY="0%",this.imageDarkThemePositionY="100%",this.imageTopLayerTimeout=333,this.handleDesignSystemChanged=O=>{var B;null===(B=this.log)||void 0===B||B.trace(this,this.handleDesignSystemChanged,null).write();const{colorScheme:U,responseMode:G}=O,q=this.getImagePositionX(G),j=U===e_.Light?this.imageLightThemePositionY:this.imageDarkThemePositionY;this.imageBottomLayerPositionX=q,this.imageBottomLayerPositionY=j,this.imageTopLayerOpacity=0,this.imageTopLayerTimer.cancelAndSet((()=>{this.imageTopLayerPositionX=q,this.imageTopLayerPositionY=j,this.imageTopLayerOpacity=1}),this.imageTopLayerTimeout)},null===(W=this.log)||void 0===W||W.trace(this,"ctor",null).write(),this._register(db.onDesignSystemChanged(this.handleDesignSystemChanged)),this.imageTopLayerTimer=this._register(new async_TimeoutTimer)}get isPlain(){return this.config.bingAtWork.isEnabled&&(!this.config.bingAtWork.isWorkToggleEnabled||this.workToggle.isEnabled&&this.workToggle.isWorkIncluded)}getImagePositionX(O){switch(O){case sr.Balanced:return"0%";case sr.Creative:return"50%";case sr.Precise:return"100%"}}};__decorate([observable,__metadata("design:type",Number)],ub.prototype,"imageTopLayerOpacity",void 0),__decorate([observable,__metadata("design:type",String)],ub.prototype,"imageTopLayerPositionX",void 0),__decorate([observable,__metadata("design:type",String)],ub.prototype,"imageTopLayerPositionY",void 0),__decorate([observable,__metadata("design:type",String)],ub.prototype,"imageBottomLayerPositionX",void 0),__decorate([observable,__metadata("design:type",String)],ub.prototype,"imageBottomLayerPositionY",void 0),ub=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,pb),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],ub);const hb=kt.createInterface("ITurnViewModel"),mb=kt.createInterface("IWelcomeContainerViewModel"),gb=kt.createInterface("ISidePanelViewModel");var fb;(function(O){O.Threads="threads",O.Plugins="plugins"})(fb||(fb={}));const yb=kt.createInterface("INotificationContainerViewModel");let _b=class extends ViewModelBase{constructor(O,B,U,G,q){super(O,B,U,q),this.notification=G}get floatingNotification(){return this.notification.floatingBarNotification}get bottomBarNotification(){return this.notification.bottomBarNotification}};_b=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,_h),__param(4,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object])],_b);const vb=kt.createInterface("IToneSelectorViewModel");var bb,Sb,Cb,Eb;let xb=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y,K,Q,Z,X,J,ee){super(O,B,U,ee),this.config=G,this.factory=q,this.errorState=j,this.firstRunExperienceService=W,this.model=Y,this.sidePanel=K,this.hoverCard=Q,this.suggestionService=Z,this.manager=X,this.chat=J,this.strings={letsChatButton:this.config.strings.letsChat,raiSuggestionsButtonAriaLabel:this.config.strings.raiSuggestions},bb.set(this,null),Sb.set(this,null),Cb.set(this,null),Eb.set(this,null),this._turnCount=0,this._turns=[],this._isTyping=!1,this._isScrollTop=!1,this._isScrollBottom=!1,this._scroller=null,this._raiSuggestions=[],this._freSuggestions=[],this._shouldAnimate=!1,this._suggestionBarVisible=!0,this._shouldShowRAISuggestions=!1,this.handleBotMessageReset=(O=Yi.Bot)=>{this.turnCount>0&&(this._turns[this.turnCount-1].resetMessages(O),this.scrollToBottomWithDelay())},this.handleModelReset=()=>{this.reset()},this.handleMessageAdded=O=>{var B;null===(B=this.log)||void 0===B||B.trace(this,this.handleMessageAdded,"conVM handle model message added").write(),this.checkNewTurn(O.author),this.current.addTurnMessage(O),this.config.features.enableServerLogMerging&&this.fireMessageTelemetry(O)},this.handleRequestGenerated=O=>{var B,U,G,q,j;null===(B=this.log)||void 0===B||B.trace(this,this.handleRequestGenerated,"conVM handle request generated").write();const W=O[0],Y=O[1];(null===(U=this.serp)||void 0===U?void 0:U.inMode(Hy.Conversation))?this.telemetry.trackEvent("InteractionEvent","TextMessageSend",{Namespace:jy.toTelemetryNamespace(jy.None),CustomData:JSON.stringify({convId:Y,rid:W.requestId,mid:W.messageId,numCharacters:null===(G=W.text)||void 0===G?void 0:G.length,numWords:null===(q=W.text)||void 0===q?void 0:q.split(/\s+/).length,turnId:this.turnCount}),EncryptedData:JSON.stringify({text:this.telemetry.getComplianceSafeMessage(W.text)})}):this.telemetry.trackEvent("InteractionEvent","SearchQuerySend",{Namespace:jy.toTelemetryNamespace(null===(j=this.serp)||void 0===j?void 0:j.serpSlot),CustomData:JSON.stringify({convId:Y,rid:W.requestId,mid:W.messageId})})},this.attachListeners(),this.fillFRESuggestions()}get isSidePanelEnabled(){return this.sidePanel.isVisible}get isSidePanelDocked(){return this.sidePanel.isThreadsPanelDocked}get welcomeContainer(){var O;return __classPrivateFieldSet(this,bb,null!==(O=__classPrivateFieldGet(this,bb,"f"))&&void 0!==O?O:this.factory.create(mb),"f"),__classPrivateFieldGet(this,bb,"f")}get notificationContainer(){var O;return __classPrivateFieldSet(this,Sb,null!==(O=__classPrivateFieldGet(this,Sb,"f"))&&void 0!==O?O:this.factory.create(yb),"f"),__classPrivateFieldGet(this,Sb,"f")}get lastBotTextMessage(){let O="";for(let B=this.model.messages.length-1;B>=0;B--)if(this.model.messages[B].author===Yi.Bot&&isTextMessageModel(this.model.messages[B])){O=this.model.messages[B].text;break}return O}get toneSelector(){var O;return __classPrivateFieldSet(this,Cb,null!==(O=__classPrivateFieldGet(this,Cb,"f"))&&void 0!==O?O:this.factory.create(vb),"f"),__classPrivateFieldGet(this,Cb,"f")}get workToggle(){var O;return __classPrivateFieldSet(this,Eb,null!==(O=__classPrivateFieldGet(this,Eb,"f"))&&void 0!==O?O:this.factory.create(pb),"f"),__classPrivateFieldGet(this,Eb,"f")}get turnCount(){return this._turnCount}get convId(){return this.model.id}get turns(){return this._turns}get current(){const O=this._turns;return 0===this.turnCount?this.addTurn():O[this.turnCount-1]}get isTyping(){return this._isTyping}get isScrollTop(){return this._isScrollTop}set isScrollTop(O){this._isScrollTop=O}get isScrollBottom(){return this._isScrollBottom}set isScrollBottom(O){this._isScrollTop=O}get scroller(){return this._scroller}get suggestions(){return this.model.suggestions}get suggestionMessageId(){return this.model.suggestionMessageId}get suggestionRequestId(){return this.model.suggestionRequestId}get raiSuggestions(){return this._raiSuggestions}get shouldAnimate(){return this._shouldAnimate}set shouldAnimate(O){this._shouldAnimate=O}get suggestionBarVisible(){return this.errorState.chatErrorState===Gc.OK&&this._suggestionBarVisible}get shouldShowRAISuggestions(){return this._shouldShowRAISuggestions}async openRAISuggestions(){await this.fillRAISuggestions(),0!==this.raiSuggestions.length&&(this._shouldShowRAISuggestions=!0)}closeRAISuggestions(){this._shouldShowRAISuggestions=!1}get freSuggestions(){return this.isFirstTime?this._freSuggestions:[]}clearFreSuggesitons(){this._freSuggestions.splice(0,this._freSuggestions.length)}get slottedModeTurnIndex(){return this.config.sydney.slottedModeTurnIndex}get isRequestPending(){return this.chat.isRequestPending}get isFirstTime(){return this.firstRunExperienceService.isFirstTime}get chatErrorState(){return this.errorState.chatErrorState}async fillFRESuggestions(){if(this.isFirstTime)try{const O=await this.suggestionService.getFRESuggestions();this.setFreSuggestions(this.createSuggestions(O))}catch(O){this.clearFreSuggesitons()}}async fillRAISuggestions(){try{const O=await this.suggestionService.getRAISuggestions();this.setRaiSuggestions(this.createSuggestions(O))}catch(O){this.setRaiSuggestions([])}}ensureInitialized(){0===this.turnCount&&this.model.state===Lc.Inactive&&queueMicrotask((async()=>{await this.manager.beginConversationAsync()}))}addConversationMessage(O){var B,U,G;null===(B=this.log)||void 0===B||B.trace(this,this.addConversationMessage,"conVM add message:",O).write(),this.config.features.enableServerLogMerging?this.telemetry.trackEvent("InteractionEvent","TextMessageEnter",{Namespace:(null===(U=this.serp)||void 0===U?void 0:U.inMode(Hy.Conversation))?jy.toTelemetryNamespace(jy.None):jy.toTelemetryNamespace(null===(G=this.serp)||void 0===G?void 0:G.serpSlot),CustomData:JSON.stringify({numCharacters:O.length,numWords:O.split(/\s+/).length,turnId:this.turnCount,convId:this.model.id})}):this.telemetry.trackEvent("InteractionEvent","TextMessageSend",{Namespace:"Conversation",CustomData:JSON.stringify({numCharacters:O.length,numWords:O.split(/\s+/).length,turnId:this.turnCount,convId:this.model.id}),EncryptedData:JSON.stringify({text:this.telemetry.getComplianceSafeMessage(O)})}),this.clearFreSuggesitons(),this.closeRAISuggestions(),this.manager.sendMessage(O)}setScroller(O){this._scroller!==O&&(this._scroller=O)}scrollToBottom(){this._scroller&&this._scroller.scroll({top:this._scroller.scrollHeight,behavior:"smooth"})}reset(){this._turnCount=0,this.model.setTurnCount(0),this._turns.splice(0,this.turns.length),this._suggestionBarVisible=!0,this.errorState.setChatErrorState(Gc.OK),this.scrollToBottom(),this.addTurn()}checkNewTurn(O){if((this.config.features.enableMaxTurnsPerConversationWithoutTurnCounter||this.config.features.enableMaxTurnsPerConversation)&&this.config.messaging.maxTurnsPerConversation&&this.turnCount>this.config.messaging.maxTurnsPerConversation)this._suggestionBarVisible=!1;else if(0===this.turnCount||O===Yi.User&&this.current.bot.messages.length){if(this.addTurn(),this.scroller&&this.scroller.scrollHeight-this.scroller.scrollTop===this.scroller.clientHeight)return;this.scrollToBottomWithDelay()}}scrollToBottomWithDelay(O=333){setTimeout((()=>{this.scrollToBottom()}),O)}addTurn(){var O;const B=this.factory.create(hb);return this._turns.push(B),B.initialize(this),this._turnCount=this.turns.length,this.model.setTurnCount(this._turnCount),null===(O=this.log)||void 0===O||O.trace(this,this.addTurn,"conVM turn added").write(),B}createSuggestions(O){const B=[];for(let U=0;U<O.length;U++){const G={contentOrigin:Ki.DeepLeo,messageType:tr.Suggestion,offense:nr.Unknown,text:O[U],messageId:"",hiddenText:void 0};B.push(G)}return B}setRaiSuggestions(O){this._raiSuggestions.splice(0,this._raiSuggestions.length,...O)}setFreSuggestions(O){this._freSuggestions.splice(0,this._freSuggestions.length,...O)}attachListeners(){this.model.onReset(this.handleModelReset),this.model.onMessageAdded(this.handleMessageAdded),this.model.onBotMessageReset(this.handleBotMessageReset),this.chat.onRequestGenerated(this.handleRequestGenerated)}fireMessageTelemetry(O){var B,U,G,q,j;O.type===vp.Meta&&O.messageType===tr.InternalSearchQuery&&O.contentOrigin===Ki.DeepLeo&&this.telemetry.trackEvent("MessageEvent","WebSearch",{Namespace:(null===(B=this.serp)||void 0===B?void 0:B.inMode(Hy.Conversation))?jy.toTelemetryNamespace(jy.None):jy.toTelemetryNamespace(null===(U=this.serp)||void 0===U?void 0:U.serpSlot),CustomData:JSON.stringify({query:this.telemetry.getComplianceSafeMessage(null===(G=/`(.*?)`/.exec(O.text))||void 0===G?void 0:G[1]),convId:this.convId,rid:O.requestId,mid:O.messageId,turnId:this.turnCount})}),O.type===vp.Host&&O.contentType===bp.ImageContentCreator&&this.telemetry.trackEvent("MessageEvent","ContentCreatorRender",{Namespace:(null===(q=this.serp)||void 0===q?void 0:q.inMode(Hy.Conversation))?jy.toTelemetryNamespace(jy.None):jy.toTelemetryNamespace(null===(j=this.serp)||void 0===j?void 0:j.serpSlot),CustomData:JSON.stringify({searchQuery:this.telemetry.getComplianceSafeMessage(O.text),convId:this.convId,rid:O.requestId,mid:O.messageId,turnId:this.turnCount})})}};bb=new WeakMap,Sb=new WeakMap,Cb=new WeakMap,Eb=new WeakMap,__decorate([observable,__metadata("design:type",Object)],xb.prototype,"strings",void 0),__decorate([observable,__metadata("design:type",Number)],xb.prototype,"_turnCount",void 0),__decorate([observable,__metadata("design:type",Array)],xb.prototype,"_turns",void 0),__decorate([observable,__metadata("design:type",Boolean)],xb.prototype,"_isTyping",void 0),__decorate([observable,__metadata("design:type",Boolean)],xb.prototype,"_isScrollTop",void 0),__decorate([observable,__metadata("design:type",Boolean)],xb.prototype,"_isScrollBottom",void 0),__decorate([observable,__metadata("design:type",Object),__metadata("design:paramtypes",[])],xb.prototype,"scroller",null),__decorate([observable,__metadata("design:type",Boolean)],xb.prototype,"_shouldAnimate",void 0),__decorate([observable,__metadata("design:type",Boolean)],xb.prototype,"_suggestionBarVisible",void 0),__decorate([observable,__metadata("design:type",Boolean)],xb.prototype,"_shouldShowRAISuggestions",void 0),xb=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Vt),__param(5,Uc),__param(6,Ph),__param(7,Dc),__param(8,gb),__param(9,Wy),__param(10,Ah),__param(11,uh),__param(12,Mc),__param(13,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],xb);const Tb=kt.createInterface("IHistoryConversationViewModel");let wb=class extends ViewModelBase{constructor(O,B,U,G,q){super(O,B,U,q),this.hoverCard=G,this.messages=[],this._messagesReadyToken=new DeferredPromise}async waitForMessagesReadyAsync(O){return this.messages=O,this._messagesReadyToken=new DeferredPromise,setTimeout((()=>{var O;this._messagesReadyToken.complete(!1),null===(O=this.log)||void 0===O||O.warn(this,this.waitForMessagesReadyAsync,"No DOM resize detected")}),2e3),this._messagesReadyToken.p}setMessagesReadyTokenReady(O){var B;this._messagesReadyToken.complete(O),null===(B=this.log)||void 0===B||B.trace(this,this.setMessagesReadyTokenReady,"DOM resize detected")}};__decorate([observable,__metadata("design:type",Array)],wb.prototype,"messages",void 0),wb=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,Wy),__param(4,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object])],wb);let kb=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(O,U,B,j),this.config=G,this.conversation=q,this.copyState=Py.Idle,this.strings={accessed:this.config.strings.feedbackAccessed,source:this.config.strings.feedbackSource,copyButtonAriaLabel:this.config.strings.feedbackCopyButtonAriaLabel,messageActionsCopy:this.config.strings.messageActionsCopy,messageActionsCopying:this.config.strings.messageActionsCopying,messageActionsCopyError:this.config.strings.messageActionsCopyError,messageActionsCopied:this.config.strings.messageActionsCopied,messageActionsReport:this.config.strings.messageActionsReport},this.attributionsCount=0,this.message=null,this.citationRegex=/\[\^([1-9]+)\^\]/g,this.numberToSuperscript={0:"",1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:""},this.idleTimeout=3e3}initialize(O){this.message=O}get shouldShowCopy(){var O,B;return(null===(O=this.message)||void 0===O?void 0:O.author)===Yi.Bot&&!((null===(B=this.message)||void 0===B?void 0:B.messageType)===tr.GenerateContentQuery)}get shouldRenderString(){return!this.config.features.enableOneClickCopy}get isInstrumentationEnabled(){return!!this.config.features.enableCopyButtonInstrumented}shouldShowCopiedToolTip(O){return this.copyState===Py.Copied&&O===Ny.Sidebar}async copyToClipboard(){var O,B;try{if(this.changeCopyState(Py.Copying),!this.message)return null===(O=this.log)||void 0===O||O.error(this,this.copyToClipboard,"Message is null").write(),void this.fireMessageCopyTelemetryEvent("Message is null",Py.Error);const B=this.getCopyTextWithCitations();B?this.copyText(B):this.copyText(this.message.text),this.fireMessageCopyTelemetryEvent(null,Py.Copying)}catch(O){this.changeCopyState(Py.Error),isError(O)&&(null===(B=this.log)||void 0===B||B.error(this,this.copyToClipboard,`Failed to copy. Reason: ${O.message}`).write()),this.fireMessageCopyTelemetryEvent(isError(O)?O.message:null,Py.Error)}}getCopyTextWithCitations(){var O,B,U;if(!this.message)throw null===(O=this.log)||void 0===O||O.error(this,this.getCopyTextWithCitations,"Message is null").write(),new Error("Message is null");if(isTextMessageModel(this.message)&&(null===(B=this.message.sourceAttributions)||void 0===B?void 0:B.length)>0){const O=(new Date).toLocaleDateString(),B=this.message.sourceAttributions.map(((B,U)=>`(${U+1}) ${B.providerDisplayName}. ${B.seeMoreUrl} ${this.strings.accessed} ${O}.`));this.attributionsCount=null===(U=this.message.sourceAttributions)||void 0===U?void 0:U.length;let G=`${this.message.text}`;return G=G.split(this.citationRegex).map((O=>this.isInteger(O)?this.toSuperscript(O):O)).join(""),G+="\n\n",G+=`${this.strings.source} ${O}`,G+=B.join("\n"),G}return null}getButtonText(){switch(this.copyState){case Py.Idle:return this.strings.messageActionsCopy;case Py.Copying:return this.strings.messageActionsCopying;case Py.Copied:return this.strings.messageActionsCopied;case Py.Error:return this.strings.messageActionsCopyError;default:return this.strings.messageActionsCopy}}fireMessageCopyTelemetryEvent(O,B){var U,G;null!==O&&(O=O.slice(0,128));let q="MessageCopy";switch(B){case Py.Copied:q="MessageCopySuccessfully";break;case Py.Error:q="MessageCopyFailed"}this.telemetry.trackEvent("InteractionEvent",q,{Namespace:jy.toTelemetryNamespace(this.serp.serpSlot),CustomData:JSON.stringify({convId:this.conversation.id,turnId:this.conversation.turnCount,rid:null===(U=this.message)||void 0===U?void 0:U.requestId,mid:null===(G=this.message)||void 0===G?void 0:G.messageId,linkNumber:this.attributionsCount,error:O})})}async copyText(O){var B;try{return null===(B=this.log)||void 0===B||B.trace(this,this.copyText,`Copying text: ${O}`),this.changeCopyState(Py.Copied),this.config.sydney.copyToClipboardProvider?this.config.sydney.copyToClipboardProvider(O):await navigator.clipboard.writeText(O)}catch(O){throw new Error("Failed to copy text",{cause:O instanceof Error?O:void 0})}}changeCopyState(O){this.copyState=O,window.setTimeout((()=>{O!==Py.Copied&&O!==Py.Error||this.changeCopyState(Py.Idle)}),this.idleTimeout)}toSuperscript(O){return O.split("").map((O=>this.numberToSuperscript[O])).join("")}isInteger(O){return!isNaN(Number(O))}};var Ab;__decorate([observable,__metadata("design:type",String)],kb.prototype,"copyState",void 0),kb=__decorate([__param(0,qy),__param(1,$c),__param(2,gh),__param(3,ql),__param(4,Dc),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],kb);class MessageViewModelBase extends ViewModelBase{constructor(O,B,U,G,q){super(B,U,G,q),this.config=O,this.isModelFinalized=!1,Ab.set(this,null)}get classNames(){return MessageViewModelBase.classNames}get shouldRenderFeedback(){return!1}get shouldRenderCopyOutside(){return!1}get model(){if(null===__classPrivateFieldGet(this,Ab,"f"))throw new Error("MessageViewModel has not been initialized.");return __classPrivateFieldGet(this,Ab,"f")}get type(){return this.model.type}get author(){return this.model.author}get isShared(){return!!this.model.isShared&&this.model.author===Yi.Bot}initialize(O){__classPrivateFieldSet(this,Ab,O,"f"),this.subscribeToModelChanges(),this.onModelPropertyChanged(null)}onModelPropertyChanged(O){}subscribeToModelChanges(){const O={handleChange:(O,B)=>{O===this.model&&this.onModelPropertyChanged(B)}};this.model.onPropertyChanged.subscribe(O),this._register(lifecycle_toDisposable((()=>this.model.onPropertyChanged.unsubscribe(O))))}}Ab=new WeakMap,MessageViewModelBase.classNames={tooltip:"tooltip-target",citation:"sup-target"},__decorate([observable,__metadata("design:type",Boolean)],MessageViewModelBase.prototype,"isModelFinalized",void 0);let Rb=class extends MessageViewModelBase{constructor(O,B,U,G,q){super(O,B,U,G,q)}get contextType(){return this.model.contextType}get sourceUrl(){return this.model.sourceUrl}get sourceName(){return this.model.sourceName}};Rb=__decorate([__param(0,ql),__param(1,qy),__param(2,gh),__param(3,$c),__param(4,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object])],Rb);let Ib=class extends ViewModelBase{constructor(O,B,U,G,q,j,W){super(O,B,U,W),this.config=G,this.exportService=q,this.notification=j,this.exportButtonState=Dy.Idle,this.strings={exportButtonAriaLabel:this.config.strings.feedbackExportButtonAriaLabel,tooltipExport:this.config.strings.tooltipExport,messageActionsExportText:this.config.strings.messageActionsExportText,messageActionsExportWord:this.config.strings.messageActionsExportWord,messageActionsExportPdf:this.config.strings.messageActionsExportPdf,exportTextButtonAriaLabel:this.config.strings.feedbackExportTextButtonAriaLabel,exportWordButtonAriaLabel:this.config.strings.feedbackExportWordButtonAriaLabel,exportPdfButtonAriaLabel:this.config.strings.feedbackExportPdfButtonAriaLabel,exportSuccessToastTitle:this.config.strings.exportSuccessToastTitle},this.messages=null,this.idleTimeoutMs=3e3,this.exportService.dynamicImportDocx(this.serp.isDevMode)}initialize(O){this.messages=O}async exportToFile(O,B,U,G){this.changeExportState(Dy.Exporting);try{const q=B||this.messages||[];await this.exportService.exportToFile(q,O,U),this.changeExportState(Dy.Exported),this.fireExportTelemetryEvent(Dy.Exported,O,G)}catch(B){throw this.changeExportState(Dy.Error),this.fireExportTelemetryEvent(Dy.Error,O,G),B}}changeExportState(O){if(this.exportButtonState=O,O===Dy.Exported){const O={text:this.strings.exportSuccessToastTitle,icon:bh.Success,type:vh.Toast};this.notification.sendFloatingBarNotification(O)}window.setTimeout((()=>{O!==Dy.Exported&&O!==Dy.Error||(this.changeExportState(Dy.Idle),this.notification.removeFloatingBarNotification())}),this.idleTimeoutMs)}fireExportTelemetryEvent(O,B,U){const G=this.getEventName(O);this.telemetry.trackEvent("InteractionEvent",G,{Namespace:jy.toTelemetryNamespace(this.serp.serpSlot),CustomData:B,EncryptedData:U||Ly.SingleMessage})}getEventName(O){switch(O){case Dy.Exported:return"CibExportSuccessfully";case Dy.Error:return"CibExportFailed";default:return"CibExport"}}};__decorate([observable,__metadata("design:type",String)],Ib.prototype,"exportButtonState",void 0),Ib=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,hp),__param(5,_h),__param(6,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],Ib);const Pb=kt.createInterface("IDrawerViewModel"),Nb=kt.createInterface("IHeaderBarViewModel");let Ob=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y){super(O,B,U,Y),this.config=G,this.conversation=q,this.sidePanel=j,this.headerBar=W,this.strings={shareConversation:this.config.strings.shareConversation},this._isFullGestureEnabled=!1}get enableShareConversation(){return!!this.config.features.enableShareConversation}get shouldRenderHeaderBar(){return this.enableShareConversation||!!this.config.features.enableSendFeedback||this.enableHistory}get enableWelcomeScreen(){return!!this.config.features.enableWelcomeScreen}get isFullGestureEnabled(){return this._isFullGestureEnabled}get enableHistory(){return!!this.config.features.enableThreads}toggleIsFullGesture(O){this._isFullGestureEnabled=O}shareConversation(){var O;try{return void(this.config.sydney.shareConversationProvider&&this.config.sydney.shareConversationProvider())}catch(B){isError(B)&&(null===(O=this.log)||void 0===O||O.error(this,this.shareConversation,`Failed to share ${B.message}`).write())}}};var Mb;__decorate([observable,__metadata("design:type",Object)],Ob.prototype,"strings",void 0),Ob=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Yy),__param(5,gb),__param(6,Nb),__param(7,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object])],Ob),function(O){O.Bing="bing",O.Sapphire="sapphire",O.Shoreline="shoreline"}(Mb||(Mb={})),function(O){O.tryParse=function(B){let U;switch(null==B?void 0:B.toLowerCase()){case O.Bing:U=O.Bing;break;case O.Sapphire:U=O.Sapphire;break;case O.Shoreline:U=O.Shoreline}return U},O.getDefault=function(){return O.Bing}}(Mb||(Mb={}));let Db=class extends ViewModelBase{constructor(O,B,U,G,q,j,W){super(O,B,U,W),this.config=G,this.sidePanel=q,this.manager=j,this.shouldShowMoreMenu=!1,this.shouldShowExportPopupPanel=!1,this.strings={threadsChatHistory:this.config.strings.threadsChatHistory,shareConversation:this.config.strings.shareConversation,sendFeedback:this.config.strings.serpfeedback,feedbackShareButtonAriaLabel:this.config.strings.feedbackShareButtonAriaLabel,feedbackExportButtonAriaLabel:this.config.strings.feedbackExportButtonAriaLabel,threadsEdit:this.config.strings.threadsEdit,threadsDelete:this.config.strings.threadsDelete,more:this.config.strings.more,feedbackExportPdfButtonAriaLabel:this.config.strings.feedbackExportPdfButtonAriaLabel,feedbackExportWordButtonAriaLabel:this.config.strings.feedbackExportWordButtonAriaLabel,feedbackExportTextButtonAriaLabel:this.config.strings.feedbackExportTextButtonAriaLabel,threadsExportPanelTitle:this.config.strings.threadsExportPanelTitle,threadsExportPanelAriaLabel:this.config.strings.threadsExportPanelAriaLabel}}get enableShareConversation(){return!!this.config.features.enableShareConversation}get enableSendFeedback(){return!!this.config.features.enableSendFeedback}get enableHistory(){return!!this.config.features.enableThreads}get drawerTitle(){pt.track(this,"drawerTitle");let O=this.config.strings.threadsTitle;return this.serp.productType===Mb.Shoreline&&(O=this.config.strings.threadsRecentTitleShort),this.sidePanel.isVisible?O:this.sidePanel.activeThread?this.sidePanel.activeThread.name:this.config.strings.threadsDefaultChatName}get sidePanelVm(){return this.sidePanel}get isExportSidePanelEnabled(){return this.enableExportConversation&&this.isContextMenuEnabled}get enableExportConversation(){return!!this.config.features.enableExportConversation}get isContextMenuEnabled(){return!!this.config.features.enableThreadContextMenu}get isEditing(){return!!this.sidePanel.activeThread&&this.sidePanel.activeThread.isEditing}get shouldShowPanel(){return this.sidePanel.isVisible}set shouldShowPanel(O){this.sidePanel.isVisible=O}beginEdit(){this.sidePanel.activeThread&&(this.toggleShowMore(),this.sidePanel.activeThread.beginEdit())}async deleteConversationAsync(){var O;this.toggleShowMore(),await(null===(O=this.sidePanel.activeThread)||void 0===O?void 0:O.deleteSingleConversationAsync()),this.manager.resetConversation(void 0,!1)}async confirmEditAsync(O){var B;await(null===(B=this.sidePanel.activeThread)||void 0===B?void 0:B.confirmEditAsync(O))}cancelEdit(){var O;null===(O=this.sidePanel.activeThread)||void 0===O||O.cancelEdit()}toggleShowMore(){this.shouldShowMoreMenu=!this.shouldShowMoreMenu}toggleSidePanelVisibility(O){void 0!==O?this.sidePanel.toggleVisibility(O):this.sidePanel.toggleVisibility()}async shareConversationAsync(O,B,U,G){var q,j,W,Y,K,Q,Z;try{if(this.config.features.enableTextShare&&this.config.sydney.shareConversationProvider)this.config.sydney.shareConversationProvider();else{if(!O)return void(null===(q=this.log)||void 0===q||q.error(this,this.shareConversationAsync,"Screenshot target undefined, ending share early").write());if(!B)return void(null===(j=this.log)||void 0===j||j.error(this,this.shareConversationAsync,"ShareButton undefined, ending share early").write());await(null===(Q=null===(K=null===(Y=null===(W=this.sidePanelVm)||void 0===W?void 0:W.activeThread)||void 0===Y?void 0:Y.contextMenuVm)||void 0===K?void 0:K.feedbackVm)||void 0===Q?void 0:Q.share(U,O,B,G))}}catch(O){isError(O)&&(null===(Z=this.log)||void 0===Z||Z.error(this,this.shareConversationAsync,`Failed to share ${O.message}`).write())}setTimeout((()=>{this.toggleShowMore()}),3e3)}sendFeedback(){var O;try{this.toggleShowMore(),this.config.sydney.sendFeedbackProvider&&this.config.sydney.sendFeedbackProvider()}catch(B){isError(B)&&(null===(O=this.log)||void 0===O||O.error(this,this.sendFeedback,`Failed to share ${B.message}`).write())}}toggleExportPopupPanel(){this.shouldShowExportPopupPanel=!this.shouldShowExportPopupPanel}};var Lb,Bb,Fb,zb,$b,Ub;__decorate([observable,__metadata("design:type",Boolean)],Db.prototype,"shouldShowMoreMenu",void 0),__decorate([observable,__metadata("design:type",Boolean)],Db.prototype,"shouldShowExportPopupPanel",void 0),__decorate([observable_volatile,__metadata("design:type",String),__metadata("design:paramtypes",[])],Db.prototype,"drawerTitle",null),__decorate([observable_volatile,__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],Db.prototype,"isEditing",null),Db=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,gb),__param(5,uh),__param(6,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],Db),function(O){O.ContentLoaded="AnswerCardDimensionUpdate",O.ContentResized="AnswerCardResize",O.ContentReady="ContentReady",O.ShoppingClick="ShoppingAnsClickUpdate",O.MMStaticMessage="MMStaticMessage"}(Lb||(Lb={})),function(O){O.Pole="POLE",O.Top="TOP",O.Ads="ADS",O.GenerativeImages="GenerateContentQuery",O.Shopping="SHOPPING",O.Image="IMAGE",O.Video="VIDEO",O.Mobile="MOBILE",O.Unknown="UNKNOWN",O.NoAnswer="NOANS"}(Bb||(Bb={})),function(O){const B={type:Bb.Top,hasCarousel:!1,height:620,width:648,query:"weather",iframeid:"weather"},U={type:Bb.Pole,hasCarousel:!0,height:240,width:1204,query:"movies",iframeid:"movies"},G={type:Bb.Ads,hasCarousel:!1,height:440,width:820,query:"buy iphone",iframeid:"iphone",context:[{title:"A title",price:19.99},{title:"A title",price:19.99},{title:"A title",price:19.99}]};O.queueDimensionUpdateMessage=function(O){var q;let j;if(O.includes("images/create"))j={type:Bb.Top,hasCarousel:!1,height:620,width:648,query:"weather",iframeid:null!==(q=new URLSearchParams(O).get("iframeid"))&&void 0!==q?q:""};else if(O.includes("weather"))j=B;else if(O.includes("movies"))j=U;else{if(!O.includes("iphone"))return;j=G}const W={type:Lb.ContentLoaded,data:j};setTimeout((()=>window.postMessage(W,"*")),4e3)},O.getShoppingClickEventTestData=function(){return{type:Lb.ShoppingClick,data:{type:Bb.Shopping,height:1005,width:500,iframeid:"string",payload:{pdpAjaxUrl:"http://sacheru-pc/shop/productpage?q=mobiles&filters=scenario%3a%2217%22+gType%3a%2212%22+gId%3a%2299388976423%22+gIdHash%3a%220%22+gGlobalOfferIds%3a%2299388976423%22+AucContextGuid%3a%220%22+GroupEntityId%3a%2299388976423%22+NonSponsoredOffer%3a%22True%22&productpage=true&FORM=SHPPDP&browse=true&features=null&showselans=1",groundingData:"This item is REFURBISHEDMotorola One 5G Ace is here which could only mean one thing. Superfast 5G speed for all. Now you dont have to spend a fortune for movies ultra-clear video chats and games without the wait. 5G speed is just the start. Enjoy a long lasting 5000 mAh battery. View everything in vivid true-to-life color on the 6.7 Full HD+ Max Vision"}}}}}(Fb||(Fb={})),function(O){function isPostMessageEventData(O){const B=O;return"object"==typeof O&&null!==O&&"string"==typeof B.type&&isPostMessageEventDataType(B.type)&&"string"==typeof B.iframeid&&"number"==typeof B.height&&"number"==typeof B.width}function isShoppingClickEventData(O){const B=O;return isPostMessageEventData(O)&&B.type===Bb.Shopping&&isShoppingClickEventDataPayload(B.payload)}function isShoppingClickEventDataPayload(O){const B=O;return"object"==typeof O&&null!==O&&"string"==typeof B.pdpAjaxUrl&&"string"==typeof B.groundingData}function isContentLoadedEventData(O){const B=O;return isPostMessageEventData(O)&&"boolean"==typeof B.hasCarousel&&"string"==typeof B.query}function isPostMessageEventType(O){return isEnum(Lb,O)}function isPostMessageEventDataType(O){return isEnum(Bb,O)}function isEnum(O,B){return function(O){return null!=O}(B)&&function(O){return Object.values(O).filter((O=>"function"!=typeof O))}(O).includes(B)}O.isPostMessageEventData=isPostMessageEventData,O.isPostMessageEvent=function(O){const B=O;return"object"==typeof O&&null!==O&&"string"==typeof B.type&&isPostMessageEventType(B.type)&&(isContentLoadedEventData(B.data)||isShoppingClickEventData(B.data))},O.isShoppingClickEventData=isShoppingClickEventData,O.isShoppingClickEventDataPayload=isShoppingClickEventDataPayload,O.isContentLoadedEventData=isContentLoadedEventData,O.isPostMessageEventType=isPostMessageEventType,O.isPostMessageEventDataType=isPostMessageEventDataType}(zb||(zb={})),function(O){function isPostMessageEventData(O){const B=O;return"object"==typeof O&&null!==O&&"string"==typeof B.type&&zb.isPostMessageEventDataType(B.type)}O.isPostMessageEvent=function(O){const B=O;return"object"==typeof O&&null!==O&&"string"==typeof B.type&&zb.isPostMessageEventType(B.type)&&isPostMessageEventData(B.data)},O.isPostMessageEventData=isPostMessageEventData,O.isUnusableEventDataType=function(O){return[Bb.NoAnswer,Bb.Unknown].includes(O)}}($b||($b={}));let Vb=class extends MessageViewModelBase{constructor(O,B,U,G,q,j,W,Y,K){super(U,G,q,j,K),this.chat=O,this.vmFactory=B,this.conversation=W,this.screenshotService=Y,this.cancelRender=!1,this.isContentLoaded=!1,Ub.set(this,null),this.frameConfig=null,this._frameHeight="0px",this._frameWidth="0px",this.messagingDisposer=this._register(new Disposer),this.handleWindowMessage=O=>{var B;const U=O.data;if(!$b.isPostMessageEvent(U))return;if(zb.isContentLoadedEventData(U.data)&&this.model.text.toLowerCase()!==U.data.query.toLowerCase())return;if(U.data.iframeid!==this.model.iframeid)return;if($b.isUnusableEventDataType(U.data.type))return this.disposeMessageHandler(),this.cancelRender=!0,void(null===(B=this.log)||void 0===B||B.warn(this,this.handleWindowMessage,"The content loaded by the host frame could not be used.","type:",U.data.type).write());const{type:G,data:q}=U;switch(G){case Lb.ContentLoaded:this.handleContentLoadedEvent(q);break;case Lb.ContentResized:this.handleContentResizedEvent(q);break;case Lb.ContentReady:this.handleContentReadyEvent(q);break;case Lb.ShoppingClick:this.handleShoppingClickEvent(q);break;case Lb.MMStaticMessage:this.handleMMStaticMessage(q)}},this._register(lifecycle_toDisposable((()=>this.disposeMessageHandler())))}get feedback(){var O;return __classPrivateFieldSet(this,Ub,null!==(O=__classPrivateFieldGet(this,Ub,"f"))&&void 0!==O?O:this.vmFactory.createFeedback(this.model),"f"),__classPrivateFieldGet(this,Ub,"f")}get frameHeight(){return this._frameHeight}get frameWidth(){return this._frameWidth}get isSandboxedIframe(){var O;return null!==(O=this.config.partner.isSandboxedIframe)&&void 0!==O&&O}get iFrameCSPAttribute(){var O;return null!==(O=this.config.partner.iFrameCSPPolicy)&&void 0!==O?O:""}get contentUrl(){return this.model.contentUrl+"&frame=sydedg"}get contentType(){return this.model.contentType}get shouldRenderFeedback(){return this.model.messageType===tr.GenerateContentQuery&&this.model.author===Yi.Bot&&this.model.isFinalized}onModelPropertyChanged(O){super.onModelPropertyChanged(O),null===O&&(this.configureHostedContentMessaging(),this.enableConfigDrivenFeatures())}configureHostedContentMessaging(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.configureHostedContentMessaging,null).write(),this.messagingDisposer.register(addDisposableListener(window,"message",this.handleWindowMessage))}enableConfigDrivenFeatures(){const O=this.config.answers.answerCardDimensionUpdateTimeout;O>0&&setTimeout((()=>{var O,B;this.isContentLoaded?this.config.features.enableServerLogMerging?this.telemetry.trackEvent("SystemEvent","ComponentRender",{Namespace:(null===(O=this.serp)||void 0===O?void 0:O.mode)===Hy.Conversation?jy.toTelemetryNamespace(jy.None):jy.toTelemetryNamespace(null===(B=this.serp)||void 0===B?void 0:B.serpSlot),CustomData:JSON.stringify({convId:this.conversation.id,rid:this.model.requestId,mid:this.model.messageId,turnId:this.conversation.turnCount})}):this.telemetry.trackEvent("SystemEvent","ComponentRender",{Namespace:"Conversation",CustomData:JSON.stringify({scenarioName:"TODO",serviceName:"TODO",turnId:this.conversation.messages.length-1,convId:this.conversation.id})}):this.disposeMessageHandler(!0)}),O),this.config.answers.debugAutoSizeAnswerCard&&Fb.queueDimensionUpdateMessage(this.contentUrl)}disposeMessageHandler(O=!1){var B;this.messagingDisposer.isDisposed||(this.messagingDisposer.dispose(),O&&(this.cancelRender=!0,null===(B=this.log)||void 0===B||B.warn(this,this.disposeMessageHandler,`The '${this.contentType}' host message rendered a frame with the following 'contentUrl' but has timed out waiting for the init message from the frame. The frame will now be destroyed.`,this.contentUrl).write()))}handleContentLoadedEvent(O){var B;if(null===(B=this.log)||void 0===B||B.trace(this,this.handleContentLoadedEvent,"ANSWER/ADS data:",O).write(),this.isContentLoaded=!0,this.frameConfig=O,O.type===Bb.Ads)queueMicrotask((()=>this.processAdsQueryMessage(O)));else if(O.type===Bb.Shopping&&this.doesLatestTextMessageHaveInlineAds())return this.disposeMessageHandler(),void(this.cancelRender=!0);this.updateFrameDimensions(O),this.config.features.enableAnswerScreenshot&&this.model.contentType===bp.Answer&&queueMicrotask((()=>this.processAnswerMessage()))}async processAnswerMessage(){var O,B;if(!this.hostIframeRef)return;null===(O=this.log)||void 0===O||O.trace(this,this.processAnswerMessage,"processAnswerMessage").write();const clonedElementHandler=O=>{O.style.width=this.frameWidth,O.style.height=this.frameHeight};try{const O=await this.screenshotService.captureIframeImageAsync(this.hostIframeRef,clonedElementHandler);this.model.contentType===bp.Answer&&(this.model.answerScreenshot=O,this.chat.updateConversationAsync([this.model]).then((()=>{var O;null===(O=this.log)||void 0===O||O.trace(this,this.processAnswerMessage,"Update conversation successfully").write()})).catch((()=>{var O;null===(O=this.log)||void 0===O||O.warn(this,this.processAnswerMessage,"Update conversation unsuccessfully").write()})))}catch(O){null===(B=this.log)||void 0===B||B.warn(this,this.processAnswerMessage,"Get screenshot unsuccessfully",O).write()}}doesLatestTextMessageHaveInlineAds(){const O=this.conversation.messages;let B=null;for(let U=O.length-1;U>=0;U--)if(O[U].type===vp.Text&&O[U].author===Yi.Bot){B=O[U];break}return!(!B||!B.inlineAdsModel)}handleContentResizedEvent(O){var B;null===(B=this.log)||void 0===B||B.trace(this,this.handleContentResizedEvent,"ANSWER/ADS data:",O).write(),this.frameConfig=O,this.updateFrameDimensions(O)}handleShoppingClickEvent(O){var B;null===(B=this.log)||void 0===B||B.trace(this,this.handleShoppingClickEvent,"SHOPPING data:",O).write();const U=this.vmFactory.createTextMessage("$$$>SLOTTED<$$$",Yi.Bot);let G;O.payload.groundingData&&(G=this.vmFactory.createTextMessage(O.payload.groundingData,Yi.Bot));const q=new URL(O.payload.pdpAjaxUrl);q.searchParams.delete("iframeid");const j={groundingTextVm:G,emptyVm:U,contentHostData:{isContentLoaded:!0,contentUrl:q.href,frameWidth:`${O.width}px`,frameHeight:`${O.height}px`,cancelRender:!1}};this.shoppingPdpRenderData=j}handleMMStaticMessage(O){if(this.config.features.enableMMStaticMessage&&O.payload.staticMessage){const B={mmStaticMessageVm:this.vmFactory.createTextMessage(O.payload.staticMessage,Yi.Bot)};this.mmStaticMessage=B}}handleContentReadyEvent(O){if(this.config.features.enableShareOnHostMessage&&O){const{shareUrl:B,thid:U}=O;this.model.renderUrl=null!=B?B:this.contentUrl,this.model.isShareable=!0,U&&(this.model.thid=U),__classPrivateFieldGet(this,Ub,"f")&&!__classPrivateFieldGet(this,Ub,"f").shouldShowMessageShare&&(__classPrivateFieldGet(this,Ub,"f").shouldShowMessageShare=!0)}}updateFrameDimensions(O){const{hasCarousel:B,height:U,width:G}=O;this._frameHeight=`${U}px`,this._frameWidth=B?"100%":`${G}px`}processAdsQueryMessage(O){var B,U,G;if(this.model.contentType===bp.Ads){const q=this.model.messageData.messageId,j="string"==typeof O.context?JSON.parse(O.context):O.context,W=new AdsMessage(q,j);null===(B=this.log)||void 0===B||B.trace(this,this.processAdsQueryMessage,"Received AdsQuery:",this.model.messageData).write(),null===(U=this.log)||void 0===U||U.trace(this,this.processAdsQueryMessage,"Rendered, received context:",O.context).write(),null===(G=this.log)||void 0===G||G.trace(this,this.processAdsQueryMessage,"Created AdsMessage:",W).write(),this.chat.registerContext([W])}}};var Gb,Hb,qb,jb;Ub=new WeakMap,__decorate([observable,__metadata("design:type",HTMLIFrameElement)],Vb.prototype,"hostIframeRef",void 0),__decorate([observable,__metadata("design:type",Boolean)],Vb.prototype,"cancelRender",void 0),__decorate([observable,__metadata("design:type",Boolean)],Vb.prototype,"isContentLoaded",void 0),__decorate([observable,__metadata("design:type",Object)],Vb.prototype,"shoppingPdpRenderData",void 0),__decorate([observable,__metadata("design:type",Object)],Vb.prototype,"mmStaticMessage",void 0),__decorate([observable,__metadata("design:type",String)],Vb.prototype,"_frameHeight",void 0),__decorate([observable,__metadata("design:type",String)],Vb.prototype,"_frameWidth",void 0),Vb=__decorate([__param(0,Mc),__param(1,Vt),__param(2,ql),__param(3,qy),__param(4,gh),__param(5,$c),__param(6,Dc),__param(7,Sp),__param(8,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object])],Vb);let Wb=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y,K,Q,Z,X,J,ee,te,ie){super(O,B,U,ie),this.config=G,this.chat=q,this.api=j,this.feedbackService=W,this.compliantFeedbackService=Y,this.feedbackFormService=K,this.conversation=Q,this.modelFactory=Z,this.viewModelFactory=X,this.conversationModel=J,this.shareService=ee,this.screenshotService=te,this.hasSubmittedPositiveFeedback=!1,this.hasSubmittedNegativeFeedback=!1,this.hasSubmittedOffensiveFeedback=!1,this.enableOffensiveFeedback=!!this.config.features.enableOffensiveFeedback,this.enableFlatActionBar=!!this.config.features.enableFlatActionBar,this.enableFeedbackMenuOverflow=!!this.config.features.enableFeedbackMenuOverflow,this.enableMessageExport=!!this.config.features.enableMessageExport,this.enableStandaloneUtility=!!this.config.features.enableStandaloneUtility,this.enableShowHistoryConversation=!1,this.shouldShowMessageShare=!1,this.strings={accessed:this.config.strings.feedbackAccessed,source:this.config.strings.feedbackSource,likeButtonAriaLabel:this.config.strings.feedbackLikeButtonAriaLabel,dislikeButtonAriaLabel:this.config.strings.feedbackDislikeButtonAriaLabel,offensiveButtonAriaLabel:this.config.strings.feedbackOffensiveButtonAriaLabel,shareButtonAriaLabel:this.config.strings.feedbackShareButtonAriaLabel,messageActionsReport:this.config.strings.messageActionsReport,shareAnswer:this.config.strings.feedbackShareAnswer,shareGenerated:this.config.strings.feedbackShareGenerated,tooltipPositive:this.config.strings.tooltipPositive,tooltipNegative:this.config.strings.tooltipNegative,tooltipShare:this.config.strings.tooltipShare,tooltipMore:this.config.strings.tooltipMore,exportButtonAriaLabel:this.config.strings.feedbackExportButtonAriaLabel,shareTitleFormat:this.config.strings.feedbackShareTitleFormat},Gb.set(this,void 0),Hb.set(this,void 0),qb.set(this,void 0),this.utilityType=null,this.shareWholeThread=!1,this.enableIgnoreHtml2canvas=!0,jb.set(this,void 0),this.wholeThreadConversationId=null,this.conversationType=Bc.Default,this.message=null,this.shareUrlCache={[jy.RightRail]:void 0,[jy.None]:void 0,[jy.Pole]:void 0,[jy.Creator]:void 0},this.screenshotService.dynamicImportHtml2Canvas(this.serp.isDevMode)}get copyVm(){return __classPrivateFieldGet(this,Gb,"f")}set copyVm(O){var B;__classPrivateFieldGet(this,Gb,"f")?null===(B=this.log)||void 0===B||B.warn(this,"set copyVm","copyVM has already been assigned.",__classPrivateFieldGet(this,Gb,"f")).write():O&&__classPrivateFieldSet(this,Gb,O,"f")}get historyConversationVm(){return __classPrivateFieldGet(this,qb,"f")}set historyConversationVm(O){var B;__classPrivateFieldGet(this,qb,"f")?null===(B=this.log)||void 0===B||B.warn(this,"set historyConversationVm","historyConversationVm has already been assigned.",__classPrivateFieldGet(this,qb,"f")).write():O&&__classPrivateFieldSet(this,qb,O,"f")}get exportVm(){return __classPrivateFieldGet(this,jb,"f")}set exportVm(O){var B;__classPrivateFieldGet(this,jb,"f")?null===(B=this.log)||void 0===B||B.warn(this,"set exportVm","exportVm has already been assigned.",__classPrivateFieldGet(this,jb,"f")).write():O&&__classPrivateFieldSet(this,jb,O,"f")}get hasClickedShare(){return(!this.shareWholeThread||!this.config.features.enableShareThreadWithNoCache)&&void 0!==this.shareUrlCache[this.serp.serpSlot]}get userQuestion(){var O;return __classPrivateFieldSet(this,Hb,null!==(O=__classPrivateFieldGet(this,Hb,"f"))&&void 0!==O?O:this.conversationModel.messages.find((O=>{var B;return O.author===Yi.User&&O.requestId===(null===(B=this.message)||void 0===B?void 0:B.requestId)})),"f"),__classPrivateFieldGet(this,Hb,"f")}initialize(O,B,U){this.message=O,this.shouldShowMessageShare=O.type!==vp.Host,B&&(this.copyVm=B),U&&(this.exportVm=U)}isHostMessageShareEnable(){return!!this.config.features.enableShareOnHostMessage}isFeedbackInstrumentationEnabled(){return!!this.config.features.enableFeedbackInstrumentation}get shouldShowMoreMenuButton(){var O;return!((null===(O=this.message)||void 0===O?void 0:O.messageType)===tr.GenerateContentQuery)&&this.moreMenuNumber>0}get shouldShowToolTipStyleOfMoreMenuItem(){return this.enableFeedbackMenuOverflow&&1===this.moreMenuNumber}isShareEligibleSlot(O){return!!this.config.features.enableShare&&(!(!this.config.features.enableShareCreator&&O===jy.Creator)&&!!(this.config.features.enableShareSemSerp||O!==jy.Pole&&O!==jy.RightRail))}async sendFeedbackAsync(O,B,U){var G,q,j;if(this.message)try{switch(this.conversationModel.id?this.config.bingAtWork.isEnabled?await this.compliantFeedbackService.sendFeedbackAsync(O,this.message):await this.feedbackService.sendFeedbackAsync(O,this.message,B):null===(q=this.log)||void 0===q||q.info(this,this.sendFeedbackAsync,"ConversationId is null, skipping sydney feedback").write(),this.logFeedback(O,B),O){case"Positive":this.hasSubmittedPositiveFeedback=B,this.hasSubmittedNegativeFeedback=!1;break;case"Negative":this.hasSubmittedNegativeFeedback=B,this.hasSubmittedPositiveFeedback=!1;break;case"Offensive":this.hasSubmittedOffensiveFeedback=B}B&&this.config.features.enableInlineFeedback&&U===jy.None&&this.promptUserForFeedback(O)}catch(B){const U=isError(B)?B.message:"unknown error";null===(j=this.log)||void 0===j||j.error(this,this.sendFeedbackAsync,`Error sending feedback: kind: ${O} ${U}`).write()}else null===(G=this.log)||void 0===G||G.error(this,this.sendFeedbackAsync,"Message is null").write()}async share(O,B,U,G){var q,j,W,Y,K,Q;if(this.config.features.enableTextShare)return void await this.shareTextAsync();G.setTarget(U),G.show();const Z=G.container;if(this.config.features.enableShareLoadingUI){const O=Z.querySelector("span[data-menuid]");O&&this.feedbackFormService.showShareControlWithLoadingUI(O,U)}let X="Conversation",J=!1;O===jy.Creator&&(J=!0,X="Creator");let ee=!1;O===jy.RightRail&&(ee=!0,X="RightRail"),O===jy.Pole&&(ee=!0,X="Pole");const te=this.getShareTitle(ee),ie=new URL(this.serp.productType===Mb.Shoreline?"https://www.bing.com/search?":window.location.href);O===jy.None&&(ie.searchParams.set("q",this.config.strings.feedbackShareConversationQuery),ie.searchParams.set("showconv","1"));const re=function(O,B,U=!1){const G=B===jy.Pole||B===jy.RightRail?"WholePageTemplate_SemanticSerp":B===jy.Creator?"WholePageTemplate_Creator":B===jy.None?U?"ConversationWholeThread":"Conversation":"",q=`wholepagesharingscenario:"${G}"`;if(!G)return O;if(O)return`${O.split(" ").filter((O=>!O.includes("wholepagesharingscenario"))).join(" ")} ${q}`;return q}(ie.searchParams.get("filters"),O,this.shareWholeThread);if(re&&ie.searchParams.set("filters",re),this.config.sydney.shareId&&(null===(q=this.conversationModel.messages[0])||void 0===q?void 0:q.messageId)===(null===(j=this.message)||void 0===j?void 0:j.messageId)){null===(W=this.log)||void 0===W||W.info(this,this.share,"Reusing current link because we're resharing the initial shared message",{isCreatorMode:J,isSemanticSerp:ee,shareId:this.config.sydney.shareId}).write();const G=this.conversationModel.messages[0].type===vp.Host?this.conversationModel.messages[0].thid:void 0;this.embedShareControl(ie.href,te,Z,B,U,O,G)}else try{const G=this.conversationModel.messages.filter((O=>{var B;return O.messageId===(null===(B=this.message)||void 0===B?void 0:B.messageId)&&!isEmptyMessageModel(O)})),q=(null==G?void 0:G.length)>0&&G[0].type===vp.Host?G[0].thid:void 0;if(this.hasClickedShare){if(this.config.features.enableLinkShare)return void await this.shareLink(this.shareUrlCache[O]);this.embedShareControl(this.shareUrlCache[O],te,Z,B,U,O,q)}else{null===(Y=this.log)||void 0===Y||Y.info(this,this.share,"Sharing message messageId:",null===(K=this.message)||void 0===K?void 0:K.messageId).write();let G=[];if(this.enableStandaloneUtility&&this.shareWholeThread){const O=await this.getWholeThreadMessagesAsync();G=this.filterMessages(O)}else if(this.config.features.enableShareQuestionWithResponse){if(this.userQuestion&&G.push(this.userQuestion),this.message&&G.push(this.message),!(null==G?void 0:G.length))return}else G=this.conversationModel.messages.filter((O=>{var B;return O.messageId===(null===(B=this.message)||void 0===B?void 0:B.messageId)&&!isEmptyMessageModel(O)}));const j=await this.getShareMetadataAsync(B);let W="";if(this.shareWholeThread)if(this.conversationType===Bc.Shared&&this.wholeThreadConversationId)W=this.wholeThreadConversationId,await this.getHistoryConversationPromise(G);else{const O=this.getHistoryConversationPromise(G),B=this.shareService.shareMessagesAsync(G,j),[,U]=await Promise.all([O,B]);W=U.shareId}else{W=(await this.shareService.shareMessagesAsync(G,j)).shareId}if(ie.searchParams.set("shareId",W),this.config.features.enableLinkShare)return this.shareUrlCache[O]=ie.href,void await this.shareLink(ie.href);this.embedShareControl(ie.href,te,Z,B,U,O,q),this.telemetry.trackEvent("MessageEvent","ActionBarShare",{Namespace:X,CustomData:JSON.stringify({shareId:W,shareUrl:ie.href})})}}catch(O){null===(Q=this.log)||void 0===Q||Q.error(this,this.share,`Failed to hit share: ${O}`).write()}}convertMessageToDMessage(O){const B=[];return O.forEach(((O,U)=>{var G;const q=O.text,j=O.messageType;let W=null;try{W=O.author===Yi.User?this.modelFactory.createLocalText({text:q,messageType:j}):O.author===Yi.Bot?this.modelFactory.createIncoming(O):null}catch(O){null===(G=this.log)||void 0===G||G.error(this,this.convertMessageToDMessage,"failed to convert messages to DMessages").write()}null!==W&&B.push(W)})),B}async getHistoryConversationMessagesAsync(O){const{baseUrl:B,pathBase:U,pathGetConversation:G,queryGetConversation:q}=this.config.sydney,j=new URL(`${B}${U}${G}`);for(const B in q)if(Object.prototype.hasOwnProperty.call(q,B)){const U=q[B];"<<conversationId>>"===U?j.searchParams.set(B,O):j.searchParams.set(B,U)}const W=await fetch(j);if(W.ok){return(await W.json()).messages}throw new Error("Get conversation API failed.")}async getSharedMessagesAsync(O){const{source:B,sliceIds:U}=this.config.sydney.request;return(await this.api.sydney.sharing.getSharedMessagesAsync(O,B,CoreUtils.uuid(),U)).messages}enableStandaloneShare(O){!0===O&&(this.utilityType=Ry.Share)}setWholeThreadConversationId(O){this.wholeThreadConversationId=O}setConverstaionType(O){this.conversationType=O}enableShareWholeThread(O){this.shareWholeThread=O,this.enableIgnoreHtml2canvas=!1}async exportWholeThreadAsync(O){var B;const U=await this.getWholeThreadMessagesAsync();await(null===(B=this.exportVm)||void 0===B?void 0:B.exportToFile(O,U,{filename:"Conversation"},Ly.Thread))}getHistoryConversationPromise(O){var B;__classPrivateFieldSet(this,qb,null!==(B=__classPrivateFieldGet(this,qb,"f"))&&void 0!==B?B:this.viewModelFactory.create(Tb),"f"),this.enableShowHistoryConversation=!0;const U=[];O.forEach((O=>{const B=this.viewModelFactory.createMessage(O);B.type===vp.Text&&(B.turnCounter.resetCurrentTurnIndex(),U.push(B))}));return __classPrivateFieldGet(this,qb,"f").waitForMessagesReadyAsync(U)}filterMessages(O){return this.config.features.enableThreadShareWithoutRenderCardRequest?O.filter((O=>O.messageType!==tr.RenderCardRequest)):O}async getWholeThreadMessagesAsync(){var O,B,U;let G=[];try{if((null===(O=this.conversationModel)||void 0===O?void 0:O.id)===this.wholeThreadConversationId)G=this.conversationModel.messages;else{if(null===this.wholeThreadConversationId)throw new Error("Load conversation failed.");{const O=this.wholeThreadConversationId;if(null===O)throw null===(B=this.log)||void 0===B||B.error(this,"Sharing whole topic found no conversation id","Conversation id is null").write(),new Error("No conversation ID retrieved");let U=[];U=this.conversationType===Bc.Shared?await this.getSharedMessagesAsync(O):await this.getHistoryConversationMessagesAsync(O),G=this.convertMessageToDMessage(U)}}}catch(O){const B=O instanceof Error?O:"Conversation load failed.";throw null===(U=this.log)||void 0===U||U.error(this,this.share,"loadConversationAsync",B).write(),O}return G=G.filter((O=>!isEmptyMessageModel(O))),G}async shareLink(O){var B,U,G,q,j;if(this.config.sydney.shareLinkProvider)if(O&&0!==O.length){try{return null===(U=this.log)||void 0===U||U.trace(this,this.shareLink,`Sharing Link: ${O}`),this.config.sydney.shareLinkProvider(O)}catch(O){null===(G=this.log)||void 0===G||G.error(this,this.shareLink,"Failed to share link cause:"+(O instanceof Error?O.toString():"undefined"))}null===(q=this.log)||void 0===q||q.error(this,this.shareLink,"Message is null").write()}else null===(j=this.log)||void 0===j||j.error(this,this.shareLink,"Message is null").write();else null===(B=this.log)||void 0===B||B.error(this,this.shareLink,"No share provider available").write()}async shareTextAsync(){var O,B,U,G,q;if(!this.config.sydney.shareTextProvider)return void(null===(O=this.log)||void 0===O||O.error(this,this.shareTextAsync,"No share provider available").write());if(!this.message)return void(null===(B=this.log)||void 0===B||B.error(this,this.shareTextAsync,"Message is null").write());let j=null===(U=this.copyVm)||void 0===U?void 0:U.getCopyTextWithCitations();if(!j&&isTextMessageModel(this.message)&&(j=`${this.message.text}`),j)try{return null===(G=this.log)||void 0===G||G.trace(this,this.shareTextAsync,`Sharing text: ${j}`),this.config.sydney.shareTextProvider(j)}catch(O){null===(q=this.log)||void 0===q||q.error(this,this.shareTextAsync,"Failed to share text cause:"+(O instanceof Error?O.toString():"undefined"))}}getShareTitle(O){let B=O?this.strings.shareAnswer:this.strings.shareGenerated;return this.config.features.enableShareQuestionWithResponse&&this.userQuestion?(B=this.config.features.enableShareQuestionTitlePrefix?this.strings.shareTitleFormat.replace("{0}",B).replace("{1}",this.userQuestion.text):this.userQuestion.text,B):B}embedShareControl(O,B,G,q,j,W,Y){var K,Q,Z,X,J;null===(K=this.log)||void 0===K||K.info(this,this.embedShareControl,`Creating share control with link: ${O}`).write();const ee=G.querySelector("span[data-menuid]");if(null===(Q=this.log)||void 0===Q||Q.info(this,this.embedShareControl,"Share control already created, firing update").write(),ee||null===(Z=this.log)||void 0===Z||Z.error(this,this.embedShareControl,"Share control not found").write(),!Y&&this.config.features.enableShareInlineAdsIframe){const O=q.contentDiv;this.batchConvertIframe(O)}if(this.config.features.enableShareLoadingUI?this.feedbackFormService.populateShareControl(ee,O,B,q,Y):this.feedbackFormService.updateShareControl(ee,O,B,q,Y),this.config.features.enableShareLoadingUI||this.feedbackFormService.showShareControl(ee,j),!this.hasClickedShare&&(this.shareUrlCache[W]=O,this.serp.isDevMode))return null===(X=this.log)||void 0===X||X.trace(this,this.embedShareControl,"using share control stub"),U.e(148).then(U.bind(U,1317)).then((B=>{G.innerHTML=`shareLink: ${O}\n\n          ${B.stub}`})),this.shareUrlCache[W]=O,void navigator.clipboard.writeText(O);null===(J=this.log)||void 0===J||J.trace(this,this.embedShareControl,"done").write()}async getShareMetadataAsync(O){var B,U,G,q;if(this.config.features.enableShareInlineAdsIframe||this.config.features.enableThreadShareLandingPage){null===(B=this.log)||void 0===B||B.trace(this,this.getShareMetadataAsync,"getShareMetadataAsync").write();try{const B={};if(this.config.features.enableThreadShareLandingPage&&B&&(B.expiryDate=(Date.now()+6048e5).toString()),this.config.features.enableShareInlineAdsIframe){const q=O.contentDiv;if(q&&(null===(U=q.querySelectorAll("iframe"))||void 0===U?void 0:U.length)>0){const O=q.querySelectorAll("iframe")[0],U=null===(G=null==O?void 0:O.src)||void 0===G?void 0:G.replace("&showonlyads=1",""),j=await this.screenshotService.captureIframeImageAsync(O,this.handleIframeScreenshotStyle);U&&j&&(B.iframeImg=j,B.iframeSrc=U)}}return B}catch(O){return void(null===(q=this.log)||void 0===q||q.error(this,this.getShareMetadataAsync,`Failed to get metadata: ${O}`).write())}}}batchConvertIframe(O){var B;null===(B=this.log)||void 0===B||B.trace(this,this.batchConvertIframe,"batchConvertIframe").write();const U=null==O?void 0:O.querySelectorAll("iframe");for(let O=0;O<(null==U?void 0:U.length);O++){const B=U[O];this.screenshotService.cloneIframeAndAppend(B,this.config.shareScreenshot.dataHtmlToCanvasHiddenElement,this.handleIframeScreenshotStyle)}}handleIframeScreenshotStyle(O){const B=document.createElement("style");B.innerHTML=".content .ac-container, .content .ac-container p {font-size: 14px !important;} #b_results .sb_adTextInfo{ background-color: white !important; margin: 0 !important; padding: 20px !important;} #b_results .sb_adTextInfo .sb_CallToAction {min-width: auto !important; min-inline-size: auto !important;} .b_adSlugRow html2canvaspseudoelement > img {transform-origin: -320px 0 !important; transform: scale(0.5) !important;}",O.appendChild(B)}promptUserForFeedback(O){this.serp.mode!==Hy.Conversation&&this.serp.changeMode(Hy.Conversation);const B=[{text:"Positive"===O?this.config.strings.feedbackPromptPositive:this.config.strings.feedbackPromptMessage,author:Yi.Bot,feedbackPrompt:"Positive"!==O,reportable:!1}],U=this.modelFactory.createLocalText(B[0]);this.conversation.addMessage(U),this.chat.registerContext(B)}logFeedback(O,B){var U;null!==this.message?this.telemetry.trackEvent("InteractionEvent","Feedback",{Namespace:jy.toTelemetryNamespace(this.serp.serpSlot),CustomData:JSON.stringify({type:O,mid:this.message.messageId,text:this.telemetry.getComplianceSafeMessage(this.message.text),creatorFeedbackId:this.config.creator.feedbackId,isAdded:B,convId:this.conversation.id})}):null===(U=this.log)||void 0===U||U.error(this,this.logFeedback,"Message is null").write()}get hasSelectedFeedback(){return this.hasSubmittedNegativeFeedback||this.hasSubmittedPositiveFeedback||this.hasSubmittedOffensiveFeedback}get shouldOffensiveBeFirst(){return this.hasSubmittedNegativeFeedback||this.hasSubmittedPositiveFeedback}get moreMenuNumber(){let O=0;return this.copyVm&&(O+=1),this.enableOffensiveFeedback&&(O+=1),O}};var Yb;Gb=new WeakMap,Hb=new WeakMap,qb=new WeakMap,jb=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"hasSubmittedPositiveFeedback",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"hasSubmittedNegativeFeedback",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"hasSubmittedOffensiveFeedback",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"enableOffensiveFeedback",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"enableFlatActionBar",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"enableFeedbackMenuOverflow",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"enableMessageExport",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"enableStandaloneUtility",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"enableShowHistoryConversation",void 0),__decorate([observable,__metadata("design:type",Boolean)],Wb.prototype,"shouldShowMessageShare",void 0),__decorate([observable,__metadata("design:type",Object)],Wb.prototype,"strings",void 0),Wb=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Mc),__param(5,Ii),__param(6,ih),__param(7,nh),__param(8,lh),__param(9,Dc),__param(10,hh),__param(11,Vt),__param(12,Dc),__param(13,Lh),__param(14,Sp),__param(15,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],Wb);class HoverAdsModel extends lifecycle_Disposable{constructor(O,B,U,G,q){super(),this.searchQuery=O,this.config=B,this.conversation=U,this.telemetry=G,this.log=q,this.isContentLoaded=!1,this.cancelRender=!1,this.contentUrl="",Yb.set(this,this._register(new Emitter)),this._frameHeight="0px",this._frameWidth="0px",this._isActive=!1,this._iframeId=this.getUUID(),this.handleWindowMessage=O=>{var B,U,G;const q=O.data.data;if(this.shouldHandleMessage(O.data))if(this.messageHandlerDisposer.dispose(),q.type!==Bb.Ads||0===q.height||0===q.width)this.cancelRender=!0,null===(B=this.log)||void 0===B||B.warn(this,this.handleWindowMessage,"ADS content failed to load:",O).write();else{try{const B=O.data.data;B.context&&(this._context=JSON.parse(B.context.toString()))}catch(O){null===(U=this.log)||void 0===U||U.error(this,this.handleWindowMessage,"Failed to parse AdContext from JSON").write()}this.isContentLoaded=!0,this._frameHeight=q.height+"px",this._frameWidth=q.width+"px",setTimeout((()=>__classPrivateFieldGet(this,Yb,"f").fire())),null===(G=this.log)||void 0===G||G.trace(this,this.handleWindowMessage,"ADS content loaded:",O).write()}},this.messageHandlerDisposer=addDisposableListener(window,"message",this.handleWindowMessage),this.setContentUrl()}get frameHeight(){return this._frameHeight}get frameWidth(){return this._frameWidth}get isActive(){return pt.track(this,"isActive"),this._isActive}set isActive(O){this._isActive!==O&&(this._isActive=O,pt.notify(this,"isActive"),this.sendVisibilitySignal())}get iframeId(){return this._iframeId}get adsUrl(){var O,B,U;return null!==(U=null===(B=null===(O=this._context)||void 0===O?void 0:O[0])||void 0===B?void 0:B.rlink)&&void 0!==U?U:""}onContentLoaded(O){let B=lifecycle_Disposable.None;return this.isContentLoaded?setTimeout(O):B=__classPrivateFieldGet(this,Yb,"f").event(O),B}sendVisibilitySignal(){var O;if(null===(O=this.frame)||void 0===O?void 0:O.contentWindow){const O=!this.cancelRender&&this.isContentLoaded&&this.isActive?"adsHoverIframeVisible":"adsHoverIframeInvisible";this.frame.contentWindow.postMessage(O,"*")}}setContentUrl(){const O=this.config.buildUrl(this.config.ads);O.searchParams.set("q",this.searchQuery),O.searchParams.set("iframeid",this.iframeId),O.searchParams.set("onlyadsovl","1"),O.searchParams.set("codex_conid",this.getConversationId()),O.searchParams.set("kseed",`${this.telemetry.getNextKSeed()}`),O.searchParams.set("SFX",this.telemetry.getNextInstSuffix()),db.colorScheme===e_.Dark&&O.searchParams.set("adonlydm","1");let B=3;do{O.searchParams.set("codex_summ",this.conversation.createConversationSummary(B--))}while(O.href.length>2e3);this.contentUrl=O.toString()}shouldHandleMessage(O){return zb.isPostMessageEvent(O)&&O.type===Lb.ContentLoaded&&this.iframeId===O.data.iframeid}getUUID(){return CoreUtils.uuid()}getConversationId(){return null===this.conversation.id?"":this.conversation.id}}Yb=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],HoverAdsModel.prototype,"isContentLoaded",void 0),__decorate([observable,__metadata("design:type",Boolean)],HoverAdsModel.prototype,"cancelRender",void 0),__decorate([observable,__metadata("design:type",String)],HoverAdsModel.prototype,"contentUrl",void 0),__decorate([observable,__metadata("design:type",String)],HoverAdsModel.prototype,"_frameHeight",void 0),__decorate([observable,__metadata("design:type",String)],HoverAdsModel.prototype,"_frameWidth",void 0);let Kb=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(O,B,U,j),this.config=G,this.conversation=q,this.hasAdvert=!1,this.singleCitationGroup=!1,this.enablePageHeaderOverlapClamping=!!this.config.features.enablePageHeaderOverlapClamping,this._target=null,this._adverts=[],this._adsModels=new Map,this._citationGroupMap=new Map}get showAttributionFavicons(){var O;return null===(O=this.config.features.enableHoverCardAttributionFavicons)||void 0===O||O}get target(){return this._target}get citations(){return pt.track(this,"citations"),this._citations}set citations(O){this._citations!==O&&(this._citations=O,pt.notify(this,"citations"),this.singleCitationGroup=1===(null==O?void 0:O.length))}get adverts(){return this._adverts}get activeAdModel(){return this._activeAdModel}set activeAdModel(O){this._activeAdModel!==O&&(this._activeAdModel&&(this._activeAdModel.isActive=!1,this._activeAdModel=void 0),(null==O?void 0:O.isContentLoaded)&&(this._activeAdModel=O,this._activeAdModel.isActive=!0),this.hasAdvert=void 0!==this.activeAdModel)}setTarget(O){var B,U;this._target!==O&&(null===(B=this.log)||void 0===B||B.trace(this,this.setTarget,null,O).write(),this._target=O,this.updateTargetDataByCitationId(null===(U=this.target)||void 0===U?void 0:U.dataset.citationid))}registerCitationGroup(O){var B;null===(B=this.log)||void 0===B||B.trace(this,this.registerCitationGroup,"group:",O).write(),O.advertQuery&&(O.advertModel=this.generateAdvertForQuery(O.advertQuery)),this._citationGroupMap.set(O.uuid,O)}applyLinkToTarget(){var O;if(this.target&&(null===(O=this.citations)||void 0===O?void 0:O.length)){let O=this.citations[0].link;if(this.citations.advertModel&&!this.citations.advertModel.cancelRender&&this.citations.advertModel.isContentLoaded){const{adsUrl:B}=this.citations.advertModel;this.config.features.enableApplyLinkToHoverAds&&B&&this.citations.useAdClickout&&(O=B)}this.target.setAttribute("href",O),this.target.setAttribute("target","_blank")}}clear(){this._adsModels.clear(),this._adverts=[],this._citationGroupMap.clear(),this.citations=void 0}generateAdvertForQuery(O){var B;let U=this._adsModels.get(O);return U||(U=new HoverAdsModel(O,this.config,this.conversation,this.telemetry,this.log),this._adsModels.set(O,U),this._adverts.push(U),null===(B=this.log)||void 0===B||B.trace(this,this.generateAdvertForQuery,O,"adverts:",this._adverts).write()),U}updateTargetDataByCitationId(O="-1"){var B,U,G;this.citations=this._citationGroupMap.get(O),(null===(B=this.citations)||void 0===B?void 0:B.advertQuery)?this.citations.advertQuery!==(null===(U=this.activeAdModel)||void 0===U?void 0:U.searchQuery)&&(this.activeAdModel=this._adsModels.get(this.citations.advertQuery)):this.activeAdModel=void 0,null===(G=this.log)||void 0===G||G.trace(this,this.updateTargetDataByCitationId,O,this.citations).write()}};var Qb;__decorate([observable,__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],Kb.prototype,"showAttributionFavicons",null),__decorate([observable,__metadata("design:type",Boolean)],Kb.prototype,"hasAdvert",void 0),__decorate([observable,__metadata("design:type",Boolean)],Kb.prototype,"singleCitationGroup",void 0),__decorate([observable,__metadata("design:type",Boolean)],Kb.prototype,"enablePageHeaderOverlapClamping",void 0),__decorate([observable,__metadata("design:type",Object)],Kb.prototype,"_target",void 0),__decorate([observable,__metadata("design:type",Array)],Kb.prototype,"_adverts",void 0),Kb=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Dc),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Kb),function(O){O.ConversationMode="Codex_ConversationMode",O.SemanticSerp="Codex_SemanticSerp",O.CreatorMode="Codex_CreatorMode",O.Others="Codex_Others"}(Qb||(Qb={}));const Zb=kt.createInterface("IHoverViewModel");let Xb=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(O,B,U,j),this.config=G,this.feedbackFormService=q,this.target=null,this.content=null,this.shouldBeVisible=!1,this.enablePageHeaderOverlapClamping=!!this.config.features.enablePageHeaderOverlapClamping,this.container=null}setContent(O){this.content=O}setTarget(O){this.target=O}get isMobile(){return this.serp.isMobile}initializeShareControl(O){this.feedbackFormService.createShareControl(O,this.getScenarioName(),this.config.features.enableShareModalDialog&&this.serp.serpSlot===jy.None?ch.Modal:ch.Tooltip)}get shareControlRef(){var O,B,U;const G=null!==(B=null===(O=this.container)||void 0===O?void 0:O.querySelector("span[data-menuid]"))&&void 0!==B?B:null;return G||null===(U=this.log)||void 0===U||U.error(this,"get shareControlRef","Share control not found in container",{container:this.container}).write(),G}onShow(){var O;this.target||null===(O=this.log)||void 0===O||O.error(this,this.onShow,"Share button not found").write(),this.feedbackFormService.showShareControl(this.shareControlRef,this.target)}onHide(){var O;this.target||null===(O=this.log)||void 0===O||O.error(this,this.onShow,"Share button not found").write(),this.feedbackFormService.hideShareControl(this.shareControlRef)}show(){this.shouldBeVisible=!this.shouldBeVisible}getScenarioName(){switch(this.serp.serpSlot){case jy.None:return Qb.ConversationMode;case jy.RightRail:return Qb.SemanticSerp;case jy.Creator:return Qb.CreatorMode;default:return Qb.Others}}};__decorate([observable,__metadata("design:type",Object)],Xb.prototype,"target",void 0),__decorate([observable,__metadata("design:type",Object)],Xb.prototype,"content",void 0),__decorate([observable,__metadata("design:type",Boolean)],Xb.prototype,"shouldBeVisible",void 0),__decorate([observable,__metadata("design:type",Boolean)],Xb.prototype,"enablePageHeaderOverlapClamping",void 0),Xb=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],Xb);const Jb=kt.createInterface("IMessageGroupViewModel");var eS;let tS=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(O,B,U,j),this.factory=G,this.perfTracker=q,eS.set(this,null),this._isExpanded=!1,this._messageCount=0,this._messages=[],this._author=null}get isExpanded(){return this._isExpanded}get messageCount(){return this._messageCount}get messages(){return this._messages}get source(){return this.author}get author(){if(null===this._author)throw new Error("MessageGroupViewModel has not been initialized.");return this._author}get serpSlotLastMetaMessage(){if(0===this.messageCount)return;let O;const B=this.messages.filter((O=>O.type===vp.Meta));return B.length>0&&(O=B[B.length-1]),O}get serpSlotFirstTextMessage(){if(0!==this.messageCount)return this.messages.find((O=>O.type===vp.Text))}get showSerpSlotMetaMessage(){return void 0!==this.serpSlotLastMetaMessage&&void 0===this.serpSlotFirstTextMessage}get turn(){if(null===__classPrivateFieldGet(this,eS,"f"))throw new Error("MessageGroupViewModel has not been initialized.");return __classPrivateFieldGet(this,eS,"f")}addGroupMessage(O){var B;if(O.author!==this.author)throw new Error(`Author mismatch. Group: '${this.author}' Message: '${O.author}'`);const U=this.createMessageVM(O);this._messages.push(U),this._messageCount=this._messages.length,this.author===Yi.Bot&&O.messageType===tr.Chat&&this.perfTracker.markEvent("FirstTokenResponse"),null===(B=this.log)||void 0===B||B.trace(this,this.addGroupMessage,`group message added: '${O.author}' (count: ${this._messageCount})`).write(),this.checkExpand(U)}initialize(O,B){__classPrivateFieldSet(this,eS,O,"f"),this._author=B}resetMessages(){this._messages.splice(0,this._messages.length),this._messageCount=0}checkExpand(O){O.type===vp.Host&&O.contentType===bp.SemSerp&&(this._isExpanded=!0)}createMessageVM(O){const B=this.factory.createMessage(O);return this._register(O.onMessageRemoved((()=>this.handleMessageRemoved(B)))),B}handleMessageRemoved(O){const B=this._messages.findIndex((B=>B===O));B>=0&&(this._messages.splice(B,1),this._messageCount=this._messages.length)}};eS=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],tS.prototype,"_isExpanded",void 0),__decorate([observable,__metadata("design:type",Number)],tS.prototype,"_messageCount",void 0),__decorate([observable,__metadata("design:type",Array)],tS.prototype,"_messages",void 0),__decorate([observable_volatile,__metadata("design:type",Object),__metadata("design:paramtypes",[])],tS.prototype,"serpSlotLastMetaMessage",null),__decorate([observable_volatile,__metadata("design:type",Object),__metadata("design:paramtypes",[])],tS.prototype,"serpSlotFirstTextMessage",null),__decorate([observable_volatile,__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],tS.prototype,"showSerpSlotMetaMessage",null),tS=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,Vt),__param(4,qc),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],tS);let iS=class extends MessageViewModelBase{constructor(O,B,U,G,q,j){super(B,U,G,q,j),this.cards=O,this._metaTextHtml="",this._icon=Cy.CheckMark,this._disableIcon=!1}get metaTextHtml(){return this._metaTextHtml}get icon(){return this._icon}get isShared(){return!1}get disableIcon(){return this._disableIcon}onModelPropertyChanged(O){switch(super.onModelPropertyChanged(O),O){case null:case"text":this._metaTextHtml=this.getFormattedHtml(),this._icon=this.getIconType(),this._disableIcon=this.model.disableIcon}}getFormattedHtml(){const{text:O,messageType:B}=this.model;if(this.config.features.enableServerMetaText)return this.cards.renderMarkdownToHtml(O);let U;switch(B){case tr.InternalSearchQuery:const B=/`(.*?)`/;U=this.getFormattedString(O,this.config.strings.metaInternalSearchQuery,B);break;case tr.InternalLoaderMessage:U=this.config.strings.metaInternalLoaderMessage;break;default:U=O}return this.cards.renderMarkdownToHtml(U)}getFormattedString(O,B,U){const G=null==O?void 0:O.match(U);let q=B;return null==G||G.forEach(((O,B)=>{q=q.replaceAll(`{${B}}`,O)})),q}getIconType(){const{messageType:O}=this.model;switch(O){case tr.InternalSearchQuery:return Cy.CheckMark;case tr.InternalLoaderMessage:return this.config.bingAtWork.isEnabled?Cy.LockClosed:Cy.CheckMark;default:return Cy.CheckMark}}};__decorate([observable,__metadata("design:type",String)],iS.prototype,"_metaTextHtml",void 0),__decorate([observable,__metadata("design:type",String)],iS.prototype,"_icon",void 0),iS=__decorate([__param(0,Dm),__param(1,ql),__param(2,qy),__param(3,gh),__param(4,$c),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],iS);const rS=kt.createInterface("IModalViewModel");var nS,oS;(function(O){O.FeedbackDialog="feedback-dialog",O.TestDialog="test-dialog"})(nS||(nS={})),function(O){O.Inaccurate="Inaccurate",O.Inappropriate="Inappropriate",O.Offensive="Offensive",O.Irrelevant="Irrelevant",O.Other="Other",O.None=""}(oS||(oS={}));const aS=kt.createInterface(nS.FeedbackDialog),sS=kt.createInterface("ISeeMoreContainerViewModel"),lS=kt.createInterface("ISerpFeedbackViewModel"),cS=kt.createInterface("ISlimHeaderViewModel"),dS=kt.createInterface("ICaptchaViewModel"),pS=kt.createInterface("ISerpViewModel");let uS=class FeedbackDialogViewModel extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y,K){super(O,B,U,K),this.eventBus=G,this.config=q,this.compliantFeedbackService=j,this.feedbackService=W,this.conversationModel=Y,this.showForm=!0,this.showNotification=!1,this.strings={formTitleText:this.config.strings.feedbackFormTitleText,formInputDefaultText:this.config.strings.feedbackFormInputDefaultText,formLegalText:this.config.strings.feedbackFormLegalText,formReportAConcern:this.config.strings.feedbackFormReportAConcern,submitButtonText:this.config.strings.submit,cancelButtonText:this.config.strings.cancel,reportConcernLink:this.config.links.reportAConcern,notificationTitleText:this.config.strings.feedbackFormNotificationTitleText,notificationText:this.config.strings.feedbackFormNotificationBodyText,closeButtonText:this.config.strings.close},this.categories=[oS.Inaccurate,oS.Inappropriate,oS.Offensive,oS.Irrelevant,oS.Other]}get dialogConfig(){return FeedbackDialogViewModel.dialogConfig}openFeedbackDialog(){this.eventBus.sendSystemCommand(Hh.ShowDialog,FeedbackDialogViewModel.dialogConfig),this.telemetry.trackEvent("ClientInst","FeedbackDialog_Show")}async submitForm(O,B){var U,G,q;if(this.displayNotification(),this.conversationModel.id)if(O)try{this.config.bingAtWork.isEnabled?await this.compliantFeedbackService.sendInlineFeedbackAsync(O,B):await this.feedbackService.sendInlineFeedbackAsync(O,B)}catch(O){null===(q=this.log)||void 0===q||q.error(this,this.submitForm,O.message).write(),this.telemetry.trackEvent("ClientInst","FeedbackDialog_Submit_Error")}else null===(G=this.log)||void 0===G||G.info(this,this.submitForm,"User chosen category is empty, skipping bing feedback").write();else null===(U=this.log)||void 0===U||U.info(this,this.submitForm,"ConversationId is null, skipping bing feedback").write()}closeFeedbackDialog(){this.showForm=!0,this.showNotification=!1,this.serp.modal.dismiss(),this.telemetry.trackEvent("ClientInst","FeedbackDialog_Closed")}displayNotification(){this.showForm=!1,this.showNotification=!0}};uS.dialogConfig={dialog:nS.FeedbackDialog,isLightDismiss:!0,enableDismissIconButton:!1},__decorate([observable,__metadata("design:type",Boolean)],uS.prototype,"showForm",void 0),__decorate([observable,__metadata("design:type",Boolean)],uS.prototype,"showNotification",void 0),uS=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,Zd),__param(4,ql),__param(5,nh),__param(6,ih),__param(7,Dc),__param(8,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object])],uS);const hS=kt.createInterface(nS.TestDialog);let mS=class TestDialogViewModel extends ViewModelBase{constructor(O,B,U,G){var q;super(O,B,U,G),null===(q=this.log)||void 0===q||q.trace(this,"ctor",null).write()}get dialogConfig(){return TestDialogViewModel.dialogConfig}};mS.dialogConfig={dialog:nS.TestDialog,isLightDismiss:!0,enableDismissIconButton:!0},mS=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object])],mS);const gS=new Map;var fS,yS;let _S=class extends ViewModelBase{constructor(O,B,U,G,q,j,W){var Y;super(O,B,U,W),this.config=G,this.eventBus=q,this.isFocusTrapped=!1,fS.set(this,void 0),this._currentDialog=null,this._isVisible=!1,yS.set(this,this._register(new Emitter)),this.strings={dismiss:this.config.strings.dismiss},this.handleSystemCommand=O=>{if(O.type===Hh.ShowDialog)if("string"==typeof O.data){const U=JSON.parse(O.data),G=(B=U.dialog,gS.get(B));if(G){const O=__classPrivateFieldGet(this,fS,"f").get(G);O&&(this.currentDialog=O)}}var B},null===(Y=this.log)||void 0===Y||Y.trace(this,"ctor",null).write(),__classPrivateFieldSet(this,fS,j,"f"),this._register(this.eventBus.onSystemCommand(this.handleSystemCommand))}get currentDialog(){return this._currentDialog}set currentDialog(O){null!==this._currentDialog&&this._currentDialog.dispose(),null===O&&(this.isVisible=!1),this._currentDialog=O,null!==this._currentDialog&&(this.isVisible=!0)}get isVisible(){return this._isVisible}set isVisible(O){this.isVisible!==O&&(this._isVisible=O,__classPrivateFieldGet(this,yS,"f").fire(this.isVisible),this.isVisible||(this.isFocusTrapped=!1))}get onVisibilityChanged(){return __classPrivateFieldGet(this,yS,"f").event}dismiss(){this.currentDialog=null}};fS=new WeakMap,yS=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],_S.prototype,"isFocusTrapped",void 0),__decorate([observable,__metadata("design:type",Object)],_S.prototype,"_currentDialog",void 0),__decorate([observable,__metadata("design:type",Boolean)],_S.prototype,"_isVisible",void 0),_S=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Zd),__param(5,Rt),__param(6,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],_S);let vS=class extends ViewModelBase{constructor(O,B,U,G,q){super(B,U,G,q),this.config=O,this.strings={seeMoreButton:this.config.strings.seeMore}}};var bS;__decorate([observable,__metadata("design:type",Object)],vS.prototype,"strings",void 0),vS=__decorate([__param(0,ql),__param(1,qy),__param(2,gh),__param(3,$c),__param(4,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object])],vS),function(O){O.Nothing="nothing",O.MicDisabledToMicListening="micDisabledToMicListening",O.MicDisabledToMicRest="micDisabledToMicRest",O.MicDisabled="micDisabled",O.MicListeningToMicDisabled="micListeningToMicDisabled",O.MicListeningToMicLoading="micListeningToMicLoading",O.MicListeningToMicRest="micListeningToMicRest",O.MicListeningToMicTextbox="micListeningToMicTextbox",O.MicListeningToTtsLoading="micListeningToTtsLoading",O.MicLoadingToMicDisabled="micLoadingToMicDisabled",O.MicLoadingToMicListening="micLoadingToMicListening",O.MicLoadingToMicRest="micLoadingToMicRest",O.MicLoadingLoop="micLoadingLoop",O.MicRestToMicDisabled="micRestToMicDisabled",O.MicRestToMicListening="micRestToMicListening",O.MicRestToMicLoading="micRestToMicLoading",O.MicRestToMicTextbox="micRestToMicTextbox",O.MicRestToNothing="micRestToNothing",O.MicRestToTtsActive="micRestToTtsActive",O.MicRestToTtsLoading="micRestToTtsLoading",O.MicRest="micRest",O.MicTextboxToMicListening="micTextboxToMicListening",O.MicTextboxToMicRest="micTextboxToMicRest",O.MicTextboxToTtsActive="micTextboxToTtsActive",O.MicTextbox="micTextbox",O.NothingToMicListening="nothingToMicListening",O.NothingToMicRest="nothingToMicRest",O.TtsActiveToMicRest="ttsActiveToMicRest",O.TtsActiveToMicTextbox="ttsActiveToMicTextbox",O.TtsLoadingToMicRest="ttsLoadingToMicRest",O.TtsLoadingToMicTextbox="ttsLoadingToMicTextbox",O.TtsLoadingToTtsActive="ttsLoadingToTtsActive"}(bS||(bS={}));const SS=kt.createInterface("ISpeechIconViewModel");var CS,ES,xS,TS,wS,kS,AS,RS,IS,PS,NS,OS,MS,DS,LS,BS,FS,zS,$S;let US=class extends lifecycle_Disposable{constructor(O,B,U,G,q,j){super(),this.telemetry=O,this.config=B,this.errorService=U,this.model=G,this.factory=q,this.log=j,this.isDevMode=!1,this.isMobile=!1,this.isCachedResponse=!1,this.isSeeMoreActivated=!1,this.serpSlot=jy.None,this.cardHeight=320,this.canTransition=!0,this.isSharedConversation=!1,CS.set(this,this._register(new Emitter)),ES.set(this,this._register(new Emitter)),xS.set(this,this._register(new Emitter)),TS.set(this,null),wS.set(this,null),kS.set(this,null),AS.set(this,null),RS.set(this,null),IS.set(this,null),PS.set(this,null),NS.set(this,null),OS.set(this,null),MS.set(this,null),DS.set(this,null),LS.set(this,null),BS.set(this,null),FS.set(this,null),zS.set(this,null),$S.set(this,null),this.handleWindowResize=()=>{var O;null===(O=this.log)||void 0===O||O.trace(this,this.handleWindowResize,"Disabling transitions.").write(),this.canTransition=!1},this.handleConversationConversationTypeChanged=O=>{this.config.features.enableThreadShareLandingPage&&(this.isSharedConversation=O===Bc.Shared)},this.onWindowResize=this._register(new DomEmitter(window,"resize")),this.onWindowResize.event(this.handleWindowResize),this.query=null,this.mode=Hy.getDefault(),this.alignment=this.getDefaultAlignment(),this.productType=Mb.getDefault(),this._register(this.model.onConversationTypeChanged(this.handleConversationConversationTypeChanged))}get enableFullScreenMobile(){return!!this.config.features.enableFullScreenMobile}get enableThreads(){return!!this.config.features.enableThreads}get onSerpSlotSuggestionInvoked(){return __classPrivateFieldGet(this,CS,"f").event}get onModeChanging(){return __classPrivateFieldGet(this,ES,"f").event}get onModeChanged(){return __classPrivateFieldGet(this,xS,"f").event}get actionBar(){var O;return __classPrivateFieldSet(this,TS,null!==(O=__classPrivateFieldGet(this,TS,"f"))&&void 0!==O?O:this._register(this.factory.create($y)),"f"),__classPrivateFieldGet(this,TS,"f")}get background(){var O;return __classPrivateFieldSet(this,wS,null!==(O=__classPrivateFieldGet(this,wS,"f"))&&void 0!==O?O:this._register(this.factory.create(Xy)),"f"),__classPrivateFieldGet(this,wS,"f")}get conversation(){var O;return __classPrivateFieldSet(this,kS,null!==(O=__classPrivateFieldGet(this,kS,"f"))&&void 0!==O?O:this._register(this.factory.create(Yy)),"f"),__classPrivateFieldGet(this,kS,"f")}get sidePanel(){var O;return __classPrivateFieldSet(this,AS,null!==(O=__classPrivateFieldGet(this,AS,"f"))&&void 0!==O?O:this._register(this.factory.create(gb)),"f"),__classPrivateFieldGet(this,AS,"f")}get captcha(){var O;return __classPrivateFieldSet(this,RS,null!==(O=__classPrivateFieldGet(this,RS,"f"))&&void 0!==O?O:this._register(this.factory.create(dS)),"f"),__classPrivateFieldGet(this,RS,"f")}get drawer(){var O;return __classPrivateFieldSet(this,IS,null!==(O=__classPrivateFieldGet(this,IS,"f"))&&void 0!==O?O:this._register(this.factory.create(Pb)),"f"),__classPrivateFieldGet(this,IS,"f")}get headerBar(){var O;return __classPrivateFieldSet(this,PS,null!==(O=__classPrivateFieldGet(this,PS,"f"))&&void 0!==O?O:this._register(this.factory.create(Nb)),"f"),__classPrivateFieldGet(this,PS,"f")}get hoverCard(){var O;return __classPrivateFieldSet(this,NS,null!==(O=__classPrivateFieldGet(this,NS,"f"))&&void 0!==O?O:this._register(this.factory.create(Wy)),"f"),__classPrivateFieldGet(this,NS,"f")}get hover(){var O;return __classPrivateFieldSet(this,OS,null!==(O=__classPrivateFieldGet(this,OS,"f"))&&void 0!==O?O:this._register(this.factory.create(Zb)),"f"),__classPrivateFieldGet(this,OS,"f")}get modal(){var O;return __classPrivateFieldSet(this,MS,null!==(O=__classPrivateFieldGet(this,MS,"f"))&&void 0!==O?O:this._register(this.factory.create(rS)),"f"),__classPrivateFieldGet(this,MS,"f")}get seeMoreContainer(){var O;return __classPrivateFieldSet(this,LS,null!==(O=__classPrivateFieldGet(this,LS,"f"))&&void 0!==O?O:this._register(this.factory.create(sS)),"f"),__classPrivateFieldGet(this,LS,"f")}get toneSelector(){var O;return __classPrivateFieldSet(this,DS,null!==(O=__classPrivateFieldGet(this,DS,"f"))&&void 0!==O?O:this._register(this.factory.create(vb)),"f"),__classPrivateFieldGet(this,DS,"f")}get serpFeedback(){var O;return __classPrivateFieldSet(this,BS,null!==(O=__classPrivateFieldGet(this,BS,"f"))&&void 0!==O?O:this._register(this.factory.create(lS)),"f"),__classPrivateFieldGet(this,BS,"f")}get slimHeader(){var O;return __classPrivateFieldSet(this,FS,null!==(O=__classPrivateFieldGet(this,FS,"f"))&&void 0!==O?O:this._register(this.factory.create(cS)),"f"),__classPrivateFieldGet(this,FS,"f")}get typingIndicator(){var O;return __classPrivateFieldSet(this,zS,null!==(O=__classPrivateFieldGet(this,zS,"f"))&&void 0!==O?O:this._register(this.factory.create(Ky)),"f"),__classPrivateFieldGet(this,zS,"f")}get speechIcon(){var O;return __classPrivateFieldSet(this,$S,null!==(O=__classPrivateFieldGet(this,$S,"f"))&&void 0!==O?O:this._register(this.factory.create(SS)),"f"),__classPrivateFieldGet(this,$S,"f")}changeMode(O){var B,U;!this.isDevMode&&[Hy.Home,Hy.Search].includes(O)||this.mode!==O&&(null===(B=this.log)||void 0===B||B.debug(this,this.changeMode,`SerpMode changing: ${O}`).write(),__classPrivateFieldGet(this,ES,"f").fire(O),this.canTransition=!0,O===Hy.Conversation&&(this.telemetry.trackEvent("ClientInst","EnterConversation"),this.query=null,this.conversation.ensureInitialized()),this.mode===Hy.Conversation&&this.telemetry.trackEvent("ClientInst","ExitConversation"),this.mode=O,__classPrivateFieldGet(this,xS,"f").fire(this.mode),null===(U=this.log)||void 0===U||U.debug(this,this.changeMode,`SerpMode changed: ${this.mode}`).write())}inMode(O){return this.mode===O}invokeSuggestion(O){this.isConversationChatDisabled()||(null!==O&&this.actionBar.submitSuggestion(O),this.changeMode(Hy.Conversation),this.serpSlot!==jy.None&&__classPrivateFieldGet(this,CS,"f").fire(null!==O))}submitQuery(O){var B;this.isConversationChatDisabled()||(null!==O&&this.conversation.addConversationMessage(O),this.mode!==Hy.Conversation&&this.query!==O&&(null===(B=this.log)||void 0===B||B.debug(this,this.submitQuery,`Query received: ${O}`).write(),this.query=O,null!==this.query&&setTimeout((()=>this.afterQueryReceived()),333)))}afterQueryReceived(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.afterQueryReceived,null).write(),this.randomizeCardHeight(),this.changeMode(Hy.Search)}queryChanged(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.queryChanged,`Query changed: ${this.query}`).write()}isConversationChatDisabled(){return this.mode===Hy.Conversation&&this.errorService.isChatDisabled()}getDefaultAlignment(){return Gy.Left}randomizeCardHeight(){this.cardHeight=Math.floor(400*Math.random())+240}};CS=new WeakMap,ES=new WeakMap,xS=new WeakMap,TS=new WeakMap,wS=new WeakMap,kS=new WeakMap,AS=new WeakMap,RS=new WeakMap,IS=new WeakMap,PS=new WeakMap,NS=new WeakMap,OS=new WeakMap,MS=new WeakMap,DS=new WeakMap,LS=new WeakMap,BS=new WeakMap,FS=new WeakMap,zS=new WeakMap,$S=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],US.prototype,"isDevMode",void 0),__decorate([observable,__metadata("design:type",Boolean)],US.prototype,"isMobile",void 0),__decorate([observable,__metadata("design:type",Boolean)],US.prototype,"isCachedResponse",void 0),__decorate([observable,__metadata("design:type",Boolean)],US.prototype,"isSeeMoreActivated",void 0),__decorate([observable,__metadata("design:type",String)],US.prototype,"mode",void 0),__decorate([observable,__metadata("design:type",String)],US.prototype,"productType",void 0),__decorate([observable,__metadata("design:type",String)],US.prototype,"alignment",void 0),__decorate([observable,__metadata("design:type",String)],US.prototype,"serpSlot",void 0),__decorate([observable,__metadata("design:type",Object)],US.prototype,"query",void 0),__decorate([observable,__metadata("design:type",Number)],US.prototype,"cardHeight",void 0),__decorate([observable,__metadata("design:type",Boolean)],US.prototype,"canTransition",void 0),__decorate([observable,__metadata("design:type",Boolean)],US.prototype,"isSharedConversation",void 0),US=__decorate([__param(0,$c),__param(1,ql),__param(2,Uc),__param(3,Dc),__param(4,Vt),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],US);let VS=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(O,B,U,j),this.feedbackForm=G,this.config=q,this.feedbackString=this.config.strings.serpfeedback}openFeedbackForm(){this.feedbackForm.openFeedbackForm()}};VS=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,lh),__param(4,ql),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],VS);const GS=kt.createInterface("IDeleteConversationViewModel");var HS;(function(O){O[O.Idle=0]="Idle",O[O.InProgress=1]="InProgress",O[O.Failed=2]="Failed",O[O.Succeeded=3]="Succeeded"})(HS||(HS={}));const qS=kt.createInterface("IPluginPanelViewModel");var jS;let WS=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y,K,Q){super(O,B,U,Q),this.config=G,this.factory=q,this.manager=j,this.eventBus=W,this.pluginPanel=Y,this.chats=K,this.isThreadsPanelExpanded=!1,this.isThreadsPanelDocked=!1,this.shouldShowExpansion=!1,this.selectedPanel=this.config.features.enableFlux3P?fb.Plugins:fb.Threads,this.panels=[],this.sidePanelScrollTop=0,jS.set(this,void 0),this.isVisibleDesktop=!0,this.isVisibleMobile=!1,this._threads=[],this._activeThread=null,this.lastThreadConvId="",this.currentTone=cr.Balanced,this.defaultThreadID="defaultThread",this.handleDesignSystemChanged=O=>{var B;null===(B=this.log)||void 0===B||B.trace(this,this.handleDesignSystemChanged,null).write();const{responseMode:U}=O;this.currentTone=this.currentToneAsBingResponseTone(U)},this.handleSystemEvent=O=>{if(this.config.features.enableThreads&&O.type===Xd.CreateUpdateThread){const B=JSON.parse(O.data);this.handleCreateUpdateThread(B)}},this.resetActive=()=>{if(this.config.features.enableThreads&&(this.activeThread=null,this.config.features.enableThreadShareLandingPage))for(const O of this._threads)O.isActive=!1},this.handleWindowFocus=O=>{const B=O.target;"hidden"!==(null==B?void 0:B.visibilityState)&&this.config.features.enableThreadSync&&this.getChats()},this.initializeHeaderTabs(),this._register(db.onDesignSystemChanged(this.handleDesignSystemChanged)),this.config.features.enableThreadsTestData&&setTimeout((()=>{this.createDefaultThread(),this.initializeThreads(),this.initializeThreads(),this.initializeThreads(),this.initializeThreads()}),0),this.config.features.enableGetChats&&this.getChats(),this.eventBus.onSystemEvent(this.handleSystemEvent),this.manager.onResetConversationInvoked(this.resetActive.bind(this)),this._register(addDisposableListener(window,"visibilitychange",this.handleWindowFocus)),this.attachNotifiers()}get activeThread(){return pt.track(this,"activeThread"),this._activeThread}set activeThread(O){this._activeThread!==O&&(this.activeThread&&(this.activeThread.isActive=!1),this._activeThread=O,this.activeThread&&(this.activeThread.isActive=!0),pt.notify(this,"activeThread"))}get threads(){return this._threads}get historyConversationVm(){var O;return __classPrivateFieldSet(this,jS,null!==(O=__classPrivateFieldGet(this,jS,"f"))&&void 0!==O?O:this.factory.create(Tb),"f"),__classPrivateFieldGet(this,jS,"f")}get isVisible(){return(this.serp.isMobile&&this.isVisibleMobile||!this.serp.isMobile&&this.isVisibleDesktop)&&this.config.features.enableThreads}set isVisible(O){this.isVisible=O}toggleVisibility(O){this.isVisibleDesktop=null!=O?O:!this.isVisibleDesktop,this.isVisibleMobile=null!=O?O:!this.isVisibleMobile}handleThreadsPanelExpansionClick(){this.isThreadsPanelExpanded=!this.isThreadsPanelExpanded}removeThread(O){const B=this._threads.indexOf(O);B>=0&&this._threads.splice(B,1)}get threadsPanelExpansionText(){return this.isThreadsPanelExpanded?this.config.strings.threadsMinimizeRecent:this.config.strings.threadsSeeAllRecent}addThread(O){this.telemetry.trackEvent("InteractionEvent","AddThreadAPI",{Namespace:"SidePanel",CustomData:JSON.stringify({convId:O.conversationId})}),this._threads.push(this.createThreadVM(O))}updateSidePanelScrollTop(O){this.sidePanelScrollTop=O}handleLoadVisibility(O){this.isVisibleMobile=!1,this.activeThread=O}createDefaultThread(){const O=(new Date).getTime();this._threads.push(this.createThreadVM(new ThreadData(this.config.strings.threadsDefaultChatName,this.currentTone,O,O,O+72e5,this.defaultThreadID,""))),this.lastThreadConvId=this.defaultThreadID}currentToneAsBingResponseTone(O){let B=cr.Balanced;return O===sr.Creative?B=cr.Creative:O===sr.Precise&&(B=cr.Precise),B}initializeHeaderTabs(){this.config.features.enableFlux3P?this.panels=[{type:fb.Threads,label:this.config.strings.threadsRecentTitleShort},{type:fb.Plugins,label:this.config.strings.pluginTitle}]:this.panels=[{type:fb.Threads,label:this.config.strings.threadsRecentTitle}]}initializeThreads(){this._threads.push(this.createThreadVM(new ThreadData(this.config.strings.threadsDefaultChatName,cr.Balanced,(new Date).getTime(),(new Date).getTime(),(new Date).getTime()+72e5,"",""))),this._threads.push(this.createThreadVM(new ThreadData(this.config.strings.threadsDefaultChatName,cr.Creative,(new Date).getTime()-18e6,(new Date).getTime(),(new Date).getTime()+72e5,"",""))),this._threads.push(this.createThreadVM(new ThreadData(this.config.strings.threadsDefaultChatName,cr.Creative,(new Date).getTime()-864e5,(new Date).getTime(),(new Date).getTime()+72e5,"",""))),this._threads.push(this.createThreadVM(new ThreadData(this.config.strings.threadsDefaultChatName,cr.Precise,(new Date).getTime()-1728e5,(new Date).getTime(),(new Date).getTime()+72e5,"",""))),this._threads.push(this.createThreadVM(new ThreadData(this.config.strings.threadsDefaultChatName,cr.Balanced,(new Date).getTime()-252e5,(new Date).getTime(),(new Date).getTime()+72e5,"","")))}createThreadVM(O){const B=this.factory.createThread(O);return B.model&&(this._register(B.model.onThreadRemoved((()=>this.handleThreadRemoved(B)))),this._register(B.onThreadLoad((()=>this.handleLoadVisibility(B))))),B.historyConversationVm=this.historyConversationVm,B.sidePanelVm=this,B}handleThreadRemoved(O){var B,U,G;const q=this._threads.findIndex((B=>B===O));q>=0&&((null===(B=this._threads[q].model)||void 0===B?void 0:B.id)===(null===(G=null===(U=this.activeThread)||void 0===U?void 0:U.model)||void 0===G?void 0:G.id)&&(this.resetActive(),this.manager.resetConversation()),this._threads.splice(q,1))}handleCreateUpdateThread(O){var B;if(O&&this.lastThreadConvId===this.defaultThreadID){const B=this._threads.pop();B.name!==this.config.strings.threadsDefaultChatName&&(O.text=B.name)}if(O&&this.lastThreadConvId!==O.id){const U=this.getThreadViewModel(O);(null===(B=U.model)||void 0===B?void 0:B.threadData)&&(U.model.threadData.tone=this.currentTone),this.resetActive(),this.activeThread=U,this.telemetry.trackEvent("InteractionEvent","AddThreadEvent",{Namespace:"SidePanel",CustomData:JSON.stringify({convId:O.id})}),this.lastThreadConvId=O.id}}getThreadViewModel(O){var B;let U=null;if(this.config.features.enableThreadShareLandingPage)for(const G of this._threads)if((null===(B=G.model)||void 0===B?void 0:B.id)===O.id){U=G;break}if(U)return U;const{text:G,expiry:q,id:j,conversationSignature:W}=O;if(O.type===Em.Shared&&this.config.features.enableThreadShareLandingPage){const O=new SharedThreadData(G,cr.Balanced,(new Date).getTime(),-1,q,j,W);U=this.createThreadVM(O)}else{const O=new ThreadData(G,cr.Balanced,(new Date).getTime(),-1,q,j,W);U=this.createThreadVM(O)}return this._threads.unshift(U),U}generateChatsVM(O){return O.map((O=>this.createThreadVM(O)))}async getChats(){var O;try{const B=await this.chats.getChats();if(!B)return void(null===(O=this.log)||void 0===O||O.trace(this,this.getChats,"Chats fetched successfully - No previous chats were found").write());if(!B.length)return void this._threads.splice(0,this.threads.length);{const O=this.generateChatsVM(B);this._threads.splice(0,this.threads.length,...this.getSortedThreads(O))}}finally{this.threads.length||this.createDefaultThread()}}getSortedThreads(O){return O.sort(((O,B)=>{var U,G;return(null===(U=O.model)||void 0===U?void 0:U.threadData)&&(null===(G=B.model)||void 0===G?void 0:G.threadData)?B.model.threadData.updateTimeUtc-O.model.threadData.updateTimeUtc:0}))}attachNotifiers(){const O={handleChange:O=>{O.length||this.createDefaultThread()}};pt.getNotifier(this._threads).subscribe(O)}};jS=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],WS.prototype,"isThreadsPanelExpanded",void 0),__decorate([observable,__metadata("design:type",Boolean)],WS.prototype,"isThreadsPanelDocked",void 0),__decorate([observable,__metadata("design:type",Boolean)],WS.prototype,"shouldShowExpansion",void 0),__decorate([observable,__metadata("design:type",String)],WS.prototype,"selectedPanel",void 0),__decorate([observable,__metadata("design:type",Boolean)],WS.prototype,"isVisibleDesktop",void 0),__decorate([observable,__metadata("design:type",Boolean)],WS.prototype,"isVisibleMobile",void 0),__decorate([observable,__metadata("design:type",Array)],WS.prototype,"_threads",void 0),__decorate([observable_volatile,__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],WS.prototype,"isVisible",null),WS=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Vt),__param(5,uh),__param(6,Zd),__param(7,qS),__param(8,GS),__param(9,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],WS);let YS=class extends ViewModelBase{constructor(O,B,U,G,q){super(O,B,U,q),this.config=G,this.strings={letsChat:this.config.strings.letsChat}}enableConversationMode(){this.serp.invokeSuggestion(null)}};__decorate([observable,__metadata("design:type",Object)],YS.prototype,"strings",void 0),YS=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object])],YS);let KS=class extends ViewModelBase{constructor(O,B,U,G,q){super(O,B,U,q),this.config=G,this.iconNextStates=[bS.MicRest]}queueIconNextStates(O,B){var U;null===(U=this.log)||void 0===U||U.trace(this,this.queueIconNextStates,"SpeechIconState:",O,"->",B).write();let G=[],q="";switch(B){case"hidden":if(this.serp.isMobile)switch(O){case"standby":G=[bS.MicRestToMicTextbox];break;case"listening":G=[bS.MicListeningToMicTextbox];break;case"loading":G=[bS.TtsLoadingToMicTextbox];break;case"speaking":G=[bS.TtsActiveToMicTextbox];break;default:G=[bS.MicTextbox]}else G=[bS.Nothing];break;case"standby":switch(O){case"hidden":G=this.serp.isMobile?[bS.MicTextboxToMicRest]:[bS.NothingToMicRest];break;case"micpending":G=[bS.MicLoadingToMicRest];break;case"listening":G=[bS.MicListeningToMicRest];break;case"loading":G=[bS.TtsLoadingToMicRest];break;case"speaking":G=[bS.TtsActiveToMicRest];break;case"errored":default:G=[bS.MicRest];break;case"blocked":G=[bS.MicDisabledToMicRest]}break;case"micpending":switch(O){case"hidden":G=[bS.NothingToMicRest,bS.MicRestToMicLoading,bS.MicLoadingLoop];break;case"standby":G=[bS.MicRestToMicLoading,bS.MicLoadingLoop];break;case"speaking":G=[bS.TtsActiveToMicRest,bS.MicRestToMicLoading,bS.MicLoadingLoop];break;default:G=[bS.MicLoadingLoop]}break;case"listening":switch(O){case"hidden":G=this.serp.isMobile?[bS.MicTextboxToMicListening]:[bS.NothingToMicListening];break;case"micpending":G=[bS.MicLoadingToMicListening];break;case"standby":G=[bS.MicRestToMicListening];break;case"blocked":G=[bS.MicDisabledToMicListening]}break;case"loading":if("listening"===O)G=[bS.MicListeningToTtsLoading];break;case"speaking":switch(O){case"hidden":G=this.serp.isMobile?[bS.MicTextboxToTtsActive]:[bS.NothingToMicRest];break;case"standby":G=[bS.MicRestToTtsActive];break;case"loading":G=[bS.TtsLoadingToTtsActive]}break;case"errored":switch(O){case"standby":G=[bS.MicRestToMicLoading,bS.MicLoadingLoop];break;case"listening":G=[bS.MicListeningToMicLoading,bS.MicLoadingLoop];break;case"loading":G=[bS.TtsLoadingToMicRest];break;default:G=[bS.NothingToMicRest,bS.MicRestToMicLoading,bS.MicLoadingLoop]}break;case"blocked":switch(O){case"hidden":G=[bS.NothingToMicRest,bS.MicRestToMicDisabled];break;case"standby":G=[bS.MicRestToMicDisabled];break;case"micpending":G=[bS.MicLoadingToMicDisabled];break;case"listening":G=[bS.MicListeningToMicDisabled];break;default:G=[bS.MicDisabled]}}switch(B){case"standby":q=this.config.strings.actionBarSpeechBtnStartListeningAriaLabel;break;case"listening":case"loading":q=this.config.strings.actionBarSpeechBtnStopListeningAriaLabel;break;case"speaking":q=this.config.strings.actionBarSpeechBtnStopReadoutAriaLabel}this.iconNextStates=G,this.ariaLabelText=q}};__decorate([observable,__metadata("design:type",Array)],KS.prototype,"iconNextStates",void 0),__decorate([observable,__metadata("design:type",String)],KS.prototype,"ariaLabelText",void 0),KS=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object])],KS);class HTMLDirective{constructor(){this.targetIndex=0}}class TargetedHTMLDirective extends HTMLDirective{constructor(){super(...arguments),this.createPlaceholder=dt.createInterpolationPlaceholder}}class AttachedBehaviorHTMLDirective extends HTMLDirective{constructor(O,B,U){super(),this.name=O,this.behavior=B,this.options=U}createPlaceholder(O){return dt.createCustomAttributePlaceholder(this.name,O)}createBehavior(O){return new this.behavior(O,this.options)}}function normalBind(O,B){this.source=O,this.context=B,null===this.bindingObserver&&(this.bindingObserver=pt.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(O,B))}function triggerBind(O,B){this.source=O,this.context=B,this.target.addEventListener(this.targetName,this)}function normalUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function contentUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null;const O=this.target.$fastView;void 0!==O&&O.isComposed&&(O.unbind(),O.needsBindOnly=!0)}function triggerUnbind(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function updateAttributeTarget(O){dt.setAttribute(this.target,this.targetName,O)}function updateBooleanAttributeTarget(O){dt.setBooleanAttribute(this.target,this.targetName,O)}function updateContentTarget(O){if(null==O&&(O=""),O.create){this.target.textContent="";let B=this.target.$fastView;void 0===B?B=O.create():this.target.$fastTemplate!==O&&(B.isComposed&&(B.remove(),B.unbind()),B=O.create()),B.isComposed?B.needsBindOnly&&(B.needsBindOnly=!1,B.bind(this.source,this.context)):(B.isComposed=!0,B.bind(this.source,this.context),B.insertBefore(this.target),this.target.$fastView=B,this.target.$fastTemplate=O)}else{const B=this.target.$fastView;void 0!==B&&B.isComposed&&(B.isComposed=!1,B.remove(),B.needsBindOnly?B.needsBindOnly=!1:B.unbind()),this.target.textContent=O}}function updatePropertyTarget(O){this.target[this.targetName]=O}function updateClassTarget(O){const B=this.classVersions||Object.create(null),U=this.target;let G=this.version||0;if(null!=O&&O.length){const q=O.split(/\s+/);for(let O=0,j=q.length;O<j;++O){const j=q[O];""!==j&&(B[j]=G,U.classList.add(j))}}if(this.classVersions=B,this.version=G+1,0!==G){G-=1;for(const O in B)B[O]===G&&U.classList.remove(O)}}class HTMLBindingDirective extends TargetedHTMLDirective{constructor(O){super(),this.binding=O,this.bind=normalBind,this.unbind=normalUnbind,this.updateTarget=updateAttributeTarget,this.isBindingVolatile=pt.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(O){if(this.originalTargetName=O,void 0!==O)switch(O[0]){case":":if(this.cleanedTargetName=O.substr(1),this.updateTarget=updatePropertyTarget,"innerHTML"===this.cleanedTargetName){const O=this.binding;this.binding=(B,U)=>dt.createHTML(O(B,U))}break;case"?":this.cleanedTargetName=O.substr(1),this.updateTarget=updateBooleanAttributeTarget;break;case"@":this.cleanedTargetName=O.substr(1),this.bind=triggerBind,this.unbind=triggerUnbind;break;default:this.cleanedTargetName=O,"class"===O&&(this.updateTarget=updateClassTarget)}}targetAtContent(){this.updateTarget=updateContentTarget,this.unbind=contentUnbind}createBehavior(O){return new BindingBehavior(O,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}}class BindingBehavior{constructor(O,B,U,G,q,j,W){this.source=null,this.context=null,this.bindingObserver=null,this.target=O,this.binding=B,this.isBindingVolatile=U,this.bind=G,this.unbind=q,this.updateTarget=j,this.targetName=W}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(O){ExecutionContext.setEvent(O);const B=this.binding(this.source,this.context);ExecutionContext.setEvent(null),!0!==B&&O.preventDefault()}}let QS=null;class CompilationContext{addFactory(O){O.targetIndex=this.targetIndex,this.behaviorFactories.push(O)}captureContentBinding(O){O.targetAtContent(),this.addFactory(O)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){QS=this}static borrow(O){const B=QS||new CompilationContext;return B.directives=O,B.reset(),QS=null,B}}function createAggregateBinding(O){if(1===O.length)return O[0];let B;const U=O.length,G=O.map((O=>"string"==typeof O?()=>O:(B=O.targetName||B,O.binding))),q=new HTMLBindingDirective(((O,B)=>{let q="";for(let j=0;j<U;++j)q+=G[j](O,B);return q}));return q.targetName=B,q}const ZS=ct.length;function parseContent(O,B){const U=B.split(lt);if(1===U.length)return null;const G=[];for(let B=0,q=U.length;B<q;++B){const q=U[B],j=q.indexOf(ct);let W;if(-1===j)W=q;else{const B=parseInt(q.substring(0,j));G.push(O.directives[B]),W=q.substring(j+ZS)}""!==W&&G.push(W)}return G}function compileAttributes(O,B,U=!1){const G=B.attributes;for(let q=0,j=G.length;q<j;++q){const W=G[q],Y=W.value,K=parseContent(O,Y);let Q=null;null===K?U&&(Q=new HTMLBindingDirective((()=>Y)),Q.targetName=W.name):Q=createAggregateBinding(K),null!==Q&&(B.removeAttributeNode(W),q--,j--,O.addFactory(Q))}}function compileContent(O,B,U){const G=parseContent(O,B.textContent);if(null!==G){let q=B;for(let j=0,W=G.length;j<W;++j){const W=G[j],Y=0===j?B:q.parentNode.insertBefore(document.createTextNode(""),q.nextSibling);"string"==typeof W?Y.textContent=W:(Y.textContent=" ",O.captureContentBinding(W)),q=Y,O.targetIndex++,Y!==B&&U.nextNode()}O.targetIndex--}}const XS=document.createRange();class HTMLView{constructor(O,B){this.fragment=O,this.behaviors=B,this.source=null,this.context=null,this.firstChild=O.firstChild,this.lastChild=O.lastChild}appendTo(O){O.appendChild(this.fragment)}insertBefore(O){if(this.fragment.hasChildNodes())O.parentNode.insertBefore(this.fragment,O);else{const B=O.parentNode,U=this.lastChild;let G,q=this.firstChild;for(;q!==U;)G=q.nextSibling,B.insertBefore(q,O),q=G;B.insertBefore(U,O)}}remove(){const O=this.fragment,B=this.lastChild;let U,G=this.firstChild;for(;G!==B;)U=G.nextSibling,O.appendChild(G),G=U;O.appendChild(B)}dispose(){const O=this.firstChild.parentNode,B=this.lastChild;let U,G=this.firstChild;for(;G!==B;)U=G.nextSibling,O.removeChild(G),G=U;O.removeChild(B);const q=this.behaviors,j=this.source;for(let O=0,B=q.length;O<B;++O)q[O].unbind(j)}bind(O,B){const U=this.behaviors;if(this.source!==O)if(null!==this.source){const G=this.source;this.source=O,this.context=B;for(let q=0,j=U.length;q<j;++q){const j=U[q];j.unbind(G),j.bind(O,B)}}else{this.source=O,this.context=B;for(let G=0,q=U.length;G<q;++G)U[G].bind(O,B)}}unbind(){if(null===this.source)return;const O=this.behaviors,B=this.source;for(let U=0,G=O.length;U<G;++U)O[U].unbind(B);this.source=null}static disposeContiguousBatch(O){if(0!==O.length){XS.setStartBefore(O[0].firstChild),XS.setEndAfter(O[O.length-1].lastChild),XS.deleteContents();for(let B=0,U=O.length;B<U;++B){const U=O[B],G=U.behaviors,q=U.source;for(let O=0,B=G.length;O<B;++O)G[O].unbind(q)}}}}class ViewTemplate{constructor(O,B){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=O,this.directives=B}create(O){if(null===this.fragment){let O;const B=this.html;if("string"==typeof B){O=document.createElement("template"),O.innerHTML=dt.createHTML(B);const U=O.content.firstElementChild;null!==U&&"TEMPLATE"===U.tagName&&(O=U)}else O=B;const U=function(O,B){const U=O.content;document.adoptNode(U);const G=CompilationContext.borrow(B);compileAttributes(G,O,!0);const q=G.behaviorFactories;G.reset();const j=dt.createTemplateWalker(U);let W;for(;W=j.nextNode();)switch(G.targetIndex++,W.nodeType){case 1:compileAttributes(G,W);break;case 3:compileContent(G,W,j);break;case 8:dt.isMarker(W)&&G.addFactory(B[dt.extractDirectiveIndexFromMarker(W)])}let Y=0;(dt.isMarker(U.firstChild)||1===U.childNodes.length&&B.length)&&(U.insertBefore(document.createComment(""),U.firstChild),Y=-1);const K=G.behaviorFactories;return G.release(),{fragment:U,viewBehaviorFactories:K,hostBehaviorFactories:q,targetOffset:Y}}(O,this.directives);this.fragment=U.fragment,this.viewBehaviorFactories=U.viewBehaviorFactories,this.hostBehaviorFactories=U.hostBehaviorFactories,this.targetOffset=U.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}const B=this.fragment.cloneNode(!0),U=this.viewBehaviorFactories,G=new Array(this.behaviorCount),q=dt.createTemplateWalker(B);let j=0,W=this.targetOffset,Y=q.nextNode();for(let O=U.length;j<O;++j){const O=U[j],B=O.targetIndex;for(;null!==Y;){if(W===B){G[j]=O.createBehavior(Y);break}Y=q.nextNode(),W++}}if(this.hasHostBehaviors){const B=this.hostBehaviorFactories;for(let U=0,q=B.length;U<q;++U,++j)G[j]=B[U].createBehavior(O)}return new HTMLView(B,G)}render(O,B,U){"string"==typeof B&&(B=document.getElementById(B)),void 0===U&&(U=B);const G=this.create(U);return G.bind(O,ht),G.appendTo(B),G}}const JS=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function html(O,...B){const U=[];let G="";for(let q=0,j=O.length-1;q<j;++q){const j=O[q];let W=B[q];if(G+=j,W instanceof ViewTemplate){const O=W;W=()=>O}if("function"==typeof W&&(W=new HTMLBindingDirective(W)),W instanceof TargetedHTMLDirective){const O=JS.exec(j);null!==O&&(W.targetName=O[2])}W instanceof HTMLDirective?(G+=W.createPlaceholder(U.length),U.push(W)):G+=W}return G+=O[O.length-1],new ViewTemplate(G,U)}const eC=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function createTemplate(O,B){const U=[];let G="";for(let q=0,j=O.length-1;q<j;++q){const j=O[q];let W=B[q];if(G+=j,W instanceof ViewTemplate){const O=W;W=()=>O}if("function"==typeof W&&(W=new HTMLBindingDirective(W)),W instanceof TargetedHTMLDirective){const O=eC.exec(j);null!==O&&(W.targetName=O[2])}W instanceof HTMLDirective?(G+=W.createPlaceholder(U.length),U.push(W)):G+=W}return G+=O[O.length-1],new ViewTemplate(G,U)}class OnceBehavior{constructor(O,B,U,G,q){this.location=O,this.itemBinding=B,this.templateBinding=G,this.source=null,this.view=null,this.item=null,this.itemObserver=null,this.itemBindingObserver=pt.binding(B,this,U),this.templateBindingObserver=pt.binding(G,this,q)}bind(O,B){this.source=O,this.originalContext=B,this.childContext=Object.create(B),this.childContext.parent=O,this.childContext.parentContext=this.originalContext,this.item=this.itemBindingObserver.observe(O,this.originalContext),this.template=this.templateBindingObserver.observe(O,this.originalContext),this.observeItem(!0),this.refreshView()}unbind(){var O;this.source=null,this.item=null,null!==this.itemObserver&&this.itemObserver.unsubscribe(this),null===(O=this.view)||void 0===O||O.unbind(),this.itemBindingObserver.disconnect(),this.templateBindingObserver.disconnect()}handleChange(O){O===this.itemBinding?(this.item=this.itemBindingObserver.observe(this.source,this.originalContext),this.observeItem(),this.refreshView()):O===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.originalContext),this.refreshView(!0)):this.refreshView()}observeItem(O=!1){if(null===this.item)return void(this.item={});const B=this.itemObserver,U=this.itemObserver=pt.getNotifier(this.item),G=B!==U;G&&null!==B&&B.unsubscribe(this),(G||O)&&U.subscribe(this)}createView(){this.view=this.template.create(),this.bindView(),this.view.insertBefore(this.location)}bindView(){var O;null===(O=this.view)||void 0===O||O.bind(this.item,this.childContext)}refreshView(O=!1){var B;O&&(null===(B=this.view)||void 0===B||B.dispose(),this.view=null),null===this.view?this.createView():this.bindView()}}class OnceDirective extends HTMLDirective{constructor(O,B){super(),this.itemBinding=O,this.templateBinding=B,this.createPlaceholder=dt.createBlockPlaceholder,this.isItemBindingVolatile=pt.isVolatileBinding(O),this.isTemplateBindingVolatile=pt.isVolatileBinding(B)}createBehavior(O){return new OnceBehavior(O,this.itemBinding,this.isItemBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile)}}function OnceDirective_once(O,B){return new OnceDirective(O,"function"==typeof B?B:()=>B)}const tC=kt.createInterface("ITurnCounterViewModel");var iC,rC,nC,oC;(function(O){O.Green="green",O.Amber="amber",O.Red="red"})(iC||(iC={}));const aC="-group",sC="<code>-1#5#9#5#1-</code>",lC=html`
  ${OnceDirective_once((O=>O.fateLink),html`
  <a
    h="${O=>O.h}"
    href="${O=>O.link}"
    title="${O=>O.title}"
    target="_blank"
    @click=${(O,B)=>O.handleLinkClick(B.event)}
    >${O=>O.sourceCaption}</a
  >
`)}
`;html`
   <cib-message-attributions :vm=${O=>O}></cib-message-attributions>
`;let cC=class extends MessageViewModelBase{constructor(O,B,U,G,q,j,W,Y,K,Q,Z,X,J){super(B,U,K,Z,J),this.cards=O,this.conversation=G,this.hoverCard=q,this.turnCounter=j,this.feedbackDialog=W,this.vmFactory=Y,this.katex=Q,this.perfTracker=X,this.turnIndex=this.conversation.turnCount,rC.set(this,null),nC.set(this,null),oC.set(this,null),this._inlineAdsViewModel=null,this._fateOverrideTemplate=null,this._adaptiveCardTemplate=null,this._displayMode=Ty.Text,this._attributions=[],this._fateLink=null,this.subdomainToRemove=["www","ww2","mobile","m"],this.messageId=CoreUtils.uuid(),this.citationGroupLinks=new Map,this.loadingAdModels=new Set,this.groupAdModels=new Map,this.handleKatexMessageCopy=O=>!this.config.features.enableKatexCopy||this.katex.handleCopyEvent(O),this.handleLinkClick=O=>{let B;if(!(O.currentTarget instanceof HTMLAnchorElement))throw new Error("Link click event target is not an HTMLAnchorElement");return B=O.currentTarget,this.telemetry.trackInteractionEvent(O),this.telemetry.trackEvent("ClientInst","LinkClicked",{link:B.href}),!0},this.handleDocumentLinkClick=O=>{var B;const U=O.target,G=U.dataset.info;return!!G&&(null===(B=window.sj_evt)||void 0===B||B.fire("Discover.Chat.SydneyClickPageCitation",U,G),!0)},this.handleFateLinkClick=O=>(this.telemetry.trackInteractionEvent(O),this.telemetry.trackEvent("ClientInst","FATELinkClicked"),!0)}get feedback(){var O;return __classPrivateFieldSet(this,rC,null!==(O=__classPrivateFieldGet(this,rC,"f"))&&void 0!==O?O:this.vmFactory.createFeedback(this.model,this.shouldRenderCopyOutside?void 0:this.copy,this.config.features.enableMessageExport?this.export:void 0),"f"),this.config.features.enableShareWholeThreadMockUp&&(__classPrivateFieldGet(this,rC,"f").setWholeThreadConversationId(this.conversation.id),__classPrivateFieldGet(this,rC,"f").enableShareWholeThread(!0),__classPrivateFieldGet(this,rC,"f").enableStandaloneShare(!0)),__classPrivateFieldGet(this,rC,"f")}get shouldRenderCopyOutside(){return!!this.config.features.enableOneClickCopy}get copy(){var O;return __classPrivateFieldSet(this,nC,null!==(O=__classPrivateFieldGet(this,nC,"f"))&&void 0!==O?O:this.vmFactory.createCopy(this.model),"f"),__classPrivateFieldGet(this,nC,"f")}get export(){var O;return __classPrivateFieldSet(this,oC,null!==(O=__classPrivateFieldGet(this,oC,"f"))&&void 0!==O?O:this.vmFactory.createExport([this.model]),"f"),__classPrivateFieldGet(this,oC,"f")}get shouldRenderFeedback(){return this.model.author===Yi.Bot&&this.reportable&&this.model.isFinalized}get inlineAds(){return this._inlineAdsViewModel}get text(){return this.model.text}get learnMoreText(){return this.config.strings.messageLearnMore}get fateOverrideTemplate(){return this._fateOverrideTemplate}get adaptiveCardTemplate(){return this._adaptiveCardTemplate}get displayMode(){return this._displayMode}get attributions(){return this._attributions}get feedbackPrompt(){return this.model.feedbackPrompt}get reportable(){return this.model.reportable}get modelMessageId(){return this.model.messageId}get modelRequestId(){return this.model.requestId}async openFeedbackForm(){return this.feedbackDialog.openFeedbackDialog()}onModelPropertyChanged(O){super.onModelPropertyChanged(O);let B;switch(O){case null:this.mapAttributionsFromModel(),this.isModelFinalized=this.model.isFinalized;case"text":this.updateDisplayMode(),null==B||B.trace(this,this.onModelPropertyChanged,`${null!=O?O:"init"}: '${this.model.text.slice(0,60)}'`).write();break;case"sourceAttributions":this.mapAttributionsFromModel(),this.isModelFinalized&&pt.notify(this,"isModelFinalized"),null==B||B.trace(this,this.onModelPropertyChanged,`${O}:`,this.model[O]).write();break;case"isFinalized":this.isModelFinalized=this.model.isFinalized,this.mapAttributionsFromModel(),null==B||B.trace(this,this.onModelPropertyChanged,`${O}: '${this.model[O]}'`).write();break;case"inlineAdsModel":null===this._inlineAdsViewModel&&this.model.inlineAdsModel&&(this._inlineAdsViewModel=this.vmFactory.createMessage(this.model.inlineAdsModel)),this.mapAttributionsFromModel(),null==B||B.trace(this,this.onModelPropertyChanged,`${O}:`,this.model[O]).write();break;case"contentOrigin":null==B||B.trace(this,this.onModelPropertyChanged,`${O}: '${this.model[O]}'`).write()}}get enableLongDocument(){return!!this.config.features.enableLongDocument}updateDisplayMode(){this._displayMode=this.getDisplayMode()}getDisplayMode(){let O=Ty.Text;return this.author===Yi.Bot&&(this.checkBotFatePolicy()?O=Ty.FateOverride:this.checkBotAdaptiveCards()&&(O=Ty.AdaptiveCard)),O}checkBotFatePolicy(){let O=!1;return this._fateOverrideTemplate=this.getFatePolicyCheckResult(),this._fateOverrideTemplate&&(O=!0),O}checkBotAdaptiveCards(){let O=!1;return this.model.adaptiveCards.length>0&&(this._adaptiveCardTemplate=this.renderAdaptiveCardToTemplate(),this._adaptiveCardTemplate&&(O=!0)),O}createAdaptiveCardViewTemplate(O){var B;let U;if(this.attributions.length>0){const G=O.lastElementChild;if((null==G?void 0:G.matches(".ac-textBlock"))&&(null===(B=G.previousElementSibling)||void 0===B?void 0:B.matches(".ac-horizontal-separator")))if(G.remove(),this.config.features.enableLearnMore){G.innerHTML=sC;U=createTemplate(O.outerHTML.split(sC),[])}else G.previousElementSibling.remove(),G.remove()}return null!=U||(U=new ViewTemplate(O.outerHTML,[])),U}checkAdSlugsEnabled(){return this.serp.isMobile?!0===this.config.features.enableAdSlugsMobile:!0===this.config.features.enableAdSlugsDesktop}renderAdaptiveCardToTemplate(){const O=this.cards.create(this.model.adaptiveCards[0]);if(!O)return null;O.removeAttribute("style");const B=this.telemetry.externalLinkId,{tooltip:U,citation:G}=this.classNames;return O.classList.contains("ac-container")&&O.removeAttribute("tabindex"),O.querySelectorAll("*").forEach(((O,q)=>{var j,W,Y;if("A"===O.nodeName){if("SUP"===(null===(j=O.firstChild)||void 0===j?void 0:j.nodeName)){if(!this.config.features.enableCitations)return void O.remove();if(O.firstChild.textContent){const j=O,K=`${this.messageId}-${q}`;if(this.citationGroupLinks.set(K,[j.href]),j.classList.add(G),j.setAttribute("data-citationid",K),j.setAttribute("aria-label",j.title),j.removeAttribute("title"),this.config.features.enableLongDocument&&-1!==j.href.indexOf("#sjevt")&&(j.removeAttribute("target"),j.setAttribute("target","_self")),"A"!==(null===(W=O.nextSibling)||void 0===W?void 0:W.nodeName)){const G=O;let j=G;const W=[j];let K=j.previousSibling;const Q=[G.href],Z=`${this.messageId}-${q}-group`;for(this.citationGroupLinks.set(Z,Q);"A"===(null==K?void 0:K.nodeName);){j=K,K=j.previousSibling;const O=j;Q.unshift(O.href),W.unshift(j)}if(this.checkAdSlugsEnabled()&&(null===(Y=this.groupAdModels.get(Z))||void 0===Y?void 0:Y.isContentLoaded)){const O=document.createElement("sup");O.textContent="Ad",O.setAttribute("style","margin: 0px 2px; padding: 0px 3px;"),Q[0]===this.firstAttributionLink?(O.setAttribute("class","ad-first"),W.unshift(O)):!0===this.config.features.enableAdSlugsAtEndOfGroup&&(O.setAttribute("class","ad-last"),W.push(O))}for(;!this.isCitationContextStart(K);)j=K,K=j.previousSibling,W.unshift(j);const X=document.createElement("a");if(this.config.features.enableCitations&&(X.classList.add(U),X.setAttribute("data-citationid",Z),!this.serp.isMobile&&Q.length&&B&&X.setAttribute("h",B)),(null==K?void 0:K.nodeType)===Node.TEXT_NODE&&K.textContent){const O=K.textContent.match(/([\.!?] )/);if(O){const B=O[0],U=K.textContent.split(B);if(U&&Array.isArray(U))for(;U.length>0;){const O=U.pop();if(O.trim()){X.appendChild(document.createTextNode(O));break}}K.textContent=U.length?`${U.join(B)}${B}`:`${U.join(B)}`}}for(const O of W)O===G&&O.replaceWith(X),X.appendChild(O)}}}B&&O.setAttribute("h",B)}"CODE"!==O.tagName&&O.removeAttribute("style"),this.config.features.enableShareInlineAdsIframe&&this.isShared||"IMG"!==O.nodeName||O.remove()})),this.createAdaptiveCardViewTemplate(O)}isCitationContextStart(O){return!O||(["A","P","DIV","SPAN"].includes(O.nodeName)||O.nodeType===Node.TEXT_NODE&&/[\.!?] /.test(O.textContent))}mapAttributionsFromModel(){if(!this.model.feedbackPrompt){this._attributions=[];for(let O=0;O<this.model.sourceAttributions.length;O++){const B=this.model.sourceAttributions[O];let U;B.seeMoreUrl?U=this.createUrlAttributionLink(B,O):this.config.features.enableLongDocument&&B.highlightText&&(U=this.createDocumentAttributionLink(B,O)),U&&this._attributions.push(U)}this.enableHoverCitations()}}createUrlAttributionLink(O,B){const U=new URL(O.seeMoreUrl),G=`${B+1}`,q=`${G}. ${this.getDisplayDomain(U)}`,j=this.createAttributionLink(O,G,O.providerDisplayName,q,U.href);return 0===B&&(this.firstAttributionLink=j.link),j}createDocumentAttributionLink(O,B){const U=`${B+1}`;let G=`${U}`;"pdf"===O.pageType&&(G=`${U}. Page ${O.pageIndex} - Line ${O.lineIndex}`);const q=this.truncateWithEllipsis(O.providerDisplayName,23),j=this.createAttributionLink(O,U,q,G);return j.handleLinkClick=this.handleDocumentLinkClick,j}createAttributionLink(O,B,U,G,q=""){return{id:CoreUtils.uuid(),handleLinkClick:this.handleLinkClick,number:B,title:U,sourceCaption:G,link:q,searchQuery:O.searchQuery,description:O.snippets,favIcon:O.imageFavicon||"",imageHeight:isNaN(Number(O.imageHeight))?0:parseInt(O.imageHeight),imageWidth:isNaN(Number(O.imageWidth))?0:parseInt(O.imageWidth),imageLink:O.imageLink||"",h:this.telemetry.externalLinkId,pageIndex:O.pageIndex,highlightText:O.highlightText,relatedPageUrl:O.relatedPageUrl}}enableHoverCitations(){var O,B;if(this.config.features.enableCitations&&this.isModelFinalized){null===(O=this.log)||void 0===O||O.trace(this,this.enableHoverCitations,null).write();for(const O of this.citationGroupLinks.keys()){const U=[];if(null===(B=this.citationGroupLinks.get(O))||void 0===B||B.forEach((O=>{const B=this.attributions.find((B=>B.link===O));B&&U.push(B)})),U.length){const B=this.createCitationGroup(O,U);if(this.hoverCard.registerCitationGroup(B),this.checkAdSlugsEnabled()&&B.advertModel&&(this.groupAdModels.set(O,B.advertModel),!this.loadingAdModels.has(B.advertModel))){this.loadingAdModels.add(B.advertModel);const O=B.advertModel.onContentLoaded((()=>{O.dispose(),this.updateDisplayMode()}))}}}}}createCitationGroup(O,B){var U;const G=B;G.uuid=O;let q=!0;return this.config.features.enableAds?this.isShared&&!this.config.features.enableSharedAds?q=!1:O.endsWith(aC)||(q=!1):q=!1,q&&(G.useAdClickout=B[0]===this.attributions[0],G.advertQuery=null!==(U=B[0].searchQuery)&&void 0!==U?U:null),G}getDisplayDomain(O){return this.subdomainToRemove.reduce(((O,B)=>(B+=".",O.startsWith(B)?O.replace(B,""):O)),O.hostname)}get fateLink(){var O;return null!==(O=this._fateLink)&&void 0!==O||(this._fateLink={id:"",number:"-1",handleLinkClick:this.handleFateLinkClick,title:"Bing",sourceCaption:"Bing",link:this.config.bing.baseUrl}),this._fateLink}getFatePolicyCheckResult(){const O="@failover_hyperlink";let B=null;if(this.model.text.includes(O)){const U=this.model.text.replace(O,"`-1#5#9#5#1-`");B=createTemplate(this.cards.renderMarkdownToHtml(U).split(sC),[lC])}return B}truncateWithEllipsis(O,B){return O.length>B?O.slice(0,B-"...".length)+"...":O}};var dC;rC=new WeakMap,nC=new WeakMap,oC=new WeakMap,__decorate([observable,__metadata("design:type",Object)],cC.prototype,"_inlineAdsViewModel",void 0),__decorate([observable,__metadata("design:type",Object)],cC.prototype,"_fateOverrideTemplate",void 0),__decorate([observable,__metadata("design:type",Object)],cC.prototype,"_adaptiveCardTemplate",void 0),__decorate([observable,__metadata("design:type",Number)],cC.prototype,"_displayMode",void 0),__decorate([observable,__metadata("design:type",Array)],cC.prototype,"_attributions",void 0),cC=__decorate([__param(0,Dm),__param(1,ql),__param(2,qy),__param(3,Dc),__param(4,Wy),__param(5,tC),__param(6,aS),__param(7,Vt),__param(8,gh),__param(9,Dh),__param(10,$c),__param(11,qc),__param(12,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],cC);let pC=class extends MessageViewModelBase{constructor(O,B,U,G,q,j){super(O,B,G,q,j),this.vmFactory=U,dC.set(this,null),this._htmlString=""}get feedback(){var O;return __classPrivateFieldSet(this,dC,null!==(O=__classPrivateFieldGet(this,dC,"f"))&&void 0!==O?O:this.vmFactory.create(Iy),"f"),__classPrivateFieldGet(this,dC,"f").initialize(this.model),__classPrivateFieldGet(this,dC,"f")}get htmlString(){return this._htmlString}onModelPropertyChanged(O){switch(super.onModelPropertyChanged(O),O){case null:case"text":this._htmlString=this.model.text}}};var uC;dC=new WeakMap,__decorate([observable,__metadata("design:type",String)],pC.prototype,"_htmlString",void 0),pC=__decorate([__param(0,ql),__param(1,qy),__param(2,Vt),__param(3,gh),__param(4,$c),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],pC);let hC=class extends MessageViewModelBase{constructor(O,B,U,G,q,j){super(O,B,G,q,j),this.vmFactory=U,uC.set(this,null),this._htmlString=""}get feedback(){var O;return __classPrivateFieldSet(this,uC,null!==(O=__classPrivateFieldGet(this,uC,"f"))&&void 0!==O?O:this.vmFactory.create(Iy),"f"),__classPrivateFieldGet(this,uC,"f").initialize(this.model),__classPrivateFieldGet(this,uC,"f")}get htmlString(){return this._htmlString}onModelPropertyChanged(O){switch(super.onModelPropertyChanged(O),O){case null:case"text":this._htmlString=this.model.text}}};var mC;uC=new WeakMap,__decorate([observable,__metadata("design:type",String)],hC.prototype,"_htmlString",void 0),hC=__decorate([__param(0,ql),__param(1,qy),__param(2,Vt),__param(3,gh),__param(4,$c),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],hC);let gC=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y,K){super(O,B,U,K),this.conversation=G,this.manager=q,this.config=j,this.errorState=W,this.eventBus=Y,this.strings={description:this.config.strings.toneSelectorDescription,preview:this.config.strings.preview,notificationResetConversationCta:this.config.strings.notificationResetConversationCta},mC.set(this,this._register(new Emitter)),this._toneOptions=[],this.handleSystemCommand=O=>{if(this.config.features.enableThreads&&O.type===Hh.SetResponseTone)O.data&&(this.tone=O.data)},this.eventBus.onSystemCommand(this.handleSystemCommand)}get isToneButtonDisabled(){return this.config.bingAtWork.isEnabled||!this.isVisible}get isEnabled(){return!0===this.config.features.enableResponseToneSelector&&void 0!==this.config.sydney.responseToneOptions&&this.config.sydney.responseToneOptions.length>1}get isDisabled(){return this.errorState.chatErrorState===Gc.MuidUserConsentNotGiven}get isVisible(){const{turnCount:O}=this.conversation;return!this.isDisabled&&(this.config.features.enablePersistentResponseToneSelector||O<2)}get isPreviewEnabled(){return!this.config.features.enableThreads}get tone(){return this._tone}set tone(O){var B;this._tone!==O&&(this._tone=O,null===(B=this.log)||void 0===B||B.trace(this,this.tone,`ResponseTone set to: ${this._tone}`).write(),this.conversation.turnCount>0&&!this.config.partner.disableToneConversationReset&&this.manager.resetConversation(O),this.config.features.enableResponseToneColorThemes&&this.isEnabled&&(db.responseMode=O),this.config.features.enableTonePerf&&this.eventBus.sendSystemEvent(Xd.ResponseToneChanged,this._tone),__classPrivateFieldGet(this,mC,"f").fire(this._tone))}get toneOptions(){if(0===this._toneOptions.length){const O=this.config.sydney.responseToneOptions;if(O&&O.length>0)for(let B=0;B<O.length;B++){const U=O[B],{label:G,labelModifier:q,tooltip:j}=this.getToneStrings(U);this._toneOptions.push({tone:U,label:G,labelModifier:q,tooltip:j})}}return this._toneOptions}getToneStrings(O){let B="",U="",G="";switch(O){case sr.Balanced:B=this.config.strings.toneSelectorBalanced,U=this.config.strings.toneSelectorBalancedModifier,G=this.config.strings.toneSelectorBalancedTooltip;break;case sr.Creative:B=this.config.strings.toneSelectorCreative,U=this.config.strings.toneSelectorCreativeModifier,G=this.config.strings.toneSelectorCreativeTooltip;break;case sr.Precise:B=this.config.strings.toneSelectorPrecise,U=this.config.strings.toneSelectorPreciseModifier,G=this.config.strings.toneSelectorPreciseTooltip}return{label:B,labelModifier:U,tooltip:G}}get onToneChanged(){return __classPrivateFieldGet(this,mC,"f").event}};var fC,yC,_C;mC=new WeakMap,__decorate([observable,__metadata("design:type",String)],gC.prototype,"_tone",void 0),__decorate([observable,__metadata("design:type",Array)],gC.prototype,"_toneOptions",void 0),gC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,Yy),__param(4,uh),__param(5,ql),__param(6,Uc),__param(7,Zd),__param(8,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object])],gC);let vC=class extends ViewModelBase{constructor(O,B,U,G,q,j,W){super(O,B,U,W),this.config=G,this.eventBus=q,this.factory=j,fC.set(this,null),yC.set(this,void 0),_C.set(this,void 0),this.handleSystemEvent=O=>{if(O.type===Xd.InvalidSessionRecovered)this.isCurrent&&(this.notificationText=this.config.strings.notificationInvalidSessionRecovered)},__classPrivateFieldSet(this,yC,this.createMessageGroup(Yi.User),"f"),__classPrivateFieldSet(this,_C,this.createMessageGroup(Yi.Bot),"f"),this.eventBus.onSystemEvent(this.handleSystemEvent)}get bot(){return __classPrivateFieldGet(this,_C,"f")}get user(){return __classPrivateFieldGet(this,yC,"f")}get isExpanded(){return this.bot.isExpanded||this.user.isExpanded}get conversation(){if(null===__classPrivateFieldGet(this,fC,"f"))throw new Error("TurnViewModel has not been initialized.");return __classPrivateFieldGet(this,fC,"f")}get isCurrent(){return this.conversation.current===this}addTurnMessage(O){var B;switch(null===(B=this.log)||void 0===B||B.trace(this,this.addTurnMessage,"turn add message:",O.messageId).write(),O.author){case Yi.Bot:this.bot.addGroupMessage(O);break;case Yi.User:this.user.addGroupMessage(O);break;default:throw new Error(`Unsupported author: '${O.author}'`)}}get lastMessage(){let O=null;return this.user.messages.length>0&&(O=this.user.messages[this.user.messages.length-1]),this.bot.messages.length>0&&(O=this.bot.messages[this.bot.messages.length-1]),O}initialize(O){__classPrivateFieldSet(this,fC,O,"f")}resetMessages(O){switch(O){case Yi.Bot:__classPrivateFieldGet(this,_C,"f").resetMessages();break;case Yi.User:__classPrivateFieldGet(this,yC,"f").resetMessages();break;default:throw new Error(`Unsupported author: '${O}'`)}}createMessageGroup(O){const B=this.factory.create(Jb);return B.initialize(this,O),B}};fC=new WeakMap,yC=new WeakMap,_C=new WeakMap,__decorate([observable,__metadata("design:type",String)],vC.prototype,"notificationText",void 0),vC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Zd),__param(5,Vt),__param(6,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],vC);let bC=class extends ViewModelBase{constructor(O,B,U,G,q,j,W){var Y;super(O,B,U,W),this.config=G,this.model=q,this.conversation=j,this.strings={of:this.config.strings.of},this.currentTurnIndex=this.model.messages[0].author===Yi.Bot?this.conversation.turnCount-1:this.conversation.turnCount,this.maxTurnLength=null!==(Y=this.config.messaging.maxTurnsPerConversation)&&void 0!==Y?Y:void 0}getTurnCounterState(){return this.maxTurnLength?this.currentTurnIndex===this.maxTurnLength?iC.Red:this.currentTurnIndex>this.maxTurnLength/2?iC.Amber:iC.Green:iC.Green}resetCurrentTurnIndex(){this.currentTurnIndex=0}};__decorate([observable,__metadata("design:type",Object)],bC.prototype,"strings",void 0),bC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Dc),__param(5,Yy),__param(6,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],bC);let SC=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y){var K;super(O,B,U,Y),this.config=G,this.chat=q,this.speech=j,this.conversation=W,this.strings={stopStreamingAriaLabel:this.config.strings.typingIndicatorStopStreamingAriaLabel,stopRespondingAriaLabel:this.config.strings.typingIndicatorStopRespondingAriaLabel,stop:this.config.strings.stop,canceling:this.config.strings.canceling},this.enableStreamStop=null===(K=!!this.config.features.enableStopButton)||void 0===K||K,this.isEnabled=!0,this.handlePendingRequestStateChanged=O=>{var B;null===(B=this.log)||void 0===B||B.trace(this,this.handlePendingRequestStateChanged,"isRequestPending:",O).write(),O&&(this.isEnabled=!0)},this._register(this.chat.onPendingRequestStateChanged(this.handlePendingRequestStateChanged))}get text(){return this.isEnabled?this.strings.stopRespondingAriaLabel:this.strings.canceling}get isVisible(){return this.chat.isRequestPending}cancelPendingRequest(){var O;null===(O=this.log)||void 0===O||O.trace(this,this.cancelPendingRequest,"Cancelling requests from both text and speech.").write(),this.chat.cancelPendingRequest(),this.speech.cancelPendingRequest(),this.isEnabled=!1}};var CC;__decorate([observable,__metadata("design:type",Object)],SC.prototype,"strings",void 0),__decorate([observable,__metadata("design:type",Boolean)],SC.prototype,"enableStreamStop",void 0),__decorate([observable,__metadata("design:type",Boolean)],SC.prototype,"isEnabled",void 0),SC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Mc),__param(5,Fc),__param(6,Yy),__param(7,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object])],SC);let EC=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(G,U,j),this.config=O,this.feedbackForm=B,this.errorState=q,CC.set(this,this._register(new Emitter)),this._showWelcomeScreen=void 0===this.config.partner.disableWelcomeContainer?!!this.config.features.enableWelcomeScreen:!this.config.partner.disableWelcomeContainer,this.config.features.enableCodexMuidConsent&&!this.config.sydney.muidUserConsentGiven&&this.errorState.setChatErrorState(Gc.MuidUserConsentNotGiven)}get onConsentGivenInvoked(){return __classPrivateFieldGet(this,CC,"f").event}get learnSegment1(){return this.config.strings.welcomeLearnSegment1}get learnSegment2(){return this.config.strings.welcomeLearnSegment3}get termsAndCondSeg1(){return this.config.strings.muidUsersTermsCond1.replace("{0}",this.config.strings.muidUserGetStartedText)}get termsAndCondSeg2(){return this.config.strings.muidUsersTermsCond2}get getStartedText(){return this.config.strings.muidUserGetStartedText}get learnSegment3(){return this.config.strings.welcomeLearnSegment2}get bingAtWorkEnabled(){return this.config.bingAtWork.isEnabled}get messageItems(){return[{header:this.config.strings.welcomeMessageItemTitle1,body:this.config.strings.welcomeMessageItemContent1,isClickable:!0},{header:this.config.strings.welcomeMessageItemTitle2,body:this.config.strings.welcomeMessageItemContent2,isClickable:!0},{header:this.config.bingAtWork.isEnabled?this.config.strings.welcomeMessageItemTitle3:this.config.strings.discoverMessageItemTitle,body:this.config.bingAtWork.isEnabled?this.config.strings.welcomeMessageItemContent3:this.config.strings.discoverMessageItemContent,isClickable:!!this.config.bingAtWork.isEnabled}]}openFeedbackForm(){this.feedbackForm.openFeedbackForm()}get privacyStatementLink(){return{title:this.config.strings.welcomeContainerPrivacyStatement,url:this.config.links.privacyStatement}}get showWelcomeScreen(){return this._showWelcomeScreen}get subTitleText(){return this.config.strings.welcomeSubtitleText}get titleText(){return this.config.strings.warmWelcomeTitle}get tertiaryTitleText(){return this.config.strings.welcomeTertiaryTitleText}get termsOfUseLink(){return{title:this.config.strings.welcomeContainerUseTerms,url:this.config.links.termsOfUse}}getSuggestions(){return[{contentOrigin:Ki.DeepLeo,messageType:tr.Suggestion,offense:nr.Unknown,text:this.config.strings.welcomeMobSugg1,messageId:"",hiddenText:void 0},{contentOrigin:Ki.DeepLeo,messageType:tr.Suggestion,offense:nr.Unknown,text:this.config.strings.welcomeMobSugg2,messageId:"",hiddenText:void 0},{contentOrigin:Ki.DeepLeo,messageType:tr.Suggestion,offense:nr.Unknown,text:this.config.strings.welcomeMobSugg3,messageId:"",hiddenText:void 0}]}toggleWelcomeScreen(O){return this._showWelcomeScreen=O,this._showWelcomeScreen}provideConsent(){this.errorState.setChatErrorState(),__classPrivateFieldGet(this,CC,"f").fire()}get isMuidConsentUngranted(){return this.errorState.chatErrorState===Gc.MuidUserConsentNotGiven}};var xC;CC=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],EC.prototype,"_showWelcomeScreen",void 0),EC=__decorate([__param(0,ql),__param(1,lh),__param(2,gh),__param(3,qy),__param(4,Uc),__param(5,$c),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],EC);let TC=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y){super(O,B,U,Y),this.conversation=G,this.manager=q,this.config=j,this.toneSelector=W,this.strings={description:this.config.strings.workToggleDescription,label:this.config.strings.workToggleLabel},xC.set(this,this._register(new Emitter)),this._isWorkIncluded=!0}get isEnabled(){return!0===this.config.bingAtWork.isWorkToggleEnabled}get isVisible(){return this.toneSelector.isVisible}get isWorkIncluded(){return this._isWorkIncluded}set isWorkIncluded(O){var B;this._isWorkIncluded!==O&&(this._isWorkIncluded=O,null===(B=this.log)||void 0===B||B.trace(this,"set isWorkIncluded",`isWorkIncluded set to: ${this._isWorkIncluded}`).write(),this.conversation.turnCount>0&&this.manager.resetConversation(),__classPrivateFieldGet(this,xC,"f").fire(this._isWorkIncluded))}get onWorkToggleChanged(){return __classPrivateFieldGet(this,xC,"f").event}};xC=new WeakMap,__decorate([observable,__metadata("design:type",Boolean)],TC.prototype,"_isWorkIncluded",void 0),TC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,Yy),__param(4,uh),__param(5,ql),__param(6,vb),__param(7,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object])],TC);let wC=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(O,B,U,j),this.config=G,this.captchaService=q,this.isVisible=!1,this.isInputValid=!0,this.userInput="",this.captchaImgSrc="",this.userInputRegex=/^[0-9a-zA-Z]{4,}$/,this.strings={captchaTitle:this.config.strings.captchaTitle,captchaDescription:this.config.strings.captchaDescription,captchaPlaceholder:this.config.strings.captchaPlaceholder,captchaPlaceholderError:this.config.strings.captchaPlaceholderError,captchaImgAlt:this.config.strings.captchaImgAlt,captchaRefreshBtnAriaLabel:this.config.strings.captchaRefreshBtnAriaLabel,next:this.config.strings.next,cancel:this.config.strings.cancel},this.handleCaptchaChallengeRequested=O=>{this.telemetry.trackEvent("SystemEvent","CaptchaCreated"),this.captchaImgSrc=O,this.isVisible=!0},this.captchaService.onCaptchaChallengeRequested(this.handleCaptchaChallengeRequested)}async refreshCaptchaAsync(){var O;try{this.isInputValid=!0,""!==this.userInput&&(this.userInput=""),await this.captchaService.startCaptchaChallengeAsync(),this.telemetry.trackEvent("SystemEvent","CaptchaRefreshedSuccess")}catch(B){null===(O=this.log)||void 0===O||O.error(this,this.refreshCaptchaAsync,B instanceof Error?B.message:"undefined").write(),this.telemetry.trackEvent("SystemEvent","CaptchaRefreshedFailure",{CustomData:JSON.stringify({err:B instanceof Error?B.message.slice(0,128):"undefined"})})}}async submitCaptchaAsync(O){var B;try{if(!O.match(this.userInputRegex))return this.isInputValid=!1,void(this.userInput="");const B=await this.captchaService.submitCaptchaAsync(this.userInput);this.userInput="",B?(this.isVisible=!1,this.telemetry.trackEvent("SystemEvent","CaptchaSolved")):(this.telemetry.trackEvent("SystemEvent","CaptchaUnsolved"),await this.refreshCaptchaAsync())}catch(O){null===(B=this.log)||void 0===B||B.error(this,this.submitCaptchaAsync,O instanceof Error?O.message:"undefined").write(),this.telemetry.trackEvent("SystemEvent","CaptchaSubmitError",{CustomData:JSON.stringify({err:O instanceof Error?O.message.slice(0,128):"undefined"})})}}cancelCaptcha(){this.telemetry.trackEvent("InteractionEvent","CaptchaCancelled"),this.serp.changeMode(Hy.getDefault()),this.captchaService.cancelCaptchaChallenge()}};__decorate([observable,__metadata("design:type",Boolean)],wC.prototype,"isVisible",void 0),__decorate([observable,__metadata("design:type",Boolean)],wC.prototype,"isInputValid",void 0),__decorate([observable,__metadata("design:type",String)],wC.prototype,"userInput",void 0),__decorate([observable,__metadata("design:type",String)],wC.prototype,"captchaImgSrc",void 0),wC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,ei),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],wC);const kC=kt.createInterface("IDeleteConversationViewModel");var AC;(function(O){O[O.Idle=0]="Idle",O[O.Deleting=1]="Deleting",O[O.DeleteFailed=2]="DeleteFailed",O[O.Deleted=3]="Deleted"})(AC||(AC={}));const RC=kt.createInterface("IEditThreadViewModel");var IC,PC,NC,OC;(function(O){O[O.Idle=0]="Idle",O[O.Editing=1]="Editing",O[O.EditSuccess=2]="EditSuccess",O[O.Error=3]="Error"})(IC||(IC={}));let MC=class extends ViewModelBase{constructor(O,B,U,G,q,j,W,Y,K,Q,Z,X,J){super(O,B,U,J),this.config=G,this.manager=q,this.factory=j,this.chat=W,this.notification=Y,this.edit=K,this.deleteConversation=Q,this.eventBus=Z,this.conversation=X,this.name="",this.isActive=!1,this.strings={edit:this.config.strings.threadsEdit,delete:this.config.strings.threadsDelete,confirm:this.config.strings.threadsConfirm,cancel:this.config.strings.threadsCancel,more:this.config.strings.more,load:this.config.strings.threadsLoad},this.model=null,PC.set(this,void 0),NC.set(this,void 0),OC.set(this,void 0),this._onThreadLoadedEmitter=this._register(new Emitter),this.defaultThreadID="defaultThread"}get isEditing(){return this.edit.isEditing}get isContextMenuEnabled(){return!!this.config.features.enableThreadContextMenu}initialize(O){var B,U;this.model=O,this.name=null!==(B=O.threadData.chatName)&&void 0!==B?B:"",__classPrivateFieldSet(this,PC,null!==(U=__classPrivateFieldGet(this,PC,"f"))&&void 0!==U?U:this.factory.createThreadContextMenu(this.model),"f"),this.config.features.enableThreadShareLandingPage&&O.threadData instanceof SharedThreadData&&this.sendSharedTip()}get contextMenuVm(){return __classPrivateFieldGet(this,PC,"f")}set contextMenuVm(O){__classPrivateFieldSet(this,PC,O,"f")}get historyConversationVm(){return __classPrivateFieldGet(this,OC,"f")}set historyConversationVm(O){__classPrivateFieldSet(this,OC,O,"f"),this.contextMenuVm&&(this.contextMenuVm.historyConversationVm=O)}get sidePanelVm(){return __classPrivateFieldGet(this,NC,"f")}set sidePanelVm(O){__classPrivateFieldSet(this,NC,O,"f"),this.contextMenuVm&&(this.contextMenuVm.sidePanelVm=O)}get displayTime(){var O;let B=this.getDisplayTime();return(null===(O=this.model)||void 0===O?void 0:O.threadData)instanceof SharedThreadData&&(B=this.config.strings.threadsSharedOnDate.replace("{0}",B)),B}async deleteConversationAsync(){var O,B,U;const G=null===(O=this.model)||void 0===O?void 0:O.id;G?(await this.deleteConversation.deleteConversationAsync([G]),null===(B=this.model)||void 0===B||B.remove()):null===(U=this.log)||void 0===U||U.error(this,this.deleteConversationAsync,`ConversationId is required to perform a delete operation ConvId: ${G}`).write()}async deleteSingleConversationAsync(){var O,B,U,G,q;(null===(O=this.model)||void 0===O?void 0:O.id)&&(null===(B=this.model)||void 0===B?void 0:B.threadData)?(await this.deleteConversation.deleteSingleConversationAsync(this.model.threadData),null===(U=this.model)||void 0===U||U.remove()):null===(G=this.log)||void 0===G||G.error(this,this.deleteSingleConversationAsync,`ConversationId is required to perform a delete operation ConvId: ${null===(q=this.model)||void 0===q?void 0:q.id}`).write()}beginEdit(){this.edit.edit(this.name)}cancelEdit(){this.name=this.edit.cancel()}async confirmEditAsync(O){var B,U,G;(null===(B=this.model)||void 0===B?void 0:B.threadData)?(await this.edit.saveAsync(this.model.threadData,O),this.name=O,(null===(G=this.model)||void 0===G?void 0:G.threadData.chatName)&&(this.model.threadData.chatName=O)):null===(U=this.log)||void 0===U||U.error(this,this.confirmEditAsync,"Thread data is not available").write()}async loadThreadAsync(){var O,B,U,G,q,j;this.isEditing||this.conversation.id===(null===(O=this.model)||void 0===O?void 0:O.id)||(null===(B=this.model)||void 0===B?void 0:B.id)===this.defaultThreadID||(null===(U=this.model)||void 0===U?void 0:U.id)&&(this.manager.fireConversationLoadStart(),sr[this.model.threadData.tone]&&this.eventBus.sendSystemCommand(Hh.SetResponseTone,sr[this.model.threadData.tone]),this.manager.resetConversation(void 0,!1),this.conversation.updateId(this.model.id,new Date(this.model.threadData.expiryTimeUtc),void 0,this.model.threadData.conversationSignature),this._onThreadLoadedEmitter.fire(),this.model.threadData instanceof SharedThreadData?(await this.chat.loadSharedMessagesAsync(null===(G=this.model)||void 0===G?void 0:G.id),this.sendSharedTip()):await this.chat.loadConversationAsync(null===(q=this.model)||void 0===q?void 0:q.id),this.manager.fireConversationLoadEnd(),this.telemetry.trackEvent("InteractionEvent","LoadThread",{Namespace:"Thread",CustomData:JSON.stringify({convId:null===(j=this.model)||void 0===j?void 0:j.id})}))}onThreadLoad(O){return this._onThreadLoadedEmitter.event(O)}sendSharedTip(){this.notification.sendBottomBarNotification({type:this.serp.isMobile?vh.StackedInline:vh.Inline,icon:this.serp.isMobile?bh.Information:void 0,innerHTML:this.config.strings.notificationSharedTip.replace("{0}",this.name).replace("{1}",this.getDisplayTime()).replace("&lt;strong&gt;","<strong>").replace("&lt;/strong&gt;","</strong>")})}getDisplayTime(){var O;if(!(null===(O=this.model)||void 0===O?void 0:O.threadData.createTimeUtc))return"";const B=864e5,U=new Date(this.model.threadData.createTimeUtc),G=new Date;G.setHours(0),G.setMinutes(0),G.setSeconds(0),G.setMilliseconds(0);const q=G.getTime()-U.getTime();if(q<0)return U.toLocaleTimeString("default",{hour:"numeric",minute:"2-digit",hour12:!0});if(q<B)return this.config.strings.threadsYesterday;if(q<5*B){const O=Math.ceil(q/B);return this.config.strings.threadsDaysAgo.replace("{0}",O.toString())}return U.toLocaleDateString("default",{month:"short",day:"numeric",year:"numeric"})}};PC=new WeakMap,NC=new WeakMap,OC=new WeakMap,__decorate([observable,__metadata("design:type",String)],MC.prototype,"name",void 0),__decorate([observable,__metadata("design:type",Boolean)],MC.prototype,"isActive",void 0),MC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,uh),__param(5,Vt),__param(6,Mc),__param(7,_h),__param(8,RC),__param(9,kC),__param(10,Zd),__param(11,Dc),__param(12,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],MC);let DC=class extends ViewModelBase{constructor(O,B,U,G){super(O,B,U),this.config=G,this.plugins=[],this.initializePlugins()}addOptionSet(O){this.config.sydney.request.optionsSets.includes(O)||this.config.sydney.request.optionsSets.push(O)}removeOptionSet(O){const B=this.config.sydney.request.optionsSets.indexOf(O);B>-1&&this.config.sydney.request.optionsSets.splice(B,1)}initializePlugins(){this.plugins.push({name:"OpenTable",iconUrl:"https://bing.com/th?id=OSK.6D0626EFCDF6674FFC03047CDAA44120",label:"OpenTable",enabled:!0,isToggleVisible:!0,isToggleDisabled:!1,optionSet:"opentable"}),this.plugins.push({name:"WolframAlpha",iconUrl:"https://bing.com/th?id=OSK.A35F4E5E62E5141616F86714414C41EE",label:"Wolfram Alpha",enabled:!0,isToggleVisible:!0,isToggleDisabled:!1,optionSet:"calcwolfram"}),this.plugins.push({name:"MathSolver",iconUrl:"https://bing.com/th?id=OSK.E1D5F4A8008F66C59A05675A278AE410",label:"Math Solver",enabled:!1,isToggleVisible:!0,isToggleDisabled:!0,optionSet:"mathsolver"}),this.plugins.forEach((O=>{this.config.features.enableFlux3P&&this.config.sydney.request.optionsSets.includes("flux")&&O.enabled&&!this.config.sydney.request.optionsSets.includes(O.optionSet)&&this.config.sydney.request.optionsSets.push(O.optionSet)}))}};DC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__metadata("design:paramtypes",[Object,Object,Object,Object])],DC);let LC=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(O,B,U,j),this.config=G,this.service=q,this._editState=IC.Idle,this.delay=1e3,this._name="",this._previousName=""}get editState(){return this._editState}get isEditing(){return this._editState===IC.Editing}get name(){return this._name}get previousName(){return this._previousName}edit(O){this.instrumentThreadStartEdit(),this._editState=IC.Editing,this._previousName=O}cancel(){return this.instrumentThreadCancelEdit(),this._editState=IC.Idle,this._previousName}async saveAsync(O,B){var U;try{const U={...O,chatName:B};await this.service.saveEdits(U),this.instrumentThreadSave(),this._editState=IC.EditSuccess}catch(O){this.instrumentThreadSaveError(),null===(U=this.log)||void 0===U||U.error(this,this.saveAsync,`Error saving edits: ${O}`).write(),this._editState=IC.Error}finally{this.resetWithDelay()}}instrumentThreadSave(){this.telemetry.trackEvent("InteractionEvent","RenameChatSuccess",{Namespace:"Thread"})}instrumentThreadSaveError(){this.telemetry.trackEvent("InteractionEvent","FailedToSaveRenameChat",{Namespace:"Thread"})}instrumentThreadStartEdit(){this.telemetry.trackEvent("InteractionEvent","ThreadStartEdit",{Namespace:"Thread"})}instrumentThreadCancelEdit(){this.telemetry.trackEvent("InteractionEvent","ThreadCancelEdit",{Namespace:"Thread"})}resetWithDelay(){setTimeout((()=>{this._editState=IC.Idle}),this.delay)}};__decorate([observable,__metadata("design:type",Number)],LC.prototype,"_editState",void 0),LC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Sh),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],LC);let BC=class extends ViewModelBase{constructor(O,B,U,G,q,j,W){super(O,B,j,W),this.config=U,this.service=G,this.conversationModel=q,this._getChatsState=HS.Idle,this.delay=1e3}async getChats(){var O;try{if(this._getChatsState===HS.Idle){this._getChatsState=HS.InProgress;const O=await this.service.getChats();if(this.instrumentGetChatsSuccess(),this.isGetChatsResponse(O))return this._getChatsState=HS.Succeeded,this.conversationModel.setClientId(O.clientId),O.chats;throw this._getChatsState=HS.Failed,new Error("Error fetching chats")}throw this._getChatsState=HS.Failed,new Error("Error fetching chats - Task to fetch chats is already in progress.")}catch(B){throw null===(O=this.log)||void 0===O||O.error(this,this.getChats,`Error fetching chats: ${B}`).write(),this.instrumentGetChatsFailed(),this._getChatsState=HS.Failed,new Error("Error fetching chats")}finally{this.resetWithDelay()}}isGetChatsResponse(O){return!(!O||!(null==O?void 0:O.chats))}resetWithDelay(){setTimeout((()=>this._getChatsState=HS.Idle),this.delay)}instrumentGetChatsSuccess(){this.telemetry.trackEvent("InteractionEvent","GetChatsSuccess",{Namespace:"Thread",CustomData:JSON.stringify({userId:this.conversationModel.clientId})})}instrumentGetChatsFailed(){this.telemetry.trackEvent("InteractionEvent","GetChatsFailed",{Namespace:"Thread",CustomData:JSON.stringify({userId:this.conversationModel.clientId})})}};__decorate([observable,__metadata("design:type",Number)],BC.prototype,"_getChatsState",void 0),BC=__decorate([__param(0,qy),__param(1,gh),__param(2,ql),__param(3,Th),__param(4,Dc),__param(5,$c),__param(6,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],BC);let FC=class extends ViewModelBase{constructor(O,B,U,G,q,j){super(O,B,U,j),this.config=G,this.service=q,this._deleteState=AC.Idle,this.delay=1e3}get deleteState(){return this._deleteState}async deleteConversationAsync(O){return this.deleteAsync(O)}deleteSingleConversationAsync(O){return this.deleteSingleAsync(O)}async deleteSingleAsync(O){var B,U,G,q;if(this.deleteState===AC.Idle){this._deleteState=AC.Deleting;try{null===(U=this.log)||void 0===U||U.trace(this,this.deleteConversationAsync,"Requesting to delete a conversation").write(),await this.service.deleteSingleConversationAsync(O),this.instrumentSingleDeleteConversationSuccess(O.conversationId),null===(G=this.log)||void 0===G||G.trace(this,this.deleteConversationAsync,"Delete succeeded."),this._deleteState=AC.Deleted,this.resetWithDelay()}catch(B){this.instrumentSingleDeleteConversationFailure(O.conversationId),this._deleteState=AC.DeleteFailed,this.resetWithDelay(),null===(q=this.log)||void 0===q||q.error(this,this.deleteConversationAsync,`Error deleting conversation: ${B}`).write()}}else null===(B=this.log)||void 0===B||B.error(this,this.deleteAsync,"Error deleting conversation: Delete is already in progress.").write()}async deleteAsync(O){var B,U,G,q;if(this.deleteState===AC.Idle){this._deleteState=AC.Deleting;try{null===(U=this.log)||void 0===U||U.trace(this,this.deleteConversationAsync,"Requesting to delete a conversation").write(),await this.service.deleteConversation(O),this.instrumentDeleteConversationSuccess(O),null===(G=this.log)||void 0===G||G.trace(this,this.deleteConversationAsync,"Delete succeeded."),this._deleteState=AC.Deleted,this.resetWithDelay()}catch(B){this.instrumentDeleteConversationFailure(O),this._deleteState=AC.DeleteFailed,this.resetWithDelay(),null===(q=this.log)||void 0===q||q.error(this,this.deleteConversationAsync,`Error deleting conversation: ${B}`).write()}}else null===(B=this.log)||void 0===B||B.error(this,this.deleteAsync,"Error deleting conversation: Delete is already in progress.").write()}resetWithDelay(){setTimeout((()=>this._deleteState=AC.Idle),this.delay)}instrumentDeleteConversationSuccess(O){this.telemetry.trackEvent("InteractionEvent","DeleteConversationSuccess",{Namespace:"Thread",CustomData:JSON.stringify({convId:O})})}instrumentDeleteConversationFailure(O){this.telemetry.trackEvent("InteractionEvent","DeleteConversationFailed",{Namespace:"Thread",CustomData:JSON.stringify({convId:O})})}instrumentSingleDeleteConversationSuccess(O){this.telemetry.trackEvent("InteractionEvent","DeleteConversationSuccess",{Namespace:"Thread",CustomData:JSON.stringify({isSingleDelete:!0,convId:O})})}instrumentSingleDeleteConversationFailure(O){this.telemetry.trackEvent("InteractionEvent","DeleteConversationFailed",{Namespace:"Thread",CustomData:JSON.stringify({isSingleDelete:!0,convId:O})})}};var zC,$C,UC,VC;__decorate([observable,__metadata("design:type",Number)],FC.prototype,"_deleteState",void 0),FC=__decorate([__param(0,qy),__param(1,gh),__param(2,$c),__param(3,ql),__param(4,Eh),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],FC);let GC=class extends lifecycle_Disposable{constructor(O,B,U,G,q,j){super(),this.telemetry=O,this.config=B,this.layout=U,this.factory=G,this.conversation=q,this.log=j,this.threadName="",this.strings={shareButtonAriaLabel:this.config.strings.feedbackShareButtonAriaLabel,tooltipShare:this.config.strings.tooltipShare},this.model=null,zC.set(this,void 0),$C.set(this,void 0),UC.set(this,void 0),VC.set(this,void 0)}initialize(O){var B;this.model=O,this.threadName=null!==(B=O.threadData.chatName)&&void 0!==B?B:""}get feedbackVm(){var O,B,U;return __classPrivateFieldSet(this,zC,null!==(O=__classPrivateFieldGet(this,zC,"f"))&&void 0!==O?O:this.factory.createFeedback({},void 0,this.exportVm),"f"),__classPrivateFieldGet(this,zC,"f").setWholeThreadConversationId((null===(B=this.model)||void 0===B?void 0:B.id)||null),__classPrivateFieldGet(this,zC,"f").enableShareWholeThread(!0),__classPrivateFieldGet(this,zC,"f").enableStandaloneShare(!0),__classPrivateFieldGet(this,zC,"f").setConverstaionType((null===(U=this.model)||void 0===U?void 0:U.threadData)instanceof SharedThreadData?Bc.Shared:Bc.Default),__classPrivateFieldGet(this,zC,"f").historyConversationVm=this.historyConversationVm,__classPrivateFieldGet(this,zC,"f")}get exportVm(){var O;return __classPrivateFieldSet(this,$C,null!==(O=__classPrivateFieldGet(this,$C,"f"))&&void 0!==O?O:this.factory.createExport([...this.conversation.messages]),"f"),__classPrivateFieldGet(this,$C,"f")}get historyConversationVm(){return __classPrivateFieldGet(this,UC,"f")}set historyConversationVm(O){__classPrivateFieldSet(this,UC,O,"f")}get sidePanelVm(){return __classPrivateFieldGet(this,VC,"f")}set sidePanelVm(O){__classPrivateFieldSet(this,VC,O,"f")}async handleExport(O,B){var U;O.preventDefault(),O.stopPropagation(),await(null===(U=this.feedbackVm)||void 0===U?void 0:U.exportWholeThreadAsync(B))}};function registerViewModels(O){O.addSingleton(Vt,zy),O.addSingleton(pS,US),O.addAlias(pS,qy),O.addSingleton($y,Zy),O.addSingleton(Xy,ub),O.addSingleton(dS,wC),O.addSingleton(Yy,xb),O.addSingleton(Pb,Ob),O.addSingleton(Nb,Db),O.addSingleton(rS,_S),O.addSingleton(SS,KS),O.addSingleton(vb,gC),O.addSingleton(pb,TC),O.addSingleton(gb,WS),O.addSingleton(qS,DC),O.addSingleton(Wy,Kb),O.addSingleton(Zb,Xb),O.addSingleton(Ky,SC),O.addSingleton(mb,EC),O.addSingleton(lS,VS),O.addSingleton(sS,vS),O.addSingleton(cS,YS),O.addSingleton(yb,_b),O.addTransient(Oy,kb),O.addTransient(By,Ib),O.addTransient(hb,vC),O.addTransient(tC,bC),O.addTransient(Iy,Wb),O.addTransient(Jb,tS),O.addTransient(ky,Rb),O.addTransient(xy,cC),O.addTransient(Ey,iS),O.addTransient(Sy,Vb),O.addTransient(My,MC),O.addTransient(Tb,wb),O.addTransient(RC,LC),O.addTransient(kC,FC),O.addTransient(by,pC),O.addTransient(Fy,GC),O.addTransient(wy,hC),O.addTransient(GS,BC),function(O){O.addTransient(aS,uS),O.addTransient(hS,mS),gS.set(nS.FeedbackDialog,aS),gS.set(nS.TestDialog,hS)}(O)}function collectStyles(O,B){const U=[];let G="";const q=[];for(let j=0,W=O.length-1;j<W;++j){G+=O[j];let W=B[j];if(W instanceof css_directive_CSSDirective){const O=W.createBehavior();W=W.createCSS(),O&&q.push(O)}W instanceof element_styles_ElementStyles||W instanceof CSSStyleSheet?(""!==G.trim()&&(U.push(G),G=""),U.push(W)):G+=W}return G+=O[O.length-1],""!==G.trim()&&U.push(G),{styles:U,behaviors:q}}function css(O,...B){const{styles:U,behaviors:G}=collectStyles(O,B),q=element_styles_ElementStyles.create(U);return G.length&&q.withBehaviors(...G),q}zC=new WeakMap,$C=new WeakMap,UC=new WeakMap,VC=new WeakMap,__decorate([observable,__metadata("design:type",String)],GC.prototype,"threadName",void 0),__decorate([observable,__metadata("design:type",Object)],GC.prototype,"strings",void 0),GC=__decorate([__param(0,$c),__param(1,ql),__param(2,gh),__param(3,Vt),__param(4,Dc),__param(5,Nt(Pi)),__metadata("design:paramtypes",[Object,Object,Object,Object,Object,Object])],GC);const HC=css`
  :host {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: ${tb.platform.typography.typeRamp.body2.fontSize};
    line-height: ${tb.platform.typography.typeRamp.body2.lineHeight};
  }

  :host([mobile]) {
    width: 100%;
    justify-content: flex-end;
  }

  /* CONTAINER */

  .feedbackform-container {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    width: 360px;
    z-index: 10;
    box-sizing: border-box;
    padding: 20px;
    gap: 10px;
    background: ${tb.theme.neutralColors.background.colorNeutralLayerCardAlt};
    border-radius: 12px;
  }

  :host([mobile]) .feedbackform-container {
    width: 100%;
    border-radius: 16px 16px 0px 0px;
  }

  :host([mobile]) .feedbackform-container.notification {
    align-items: center;
  }

  /* CONTENT */

  .feedbackform-container > form {
    width: 100%;
  }

  .feedbackform-title {
    font-weight: 700;
    font-size: ${tb.platform.typography.typeRamp.subtitle1.fontSize};
    line-height: ${tb.platform.typography.typeRamp.message.lineHeight};
    color: ${tb.theme.neutralColors.foreground.colorNeutralPrimaryForeground};
  }

  .feedbackform-category {
    margin-bottom: 8px;
  }

  .feedbackform-textarea {
    height: 60px;
    width: 100%;
    resize: none;
    background: ${tb.theme.neutralColors.background.colorNeutralPrimaryBackground};
    border: 1px solid ${tb.theme.neutralColors.stroke.colorNeutralStroke};
    border-radius: 2px;
    font-family: ${tb.platform.typography.fonts.text};
    font-weight: 400;
    font-size: ${tb.platform.typography.typeRamp.body1.fontSize};
    line-height: ${tb.platform.typography.typeRamp.body1.lineHeight};
    color: ${tb.theme.neutralColors.foreground.colorNeutralForeground};
  }

  .feedbackform-textarea:focus,
  .feedbackform-textarea:focus-visible {
    background: ${tb.theme.neutralColors.background.colorNeutralInputBackground};
    border: 1px solid ${tb.theme.neutralColors.stroke.colorNeutralStrokeFocus};
  }

  .feedbackform-legal {
    font-size: ${tb.platform.typography.typeRamp.body1.fontSize};
    line-height: ${tb.platform.typography.typeRamp.body1.lineHeight};
    color: ${tb.theme.neutralColors.foreground.colorNeutralForegroundHint};
  }

  .feedbackform-legal > a {
    color: ${tb.theme.brandColors.foreground.colorBrandLinkForeground};
  }

  .feedbackform-notification {
    font-size: ${tb.platform.typography.typeRamp.body1.fontSize};
    line-height: ${tb.platform.typography.typeRamp.body1.lineHeight};
    color: ${tb.theme.neutralColors.foreground.colorNeutralForegroundHint};
  }

  /* BUTTONS */

  .btn-group {
    display: flex;
    flex-direction: row;
    justify-content: center;
    gap: 10px;
    width: 100%;
  }

  .feedbackform-btn {
    flex-grow: 1;
    max-width: 50%;
    margin-top: 18px;
    height: 36px;
    padding: 7px 16px;
    border-radius: 20px;
    border: none;
  }

  .primary-btn:disabled,
  .primary-btn[disabled] {
    background: ${tb.theme.brandColors.background.colorBrandSecondaryBackgroundSolid};
    color: ${tb.theme.neutralColors.background.colorNeutralInputBackground};
    cursor: not-allowed;
  }

  .primary-btn {
    color: ${tb.theme.brandColors.foreground.colorBrandPrimaryForeground};
    background: ${tb.theme.brandColors.background.colorBrandPrimaryBackground};
  }
  .primary-btn:not([disabled]):hover {
    background: ${tb.theme.brandColors.background.colorBrandPrimaryBackgroundHover};
  }
  .primary-btn:not([disabled]):active {
    background: ${tb.theme.brandColors.background.colorBrandPrimaryBackgroundPressed};
  }

  .secondary-btn {
    color: ${tb.theme.neutralColors.foreground.colorNeutralPrimaryForeground};
    background: ${tb.theme.neutralColors.background.colorNeutralPrimaryBackground};
    border: 2px solid ${tb.theme.brandColors.stroke.colorBrandSecondaryStroke};
  }
  .secondary-btn:hover {
    background: ${tb.theme.neutralColors.background.colorNeutralPrimaryBackgroundHover};
  }
  .secondary-btn:active {
    background: ${tb.theme.neutralColors.background.colorNeutralPrimaryBackgroundPressed};
  }
`;class RefBehavior{constructor(O,B){this.target=O,this.propertyName=B}bind(O){O[this.propertyName]=this.target}unbind(){}}function ref(O){return new AttachedBehaviorHTMLDirective("fast-ref",RefBehavior,O)}function newSplice(O,B,U){return{index:O,removed:B,addedCount:U}}function calcSplices(O,B,U,G,q,j){let W=0,Y=0;const K=Math.min(U-B,j-q);if(0===B&&0===q&&(W=function(O,B,U){for(let G=0;G<U;++G)if(O[G]!==B[G])return G;return U}(O,G,K)),U===O.length&&j===G.length&&(Y=function(O,B,U){let G=O.length,q=B.length,j=0;for(;j<U&&O[--G]===B[--q];)j++;return j}(O,G,K-W)),q+=W,j-=Y,(U-=Y)-(B+=W)==0&&j-q==0)return rt;if(B===U){const O=newSplice(B,[],0);for(;q<j;)O.removed.push(G[q++]);return[O]}if(q===j)return[newSplice(B,[],U-B)];const Q=function(O){let B=O.length-1,U=O[0].length-1,G=O[B][U];const q=[];for(;B>0||U>0;){if(0===B){q.push(2),U--;continue}if(0===U){q.push(3),B--;continue}const j=O[B-1][U-1],W=O[B-1][U],Y=O[B][U-1];let K;K=W<Y?W<j?W:j:Y<j?Y:j,K===j?(j===G?q.push(0):(q.push(1),G=j),B--,U--):K===W?(q.push(3),B--,G=W):(q.push(2),U--,G=Y)}return q.reverse(),q}(function(O,B,U,G,q,j){const W=j-q+1,Y=U-B+1,K=new Array(W);let Q,Z;for(let O=0;O<W;++O)K[O]=new Array(Y),K[O][0]=O;for(let O=0;O<Y;++O)K[0][O]=O;for(let U=1;U<W;++U)for(let j=1;j<Y;++j)O[B+j-1]===G[q+U-1]?K[U][j]=K[U-1][j-1]:(Q=K[U-1][j]+1,Z=K[U][j-1]+1,K[U][j]=Q<Z?Q:Z);return K}(O,B,U,G,q,j)),Z=[];let X,J=B,ee=q;for(let O=0;O<Q.length;++O)switch(Q[O]){case 0:void 0!==X&&(Z.push(X),X=void 0),J++,ee++;break;case 1:void 0===X&&(X=newSplice(J,[],0)),X.addedCount++,J++,X.removed.push(G[ee]),ee++;break;case 2:void 0===X&&(X=newSplice(J,[],0)),X.addedCount++,J++;break;case 3:void 0===X&&(X=newSplice(J,[],0)),X.removed.push(G[ee]),ee++}return void 0!==X&&Z.push(X),Z}const qC=Array.prototype.push;function mergeSplice(O,B,U,G){const q=newSplice(B,U,G);let j=!1,W=0;for(let B=0;B<O.length;B++){const U=O[B];if(U.index+=W,j)continue;const G=(Y=q.index,K=q.index+q.removed.length,Q=U.index,Z=U.index+U.addedCount,K<Q||Z<Y?-1:K===Q||Z===Y?0:Y<Q?K<Z?K-Q:Z-Q:Z<K?Z-Y:K-Y);if(G>=0){O.splice(B,1),B--,W-=U.addedCount-U.removed.length,q.addedCount+=U.addedCount-G;const Y=q.removed.length+U.removed.length-G;if(q.addedCount||Y){let O=U.removed;if(q.index<U.index){const B=q.removed.slice(0,U.index-q.index);qC.apply(B,O),O=B}if(q.index+q.removed.length>U.index+U.addedCount){const B=q.removed.slice(U.index+U.addedCount-q.index);qC.apply(O,B)}q.removed=O,U.index<q.index&&(q.index=U.index)}else j=!0}else if(q.index<U.index){j=!0,O.splice(B,0,q),B++;const G=q.addedCount-q.removed.length;U.index+=G,W+=G}}var Y,K,Q,Z;j||O.push(q)}function projectArraySplices(O,B){let U=[];const G=function(O){const B=[];for(let U=0,G=O.length;U<G;U++){const G=O[U];mergeSplice(B,G.index,G.removed,G.addedCount)}return B}(B);for(let B=0,q=G.length;B<q;++B){const q=G[B];1!==q.addedCount||1!==q.removed.length?U=U.concat(calcSplices(O,q.index,q.index+q.addedCount,q.removed,0,q.removed.length)):q.removed[0]!==O[q.index]&&U.push(q)}return U}let jC=!1;function adjustIndex(O,B){let U=O.index;const G=B.length;return U>G?U=G-O.addedCount:U<0&&(U=G+O.removed.length+U-O.addedCount),U<0&&(U=0),O.index=U,O}class ArrayObserver extends SubscriberSet{constructor(O){super(O),this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this.call=this.flush,Re
